{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4178185228859224, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 3.432091047749003, "policy_loss": -0.1246092475527617, "vf_loss": 3.545577122575493, "vf_explained_var": 0.03301102121671041, "kl": 0.055615884250158704, "entropy": 4.193513126270745, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 465.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "sampler_results": {"episode_reward_max": 98.7, "episode_reward_min": -12.600000000000001, "episode_reward_mean": -10.245652173913042, "episode_len_mean": 9.746376811594203, "episode_media": {}, "episodes_this_iter": 138, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.1, -11.6, -11.7, -11.700000000000001, -10.9, -11.3, 98.7, -12.0, -12.5, -10.4, -10.8, -11.0, -10.4, -11.1, -10.6, -10.6, -11.4, -11.8, -11.0, -12.1, -10.2, -10.4, -10.8, -11.7, -10.2, -11.3, -11.0, -11.2, -11.5, -11.4, -11.4, -10.5, -10.2, -10.3, -10.6, -11.5, -11.0, -12.100000000000001, -10.1, -10.6, -10.9, -10.9, -11.6, -12.3, -10.0, -10.5, -10.6, -11.4, -11.5, -11.7, -11.5, -11.7, -10.0, -10.4, -10.6, -10.0, -10.2, -10.3, -10.5, -11.1, -11.4, -12.0, -11.9, -11.8, -12.3, -10.3, -10.3, -10.2, -11.7, -11.1, -12.0, -12.200000000000001, -10.1, -10.3, -10.5, -10.0, -10.7, -10.0, -10.1, -10.4, -10.7, -10.7, -11.0, -11.2, -10.7, -12.600000000000001, -10.1, -10.1, -10.2, -10.6, -10.6, -11.2, -11.5, -11.4, -11.2, -10.4, -10.0, -10.7, -11.5, -11.3, -11.7, -12.0, -12.4, -10.8, -12.200000000000001, -10.4, -10.4, -10.5, -11.0, -11.1, -11.6, -11.6, -11.1, -10.1, -10.4, -10.5, -10.5, -10.7, -11.9, -11.8, -12.0, -10.4, -10.8, -10.8, -11.1, -11.600000000000001, -12.3, -12.2, -12.600000000000001, -10.7, -10.7, -11.4, -11.600000000000001, -11.6, -11.4, -10.8, -11.9, -10.3], "episode_lengths": [2, 15, 16, 17, 9, 12, 12, 17, 18, 5, 8, 10, 5, 11, 6, 7, 14, 15, 10, 18, 3, 5, 7, 14, 3, 10, 10, 10, 13, 13, 14, 5, 3, 4, 4, 14, 11, 19, 2, 7, 9, 9, 14, 20, 1, 5, 6, 12, 13, 15, 15, 16, 1, 4, 7, 1, 2, 4, 6, 11, 12, 19, 15, 17, 19, 3, 4, 3, 14, 10, 18, 20, 2, 4, 6, 1, 7, 1, 2, 4, 7, 8, 9, 11, 7, 19, 2, 2, 2, 6, 7, 12, 13, 14, 10, 4, 1, 7, 12, 12, 17, 18, 19, 8, 19, 5, 5, 6, 9, 9, 14, 14, 10, 2, 4, 6, 6, 8, 15, 15, 17, 4, 8, 9, 11, 15, 18, 19, 20, 7, 7, 12, 14, 15, 15, 9, 17, 4]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.064977295074568, "mean_inference_ms": 15.88487871932194, "mean_action_processing_ms": 0.9590716424524743, "mean_env_wait_ms": 2.1060576020972, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0632892484250276, "StateBufferConnector_ms": 0.007831013720968494, "ViewRequirementAgentConnector_ms": 0.11522389840388643}}, "episode_reward_max": 98.7, "episode_reward_min": -12.600000000000001, "episode_reward_mean": -10.245652173913042, "episode_len_mean": 9.746376811594203, "episodes_this_iter": 138, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10.1, -11.6, -11.7, -11.700000000000001, -10.9, -11.3, 98.7, -12.0, -12.5, -10.4, -10.8, -11.0, -10.4, -11.1, -10.6, -10.6, -11.4, -11.8, -11.0, -12.1, -10.2, -10.4, -10.8, -11.7, -10.2, -11.3, -11.0, -11.2, -11.5, -11.4, -11.4, -10.5, -10.2, -10.3, -10.6, -11.5, -11.0, -12.100000000000001, -10.1, -10.6, -10.9, -10.9, -11.6, -12.3, -10.0, -10.5, -10.6, -11.4, -11.5, -11.7, -11.5, -11.7, -10.0, -10.4, -10.6, -10.0, -10.2, -10.3, -10.5, -11.1, -11.4, -12.0, -11.9, -11.8, -12.3, -10.3, -10.3, -10.2, -11.7, -11.1, -12.0, -12.200000000000001, -10.1, -10.3, -10.5, -10.0, -10.7, -10.0, -10.1, -10.4, -10.7, -10.7, -11.0, -11.2, -10.7, -12.600000000000001, -10.1, -10.1, -10.2, -10.6, -10.6, -11.2, -11.5, -11.4, -11.2, -10.4, -10.0, -10.7, -11.5, -11.3, -11.7, -12.0, -12.4, -10.8, -12.200000000000001, -10.4, -10.4, -10.5, -11.0, -11.1, -11.6, -11.6, -11.1, -10.1, -10.4, -10.5, -10.5, -10.7, -11.9, -11.8, -12.0, -10.4, -10.8, -10.8, -11.1, -11.600000000000001, -12.3, -12.2, -12.600000000000001, -10.7, -10.7, -11.4, -11.600000000000001, -11.6, -11.4, -10.8, -11.9, -10.3], "episode_lengths": [2, 15, 16, 17, 9, 12, 12, 17, 18, 5, 8, 10, 5, 11, 6, 7, 14, 15, 10, 18, 3, 5, 7, 14, 3, 10, 10, 10, 13, 13, 14, 5, 3, 4, 4, 14, 11, 19, 2, 7, 9, 9, 14, 20, 1, 5, 6, 12, 13, 15, 15, 16, 1, 4, 7, 1, 2, 4, 6, 11, 12, 19, 15, 17, 19, 3, 4, 3, 14, 10, 18, 20, 2, 4, 6, 1, 7, 1, 2, 4, 7, 8, 9, 11, 7, 19, 2, 2, 2, 6, 7, 12, 13, 14, 10, 4, 1, 7, 12, 12, 17, 18, 19, 8, 19, 5, 5, 6, 9, 9, 14, 14, 10, 2, 4, 6, 6, 8, 15, 15, 17, 4, 8, 9, 11, 15, 18, 19, 20, 7, 7, 12, 14, 15, 15, 9, 17, 4]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.064977295074568, "mean_inference_ms": 15.88487871932194, "mean_action_processing_ms": 0.9590716424524743, "mean_env_wait_ms": 2.1060576020972, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0632892484250276, "StateBufferConnector_ms": 0.007831013720968494, "ViewRequirementAgentConnector_ms": 0.11522389840388643}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 170634.691, "load_time_ms": 0.423, "load_throughput": 9446630.631, "learn_time_ms": 169494.934, "learn_throughput": 23.6, "synch_weights_time_ms": 176.056}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 138, "training_iteration": 1, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-06_20-58-31", "timestamp": 1680807511, "time_this_iter_s": 170.64678955078125, "time_total_s": 170.64678955078125, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476bc1f0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7effc2556ca0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 170.64678955078125, "timesteps_since_restore": 0, "iterations_since_restore": 1, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.973251028806583, "ram_util_percent": 22.841975308641977}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4718893278991023, "cur_kl_coeff": 0.3, "cur_lr": 0.0010000000000000005, "total_loss": 1.6073695330249687, "policy_loss": -0.16233380214431353, "vf_loss": 1.750747609867524, "vf_explained_var": 0.09088891276749231, "kl": 0.06318574278810693, "entropy": 4.115531289705666, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1395.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": -3.1000000000000005, "episode_reward_min": -12.600000000000001, "episode_reward_mean": -6.1409090909090915, "episode_len_mean": 17.611570247933884, "episode_media": {}, "episodes_this_iter": 242, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.500000000000001, -3.500000000000001, -3.500000000000001, -3.500000000000001, -3.500000000000001, -3.6000000000000005, -3.7000000000000006, -10.2, -11.7, -3.700000000000001, -3.4000000000000004, -3.400000000000001, -3.3000000000000003, -3.700000000000001, -3.400000000000001, -3.800000000000001, -10.6, -3.400000000000001, -12.600000000000001, -11.3, -3.6000000000000005, -11.8, -3.5000000000000004, -3.600000000000001, -3.400000000000001, -3.7000000000000006, -3.7, -3.6000000000000005, -3.400000000000001, -11.6, -3.6000000000000005, -3.6000000000000005, -3.5000000000000013, -3.500000000000001, -3.2000000000000006, -3.5000000000000004, -3.400000000000001, -3.3000000000000007, -10.0, -10.1, -10.6, -3.500000000000001, -10.7, -11.3, -3.600000000000001, -4.000000000000001, -3.5000000000000013, -3.3000000000000007, -3.600000000000001, -3.600000000000001, -3.400000000000001, -3.2000000000000006, -3.500000000000001, -3.600000000000001, -10.4, -12.1, -3.7000000000000015, -3.6000000000000005, -3.900000000000001, -3.4000000000000004, -11.0, -3.500000000000001, -3.3000000000000007, -3.400000000000001, -3.5000000000000004, -10.2, -3.600000000000001, -3.400000000000001, -11.5, -3.3000000000000007, -3.5000000000000004, -3.3000000000000007, -3.6000000000000005, -3.4000000000000004, -3.5000000000000004, -3.3000000000000007, -3.6000000000000005, -11.6, -10.9, -3.8000000000000007, -11.8, -11.9, -3.600000000000001, -3.400000000000001, -3.5000000000000004, -3.6000000000000005, -3.400000000000001, -10.0, -3.400000000000001, -3.600000000000001, -10.6, -3.9000000000000012, -3.6000000000000005, -10.8, -3.600000000000001, -11.5, -10.1, -11.0, -3.600000000000001, -3.600000000000001, -3.1000000000000005, -12.100000000000001, -3.500000000000001, -10.6, -3.4000000000000004, -11.5, -3.7000000000000006, -3.2000000000000006, -12.3, -3.500000000000001, -3.600000000000001, -3.4000000000000004, -10.9, -3.5000000000000004, -3.2, -3.600000000000001, -3.6000000000000005, -12.100000000000001, -10.7, -11.3, -3.500000000000001, -11.8, -12.100000000000001, -3.8000000000000007, -10.0, -3.6000000000000005, -3.700000000000001, -3.400000000000001, -3.3000000000000007, -3.8000000000000007, -3.3000000000000007, -3.500000000000001, -10.5, -10.7, -3.2, -10.7, -3.3000000000000007, -3.4000000000000004, -3.7000000000000006, -3.5000000000000004, -3.500000000000001, -3.7000000000000006, -3.400000000000001, -11.4, -11.1, -3.3000000000000003, -3.5000000000000004, -12.3, -3.600000000000001, -3.300000000000001, -11.3, -3.500000000000001, -3.6000000000000005, -3.3000000000000003, -3.400000000000001, -3.4000000000000004, -3.5000000000000004, -10.5, -11.0, -11.4, -3.6000000000000014, -3.4000000000000004, -3.4000000000000004, -10.9, -12.100000000000001, -3.600000000000001, -10.3, -12.600000000000001, -10.0, -11.1, -11.6, -12.0, -3.6000000000000005, -10.3, -3.500000000000001, -3.500000000000001, -3.7000000000000006, -3.7000000000000006, -11.3, -11.0, -12.5, -10.3, -3.300000000000001, -11.3, -3.5000000000000004, -10.5, -3.500000000000001, -3.6000000000000005, -3.2000000000000006, -3.600000000000001, -11.7, -11.5, -3.7000000000000006, -11.6, -12.200000000000001, -3.400000000000001, -3.5000000000000004, -3.3000000000000007, -3.3000000000000007, -10.7, -10.6, -11.700000000000001, -3.3000000000000007, -3.4000000000000004, -3.3000000000000007, -10.8, -3.600000000000001, -11.1, -3.400000000000001, -3.7000000000000006, -3.5000000000000004, -3.3000000000000003, -3.400000000000001, -3.800000000000001, -10.6, -3.2000000000000006, -11.2, -12.3, -11.1, -10.1, -3.4000000000000004, -3.6000000000000005, -3.3000000000000007, -3.3000000000000007, -11.7, -3.2000000000000006, -3.400000000000001, -12.100000000000001, -3.3000000000000003, -11.6, -3.3000000000000007, -12.4, -3.5000000000000004, -3.3000000000000007, -3.800000000000001, -11.700000000000001, -3.5000000000000004, -3.5000000000000004, -11.8, -3.400000000000001, -3.7000000000000006, -3.8000000000000007], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 3, 15, 21, 21, 21, 21, 21, 21, 21, 7, 21, 20, 12, 21, 17, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 1, 2, 6, 21, 7, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 19, 21, 21, 21, 21, 11, 21, 21, 21, 21, 3, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 14, 9, 21, 15, 16, 21, 21, 21, 21, 21, 1, 21, 21, 6, 21, 21, 9, 21, 14, 2, 8, 21, 21, 21, 19, 21, 6, 21, 14, 21, 21, 18, 21, 21, 21, 10, 21, 21, 21, 21, 18, 8, 12, 21, 16, 18, 21, 1, 21, 21, 21, 21, 21, 21, 21, 5, 8, 21, 7, 21, 21, 21, 21, 21, 21, 21, 12, 11, 21, 21, 19, 21, 21, 14, 21, 21, 21, 21, 21, 21, 6, 10, 13, 21, 21, 21, 10, 17, 21, 4, 20, 1, 10, 15, 17, 21, 4, 21, 21, 21, 21, 11, 10, 18, 4, 21, 14, 21, 5, 21, 21, 21, 21, 14, 13, 21, 15, 18, 21, 21, 21, 21, 8, 7, 16, 21, 21, 21, 8, 21, 9, 21, 21, 21, 21, 21, 21, 7, 21, 12, 19, 10, 2, 21, 21, 21, 21, 14, 21, 21, 18, 21, 15, 21, 20, 21, 21, 21, 15, 21, 21, 16, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.144073273909234, "mean_inference_ms": 16.88479848552966, "mean_action_processing_ms": 0.9643735964436176, "mean_env_wait_ms": 2.1516180547873023, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09295309870696265, "StateBufferConnector_ms": 0.01491613624509701, "ViewRequirementAgentConnector_ms": 0.16973767398802703}}, "episode_reward_max": -3.1000000000000005, "episode_reward_min": -12.600000000000001, "episode_reward_mean": -6.1409090909090915, "episode_len_mean": 17.611570247933884, "episodes_this_iter": 242, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.500000000000001, -3.500000000000001, -3.500000000000001, -3.500000000000001, -3.500000000000001, -3.6000000000000005, -3.7000000000000006, -10.2, -11.7, -3.700000000000001, -3.4000000000000004, -3.400000000000001, -3.3000000000000003, -3.700000000000001, -3.400000000000001, -3.800000000000001, -10.6, -3.400000000000001, -12.600000000000001, -11.3, -3.6000000000000005, -11.8, -3.5000000000000004, -3.600000000000001, -3.400000000000001, -3.7000000000000006, -3.7, -3.6000000000000005, -3.400000000000001, -11.6, -3.6000000000000005, -3.6000000000000005, -3.5000000000000013, -3.500000000000001, -3.2000000000000006, -3.5000000000000004, -3.400000000000001, -3.3000000000000007, -10.0, -10.1, -10.6, -3.500000000000001, -10.7, -11.3, -3.600000000000001, -4.000000000000001, -3.5000000000000013, -3.3000000000000007, -3.600000000000001, -3.600000000000001, -3.400000000000001, -3.2000000000000006, -3.500000000000001, -3.600000000000001, -10.4, -12.1, -3.7000000000000015, -3.6000000000000005, -3.900000000000001, -3.4000000000000004, -11.0, -3.500000000000001, -3.3000000000000007, -3.400000000000001, -3.5000000000000004, -10.2, -3.600000000000001, -3.400000000000001, -11.5, -3.3000000000000007, -3.5000000000000004, -3.3000000000000007, -3.6000000000000005, -3.4000000000000004, -3.5000000000000004, -3.3000000000000007, -3.6000000000000005, -11.6, -10.9, -3.8000000000000007, -11.8, -11.9, -3.600000000000001, -3.400000000000001, -3.5000000000000004, -3.6000000000000005, -3.400000000000001, -10.0, -3.400000000000001, -3.600000000000001, -10.6, -3.9000000000000012, -3.6000000000000005, -10.8, -3.600000000000001, -11.5, -10.1, -11.0, -3.600000000000001, -3.600000000000001, -3.1000000000000005, -12.100000000000001, -3.500000000000001, -10.6, -3.4000000000000004, -11.5, -3.7000000000000006, -3.2000000000000006, -12.3, -3.500000000000001, -3.600000000000001, -3.4000000000000004, -10.9, -3.5000000000000004, -3.2, -3.600000000000001, -3.6000000000000005, -12.100000000000001, -10.7, -11.3, -3.500000000000001, -11.8, -12.100000000000001, -3.8000000000000007, -10.0, -3.6000000000000005, -3.700000000000001, -3.400000000000001, -3.3000000000000007, -3.8000000000000007, -3.3000000000000007, -3.500000000000001, -10.5, -10.7, -3.2, -10.7, -3.3000000000000007, -3.4000000000000004, -3.7000000000000006, -3.5000000000000004, -3.500000000000001, -3.7000000000000006, -3.400000000000001, -11.4, -11.1, -3.3000000000000003, -3.5000000000000004, -12.3, -3.600000000000001, -3.300000000000001, -11.3, -3.500000000000001, -3.6000000000000005, -3.3000000000000003, -3.400000000000001, -3.4000000000000004, -3.5000000000000004, -10.5, -11.0, -11.4, -3.6000000000000014, -3.4000000000000004, -3.4000000000000004, -10.9, -12.100000000000001, -3.600000000000001, -10.3, -12.600000000000001, -10.0, -11.1, -11.6, -12.0, -3.6000000000000005, -10.3, -3.500000000000001, -3.500000000000001, -3.7000000000000006, -3.7000000000000006, -11.3, -11.0, -12.5, -10.3, -3.300000000000001, -11.3, -3.5000000000000004, -10.5, -3.500000000000001, -3.6000000000000005, -3.2000000000000006, -3.600000000000001, -11.7, -11.5, -3.7000000000000006, -11.6, -12.200000000000001, -3.400000000000001, -3.5000000000000004, -3.3000000000000007, -3.3000000000000007, -10.7, -10.6, -11.700000000000001, -3.3000000000000007, -3.4000000000000004, -3.3000000000000007, -10.8, -3.600000000000001, -11.1, -3.400000000000001, -3.7000000000000006, -3.5000000000000004, -3.3000000000000003, -3.400000000000001, -3.800000000000001, -10.6, -3.2000000000000006, -11.2, -12.3, -11.1, -10.1, -3.4000000000000004, -3.6000000000000005, -3.3000000000000007, -3.3000000000000007, -11.7, -3.2000000000000006, -3.400000000000001, -12.100000000000001, -3.3000000000000003, -11.6, -3.3000000000000007, -12.4, -3.5000000000000004, -3.3000000000000007, -3.800000000000001, -11.700000000000001, -3.5000000000000004, -3.5000000000000004, -11.8, -3.400000000000001, -3.7000000000000006, -3.8000000000000007], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 3, 15, 21, 21, 21, 21, 21, 21, 21, 7, 21, 20, 12, 21, 17, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 1, 2, 6, 21, 7, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 19, 21, 21, 21, 21, 11, 21, 21, 21, 21, 3, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 14, 9, 21, 15, 16, 21, 21, 21, 21, 21, 1, 21, 21, 6, 21, 21, 9, 21, 14, 2, 8, 21, 21, 21, 19, 21, 6, 21, 14, 21, 21, 18, 21, 21, 21, 10, 21, 21, 21, 21, 18, 8, 12, 21, 16, 18, 21, 1, 21, 21, 21, 21, 21, 21, 21, 5, 8, 21, 7, 21, 21, 21, 21, 21, 21, 21, 12, 11, 21, 21, 19, 21, 21, 14, 21, 21, 21, 21, 21, 21, 6, 10, 13, 21, 21, 21, 10, 17, 21, 4, 20, 1, 10, 15, 17, 21, 4, 21, 21, 21, 21, 11, 10, 18, 4, 21, 14, 21, 5, 21, 21, 21, 21, 14, 13, 21, 15, 18, 21, 21, 21, 21, 8, 7, 16, 21, 21, 21, 8, 21, 9, 21, 21, 21, 21, 21, 21, 7, 21, 12, 19, 10, 2, 21, 21, 21, 21, 14, 21, 21, 18, 21, 15, 21, 20, 21, 21, 21, 15, 21, 21, 16, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.144073273909234, "mean_inference_ms": 16.88479848552966, "mean_action_processing_ms": 0.9643735964436176, "mean_env_wait_ms": 2.1516180547873023, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09295309870696265, "StateBufferConnector_ms": 0.01491613624509701, "ViewRequirementAgentConnector_ms": 0.16973767398802703}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 170559.776, "load_time_ms": 0.653, "load_throughput": 6121954.388, "learn_time_ms": 169510.913, "learn_throughput": 23.597, "synch_weights_time_ms": 166.993}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 380, "training_iteration": 2, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-06_21-01-26", "timestamp": 1680807686, "time_this_iter_s": 170.49575757980347, "time_total_s": 341.1425471305847, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476ad610>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0147773040>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 341.1425471305847, "timesteps_since_restore": 0, "iterations_since_restore": 2, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 6.411693548387096, "ram_util_percent": 23.49475806451613}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1367111430373242, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 1.3707008719624532, "policy_loss": -0.16407630876587925, "vf_loss": 1.511405227221148, "vf_explained_var": 0.17796720875206815, "kl": 0.05193765478744422, "entropy": 4.0546215590610295, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2325.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.4, "episode_reward_mean": -5.901702127659575, "episode_len_mean": 18.025531914893616, "episode_media": {}, "episodes_this_iter": 235, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.600000000000001, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -10.0, -3.2, -3.400000000000001, -3.500000000000001, -3.9000000000000012, -3.2000000000000006, -11.9, -3.6000000000000005, -3.400000000000001, -3.2000000000000006, -3.7000000000000006, -3.4000000000000004, -3.5000000000000004, -3.500000000000001, -3.6000000000000005, -11.6, -3.600000000000001, -12.0, -3.4000000000000004, -3.800000000000001, -3.3000000000000007, -3.4000000000000004, -3.7000000000000006, -3.3000000000000007, -10.0, -3.3000000000000007, -3.500000000000001, -3.500000000000001, -3.5000000000000004, -11.9, -3.4000000000000004, -3.600000000000001, -12.200000000000001, -3.400000000000001, -3.3000000000000007, -10.6, -3.4000000000000004, -11.8, -3.400000000000001, -3.400000000000001, -3.600000000000001, -3.7000000000000006, -3.500000000000001, -3.600000000000001, -3.7000000000000006, -3.500000000000001, -12.3, -3.400000000000001, -3.3000000000000007, -3.0000000000000004, -10.9, -3.6000000000000005, -11.5, -11.7, -3.400000000000001, -3.5000000000000004, -3.3000000000000007, -3.400000000000001, -10.5, -3.400000000000001, -3.400000000000001, -3.400000000000001, -3.2000000000000006, -3.4000000000000004, -3.6000000000000005, -3.5000000000000004, -3.7000000000000006, -3.5000000000000004, -3.600000000000001, -3.6000000000000005, -3.500000000000001, -12.200000000000001, -3.7000000000000006, -3.3000000000000007, -3.600000000000001, -3.500000000000001, -10.6, -3.500000000000001, -10.1, -10.8, -3.600000000000001, -11.3, -10.0, -3.5000000000000004, -3.7000000000000006, -3.2000000000000006, -11.2, -3.4000000000000004, -3.3000000000000003, -3.3000000000000007, -11.700000000000001, -3.5000000000000004, -3.400000000000001, -3.600000000000001, -3.4000000000000004, -3.500000000000001, -12.3, -3.6000000000000005, -10.0, -3.500000000000001, -10.1, -3.6000000000000005, -10.1, -11.0, -3.800000000000001, -3.5000000000000004, -3.8000000000000007, -12.0, -3.3000000000000007, -12.4, -12.3, -3.500000000000001, -3.9000000000000012, -3.3000000000000007, -3.2000000000000006, -3.5000000000000004, -10.6, -11.1, -11.5, -11.2, -3.8000000000000007, -3.500000000000001, -3.5000000000000004, -3.600000000000001, -3.2000000000000006, -3.6000000000000005, -3.500000000000001, -3.7000000000000006, -3.3000000000000007, -10.5, -10.4, -3.700000000000001, -11.700000000000001, -3.400000000000001, -3.3000000000000007, -3.8000000000000007, -3.600000000000001, -3.8000000000000007, -4.000000000000001, -3.600000000000001, -3.500000000000001, -3.6000000000000005, -11.3, -10.6, -10.9, -11.6, -3.7000000000000006, -3.5000000000000004, -3.400000000000001, -3.3000000000000007, -3.800000000000001, -3.8000000000000007, -3.3000000000000007, -11.7, -3.6000000000000005, -12.3, -3.3000000000000003, -3.2000000000000006, -12.200000000000001, -11.7, -3.5000000000000004, -3.500000000000001, -3.100000000000001, -10.6, -4.000000000000002, -11.2, -3.700000000000001, -10.8, -3.6000000000000005, -11.4, -3.7000000000000006, -3.600000000000001, -10.7, -11.7, -11.0, -11.9, -3.3000000000000003, -3.3000000000000007, -3.700000000000001, -3.4000000000000004, -3.2000000000000006, -3.5000000000000004, -3.4000000000000004, -3.5000000000000004, -10.4, -3.600000000000001, -3.400000000000001, -12.100000000000001, -11.2, -3.2000000000000006, -10.8, -11.4, -10.6, -10.6, -3.3000000000000007, -12.100000000000001, -12.200000000000001, -3.5000000000000004, -3.2000000000000006, -11.6, -10.7, -3.600000000000001, -3.600000000000001, -12.0, -12.0, -3.400000000000001, -3.400000000000001, -3.600000000000001, -3.4000000000000012, -10.5, -3.5000000000000004, -3.500000000000001, -10.2, -11.6, -11.700000000000001, -3.7000000000000006, -11.5, -3.700000000000001, -3.700000000000001, -3.600000000000001, -3.400000000000001, -3.300000000000001, -3.600000000000001, -10.5, -3.8000000000000007, -3.6000000000000005, -11.7, -3.600000000000001, -3.500000000000001, -3.500000000000001], "episode_lengths": [21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 19, 21, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 16, 21, 21, 19, 21, 21, 7, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 10, 21, 14, 15, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 6, 21, 2, 8, 21, 13, 1, 21, 21, 21, 11, 21, 21, 21, 17, 21, 21, 21, 21, 21, 20, 21, 1, 21, 2, 21, 2, 7, 21, 21, 21, 17, 21, 20, 20, 21, 21, 21, 21, 21, 6, 9, 13, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 4, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 7, 8, 14, 21, 21, 21, 21, 21, 21, 21, 15, 21, 20, 21, 21, 18, 16, 21, 21, 21, 7, 21, 12, 21, 8, 21, 13, 21, 21, 7, 14, 9, 17, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 17, 10, 21, 8, 13, 7, 6, 21, 18, 20, 21, 21, 15, 7, 21, 21, 18, 17, 21, 21, 21, 21, 5, 21, 21, 3, 14, 16, 21, 13, 21, 21, 21, 21, 21, 21, 6, 21, 21, 14, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.247997804847294, "mean_inference_ms": 17.1892872329036, "mean_action_processing_ms": 0.956856651425902, "mean_env_wait_ms": 2.1382563364476663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0789283184295005, "StateBufferConnector_ms": 0.01215417334373961, "ViewRequirementAgentConnector_ms": 0.14766977188435007}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.4, "episode_reward_mean": -5.901702127659575, "episode_len_mean": 18.025531914893616, "episodes_this_iter": 235, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.600000000000001, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -10.0, -3.2, -3.400000000000001, -3.500000000000001, -3.9000000000000012, -3.2000000000000006, -11.9, -3.6000000000000005, -3.400000000000001, -3.2000000000000006, -3.7000000000000006, -3.4000000000000004, -3.5000000000000004, -3.500000000000001, -3.6000000000000005, -11.6, -3.600000000000001, -12.0, -3.4000000000000004, -3.800000000000001, -3.3000000000000007, -3.4000000000000004, -3.7000000000000006, -3.3000000000000007, -10.0, -3.3000000000000007, -3.500000000000001, -3.500000000000001, -3.5000000000000004, -11.9, -3.4000000000000004, -3.600000000000001, -12.200000000000001, -3.400000000000001, -3.3000000000000007, -10.6, -3.4000000000000004, -11.8, -3.400000000000001, -3.400000000000001, -3.600000000000001, -3.7000000000000006, -3.500000000000001, -3.600000000000001, -3.7000000000000006, -3.500000000000001, -12.3, -3.400000000000001, -3.3000000000000007, -3.0000000000000004, -10.9, -3.6000000000000005, -11.5, -11.7, -3.400000000000001, -3.5000000000000004, -3.3000000000000007, -3.400000000000001, -10.5, -3.400000000000001, -3.400000000000001, -3.400000000000001, -3.2000000000000006, -3.4000000000000004, -3.6000000000000005, -3.5000000000000004, -3.7000000000000006, -3.5000000000000004, -3.600000000000001, -3.6000000000000005, -3.500000000000001, -12.200000000000001, -3.7000000000000006, -3.3000000000000007, -3.600000000000001, -3.500000000000001, -10.6, -3.500000000000001, -10.1, -10.8, -3.600000000000001, -11.3, -10.0, -3.5000000000000004, -3.7000000000000006, -3.2000000000000006, -11.2, -3.4000000000000004, -3.3000000000000003, -3.3000000000000007, -11.700000000000001, -3.5000000000000004, -3.400000000000001, -3.600000000000001, -3.4000000000000004, -3.500000000000001, -12.3, -3.6000000000000005, -10.0, -3.500000000000001, -10.1, -3.6000000000000005, -10.1, -11.0, -3.800000000000001, -3.5000000000000004, -3.8000000000000007, -12.0, -3.3000000000000007, -12.4, -12.3, -3.500000000000001, -3.9000000000000012, -3.3000000000000007, -3.2000000000000006, -3.5000000000000004, -10.6, -11.1, -11.5, -11.2, -3.8000000000000007, -3.500000000000001, -3.5000000000000004, -3.600000000000001, -3.2000000000000006, -3.6000000000000005, -3.500000000000001, -3.7000000000000006, -3.3000000000000007, -10.5, -10.4, -3.700000000000001, -11.700000000000001, -3.400000000000001, -3.3000000000000007, -3.8000000000000007, -3.600000000000001, -3.8000000000000007, -4.000000000000001, -3.600000000000001, -3.500000000000001, -3.6000000000000005, -11.3, -10.6, -10.9, -11.6, -3.7000000000000006, -3.5000000000000004, -3.400000000000001, -3.3000000000000007, -3.800000000000001, -3.8000000000000007, -3.3000000000000007, -11.7, -3.6000000000000005, -12.3, -3.3000000000000003, -3.2000000000000006, -12.200000000000001, -11.7, -3.5000000000000004, -3.500000000000001, -3.100000000000001, -10.6, -4.000000000000002, -11.2, -3.700000000000001, -10.8, -3.6000000000000005, -11.4, -3.7000000000000006, -3.600000000000001, -10.7, -11.7, -11.0, -11.9, -3.3000000000000003, -3.3000000000000007, -3.700000000000001, -3.4000000000000004, -3.2000000000000006, -3.5000000000000004, -3.4000000000000004, -3.5000000000000004, -10.4, -3.600000000000001, -3.400000000000001, -12.100000000000001, -11.2, -3.2000000000000006, -10.8, -11.4, -10.6, -10.6, -3.3000000000000007, -12.100000000000001, -12.200000000000001, -3.5000000000000004, -3.2000000000000006, -11.6, -10.7, -3.600000000000001, -3.600000000000001, -12.0, -12.0, -3.400000000000001, -3.400000000000001, -3.600000000000001, -3.4000000000000012, -10.5, -3.5000000000000004, -3.500000000000001, -10.2, -11.6, -11.700000000000001, -3.7000000000000006, -11.5, -3.700000000000001, -3.700000000000001, -3.600000000000001, -3.400000000000001, -3.300000000000001, -3.600000000000001, -10.5, -3.8000000000000007, -3.6000000000000005, -11.7, -3.600000000000001, -3.500000000000001, -3.500000000000001], "episode_lengths": [21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 19, 21, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 16, 21, 21, 19, 21, 21, 7, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 10, 21, 14, 15, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 6, 21, 2, 8, 21, 13, 1, 21, 21, 21, 11, 21, 21, 21, 17, 21, 21, 21, 21, 21, 20, 21, 1, 21, 2, 21, 2, 7, 21, 21, 21, 17, 21, 20, 20, 21, 21, 21, 21, 21, 6, 9, 13, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 4, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 7, 8, 14, 21, 21, 21, 21, 21, 21, 21, 15, 21, 20, 21, 21, 18, 16, 21, 21, 21, 7, 21, 12, 21, 8, 21, 13, 21, 21, 7, 14, 9, 17, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 17, 10, 21, 8, 13, 7, 6, 21, 18, 20, 21, 21, 15, 7, 21, 21, 18, 17, 21, 21, 21, 21, 5, 21, 21, 3, 14, 16, 21, 13, 21, 21, 21, 21, 21, 21, 6, 21, 21, 14, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.247997804847294, "mean_inference_ms": 17.1892872329036, "mean_action_processing_ms": 0.956856651425902, "mean_env_wait_ms": 2.1382563364476663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0789283184295005, "StateBufferConnector_ms": 0.01215417334373961, "ViewRequirementAgentConnector_ms": 0.14766977188435007}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 170525.76, "load_time_ms": 0.741, "load_throughput": 5399232.783, "learn_time_ms": 169473.316, "learn_throughput": 23.603, "synch_weights_time_ms": 177.925}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 615, "training_iteration": 3, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-06_21-04-16", "timestamp": 1680807856, "time_this_iter_s": 170.47129273414612, "time_total_s": 511.61383986473083, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476cb130>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0147753f70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 511.61383986473083, "timesteps_since_restore": 0, "iterations_since_restore": 3, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.37892561983471, "ram_util_percent": 23.44752066115702}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0479370198422862, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 1.179809592024333, "policy_loss": -0.05507476089311944, "vf_loss": 1.2189879623792506, "vf_explained_var": 0.2625829719087129, "kl": 0.02355020381710542, "entropy": 4.040265803952371, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3255.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "sampler_results": {"episode_reward_max": 97.8, "episode_reward_min": -12.3, "episode_reward_mean": -5.062666666666667, "episode_len_mean": 18.075555555555557, "episode_media": {}, "episodes_this_iter": 225, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.2000000000000006, -3.5000000000000004, -3.2000000000000006, -3.800000000000001, -3.600000000000001, -3.600000000000001, -11.0, -3.6000000000000014, -11.8, -11.8, -3.500000000000001, -10.6, -3.8000000000000007, -3.6000000000000005, -11.1, -10.4, -3.7000000000000006, -3.3000000000000003, -3.800000000000001, -3.4000000000000004, -3.600000000000001, -3.400000000000001, -10.4, -3.7000000000000006, -3.3000000000000003, -3.6000000000000005, -11.5, -3.400000000000001, -3.500000000000001, -3.7000000000000006, -3.500000000000001, -11.0, -3.600000000000001, -3.400000000000001, -3.600000000000001, -3.500000000000001, -3.5, -3.6000000000000005, -3.500000000000001, -12.200000000000001, -3.700000000000001, -3.4000000000000004, -3.3000000000000007, -3.5000000000000004, -3.2000000000000006, -3.500000000000001, -3.400000000000001, -3.600000000000001, -3.6000000000000005, -10.0, -3.7000000000000006, -3.500000000000001, -3.500000000000001, -3.500000000000001, -3.3000000000000007, -3.400000000000001, -3.500000000000001, -3.700000000000001, -3.500000000000001, -3.700000000000001, -3.3000000000000007, -3.700000000000001, -3.500000000000001, -10.0, -3.500000000000001, -11.1, -3.400000000000001, -3.400000000000001, -12.200000000000001, -3.6000000000000005, -11.1, -3.6000000000000005, -3.2000000000000006, -11.0, -3.700000000000001, -3.6000000000000005, -3.2000000000000006, -3.3000000000000003, -3.7000000000000006, -10.3, -3.600000000000001, -3.2000000000000006, -3.5000000000000004, -3.500000000000001, -3.400000000000001, -3.4000000000000004, -10.3, -3.400000000000001, -3.400000000000001, -10.9, -3.5000000000000004, -11.6, -3.400000000000001, -11.4, -3.500000000000001, -11.7, -12.100000000000001, -3.400000000000001, -3.400000000000001, -12.3, -3.5000000000000004, -3.3000000000000007, -3.500000000000001, -11.4, -3.400000000000001, -3.4, 97.8, -3.1000000000000005, -3.500000000000001, -3.500000000000001, -3.400000000000001, -10.8, -10.1, -3.800000000000001, -3.3000000000000007, -10.3, -10.3, -11.2, -11.5, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -12.0, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -11.700000000000001, -3.600000000000001, -3.4000000000000004, -11.0, -3.500000000000001, -3.6000000000000005, -3.3000000000000003, -3.500000000000001, -3.600000000000001, -3.5000000000000004, -3.800000000000001, -3.6000000000000005, -3.3000000000000003, -10.7, -3.7000000000000006, -3.500000000000001, -10.9, -10.9, -3.3000000000000007, -3.500000000000001, -3.6000000000000005, -3.8000000000000007, -3.6000000000000005, -3.8000000000000003, -3.5000000000000004, -3.300000000000001, -3.600000000000001, -3.600000000000001, -3.3000000000000003, -11.0, -11.1, -12.0, -10.2, -3.400000000000001, -3.500000000000001, -3.5000000000000004, -3.4000000000000004, -3.500000000000001, -3.700000000000001, -10.4, -10.8, -11.2, -11.6, -11.8, -11.3, -3.4000000000000004, -3.4000000000000004, -3.7000000000000006, -3.5000000000000013, -4.100000000000001, -10.6, -10.3, -3.5000000000000004, -11.3, -3.5000000000000004, -3.8000000000000007, -3.6000000000000005, -3.500000000000001, -10.7, -3.900000000000001, -3.700000000000001, -3.400000000000001, -10.8, -3.900000000000001, -3.7000000000000006, -10.4, -3.3000000000000007, -3.600000000000001, -3.600000000000001, -11.8, -3.500000000000001, -3.200000000000001, -11.8, -3.3000000000000007, -3.3000000000000007, -3.5000000000000004, -3.2000000000000006, -3.8000000000000007, -11.3, -3.600000000000001, -3.4000000000000004, -11.2, -3.5000000000000004, -3.6000000000000005, -3.500000000000001, -10.4, -3.4000000000000004, -3.500000000000001, -10.3, -10.6, -3.600000000000001, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.5000000000000004, -3.7000000000000006, -3.3000000000000007, -3.500000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 11, 21, 16, 16, 21, 6, 21, 21, 11, 5, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 13, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21, 11, 21, 21, 18, 21, 10, 21, 21, 11, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 4, 21, 21, 8, 21, 14, 21, 13, 21, 14, 19, 21, 21, 18, 21, 21, 21, 13, 21, 21, 19, 21, 21, 21, 21, 9, 2, 21, 21, 4, 4, 11, 14, 21, 21, 21, 15, 21, 21, 21, 21, 15, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 9, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 11, 16, 3, 21, 21, 21, 21, 21, 21, 5, 8, 11, 15, 18, 12, 21, 21, 21, 21, 21, 7, 4, 21, 11, 21, 21, 21, 21, 7, 21, 21, 21, 8, 21, 21, 5, 21, 21, 21, 17, 21, 21, 17, 21, 21, 21, 21, 21, 12, 21, 21, 11, 21, 21, 21, 4, 21, 21, 4, 6, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.280947283625766, "mean_inference_ms": 17.282618455926087, "mean_action_processing_ms": 0.9455715514341336, "mean_env_wait_ms": 2.1291498359502263, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07516394721137153, "StateBufferConnector_ms": 0.011314286126030816, "ViewRequirementAgentConnector_ms": 0.13912444644504124}}, "episode_reward_max": 97.8, "episode_reward_min": -12.3, "episode_reward_mean": -5.062666666666667, "episode_len_mean": 18.075555555555557, "episodes_this_iter": 225, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.2000000000000006, -3.5000000000000004, -3.2000000000000006, -3.800000000000001, -3.600000000000001, -3.600000000000001, -11.0, -3.6000000000000014, -11.8, -11.8, -3.500000000000001, -10.6, -3.8000000000000007, -3.6000000000000005, -11.1, -10.4, -3.7000000000000006, -3.3000000000000003, -3.800000000000001, -3.4000000000000004, -3.600000000000001, -3.400000000000001, -10.4, -3.7000000000000006, -3.3000000000000003, -3.6000000000000005, -11.5, -3.400000000000001, -3.500000000000001, -3.7000000000000006, -3.500000000000001, -11.0, -3.600000000000001, -3.400000000000001, -3.600000000000001, -3.500000000000001, -3.5, -3.6000000000000005, -3.500000000000001, -12.200000000000001, -3.700000000000001, -3.4000000000000004, -3.3000000000000007, -3.5000000000000004, -3.2000000000000006, -3.500000000000001, -3.400000000000001, -3.600000000000001, -3.6000000000000005, -10.0, -3.7000000000000006, -3.500000000000001, -3.500000000000001, -3.500000000000001, -3.3000000000000007, -3.400000000000001, -3.500000000000001, -3.700000000000001, -3.500000000000001, -3.700000000000001, -3.3000000000000007, -3.700000000000001, -3.500000000000001, -10.0, -3.500000000000001, -11.1, -3.400000000000001, -3.400000000000001, -12.200000000000001, -3.6000000000000005, -11.1, -3.6000000000000005, -3.2000000000000006, -11.0, -3.700000000000001, -3.6000000000000005, -3.2000000000000006, -3.3000000000000003, -3.7000000000000006, -10.3, -3.600000000000001, -3.2000000000000006, -3.5000000000000004, -3.500000000000001, -3.400000000000001, -3.4000000000000004, -10.3, -3.400000000000001, -3.400000000000001, -10.9, -3.5000000000000004, -11.6, -3.400000000000001, -11.4, -3.500000000000001, -11.7, -12.100000000000001, -3.400000000000001, -3.400000000000001, -12.3, -3.5000000000000004, -3.3000000000000007, -3.500000000000001, -11.4, -3.400000000000001, -3.4, 97.8, -3.1000000000000005, -3.500000000000001, -3.500000000000001, -3.400000000000001, -10.8, -10.1, -3.800000000000001, -3.3000000000000007, -10.3, -10.3, -11.2, -11.5, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -12.0, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -11.700000000000001, -3.600000000000001, -3.4000000000000004, -11.0, -3.500000000000001, -3.6000000000000005, -3.3000000000000003, -3.500000000000001, -3.600000000000001, -3.5000000000000004, -3.800000000000001, -3.6000000000000005, -3.3000000000000003, -10.7, -3.7000000000000006, -3.500000000000001, -10.9, -10.9, -3.3000000000000007, -3.500000000000001, -3.6000000000000005, -3.8000000000000007, -3.6000000000000005, -3.8000000000000003, -3.5000000000000004, -3.300000000000001, -3.600000000000001, -3.600000000000001, -3.3000000000000003, -11.0, -11.1, -12.0, -10.2, -3.400000000000001, -3.500000000000001, -3.5000000000000004, -3.4000000000000004, -3.500000000000001, -3.700000000000001, -10.4, -10.8, -11.2, -11.6, -11.8, -11.3, -3.4000000000000004, -3.4000000000000004, -3.7000000000000006, -3.5000000000000013, -4.100000000000001, -10.6, -10.3, -3.5000000000000004, -11.3, -3.5000000000000004, -3.8000000000000007, -3.6000000000000005, -3.500000000000001, -10.7, -3.900000000000001, -3.700000000000001, -3.400000000000001, -10.8, -3.900000000000001, -3.7000000000000006, -10.4, -3.3000000000000007, -3.600000000000001, -3.600000000000001, -11.8, -3.500000000000001, -3.200000000000001, -11.8, -3.3000000000000007, -3.3000000000000007, -3.5000000000000004, -3.2000000000000006, -3.8000000000000007, -11.3, -3.600000000000001, -3.4000000000000004, -11.2, -3.5000000000000004, -3.6000000000000005, -3.500000000000001, -10.4, -3.4000000000000004, -3.500000000000001, -10.3, -10.6, -3.600000000000001, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.5000000000000004, -3.7000000000000006, -3.3000000000000007, -3.500000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 11, 21, 16, 16, 21, 6, 21, 21, 11, 5, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 13, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21, 11, 21, 21, 18, 21, 10, 21, 21, 11, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 4, 21, 21, 8, 21, 14, 21, 13, 21, 14, 19, 21, 21, 18, 21, 21, 21, 13, 21, 21, 19, 21, 21, 21, 21, 9, 2, 21, 21, 4, 4, 11, 14, 21, 21, 21, 15, 21, 21, 21, 21, 15, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 9, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 11, 16, 3, 21, 21, 21, 21, 21, 21, 5, 8, 11, 15, 18, 12, 21, 21, 21, 21, 21, 7, 4, 21, 11, 21, 21, 21, 21, 7, 21, 21, 21, 8, 21, 21, 5, 21, 21, 21, 17, 21, 21, 17, 21, 21, 21, 21, 21, 12, 21, 21, 11, 21, 21, 21, 4, 21, 21, 4, 6, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.280947283625766, "mean_inference_ms": 17.282618455926087, "mean_action_processing_ms": 0.9455715514341336, "mean_env_wait_ms": 2.1291498359502263, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07516394721137153, "StateBufferConnector_ms": 0.011314286126030816, "ViewRequirementAgentConnector_ms": 0.13912444644504124}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 170740.937, "load_time_ms": 0.809, "load_throughput": 4946842.4, "learn_time_ms": 169706.195, "learn_throughput": 23.57, "synch_weights_time_ms": 182.434}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "episodes_total": 840, "training_iteration": 4, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-06_21-07-08", "timestamp": 1680808028, "time_this_iter_s": 171.3995749950409, "time_total_s": 683.0134148597717, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01477a3c10>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01477d3040>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 683.0134148597717, "timesteps_since_restore": 0, "iterations_since_restore": 4, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.62551440329218, "ram_util_percent": 23.416872427983538}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2738563204324374, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 1.1784800651733593, "policy_loss": -0.1498406924918214, "vf_loss": 1.2965355216375283, "vf_explained_var": 0.20685320817014222, "kl": 0.03139282300560084, "entropy": 4.016098638503782, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4185.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "sampler_results": {"episode_reward_max": -3.1000000000000005, "episode_reward_min": -12.4, "episode_reward_mean": -5.758666666666666, "episode_len_mean": 18.017777777777777, "episode_media": {}, "episodes_this_iter": 225, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.6, -12.0, -3.600000000000001, -3.7000000000000006, -3.3000000000000003, -3.400000000000001, -3.400000000000001, -11.3, -3.3000000000000007, -11.1, -3.8000000000000007, -10.1, -10.5, -3.300000000000001, -3.7000000000000006, -12.0, -11.2, -3.5000000000000004, -3.5000000000000004, -3.8000000000000007, -3.6000000000000005, -11.4, -11.9, -3.2000000000000006, -10.6, -12.200000000000001, -3.4000000000000004, -3.3000000000000007, -3.6000000000000005, -3.400000000000001, -3.5000000000000004, -10.8, -11.3, -3.700000000000001, -3.5, -11.5, -11.700000000000001, -3.6000000000000005, -3.6000000000000005, -3.600000000000001, -3.3000000000000007, -3.3000000000000003, -3.600000000000001, -3.5000000000000004, -11.4, -3.600000000000001, -3.500000000000001, -3.400000000000001, -11.1, -3.600000000000001, -3.700000000000001, -3.400000000000001, -3.6000000000000005, -11.1, -3.600000000000001, -3.2000000000000006, -11.8, -10.7, -3.4000000000000004, -3.5000000000000004, -11.700000000000001, -3.4000000000000012, -11.1, -3.3000000000000007, -3.3000000000000007, -10.7, -3.700000000000001, -11.3, -3.700000000000001, -10.4, -11.6, -11.0, -3.3000000000000007, -3.4000000000000004, -3.3000000000000007, -3.3000000000000003, -3.400000000000001, -3.5000000000000004, -3.700000000000001, -12.200000000000001, -10.0, -3.7000000000000006, -3.3000000000000007, -3.5000000000000004, -11.1, -11.4, -3.5000000000000004, -11.2, -3.4000000000000004, -12.3, -3.800000000000001, -3.4000000000000004, -3.200000000000001, -3.4000000000000012, -11.700000000000001, -3.5000000000000004, -3.4000000000000012, -3.4000000000000004, -3.400000000000001, -3.3000000000000007, -12.100000000000001, -10.7, -10.7, -10.1, -3.6000000000000005, -3.7000000000000006, -10.9, -10.5, -3.5000000000000013, -3.700000000000001, -10.3, -3.2000000000000006, -10.1, -3.5000000000000004, -10.6, -3.500000000000001, -3.400000000000001, -3.2000000000000006, -11.7, -3.3000000000000003, -3.400000000000001, -11.0, -3.600000000000001, -10.8, -3.7000000000000006, -12.4, -3.2000000000000006, -3.8000000000000007, -3.500000000000001, -3.5000000000000004, -3.600000000000001, -3.4000000000000012, -3.3000000000000003, -3.400000000000001, -3.4000000000000004, -3.400000000000001, -11.9, -10.0, -10.1, -12.100000000000001, -10.6, -3.5000000000000004, -3.5000000000000004, -3.500000000000001, -3.600000000000001, -3.3000000000000007, -3.7000000000000006, -3.7000000000000006, -10.0, -3.2000000000000006, -3.900000000000001, -3.400000000000001, -3.400000000000001, -3.600000000000001, -3.2000000000000006, -11.8, -3.6000000000000005, -3.3000000000000007, -12.1, -3.6000000000000005, -3.400000000000001, -3.3000000000000007, -3.900000000000001, -3.600000000000001, -11.3, -3.600000000000001, -3.8000000000000016, -3.4000000000000004, -3.4000000000000004, -3.7000000000000006, -3.400000000000001, -3.3000000000000003, -3.400000000000001, -11.1, -3.500000000000001, -3.500000000000001, -3.500000000000001, -3.4000000000000004, -3.3000000000000007, -3.5000000000000004, -12.200000000000001, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.5000000000000004, -3.3000000000000007, -11.9, -3.6000000000000005, -11.7, -10.7, -11.1, -3.3000000000000007, -11.700000000000001, -3.5000000000000004, -3.3000000000000007, -3.4000000000000012, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.4000000000000004, -3.600000000000001, -3.500000000000001, -3.3000000000000007, -3.2000000000000006, -3.7000000000000006, -10.1, -3.2000000000000006, -3.700000000000001, -3.3000000000000007, -10.6, -3.5000000000000004, -3.400000000000001, -3.3000000000000003, -3.3000000000000007, -3.300000000000001, -3.6000000000000005, -11.0, -3.5000000000000004, -3.6000000000000005, -3.500000000000001, -3.3000000000000007], "episode_lengths": [16, 18, 21, 21, 21, 21, 21, 12, 21, 11, 21, 2, 6, 21, 21, 17, 10, 21, 21, 21, 21, 13, 18, 21, 7, 19, 21, 21, 21, 21, 21, 8, 11, 21, 21, 13, 15, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 9, 21, 21, 21, 21, 12, 21, 21, 13, 7, 21, 21, 16, 21, 10, 21, 21, 8, 21, 11, 21, 5, 14, 11, 21, 21, 21, 21, 21, 21, 21, 19, 1, 21, 21, 21, 11, 12, 21, 10, 21, 20, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 19, 8, 8, 2, 21, 21, 9, 6, 21, 21, 4, 21, 2, 21, 7, 21, 21, 21, 15, 21, 21, 10, 21, 8, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 1, 2, 18, 6, 21, 21, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 15, 21, 21, 19, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 17, 21, 16, 8, 11, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.376497828921076, "mean_inference_ms": 17.29224822964474, "mean_action_processing_ms": 0.9411487537379837, "mean_env_wait_ms": 2.121420210868743, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07674651675754124, "StateBufferConnector_ms": 0.01089742448594835, "ViewRequirementAgentConnector_ms": 0.14080365498860678}}, "episode_reward_max": -3.1000000000000005, "episode_reward_min": -12.4, "episode_reward_mean": -5.758666666666666, "episode_len_mean": 18.017777777777777, "episodes_this_iter": 225, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11.6, -12.0, -3.600000000000001, -3.7000000000000006, -3.3000000000000003, -3.400000000000001, -3.400000000000001, -11.3, -3.3000000000000007, -11.1, -3.8000000000000007, -10.1, -10.5, -3.300000000000001, -3.7000000000000006, -12.0, -11.2, -3.5000000000000004, -3.5000000000000004, -3.8000000000000007, -3.6000000000000005, -11.4, -11.9, -3.2000000000000006, -10.6, -12.200000000000001, -3.4000000000000004, -3.3000000000000007, -3.6000000000000005, -3.400000000000001, -3.5000000000000004, -10.8, -11.3, -3.700000000000001, -3.5, -11.5, -11.700000000000001, -3.6000000000000005, -3.6000000000000005, -3.600000000000001, -3.3000000000000007, -3.3000000000000003, -3.600000000000001, -3.5000000000000004, -11.4, -3.600000000000001, -3.500000000000001, -3.400000000000001, -11.1, -3.600000000000001, -3.700000000000001, -3.400000000000001, -3.6000000000000005, -11.1, -3.600000000000001, -3.2000000000000006, -11.8, -10.7, -3.4000000000000004, -3.5000000000000004, -11.700000000000001, -3.4000000000000012, -11.1, -3.3000000000000007, -3.3000000000000007, -10.7, -3.700000000000001, -11.3, -3.700000000000001, -10.4, -11.6, -11.0, -3.3000000000000007, -3.4000000000000004, -3.3000000000000007, -3.3000000000000003, -3.400000000000001, -3.5000000000000004, -3.700000000000001, -12.200000000000001, -10.0, -3.7000000000000006, -3.3000000000000007, -3.5000000000000004, -11.1, -11.4, -3.5000000000000004, -11.2, -3.4000000000000004, -12.3, -3.800000000000001, -3.4000000000000004, -3.200000000000001, -3.4000000000000012, -11.700000000000001, -3.5000000000000004, -3.4000000000000012, -3.4000000000000004, -3.400000000000001, -3.3000000000000007, -12.100000000000001, -10.7, -10.7, -10.1, -3.6000000000000005, -3.7000000000000006, -10.9, -10.5, -3.5000000000000013, -3.700000000000001, -10.3, -3.2000000000000006, -10.1, -3.5000000000000004, -10.6, -3.500000000000001, -3.400000000000001, -3.2000000000000006, -11.7, -3.3000000000000003, -3.400000000000001, -11.0, -3.600000000000001, -10.8, -3.7000000000000006, -12.4, -3.2000000000000006, -3.8000000000000007, -3.500000000000001, -3.5000000000000004, -3.600000000000001, -3.4000000000000012, -3.3000000000000003, -3.400000000000001, -3.4000000000000004, -3.400000000000001, -11.9, -10.0, -10.1, -12.100000000000001, -10.6, -3.5000000000000004, -3.5000000000000004, -3.500000000000001, -3.600000000000001, -3.3000000000000007, -3.7000000000000006, -3.7000000000000006, -10.0, -3.2000000000000006, -3.900000000000001, -3.400000000000001, -3.400000000000001, -3.600000000000001, -3.2000000000000006, -11.8, -3.6000000000000005, -3.3000000000000007, -12.1, -3.6000000000000005, -3.400000000000001, -3.3000000000000007, -3.900000000000001, -3.600000000000001, -11.3, -3.600000000000001, -3.8000000000000016, -3.4000000000000004, -3.4000000000000004, -3.7000000000000006, -3.400000000000001, -3.3000000000000003, -3.400000000000001, -11.1, -3.500000000000001, -3.500000000000001, -3.500000000000001, -3.4000000000000004, -3.3000000000000007, -3.5000000000000004, -12.200000000000001, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.5000000000000004, -3.3000000000000007, -11.9, -3.6000000000000005, -11.7, -10.7, -11.1, -3.3000000000000007, -11.700000000000001, -3.5000000000000004, -3.3000000000000007, -3.4000000000000012, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.4000000000000004, -3.600000000000001, -3.500000000000001, -3.3000000000000007, -3.2000000000000006, -3.7000000000000006, -10.1, -3.2000000000000006, -3.700000000000001, -3.3000000000000007, -10.6, -3.5000000000000004, -3.400000000000001, -3.3000000000000003, -3.3000000000000007, -3.300000000000001, -3.6000000000000005, -11.0, -3.5000000000000004, -3.6000000000000005, -3.500000000000001, -3.3000000000000007], "episode_lengths": [16, 18, 21, 21, 21, 21, 21, 12, 21, 11, 21, 2, 6, 21, 21, 17, 10, 21, 21, 21, 21, 13, 18, 21, 7, 19, 21, 21, 21, 21, 21, 8, 11, 21, 21, 13, 15, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 9, 21, 21, 21, 21, 12, 21, 21, 13, 7, 21, 21, 16, 21, 10, 21, 21, 8, 21, 11, 21, 5, 14, 11, 21, 21, 21, 21, 21, 21, 21, 19, 1, 21, 21, 21, 11, 12, 21, 10, 21, 20, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 19, 8, 8, 2, 21, 21, 9, 6, 21, 21, 4, 21, 2, 21, 7, 21, 21, 21, 15, 21, 21, 10, 21, 8, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 1, 2, 18, 6, 21, 21, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 15, 21, 21, 19, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 17, 21, 16, 8, 11, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.376497828921076, "mean_inference_ms": 17.29224822964474, "mean_action_processing_ms": 0.9411487537379837, "mean_env_wait_ms": 2.121420210868743, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07674651675754124, "StateBufferConnector_ms": 0.01089742448594835, "ViewRequirementAgentConnector_ms": 0.14080365498860678}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 170831.139, "load_time_ms": 0.861, "load_throughput": 4647170.794, "learn_time_ms": 169816.115, "learn_throughput": 23.555, "synch_weights_time_ms": 179.911}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "episodes_total": 1065, "training_iteration": 5, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-06_21-09-59", "timestamp": 1680808199, "time_this_iter_s": 171.20632243156433, "time_total_s": 854.2197372913361, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476cb9d0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0147753f70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 854.2197372913361, "timesteps_since_restore": 0, "iterations_since_restore": 5, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.29795081967213, "ram_util_percent": 23.498360655737706}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9488206046883778, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.0010000000000000005, "total_loss": 0.8339991205081504, "policy_loss": -0.050833983189346246, "vf_loss": 0.8670326476295789, "vf_explained_var": 0.3039467950661977, "kl": 0.011720464447192767, "entropy": 4.014042930192844, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5115.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": 98.8, "episode_reward_min": -12.3, "episode_reward_mean": -4.150222222222223, "episode_len_mean": 18.511111111111113, "episode_media": {}, "episodes_this_iter": 225, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.5000000000000004, -3.2000000000000006, -3.300000000000001, -3.6, -10.3, -12.0, -3.7000000000000006, -10.2, -3.400000000000001, -3.400000000000001, -3.6000000000000005, -10.5, -12.2, -10.2, -3.500000000000001, -3.400000000000001, -3.1000000000000005, -3.4000000000000004, -11.9, -3.700000000000001, -3.400000000000001, -3.7000000000000006, -3.600000000000001, -3.600000000000001, -3.5000000000000004, -3.8000000000000007, -3.3000000000000007, -3.8000000000000007, -10.8, -3.400000000000001, -3.500000000000001, -3.4000000000000012, -3.4000000000000004, -12.0, -3.3000000000000007, -3.6000000000000005, -3.6000000000000005, -3.6000000000000005, -3.4000000000000004, -3.600000000000001, -3.3000000000000007, -3.1000000000000005, -3.700000000000001, 98.8, -3.400000000000001, -3.6000000000000005, -11.700000000000001, -3.4000000000000004, -3.400000000000001, -3.500000000000001, -11.8, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.500000000000001, -3.3000000000000007, -3.6000000000000005, -3.600000000000001, -10.2, -3.2000000000000006, -3.400000000000001, -3.6000000000000005, -3.4000000000000004, -12.3, -3.3000000000000007, -3.3000000000000007, -3.6, -3.2000000000000006, -12.200000000000001, -12.100000000000001, -3.3000000000000003, -3.500000000000001, -3.5, -11.0, -11.5, -3.600000000000001, -3.9000000000000012, -3.3000000000000007, -3.900000000000001, -10.1, -3.2000000000000006, -3.600000000000001, -3.500000000000001, -3.4000000000000004, -3.4000000000000004, -11.3, -3.600000000000001, -3.1000000000000005, -3.6000000000000005, -3.4000000000000004, -3.4000000000000004, -3.6000000000000005, -3.4000000000000012, -10.5, -3.5000000000000004, -3.400000000000001, -3.600000000000001, -3.2000000000000006, -3.2000000000000006, -4.100000000000001, -3.8000000000000007, -3.6000000000000005, -3.600000000000001, -3.9000000000000012, -3.400000000000001, -3.3000000000000003, -10.3, -3.400000000000001, -10.5, -3.400000000000001, -11.4, -10.8, -3.4000000000000004, -3.1000000000000005, -10.6, -3.5000000000000004, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.500000000000001, -3.500000000000001, -3.5000000000000004, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.3000000000000003, -3.500000000000001, -11.1, -3.400000000000001, -11.700000000000001, -3.600000000000001, -3.6000000000000005, -3.5000000000000013, -3.700000000000001, -3.400000000000001, -10.3, -3.5000000000000004, -3.400000000000001, -3.8000000000000007, -3.600000000000001, -11.3, -11.2, -12.200000000000001, -3.800000000000001, -3.2000000000000006, -3.200000000000001, -3.700000000000001, 98.6, -3.500000000000001, -3.8000000000000007, -3.3000000000000007, -3.600000000000001, -3.4000000000000004, -3.6000000000000005, -3.4000000000000004, -3.300000000000001, -3.400000000000001, -3.3000000000000003, -3.4000000000000004, -3.5000000000000004, -3.3000000000000007, -10.4, -3.3000000000000007, -10.7, -3.4000000000000004, -3.7000000000000006, -12.0, -3.6000000000000005, -3.400000000000001, -10.5, -10.6, -3.3000000000000007, -3.2000000000000006, -3.5000000000000004, -3.3000000000000003, -3.3000000000000007, -10.1, -3.300000000000001, -10.7, -10.2, -10.2, -11.4, -3.3000000000000007, -3.400000000000001, -3.500000000000001, -3.6000000000000005, -3.6000000000000005, -3.7000000000000006, -11.2, -10.2, -10.3, -3.400000000000001, -3.3000000000000003, -3.500000000000001, -3.3000000000000007, -3.400000000000001, -3.500000000000001, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.2000000000000006, -12.200000000000001, -3.6000000000000005, -3.2000000000000006, -3.7000000000000006, -3.3000000000000007, -10.0, -3.3000000000000007, -3.6000000000000005, -3.2000000000000006, -3.500000000000001, -3.400000000000001, -3.400000000000001, -3.400000000000001, -3.3000000000000003, -3.400000000000001, -10.5, -10.3, -3.5, -3.5000000000000004, -3.400000000000001, -3.6000000000000005, -3.2, -3.500000000000001], "episode_lengths": [21, 21, 21, 21, 4, 17, 21, 3, 21, 21, 21, 6, 20, 3, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 16, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 19, 21, 21, 21, 21, 20, 20, 21, 21, 21, 10, 14, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 6, 21, 14, 9, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 17, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 12, 11, 19, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 8, 21, 21, 20, 21, 21, 6, 7, 21, 21, 21, 21, 21, 2, 21, 6, 3, 3, 11, 21, 21, 21, 21, 21, 21, 10, 3, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 4, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.365467674038188, "mean_inference_ms": 17.35715465878433, "mean_action_processing_ms": 0.9502852171030035, "mean_env_wait_ms": 2.1552314355463142, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07804245418972439, "StateBufferConnector_ms": 0.010332425435384115, "ViewRequirementAgentConnector_ms": 0.14330069224039713}}, "episode_reward_max": 98.8, "episode_reward_min": -12.3, "episode_reward_mean": -4.150222222222223, "episode_len_mean": 18.511111111111113, "episodes_this_iter": 225, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.5000000000000004, -3.2000000000000006, -3.300000000000001, -3.6, -10.3, -12.0, -3.7000000000000006, -10.2, -3.400000000000001, -3.400000000000001, -3.6000000000000005, -10.5, -12.2, -10.2, -3.500000000000001, -3.400000000000001, -3.1000000000000005, -3.4000000000000004, -11.9, -3.700000000000001, -3.400000000000001, -3.7000000000000006, -3.600000000000001, -3.600000000000001, -3.5000000000000004, -3.8000000000000007, -3.3000000000000007, -3.8000000000000007, -10.8, -3.400000000000001, -3.500000000000001, -3.4000000000000012, -3.4000000000000004, -12.0, -3.3000000000000007, -3.6000000000000005, -3.6000000000000005, -3.6000000000000005, -3.4000000000000004, -3.600000000000001, -3.3000000000000007, -3.1000000000000005, -3.700000000000001, 98.8, -3.400000000000001, -3.6000000000000005, -11.700000000000001, -3.4000000000000004, -3.400000000000001, -3.500000000000001, -11.8, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.500000000000001, -3.3000000000000007, -3.6000000000000005, -3.600000000000001, -10.2, -3.2000000000000006, -3.400000000000001, -3.6000000000000005, -3.4000000000000004, -12.3, -3.3000000000000007, -3.3000000000000007, -3.6, -3.2000000000000006, -12.200000000000001, -12.100000000000001, -3.3000000000000003, -3.500000000000001, -3.5, -11.0, -11.5, -3.600000000000001, -3.9000000000000012, -3.3000000000000007, -3.900000000000001, -10.1, -3.2000000000000006, -3.600000000000001, -3.500000000000001, -3.4000000000000004, -3.4000000000000004, -11.3, -3.600000000000001, -3.1000000000000005, -3.6000000000000005, -3.4000000000000004, -3.4000000000000004, -3.6000000000000005, -3.4000000000000012, -10.5, -3.5000000000000004, -3.400000000000001, -3.600000000000001, -3.2000000000000006, -3.2000000000000006, -4.100000000000001, -3.8000000000000007, -3.6000000000000005, -3.600000000000001, -3.9000000000000012, -3.400000000000001, -3.3000000000000003, -10.3, -3.400000000000001, -10.5, -3.400000000000001, -11.4, -10.8, -3.4000000000000004, -3.1000000000000005, -10.6, -3.5000000000000004, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.500000000000001, -3.500000000000001, -3.5000000000000004, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.3000000000000003, -3.500000000000001, -11.1, -3.400000000000001, -11.700000000000001, -3.600000000000001, -3.6000000000000005, -3.5000000000000013, -3.700000000000001, -3.400000000000001, -10.3, -3.5000000000000004, -3.400000000000001, -3.8000000000000007, -3.600000000000001, -11.3, -11.2, -12.200000000000001, -3.800000000000001, -3.2000000000000006, -3.200000000000001, -3.700000000000001, 98.6, -3.500000000000001, -3.8000000000000007, -3.3000000000000007, -3.600000000000001, -3.4000000000000004, -3.6000000000000005, -3.4000000000000004, -3.300000000000001, -3.400000000000001, -3.3000000000000003, -3.4000000000000004, -3.5000000000000004, -3.3000000000000007, -10.4, -3.3000000000000007, -10.7, -3.4000000000000004, -3.7000000000000006, -12.0, -3.6000000000000005, -3.400000000000001, -10.5, -10.6, -3.3000000000000007, -3.2000000000000006, -3.5000000000000004, -3.3000000000000003, -3.3000000000000007, -10.1, -3.300000000000001, -10.7, -10.2, -10.2, -11.4, -3.3000000000000007, -3.400000000000001, -3.500000000000001, -3.6000000000000005, -3.6000000000000005, -3.7000000000000006, -11.2, -10.2, -10.3, -3.400000000000001, -3.3000000000000003, -3.500000000000001, -3.3000000000000007, -3.400000000000001, -3.500000000000001, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.2000000000000006, -12.200000000000001, -3.6000000000000005, -3.2000000000000006, -3.7000000000000006, -3.3000000000000007, -10.0, -3.3000000000000007, -3.6000000000000005, -3.2000000000000006, -3.500000000000001, -3.400000000000001, -3.400000000000001, -3.400000000000001, -3.3000000000000003, -3.400000000000001, -10.5, -10.3, -3.5, -3.5000000000000004, -3.400000000000001, -3.6000000000000005, -3.2, -3.500000000000001], "episode_lengths": [21, 21, 21, 21, 4, 17, 21, 3, 21, 21, 21, 6, 20, 3, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 16, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 19, 21, 21, 21, 21, 20, 20, 21, 21, 21, 10, 14, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 6, 21, 14, 9, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 17, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 12, 11, 19, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 8, 21, 21, 20, 21, 21, 6, 7, 21, 21, 21, 21, 21, 2, 21, 6, 3, 3, 11, 21, 21, 21, 21, 21, 21, 10, 3, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 4, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.365467674038188, "mean_inference_ms": 17.35715465878433, "mean_action_processing_ms": 0.9502852171030035, "mean_env_wait_ms": 2.1552314355463142, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07804245418972439, "StateBufferConnector_ms": 0.010332425435384115, "ViewRequirementAgentConnector_ms": 0.14330069224039713}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 170816.412, "load_time_ms": 0.92, "load_throughput": 4347743.1, "learn_time_ms": 169802.977, "learn_throughput": 23.557, "synch_weights_time_ms": 178.878}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 1290, "training_iteration": 6, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-06_21-12-50", "timestamp": 1680808370, "time_this_iter_s": 170.7542130947113, "time_total_s": 1024.9739503860474, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476f2f10>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014785edc0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 1024.9739503860474, "timesteps_since_restore": 0, "iterations_since_restore": 6, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.399588477366255, "ram_util_percent": 23.500411522633748}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1125013418735996, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.0010000000000000005, "total_loss": 0.7943024180793223, "policy_loss": -0.040993933899638554, "vf_loss": 0.8167045224758406, "vf_explained_var": 0.3802232627586652, "kl": 0.012241537262803264, "entropy": 3.9989143020363263, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6045.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "sampler_results": {"episode_reward_max": 97.7, "episode_reward_min": -12.3, "episode_reward_mean": -4.573023255813954, "episode_len_mean": 18.474418604651163, "episode_media": {}, "episodes_this_iter": 215, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.5000000000000004, -3.300000000000001, -3.500000000000001, -10.1, -3.7000000000000006, -3.3000000000000007, -3.6, -3.3000000000000003, -3.4000000000000004, -3.4000000000000004, -3.5000000000000013, -3.400000000000001, -11.6, -11.2, -3.400000000000001, -3.2000000000000006, -3.5000000000000004, -3.3000000000000007, -3.4000000000000012, -10.4, -11.7, -3.3000000000000007, -3.400000000000001, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.500000000000001, -3.400000000000001, -3.6000000000000005, -3.7000000000000006, -3.2000000000000006, -11.3, -3.2, -3.600000000000001, -3.4000000000000004, -3.500000000000001, -11.9, -3.400000000000001, -3.600000000000001, -3.400000000000001, -3.500000000000001, -3.4000000000000004, -3.300000000000001, -3.400000000000001, -10.3, -3.2, -3.600000000000001, -3.3000000000000007, -10.0, -3.5000000000000004, -3.400000000000001, -11.7, -3.600000000000001, -3.500000000000001, -3.400000000000001, -3.5000000000000004, -11.7, -3.2000000000000006, -3.500000000000001, -3.500000000000001, -10.3, -3.700000000000001, -3.4000000000000004, -10.2, -3.500000000000001, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -11.6, -3.2, -3.500000000000001, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.700000000000001, -3.700000000000001, -3.5000000000000004, -10.3, -10.7, -3.5000000000000004, -3.400000000000001, -3.6000000000000005, -3.5000000000000004, -3.500000000000001, -3.5000000000000004, -3.6000000000000005, -3.1000000000000005, -12.3, -3.500000000000001, -10.2, -3.6000000000000005, -3.600000000000001, -3.2000000000000006, -3.3000000000000007, -11.9, -3.7000000000000006, -10.2, -10.0, -3.400000000000001, -3.500000000000001, -3.3000000000000007, -3.1000000000000005, -11.3, -10.4, -3.500000000000001, -3.2000000000000006, -3.7000000000000006, -3.500000000000001, -3.5000000000000013, -3.2000000000000006, -3.600000000000001, -3.500000000000001, -3.600000000000001, -3.600000000000001, -3.500000000000001, -3.7000000000000006, -3.3000000000000007, -10.4, -10.4, -10.7, -10.1, -3.2000000000000006, -3.500000000000001, -3.7000000000000006, -11.9, -3.3000000000000007, -3.500000000000001, -10.0, -10.8, -3.500000000000001, -3.7000000000000006, -3.5000000000000004, -11.6, -11.2, -3.3000000000000003, -3.400000000000001, -11.3, -10.5, -3.500000000000001, -3.400000000000001, -3.4000000000000004, -3.400000000000001, -3.3000000000000007, -3.700000000000001, -3.700000000000001, -3.1000000000000005, -3.4000000000000004, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -11.1, -3.600000000000001, -3.500000000000001, -3.4000000000000004, -3.400000000000001, -3.500000000000001, -3.3000000000000003, -3.400000000000001, -3.3000000000000007, -3.500000000000001, -3.8000000000000007, -3.8000000000000007, -3.5000000000000004, 97.7, -3.5000000000000004, -10.1, -3.6000000000000005, -3.2, -3.3000000000000003, -3.3000000000000007, -10.6, -10.3, -11.5, -11.5, -3.400000000000001, -3.400000000000001, -3.500000000000001, -3.6000000000000005, -3.500000000000001, -10.7, -3.3000000000000007, -3.3000000000000007, -11.4, -11.7, -3.4000000000000004, -3.6000000000000005, -3.4000000000000004, -3.4000000000000004, -3.4000000000000004, -3.500000000000001, -3.1000000000000005, -3.3000000000000007, -3.500000000000001, -3.400000000000001, -11.9, -3.2000000000000006, -3.400000000000001, -3.7000000000000006, -3.7000000000000006, -3.5000000000000004, -11.9, -3.700000000000001, -11.5, -3.800000000000001, -3.300000000000001, -3.2000000000000006, -3.3000000000000007, -3.500000000000001, -3.400000000000001, -3.2, -3.100000000000001, -3.5000000000000013, -3.6000000000000005], "episode_lengths": [21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 12, 13, 21, 21, 21, 21, 21, 4, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 1, 21, 21, 14, 21, 21, 21, 21, 15, 21, 21, 21, 4, 21, 21, 3, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 4, 7, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 3, 21, 21, 21, 21, 16, 21, 3, 1, 21, 21, 21, 21, 12, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 5, 8, 2, 21, 21, 21, 19, 21, 21, 1, 9, 21, 21, 21, 16, 11, 21, 21, 12, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 2, 21, 21, 21, 21, 7, 4, 14, 14, 21, 21, 21, 21, 21, 7, 21, 21, 12, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 17, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.37115786088569, "mean_inference_ms": 17.360914467231645, "mean_action_processing_ms": 0.9450031313863936, "mean_env_wait_ms": 2.150370353876158, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07603279379911201, "StateBufferConnector_ms": 0.010075901829919149, "ViewRequirementAgentConnector_ms": 0.14071020969124728}}, "episode_reward_max": 97.7, "episode_reward_min": -12.3, "episode_reward_mean": -4.573023255813954, "episode_len_mean": 18.474418604651163, "episodes_this_iter": 215, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.5000000000000004, -3.300000000000001, -3.500000000000001, -10.1, -3.7000000000000006, -3.3000000000000007, -3.6, -3.3000000000000003, -3.4000000000000004, -3.4000000000000004, -3.5000000000000013, -3.400000000000001, -11.6, -11.2, -3.400000000000001, -3.2000000000000006, -3.5000000000000004, -3.3000000000000007, -3.4000000000000012, -10.4, -11.7, -3.3000000000000007, -3.400000000000001, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.500000000000001, -3.400000000000001, -3.6000000000000005, -3.7000000000000006, -3.2000000000000006, -11.3, -3.2, -3.600000000000001, -3.4000000000000004, -3.500000000000001, -11.9, -3.400000000000001, -3.600000000000001, -3.400000000000001, -3.500000000000001, -3.4000000000000004, -3.300000000000001, -3.400000000000001, -10.3, -3.2, -3.600000000000001, -3.3000000000000007, -10.0, -3.5000000000000004, -3.400000000000001, -11.7, -3.600000000000001, -3.500000000000001, -3.400000000000001, -3.5000000000000004, -11.7, -3.2000000000000006, -3.500000000000001, -3.500000000000001, -10.3, -3.700000000000001, -3.4000000000000004, -10.2, -3.500000000000001, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -11.6, -3.2, -3.500000000000001, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.700000000000001, -3.700000000000001, -3.5000000000000004, -10.3, -10.7, -3.5000000000000004, -3.400000000000001, -3.6000000000000005, -3.5000000000000004, -3.500000000000001, -3.5000000000000004, -3.6000000000000005, -3.1000000000000005, -12.3, -3.500000000000001, -10.2, -3.6000000000000005, -3.600000000000001, -3.2000000000000006, -3.3000000000000007, -11.9, -3.7000000000000006, -10.2, -10.0, -3.400000000000001, -3.500000000000001, -3.3000000000000007, -3.1000000000000005, -11.3, -10.4, -3.500000000000001, -3.2000000000000006, -3.7000000000000006, -3.500000000000001, -3.5000000000000013, -3.2000000000000006, -3.600000000000001, -3.500000000000001, -3.600000000000001, -3.600000000000001, -3.500000000000001, -3.7000000000000006, -3.3000000000000007, -10.4, -10.4, -10.7, -10.1, -3.2000000000000006, -3.500000000000001, -3.7000000000000006, -11.9, -3.3000000000000007, -3.500000000000001, -10.0, -10.8, -3.500000000000001, -3.7000000000000006, -3.5000000000000004, -11.6, -11.2, -3.3000000000000003, -3.400000000000001, -11.3, -10.5, -3.500000000000001, -3.400000000000001, -3.4000000000000004, -3.400000000000001, -3.3000000000000007, -3.700000000000001, -3.700000000000001, -3.1000000000000005, -3.4000000000000004, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -11.1, -3.600000000000001, -3.500000000000001, -3.4000000000000004, -3.400000000000001, -3.500000000000001, -3.3000000000000003, -3.400000000000001, -3.3000000000000007, -3.500000000000001, -3.8000000000000007, -3.8000000000000007, -3.5000000000000004, 97.7, -3.5000000000000004, -10.1, -3.6000000000000005, -3.2, -3.3000000000000003, -3.3000000000000007, -10.6, -10.3, -11.5, -11.5, -3.400000000000001, -3.400000000000001, -3.500000000000001, -3.6000000000000005, -3.500000000000001, -10.7, -3.3000000000000007, -3.3000000000000007, -11.4, -11.7, -3.4000000000000004, -3.6000000000000005, -3.4000000000000004, -3.4000000000000004, -3.4000000000000004, -3.500000000000001, -3.1000000000000005, -3.3000000000000007, -3.500000000000001, -3.400000000000001, -11.9, -3.2000000000000006, -3.400000000000001, -3.7000000000000006, -3.7000000000000006, -3.5000000000000004, -11.9, -3.700000000000001, -11.5, -3.800000000000001, -3.300000000000001, -3.2000000000000006, -3.3000000000000007, -3.500000000000001, -3.400000000000001, -3.2, -3.100000000000001, -3.5000000000000013, -3.6000000000000005], "episode_lengths": [21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 12, 13, 21, 21, 21, 21, 21, 4, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 1, 21, 21, 14, 21, 21, 21, 21, 15, 21, 21, 21, 4, 21, 21, 3, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 4, 7, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 3, 21, 21, 21, 21, 16, 21, 3, 1, 21, 21, 21, 21, 12, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 5, 8, 2, 21, 21, 21, 19, 21, 21, 1, 9, 21, 21, 21, 16, 11, 21, 21, 12, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 2, 21, 21, 21, 21, 7, 4, 14, 14, 21, 21, 21, 21, 21, 7, 21, 21, 12, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 17, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.37115786088569, "mean_inference_ms": 17.360914467231645, "mean_action_processing_ms": 0.9450031313863936, "mean_env_wait_ms": 2.150370353876158, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07603279379911201, "StateBufferConnector_ms": 0.010075901829919149, "ViewRequirementAgentConnector_ms": 0.14071020969124728}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 170950.407, "load_time_ms": 0.936, "load_throughput": 4272272.982, "learn_time_ms": 169939.275, "learn_throughput": 23.538, "synch_weights_time_ms": 177.256}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "episodes_total": 1505, "training_iteration": 7, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-06_21-15-41", "timestamp": 1680808541, "time_this_iter_s": 171.76581573486328, "time_total_s": 1196.7397661209106, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476bcd60>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0147604d30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 1196.7397661209106, "timesteps_since_restore": 0, "iterations_since_restore": 7, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.580327868852459, "ram_util_percent": 23.50491803278689}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2775062251796006, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.0010000000000000005, "total_loss": 0.8419452537892647, "policy_loss": -0.12583643174930526, "vf_loss": 0.9334466378254596, "vf_explained_var": 0.3729871016035798, "kl": 0.022607443577256955, "entropy": 3.9852689873787663, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6975.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.5, "episode_reward_mean": -5.119811320754717, "episode_len_mean": 18.943396226415093, "episode_media": {}, "episodes_this_iter": 212, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.400000000000001, -11.5, -3.5000000000000004, -12.4, -3.4000000000000004, -11.7, -10.2, -10.9, -10.8, -3.400000000000001, -12.0, -10.0, -3.3000000000000007, -3.400000000000001, -3.7000000000000006, -3.900000000000001, -3.5000000000000004, -3.2000000000000006, -3.5000000000000004, -3.6000000000000005, -3.3000000000000007, -3.6000000000000005, -12.5, -3.6000000000000005, -3.3000000000000007, -10.8, -3.6000000000000005, -3.700000000000001, -10.0, -3.2000000000000006, -3.500000000000001, -3.6000000000000005, -3.600000000000001, -11.1, -3.800000000000001, -10.1, -3.8000000000000007, -3.500000000000001, -11.5, -3.700000000000001, -3.600000000000001, -11.3, -3.200000000000001, -3.2000000000000006, -3.700000000000001, -3.5000000000000004, -3.3000000000000007, -3.500000000000001, -11.9, -3.800000000000001, -11.8, -3.6000000000000005, -3.3000000000000007, -3.500000000000001, -11.6, -11.7, -11.3, -3.200000000000001, -3.500000000000001, -3.3000000000000007, -3.7000000000000006, -3.7000000000000015, -12.0, -3.500000000000001, -3.4000000000000004, -11.7, -3.500000000000001, -3.7000000000000006, -3.3000000000000003, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.700000000000001, -3.500000000000001, -3.7000000000000006, -3.3000000000000007, -3.800000000000001, -3.3000000000000007, -11.5, -11.0, -3.6000000000000005, -3.3000000000000007, -3.600000000000001, -11.9, -3.700000000000001, -3.600000000000001, -3.700000000000001, -3.4000000000000012, -3.5000000000000004, -3.2000000000000006, -3.7000000000000006, -3.500000000000001, -3.3000000000000003, -10.2, -3.6000000000000005, -3.400000000000001, -10.2, -3.900000000000001, -3.400000000000001, -3.4000000000000004, -3.5000000000000004, -3.500000000000001, -3.400000000000001, -10.5, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.5000000000000004, -10.1, -10.1, -3.7000000000000006, -3.3000000000000007, -3.800000000000001, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.7000000000000006, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -11.8, -3.4000000000000004, -3.3000000000000007, -3.7000000000000006, -3.400000000000001, -3.400000000000001, -3.5000000000000004, -3.400000000000001, -3.800000000000001, -3.4000000000000012, -3.3000000000000007, -3.500000000000001, -3.500000000000001, -3.400000000000001, -3.500000000000001, -11.0, -3.500000000000001, -3.600000000000001, -3.5000000000000013, -3.500000000000001, -3.3000000000000007, -3.3000000000000007, -3.500000000000001, -3.2000000000000006, -3.1000000000000005, -3.600000000000001, -3.500000000000001, -3.500000000000001, -3.1000000000000005, -3.3000000000000003, -3.0000000000000004, -3.400000000000001, -3.5000000000000004, -11.5, -12.4, -3.5000000000000004, -3.500000000000001, -3.7000000000000006, -3.600000000000001, -3.3000000000000007, -10.4, -3.5000000000000004, -3.400000000000001, -10.6, -11.1, -3.400000000000001, -3.700000000000001, -3.8000000000000007, -3.2000000000000006, -12.3, -10.2, -12.3, -11.9, -3.5000000000000004, -3.5000000000000004, -3.400000000000001, -3.400000000000001, -3.4, -3.5000000000000013, -3.400000000000001, -3.5000000000000004, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.6000000000000005, -3.3000000000000007, -3.500000000000001, -3.4000000000000004, -3.3000000000000007, -3.7000000000000006, -3.8000000000000007, -3.8000000000000007, -3.4000000000000004, -3.400000000000001, -3.5000000000000004, -4.000000000000001, -11.8, -11.8, -3.2000000000000006, -3.400000000000001, -3.5000000000000004, -3.700000000000001, -3.5000000000000004, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -10.8, -3.2000000000000006, -11.3, -3.7000000000000006], "episode_lengths": [21, 10, 21, 19, 21, 16, 3, 9, 9, 21, 16, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 8, 21, 21, 1, 21, 21, 21, 21, 10, 21, 2, 21, 21, 15, 21, 21, 13, 21, 21, 21, 21, 21, 21, 18, 21, 16, 21, 21, 21, 14, 16, 11, 21, 21, 21, 21, 21, 18, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 10, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 3, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 2, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 19, 21, 21, 21, 21, 21, 5, 21, 21, 7, 10, 21, 21, 21, 21, 19, 3, 19, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 13, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.380586120541095, "mean_inference_ms": 17.375290778014918, "mean_action_processing_ms": 0.9408054130515753, "mean_env_wait_ms": 2.138645801512896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07160092299839235, "StateBufferConnector_ms": 0.009467916668586011, "ViewRequirementAgentConnector_ms": 0.13318365474916855}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.5, "episode_reward_mean": -5.119811320754717, "episode_len_mean": 18.943396226415093, "episodes_this_iter": 212, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.400000000000001, -11.5, -3.5000000000000004, -12.4, -3.4000000000000004, -11.7, -10.2, -10.9, -10.8, -3.400000000000001, -12.0, -10.0, -3.3000000000000007, -3.400000000000001, -3.7000000000000006, -3.900000000000001, -3.5000000000000004, -3.2000000000000006, -3.5000000000000004, -3.6000000000000005, -3.3000000000000007, -3.6000000000000005, -12.5, -3.6000000000000005, -3.3000000000000007, -10.8, -3.6000000000000005, -3.700000000000001, -10.0, -3.2000000000000006, -3.500000000000001, -3.6000000000000005, -3.600000000000001, -11.1, -3.800000000000001, -10.1, -3.8000000000000007, -3.500000000000001, -11.5, -3.700000000000001, -3.600000000000001, -11.3, -3.200000000000001, -3.2000000000000006, -3.700000000000001, -3.5000000000000004, -3.3000000000000007, -3.500000000000001, -11.9, -3.800000000000001, -11.8, -3.6000000000000005, -3.3000000000000007, -3.500000000000001, -11.6, -11.7, -11.3, -3.200000000000001, -3.500000000000001, -3.3000000000000007, -3.7000000000000006, -3.7000000000000015, -12.0, -3.500000000000001, -3.4000000000000004, -11.7, -3.500000000000001, -3.7000000000000006, -3.3000000000000003, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.700000000000001, -3.500000000000001, -3.7000000000000006, -3.3000000000000007, -3.800000000000001, -3.3000000000000007, -11.5, -11.0, -3.6000000000000005, -3.3000000000000007, -3.600000000000001, -11.9, -3.700000000000001, -3.600000000000001, -3.700000000000001, -3.4000000000000012, -3.5000000000000004, -3.2000000000000006, -3.7000000000000006, -3.500000000000001, -3.3000000000000003, -10.2, -3.6000000000000005, -3.400000000000001, -10.2, -3.900000000000001, -3.400000000000001, -3.4000000000000004, -3.5000000000000004, -3.500000000000001, -3.400000000000001, -10.5, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.5000000000000004, -10.1, -10.1, -3.7000000000000006, -3.3000000000000007, -3.800000000000001, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.7000000000000006, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -11.8, -3.4000000000000004, -3.3000000000000007, -3.7000000000000006, -3.400000000000001, -3.400000000000001, -3.5000000000000004, -3.400000000000001, -3.800000000000001, -3.4000000000000012, -3.3000000000000007, -3.500000000000001, -3.500000000000001, -3.400000000000001, -3.500000000000001, -11.0, -3.500000000000001, -3.600000000000001, -3.5000000000000013, -3.500000000000001, -3.3000000000000007, -3.3000000000000007, -3.500000000000001, -3.2000000000000006, -3.1000000000000005, -3.600000000000001, -3.500000000000001, -3.500000000000001, -3.1000000000000005, -3.3000000000000003, -3.0000000000000004, -3.400000000000001, -3.5000000000000004, -11.5, -12.4, -3.5000000000000004, -3.500000000000001, -3.7000000000000006, -3.600000000000001, -3.3000000000000007, -10.4, -3.5000000000000004, -3.400000000000001, -10.6, -11.1, -3.400000000000001, -3.700000000000001, -3.8000000000000007, -3.2000000000000006, -12.3, -10.2, -12.3, -11.9, -3.5000000000000004, -3.5000000000000004, -3.400000000000001, -3.400000000000001, -3.4, -3.5000000000000013, -3.400000000000001, -3.5000000000000004, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.6000000000000005, -3.3000000000000007, -3.500000000000001, -3.4000000000000004, -3.3000000000000007, -3.7000000000000006, -3.8000000000000007, -3.8000000000000007, -3.4000000000000004, -3.400000000000001, -3.5000000000000004, -4.000000000000001, -11.8, -11.8, -3.2000000000000006, -3.400000000000001, -3.5000000000000004, -3.700000000000001, -3.5000000000000004, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -10.8, -3.2000000000000006, -11.3, -3.7000000000000006], "episode_lengths": [21, 10, 21, 19, 21, 16, 3, 9, 9, 21, 16, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 8, 21, 21, 1, 21, 21, 21, 21, 10, 21, 2, 21, 21, 15, 21, 21, 13, 21, 21, 21, 21, 21, 21, 18, 21, 16, 21, 21, 21, 14, 16, 11, 21, 21, 21, 21, 21, 18, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 10, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 3, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 2, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 19, 21, 21, 21, 21, 21, 5, 21, 21, 7, 10, 21, 21, 21, 21, 19, 3, 19, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 13, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.380586120541095, "mean_inference_ms": 17.375290778014918, "mean_action_processing_ms": 0.9408054130515753, "mean_env_wait_ms": 2.138645801512896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07160092299839235, "StateBufferConnector_ms": 0.009467916668586011, "ViewRequirementAgentConnector_ms": 0.13318365474916855}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 171081.938, "load_time_ms": 0.964, "load_throughput": 4148412.19, "learn_time_ms": 169957.125, "learn_throughput": 23.535, "synch_weights_time_ms": 177.277}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "episodes_total": 1717, "training_iteration": 8, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-06_21-18-34", "timestamp": 1680808714, "time_this_iter_s": 172.01417660713196, "time_total_s": 1368.7539427280426, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476f2250>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01475fc820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 1368.7539427280426, "timesteps_since_restore": 0, "iterations_since_restore": 8, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.353061224489796, "ram_util_percent": 23.50040816326531}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1722154708639267, "cur_kl_coeff": 2.2781249999999993, "cur_lr": 0.0010000000000000005, "total_loss": 0.7089853786377697, "policy_loss": -0.04687845019964121, "vf_loss": 0.7382435004647461, "vf_explained_var": 0.39827402939078627, "kl": 0.007734573300945402, "entropy": 3.9849238429018246, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7905.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": 98.9, "episode_reward_min": -12.5, "episode_reward_mean": -3.8202970297029704, "episode_len_mean": 19.198019801980198, "episode_media": {}, "episodes_this_iter": 202, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.6, -3.400000000000001, -3.400000000000001, -3.4000000000000012, -3.500000000000001, -3.700000000000001, -3.5000000000000004, -3.2, -3.6000000000000005, -11.5, -3.500000000000001, -3.500000000000001, -3.6000000000000005, -10.4, -3.700000000000001, -3.600000000000001, -3.3000000000000007, -3.400000000000001, -3.6000000000000005, -3.400000000000001, -11.4, -3.600000000000001, -3.100000000000001, -3.6000000000000005, -10.8, -3.3000000000000003, -10.7, -3.4000000000000004, -3.500000000000001, -3.6000000000000005, -3.4000000000000012, -3.3000000000000007, -3.6000000000000005, -3.5000000000000004, -3.3000000000000007, -3.5000000000000004, -11.6, -11.2, -3.4000000000000004, -3.4000000000000004, -3.500000000000001, -3.5000000000000004, -3.2, -3.500000000000001, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.6000000000000005, -10.5, -11.2, -3.600000000000001, -3.800000000000001, -3.3000000000000007, -3.5000000000000004, -3.4000000000000004, -3.6000000000000005, -3.6000000000000005, -3.2000000000000006, 98.1, -3.500000000000001, -3.500000000000001, -3.3000000000000003, -3.700000000000001, -3.400000000000001, -3.600000000000001, -12.3, -3.6000000000000005, -3.500000000000001, -3.500000000000001, -3.5000000000000013, -10.9, -3.400000000000001, -10.9, -3.3000000000000007, -12.2, -3.600000000000001, -3.3000000000000007, -3.500000000000001, -3.400000000000001, -3.6000000000000005, -3.3000000000000007, -12.3, -11.4, -3.0000000000000004, -10.5, -10.0, -3.400000000000001, -3.6000000000000005, -3.600000000000001, -10.5, -11.9, -10.9, -10.6, -3.300000000000001, -10.0, 98.9, -3.3000000000000007, -3.4000000000000004, -3.3000000000000003, -3.4000000000000004, -10.9, -10.5, -3.500000000000001, -3.5000000000000004, -3.2000000000000006, -3.1000000000000005, -3.800000000000001, -3.4000000000000012, -3.3000000000000003, -3.600000000000001, -3.400000000000001, -3.500000000000001, -3.600000000000001, -3.2000000000000006, -3.7000000000000006, -3.400000000000001, -3.4000000000000004, -11.9, -3.3000000000000003, -3.7000000000000006, -3.3000000000000003, -10.5, -11.0, -3.600000000000001, -3.5000000000000004, -3.600000000000001, -3.3000000000000007, -3.4000000000000004, -3.3000000000000007, -3.500000000000001, -3.500000000000001, -3.5000000000000004, -3.400000000000001, -3.500000000000001, -3.2000000000000006, -3.400000000000001, -3.500000000000001, -3.4000000000000004, -3.400000000000001, -3.8000000000000007, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.6000000000000005, -10.2, -3.6000000000000005, -3.500000000000001, -3.7000000000000006, -3.400000000000001, -3.400000000000001, -12.1, -12.200000000000001, -3.500000000000001, -3.200000000000001, -3.400000000000001, -3.600000000000001, -3.3000000000000007, -11.2, -3.5000000000000004, -11.3, -3.7000000000000006, -3.2000000000000006, -3.5000000000000004, -3.2000000000000006, -10.5, -3.5000000000000004, -12.5, -3.6000000000000005, -3.3000000000000007, -3.500000000000001, -3.600000000000001, -3.5000000000000004, -3.600000000000001, -3.600000000000001, -3.500000000000001, -12.4, -3.4000000000000004, -3.5000000000000004, -3.3000000000000007, -3.600000000000001, -3.3000000000000003, -3.1000000000000005, -3.5000000000000004, -3.1000000000000005, -3.600000000000001, -3.500000000000001, -3.600000000000001, -3.5000000000000013, -3.6000000000000005, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.7000000000000006, -3.5000000000000013, -3.400000000000001, -3.400000000000001, -3.800000000000001, -3.600000000000001, -3.600000000000001, -3.7000000000000006, -3.2000000000000006], "episode_lengths": [14, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 9, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 11, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 9, 21, 9, 21, 17, 21, 21, 21, 21, 21, 21, 19, 12, 21, 6, 1, 21, 21, 21, 6, 16, 10, 7, 21, 1, 12, 21, 21, 21, 21, 9, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 6, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 20, 18, 21, 21, 21, 21, 21, 12, 21, 13, 21, 21, 21, 21, 6, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.413961324811236, "mean_inference_ms": 17.39914809436129, "mean_action_processing_ms": 0.9342310341369217, "mean_env_wait_ms": 2.1256744049745855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07440123227563235, "StateBufferConnector_ms": 0.009130723405592513, "ViewRequirementAgentConnector_ms": 0.13401036215300607}}, "episode_reward_max": 98.9, "episode_reward_min": -12.5, "episode_reward_mean": -3.8202970297029704, "episode_len_mean": 19.198019801980198, "episodes_this_iter": 202, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11.6, -3.400000000000001, -3.400000000000001, -3.4000000000000012, -3.500000000000001, -3.700000000000001, -3.5000000000000004, -3.2, -3.6000000000000005, -11.5, -3.500000000000001, -3.500000000000001, -3.6000000000000005, -10.4, -3.700000000000001, -3.600000000000001, -3.3000000000000007, -3.400000000000001, -3.6000000000000005, -3.400000000000001, -11.4, -3.600000000000001, -3.100000000000001, -3.6000000000000005, -10.8, -3.3000000000000003, -10.7, -3.4000000000000004, -3.500000000000001, -3.6000000000000005, -3.4000000000000012, -3.3000000000000007, -3.6000000000000005, -3.5000000000000004, -3.3000000000000007, -3.5000000000000004, -11.6, -11.2, -3.4000000000000004, -3.4000000000000004, -3.500000000000001, -3.5000000000000004, -3.2, -3.500000000000001, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.6000000000000005, -10.5, -11.2, -3.600000000000001, -3.800000000000001, -3.3000000000000007, -3.5000000000000004, -3.4000000000000004, -3.6000000000000005, -3.6000000000000005, -3.2000000000000006, 98.1, -3.500000000000001, -3.500000000000001, -3.3000000000000003, -3.700000000000001, -3.400000000000001, -3.600000000000001, -12.3, -3.6000000000000005, -3.500000000000001, -3.500000000000001, -3.5000000000000013, -10.9, -3.400000000000001, -10.9, -3.3000000000000007, -12.2, -3.600000000000001, -3.3000000000000007, -3.500000000000001, -3.400000000000001, -3.6000000000000005, -3.3000000000000007, -12.3, -11.4, -3.0000000000000004, -10.5, -10.0, -3.400000000000001, -3.6000000000000005, -3.600000000000001, -10.5, -11.9, -10.9, -10.6, -3.300000000000001, -10.0, 98.9, -3.3000000000000007, -3.4000000000000004, -3.3000000000000003, -3.4000000000000004, -10.9, -10.5, -3.500000000000001, -3.5000000000000004, -3.2000000000000006, -3.1000000000000005, -3.800000000000001, -3.4000000000000012, -3.3000000000000003, -3.600000000000001, -3.400000000000001, -3.500000000000001, -3.600000000000001, -3.2000000000000006, -3.7000000000000006, -3.400000000000001, -3.4000000000000004, -11.9, -3.3000000000000003, -3.7000000000000006, -3.3000000000000003, -10.5, -11.0, -3.600000000000001, -3.5000000000000004, -3.600000000000001, -3.3000000000000007, -3.4000000000000004, -3.3000000000000007, -3.500000000000001, -3.500000000000001, -3.5000000000000004, -3.400000000000001, -3.500000000000001, -3.2000000000000006, -3.400000000000001, -3.500000000000001, -3.4000000000000004, -3.400000000000001, -3.8000000000000007, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.6000000000000005, -10.2, -3.6000000000000005, -3.500000000000001, -3.7000000000000006, -3.400000000000001, -3.400000000000001, -12.1, -12.200000000000001, -3.500000000000001, -3.200000000000001, -3.400000000000001, -3.600000000000001, -3.3000000000000007, -11.2, -3.5000000000000004, -11.3, -3.7000000000000006, -3.2000000000000006, -3.5000000000000004, -3.2000000000000006, -10.5, -3.5000000000000004, -12.5, -3.6000000000000005, -3.3000000000000007, -3.500000000000001, -3.600000000000001, -3.5000000000000004, -3.600000000000001, -3.600000000000001, -3.500000000000001, -12.4, -3.4000000000000004, -3.5000000000000004, -3.3000000000000007, -3.600000000000001, -3.3000000000000003, -3.1000000000000005, -3.5000000000000004, -3.1000000000000005, -3.600000000000001, -3.500000000000001, -3.600000000000001, -3.5000000000000013, -3.6000000000000005, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.7000000000000006, -3.5000000000000013, -3.400000000000001, -3.400000000000001, -3.800000000000001, -3.600000000000001, -3.600000000000001, -3.7000000000000006, -3.2000000000000006], "episode_lengths": [14, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 9, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 11, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 9, 21, 9, 21, 17, 21, 21, 21, 21, 21, 21, 19, 12, 21, 6, 1, 21, 21, 21, 6, 16, 10, 7, 21, 1, 12, 21, 21, 21, 21, 9, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 6, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 20, 18, 21, 21, 21, 21, 21, 12, 21, 13, 21, 21, 21, 21, 6, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.413961324811236, "mean_inference_ms": 17.39914809436129, "mean_action_processing_ms": 0.9342310341369217, "mean_env_wait_ms": 2.1256744049745855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07440123227563235, "StateBufferConnector_ms": 0.009130723405592513, "ViewRequirementAgentConnector_ms": 0.13401036215300607}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 171034.443, "load_time_ms": 0.993, "load_throughput": 4028250.56, "learn_time_ms": 169927.485, "learn_throughput": 23.539, "synch_weights_time_ms": 179.737}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 1919, "training_iteration": 9, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-06_21-21-24", "timestamp": 1680808884, "time_this_iter_s": 170.66561603546143, "time_total_s": 1539.419558763504, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476cb550>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0147604d30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 1539.419558763504, "timesteps_since_restore": 0, "iterations_since_restore": 9, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.494214876033058, "ram_util_percent": 23.487603305785125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8044559877566112, "cur_kl_coeff": 2.2781249999999993, "cur_lr": 0.0010000000000000005, "total_loss": 0.7206411782231542, "policy_loss": -0.06410639565187677, "vf_loss": 0.7606203643064345, "vf_explained_var": 0.3362974263647551, "kl": 0.010590816566987234, "entropy": 3.9737802836202807, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8835.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "sampler_results": {"episode_reward_max": 99.3, "episode_reward_min": -12.5, "episode_reward_mean": -4.463720930232558, "episode_len_mean": 18.76279069767442, "episode_media": {}, "episodes_this_iter": 215, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.6000000000000005, -3.400000000000001, -3.400000000000001, -3.400000000000001, -3.2000000000000006, -3.6000000000000005, -12.100000000000001, -3.3000000000000007, -3.400000000000001, -3.500000000000001, -10.4, -3.1000000000000005, -3.3000000000000007, -3.500000000000001, -3.500000000000001, -3.6000000000000005, -3.1000000000000005, -3.4000000000000004, -3.3000000000000007, -3.700000000000001, -3.500000000000001, -10.5, -3.1000000000000005, -11.9, -3.300000000000001, -10.6, -3.7000000000000006, -10.3, -10.8, -3.4000000000000004, -10.6, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.3000000000000003, -3.4000000000000004, -12.5, -3.3000000000000003, -11.3, -3.3000000000000007, -3.5000000000000004, -11.0, -11.0, -3.500000000000001, -3.500000000000001, -3.5000000000000004, -3.700000000000001, -11.6, -3.3000000000000007, -11.5, -3.3000000000000007, -3.400000000000001, -12.100000000000001, -3.400000000000001, -3.400000000000001, -3.5000000000000004, -12.4, -3.500000000000001, -3.3000000000000007, -3.3000000000000003, -3.600000000000001, -3.3000000000000003, -3.4000000000000004, -11.5, -3.500000000000001, -3.6000000000000005, -3.6000000000000005, -3.200000000000001, -3.3000000000000003, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.500000000000001, -3.300000000000001, -3.500000000000001, -4.000000000000001, -3.2000000000000006, -3.400000000000001, -3.300000000000001, -3.400000000000001, -4.000000000000001, -3.800000000000001, -10.2, -3.5000000000000004, -3.3000000000000003, -11.5, -10.4, 99.3, -10.6, -3.500000000000001, -11.3, -3.3000000000000003, -10.6, -3.2, -3.6000000000000014, -10.8, -3.500000000000001, -3.4000000000000004, -10.7, -3.3000000000000007, -3.1000000000000005, -3.500000000000001, -10.2, -3.400000000000001, -10.0, -10.0, -3.1000000000000005, -3.2000000000000006, -3.600000000000001, -3.8000000000000007, -10.1, -3.600000000000001, -3.3000000000000007, -3.2, -3.900000000000001, -3.3000000000000007, -3.700000000000001, -3.5000000000000013, -3.3000000000000007, -3.500000000000001, -3.6000000000000005, -3.500000000000001, -10.5, -3.700000000000001, -3.300000000000001, -3.2000000000000006, -3.6000000000000005, -3.5000000000000004, -3.4000000000000004, -3.400000000000001, -3.400000000000001, -3.300000000000001, -3.3000000000000003, -3.400000000000001, -3.2000000000000006, -3.5000000000000004, -3.300000000000001, -3.2000000000000006, -3.400000000000001, -3.6000000000000005, -3.6000000000000005, -3.3000000000000007, -3.600000000000001, -11.7, -10.5, -3.2000000000000006, -3.2000000000000006, -3.6000000000000005, -3.400000000000001, -10.7, -3.4000000000000004, -3.6, -3.300000000000001, -3.400000000000001, -11.9, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.400000000000001, -3.600000000000001, -3.4000000000000004, -3.200000000000001, -3.700000000000001, -3.400000000000001, -3.600000000000001, -10.7, -3.2000000000000006, -3.3000000000000003, -3.200000000000001, -11.2, -3.500000000000001, -3.3000000000000007, -3.300000000000001, -12.100000000000001, -3.5000000000000004, -3.1000000000000005, -3.3000000000000007, -3.4000000000000004, -3.1000000000000005, -3.6000000000000005, -3.500000000000001, -3.500000000000001, -3.3000000000000003, -3.400000000000001, -11.0, -11.1, -3.3000000000000003, -3.500000000000001, -3.4000000000000004, -3.500000000000001, -3.600000000000001, -11.8, -3.600000000000001, -3.4000000000000004, -3.4000000000000004, -3.3000000000000007, -3.5000000000000004, -3.6000000000000005, -3.800000000000001, -11.4, -3.3000000000000003, -3.400000000000001, -10.7, -3.700000000000001, -3.4000000000000012, -3.7000000000000006, -3.0000000000000004, -3.500000000000001, -10.9, -3.500000000000001, -3.400000000000001, -3.5000000000000004], "episode_lengths": [21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 18, 21, 7, 21, 4, 8, 21, 7, 21, 21, 21, 21, 21, 21, 20, 21, 13, 21, 21, 11, 10, 21, 21, 21, 21, 15, 21, 15, 21, 21, 19, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 14, 4, 8, 7, 21, 13, 21, 6, 21, 21, 8, 21, 21, 7, 21, 21, 21, 3, 21, 1, 1, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 6, 21, 21, 21, 21, 8, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 12, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 11, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 7, 21, 21, 21, 21, 21, 9, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.421289221522958, "mean_inference_ms": 17.547831920979956, "mean_action_processing_ms": 0.9364129547221537, "mean_env_wait_ms": 2.1386091706102595, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08387044418689817, "StateBufferConnector_ms": 0.010691576225813045, "ViewRequirementAgentConnector_ms": 0.15019572058389352}}, "episode_reward_max": 99.3, "episode_reward_min": -12.5, "episode_reward_mean": -4.463720930232558, "episode_len_mean": 18.76279069767442, "episodes_this_iter": 215, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.6000000000000005, -3.400000000000001, -3.400000000000001, -3.400000000000001, -3.2000000000000006, -3.6000000000000005, -12.100000000000001, -3.3000000000000007, -3.400000000000001, -3.500000000000001, -10.4, -3.1000000000000005, -3.3000000000000007, -3.500000000000001, -3.500000000000001, -3.6000000000000005, -3.1000000000000005, -3.4000000000000004, -3.3000000000000007, -3.700000000000001, -3.500000000000001, -10.5, -3.1000000000000005, -11.9, -3.300000000000001, -10.6, -3.7000000000000006, -10.3, -10.8, -3.4000000000000004, -10.6, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.3000000000000003, -3.4000000000000004, -12.5, -3.3000000000000003, -11.3, -3.3000000000000007, -3.5000000000000004, -11.0, -11.0, -3.500000000000001, -3.500000000000001, -3.5000000000000004, -3.700000000000001, -11.6, -3.3000000000000007, -11.5, -3.3000000000000007, -3.400000000000001, -12.100000000000001, -3.400000000000001, -3.400000000000001, -3.5000000000000004, -12.4, -3.500000000000001, -3.3000000000000007, -3.3000000000000003, -3.600000000000001, -3.3000000000000003, -3.4000000000000004, -11.5, -3.500000000000001, -3.6000000000000005, -3.6000000000000005, -3.200000000000001, -3.3000000000000003, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.500000000000001, -3.300000000000001, -3.500000000000001, -4.000000000000001, -3.2000000000000006, -3.400000000000001, -3.300000000000001, -3.400000000000001, -4.000000000000001, -3.800000000000001, -10.2, -3.5000000000000004, -3.3000000000000003, -11.5, -10.4, 99.3, -10.6, -3.500000000000001, -11.3, -3.3000000000000003, -10.6, -3.2, -3.6000000000000014, -10.8, -3.500000000000001, -3.4000000000000004, -10.7, -3.3000000000000007, -3.1000000000000005, -3.500000000000001, -10.2, -3.400000000000001, -10.0, -10.0, -3.1000000000000005, -3.2000000000000006, -3.600000000000001, -3.8000000000000007, -10.1, -3.600000000000001, -3.3000000000000007, -3.2, -3.900000000000001, -3.3000000000000007, -3.700000000000001, -3.5000000000000013, -3.3000000000000007, -3.500000000000001, -3.6000000000000005, -3.500000000000001, -10.5, -3.700000000000001, -3.300000000000001, -3.2000000000000006, -3.6000000000000005, -3.5000000000000004, -3.4000000000000004, -3.400000000000001, -3.400000000000001, -3.300000000000001, -3.3000000000000003, -3.400000000000001, -3.2000000000000006, -3.5000000000000004, -3.300000000000001, -3.2000000000000006, -3.400000000000001, -3.6000000000000005, -3.6000000000000005, -3.3000000000000007, -3.600000000000001, -11.7, -10.5, -3.2000000000000006, -3.2000000000000006, -3.6000000000000005, -3.400000000000001, -10.7, -3.4000000000000004, -3.6, -3.300000000000001, -3.400000000000001, -11.9, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.400000000000001, -3.600000000000001, -3.4000000000000004, -3.200000000000001, -3.700000000000001, -3.400000000000001, -3.600000000000001, -10.7, -3.2000000000000006, -3.3000000000000003, -3.200000000000001, -11.2, -3.500000000000001, -3.3000000000000007, -3.300000000000001, -12.100000000000001, -3.5000000000000004, -3.1000000000000005, -3.3000000000000007, -3.4000000000000004, -3.1000000000000005, -3.6000000000000005, -3.500000000000001, -3.500000000000001, -3.3000000000000003, -3.400000000000001, -11.0, -11.1, -3.3000000000000003, -3.500000000000001, -3.4000000000000004, -3.500000000000001, -3.600000000000001, -11.8, -3.600000000000001, -3.4000000000000004, -3.4000000000000004, -3.3000000000000007, -3.5000000000000004, -3.6000000000000005, -3.800000000000001, -11.4, -3.3000000000000003, -3.400000000000001, -10.7, -3.700000000000001, -3.4000000000000012, -3.7000000000000006, -3.0000000000000004, -3.500000000000001, -10.9, -3.500000000000001, -3.400000000000001, -3.5000000000000004], "episode_lengths": [21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 18, 21, 7, 21, 4, 8, 21, 7, 21, 21, 21, 21, 21, 21, 20, 21, 13, 21, 21, 11, 10, 21, 21, 21, 21, 15, 21, 15, 21, 21, 19, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 14, 4, 8, 7, 21, 13, 21, 6, 21, 21, 8, 21, 21, 7, 21, 21, 21, 3, 21, 1, 1, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 6, 21, 21, 21, 21, 8, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 12, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 11, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 7, 21, 21, 21, 21, 21, 9, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.421289221522958, "mean_inference_ms": 17.547831920979956, "mean_action_processing_ms": 0.9364129547221537, "mean_env_wait_ms": 2.1386091706102595, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08387044418689817, "StateBufferConnector_ms": 0.010691576225813045, "ViewRequirementAgentConnector_ms": 0.15019572058389352}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 171078.58, "load_time_ms": 1.008, "load_throughput": 3966807.585, "learn_time_ms": 169969.899, "learn_throughput": 23.534, "synch_weights_time_ms": 192.93}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "episodes_total": 2134, "training_iteration": 10, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-06_21-24-16", "timestamp": 1680809056, "time_this_iter_s": 171.48719882965088, "time_total_s": 1710.906757593155, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476b9a60>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014785edc0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 1710.906757593155, "timesteps_since_restore": 0, "iterations_since_restore": 10, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.525819672131148, "ram_util_percent": 23.51844262295082}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.143431817956509, "cur_kl_coeff": 2.2781249999999993, "cur_lr": 0.0010000000000000005, "total_loss": 0.976813558203679, "policy_loss": -0.04534348246356052, "vf_loss": 0.9996526580323936, "vf_explained_var": 0.2769801898669171, "kl": 0.00987846858183583, "entropy": 3.9760519273819463, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 9765.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "sampler_results": {"episode_reward_max": 98.8, "episode_reward_min": -12.3, "episode_reward_mean": -4.129665071770336, "episode_len_mean": 19.148325358851675, "episode_media": {}, "episodes_this_iter": 209, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.400000000000001, -3.400000000000001, -11.4, -3.4000000000000004, -3.5000000000000004, -3.3000000000000007, -3.2000000000000006, -10.0, -3.3000000000000003, -3.500000000000001, -11.5, -3.4000000000000012, -3.8000000000000007, -3.5000000000000013, -3.600000000000001, -3.400000000000001, -3.400000000000001, -10.7, -3.2000000000000006, -3.5, -3.2000000000000006, -3.2000000000000006, -3.5000000000000004, -11.9, -3.500000000000001, -10.9, -10.4, -3.4000000000000012, -10.6, -10.7, -3.8000000000000007, -3.6000000000000005, -3.200000000000001, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.3000000000000003, -12.2, -3.500000000000001, -3.700000000000001, -3.800000000000001, -3.400000000000001, -11.4, -12.0, -12.3, -3.500000000000001, -3.7000000000000006, -3.2000000000000006, -3.4000000000000004, -11.6, -3.3000000000000007, -3.400000000000001, -3.4000000000000004, -3.400000000000001, -12.200000000000001, -3.500000000000001, -3.5000000000000004, -11.3, -11.6, -3.700000000000001, -3.3000000000000007, -3.2000000000000006, -3.600000000000001, -3.500000000000001, -10.8, -11.4, 98.8, -3.400000000000001, -4.000000000000002, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.500000000000001, 97.9, -3.4000000000000012, -11.8, -3.400000000000001, -3.3000000000000003, -11.4, -3.8000000000000007, -3.8000000000000007, -11.6, -3.3000000000000007, -12.3, -3.2000000000000006, -12.0, -3.700000000000001, -3.3000000000000003, -3.500000000000001, -3.400000000000001, -3.6000000000000005, -3.1000000000000005, -3.3000000000000007, -10.9, -3.500000000000001, -3.400000000000001, -3.500000000000001, -3.2000000000000006, -3.3000000000000007, -3.5, -3.5000000000000004, -10.8, -3.6000000000000005, -3.6000000000000005, -3.400000000000001, -3.400000000000001, -3.4000000000000004, -3.7000000000000006, -3.8000000000000007, -3.700000000000001, -3.300000000000001, -3.400000000000001, -3.6000000000000005, -3.5000000000000004, -3.500000000000001, -10.6, -3.6000000000000005, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.6000000000000005, -3.2000000000000006, -3.4000000000000012, -3.6000000000000005, -3.0000000000000004, -3.5000000000000004, -3.3000000000000007, -3.3000000000000007, -3.4000000000000004, -3.3000000000000007, -3.6000000000000005, -3.2000000000000006, -3.6, -3.5000000000000004, -3.6, -3.6000000000000005, -3.3000000000000003, -3.500000000000001, -12.3, -3.4000000000000004, -3.4000000000000004, -3.4000000000000004, -3.4000000000000012, -12.2, -3.4000000000000004, -10.3, -10.4, -12.3, -3.0000000000000004, -3.400000000000001, -10.3, -3.9000000000000012, -3.400000000000001, -3.500000000000001, -12.200000000000001, -3.500000000000001, -3.6000000000000005, -3.600000000000001, -3.3000000000000007, -3.200000000000001, -10.2, -10.4, -3.500000000000001, -3.2000000000000006, -3.7000000000000006, -11.9, -3.2000000000000006, -3.2000000000000006, -3.6, -3.2000000000000006, -3.6000000000000005, -11.3, -3.200000000000001, -3.600000000000001, -3.500000000000001, -10.7, -3.7000000000000006, -3.400000000000001, -3.4000000000000004, -3.400000000000001, -3.6000000000000005, -3.6000000000000005, -3.5000000000000013, -3.700000000000001, -3.4000000000000004, -3.500000000000001, -3.500000000000001, -10.1, -11.4, -12.3, -3.400000000000001, -3.4000000000000004, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.6000000000000014, -3.400000000000001, -3.5000000000000004, -3.5000000000000004, -12.100000000000001, -3.400000000000001, -3.500000000000001, -3.400000000000001, -3.500000000000001, -3.4000000000000004, -3.600000000000001, -12.0, -3.3000000000000007, -3.4000000000000004], "episode_lengths": [21, 21, 14, 21, 21, 21, 21, 1, 21, 21, 15, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 16, 21, 8, 4, 21, 6, 8, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 13, 15, 20, 21, 21, 21, 21, 16, 21, 21, 21, 21, 19, 21, 21, 14, 17, 21, 21, 21, 21, 21, 9, 15, 12, 21, 21, 21, 21, 21, 21, 19, 21, 16, 21, 21, 13, 21, 21, 15, 21, 20, 21, 18, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 20, 21, 4, 5, 18, 21, 21, 4, 21, 21, 21, 19, 21, 21, 21, 21, 21, 3, 5, 21, 21, 21, 17, 21, 21, 21, 21, 21, 11, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 13, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 20, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.439886383893763, "mean_inference_ms": 17.504708027612025, "mean_action_processing_ms": 0.9326363299480336, "mean_env_wait_ms": 2.1361653164560463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07259959809517746, "StateBufferConnector_ms": 0.009083747863769531, "ViewRequirementAgentConnector_ms": 0.13230919267572283}}, "episode_reward_max": 98.8, "episode_reward_min": -12.3, "episode_reward_mean": -4.129665071770336, "episode_len_mean": 19.148325358851675, "episodes_this_iter": 209, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.400000000000001, -3.400000000000001, -11.4, -3.4000000000000004, -3.5000000000000004, -3.3000000000000007, -3.2000000000000006, -10.0, -3.3000000000000003, -3.500000000000001, -11.5, -3.4000000000000012, -3.8000000000000007, -3.5000000000000013, -3.600000000000001, -3.400000000000001, -3.400000000000001, -10.7, -3.2000000000000006, -3.5, -3.2000000000000006, -3.2000000000000006, -3.5000000000000004, -11.9, -3.500000000000001, -10.9, -10.4, -3.4000000000000012, -10.6, -10.7, -3.8000000000000007, -3.6000000000000005, -3.200000000000001, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.3000000000000003, -12.2, -3.500000000000001, -3.700000000000001, -3.800000000000001, -3.400000000000001, -11.4, -12.0, -12.3, -3.500000000000001, -3.7000000000000006, -3.2000000000000006, -3.4000000000000004, -11.6, -3.3000000000000007, -3.400000000000001, -3.4000000000000004, -3.400000000000001, -12.200000000000001, -3.500000000000001, -3.5000000000000004, -11.3, -11.6, -3.700000000000001, -3.3000000000000007, -3.2000000000000006, -3.600000000000001, -3.500000000000001, -10.8, -11.4, 98.8, -3.400000000000001, -4.000000000000002, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.500000000000001, 97.9, -3.4000000000000012, -11.8, -3.400000000000001, -3.3000000000000003, -11.4, -3.8000000000000007, -3.8000000000000007, -11.6, -3.3000000000000007, -12.3, -3.2000000000000006, -12.0, -3.700000000000001, -3.3000000000000003, -3.500000000000001, -3.400000000000001, -3.6000000000000005, -3.1000000000000005, -3.3000000000000007, -10.9, -3.500000000000001, -3.400000000000001, -3.500000000000001, -3.2000000000000006, -3.3000000000000007, -3.5, -3.5000000000000004, -10.8, -3.6000000000000005, -3.6000000000000005, -3.400000000000001, -3.400000000000001, -3.4000000000000004, -3.7000000000000006, -3.8000000000000007, -3.700000000000001, -3.300000000000001, -3.400000000000001, -3.6000000000000005, -3.5000000000000004, -3.500000000000001, -10.6, -3.6000000000000005, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.6000000000000005, -3.2000000000000006, -3.4000000000000012, -3.6000000000000005, -3.0000000000000004, -3.5000000000000004, -3.3000000000000007, -3.3000000000000007, -3.4000000000000004, -3.3000000000000007, -3.6000000000000005, -3.2000000000000006, -3.6, -3.5000000000000004, -3.6, -3.6000000000000005, -3.3000000000000003, -3.500000000000001, -12.3, -3.4000000000000004, -3.4000000000000004, -3.4000000000000004, -3.4000000000000012, -12.2, -3.4000000000000004, -10.3, -10.4, -12.3, -3.0000000000000004, -3.400000000000001, -10.3, -3.9000000000000012, -3.400000000000001, -3.500000000000001, -12.200000000000001, -3.500000000000001, -3.6000000000000005, -3.600000000000001, -3.3000000000000007, -3.200000000000001, -10.2, -10.4, -3.500000000000001, -3.2000000000000006, -3.7000000000000006, -11.9, -3.2000000000000006, -3.2000000000000006, -3.6, -3.2000000000000006, -3.6000000000000005, -11.3, -3.200000000000001, -3.600000000000001, -3.500000000000001, -10.7, -3.7000000000000006, -3.400000000000001, -3.4000000000000004, -3.400000000000001, -3.6000000000000005, -3.6000000000000005, -3.5000000000000013, -3.700000000000001, -3.4000000000000004, -3.500000000000001, -3.500000000000001, -10.1, -11.4, -12.3, -3.400000000000001, -3.4000000000000004, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.6000000000000014, -3.400000000000001, -3.5000000000000004, -3.5000000000000004, -12.100000000000001, -3.400000000000001, -3.500000000000001, -3.400000000000001, -3.500000000000001, -3.4000000000000004, -3.600000000000001, -12.0, -3.3000000000000007, -3.4000000000000004], "episode_lengths": [21, 21, 14, 21, 21, 21, 21, 1, 21, 21, 15, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 16, 21, 8, 4, 21, 6, 8, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 13, 15, 20, 21, 21, 21, 21, 16, 21, 21, 21, 21, 19, 21, 21, 14, 17, 21, 21, 21, 21, 21, 9, 15, 12, 21, 21, 21, 21, 21, 21, 19, 21, 16, 21, 21, 13, 21, 21, 15, 21, 20, 21, 18, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 20, 21, 4, 5, 18, 21, 21, 4, 21, 21, 21, 19, 21, 21, 21, 21, 21, 3, 5, 21, 21, 21, 17, 21, 21, 21, 21, 21, 11, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 13, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 20, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.439886383893763, "mean_inference_ms": 17.504708027612025, "mean_action_processing_ms": 0.9326363299480336, "mean_env_wait_ms": 2.1361653164560463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07259959809517746, "StateBufferConnector_ms": 0.009083747863769531, "ViewRequirementAgentConnector_ms": 0.13230919267572283}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 171169.51, "load_time_ms": 1.086, "load_throughput": 3683495.291, "learn_time_ms": 170072.241, "learn_throughput": 23.519, "synch_weights_time_ms": 192.245}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "episodes_total": 2343, "training_iteration": 11, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-06_21-27-07", "timestamp": 1680809227, "time_this_iter_s": 171.55698823928833, "time_total_s": 1882.4637458324432, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476cbcd0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014772e8b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 1882.4637458324432, "timesteps_since_restore": 0, "iterations_since_restore": 11, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.724180327868852, "ram_util_percent": 23.52950819672131}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.202538792228186, "cur_kl_coeff": 2.2781249999999993, "cur_lr": 0.0010000000000000005, "total_loss": 0.6956882406897362, "policy_loss": -0.038285271130296936, "vf_loss": 0.7144342752684268, "vf_explained_var": 0.44263229966163636, "kl": 0.00857689464220687, "entropy": 3.9757856040872555, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 10695.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": 98.6, "episode_reward_min": -12.3, "episode_reward_mean": -3.7900000000000005, "episode_len_mean": 19.038095238095238, "episode_media": {}, "episodes_this_iter": 210, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.4000000000000012, -3.400000000000001, -3.500000000000001, -3.400000000000001, -3.1000000000000005, -10.1, -12.200000000000001, -10.8, -3.400000000000001, -3.7000000000000006, -3.6000000000000005, -3.500000000000001, -3.2000000000000006, -11.5, -3.400000000000001, -3.3000000000000007, -3.5000000000000004, -11.7, -3.2, -3.3000000000000007, -3.400000000000001, -3.3000000000000003, -10.3, -3.500000000000001, -3.400000000000001, -3.2000000000000006, -10.7, -10.4, -3.6000000000000005, -3.300000000000001, -3.3000000000000007, -10.7, -10.1, -3.300000000000001, -3.700000000000001, -3.400000000000001, -3.400000000000001, -3.4000000000000004, -3.3000000000000007, -3.600000000000001, -3.5000000000000004, -3.400000000000001, -3.6000000000000005, -3.6000000000000005, -3.500000000000001, -3.400000000000001, -10.9, -3.700000000000001, -3.4000000000000004, -3.4000000000000004, -3.2, -3.7000000000000006, -3.600000000000001, -10.2, -3.3000000000000007, -3.500000000000001, -10.9, -3.2000000000000006, -3.3000000000000003, -3.3000000000000003, -3.400000000000001, -3.6000000000000005, -3.600000000000001, -3.5000000000000004, -3.6000000000000005, -3.2000000000000006, -3.4000000000000004, -3.400000000000001, -3.5000000000000004, -3.200000000000001, -3.600000000000001, -3.400000000000001, -3.700000000000001, -3.3000000000000007, -3.3000000000000007, -3.4000000000000012, -3.5000000000000004, -3.800000000000001, -3.400000000000001, -3.2, -3.4000000000000004, -3.400000000000001, -3.600000000000001, -3.3000000000000007, -3.600000000000001, -3.400000000000001, -10.4, -10.3, -3.4000000000000012, -10.2, -3.6000000000000005, -3.4000000000000004, -3.400000000000001, -3.500000000000001, -11.4, -3.500000000000001, -3.5000000000000004, -3.2000000000000006, -3.400000000000001, -11.7, -11.5, -3.5000000000000004, -12.200000000000001, -10.9, -11.1, -3.4000000000000012, 98.3, -3.4000000000000004, -3.3000000000000007, -11.8, -11.8, -3.400000000000001, -3.5000000000000004, -3.4000000000000004, -3.700000000000001, -3.3000000000000003, -10.9, -10.4, -3.4000000000000004, -3.7000000000000006, -3.600000000000001, -11.0, -3.4000000000000004, -3.3000000000000007, -3.5000000000000004, -3.3000000000000007, -3.4000000000000004, -3.300000000000001, -3.3000000000000007, -3.3000000000000003, -3.7000000000000006, -3.500000000000001, -3.600000000000001, -3.400000000000001, -11.0, 98.6, -3.2000000000000006, -3.400000000000001, -3.3000000000000003, -3.2, -11.3, -10.3, -12.0, -3.400000000000001, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -3.2, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.8000000000000007, -12.0, -3.4000000000000004, -3.800000000000001, -3.3000000000000003, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -10.6, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -12.3, -3.200000000000001, -3.400000000000001, -3.800000000000001, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.600000000000001, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.7000000000000006, -3.6000000000000005, -3.400000000000001, -3.4000000000000004, -11.6, -3.2000000000000006, -3.400000000000001, -3.4000000000000004, -3.700000000000001, -3.4000000000000004, -4.100000000000001, -3.400000000000001, -3.4000000000000004, -3.5000000000000004, -3.500000000000001, -3.5000000000000004, -3.5000000000000004, -3.6000000000000005, -11.4, -3.5000000000000004, -3.5000000000000004, -3.5000000000000004, -10.0, -3.6000000000000005, -3.100000000000001, -3.4000000000000012, -3.8000000000000007, -3.4000000000000004, -3.500000000000001, -3.3000000000000003], "episode_lengths": [21, 21, 21, 21, 21, 2, 20, 7, 21, 21, 21, 21, 21, 14, 21, 21, 21, 17, 21, 21, 21, 21, 4, 21, 21, 21, 8, 5, 21, 21, 21, 7, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 3, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 4, 21, 3, 21, 21, 21, 21, 13, 21, 21, 21, 21, 14, 14, 21, 19, 9, 10, 21, 16, 21, 21, 15, 18, 21, 21, 21, 21, 21, 10, 5, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 13, 21, 21, 21, 21, 13, 4, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.445110106227945, "mean_inference_ms": 17.465902981233327, "mean_action_processing_ms": 0.9323944288900875, "mean_env_wait_ms": 2.139603288436073, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07594971429734003, "StateBufferConnector_ms": 0.009192625681559244, "ViewRequirementAgentConnector_ms": 0.13788268679664248}}, "episode_reward_max": 98.6, "episode_reward_min": -12.3, "episode_reward_mean": -3.7900000000000005, "episode_len_mean": 19.038095238095238, "episodes_this_iter": 210, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.4000000000000012, -3.400000000000001, -3.500000000000001, -3.400000000000001, -3.1000000000000005, -10.1, -12.200000000000001, -10.8, -3.400000000000001, -3.7000000000000006, -3.6000000000000005, -3.500000000000001, -3.2000000000000006, -11.5, -3.400000000000001, -3.3000000000000007, -3.5000000000000004, -11.7, -3.2, -3.3000000000000007, -3.400000000000001, -3.3000000000000003, -10.3, -3.500000000000001, -3.400000000000001, -3.2000000000000006, -10.7, -10.4, -3.6000000000000005, -3.300000000000001, -3.3000000000000007, -10.7, -10.1, -3.300000000000001, -3.700000000000001, -3.400000000000001, -3.400000000000001, -3.4000000000000004, -3.3000000000000007, -3.600000000000001, -3.5000000000000004, -3.400000000000001, -3.6000000000000005, -3.6000000000000005, -3.500000000000001, -3.400000000000001, -10.9, -3.700000000000001, -3.4000000000000004, -3.4000000000000004, -3.2, -3.7000000000000006, -3.600000000000001, -10.2, -3.3000000000000007, -3.500000000000001, -10.9, -3.2000000000000006, -3.3000000000000003, -3.3000000000000003, -3.400000000000001, -3.6000000000000005, -3.600000000000001, -3.5000000000000004, -3.6000000000000005, -3.2000000000000006, -3.4000000000000004, -3.400000000000001, -3.5000000000000004, -3.200000000000001, -3.600000000000001, -3.400000000000001, -3.700000000000001, -3.3000000000000007, -3.3000000000000007, -3.4000000000000012, -3.5000000000000004, -3.800000000000001, -3.400000000000001, -3.2, -3.4000000000000004, -3.400000000000001, -3.600000000000001, -3.3000000000000007, -3.600000000000001, -3.400000000000001, -10.4, -10.3, -3.4000000000000012, -10.2, -3.6000000000000005, -3.4000000000000004, -3.400000000000001, -3.500000000000001, -11.4, -3.500000000000001, -3.5000000000000004, -3.2000000000000006, -3.400000000000001, -11.7, -11.5, -3.5000000000000004, -12.200000000000001, -10.9, -11.1, -3.4000000000000012, 98.3, -3.4000000000000004, -3.3000000000000007, -11.8, -11.8, -3.400000000000001, -3.5000000000000004, -3.4000000000000004, -3.700000000000001, -3.3000000000000003, -10.9, -10.4, -3.4000000000000004, -3.7000000000000006, -3.600000000000001, -11.0, -3.4000000000000004, -3.3000000000000007, -3.5000000000000004, -3.3000000000000007, -3.4000000000000004, -3.300000000000001, -3.3000000000000007, -3.3000000000000003, -3.7000000000000006, -3.500000000000001, -3.600000000000001, -3.400000000000001, -11.0, 98.6, -3.2000000000000006, -3.400000000000001, -3.3000000000000003, -3.2, -11.3, -10.3, -12.0, -3.400000000000001, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -3.2, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.8000000000000007, -12.0, -3.4000000000000004, -3.800000000000001, -3.3000000000000003, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -10.6, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -12.3, -3.200000000000001, -3.400000000000001, -3.800000000000001, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.600000000000001, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.7000000000000006, -3.6000000000000005, -3.400000000000001, -3.4000000000000004, -11.6, -3.2000000000000006, -3.400000000000001, -3.4000000000000004, -3.700000000000001, -3.4000000000000004, -4.100000000000001, -3.400000000000001, -3.4000000000000004, -3.5000000000000004, -3.500000000000001, -3.5000000000000004, -3.5000000000000004, -3.6000000000000005, -11.4, -3.5000000000000004, -3.5000000000000004, -3.5000000000000004, -10.0, -3.6000000000000005, -3.100000000000001, -3.4000000000000012, -3.8000000000000007, -3.4000000000000004, -3.500000000000001, -3.3000000000000003], "episode_lengths": [21, 21, 21, 21, 21, 2, 20, 7, 21, 21, 21, 21, 21, 14, 21, 21, 21, 17, 21, 21, 21, 21, 4, 21, 21, 21, 8, 5, 21, 21, 21, 7, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 3, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 4, 21, 3, 21, 21, 21, 21, 13, 21, 21, 21, 21, 14, 14, 21, 19, 9, 10, 21, 16, 21, 21, 15, 18, 21, 21, 21, 21, 21, 10, 5, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 13, 21, 21, 21, 21, 13, 4, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.445110106227945, "mean_inference_ms": 17.465902981233327, "mean_action_processing_ms": 0.9323944288900875, "mean_env_wait_ms": 2.139603288436073, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07594971429734003, "StateBufferConnector_ms": 0.009192625681559244, "ViewRequirementAgentConnector_ms": 0.13788268679664248}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 171207.022, "load_time_ms": 1.115, "load_throughput": 3587941.831, "learn_time_ms": 170109.55, "learn_throughput": 23.514, "synch_weights_time_ms": 194.711}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 2553, "training_iteration": 12, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-06_21-29-58", "timestamp": 1680809398, "time_this_iter_s": 170.8734040260315, "time_total_s": 2053.3371498584747, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476f2730>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014771f040>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 2053.3371498584747, "timesteps_since_restore": 0, "iterations_since_restore": 12, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.408641975308642, "ram_util_percent": 23.514814814814816}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1025178817010695, "cur_kl_coeff": 2.2781249999999993, "cur_lr": 0.0010000000000000005, "total_loss": 0.5724879101840078, "policy_loss": -0.11576227447598852, "vf_loss": 0.6538811564665808, "vf_explained_var": 0.45264940691250627, "kl": 0.015086541724202263, "entropy": 3.9700627888402633, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 11625.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "sampler_results": {"episode_reward_max": -3.1000000000000005, "episode_reward_min": -12.3, "episode_reward_mean": -4.704950495049506, "episode_len_mean": 19.5, "episode_media": {}, "episodes_this_iter": 202, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.400000000000001, -10.5, -3.700000000000001, -3.200000000000001, -11.6, -11.3, -3.600000000000001, -3.1000000000000005, -3.3000000000000007, -3.5000000000000013, -3.3000000000000003, -3.5000000000000004, -3.2000000000000006, -12.2, -3.400000000000001, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.6000000000000005, -11.6, -3.8000000000000007, -3.4000000000000004, -3.6000000000000005, -11.8, -11.9, -10.4, -3.3000000000000003, -3.7000000000000006, -3.5000000000000004, -3.400000000000001, -3.6000000000000005, -3.3000000000000007, -3.900000000000001, -3.2, -3.400000000000001, -3.5000000000000004, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.2, -3.500000000000001, -3.9000000000000012, -3.500000000000001, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.600000000000001, -3.5000000000000004, -3.500000000000001, -3.5000000000000004, -3.600000000000001, -3.600000000000001, -3.2000000000000006, -3.700000000000001, -3.3000000000000007, -3.500000000000001, -3.2000000000000006, -3.500000000000001, -3.500000000000001, -3.400000000000001, -3.100000000000001, -3.4000000000000004, -3.4000000000000004, -3.6000000000000005, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -3.500000000000001, -3.500000000000001, -3.700000000000001, -3.400000000000001, -3.6000000000000005, -3.500000000000001, -3.400000000000001, -3.400000000000001, -3.4000000000000004, -3.6, -3.3000000000000003, -3.7000000000000006, -3.400000000000001, -3.5000000000000004, -3.8000000000000007, -3.500000000000001, -3.6000000000000005, -3.2000000000000006, -3.400000000000001, -3.700000000000001, -3.1000000000000005, -3.500000000000001, -3.400000000000001, -3.3000000000000003, -3.300000000000001, -3.3000000000000007, -11.0, -10.9, -3.2000000000000006, -3.4000000000000004, -3.6000000000000005, -3.400000000000001, -3.600000000000001, -3.400000000000001, -3.3000000000000007, -3.600000000000001, -3.600000000000001, -11.3, -11.2, -11.6, -3.2, -3.4000000000000004, -3.5000000000000004, -11.4, -3.2000000000000006, -3.3000000000000007, -3.6000000000000005, -3.500000000000001, -3.3000000000000007, -3.2, -11.2, -3.500000000000001, -3.3000000000000007, -3.2000000000000006, -3.500000000000001, -10.3, -3.3000000000000003, -11.6, -11.4, -3.6000000000000014, -12.3, -3.2, -3.5000000000000013, -3.1000000000000005, -3.1000000000000005, -11.600000000000001, -3.1000000000000005, -3.5000000000000004, -3.3000000000000007, -3.2000000000000006, -11.2, -10.2, -11.2, -11.1, -11.6, -3.5000000000000004, -3.7000000000000006, -3.2000000000000006, -3.400000000000001, -3.600000000000001, -3.3000000000000003, -3.7000000000000006, -10.9, -3.5000000000000004, -3.4000000000000004, -3.6000000000000005, -10.5, -3.5000000000000004, -3.500000000000001, -3.3000000000000007, -3.600000000000001, -3.5000000000000004, -3.500000000000001, -10.8, -3.3000000000000003, -3.7, -3.500000000000001, -3.8000000000000007, -3.7000000000000006, -10.4, -3.4000000000000004, -3.400000000000001, -3.400000000000001, -11.1, -3.600000000000001, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -12.100000000000001, -3.500000000000001, -3.3000000000000003, -3.600000000000001, -3.3000000000000007, -3.1000000000000005, -3.600000000000001, -3.8000000000000007, -3.1000000000000005, -3.3000000000000007, -3.500000000000001, -3.3000000000000007, -3.3000000000000007, -3.600000000000001, -3.400000000000001, -3.2000000000000006, -3.7000000000000006, -3.5000000000000004, -11.9, -3.400000000000001, -3.6000000000000005, -3.700000000000001, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -11.2, -3.3000000000000007], "episode_lengths": [21, 5, 21, 21, 14, 13, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 14, 21, 21, 21, 15, 18, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 13, 13, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 4, 21, 15, 12, 21, 20, 21, 21, 21, 21, 15, 21, 21, 21, 21, 12, 2, 13, 11, 14, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 5, 21, 21, 21, 11, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 11, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.46900367342482, "mean_inference_ms": 17.491962636468134, "mean_action_processing_ms": 0.930991842435518, "mean_env_wait_ms": 2.138404562921808, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07628296861554136, "StateBufferConnector_ms": 0.009758991770224996, "ViewRequirementAgentConnector_ms": 0.13946837717943852}}, "episode_reward_max": -3.1000000000000005, "episode_reward_min": -12.3, "episode_reward_mean": -4.704950495049506, "episode_len_mean": 19.5, "episodes_this_iter": 202, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.400000000000001, -10.5, -3.700000000000001, -3.200000000000001, -11.6, -11.3, -3.600000000000001, -3.1000000000000005, -3.3000000000000007, -3.5000000000000013, -3.3000000000000003, -3.5000000000000004, -3.2000000000000006, -12.2, -3.400000000000001, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.6000000000000005, -11.6, -3.8000000000000007, -3.4000000000000004, -3.6000000000000005, -11.8, -11.9, -10.4, -3.3000000000000003, -3.7000000000000006, -3.5000000000000004, -3.400000000000001, -3.6000000000000005, -3.3000000000000007, -3.900000000000001, -3.2, -3.400000000000001, -3.5000000000000004, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.2, -3.500000000000001, -3.9000000000000012, -3.500000000000001, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.600000000000001, -3.5000000000000004, -3.500000000000001, -3.5000000000000004, -3.600000000000001, -3.600000000000001, -3.2000000000000006, -3.700000000000001, -3.3000000000000007, -3.500000000000001, -3.2000000000000006, -3.500000000000001, -3.500000000000001, -3.400000000000001, -3.100000000000001, -3.4000000000000004, -3.4000000000000004, -3.6000000000000005, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -3.500000000000001, -3.500000000000001, -3.700000000000001, -3.400000000000001, -3.6000000000000005, -3.500000000000001, -3.400000000000001, -3.400000000000001, -3.4000000000000004, -3.6, -3.3000000000000003, -3.7000000000000006, -3.400000000000001, -3.5000000000000004, -3.8000000000000007, -3.500000000000001, -3.6000000000000005, -3.2000000000000006, -3.400000000000001, -3.700000000000001, -3.1000000000000005, -3.500000000000001, -3.400000000000001, -3.3000000000000003, -3.300000000000001, -3.3000000000000007, -11.0, -10.9, -3.2000000000000006, -3.4000000000000004, -3.6000000000000005, -3.400000000000001, -3.600000000000001, -3.400000000000001, -3.3000000000000007, -3.600000000000001, -3.600000000000001, -11.3, -11.2, -11.6, -3.2, -3.4000000000000004, -3.5000000000000004, -11.4, -3.2000000000000006, -3.3000000000000007, -3.6000000000000005, -3.500000000000001, -3.3000000000000007, -3.2, -11.2, -3.500000000000001, -3.3000000000000007, -3.2000000000000006, -3.500000000000001, -10.3, -3.3000000000000003, -11.6, -11.4, -3.6000000000000014, -12.3, -3.2, -3.5000000000000013, -3.1000000000000005, -3.1000000000000005, -11.600000000000001, -3.1000000000000005, -3.5000000000000004, -3.3000000000000007, -3.2000000000000006, -11.2, -10.2, -11.2, -11.1, -11.6, -3.5000000000000004, -3.7000000000000006, -3.2000000000000006, -3.400000000000001, -3.600000000000001, -3.3000000000000003, -3.7000000000000006, -10.9, -3.5000000000000004, -3.4000000000000004, -3.6000000000000005, -10.5, -3.5000000000000004, -3.500000000000001, -3.3000000000000007, -3.600000000000001, -3.5000000000000004, -3.500000000000001, -10.8, -3.3000000000000003, -3.7, -3.500000000000001, -3.8000000000000007, -3.7000000000000006, -10.4, -3.4000000000000004, -3.400000000000001, -3.400000000000001, -11.1, -3.600000000000001, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -12.100000000000001, -3.500000000000001, -3.3000000000000003, -3.600000000000001, -3.3000000000000007, -3.1000000000000005, -3.600000000000001, -3.8000000000000007, -3.1000000000000005, -3.3000000000000007, -3.500000000000001, -3.3000000000000007, -3.3000000000000007, -3.600000000000001, -3.400000000000001, -3.2000000000000006, -3.7000000000000006, -3.5000000000000004, -11.9, -3.400000000000001, -3.6000000000000005, -3.700000000000001, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -11.2, -3.3000000000000007], "episode_lengths": [21, 5, 21, 21, 14, 13, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 14, 21, 21, 21, 15, 18, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 13, 13, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 4, 21, 15, 12, 21, 20, 21, 21, 21, 21, 15, 21, 21, 21, 21, 12, 2, 13, 11, 14, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 5, 21, 21, 21, 11, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 11, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.46900367342482, "mean_inference_ms": 17.491962636468134, "mean_action_processing_ms": 0.930991842435518, "mean_env_wait_ms": 2.138404562921808, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07628296861554136, "StateBufferConnector_ms": 0.009758991770224996, "ViewRequirementAgentConnector_ms": 0.13946837717943852}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 171256.249, "load_time_ms": 1.142, "load_throughput": 3502257.849, "learn_time_ms": 170146.593, "learn_throughput": 23.509, "synch_weights_time_ms": 212.522}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "episodes_total": 2755, "training_iteration": 13, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-06_21-32-49", "timestamp": 1680809569, "time_this_iter_s": 170.9628086090088, "time_total_s": 2224.2999584674835, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01477919a0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014764be50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 2224.2999584674835, "timesteps_since_restore": 0, "iterations_since_restore": 13, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.518518518518517, "ram_util_percent": 23.503703703703703}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2155075480540594, "cur_kl_coeff": 2.2781249999999993, "cur_lr": 0.0010000000000000005, "total_loss": 0.6976769010406187, "policy_loss": -0.03949510865013606, "vf_loss": 0.7210611954010943, "vf_explained_var": 0.3642373299085966, "kl": 0.007071963634895241, "entropy": 3.9664435581494404, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 12555.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "sampler_results": {"episode_reward_max": 98.9, "episode_reward_min": -12.3, "episode_reward_mean": -3.0755980861244017, "episode_len_mean": 19.54066985645933, "episode_media": {}, "episodes_this_iter": 209, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.600000000000001, -3.3000000000000003, -3.5000000000000004, -3.5000000000000004, -3.4000000000000004, -3.7000000000000006, -3.600000000000001, -3.5000000000000004, -10.6, -3.3000000000000007, -3.3000000000000003, -3.500000000000001, -3.500000000000001, -3.5000000000000004, -3.1000000000000005, -3.8000000000000007, -3.400000000000001, -3.500000000000001, -3.5000000000000004, -12.3, -3.400000000000001, -3.500000000000001, -3.7000000000000006, -12.100000000000001, -3.700000000000001, -3.3000000000000007, -3.400000000000001, -10.3, -3.7000000000000006, -3.400000000000001, -10.2, -3.3000000000000007, -3.700000000000001, -11.9, -3.6000000000000005, -3.3000000000000003, -3.500000000000001, -3.2, -3.500000000000001, -3.3000000000000007, -3.7000000000000006, -3.5000000000000004, -3.700000000000001, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -12.100000000000001, -3.1000000000000005, -3.600000000000001, -11.5, -3.600000000000001, -3.400000000000001, -3.4000000000000012, -10.3, -10.0, -3.3000000000000007, -3.700000000000001, -3.3000000000000007, -3.300000000000001, -3.4000000000000004, -3.500000000000001, -3.1000000000000005, -12.200000000000001, -3.400000000000001, -3.4000000000000004, -3.500000000000001, -3.500000000000001, -3.500000000000001, -3.400000000000001, -3.1000000000000005, -11.9, -3.2000000000000006, -3.4000000000000004, -3.7000000000000006, -4.000000000000001, -3.400000000000001, -3.500000000000001, -3.3000000000000007, -3.4000000000000004, -3.400000000000001, -3.800000000000001, -3.5000000000000004, -11.0, -3.500000000000001, -10.3, -3.500000000000001, -12.100000000000001, -11.0, -3.400000000000001, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.500000000000001, -3.700000000000001, -3.500000000000001, -3.3000000000000007, -3.400000000000001, -3.5000000000000004, -3.2000000000000006, -3.1000000000000005, -11.1, -11.0, -3.4000000000000004, -3.3000000000000003, -3.3000000000000007, -3.4000000000000004, -10.4, -3.7000000000000006, -3.3000000000000007, 98.9, -3.4000000000000004, -3.500000000000001, -3.2, -3.300000000000001, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.500000000000001, 97.9, -3.6000000000000005, -3.6000000000000005, -10.5, -3.2000000000000006, -3.7000000000000006, -3.3000000000000007, -3.3000000000000007, -3.6000000000000005, -3.600000000000001, -3.3000000000000007, -3.4000000000000004, -3.3000000000000007, -3.200000000000001, -10.9, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.400000000000001, -3.7000000000000006, -3.500000000000001, -3.7000000000000006, -3.2000000000000006, -3.500000000000001, -3.500000000000001, -12.100000000000001, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.400000000000001, -12.0, -3.2000000000000006, -3.7000000000000006, -3.3000000000000007, -10.2, -3.5000000000000004, -3.7, -3.600000000000001, -3.400000000000001, -3.3000000000000007, 98.1, -3.2, -11.9, -3.400000000000001, -11.3, -3.5000000000000004, -3.3000000000000003, -3.800000000000001, -3.5000000000000013, -3.3000000000000003, -3.4000000000000004, -10.2, -3.4000000000000004, -3.6000000000000005, -3.600000000000001, -11.3, -3.100000000000001, -3.2, -3.500000000000001, -10.5, -3.5000000000000004, -3.2000000000000006, -3.6000000000000005, -3.2000000000000006, -3.400000000000001, -3.2, -3.5000000000000004, -3.400000000000001, -3.0000000000000004, -3.4000000000000012, -3.2000000000000006, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.7000000000000006, -3.3000000000000003, -12.2, -3.400000000000001, -3.4000000000000004, -3.2, -3.600000000000001, -3.500000000000001, -3.7000000000000006, -3.500000000000001, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.8000000000000007, -3.7000000000000006], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 20, 21, 21, 21, 4, 21, 21, 3, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 14, 21, 21, 21, 3, 1, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 3, 21, 18, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 10, 21, 21, 21, 21, 5, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 19, 21, 21, 21, 3, 21, 21, 21, 21, 21, 18, 21, 19, 21, 12, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 13, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.48132987242351, "mean_inference_ms": 17.44571636442036, "mean_action_processing_ms": 0.9268479250690772, "mean_env_wait_ms": 2.1319596303692894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07629805204400605, "StateBufferConnector_ms": 0.009625836422568873, "ViewRequirementAgentConnector_ms": 0.1373097086637214}}, "episode_reward_max": 98.9, "episode_reward_min": -12.3, "episode_reward_mean": -3.0755980861244017, "episode_len_mean": 19.54066985645933, "episodes_this_iter": 209, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.600000000000001, -3.3000000000000003, -3.5000000000000004, -3.5000000000000004, -3.4000000000000004, -3.7000000000000006, -3.600000000000001, -3.5000000000000004, -10.6, -3.3000000000000007, -3.3000000000000003, -3.500000000000001, -3.500000000000001, -3.5000000000000004, -3.1000000000000005, -3.8000000000000007, -3.400000000000001, -3.500000000000001, -3.5000000000000004, -12.3, -3.400000000000001, -3.500000000000001, -3.7000000000000006, -12.100000000000001, -3.700000000000001, -3.3000000000000007, -3.400000000000001, -10.3, -3.7000000000000006, -3.400000000000001, -10.2, -3.3000000000000007, -3.700000000000001, -11.9, -3.6000000000000005, -3.3000000000000003, -3.500000000000001, -3.2, -3.500000000000001, -3.3000000000000007, -3.7000000000000006, -3.5000000000000004, -3.700000000000001, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -12.100000000000001, -3.1000000000000005, -3.600000000000001, -11.5, -3.600000000000001, -3.400000000000001, -3.4000000000000012, -10.3, -10.0, -3.3000000000000007, -3.700000000000001, -3.3000000000000007, -3.300000000000001, -3.4000000000000004, -3.500000000000001, -3.1000000000000005, -12.200000000000001, -3.400000000000001, -3.4000000000000004, -3.500000000000001, -3.500000000000001, -3.500000000000001, -3.400000000000001, -3.1000000000000005, -11.9, -3.2000000000000006, -3.4000000000000004, -3.7000000000000006, -4.000000000000001, -3.400000000000001, -3.500000000000001, -3.3000000000000007, -3.4000000000000004, -3.400000000000001, -3.800000000000001, -3.5000000000000004, -11.0, -3.500000000000001, -10.3, -3.500000000000001, -12.100000000000001, -11.0, -3.400000000000001, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.500000000000001, -3.700000000000001, -3.500000000000001, -3.3000000000000007, -3.400000000000001, -3.5000000000000004, -3.2000000000000006, -3.1000000000000005, -11.1, -11.0, -3.4000000000000004, -3.3000000000000003, -3.3000000000000007, -3.4000000000000004, -10.4, -3.7000000000000006, -3.3000000000000007, 98.9, -3.4000000000000004, -3.500000000000001, -3.2, -3.300000000000001, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.500000000000001, 97.9, -3.6000000000000005, -3.6000000000000005, -10.5, -3.2000000000000006, -3.7000000000000006, -3.3000000000000007, -3.3000000000000007, -3.6000000000000005, -3.600000000000001, -3.3000000000000007, -3.4000000000000004, -3.3000000000000007, -3.200000000000001, -10.9, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.400000000000001, -3.7000000000000006, -3.500000000000001, -3.7000000000000006, -3.2000000000000006, -3.500000000000001, -3.500000000000001, -12.100000000000001, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.400000000000001, -12.0, -3.2000000000000006, -3.7000000000000006, -3.3000000000000007, -10.2, -3.5000000000000004, -3.7, -3.600000000000001, -3.400000000000001, -3.3000000000000007, 98.1, -3.2, -11.9, -3.400000000000001, -11.3, -3.5000000000000004, -3.3000000000000003, -3.800000000000001, -3.5000000000000013, -3.3000000000000003, -3.4000000000000004, -10.2, -3.4000000000000004, -3.6000000000000005, -3.600000000000001, -11.3, -3.100000000000001, -3.2, -3.500000000000001, -10.5, -3.5000000000000004, -3.2000000000000006, -3.6000000000000005, -3.2000000000000006, -3.400000000000001, -3.2, -3.5000000000000004, -3.400000000000001, -3.0000000000000004, -3.4000000000000012, -3.2000000000000006, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.7000000000000006, -3.3000000000000003, -12.2, -3.400000000000001, -3.4000000000000004, -3.2, -3.600000000000001, -3.500000000000001, -3.7000000000000006, -3.500000000000001, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.8000000000000007, -3.7000000000000006], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 20, 21, 21, 21, 4, 21, 21, 3, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 14, 21, 21, 21, 3, 1, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 3, 21, 18, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 10, 21, 21, 21, 21, 5, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 19, 21, 21, 21, 3, 21, 21, 21, 21, 21, 18, 21, 19, 21, 12, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 13, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.48132987242351, "mean_inference_ms": 17.44571636442036, "mean_action_processing_ms": 0.9268479250690772, "mean_env_wait_ms": 2.1319596303692894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07629805204400605, "StateBufferConnector_ms": 0.009625836422568873, "ViewRequirementAgentConnector_ms": 0.1373097086637214}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 171265.083, "load_time_ms": 1.151, "load_throughput": 3475630.503, "learn_time_ms": 170162.544, "learn_throughput": 23.507, "synch_weights_time_ms": 208.39}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "episodes_total": 2964, "training_iteration": 14, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-06_21-35-41", "timestamp": 1680809741, "time_this_iter_s": 171.48780989646912, "time_total_s": 2395.7877683639526, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476b9f10>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014784a5e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 2395.7877683639526, "timesteps_since_restore": 0, "iterations_since_restore": 14, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.5831967213114755, "ram_util_percent": 23.502868852459017}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1129846096199045, "cur_kl_coeff": 2.2781249999999993, "cur_lr": 0.0010000000000000005, "total_loss": 0.5216901007278633, "policy_loss": -0.036386634476522926, "vf_loss": 0.5412701817209362, "vf_explained_var": 0.49079327935813577, "kl": 0.007377362386857082, "entropy": 3.9661842020609046, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 13485.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": 99.3, "episode_reward_min": -12.3, "episode_reward_mean": -3.342424242424243, "episode_len_mean": 19.87878787878788, "episode_media": {}, "episodes_this_iter": 198, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.400000000000001, -11.3, -3.3000000000000007, -3.500000000000001, -3.3000000000000007, -3.5000000000000004, -3.400000000000001, -3.4000000000000004, 99.3, -3.3000000000000007, -3.500000000000001, -3.400000000000001, -11.700000000000001, -3.400000000000001, -3.4000000000000004, -3.400000000000001, -3.2000000000000006, -3.500000000000001, -3.400000000000001, -3.3000000000000007, -3.8000000000000007, -3.500000000000001, -3.400000000000001, -3.600000000000001, -3.7000000000000006, -3.3000000000000007, -3.400000000000001, -3.900000000000001, -3.500000000000001, -11.6, -3.200000000000001, -3.3000000000000007, -3.600000000000001, -3.400000000000001, -3.500000000000001, -3.500000000000001, -3.4000000000000004, -3.5000000000000004, -3.400000000000001, -3.2, -3.4000000000000004, -3.4000000000000004, -3.5000000000000004, -3.4000000000000004, -10.5, -3.3000000000000007, -3.400000000000001, -3.7000000000000006, -3.400000000000001, -10.6, -3.200000000000001, -3.500000000000001, -3.400000000000001, -11.8, -3.7000000000000006, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -11.7, -3.100000000000001, -3.400000000000001, -3.400000000000001, -3.400000000000001, -3.400000000000001, -11.3, -3.5000000000000013, -3.600000000000001, -3.3000000000000007, -3.2000000000000006, -3.500000000000001, -11.8, -3.500000000000001, -3.5000000000000004, -3.600000000000001, -3.400000000000001, -3.4000000000000004, -3.400000000000001, -3.5000000000000013, -3.5000000000000004, -10.9, -3.7000000000000006, -3.6000000000000005, -11.700000000000001, -3.400000000000001, -3.2, -12.2, -3.2000000000000006, -3.2000000000000006, -3.4000000000000012, -3.5000000000000004, -3.6000000000000005, -3.3000000000000007, -3.5000000000000004, -3.2000000000000006, -3.500000000000001, -3.400000000000001, -3.500000000000001, -3.0000000000000004, -3.900000000000001, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.6000000000000005, -3.3000000000000003, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -12.3, -11.9, -3.400000000000001, -3.600000000000001, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.4000000000000004, -3.500000000000001, -3.6000000000000005, -3.2, -3.600000000000001, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.600000000000001, -3.500000000000001, -3.4000000000000004, -10.6, -11.8, -3.500000000000001, -3.500000000000001, -10.5, -3.0000000000000004, -11.3, -3.3000000000000003, -3.5000000000000004, -3.3000000000000007, -3.3000000000000007, -12.0, 98.4, -10.7, -3.4000000000000004, -3.500000000000001, -4.000000000000002, -3.2000000000000006, -3.6000000000000005, -3.2000000000000006, -3.5, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.4000000000000004, -3.400000000000001, -3.500000000000001, -11.5, -3.3000000000000003, -3.600000000000001, -3.3000000000000007, -3.4000000000000012, -3.400000000000001, -3.500000000000001, -3.5000000000000004, -3.3000000000000007, -3.400000000000001, -11.2, -3.3000000000000007, -10.4, -3.3000000000000007, -3.3000000000000007, -3.5000000000000004, -3.500000000000001, -3.500000000000001, -3.300000000000001, -3.200000000000001, -3.3000000000000003, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.4000000000000004, -3.5000000000000013, -3.500000000000001, -3.400000000000001, -3.7000000000000006, -3.3000000000000007, -3.4000000000000004, -3.1000000000000005, -3.4000000000000004, -3.3000000000000007, -3.600000000000001, -3.600000000000001, -3.8000000000000007, -3.700000000000001, -3.6000000000000005, -3.600000000000001, -3.500000000000001, -3.5000000000000004, -3.6000000000000005, -3.500000000000001, -10.0, -3.6000000000000005], "episode_lengths": [21, 13, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 7, 21, 21, 21, 16, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 18, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 16, 21, 21, 5, 21, 14, 21, 21, 21, 21, 18, 17, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.483601678973528, "mean_inference_ms": 17.455044146844084, "mean_action_processing_ms": 0.9262475668493907, "mean_env_wait_ms": 2.1323616574516975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07467715427128956, "StateBufferConnector_ms": 0.009168398500692964, "ViewRequirementAgentConnector_ms": 0.1364045672946506}}, "episode_reward_max": 99.3, "episode_reward_min": -12.3, "episode_reward_mean": -3.342424242424243, "episode_len_mean": 19.87878787878788, "episodes_this_iter": 198, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.400000000000001, -11.3, -3.3000000000000007, -3.500000000000001, -3.3000000000000007, -3.5000000000000004, -3.400000000000001, -3.4000000000000004, 99.3, -3.3000000000000007, -3.500000000000001, -3.400000000000001, -11.700000000000001, -3.400000000000001, -3.4000000000000004, -3.400000000000001, -3.2000000000000006, -3.500000000000001, -3.400000000000001, -3.3000000000000007, -3.8000000000000007, -3.500000000000001, -3.400000000000001, -3.600000000000001, -3.7000000000000006, -3.3000000000000007, -3.400000000000001, -3.900000000000001, -3.500000000000001, -11.6, -3.200000000000001, -3.3000000000000007, -3.600000000000001, -3.400000000000001, -3.500000000000001, -3.500000000000001, -3.4000000000000004, -3.5000000000000004, -3.400000000000001, -3.2, -3.4000000000000004, -3.4000000000000004, -3.5000000000000004, -3.4000000000000004, -10.5, -3.3000000000000007, -3.400000000000001, -3.7000000000000006, -3.400000000000001, -10.6, -3.200000000000001, -3.500000000000001, -3.400000000000001, -11.8, -3.7000000000000006, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -11.7, -3.100000000000001, -3.400000000000001, -3.400000000000001, -3.400000000000001, -3.400000000000001, -11.3, -3.5000000000000013, -3.600000000000001, -3.3000000000000007, -3.2000000000000006, -3.500000000000001, -11.8, -3.500000000000001, -3.5000000000000004, -3.600000000000001, -3.400000000000001, -3.4000000000000004, -3.400000000000001, -3.5000000000000013, -3.5000000000000004, -10.9, -3.7000000000000006, -3.6000000000000005, -11.700000000000001, -3.400000000000001, -3.2, -12.2, -3.2000000000000006, -3.2000000000000006, -3.4000000000000012, -3.5000000000000004, -3.6000000000000005, -3.3000000000000007, -3.5000000000000004, -3.2000000000000006, -3.500000000000001, -3.400000000000001, -3.500000000000001, -3.0000000000000004, -3.900000000000001, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.6000000000000005, -3.3000000000000003, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -12.3, -11.9, -3.400000000000001, -3.600000000000001, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.4000000000000004, -3.500000000000001, -3.6000000000000005, -3.2, -3.600000000000001, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.600000000000001, -3.500000000000001, -3.4000000000000004, -10.6, -11.8, -3.500000000000001, -3.500000000000001, -10.5, -3.0000000000000004, -11.3, -3.3000000000000003, -3.5000000000000004, -3.3000000000000007, -3.3000000000000007, -12.0, 98.4, -10.7, -3.4000000000000004, -3.500000000000001, -4.000000000000002, -3.2000000000000006, -3.6000000000000005, -3.2000000000000006, -3.5, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.4000000000000004, -3.400000000000001, -3.500000000000001, -11.5, -3.3000000000000003, -3.600000000000001, -3.3000000000000007, -3.4000000000000012, -3.400000000000001, -3.500000000000001, -3.5000000000000004, -3.3000000000000007, -3.400000000000001, -11.2, -3.3000000000000007, -10.4, -3.3000000000000007, -3.3000000000000007, -3.5000000000000004, -3.500000000000001, -3.500000000000001, -3.300000000000001, -3.200000000000001, -3.3000000000000003, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.4000000000000004, -3.5000000000000013, -3.500000000000001, -3.400000000000001, -3.7000000000000006, -3.3000000000000007, -3.4000000000000004, -3.1000000000000005, -3.4000000000000004, -3.3000000000000007, -3.600000000000001, -3.600000000000001, -3.8000000000000007, -3.700000000000001, -3.6000000000000005, -3.600000000000001, -3.500000000000001, -3.5000000000000004, -3.6000000000000005, -3.500000000000001, -10.0, -3.6000000000000005], "episode_lengths": [21, 13, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 7, 21, 21, 21, 16, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 18, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 16, 21, 21, 5, 21, 14, 21, 21, 21, 21, 18, 17, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.483601678973528, "mean_inference_ms": 17.455044146844084, "mean_action_processing_ms": 0.9262475668493907, "mean_env_wait_ms": 2.1323616574516975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07467715427128956, "StateBufferConnector_ms": 0.009168398500692964, "ViewRequirementAgentConnector_ms": 0.1364045672946506}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 171268.418, "load_time_ms": 1.159, "load_throughput": 3451533.904, "learn_time_ms": 170166.641, "learn_throughput": 23.506, "synch_weights_time_ms": 209.327}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 3162, "training_iteration": 15, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-06_21-38-32", "timestamp": 1680809912, "time_this_iter_s": 171.2361433506012, "time_total_s": 2567.023911714554, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01477a39d0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014772e1f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 2567.023911714554, "timesteps_since_restore": 0, "iterations_since_restore": 15, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.444855967078189, "ram_util_percent": 23.519753086419755}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1935813916787024, "cur_kl_coeff": 2.2781249999999993, "cur_lr": 0.0010000000000000005, "total_loss": 0.7848005247793051, "policy_loss": -0.03948718282288962, "vf_loss": 0.8036643404974252, "vf_explained_var": 0.29520877644579896, "kl": 0.009052784521582096, "entropy": 3.9758017281050324, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 14415.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "sampler_results": {"episode_reward_max": 98.8, "episode_reward_min": -12.3, "episode_reward_mean": -3.828229665071771, "episode_len_mean": 19.0, "episode_media": {}, "episodes_this_iter": 209, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.2000000000000006, -3.2000000000000006, -3.5000000000000004, -3.3000000000000007, -12.100000000000001, -3.400000000000001, -3.4000000000000004, -3.400000000000001, -3.4000000000000004, -3.7000000000000006, -3.2000000000000006, -3.4000000000000004, -3.3000000000000003, -3.200000000000001, -3.5000000000000004, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.200000000000001, -11.8, -3.3000000000000007, -3.500000000000001, -10.8, -11.1, -3.3000000000000007, -3.500000000000001, -3.3000000000000007, -3.3000000000000007, -3.2, -3.3000000000000003, -10.7, -3.500000000000001, -3.200000000000001, -3.400000000000001, -3.5000000000000004, -3.600000000000001, -3.1000000000000005, -3.300000000000001, -3.300000000000001, -3.500000000000001, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.500000000000001, -11.6, -3.3000000000000007, -3.600000000000001, -3.5000000000000004, -3.7000000000000006, -3.5000000000000013, -12.0, -3.3000000000000003, -3.1000000000000005, -3.5000000000000004, -3.400000000000001, -12.100000000000001, -11.1, -10.5, -3.3000000000000007, -3.3000000000000007, -3.600000000000001, -3.3000000000000007, -10.4, -3.3000000000000003, -11.1, -10.2, -3.200000000000001, -3.3000000000000003, -3.5000000000000004, -3.600000000000001, -3.600000000000001, -3.500000000000001, -3.5000000000000013, -3.600000000000001, -3.5000000000000004, -10.0, -3.5000000000000004, -3.5000000000000004, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.400000000000001, -3.3000000000000003, -11.6, -3.4000000000000004, -3.500000000000001, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.7000000000000006, -11.9, -3.400000000000001, -3.6000000000000005, -3.600000000000001, -3.1000000000000005, -3.700000000000001, -3.4000000000000004, -3.4000000000000004, -3.3000000000000007, -3.6000000000000005, -3.3000000000000007, -3.700000000000001, -11.0, -3.5000000000000004, -3.8000000000000007, -11.1, -3.400000000000001, -3.8000000000000007, -3.5000000000000004, -3.600000000000001, -3.3000000000000003, 98.2, -3.3000000000000007, -3.2000000000000006, -3.600000000000001, -10.4, -3.4000000000000004, -3.500000000000001, -10.4, -3.7000000000000006, -3.600000000000001, -3.7000000000000006, -10.2, -3.600000000000001, -3.3000000000000007, -3.5000000000000004, 98.8, -11.4, -3.400000000000001, -10.1, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.7000000000000006, -3.3000000000000007, -3.3000000000000003, -3.5000000000000004, -10.9, -3.3000000000000007, -3.500000000000001, -3.6000000000000005, -3.3000000000000003, -11.6, -3.1000000000000005, -3.3000000000000003, -3.500000000000001, -3.4000000000000004, -3.2000000000000006, -3.500000000000001, -11.700000000000001, -3.3000000000000007, -12.3, -3.2, -3.7000000000000006, -3.4000000000000004, -10.3, -3.400000000000001, -10.8, -10.7, -10.2, -3.6000000000000014, -11.6, -3.6000000000000005, -3.500000000000001, -3.400000000000001, -11.6, -3.500000000000001, -3.1000000000000005, -3.400000000000001, -3.500000000000001, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.4000000000000004, -3.500000000000001, -3.2000000000000006, -3.400000000000001, -3.500000000000001, -3.3000000000000007, -3.500000000000001, -11.1, -3.400000000000001, -3.3000000000000007, -3.6000000000000005, -3.500000000000001, -3.500000000000001, -3.4000000000000004, -11.1, -3.5000000000000004, -3.3000000000000007, -3.500000000000001, -3.500000000000001, -3.6000000000000005, -3.6, -3.5000000000000004, -11.6, -3.5000000000000004, -3.2000000000000006, -3.400000000000001, -11.6, -3.4000000000000004, -3.400000000000001, -10.9, -3.500000000000001], "episode_lengths": [21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 8, 9, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 18, 11, 5, 21, 21, 21, 21, 4, 21, 12, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 10, 21, 21, 21, 21, 21, 17, 21, 21, 21, 5, 21, 21, 4, 21, 21, 21, 3, 21, 21, 21, 10, 14, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 14, 21, 18, 21, 21, 21, 4, 21, 9, 7, 3, 21, 14, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 14, 21, 21, 10, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.444099260379755, "mean_inference_ms": 17.416549735724658, "mean_action_processing_ms": 0.9264509155021433, "mean_env_wait_ms": 2.132766883523834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07784777280816621, "StateBufferConnector_ms": 0.009926882657137785, "ViewRequirementAgentConnector_ms": 0.142681199397767}}, "episode_reward_max": 98.8, "episode_reward_min": -12.3, "episode_reward_mean": -3.828229665071771, "episode_len_mean": 19.0, "episodes_this_iter": 209, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.2000000000000006, -3.2000000000000006, -3.5000000000000004, -3.3000000000000007, -12.100000000000001, -3.400000000000001, -3.4000000000000004, -3.400000000000001, -3.4000000000000004, -3.7000000000000006, -3.2000000000000006, -3.4000000000000004, -3.3000000000000003, -3.200000000000001, -3.5000000000000004, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.200000000000001, -11.8, -3.3000000000000007, -3.500000000000001, -10.8, -11.1, -3.3000000000000007, -3.500000000000001, -3.3000000000000007, -3.3000000000000007, -3.2, -3.3000000000000003, -10.7, -3.500000000000001, -3.200000000000001, -3.400000000000001, -3.5000000000000004, -3.600000000000001, -3.1000000000000005, -3.300000000000001, -3.300000000000001, -3.500000000000001, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.500000000000001, -11.6, -3.3000000000000007, -3.600000000000001, -3.5000000000000004, -3.7000000000000006, -3.5000000000000013, -12.0, -3.3000000000000003, -3.1000000000000005, -3.5000000000000004, -3.400000000000001, -12.100000000000001, -11.1, -10.5, -3.3000000000000007, -3.3000000000000007, -3.600000000000001, -3.3000000000000007, -10.4, -3.3000000000000003, -11.1, -10.2, -3.200000000000001, -3.3000000000000003, -3.5000000000000004, -3.600000000000001, -3.600000000000001, -3.500000000000001, -3.5000000000000013, -3.600000000000001, -3.5000000000000004, -10.0, -3.5000000000000004, -3.5000000000000004, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.400000000000001, -3.3000000000000003, -11.6, -3.4000000000000004, -3.500000000000001, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.7000000000000006, -11.9, -3.400000000000001, -3.6000000000000005, -3.600000000000001, -3.1000000000000005, -3.700000000000001, -3.4000000000000004, -3.4000000000000004, -3.3000000000000007, -3.6000000000000005, -3.3000000000000007, -3.700000000000001, -11.0, -3.5000000000000004, -3.8000000000000007, -11.1, -3.400000000000001, -3.8000000000000007, -3.5000000000000004, -3.600000000000001, -3.3000000000000003, 98.2, -3.3000000000000007, -3.2000000000000006, -3.600000000000001, -10.4, -3.4000000000000004, -3.500000000000001, -10.4, -3.7000000000000006, -3.600000000000001, -3.7000000000000006, -10.2, -3.600000000000001, -3.3000000000000007, -3.5000000000000004, 98.8, -11.4, -3.400000000000001, -10.1, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.7000000000000006, -3.3000000000000007, -3.3000000000000003, -3.5000000000000004, -10.9, -3.3000000000000007, -3.500000000000001, -3.6000000000000005, -3.3000000000000003, -11.6, -3.1000000000000005, -3.3000000000000003, -3.500000000000001, -3.4000000000000004, -3.2000000000000006, -3.500000000000001, -11.700000000000001, -3.3000000000000007, -12.3, -3.2, -3.7000000000000006, -3.4000000000000004, -10.3, -3.400000000000001, -10.8, -10.7, -10.2, -3.6000000000000014, -11.6, -3.6000000000000005, -3.500000000000001, -3.400000000000001, -11.6, -3.500000000000001, -3.1000000000000005, -3.400000000000001, -3.500000000000001, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.4000000000000004, -3.500000000000001, -3.2000000000000006, -3.400000000000001, -3.500000000000001, -3.3000000000000007, -3.500000000000001, -11.1, -3.400000000000001, -3.3000000000000007, -3.6000000000000005, -3.500000000000001, -3.500000000000001, -3.4000000000000004, -11.1, -3.5000000000000004, -3.3000000000000007, -3.500000000000001, -3.500000000000001, -3.6000000000000005, -3.6, -3.5000000000000004, -11.6, -3.5000000000000004, -3.2000000000000006, -3.400000000000001, -11.6, -3.4000000000000004, -3.400000000000001, -10.9, -3.500000000000001], "episode_lengths": [21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 8, 9, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 18, 11, 5, 21, 21, 21, 21, 4, 21, 12, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 10, 21, 21, 21, 21, 21, 17, 21, 21, 21, 5, 21, 21, 4, 21, 21, 21, 3, 21, 21, 21, 10, 14, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 14, 21, 18, 21, 21, 21, 4, 21, 9, 7, 3, 21, 14, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 14, 21, 21, 10, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.444099260379755, "mean_inference_ms": 17.416549735724658, "mean_action_processing_ms": 0.9264509155021433, "mean_env_wait_ms": 2.132766883523834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07784777280816621, "StateBufferConnector_ms": 0.009926882657137785, "ViewRequirementAgentConnector_ms": 0.142681199397767}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 171262.722, "load_time_ms": 1.159, "load_throughput": 3451604.913, "learn_time_ms": 170161.162, "learn_throughput": 23.507, "synch_weights_time_ms": 212.158}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "episodes_total": 3371, "training_iteration": 16, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-06_21-41-23", "timestamp": 1680810083, "time_this_iter_s": 170.69750809669495, "time_total_s": 2737.721419811249, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476f23d0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0147643ee0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 2737.721419811249, "timesteps_since_restore": 0, "iterations_since_restore": 16, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.493004115226336, "ram_util_percent": 23.590534979423868}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1024582321445147, "cur_kl_coeff": 2.2781249999999993, "cur_lr": 0.0010000000000000005, "total_loss": 0.426084396325212, "policy_loss": -0.03744422472207256, "vf_loss": 0.44779901452743076, "vf_explained_var": 0.45853150615128135, "kl": 0.006904628831437559, "entropy": 3.977202929476256, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 15345.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "sampler_results": {"episode_reward_max": 98.1, "episode_reward_min": -12.200000000000001, "episode_reward_mean": -4.050490196078432, "episode_len_mean": 19.44607843137255, "episode_media": {}, "episodes_this_iter": 204, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.600000000000001, -3.5000000000000013, -3.7000000000000006, -3.2, -3.7000000000000006, -3.4000000000000004, -12.100000000000001, -3.700000000000001, -10.4, -3.4000000000000004, -3.300000000000001, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.4000000000000012, -3.4000000000000012, -3.6000000000000005, -3.3000000000000003, -3.3000000000000007, -3.600000000000001, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.500000000000001, -3.500000000000001, -3.8000000000000007, -11.9, -12.200000000000001, -10.1, -3.500000000000001, -3.500000000000001, -3.700000000000001, -3.3000000000000007, -3.600000000000001, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.6000000000000005, -3.3000000000000007, -3.4000000000000004, -3.4000000000000004, -3.6000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.5000000000000004, -3.400000000000001, -3.7000000000000006, -3.4000000000000004, -3.600000000000001, -10.3, -3.400000000000001, -3.3000000000000007, -3.8000000000000007, -3.400000000000001, -3.3000000000000007, -11.7, -3.400000000000001, -3.5000000000000004, -10.1, -3.3000000000000003, -10.3, -3.1000000000000005, -3.400000000000001, -3.5000000000000004, -3.700000000000001, -3.3000000000000003, -11.4, -3.500000000000001, -3.400000000000001, -3.600000000000001, -3.6000000000000005, -3.3000000000000007, -3.7000000000000006, -3.4000000000000004, -3.600000000000001, -3.3000000000000007, -3.400000000000001, 98.1, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.6000000000000005, -3.4000000000000004, -3.2000000000000006, -3.400000000000001, -3.3000000000000003, -3.1000000000000005, -10.8, -3.400000000000001, -3.600000000000001, -3.400000000000001, -12.1, -3.2000000000000006, -3.6000000000000005, -3.6000000000000005, -3.3000000000000007, -10.7, -3.2000000000000006, -10.6, -12.0, -11.2, -3.4000000000000004, -10.0, -3.3000000000000003, -3.3000000000000007, -3.600000000000001, -3.5000000000000004, -11.5, -11.4, -3.4000000000000004, -3.3000000000000007, -3.5000000000000004, -3.600000000000001, -3.2000000000000006, -3.500000000000001, -3.800000000000001, -3.6000000000000005, -3.4000000000000012, -3.900000000000001, -3.800000000000001, -10.0, -3.500000000000001, -3.600000000000001, -3.6000000000000005, -3.200000000000001, -3.3000000000000007, -3.500000000000001, -3.3000000000000003, -11.5, -3.3000000000000007, -10.3, -3.3000000000000003, -3.5000000000000004, -3.400000000000001, -3.600000000000001, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -11.8, -3.3000000000000007, -3.4000000000000004, -10.8, -3.400000000000001, -3.400000000000001, -3.100000000000001, -3.2000000000000006, -3.5000000000000004, -3.1000000000000005, -3.5000000000000004, -11.8, -3.400000000000001, -3.3000000000000003, -3.5000000000000004, -3.400000000000001, -3.400000000000001, -3.7000000000000006, -3.500000000000001, -3.7000000000000006, -11.7, -3.8000000000000003, -10.7, -3.3000000000000003, -3.8000000000000007, -3.4000000000000004, -3.6000000000000005, -10.8, -3.300000000000001, -3.3000000000000007, -3.7000000000000006, -3.400000000000001, -3.500000000000001, -3.5000000000000004, -3.7000000000000006, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.5000000000000004, -3.2000000000000006, -3.1000000000000005, -3.500000000000001, -11.7, -3.500000000000001, -3.800000000000001, -11.3, -3.4000000000000004, -3.3000000000000007, -3.2, -3.200000000000001, -3.2000000000000006], "episode_lengths": [21, 21, 21, 21, 21, 21, 19, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 18, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 17, 21, 21, 2, 21, 4, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 18, 21, 21, 21, 21, 7, 21, 7, 19, 11, 21, 1, 21, 21, 21, 21, 14, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21, 15, 21, 4, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 7, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 13, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.462250918161944, "mean_inference_ms": 17.435748011197674, "mean_action_processing_ms": 0.9252933271113165, "mean_env_wait_ms": 2.1296246934256495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07239802210938696, "StateBufferConnector_ms": 0.009165441288667567, "ViewRequirementAgentConnector_ms": 0.1347047441145953}}, "episode_reward_max": 98.1, "episode_reward_min": -12.200000000000001, "episode_reward_mean": -4.050490196078432, "episode_len_mean": 19.44607843137255, "episodes_this_iter": 204, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.600000000000001, -3.5000000000000013, -3.7000000000000006, -3.2, -3.7000000000000006, -3.4000000000000004, -12.100000000000001, -3.700000000000001, -10.4, -3.4000000000000004, -3.300000000000001, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.4000000000000012, -3.4000000000000012, -3.6000000000000005, -3.3000000000000003, -3.3000000000000007, -3.600000000000001, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.500000000000001, -3.500000000000001, -3.8000000000000007, -11.9, -12.200000000000001, -10.1, -3.500000000000001, -3.500000000000001, -3.700000000000001, -3.3000000000000007, -3.600000000000001, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.6000000000000005, -3.3000000000000007, -3.4000000000000004, -3.4000000000000004, -3.6000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.5000000000000004, -3.400000000000001, -3.7000000000000006, -3.4000000000000004, -3.600000000000001, -10.3, -3.400000000000001, -3.3000000000000007, -3.8000000000000007, -3.400000000000001, -3.3000000000000007, -11.7, -3.400000000000001, -3.5000000000000004, -10.1, -3.3000000000000003, -10.3, -3.1000000000000005, -3.400000000000001, -3.5000000000000004, -3.700000000000001, -3.3000000000000003, -11.4, -3.500000000000001, -3.400000000000001, -3.600000000000001, -3.6000000000000005, -3.3000000000000007, -3.7000000000000006, -3.4000000000000004, -3.600000000000001, -3.3000000000000007, -3.400000000000001, 98.1, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.6000000000000005, -3.4000000000000004, -3.2000000000000006, -3.400000000000001, -3.3000000000000003, -3.1000000000000005, -10.8, -3.400000000000001, -3.600000000000001, -3.400000000000001, -12.1, -3.2000000000000006, -3.6000000000000005, -3.6000000000000005, -3.3000000000000007, -10.7, -3.2000000000000006, -10.6, -12.0, -11.2, -3.4000000000000004, -10.0, -3.3000000000000003, -3.3000000000000007, -3.600000000000001, -3.5000000000000004, -11.5, -11.4, -3.4000000000000004, -3.3000000000000007, -3.5000000000000004, -3.600000000000001, -3.2000000000000006, -3.500000000000001, -3.800000000000001, -3.6000000000000005, -3.4000000000000012, -3.900000000000001, -3.800000000000001, -10.0, -3.500000000000001, -3.600000000000001, -3.6000000000000005, -3.200000000000001, -3.3000000000000007, -3.500000000000001, -3.3000000000000003, -11.5, -3.3000000000000007, -10.3, -3.3000000000000003, -3.5000000000000004, -3.400000000000001, -3.600000000000001, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -11.8, -3.3000000000000007, -3.4000000000000004, -10.8, -3.400000000000001, -3.400000000000001, -3.100000000000001, -3.2000000000000006, -3.5000000000000004, -3.1000000000000005, -3.5000000000000004, -11.8, -3.400000000000001, -3.3000000000000003, -3.5000000000000004, -3.400000000000001, -3.400000000000001, -3.7000000000000006, -3.500000000000001, -3.7000000000000006, -11.7, -3.8000000000000003, -10.7, -3.3000000000000003, -3.8000000000000007, -3.4000000000000004, -3.6000000000000005, -10.8, -3.300000000000001, -3.3000000000000007, -3.7000000000000006, -3.400000000000001, -3.500000000000001, -3.5000000000000004, -3.7000000000000006, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.5000000000000004, -3.2000000000000006, -3.1000000000000005, -3.500000000000001, -11.7, -3.500000000000001, -3.800000000000001, -11.3, -3.4000000000000004, -3.3000000000000007, -3.2, -3.200000000000001, -3.2000000000000006], "episode_lengths": [21, 21, 21, 21, 21, 21, 19, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 18, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 17, 21, 21, 2, 21, 4, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 18, 21, 21, 21, 21, 7, 21, 7, 19, 11, 21, 1, 21, 21, 21, 21, 14, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21, 15, 21, 4, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 7, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 13, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.462250918161944, "mean_inference_ms": 17.435748011197674, "mean_action_processing_ms": 0.9252933271113165, "mean_env_wait_ms": 2.1296246934256495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07239802210938696, "StateBufferConnector_ms": 0.009165441288667567, "ViewRequirementAgentConnector_ms": 0.1347047441145953}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 171193.765, "load_time_ms": 1.158, "load_throughput": 3452812.513, "learn_time_ms": 170098.926, "learn_throughput": 23.516, "synch_weights_time_ms": 214.212}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "episodes_total": 3575, "training_iteration": 17, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-06_21-44-14", "timestamp": 1680810254, "time_this_iter_s": 171.0764672756195, "time_total_s": 2908.7978870868683, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476b9ca0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0147651ca0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 2908.7978870868683, "timesteps_since_restore": 0, "iterations_since_restore": 17, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.357201646090535, "ram_util_percent": 23.586008230452673}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2052602574709923, "cur_kl_coeff": 2.2781249999999993, "cur_lr": 0.0010000000000000005, "total_loss": 0.43284475925148175, "policy_loss": -0.09925280860675278, "vf_loss": 0.4992546306242065, "vf_explained_var": 0.5408888650196855, "kl": 0.014416651814670292, "entropy": 3.9678230626608735, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 16275.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": -3.1000000000000005, "episode_reward_min": -12.100000000000001, "episode_reward_mean": -4.248325358851675, "episode_len_mean": 19.74641148325359, "episode_media": {}, "episodes_this_iter": 209, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.600000000000001, -3.2000000000000006, -3.6000000000000005, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.500000000000001, -3.7000000000000006, -3.3000000000000003, -3.5000000000000004, -3.5000000000000004, -3.3000000000000007, -3.6000000000000005, -3.6000000000000014, -3.400000000000001, -3.500000000000001, -3.700000000000001, -3.4000000000000004, -3.7000000000000006, -10.6, -3.6000000000000005, -3.4000000000000012, -3.400000000000001, -3.5000000000000004, -3.6000000000000005, -3.4000000000000004, -3.400000000000001, -3.5000000000000004, -3.5000000000000004, -3.600000000000001, -3.2, -3.700000000000001, -3.6, -3.6000000000000005, -3.3000000000000007, -3.3000000000000003, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.600000000000001, -3.1000000000000005, -11.3, -3.4000000000000004, -3.400000000000001, -3.500000000000001, -3.500000000000001, -3.7000000000000006, -3.1000000000000005, -3.3000000000000007, -3.200000000000001, -3.2000000000000006, -3.4000000000000004, -10.2, -3.100000000000001, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.4000000000000004, -11.700000000000001, -3.5000000000000004, -12.0, -3.6000000000000005, -3.6000000000000014, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.7000000000000006, -3.600000000000001, -3.500000000000001, -3.3000000000000007, -3.700000000000001, -3.500000000000001, -3.5000000000000004, -3.400000000000001, -3.3000000000000007, -3.500000000000001, -3.800000000000001, -3.6000000000000005, -3.5, -3.5000000000000004, -10.4, -10.1, -3.500000000000001, -11.0, -3.4000000000000004, -3.3000000000000007, -3.300000000000001, -3.6000000000000005, -3.200000000000001, -3.500000000000001, -3.600000000000001, -3.6000000000000005, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.5000000000000004, -10.4, -3.400000000000001, -3.600000000000001, -11.0, -10.0, -3.200000000000001, -3.600000000000001, -3.2, -3.500000000000001, -3.5000000000000013, -3.500000000000001, -3.5000000000000004, -3.1000000000000005, -3.3000000000000007, -11.8, -3.400000000000001, -11.1, -3.600000000000001, -3.2, -10.5, -3.2, -10.5, -3.3000000000000003, -3.7000000000000006, -3.3000000000000007, -3.8000000000000007, -3.3000000000000007, -3.400000000000001, -3.500000000000001, -3.2000000000000006, -11.9, -3.500000000000001, -3.400000000000001, -3.400000000000001, -3.4000000000000004, -3.400000000000001, -3.500000000000001, -3.3000000000000007, -3.300000000000001, -11.7, -3.5000000000000004, -3.3000000000000007, -3.2, -11.2, -3.3000000000000003, -3.500000000000001, -3.400000000000001, -3.600000000000001, -3.400000000000001, -3.3000000000000003, -3.5000000000000004, -3.6000000000000005, -3.2000000000000006, -3.4000000000000004, -3.400000000000001, -3.5000000000000004, -3.4000000000000004, -10.2, -11.5, -3.400000000000001, -10.3, -3.3000000000000007, -3.500000000000001, -3.4000000000000004, -3.500000000000001, -3.400000000000001, -3.200000000000001, -3.3000000000000007, -3.3000000000000007, -11.7, -3.400000000000001, -3.4000000000000004, -3.400000000000001, -3.3000000000000007, -3.4000000000000004, -3.5000000000000004, -3.400000000000001, -3.5000000000000013, -3.4000000000000004, -3.500000000000001, -3.600000000000001, -3.3000000000000003, -12.100000000000001, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.7000000000000006, -3.400000000000001, -3.600000000000001, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.5000000000000004, -3.6000000000000005, -3.900000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 15, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 2, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 10, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 10, 21, 21, 5, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 13, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.453225958021683, "mean_inference_ms": 17.42511160004063, "mean_action_processing_ms": 0.9237154193498924, "mean_env_wait_ms": 2.130303958435306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07659476339531858, "StateBufferConnector_ms": 0.009703408017683258, "ViewRequirementAgentConnector_ms": 0.1399239854949513}}, "episode_reward_max": -3.1000000000000005, "episode_reward_min": -12.100000000000001, "episode_reward_mean": -4.248325358851675, "episode_len_mean": 19.74641148325359, "episodes_this_iter": 209, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.600000000000001, -3.2000000000000006, -3.6000000000000005, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.500000000000001, -3.7000000000000006, -3.3000000000000003, -3.5000000000000004, -3.5000000000000004, -3.3000000000000007, -3.6000000000000005, -3.6000000000000014, -3.400000000000001, -3.500000000000001, -3.700000000000001, -3.4000000000000004, -3.7000000000000006, -10.6, -3.6000000000000005, -3.4000000000000012, -3.400000000000001, -3.5000000000000004, -3.6000000000000005, -3.4000000000000004, -3.400000000000001, -3.5000000000000004, -3.5000000000000004, -3.600000000000001, -3.2, -3.700000000000001, -3.6, -3.6000000000000005, -3.3000000000000007, -3.3000000000000003, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.600000000000001, -3.1000000000000005, -11.3, -3.4000000000000004, -3.400000000000001, -3.500000000000001, -3.500000000000001, -3.7000000000000006, -3.1000000000000005, -3.3000000000000007, -3.200000000000001, -3.2000000000000006, -3.4000000000000004, -10.2, -3.100000000000001, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.4000000000000004, -11.700000000000001, -3.5000000000000004, -12.0, -3.6000000000000005, -3.6000000000000014, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.7000000000000006, -3.600000000000001, -3.500000000000001, -3.3000000000000007, -3.700000000000001, -3.500000000000001, -3.5000000000000004, -3.400000000000001, -3.3000000000000007, -3.500000000000001, -3.800000000000001, -3.6000000000000005, -3.5, -3.5000000000000004, -10.4, -10.1, -3.500000000000001, -11.0, -3.4000000000000004, -3.3000000000000007, -3.300000000000001, -3.6000000000000005, -3.200000000000001, -3.500000000000001, -3.600000000000001, -3.6000000000000005, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.5000000000000004, -10.4, -3.400000000000001, -3.600000000000001, -11.0, -10.0, -3.200000000000001, -3.600000000000001, -3.2, -3.500000000000001, -3.5000000000000013, -3.500000000000001, -3.5000000000000004, -3.1000000000000005, -3.3000000000000007, -11.8, -3.400000000000001, -11.1, -3.600000000000001, -3.2, -10.5, -3.2, -10.5, -3.3000000000000003, -3.7000000000000006, -3.3000000000000007, -3.8000000000000007, -3.3000000000000007, -3.400000000000001, -3.500000000000001, -3.2000000000000006, -11.9, -3.500000000000001, -3.400000000000001, -3.400000000000001, -3.4000000000000004, -3.400000000000001, -3.500000000000001, -3.3000000000000007, -3.300000000000001, -11.7, -3.5000000000000004, -3.3000000000000007, -3.2, -11.2, -3.3000000000000003, -3.500000000000001, -3.400000000000001, -3.600000000000001, -3.400000000000001, -3.3000000000000003, -3.5000000000000004, -3.6000000000000005, -3.2000000000000006, -3.4000000000000004, -3.400000000000001, -3.5000000000000004, -3.4000000000000004, -10.2, -11.5, -3.400000000000001, -10.3, -3.3000000000000007, -3.500000000000001, -3.4000000000000004, -3.500000000000001, -3.400000000000001, -3.200000000000001, -3.3000000000000007, -3.3000000000000007, -11.7, -3.400000000000001, -3.4000000000000004, -3.400000000000001, -3.3000000000000007, -3.4000000000000004, -3.5000000000000004, -3.400000000000001, -3.5000000000000013, -3.4000000000000004, -3.500000000000001, -3.600000000000001, -3.3000000000000003, -12.100000000000001, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.7000000000000006, -3.400000000000001, -3.600000000000001, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.5000000000000004, -3.6000000000000005, -3.900000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 15, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 2, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 10, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 10, 21, 21, 5, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 13, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.453225958021683, "mean_inference_ms": 17.42511160004063, "mean_action_processing_ms": 0.9237154193498924, "mean_env_wait_ms": 2.130303958435306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07659476339531858, "StateBufferConnector_ms": 0.009703408017683258, "ViewRequirementAgentConnector_ms": 0.1399239854949513}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 171144.637, "load_time_ms": 1.151, "load_throughput": 3475414.509, "learn_time_ms": 170143.381, "learn_throughput": 23.51, "synch_weights_time_ms": 214.337}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 3784, "training_iteration": 18, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-06_21-47-06", "timestamp": 1680810426, "time_this_iter_s": 171.52365636825562, "time_total_s": 3080.321543455124, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0147756eb0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014784a5e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 3080.321543455124, "timesteps_since_restore": 0, "iterations_since_restore": 18, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.744262295081968, "ram_util_percent": 23.547131147540984}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1350331846264101, "cur_kl_coeff": 2.2781249999999993, "cur_lr": 0.0010000000000000005, "total_loss": 0.8250306960698518, "policy_loss": -0.042151313620620724, "vf_loss": 0.851751655523455, "vf_explained_var": 0.35876192347977753, "kl": 0.0067732680081051865, "entropy": 3.962613283434222, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 17205.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "sampler_results": {"episode_reward_max": 99.2, "episode_reward_min": -12.4, "episode_reward_mean": -2.920095693779905, "episode_len_mean": 18.88995215311005, "episode_media": {}, "episodes_this_iter": 209, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.1000000000000005, -3.400000000000001, 97.8, -3.6, -3.5000000000000004, -11.9, -3.3000000000000007, -3.500000000000001, -3.3000000000000007, -3.400000000000001, -3.300000000000001, -3.400000000000001, -3.400000000000001, -3.1000000000000005, -3.400000000000001, -3.500000000000001, -3.3000000000000007, -3.100000000000001, -3.400000000000001, -3.2000000000000006, -3.500000000000001, -10.7, -3.5000000000000004, -3.500000000000001, -3.500000000000001, -3.600000000000001, -3.5000000000000004, -3.3000000000000007, -3.3000000000000007, -3.600000000000001, -3.6, -3.400000000000001, -3.400000000000001, -11.4, -3.400000000000001, -3.2000000000000006, -12.100000000000001, -3.3000000000000007, -3.3000000000000003, -3.400000000000001, -3.3000000000000003, -3.500000000000001, -3.400000000000001, -3.2000000000000006, -10.2, -3.400000000000001, -10.5, -3.500000000000001, -3.3000000000000007, -3.6000000000000005, -3.500000000000001, -11.3, -11.4, -3.2000000000000006, 98.6, -3.600000000000001, -3.5000000000000004, -3.0000000000000004, -12.4, -3.400000000000001, -3.3000000000000007, -3.3000000000000003, -10.3, -3.4000000000000012, -3.600000000000001, -3.5000000000000004, -3.5000000000000013, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.6000000000000005, -11.8, -3.600000000000001, -3.5, -3.800000000000001, -3.600000000000001, -3.400000000000001, -11.5, -3.4000000000000004, -3.500000000000001, -11.5, -3.5000000000000004, -3.3000000000000007, -3.300000000000001, -3.3000000000000003, -10.4, -3.3000000000000003, -11.7, -10.7, -10.5, -3.400000000000001, -10.8, -11.6, -3.3000000000000003, -10.1, -3.3000000000000003, -10.6, -3.600000000000001, -3.2, -3.500000000000001, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.100000000000001, -3.3000000000000007, -3.600000000000001, -3.5000000000000004, -3.1000000000000005, -3.500000000000001, -3.6000000000000005, -3.6000000000000005, -3.600000000000001, -3.2000000000000006, -3.2000000000000006, -3.500000000000001, -3.400000000000001, -3.2000000000000006, -3.5000000000000004, -3.3000000000000007, -3.400000000000001, -3.3000000000000003, -11.6, -3.5000000000000004, -11.2, -3.400000000000001, -3.5000000000000004, -3.4000000000000004, -3.2000000000000006, 98.0, -11.0, -3.2000000000000006, -10.4, -3.400000000000001, -10.4, -11.9, 99.2, -3.400000000000001, -3.500000000000001, -3.5000000000000004, -3.600000000000001, -10.8, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -10.2, -3.500000000000001, -3.2, -10.6, -3.400000000000001, -12.200000000000001, -3.400000000000001, -3.400000000000001, -3.4000000000000004, -3.6000000000000005, -3.3000000000000003, -3.400000000000001, -10.6, -3.2000000000000006, -3.2000000000000006, -3.500000000000001, -3.7000000000000006, -3.3000000000000003, -3.200000000000001, -3.2000000000000006, -3.4000000000000012, -3.600000000000001, -3.600000000000001, -3.7000000000000006, -11.700000000000001, -3.4000000000000004, -3.5000000000000004, -3.2, -3.2, -3.3000000000000003, -3.500000000000001, -11.3, -3.600000000000001, -3.5000000000000004, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.700000000000001, -3.500000000000001, -3.3000000000000003, -3.3000000000000007, -11.8, -3.6000000000000005, -3.500000000000001, -3.1000000000000005, -3.4000000000000012, -3.2000000000000006, -3.4000000000000004, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.700000000000001, -3.3000000000000007, -10.2, -11.6, -10.2, -3.4000000000000004, -3.4000000000000004, -3.500000000000001, -11.8, -3.4000000000000004, -12.0, -3.1000000000000005], "episode_lengths": [21, 21, 18, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 3, 21, 6, 21, 21, 21, 21, 11, 13, 21, 13, 21, 21, 21, 19, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 12, 21, 21, 15, 21, 21, 21, 21, 5, 21, 15, 6, 6, 21, 8, 15, 21, 2, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 12, 21, 21, 21, 21, 20, 11, 21, 5, 21, 4, 17, 9, 21, 21, 21, 21, 9, 21, 21, 21, 3, 21, 21, 7, 21, 19, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 14, 3, 21, 21, 21, 14, 21, 17, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.470625137773476, "mean_inference_ms": 17.419267666946332, "mean_action_processing_ms": 0.9218453866932532, "mean_env_wait_ms": 2.125476868344931, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07439104563881906, "StateBufferConnector_ms": 0.009830716694370982, "ViewRequirementAgentConnector_ms": 0.13720726852782034}}, "episode_reward_max": 99.2, "episode_reward_min": -12.4, "episode_reward_mean": -2.920095693779905, "episode_len_mean": 18.88995215311005, "episodes_this_iter": 209, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.1000000000000005, -3.400000000000001, 97.8, -3.6, -3.5000000000000004, -11.9, -3.3000000000000007, -3.500000000000001, -3.3000000000000007, -3.400000000000001, -3.300000000000001, -3.400000000000001, -3.400000000000001, -3.1000000000000005, -3.400000000000001, -3.500000000000001, -3.3000000000000007, -3.100000000000001, -3.400000000000001, -3.2000000000000006, -3.500000000000001, -10.7, -3.5000000000000004, -3.500000000000001, -3.500000000000001, -3.600000000000001, -3.5000000000000004, -3.3000000000000007, -3.3000000000000007, -3.600000000000001, -3.6, -3.400000000000001, -3.400000000000001, -11.4, -3.400000000000001, -3.2000000000000006, -12.100000000000001, -3.3000000000000007, -3.3000000000000003, -3.400000000000001, -3.3000000000000003, -3.500000000000001, -3.400000000000001, -3.2000000000000006, -10.2, -3.400000000000001, -10.5, -3.500000000000001, -3.3000000000000007, -3.6000000000000005, -3.500000000000001, -11.3, -11.4, -3.2000000000000006, 98.6, -3.600000000000001, -3.5000000000000004, -3.0000000000000004, -12.4, -3.400000000000001, -3.3000000000000007, -3.3000000000000003, -10.3, -3.4000000000000012, -3.600000000000001, -3.5000000000000004, -3.5000000000000013, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.6000000000000005, -11.8, -3.600000000000001, -3.5, -3.800000000000001, -3.600000000000001, -3.400000000000001, -11.5, -3.4000000000000004, -3.500000000000001, -11.5, -3.5000000000000004, -3.3000000000000007, -3.300000000000001, -3.3000000000000003, -10.4, -3.3000000000000003, -11.7, -10.7, -10.5, -3.400000000000001, -10.8, -11.6, -3.3000000000000003, -10.1, -3.3000000000000003, -10.6, -3.600000000000001, -3.2, -3.500000000000001, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.100000000000001, -3.3000000000000007, -3.600000000000001, -3.5000000000000004, -3.1000000000000005, -3.500000000000001, -3.6000000000000005, -3.6000000000000005, -3.600000000000001, -3.2000000000000006, -3.2000000000000006, -3.500000000000001, -3.400000000000001, -3.2000000000000006, -3.5000000000000004, -3.3000000000000007, -3.400000000000001, -3.3000000000000003, -11.6, -3.5000000000000004, -11.2, -3.400000000000001, -3.5000000000000004, -3.4000000000000004, -3.2000000000000006, 98.0, -11.0, -3.2000000000000006, -10.4, -3.400000000000001, -10.4, -11.9, 99.2, -3.400000000000001, -3.500000000000001, -3.5000000000000004, -3.600000000000001, -10.8, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -10.2, -3.500000000000001, -3.2, -10.6, -3.400000000000001, -12.200000000000001, -3.400000000000001, -3.400000000000001, -3.4000000000000004, -3.6000000000000005, -3.3000000000000003, -3.400000000000001, -10.6, -3.2000000000000006, -3.2000000000000006, -3.500000000000001, -3.7000000000000006, -3.3000000000000003, -3.200000000000001, -3.2000000000000006, -3.4000000000000012, -3.600000000000001, -3.600000000000001, -3.7000000000000006, -11.700000000000001, -3.4000000000000004, -3.5000000000000004, -3.2, -3.2, -3.3000000000000003, -3.500000000000001, -11.3, -3.600000000000001, -3.5000000000000004, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.700000000000001, -3.500000000000001, -3.3000000000000003, -3.3000000000000007, -11.8, -3.6000000000000005, -3.500000000000001, -3.1000000000000005, -3.4000000000000012, -3.2000000000000006, -3.4000000000000004, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.700000000000001, -3.3000000000000007, -10.2, -11.6, -10.2, -3.4000000000000004, -3.4000000000000004, -3.500000000000001, -11.8, -3.4000000000000004, -12.0, -3.1000000000000005], "episode_lengths": [21, 21, 18, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 3, 21, 6, 21, 21, 21, 21, 11, 13, 21, 13, 21, 21, 21, 19, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 12, 21, 21, 15, 21, 21, 21, 21, 5, 21, 15, 6, 6, 21, 8, 15, 21, 2, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 12, 21, 21, 21, 21, 20, 11, 21, 5, 21, 4, 17, 9, 21, 21, 21, 21, 9, 21, 21, 21, 3, 21, 21, 7, 21, 19, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 14, 3, 21, 21, 21, 14, 21, 17, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.470625137773476, "mean_inference_ms": 17.419267666946332, "mean_action_processing_ms": 0.9218453866932532, "mean_env_wait_ms": 2.125476868344931, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07439104563881906, "StateBufferConnector_ms": 0.009830716694370982, "ViewRequirementAgentConnector_ms": 0.13720726852782034}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 171180.021, "load_time_ms": 1.138, "load_throughput": 3513921.039, "learn_time_ms": 170182.375, "learn_throughput": 23.504, "synch_weights_time_ms": 212.784}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "episodes_total": 3993, "training_iteration": 19, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-06_21-49-57", "timestamp": 1680810597, "time_this_iter_s": 171.0201494693756, "time_total_s": 3251.3416929244995, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01477a3940>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0147643670>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 3251.3416929244995, "timesteps_since_restore": 0, "iterations_since_restore": 19, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.439094650205761, "ram_util_percent": 23.517695473251027}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0756645814545693, "cur_kl_coeff": 2.2781249999999993, "cur_lr": 0.0010000000000000005, "total_loss": 0.808186381770378, "policy_loss": -0.04578918308014631, "vf_loss": 0.834453009749933, "vf_explained_var": 0.319638608155712, "kl": 0.00856957097878299, "entropy": 3.9589989482715566, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 18135.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "sampler_results": {"episode_reward_max": 97.7, "episode_reward_min": -12.3, "episode_reward_mean": -4.353773584905661, "episode_len_mean": 19.14622641509434, "episode_media": {}, "episodes_this_iter": 212, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.2000000000000006, -3.400000000000001, -3.300000000000001, -3.500000000000001, -3.4000000000000004, -3.5000000000000004, -3.2000000000000006, -3.400000000000001, -3.5000000000000013, -3.4000000000000004, -12.1, -3.8000000000000003, -3.3000000000000007, -3.6000000000000005, -3.5000000000000004, -3.1000000000000005, -3.6000000000000005, -3.500000000000001, -3.200000000000001, -3.500000000000001, -3.500000000000001, -3.5000000000000004, -3.600000000000001, -3.3000000000000007, -3.7000000000000006, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -3.5000000000000004, -3.5000000000000004, -3.600000000000001, -3.4000000000000004, -3.300000000000001, -3.6000000000000005, -3.6000000000000005, -3.7000000000000006, -3.400000000000001, -11.7, -12.200000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.600000000000001, -11.3, -3.6000000000000005, -3.400000000000001, -3.1000000000000005, -11.3, -3.200000000000001, -3.7000000000000006, -3.1000000000000005, -3.5000000000000004, -3.5000000000000004, -3.4000000000000004, -3.2000000000000006, -3.8000000000000007, -10.5, -3.3000000000000003, -3.5000000000000004, -3.2000000000000006, -3.500000000000001, -3.2000000000000006, -3.3000000000000007, -3.5000000000000004, -3.5000000000000004, -3.3000000000000003, -3.300000000000001, -10.1, -3.5000000000000004, -3.700000000000001, -3.6000000000000005, -3.6000000000000005, -3.5000000000000004, -3.6000000000000005, -3.4000000000000004, -3.3000000000000007, 97.7, -3.2000000000000006, -10.9, -3.5000000000000004, -11.1, -3.400000000000001, -3.2000000000000006, -3.4000000000000004, -3.5000000000000004, -11.4, -10.3, -3.6000000000000005, -10.8, -3.700000000000001, -3.3000000000000007, -3.3000000000000007, -3.4000000000000004, -12.3, -3.400000000000001, -3.4000000000000004, -3.5000000000000004, -3.600000000000001, -3.5000000000000004, -3.500000000000001, -3.2000000000000006, -3.600000000000001, -11.3, -12.0, -3.4000000000000004, -3.4000000000000004, -3.1000000000000005, -3.3000000000000007, -10.7, -10.9, -3.7000000000000006, -3.2000000000000006, -3.2, -3.500000000000001, -3.700000000000001, -3.1000000000000005, -3.600000000000001, -3.700000000000001, -3.3000000000000007, -11.0, -3.2000000000000006, -3.600000000000001, -3.6000000000000005, -10.8, -3.2000000000000006, -3.3000000000000007, -3.5000000000000004, -3.4000000000000004, -11.0, -3.6000000000000005, -10.8, -3.2000000000000006, -3.400000000000001, -12.100000000000001, -3.500000000000001, -3.400000000000001, -3.100000000000001, -3.4000000000000004, -11.3, -3.2000000000000006, -3.300000000000001, -3.400000000000001, -10.0, -3.4000000000000004, -3.700000000000001, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.500000000000001, -3.3000000000000003, -3.500000000000001, -11.5, -3.900000000000001, -3.4000000000000004, -3.500000000000001, -3.100000000000001, -3.2000000000000006, -10.1, -3.600000000000001, -3.3000000000000007, -3.6000000000000005, -3.2000000000000006, -10.5, -3.500000000000001, -3.0000000000000004, -3.3000000000000007, -11.7, -3.3000000000000007, -3.2000000000000006, -10.9, -3.500000000000001, -12.3, -3.400000000000001, -10.2, -3.500000000000001, -12.1, -3.4000000000000004, -11.6, -10.9, -3.2, -3.2000000000000006, -3.400000000000001, -3.500000000000001, -3.100000000000001, -3.7000000000000006, -3.4000000000000004, -3.6000000000000005, -3.2, -3.2000000000000006, -3.2000000000000006, -11.3, -3.1000000000000005, -3.5000000000000004, -3.500000000000001, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.500000000000001, -11.1, -3.3000000000000007, -3.600000000000001, -3.500000000000001, -11.700000000000001, -3.2000000000000006, -3.500000000000001, -3.7000000000000006, -3.3000000000000003, -10.7, -3.400000000000001, -10.5, -3.500000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 20, 21, 21, 21, 21, 21, 13, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 9, 21, 11, 21, 21, 21, 21, 13, 4, 21, 9, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 11, 17, 21, 21, 21, 21, 7, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 9, 21, 21, 21, 21, 10, 21, 8, 21, 21, 19, 21, 21, 21, 21, 12, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 5, 21, 21, 21, 15, 21, 21, 10, 21, 20, 21, 3, 21, 18, 21, 15, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 14, 21, 21, 21, 21, 7, 21, 6, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.451624808017323, "mean_inference_ms": 17.45662020665474, "mean_action_processing_ms": 0.9220268217831765, "mean_env_wait_ms": 2.126353368003952, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07712998480167028, "StateBufferConnector_ms": 0.01041383113501207, "ViewRequirementAgentConnector_ms": 0.1402871788672681}}, "episode_reward_max": 97.7, "episode_reward_min": -12.3, "episode_reward_mean": -4.353773584905661, "episode_len_mean": 19.14622641509434, "episodes_this_iter": 212, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.2000000000000006, -3.400000000000001, -3.300000000000001, -3.500000000000001, -3.4000000000000004, -3.5000000000000004, -3.2000000000000006, -3.400000000000001, -3.5000000000000013, -3.4000000000000004, -12.1, -3.8000000000000003, -3.3000000000000007, -3.6000000000000005, -3.5000000000000004, -3.1000000000000005, -3.6000000000000005, -3.500000000000001, -3.200000000000001, -3.500000000000001, -3.500000000000001, -3.5000000000000004, -3.600000000000001, -3.3000000000000007, -3.7000000000000006, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -3.5000000000000004, -3.5000000000000004, -3.600000000000001, -3.4000000000000004, -3.300000000000001, -3.6000000000000005, -3.6000000000000005, -3.7000000000000006, -3.400000000000001, -11.7, -12.200000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.600000000000001, -11.3, -3.6000000000000005, -3.400000000000001, -3.1000000000000005, -11.3, -3.200000000000001, -3.7000000000000006, -3.1000000000000005, -3.5000000000000004, -3.5000000000000004, -3.4000000000000004, -3.2000000000000006, -3.8000000000000007, -10.5, -3.3000000000000003, -3.5000000000000004, -3.2000000000000006, -3.500000000000001, -3.2000000000000006, -3.3000000000000007, -3.5000000000000004, -3.5000000000000004, -3.3000000000000003, -3.300000000000001, -10.1, -3.5000000000000004, -3.700000000000001, -3.6000000000000005, -3.6000000000000005, -3.5000000000000004, -3.6000000000000005, -3.4000000000000004, -3.3000000000000007, 97.7, -3.2000000000000006, -10.9, -3.5000000000000004, -11.1, -3.400000000000001, -3.2000000000000006, -3.4000000000000004, -3.5000000000000004, -11.4, -10.3, -3.6000000000000005, -10.8, -3.700000000000001, -3.3000000000000007, -3.3000000000000007, -3.4000000000000004, -12.3, -3.400000000000001, -3.4000000000000004, -3.5000000000000004, -3.600000000000001, -3.5000000000000004, -3.500000000000001, -3.2000000000000006, -3.600000000000001, -11.3, -12.0, -3.4000000000000004, -3.4000000000000004, -3.1000000000000005, -3.3000000000000007, -10.7, -10.9, -3.7000000000000006, -3.2000000000000006, -3.2, -3.500000000000001, -3.700000000000001, -3.1000000000000005, -3.600000000000001, -3.700000000000001, -3.3000000000000007, -11.0, -3.2000000000000006, -3.600000000000001, -3.6000000000000005, -10.8, -3.2000000000000006, -3.3000000000000007, -3.5000000000000004, -3.4000000000000004, -11.0, -3.6000000000000005, -10.8, -3.2000000000000006, -3.400000000000001, -12.100000000000001, -3.500000000000001, -3.400000000000001, -3.100000000000001, -3.4000000000000004, -11.3, -3.2000000000000006, -3.300000000000001, -3.400000000000001, -10.0, -3.4000000000000004, -3.700000000000001, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.500000000000001, -3.3000000000000003, -3.500000000000001, -11.5, -3.900000000000001, -3.4000000000000004, -3.500000000000001, -3.100000000000001, -3.2000000000000006, -10.1, -3.600000000000001, -3.3000000000000007, -3.6000000000000005, -3.2000000000000006, -10.5, -3.500000000000001, -3.0000000000000004, -3.3000000000000007, -11.7, -3.3000000000000007, -3.2000000000000006, -10.9, -3.500000000000001, -12.3, -3.400000000000001, -10.2, -3.500000000000001, -12.1, -3.4000000000000004, -11.6, -10.9, -3.2, -3.2000000000000006, -3.400000000000001, -3.500000000000001, -3.100000000000001, -3.7000000000000006, -3.4000000000000004, -3.6000000000000005, -3.2, -3.2000000000000006, -3.2000000000000006, -11.3, -3.1000000000000005, -3.5000000000000004, -3.500000000000001, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.500000000000001, -11.1, -3.3000000000000007, -3.600000000000001, -3.500000000000001, -11.700000000000001, -3.2000000000000006, -3.500000000000001, -3.7000000000000006, -3.3000000000000003, -10.7, -3.400000000000001, -10.5, -3.500000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 20, 21, 21, 21, 21, 21, 13, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 9, 21, 11, 21, 21, 21, 21, 13, 4, 21, 9, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 11, 17, 21, 21, 21, 21, 7, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 9, 21, 21, 21, 21, 10, 21, 8, 21, 21, 19, 21, 21, 21, 21, 12, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 5, 21, 21, 21, 15, 21, 21, 10, 21, 20, 21, 3, 21, 18, 21, 15, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 14, 21, 21, 21, 21, 7, 21, 6, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.451624808017323, "mean_inference_ms": 17.45662020665474, "mean_action_processing_ms": 0.9220268217831765, "mean_env_wait_ms": 2.126353368003952, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07712998480167028, "StateBufferConnector_ms": 0.01041383113501207, "ViewRequirementAgentConnector_ms": 0.1402871788672681}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 171239.495, "load_time_ms": 1.134, "load_throughput": 3526329.109, "learn_time_ms": 170212.788, "learn_throughput": 23.5, "synch_weights_time_ms": 199.737}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "episodes_total": 4205, "training_iteration": 20, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-06_21-52-49", "timestamp": 1680810769, "time_this_iter_s": 172.0822982788086, "time_total_s": 3423.423991203308, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0147659b20>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014764b3a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 3423.423991203308, "timesteps_since_restore": 0, "iterations_since_restore": 20, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.43591836734694, "ram_util_percent": 23.53265306122449}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.100172000178086, "cur_kl_coeff": 2.2781249999999993, "cur_lr": 0.0010000000000000005, "total_loss": 0.6986259506679872, "policy_loss": -0.04543681888458049, "vf_loss": 0.7252302343416358, "vf_explained_var": 0.41167900587922784, "kl": 0.008266680866216375, "entropy": 3.9606460789198517, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 19065.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "sampler_results": {"episode_reward_max": 98.9, "episode_reward_min": -12.5, "episode_reward_mean": -4.192118226600987, "episode_len_mean": 19.458128078817733, "episode_media": {}, "episodes_this_iter": 203, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.200000000000001, -3.3000000000000003, -3.2000000000000006, -3.5000000000000013, -3.500000000000001, -3.900000000000001, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.500000000000001, -3.5000000000000004, -3.1000000000000005, -3.4000000000000004, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.600000000000001, -3.3000000000000007, -3.300000000000001, -3.6000000000000005, -3.400000000000001, -3.4000000000000004, -3.5000000000000004, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.500000000000001, -3.3000000000000007, -3.4000000000000004, -3.400000000000001, 98.9, -3.3000000000000007, -11.6, -3.3000000000000007, -3.400000000000001, -3.6000000000000005, -3.500000000000001, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -10.4, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.4, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.3000000000000003, -3.500000000000001, -3.400000000000001, -3.3000000000000007, -3.4000000000000012, -3.1000000000000005, -3.400000000000001, -3.400000000000001, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -11.8, -3.1000000000000005, -3.5000000000000004, -12.100000000000001, -3.400000000000001, -3.4000000000000004, -3.400000000000001, -3.600000000000001, -11.5, -3.2000000000000006, -3.700000000000001, -3.5000000000000013, -3.600000000000001, -3.5, -3.3000000000000007, -10.6, -11.5, -3.500000000000001, -3.500000000000001, -11.3, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.3000000000000003, -3.3000000000000003, -3.4000000000000004, -3.4000000000000004, -3.3000000000000007, -11.1, -3.5000000000000004, -3.3000000000000007, -3.1000000000000005, -3.4000000000000004, -3.2, -3.600000000000001, -3.400000000000001, -12.1, -11.5, -10.5, -3.3000000000000007, -3.5000000000000004, -3.2000000000000006, -3.400000000000001, -3.500000000000001, -10.0, -3.400000000000001, -11.1, -12.3, -3.1000000000000005, -3.2000000000000006, -3.300000000000001, -3.500000000000001, -3.400000000000001, -3.6000000000000005, -3.5000000000000004, -3.3000000000000003, -3.3000000000000007, -3.300000000000001, -3.2000000000000006, -3.3000000000000007, -12.5, -10.1, -3.3000000000000007, -3.4000000000000004, -10.2, -3.500000000000001, -10.7, -11.8, -3.2000000000000006, -3.5000000000000004, -3.200000000000001, -3.400000000000001, -3.3000000000000007, -3.4, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.6000000000000005, -3.400000000000001, -11.2, -3.400000000000001, -3.4000000000000004, -3.6, -3.400000000000001, -11.5, -11.8, -11.8, -3.200000000000001, -3.3000000000000007, -3.4000000000000004, -3.400000000000001, -10.4, -3.400000000000001, -3.4000000000000004, -12.5, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -11.6, -3.4000000000000004, -11.9, -3.2000000000000006, -11.4, -3.5000000000000004, -3.300000000000001, -3.2000000000000006, -3.0000000000000004, -3.200000000000001, -3.400000000000001, -10.2, -11.0, -3.400000000000001, -3.5000000000000004, -3.6000000000000005, -3.6000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.600000000000001, -3.3000000000000007, -11.1, -3.300000000000001, -3.4000000000000004, -3.400000000000001, -3.600000000000001, -3.400000000000001, -3.5000000000000004, -3.400000000000001, -3.600000000000001, -3.400000000000001, -11.6, -3.3000000000000007, -3.600000000000001, -3.600000000000001, -3.4000000000000004, -3.500000000000001, -12.3, -3.2, -3.2000000000000006, -3.2000000000000006], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 18, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 6, 14, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 17, 13, 5, 21, 21, 21, 21, 21, 1, 21, 10, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 2, 21, 21, 3, 21, 8, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 15, 17, 15, 21, 21, 21, 21, 5, 21, 21, 19, 21, 21, 21, 15, 21, 15, 21, 12, 21, 21, 21, 21, 21, 21, 3, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 19, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.441483225554133, "mean_inference_ms": 17.417428668220463, "mean_action_processing_ms": 0.9197220104261227, "mean_env_wait_ms": 2.1267307592336864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07341471798901487, "StateBufferConnector_ms": 0.009472029549734933, "ViewRequirementAgentConnector_ms": 0.13468641365690184}}, "episode_reward_max": 98.9, "episode_reward_min": -12.5, "episode_reward_mean": -4.192118226600987, "episode_len_mean": 19.458128078817733, "episodes_this_iter": 203, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.200000000000001, -3.3000000000000003, -3.2000000000000006, -3.5000000000000013, -3.500000000000001, -3.900000000000001, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.500000000000001, -3.5000000000000004, -3.1000000000000005, -3.4000000000000004, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.600000000000001, -3.3000000000000007, -3.300000000000001, -3.6000000000000005, -3.400000000000001, -3.4000000000000004, -3.5000000000000004, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.500000000000001, -3.3000000000000007, -3.4000000000000004, -3.400000000000001, 98.9, -3.3000000000000007, -11.6, -3.3000000000000007, -3.400000000000001, -3.6000000000000005, -3.500000000000001, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -10.4, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.4, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.3000000000000003, -3.500000000000001, -3.400000000000001, -3.3000000000000007, -3.4000000000000012, -3.1000000000000005, -3.400000000000001, -3.400000000000001, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -11.8, -3.1000000000000005, -3.5000000000000004, -12.100000000000001, -3.400000000000001, -3.4000000000000004, -3.400000000000001, -3.600000000000001, -11.5, -3.2000000000000006, -3.700000000000001, -3.5000000000000013, -3.600000000000001, -3.5, -3.3000000000000007, -10.6, -11.5, -3.500000000000001, -3.500000000000001, -11.3, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.3000000000000003, -3.3000000000000003, -3.4000000000000004, -3.4000000000000004, -3.3000000000000007, -11.1, -3.5000000000000004, -3.3000000000000007, -3.1000000000000005, -3.4000000000000004, -3.2, -3.600000000000001, -3.400000000000001, -12.1, -11.5, -10.5, -3.3000000000000007, -3.5000000000000004, -3.2000000000000006, -3.400000000000001, -3.500000000000001, -10.0, -3.400000000000001, -11.1, -12.3, -3.1000000000000005, -3.2000000000000006, -3.300000000000001, -3.500000000000001, -3.400000000000001, -3.6000000000000005, -3.5000000000000004, -3.3000000000000003, -3.3000000000000007, -3.300000000000001, -3.2000000000000006, -3.3000000000000007, -12.5, -10.1, -3.3000000000000007, -3.4000000000000004, -10.2, -3.500000000000001, -10.7, -11.8, -3.2000000000000006, -3.5000000000000004, -3.200000000000001, -3.400000000000001, -3.3000000000000007, -3.4, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.6000000000000005, -3.400000000000001, -11.2, -3.400000000000001, -3.4000000000000004, -3.6, -3.400000000000001, -11.5, -11.8, -11.8, -3.200000000000001, -3.3000000000000007, -3.4000000000000004, -3.400000000000001, -10.4, -3.400000000000001, -3.4000000000000004, -12.5, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -11.6, -3.4000000000000004, -11.9, -3.2000000000000006, -11.4, -3.5000000000000004, -3.300000000000001, -3.2000000000000006, -3.0000000000000004, -3.200000000000001, -3.400000000000001, -10.2, -11.0, -3.400000000000001, -3.5000000000000004, -3.6000000000000005, -3.6000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.600000000000001, -3.3000000000000007, -11.1, -3.300000000000001, -3.4000000000000004, -3.400000000000001, -3.600000000000001, -3.400000000000001, -3.5000000000000004, -3.400000000000001, -3.600000000000001, -3.400000000000001, -11.6, -3.3000000000000007, -3.600000000000001, -3.600000000000001, -3.4000000000000004, -3.500000000000001, -12.3, -3.2, -3.2000000000000006, -3.2000000000000006], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 18, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 6, 14, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 17, 13, 5, 21, 21, 21, 21, 21, 1, 21, 10, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 2, 21, 21, 3, 21, 8, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 15, 17, 15, 21, 21, 21, 21, 5, 21, 21, 19, 21, 21, 21, 15, 21, 15, 21, 12, 21, 21, 21, 21, 21, 21, 3, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 19, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.441483225554133, "mean_inference_ms": 17.417428668220463, "mean_action_processing_ms": 0.9197220104261227, "mean_env_wait_ms": 2.1267307592336864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07341471798901487, "StateBufferConnector_ms": 0.009472029549734933, "ViewRequirementAgentConnector_ms": 0.13468641365690184}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 171210.167, "load_time_ms": 1.124, "load_throughput": 3558566.156, "learn_time_ms": 170193.863, "learn_throughput": 23.503, "synch_weights_time_ms": 201.388}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "episodes_total": 4408, "training_iteration": 21, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-06_21-55-40", "timestamp": 1680810940, "time_this_iter_s": 171.26345467567444, "time_total_s": 3594.6874458789825, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476d7f40>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01476431f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 3594.6874458789825, "timesteps_since_restore": 0, "iterations_since_restore": 21, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.650409836065574, "ram_util_percent": 23.592622950819674}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3227705901348463, "cur_kl_coeff": 2.2781249999999993, "cur_lr": 0.0010000000000000005, "total_loss": 0.7222171213958533, "policy_loss": -0.1272030391409913, "vf_loss": 0.8123116139452704, "vf_explained_var": 0.37660153027503723, "kl": 0.016289074465060376, "entropy": 3.944722484260477, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 19995.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.4, "episode_reward_mean": -5.02843137254902, "episode_len_mean": 19.112745098039216, "episode_media": {}, "episodes_this_iter": 204, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.5000000000000004, -3.3000000000000007, -3.200000000000001, -3.3000000000000007, -3.100000000000001, -3.400000000000001, -3.400000000000001, -3.2, -3.1000000000000005, -3.500000000000001, -10.9, -11.4, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.200000000000001, -3.7000000000000006, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.6000000000000005, -3.400000000000001, -10.9, -3.700000000000001, -3.5000000000000004, -3.6000000000000005, -3.400000000000001, -3.5000000000000004, -10.0, -3.3000000000000007, -3.4000000000000004, -3.3000000000000007, -12.100000000000001, -3.400000000000001, -3.400000000000001, -3.6000000000000005, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.5000000000000004, -11.9, -3.2000000000000006, -3.3000000000000007, -12.0, -3.2000000000000006, -3.500000000000001, -3.3000000000000007, -3.0000000000000004, -3.6000000000000005, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -11.0, -11.5, -3.3000000000000007, -3.2000000000000006, -3.500000000000001, -3.2000000000000006, -3.8000000000000007, -3.3000000000000003, -12.4, -3.400000000000001, -3.400000000000001, -3.400000000000001, -11.600000000000001, -3.3000000000000003, -10.0, -10.5, -12.100000000000001, -10.5, -3.3000000000000003, -3.2000000000000006, -3.4000000000000004, -3.7000000000000006, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.500000000000001, -3.3000000000000007, -11.6, -3.2000000000000006, -3.3000000000000007, -12.2, -3.5000000000000004, -3.500000000000001, -11.1, -3.4000000000000004, -3.400000000000001, -3.600000000000001, -3.4000000000000004, -3.3000000000000007, -3.6000000000000005, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.3000000000000003, -3.3000000000000007, -3.5000000000000004, -12.100000000000001, -12.100000000000001, -3.5000000000000004, -3.1000000000000005, -12.3, -10.7, -3.2, -10.9, -3.300000000000001, -3.2000000000000006, -3.4000000000000004, -3.6000000000000005, -3.3000000000000007, -11.2, -3.3000000000000007, -3.700000000000001, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.600000000000001, -3.500000000000001, -3.2000000000000006, -3.600000000000001, -3.600000000000001, -3.3000000000000007, -3.3000000000000003, -3.500000000000001, -11.6, -11.0, -3.500000000000001, -3.5000000000000004, -3.1000000000000005, -3.3000000000000007, -12.4, -3.3000000000000007, -11.700000000000001, -3.4000000000000004, -3.5000000000000004, -12.4, -10.9, -3.2000000000000006, -3.200000000000001, -3.2000000000000006, -3.5000000000000004, -3.2, -3.2, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.2, -3.400000000000001, -3.2000000000000006, -3.5000000000000004, -10.7, -3.500000000000001, -3.3000000000000003, -11.5, -11.3, -11.5, -3.3000000000000007, -10.1, -11.1, -3.3000000000000003, -3.3000000000000003, -3.400000000000001, -3.2000000000000006, -10.2, -12.100000000000001, -3.5000000000000004, -11.3, -3.600000000000001, -3.5000000000000004, -3.6000000000000005, -3.100000000000001, -3.3000000000000007, -11.3, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.500000000000001, -3.400000000000001, -3.2, -3.4000000000000012, -3.6000000000000005, -3.2000000000000006, -3.1000000000000005, -3.6000000000000005, -3.2000000000000006, -3.500000000000001, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -11.5, -10.2, -3.3000000000000007, -3.400000000000001, -10.1, -3.700000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 1, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 10, 13, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 16, 21, 1, 5, 19, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 19, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 18, 21, 21, 19, 7, 21, 10, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 9, 21, 21, 21, 21, 20, 21, 15, 21, 21, 19, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 16, 13, 13, 21, 2, 12, 21, 21, 21, 21, 2, 19, 21, 13, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 2, 21, 21, 2, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.452946303032933, "mean_inference_ms": 17.423236533336244, "mean_action_processing_ms": 0.9191418164759393, "mean_env_wait_ms": 2.1297417859016434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0742942679162119, "StateBufferConnector_ms": 0.009792341905481675, "ViewRequirementAgentConnector_ms": 0.1372052173988492}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.4, "episode_reward_mean": -5.02843137254902, "episode_len_mean": 19.112745098039216, "episodes_this_iter": 204, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.5000000000000004, -3.3000000000000007, -3.200000000000001, -3.3000000000000007, -3.100000000000001, -3.400000000000001, -3.400000000000001, -3.2, -3.1000000000000005, -3.500000000000001, -10.9, -11.4, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.200000000000001, -3.7000000000000006, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.6000000000000005, -3.400000000000001, -10.9, -3.700000000000001, -3.5000000000000004, -3.6000000000000005, -3.400000000000001, -3.5000000000000004, -10.0, -3.3000000000000007, -3.4000000000000004, -3.3000000000000007, -12.100000000000001, -3.400000000000001, -3.400000000000001, -3.6000000000000005, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.5000000000000004, -11.9, -3.2000000000000006, -3.3000000000000007, -12.0, -3.2000000000000006, -3.500000000000001, -3.3000000000000007, -3.0000000000000004, -3.6000000000000005, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -11.0, -11.5, -3.3000000000000007, -3.2000000000000006, -3.500000000000001, -3.2000000000000006, -3.8000000000000007, -3.3000000000000003, -12.4, -3.400000000000001, -3.400000000000001, -3.400000000000001, -11.600000000000001, -3.3000000000000003, -10.0, -10.5, -12.100000000000001, -10.5, -3.3000000000000003, -3.2000000000000006, -3.4000000000000004, -3.7000000000000006, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.500000000000001, -3.3000000000000007, -11.6, -3.2000000000000006, -3.3000000000000007, -12.2, -3.5000000000000004, -3.500000000000001, -11.1, -3.4000000000000004, -3.400000000000001, -3.600000000000001, -3.4000000000000004, -3.3000000000000007, -3.6000000000000005, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.3000000000000003, -3.3000000000000007, -3.5000000000000004, -12.100000000000001, -12.100000000000001, -3.5000000000000004, -3.1000000000000005, -12.3, -10.7, -3.2, -10.9, -3.300000000000001, -3.2000000000000006, -3.4000000000000004, -3.6000000000000005, -3.3000000000000007, -11.2, -3.3000000000000007, -3.700000000000001, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.600000000000001, -3.500000000000001, -3.2000000000000006, -3.600000000000001, -3.600000000000001, -3.3000000000000007, -3.3000000000000003, -3.500000000000001, -11.6, -11.0, -3.500000000000001, -3.5000000000000004, -3.1000000000000005, -3.3000000000000007, -12.4, -3.3000000000000007, -11.700000000000001, -3.4000000000000004, -3.5000000000000004, -12.4, -10.9, -3.2000000000000006, -3.200000000000001, -3.2000000000000006, -3.5000000000000004, -3.2, -3.2, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.2, -3.400000000000001, -3.2000000000000006, -3.5000000000000004, -10.7, -3.500000000000001, -3.3000000000000003, -11.5, -11.3, -11.5, -3.3000000000000007, -10.1, -11.1, -3.3000000000000003, -3.3000000000000003, -3.400000000000001, -3.2000000000000006, -10.2, -12.100000000000001, -3.5000000000000004, -11.3, -3.600000000000001, -3.5000000000000004, -3.6000000000000005, -3.100000000000001, -3.3000000000000007, -11.3, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.500000000000001, -3.400000000000001, -3.2, -3.4000000000000012, -3.6000000000000005, -3.2000000000000006, -3.1000000000000005, -3.6000000000000005, -3.2000000000000006, -3.500000000000001, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -11.5, -10.2, -3.3000000000000007, -3.400000000000001, -10.1, -3.700000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 1, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 10, 13, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 16, 21, 1, 5, 19, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 19, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 18, 21, 21, 19, 7, 21, 10, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 9, 21, 21, 21, 21, 20, 21, 15, 21, 21, 19, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 16, 13, 13, 21, 2, 12, 21, 21, 21, 21, 2, 19, 21, 13, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 2, 21, 21, 2, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.452946303032933, "mean_inference_ms": 17.423236533336244, "mean_action_processing_ms": 0.9191418164759393, "mean_env_wait_ms": 2.1297417859016434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0742942679162119, "StateBufferConnector_ms": 0.009792341905481675, "ViewRequirementAgentConnector_ms": 0.1372052173988492}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 171182.788, "load_time_ms": 1.117, "load_throughput": 3579673.978, "learn_time_ms": 170167.196, "learn_throughput": 23.506, "synch_weights_time_ms": 199.91}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "episodes_total": 4612, "training_iteration": 22, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-06_21-58-31", "timestamp": 1680811111, "time_this_iter_s": 170.60032558441162, "time_total_s": 3765.287771463394, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0147756a30>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01476f4040>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 3765.287771463394, "timesteps_since_restore": 0, "iterations_since_restore": 22, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.397107438016529, "ram_util_percent": 23.56239669421488}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1248298341388343, "cur_kl_coeff": 2.2781249999999993, "cur_lr": 0.0010000000000000005, "total_loss": 0.7013110961464625, "policy_loss": 0.002716632852279481, "vf_loss": 0.6883080109172771, "vf_explained_var": 0.4078496531773639, "kl": 0.004515315061097124, "entropy": 3.9377902702618672, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 20925.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "sampler_results": {"episode_reward_max": 99.0, "episode_reward_min": -12.5, "episode_reward_mean": -3.665402843601896, "episode_len_mean": 19.55924170616114, "episode_media": {}, "episodes_this_iter": 211, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.300000000000001, -11.9, -10.7, -3.2000000000000006, -3.500000000000001, -3.3000000000000003, -11.700000000000001, -3.6000000000000005, -3.400000000000001, -3.400000000000001, -3.5000000000000004, -3.6000000000000005, -3.3000000000000007, -3.6000000000000005, -11.1, -3.3000000000000003, -3.0000000000000004, -3.500000000000001, -3.5000000000000004, -12.2, -3.3000000000000007, -3.600000000000001, -3.400000000000001, -3.400000000000001, -3.5000000000000004, -3.3000000000000007, -3.100000000000001, -3.4000000000000004, -3.3000000000000003, -3.4000000000000004, -3.1000000000000005, -3.600000000000001, -3.6000000000000005, -3.7, -3.600000000000001, -3.500000000000001, -3.3000000000000007, -3.5000000000000004, -3.2000000000000006, -3.200000000000001, -3.500000000000001, -3.3000000000000007, -3.4000000000000004, -3.400000000000001, -3.5000000000000004, -10.3, -3.5000000000000013, -3.600000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.500000000000001, -3.600000000000001, -3.300000000000001, -3.3000000000000007, -3.400000000000001, -3.600000000000001, -3.7000000000000006, -3.4000000000000004, -3.4000000000000004, -3.1000000000000005, -3.400000000000001, -3.6000000000000005, -3.3000000000000007, -3.4000000000000012, -11.6, -3.600000000000001, -11.9, -3.2000000000000006, -12.0, -3.3000000000000007, -3.400000000000001, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -11.3, -3.4000000000000004, -3.300000000000001, -3.2000000000000006, -3.6000000000000005, -11.8, -11.7, -3.400000000000001, -10.9, -10.9, -11.3, -3.3000000000000007, -3.400000000000001, -3.3000000000000003, -3.3000000000000007, -3.3000000000000003, -3.700000000000001, -3.400000000000001, -3.0000000000000004, -3.500000000000001, -3.7000000000000006, -3.5000000000000004, -3.2000000000000006, -3.5000000000000004, -3.6000000000000005, -3.6, -3.3000000000000003, -3.6000000000000005, -10.2, -10.5, -11.6, -3.2000000000000006, -3.3000000000000007, -3.6000000000000005, -3.2000000000000006, -3.600000000000001, -3.500000000000001, -3.6000000000000005, -3.6000000000000005, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.6000000000000005, -3.600000000000001, -11.700000000000001, -3.500000000000001, -3.3000000000000007, -3.1000000000000005, -12.1, -10.3, -3.2000000000000006, -11.0, -3.6000000000000005, -3.400000000000001, -3.7000000000000006, -3.6000000000000005, -3.500000000000001, -3.4000000000000012, -3.6000000000000005, -3.4000000000000004, -3.3000000000000007, -3.500000000000001, -3.400000000000001, -3.400000000000001, -3.500000000000001, -3.500000000000001, -3.2000000000000006, -3.4000000000000004, -3.600000000000001, -3.600000000000001, -3.500000000000001, -3.400000000000001, -3.2000000000000006, -3.0000000000000004, -11.0, -3.1000000000000005, -3.400000000000001, -3.5000000000000004, -10.1, -3.5000000000000004, -3.3000000000000007, -3.500000000000001, -10.8, -3.6000000000000014, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -11.8, -11.2, -3.4000000000000004, -12.5, -3.5000000000000004, -3.2000000000000006, -12.0, -3.5000000000000004, -12.0, -11.2, -3.1000000000000005, -3.400000000000001, -3.3000000000000003, -3.5000000000000004, -3.400000000000001, -3.300000000000001, -3.7000000000000006, -3.400000000000001, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -3.4000000000000004, -3.1000000000000005, -3.400000000000001, -3.400000000000001, -3.2000000000000006, -3.5000000000000004, -3.3000000000000003, -3.400000000000001, -3.400000000000001, -3.2000000000000006, -3.8000000000000007, -3.5000000000000004, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.8000000000000007, 99.0, -10.8, -11.1, -3.500000000000001, 98.5, -3.500000000000001, -3.3000000000000007, -3.2000000000000006], "episode_lengths": [21, 17, 7, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 15, 21, 18, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 17, 15, 21, 7, 9, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 6, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 17, 4, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 2, 21, 21, 21, 9, 21, 21, 21, 21, 17, 13, 21, 20, 21, 21, 19, 21, 19, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 8, 10, 21, 13, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.471282219112485, "mean_inference_ms": 17.43635962309466, "mean_action_processing_ms": 0.9194023374765015, "mean_env_wait_ms": 2.1311050122125716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07643631849243743, "StateBufferConnector_ms": 0.01017414563075061, "ViewRequirementAgentConnector_ms": 0.1410380358944572}}, "episode_reward_max": 99.0, "episode_reward_min": -12.5, "episode_reward_mean": -3.665402843601896, "episode_len_mean": 19.55924170616114, "episodes_this_iter": 211, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.300000000000001, -11.9, -10.7, -3.2000000000000006, -3.500000000000001, -3.3000000000000003, -11.700000000000001, -3.6000000000000005, -3.400000000000001, -3.400000000000001, -3.5000000000000004, -3.6000000000000005, -3.3000000000000007, -3.6000000000000005, -11.1, -3.3000000000000003, -3.0000000000000004, -3.500000000000001, -3.5000000000000004, -12.2, -3.3000000000000007, -3.600000000000001, -3.400000000000001, -3.400000000000001, -3.5000000000000004, -3.3000000000000007, -3.100000000000001, -3.4000000000000004, -3.3000000000000003, -3.4000000000000004, -3.1000000000000005, -3.600000000000001, -3.6000000000000005, -3.7, -3.600000000000001, -3.500000000000001, -3.3000000000000007, -3.5000000000000004, -3.2000000000000006, -3.200000000000001, -3.500000000000001, -3.3000000000000007, -3.4000000000000004, -3.400000000000001, -3.5000000000000004, -10.3, -3.5000000000000013, -3.600000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.500000000000001, -3.600000000000001, -3.300000000000001, -3.3000000000000007, -3.400000000000001, -3.600000000000001, -3.7000000000000006, -3.4000000000000004, -3.4000000000000004, -3.1000000000000005, -3.400000000000001, -3.6000000000000005, -3.3000000000000007, -3.4000000000000012, -11.6, -3.600000000000001, -11.9, -3.2000000000000006, -12.0, -3.3000000000000007, -3.400000000000001, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -11.3, -3.4000000000000004, -3.300000000000001, -3.2000000000000006, -3.6000000000000005, -11.8, -11.7, -3.400000000000001, -10.9, -10.9, -11.3, -3.3000000000000007, -3.400000000000001, -3.3000000000000003, -3.3000000000000007, -3.3000000000000003, -3.700000000000001, -3.400000000000001, -3.0000000000000004, -3.500000000000001, -3.7000000000000006, -3.5000000000000004, -3.2000000000000006, -3.5000000000000004, -3.6000000000000005, -3.6, -3.3000000000000003, -3.6000000000000005, -10.2, -10.5, -11.6, -3.2000000000000006, -3.3000000000000007, -3.6000000000000005, -3.2000000000000006, -3.600000000000001, -3.500000000000001, -3.6000000000000005, -3.6000000000000005, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.6000000000000005, -3.600000000000001, -11.700000000000001, -3.500000000000001, -3.3000000000000007, -3.1000000000000005, -12.1, -10.3, -3.2000000000000006, -11.0, -3.6000000000000005, -3.400000000000001, -3.7000000000000006, -3.6000000000000005, -3.500000000000001, -3.4000000000000012, -3.6000000000000005, -3.4000000000000004, -3.3000000000000007, -3.500000000000001, -3.400000000000001, -3.400000000000001, -3.500000000000001, -3.500000000000001, -3.2000000000000006, -3.4000000000000004, -3.600000000000001, -3.600000000000001, -3.500000000000001, -3.400000000000001, -3.2000000000000006, -3.0000000000000004, -11.0, -3.1000000000000005, -3.400000000000001, -3.5000000000000004, -10.1, -3.5000000000000004, -3.3000000000000007, -3.500000000000001, -10.8, -3.6000000000000014, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -11.8, -11.2, -3.4000000000000004, -12.5, -3.5000000000000004, -3.2000000000000006, -12.0, -3.5000000000000004, -12.0, -11.2, -3.1000000000000005, -3.400000000000001, -3.3000000000000003, -3.5000000000000004, -3.400000000000001, -3.300000000000001, -3.7000000000000006, -3.400000000000001, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -3.4000000000000004, -3.1000000000000005, -3.400000000000001, -3.400000000000001, -3.2000000000000006, -3.5000000000000004, -3.3000000000000003, -3.400000000000001, -3.400000000000001, -3.2000000000000006, -3.8000000000000007, -3.5000000000000004, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.8000000000000007, 99.0, -10.8, -11.1, -3.500000000000001, 98.5, -3.500000000000001, -3.3000000000000007, -3.2000000000000006], "episode_lengths": [21, 17, 7, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 15, 21, 18, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 17, 15, 21, 7, 9, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 6, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 17, 4, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 2, 21, 21, 21, 9, 21, 21, 21, 21, 17, 13, 21, 20, 21, 21, 19, 21, 19, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 8, 10, 21, 13, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.471282219112485, "mean_inference_ms": 17.43635962309466, "mean_action_processing_ms": 0.9194023374765015, "mean_env_wait_ms": 2.1311050122125716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07643631849243743, "StateBufferConnector_ms": 0.01017414563075061, "ViewRequirementAgentConnector_ms": 0.1410380358944572}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 171134.102, "load_time_ms": 1.112, "load_throughput": 3596016.718, "learn_time_ms": 170143.356, "learn_throughput": 23.51, "synch_weights_time_ms": 178.392}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "episodes_total": 4823, "training_iteration": 23, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-06_22-01-21", "timestamp": 1680811281, "time_this_iter_s": 170.47425937652588, "time_total_s": 3935.76203083992, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476d7880>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0147716f70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 3935.76203083992, "timesteps_since_restore": 0, "iterations_since_restore": 23, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 6.399176954732511, "ram_util_percent": 23.599588477366257}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3753678088386854, "cur_kl_coeff": 1.1390624999999996, "cur_lr": 0.0010000000000000005, "total_loss": 0.5575646113639356, "policy_loss": -0.03771546697531957, "vf_loss": 0.5855223934716915, "vf_explained_var": 0.4481558915107481, "kl": 0.008566420773352165, "entropy": 3.940673299245937, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 21855.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "sampler_results": {"episode_reward_max": 99.5, "episode_reward_min": -12.3, "episode_reward_mean": -3.6783251231527094, "episode_len_mean": 19.192118226600986, "episode_media": {}, "episodes_this_iter": 203, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.400000000000001, -3.500000000000001, -3.3000000000000007, -3.2000000000000006, -11.9, -3.5000000000000004, -3.400000000000001, -3.700000000000001, -3.700000000000001, -3.4000000000000004, -3.1000000000000005, -3.3000000000000007, -3.4000000000000004, -3.400000000000001, -3.5000000000000004, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.500000000000001, -11.0, -3.6000000000000005, -3.400000000000001, -3.5000000000000004, -3.6000000000000005, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -11.2, -3.700000000000001, -3.4000000000000004, -12.0, -3.500000000000001, -3.400000000000001, -3.6000000000000005, -3.3000000000000007, -11.5, -3.400000000000001, -3.3000000000000007, -3.600000000000001, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.200000000000001, -3.200000000000001, -3.2000000000000006, -3.3000000000000007, -3.500000000000001, -12.2, -3.3000000000000003, -3.2000000000000006, -3.600000000000001, -3.6000000000000005, -3.3000000000000007, -3.6000000000000005, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.2, -3.5000000000000004, -3.3000000000000003, -3.400000000000001, -3.400000000000001, -3.5000000000000004, -3.300000000000001, -3.400000000000001, -3.400000000000001, -3.6000000000000005, -3.4000000000000004, -3.4000000000000004, -11.7, -11.7, -10.1, -3.400000000000001, -3.600000000000001, -3.400000000000001, -3.2000000000000006, -3.500000000000001, -3.600000000000001, -3.400000000000001, -11.4, -11.0, -3.2000000000000006, -3.8000000000000007, -3.3000000000000007, -12.3, -3.500000000000001, -11.1, -3.400000000000001, -3.5000000000000004, -11.0, -11.3, -3.3000000000000003, -3.5000000000000013, -3.400000000000001, -3.2000000000000006, -3.4000000000000004, -3.4000000000000004, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -12.3, -3.400000000000001, 97.9, -3.5000000000000004, -3.4000000000000004, -10.0, -3.4000000000000004, -10.0, -3.500000000000001, -3.4000000000000004, -3.7000000000000006, -3.1000000000000005, -10.9, -10.8, -10.3, -11.1, -3.3000000000000007, -3.4000000000000004, -3.400000000000001, -3.4000000000000004, -3.4000000000000004, -3.2000000000000006, -3.200000000000001, -3.7000000000000006, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.7000000000000006, -3.7000000000000006, -3.1000000000000005, -3.3000000000000003, -3.6000000000000005, -3.2000000000000006, -3.600000000000001, -3.3000000000000007, -3.3000000000000007, -3.4000000000000004, -3.4000000000000004, 99.5, -3.3000000000000007, -3.4000000000000004, -11.6, -3.6, -3.400000000000001, -3.5000000000000004, -3.4000000000000004, -10.5, -3.400000000000001, -3.6000000000000005, -3.500000000000001, -3.400000000000001, -3.3000000000000003, -3.400000000000001, -10.7, -3.3000000000000007, -10.6, -10.7, -3.2, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.3000000000000003, -10.4, -12.200000000000001, -10.5, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.5000000000000004, -3.3000000000000003, -12.0, -3.3000000000000007, -3.0000000000000004, -3.5000000000000004, -3.700000000000001, -3.500000000000001, -3.500000000000001, -3.3000000000000007, -3.5000000000000004, -3.500000000000001, -3.500000000000001, -3.3000000000000007, -3.4000000000000004, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.6000000000000005, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -11.6, -10.7, -3.3000000000000007, -10.2, -3.600000000000001, -3.400000000000001, -3.3000000000000007, -3.3000000000000003, -3.300000000000001, -3.3000000000000007], "episode_lengths": [21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 19, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 16, 2, 21, 21, 21, 21, 21, 21, 21, 13, 10, 21, 21, 21, 18, 21, 11, 21, 21, 10, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 18, 21, 21, 1, 21, 1, 21, 21, 21, 21, 8, 9, 3, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 14, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 8, 21, 7, 8, 21, 21, 21, 21, 21, 4, 20, 5, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 8, 21, 2, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.47661216972747, "mean_inference_ms": 17.44368105063714, "mean_action_processing_ms": 0.9202311680000306, "mean_env_wait_ms": 2.135120772287947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07413290991571736, "StateBufferConnector_ms": 0.009609678108703914, "ViewRequirementAgentConnector_ms": 0.13754919831975929}}, "episode_reward_max": 99.5, "episode_reward_min": -12.3, "episode_reward_mean": -3.6783251231527094, "episode_len_mean": 19.192118226600986, "episodes_this_iter": 203, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.400000000000001, -3.500000000000001, -3.3000000000000007, -3.2000000000000006, -11.9, -3.5000000000000004, -3.400000000000001, -3.700000000000001, -3.700000000000001, -3.4000000000000004, -3.1000000000000005, -3.3000000000000007, -3.4000000000000004, -3.400000000000001, -3.5000000000000004, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.500000000000001, -11.0, -3.6000000000000005, -3.400000000000001, -3.5000000000000004, -3.6000000000000005, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -11.2, -3.700000000000001, -3.4000000000000004, -12.0, -3.500000000000001, -3.400000000000001, -3.6000000000000005, -3.3000000000000007, -11.5, -3.400000000000001, -3.3000000000000007, -3.600000000000001, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.200000000000001, -3.200000000000001, -3.2000000000000006, -3.3000000000000007, -3.500000000000001, -12.2, -3.3000000000000003, -3.2000000000000006, -3.600000000000001, -3.6000000000000005, -3.3000000000000007, -3.6000000000000005, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.2, -3.5000000000000004, -3.3000000000000003, -3.400000000000001, -3.400000000000001, -3.5000000000000004, -3.300000000000001, -3.400000000000001, -3.400000000000001, -3.6000000000000005, -3.4000000000000004, -3.4000000000000004, -11.7, -11.7, -10.1, -3.400000000000001, -3.600000000000001, -3.400000000000001, -3.2000000000000006, -3.500000000000001, -3.600000000000001, -3.400000000000001, -11.4, -11.0, -3.2000000000000006, -3.8000000000000007, -3.3000000000000007, -12.3, -3.500000000000001, -11.1, -3.400000000000001, -3.5000000000000004, -11.0, -11.3, -3.3000000000000003, -3.5000000000000013, -3.400000000000001, -3.2000000000000006, -3.4000000000000004, -3.4000000000000004, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -12.3, -3.400000000000001, 97.9, -3.5000000000000004, -3.4000000000000004, -10.0, -3.4000000000000004, -10.0, -3.500000000000001, -3.4000000000000004, -3.7000000000000006, -3.1000000000000005, -10.9, -10.8, -10.3, -11.1, -3.3000000000000007, -3.4000000000000004, -3.400000000000001, -3.4000000000000004, -3.4000000000000004, -3.2000000000000006, -3.200000000000001, -3.7000000000000006, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.7000000000000006, -3.7000000000000006, -3.1000000000000005, -3.3000000000000003, -3.6000000000000005, -3.2000000000000006, -3.600000000000001, -3.3000000000000007, -3.3000000000000007, -3.4000000000000004, -3.4000000000000004, 99.5, -3.3000000000000007, -3.4000000000000004, -11.6, -3.6, -3.400000000000001, -3.5000000000000004, -3.4000000000000004, -10.5, -3.400000000000001, -3.6000000000000005, -3.500000000000001, -3.400000000000001, -3.3000000000000003, -3.400000000000001, -10.7, -3.3000000000000007, -10.6, -10.7, -3.2, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.3000000000000003, -10.4, -12.200000000000001, -10.5, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.5000000000000004, -3.3000000000000003, -12.0, -3.3000000000000007, -3.0000000000000004, -3.5000000000000004, -3.700000000000001, -3.500000000000001, -3.500000000000001, -3.3000000000000007, -3.5000000000000004, -3.500000000000001, -3.500000000000001, -3.3000000000000007, -3.4000000000000004, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.6000000000000005, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -11.6, -10.7, -3.3000000000000007, -10.2, -3.600000000000001, -3.400000000000001, -3.3000000000000007, -3.3000000000000003, -3.300000000000001, -3.3000000000000007], "episode_lengths": [21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 19, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 16, 2, 21, 21, 21, 21, 21, 21, 21, 13, 10, 21, 21, 21, 18, 21, 11, 21, 21, 10, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 18, 21, 21, 1, 21, 1, 21, 21, 21, 21, 8, 9, 3, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 14, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 8, 21, 7, 8, 21, 21, 21, 21, 21, 4, 20, 5, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 8, 21, 2, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.47661216972747, "mean_inference_ms": 17.44368105063714, "mean_action_processing_ms": 0.9202311680000306, "mean_env_wait_ms": 2.135120772287947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07413290991571736, "StateBufferConnector_ms": 0.009609678108703914, "ViewRequirementAgentConnector_ms": 0.13754919831975929}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 171115.431, "load_time_ms": 1.118, "load_throughput": 3578605.008, "learn_time_ms": 170123.013, "learn_throughput": 23.512, "synch_weights_time_ms": 180.765}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "episodes_total": 5026, "training_iteration": 24, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-06_22-04-13", "timestamp": 1680811453, "time_this_iter_s": 171.2993824481964, "time_total_s": 4107.0614132881165, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0147659f70>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01476f4040>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 4107.0614132881165, "timesteps_since_restore": 0, "iterations_since_restore": 24, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.3695473251028805, "ram_util_percent": 23.598353909465022}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0705821664102615, "cur_kl_coeff": 1.1390624999999996, "cur_lr": 0.0010000000000000005, "total_loss": 0.7733645508346217, "policy_loss": -0.08056301274487088, "vf_loss": 0.835443957168008, "vf_explained_var": 0.3632518978529079, "kl": 0.016227033092769898, "entropy": 3.9298145227534795, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 22785.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "sampler_results": {"episode_reward_max": 99.3, "episode_reward_min": -12.4, "episode_reward_mean": -4.189719626168224, "episode_len_mean": 19.406542056074766, "episode_media": {}, "episodes_this_iter": 214, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.5000000000000004, -3.2, -3.400000000000001, -3.3000000000000003, -3.5000000000000004, -3.6000000000000005, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -10.7, -3.500000000000001, -11.700000000000001, -3.3000000000000007, -3.400000000000001, -3.3000000000000003, -3.3000000000000007, -3.5000000000000013, -3.2000000000000006, -3.400000000000001, -12.4, -3.4000000000000012, -3.4000000000000004, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.400000000000001, -11.3, -3.3000000000000003, -11.8, -11.9, -3.500000000000001, 99.3, -3.2000000000000006, -3.1000000000000005, -3.500000000000001, -11.9, -3.400000000000001, -3.700000000000001, -3.400000000000001, -3.3000000000000007, -3.8000000000000007, -11.5, -3.3000000000000007, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.5000000000000004, -3.5000000000000004, -11.6, -3.3000000000000007, -3.500000000000001, -3.1000000000000005, -3.3000000000000007, -3.4000000000000004, -3.200000000000001, -3.8000000000000007, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.5000000000000013, -3.300000000000001, -3.400000000000001, -3.600000000000001, -10.3, -3.2, -3.500000000000001, -3.400000000000001, -3.7000000000000006, -10.6, -3.400000000000001, -3.400000000000001, -3.500000000000001, -10.9, -3.5000000000000013, -11.2, -3.4000000000000004, -3.400000000000001, -3.3000000000000007, -3.5000000000000004, -3.500000000000001, -3.3000000000000007, -10.3, -3.6000000000000005, -3.1000000000000005, -3.6000000000000005, -3.400000000000001, -3.500000000000001, -3.4000000000000004, -3.400000000000001, -3.2000000000000006, -12.2, -10.6, -11.0, -3.500000000000001, -3.2000000000000006, -3.300000000000001, -3.500000000000001, -3.4000000000000012, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.4000000000000004, -3.900000000000001, -3.600000000000001, -3.6000000000000005, -11.3, -3.500000000000001, -3.100000000000001, -10.5, -3.400000000000001, -3.4000000000000004, -3.6000000000000005, -3.3000000000000003, -10.5, -11.3, -3.1000000000000005, -3.3000000000000003, -11.0, -3.600000000000001, -3.600000000000001, -3.3000000000000003, -10.9, -3.2000000000000006, -3.700000000000001, -10.5, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.400000000000001, -3.3000000000000003, -10.3, -10.5, -3.2000000000000006, -3.500000000000001, -3.7000000000000006, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.7000000000000006, -3.3000000000000007, -3.4000000000000004, -12.0, -3.500000000000001, -3.4000000000000004, -3.0000000000000004, -3.1000000000000005, -11.0, -3.1000000000000005, -3.400000000000001, -3.600000000000001, -3.400000000000001, -3.500000000000001, -3.6000000000000005, -3.400000000000001, -3.200000000000001, -3.600000000000001, -3.3000000000000007, -3.500000000000001, -3.500000000000001, -3.4000000000000004, -3.5000000000000004, -11.4, -3.2000000000000006, -3.500000000000001, -3.400000000000001, -3.0000000000000004, -3.2000000000000006, -10.8, -3.5000000000000004, -11.9, -3.3000000000000003, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.3000000000000007, -11.7, -3.7000000000000006, -10.6, -3.400000000000001, -3.4000000000000004, -3.2000000000000006, -3.500000000000001, -3.400000000000001, -3.600000000000001, -3.3000000000000007, -3.8000000000000003, -3.6000000000000005, -3.400000000000001, -3.500000000000001, -3.2000000000000006, -3.4000000000000004, -3.5000000000000004, -3.600000000000001, -3.600000000000001, -3.3000000000000007, -3.700000000000001, -3.4000000000000004, -3.4000000000000004, -3.7000000000000006, -3.3000000000000007, -11.3, -12.0, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.4000000000000004, -3.3000000000000007, -3.2000000000000006, -3.500000000000001, -3.3000000000000003, -3.500000000000001, -3.600000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 16, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 13, 21, 17, 17, 21, 8, 21, 21, 21, 17, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 6, 21, 21, 21, 9, 21, 11, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 20, 6, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 5, 21, 21, 21, 21, 6, 12, 21, 21, 11, 21, 21, 21, 10, 21, 21, 5, 21, 21, 21, 21, 21, 4, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 8, 21, 19, 21, 21, 21, 21, 21, 16, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.470407138396576, "mean_inference_ms": 17.412810317439106, "mean_action_processing_ms": 0.9202547358183887, "mean_env_wait_ms": 2.1397489896273285, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07743701756557572, "StateBufferConnector_ms": 0.010028732157199183, "ViewRequirementAgentConnector_ms": 0.14361599895441643}}, "episode_reward_max": 99.3, "episode_reward_min": -12.4, "episode_reward_mean": -4.189719626168224, "episode_len_mean": 19.406542056074766, "episodes_this_iter": 214, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.5000000000000004, -3.2, -3.400000000000001, -3.3000000000000003, -3.5000000000000004, -3.6000000000000005, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -10.7, -3.500000000000001, -11.700000000000001, -3.3000000000000007, -3.400000000000001, -3.3000000000000003, -3.3000000000000007, -3.5000000000000013, -3.2000000000000006, -3.400000000000001, -12.4, -3.4000000000000012, -3.4000000000000004, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.400000000000001, -11.3, -3.3000000000000003, -11.8, -11.9, -3.500000000000001, 99.3, -3.2000000000000006, -3.1000000000000005, -3.500000000000001, -11.9, -3.400000000000001, -3.700000000000001, -3.400000000000001, -3.3000000000000007, -3.8000000000000007, -11.5, -3.3000000000000007, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.5000000000000004, -3.5000000000000004, -11.6, -3.3000000000000007, -3.500000000000001, -3.1000000000000005, -3.3000000000000007, -3.4000000000000004, -3.200000000000001, -3.8000000000000007, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.5000000000000013, -3.300000000000001, -3.400000000000001, -3.600000000000001, -10.3, -3.2, -3.500000000000001, -3.400000000000001, -3.7000000000000006, -10.6, -3.400000000000001, -3.400000000000001, -3.500000000000001, -10.9, -3.5000000000000013, -11.2, -3.4000000000000004, -3.400000000000001, -3.3000000000000007, -3.5000000000000004, -3.500000000000001, -3.3000000000000007, -10.3, -3.6000000000000005, -3.1000000000000005, -3.6000000000000005, -3.400000000000001, -3.500000000000001, -3.4000000000000004, -3.400000000000001, -3.2000000000000006, -12.2, -10.6, -11.0, -3.500000000000001, -3.2000000000000006, -3.300000000000001, -3.500000000000001, -3.4000000000000012, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.4000000000000004, -3.900000000000001, -3.600000000000001, -3.6000000000000005, -11.3, -3.500000000000001, -3.100000000000001, -10.5, -3.400000000000001, -3.4000000000000004, -3.6000000000000005, -3.3000000000000003, -10.5, -11.3, -3.1000000000000005, -3.3000000000000003, -11.0, -3.600000000000001, -3.600000000000001, -3.3000000000000003, -10.9, -3.2000000000000006, -3.700000000000001, -10.5, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.400000000000001, -3.3000000000000003, -10.3, -10.5, -3.2000000000000006, -3.500000000000001, -3.7000000000000006, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.7000000000000006, -3.3000000000000007, -3.4000000000000004, -12.0, -3.500000000000001, -3.4000000000000004, -3.0000000000000004, -3.1000000000000005, -11.0, -3.1000000000000005, -3.400000000000001, -3.600000000000001, -3.400000000000001, -3.500000000000001, -3.6000000000000005, -3.400000000000001, -3.200000000000001, -3.600000000000001, -3.3000000000000007, -3.500000000000001, -3.500000000000001, -3.4000000000000004, -3.5000000000000004, -11.4, -3.2000000000000006, -3.500000000000001, -3.400000000000001, -3.0000000000000004, -3.2000000000000006, -10.8, -3.5000000000000004, -11.9, -3.3000000000000003, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.3000000000000007, -11.7, -3.7000000000000006, -10.6, -3.400000000000001, -3.4000000000000004, -3.2000000000000006, -3.500000000000001, -3.400000000000001, -3.600000000000001, -3.3000000000000007, -3.8000000000000003, -3.6000000000000005, -3.400000000000001, -3.500000000000001, -3.2000000000000006, -3.4000000000000004, -3.5000000000000004, -3.600000000000001, -3.600000000000001, -3.3000000000000007, -3.700000000000001, -3.4000000000000004, -3.4000000000000004, -3.7000000000000006, -3.3000000000000007, -11.3, -12.0, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.4000000000000004, -3.3000000000000007, -3.2000000000000006, -3.500000000000001, -3.3000000000000003, -3.500000000000001, -3.600000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 16, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 13, 21, 17, 17, 21, 8, 21, 21, 21, 17, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 6, 21, 21, 21, 9, 21, 11, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 20, 6, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 5, 21, 21, 21, 21, 6, 12, 21, 21, 11, 21, 21, 21, 10, 21, 21, 5, 21, 21, 21, 21, 21, 4, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 8, 21, 19, 21, 21, 21, 21, 21, 16, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.470407138396576, "mean_inference_ms": 17.412810317439106, "mean_action_processing_ms": 0.9202547358183887, "mean_env_wait_ms": 2.1397489896273285, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07743701756557572, "StateBufferConnector_ms": 0.010028732157199183, "ViewRequirementAgentConnector_ms": 0.14361599895441643}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 171113.968, "load_time_ms": 1.113, "load_throughput": 3592782.406, "learn_time_ms": 170120.362, "learn_throughput": 23.513, "synch_weights_time_ms": 180.437}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": false, "episodes_total": 5240, "training_iteration": 25, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-06_22-07-04", "timestamp": 1680811624, "time_this_iter_s": 171.2232313156128, "time_total_s": 4278.284644603729, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476f2c40>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01476431f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 4278.284644603729, "timesteps_since_restore": 0, "iterations_since_restore": 25, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.559259259259259, "ram_util_percent": 23.607407407407408}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1013835273282502, "cur_kl_coeff": 1.1390624999999996, "cur_lr": 0.0010000000000000005, "total_loss": 0.5182789002670356, "policy_loss": -0.04635304042240805, "vf_loss": 0.5543729955500732, "vf_explained_var": 0.45387918045443876, "kl": 0.009006480547669594, "entropy": 3.9290430881643807, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 23715.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "sampler_results": {"episode_reward_max": 98.0, "episode_reward_min": -12.100000000000001, "episode_reward_mean": -4.015048543689321, "episode_len_mean": 19.514563106796118, "episode_media": {}, "episodes_this_iter": 206, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.5000000000000004, -3.3000000000000003, -11.4, -3.3000000000000003, -3.5000000000000004, -3.3000000000000007, -3.0000000000000004, -3.3000000000000003, -3.3000000000000007, -3.400000000000001, -3.200000000000001, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.3000000000000007, -11.5, -3.700000000000001, -3.2000000000000006, -3.5000000000000004, -3.5000000000000004, -3.4000000000000012, -3.4000000000000004, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.6000000000000005, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.200000000000001, -11.2, -3.3000000000000007, -11.700000000000001, -3.200000000000001, -3.400000000000001, -3.6000000000000005, -3.3000000000000007, -3.3000000000000003, -10.3, -3.2, -3.500000000000001, -3.400000000000001, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.3000000000000003, -3.800000000000001, -3.6000000000000014, -12.100000000000001, -3.5000000000000004, -3.400000000000001, -3.6000000000000005, -3.500000000000001, -3.500000000000001, -3.6000000000000005, -3.100000000000001, -3.5000000000000004, -10.8, -12.0, -11.4, -3.3000000000000007, -3.500000000000001, -3.3000000000000007, -10.8, -12.100000000000001, -3.5000000000000004, -10.1, -10.0, -3.4000000000000004, -3.5000000000000004, -3.6000000000000005, -3.400000000000001, -3.400000000000001, -3.7000000000000006, -3.4000000000000004, -3.3000000000000007, -10.0, -10.3, -10.3, -3.2000000000000006, -3.300000000000001, -3.3000000000000003, -3.2000000000000006, -3.5000000000000004, -3.3000000000000007, -3.3000000000000007, -3.500000000000001, -11.7, -11.3, -11.1, -3.5000000000000004, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.400000000000001, -3.8000000000000003, -11.3, -11.3, -3.3000000000000003, -3.6000000000000014, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.4000000000000004, -3.3000000000000003, -3.3000000000000007, -3.700000000000001, -3.6000000000000005, -3.400000000000001, -3.3000000000000003, -3.500000000000001, -3.5000000000000004, -3.3000000000000007, -3.5000000000000004, -3.3000000000000007, -3.5000000000000004, -3.6000000000000005, -3.400000000000001, -3.400000000000001, 98.0, -3.3000000000000007, -10.5, -3.400000000000001, -3.1000000000000005, -3.4000000000000004, -3.4000000000000004, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -3.8000000000000007, -3.400000000000001, -3.5000000000000004, -3.600000000000001, -3.2000000000000006, -3.1000000000000005, -3.5000000000000004, -3.3000000000000007, -3.1000000000000005, -3.9000000000000004, -3.500000000000001, -3.500000000000001, -3.2000000000000006, -11.5, -3.3000000000000003, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.500000000000001, -3.400000000000001, -3.4000000000000004, -3.700000000000001, -3.3000000000000007, -12.1, -3.3000000000000007, -12.0, -3.400000000000001, -3.400000000000001, -10.5, -11.3, -3.2000000000000006, -3.5000000000000004, -3.4000000000000004, -10.2, -3.3000000000000007, -3.1000000000000005, -3.4000000000000004, -3.3000000000000007, -3.5000000000000004, -3.500000000000001, -3.500000000000001, -3.400000000000001, -3.4000000000000004, -3.0000000000000004, -3.500000000000001, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.300000000000001, -3.6000000000000005, -12.0, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -3.6000000000000005, -3.3000000000000007, -3.5000000000000004, -3.400000000000001, -3.100000000000001, -11.1, -3.700000000000001, -3.5000000000000004, -3.100000000000001, -3.3000000000000007, -3.2000000000000006], "episode_lengths": [21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 18, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 8, 18, 13, 21, 21, 21, 8, 18, 21, 2, 1, 21, 21, 21, 21, 21, 21, 21, 21, 1, 4, 4, 21, 21, 21, 21, 21, 21, 21, 21, 15, 12, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 18, 21, 21, 6, 12, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.469634036720327, "mean_inference_ms": 17.43719118972493, "mean_action_processing_ms": 0.9187210766430275, "mean_env_wait_ms": 2.1363760621166987, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07068196546684191, "StateBufferConnector_ms": 0.008825538227859052, "ViewRequirementAgentConnector_ms": 0.1307937705401078}}, "episode_reward_max": 98.0, "episode_reward_min": -12.100000000000001, "episode_reward_mean": -4.015048543689321, "episode_len_mean": 19.514563106796118, "episodes_this_iter": 206, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.5000000000000004, -3.3000000000000003, -11.4, -3.3000000000000003, -3.5000000000000004, -3.3000000000000007, -3.0000000000000004, -3.3000000000000003, -3.3000000000000007, -3.400000000000001, -3.200000000000001, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.3000000000000007, -11.5, -3.700000000000001, -3.2000000000000006, -3.5000000000000004, -3.5000000000000004, -3.4000000000000012, -3.4000000000000004, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.6000000000000005, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.200000000000001, -11.2, -3.3000000000000007, -11.700000000000001, -3.200000000000001, -3.400000000000001, -3.6000000000000005, -3.3000000000000007, -3.3000000000000003, -10.3, -3.2, -3.500000000000001, -3.400000000000001, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.3000000000000003, -3.800000000000001, -3.6000000000000014, -12.100000000000001, -3.5000000000000004, -3.400000000000001, -3.6000000000000005, -3.500000000000001, -3.500000000000001, -3.6000000000000005, -3.100000000000001, -3.5000000000000004, -10.8, -12.0, -11.4, -3.3000000000000007, -3.500000000000001, -3.3000000000000007, -10.8, -12.100000000000001, -3.5000000000000004, -10.1, -10.0, -3.4000000000000004, -3.5000000000000004, -3.6000000000000005, -3.400000000000001, -3.400000000000001, -3.7000000000000006, -3.4000000000000004, -3.3000000000000007, -10.0, -10.3, -10.3, -3.2000000000000006, -3.300000000000001, -3.3000000000000003, -3.2000000000000006, -3.5000000000000004, -3.3000000000000007, -3.3000000000000007, -3.500000000000001, -11.7, -11.3, -11.1, -3.5000000000000004, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.400000000000001, -3.8000000000000003, -11.3, -11.3, -3.3000000000000003, -3.6000000000000014, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.4000000000000004, -3.3000000000000003, -3.3000000000000007, -3.700000000000001, -3.6000000000000005, -3.400000000000001, -3.3000000000000003, -3.500000000000001, -3.5000000000000004, -3.3000000000000007, -3.5000000000000004, -3.3000000000000007, -3.5000000000000004, -3.6000000000000005, -3.400000000000001, -3.400000000000001, 98.0, -3.3000000000000007, -10.5, -3.400000000000001, -3.1000000000000005, -3.4000000000000004, -3.4000000000000004, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -3.8000000000000007, -3.400000000000001, -3.5000000000000004, -3.600000000000001, -3.2000000000000006, -3.1000000000000005, -3.5000000000000004, -3.3000000000000007, -3.1000000000000005, -3.9000000000000004, -3.500000000000001, -3.500000000000001, -3.2000000000000006, -11.5, -3.3000000000000003, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.500000000000001, -3.400000000000001, -3.4000000000000004, -3.700000000000001, -3.3000000000000007, -12.1, -3.3000000000000007, -12.0, -3.400000000000001, -3.400000000000001, -10.5, -11.3, -3.2000000000000006, -3.5000000000000004, -3.4000000000000004, -10.2, -3.3000000000000007, -3.1000000000000005, -3.4000000000000004, -3.3000000000000007, -3.5000000000000004, -3.500000000000001, -3.500000000000001, -3.400000000000001, -3.4000000000000004, -3.0000000000000004, -3.500000000000001, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.300000000000001, -3.6000000000000005, -12.0, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -3.6000000000000005, -3.3000000000000007, -3.5000000000000004, -3.400000000000001, -3.100000000000001, -11.1, -3.700000000000001, -3.5000000000000004, -3.100000000000001, -3.3000000000000007, -3.2000000000000006], "episode_lengths": [21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 18, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 8, 18, 13, 21, 21, 21, 8, 18, 21, 2, 1, 21, 21, 21, 21, 21, 21, 21, 21, 1, 4, 4, 21, 21, 21, 21, 21, 21, 21, 21, 15, 12, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 18, 21, 21, 6, 12, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.469634036720327, "mean_inference_ms": 17.43719118972493, "mean_action_processing_ms": 0.9187210766430275, "mean_env_wait_ms": 2.1363760621166987, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07068196546684191, "StateBufferConnector_ms": 0.008825538227859052, "ViewRequirementAgentConnector_ms": 0.1307937705401078}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 171131.836, "load_time_ms": 1.108, "load_throughput": 3609711.261, "learn_time_ms": 170144.483, "learn_throughput": 23.509, "synch_weights_time_ms": 178.096}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "done": false, "episodes_total": 5446, "training_iteration": 26, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-06_22-09-55", "timestamp": 1680811795, "time_this_iter_s": 170.87511730194092, "time_total_s": 4449.15976190567, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476d13a0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01475d8d30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 4449.15976190567, "timesteps_since_restore": 0, "iterations_since_restore": 26, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.353497942386832, "ram_util_percent": 23.56913580246914}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2699651022752125, "cur_kl_coeff": 1.1390624999999996, "cur_lr": 0.0010000000000000005, "total_loss": 0.6967400488633942, "policy_loss": -0.13063639240759994, "vf_loss": 0.7972740934570871, "vf_explained_var": 0.40836181095851365, "kl": 0.026427296872322086, "entropy": 3.904032837960028, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 24645.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.3, "episode_reward_mean": -4.863636363636364, "episode_len_mean": 19.13397129186603, "episode_media": {}, "episodes_this_iter": 209, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.2000000000000006, -3.2000000000000006, -3.500000000000001, -3.1000000000000005, -3.600000000000001, -3.2000000000000006, -3.3000000000000007, -3.500000000000001, -3.1000000000000005, -3.6000000000000005, -3.500000000000001, -3.3000000000000007, -3.3000000000000007, -3.5000000000000013, -3.600000000000001, -3.400000000000001, -3.400000000000001, -3.2000000000000006, -3.2, -3.400000000000001, -3.6000000000000005, -3.3000000000000007, -10.6, -3.3000000000000007, -11.2, -3.4000000000000004, -3.600000000000001, -3.3000000000000003, -11.700000000000001, -3.5000000000000004, -10.9, -3.400000000000001, -3.2000000000000006, -3.6000000000000005, -3.500000000000001, -11.2, -3.500000000000001, -3.3000000000000007, -3.500000000000001, -3.500000000000001, -3.3000000000000007, -10.5, -11.0, -3.300000000000001, -3.400000000000001, -11.5, -3.500000000000001, -3.5000000000000004, -3.1000000000000005, -3.4000000000000004, -3.7000000000000006, -12.3, -3.1000000000000005, -3.3000000000000007, -12.200000000000001, -10.2, -3.2000000000000006, -3.500000000000001, -3.6000000000000014, -10.1, -3.4000000000000004, -3.5000000000000004, -3.500000000000001, -3.5000000000000004, -10.9, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -10.5, -3.4000000000000004, -3.3000000000000003, -3.6000000000000005, -12.200000000000001, -3.400000000000001, -3.600000000000001, -3.500000000000001, -3.3000000000000007, -3.7000000000000006, -3.500000000000001, -3.2, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.7000000000000006, -12.1, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.5000000000000004, -3.3000000000000007, -3.5000000000000004, -3.2, -3.400000000000001, -3.100000000000001, -3.2, -3.6000000000000005, -10.9, -3.600000000000001, -3.600000000000001, -3.500000000000001, -3.3000000000000007, -3.3000000000000003, -3.6000000000000005, -3.2000000000000006, -3.1000000000000005, -10.0, -10.5, -3.4000000000000004, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -11.6, -3.1000000000000005, -10.9, -3.400000000000001, -3.2, -3.2000000000000006, -3.6000000000000005, -3.3000000000000007, -3.600000000000001, -3.600000000000001, -11.5, -10.1, -3.4000000000000004, -3.1000000000000005, -3.4000000000000004, -11.8, -11.1, -10.6, -3.3000000000000007, -12.3, -3.500000000000001, -11.2, -3.5000000000000004, -3.2000000000000006, -3.400000000000001, -11.2, -3.1000000000000005, -3.7000000000000006, -3.6000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2, -3.3000000000000007, -3.3000000000000007, -3.2, -3.0000000000000004, -3.6000000000000005, -3.2, -3.400000000000001, -3.500000000000001, -3.400000000000001, -3.6000000000000005, -3.2000000000000006, -3.5000000000000004, -3.1000000000000005, -3.3000000000000007, -3.4000000000000004, -3.1000000000000005, -11.3, -11.5, -3.400000000000001, -3.400000000000001, -3.4000000000000004, -3.5000000000000004, -3.500000000000001, -10.6, -3.1000000000000005, -11.8, -3.500000000000001, -3.2000000000000006, -11.5, -3.5000000000000004, -10.9, -3.8000000000000007, -10.2, -10.5, -3.3000000000000007, -12.200000000000001, -3.600000000000001, -3.400000000000001, -11.3, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.400000000000001, -3.5000000000000004, -3.2000000000000006, -3.5000000000000004, -3.3000000000000007, -3.4000000000000004, -3.4000000000000004, -3.1000000000000005, -3.400000000000001, -3.3000000000000003, -3.4000000000000004, -3.4000000000000004, -3.4000000000000004, -3.3000000000000003, -3.500000000000001, -3.500000000000001, -12.1, -3.2, -3.5000000000000013, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 12, 21, 21, 21, 15, 21, 9, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 6, 10, 21, 21, 14, 21, 21, 21, 21, 21, 19, 21, 21, 19, 3, 21, 21, 21, 2, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 5, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 1, 6, 21, 21, 21, 21, 15, 21, 9, 21, 21, 21, 21, 21, 21, 21, 15, 2, 21, 21, 21, 17, 11, 7, 21, 19, 21, 11, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 15, 21, 21, 21, 21, 21, 7, 21, 19, 21, 21, 15, 21, 9, 21, 3, 6, 21, 20, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.454123123118743, "mean_inference_ms": 17.44987410508145, "mean_action_processing_ms": 0.9191953364881029, "mean_env_wait_ms": 2.14315802674671, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07387587898655941, "StateBufferConnector_ms": 0.00917957159891083, "ViewRequirementAgentConnector_ms": 0.13468128642397065}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.3, "episode_reward_mean": -4.863636363636364, "episode_len_mean": 19.13397129186603, "episodes_this_iter": 209, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.2000000000000006, -3.2000000000000006, -3.500000000000001, -3.1000000000000005, -3.600000000000001, -3.2000000000000006, -3.3000000000000007, -3.500000000000001, -3.1000000000000005, -3.6000000000000005, -3.500000000000001, -3.3000000000000007, -3.3000000000000007, -3.5000000000000013, -3.600000000000001, -3.400000000000001, -3.400000000000001, -3.2000000000000006, -3.2, -3.400000000000001, -3.6000000000000005, -3.3000000000000007, -10.6, -3.3000000000000007, -11.2, -3.4000000000000004, -3.600000000000001, -3.3000000000000003, -11.700000000000001, -3.5000000000000004, -10.9, -3.400000000000001, -3.2000000000000006, -3.6000000000000005, -3.500000000000001, -11.2, -3.500000000000001, -3.3000000000000007, -3.500000000000001, -3.500000000000001, -3.3000000000000007, -10.5, -11.0, -3.300000000000001, -3.400000000000001, -11.5, -3.500000000000001, -3.5000000000000004, -3.1000000000000005, -3.4000000000000004, -3.7000000000000006, -12.3, -3.1000000000000005, -3.3000000000000007, -12.200000000000001, -10.2, -3.2000000000000006, -3.500000000000001, -3.6000000000000014, -10.1, -3.4000000000000004, -3.5000000000000004, -3.500000000000001, -3.5000000000000004, -10.9, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -10.5, -3.4000000000000004, -3.3000000000000003, -3.6000000000000005, -12.200000000000001, -3.400000000000001, -3.600000000000001, -3.500000000000001, -3.3000000000000007, -3.7000000000000006, -3.500000000000001, -3.2, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.7000000000000006, -12.1, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.5000000000000004, -3.3000000000000007, -3.5000000000000004, -3.2, -3.400000000000001, -3.100000000000001, -3.2, -3.6000000000000005, -10.9, -3.600000000000001, -3.600000000000001, -3.500000000000001, -3.3000000000000007, -3.3000000000000003, -3.6000000000000005, -3.2000000000000006, -3.1000000000000005, -10.0, -10.5, -3.4000000000000004, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -11.6, -3.1000000000000005, -10.9, -3.400000000000001, -3.2, -3.2000000000000006, -3.6000000000000005, -3.3000000000000007, -3.600000000000001, -3.600000000000001, -11.5, -10.1, -3.4000000000000004, -3.1000000000000005, -3.4000000000000004, -11.8, -11.1, -10.6, -3.3000000000000007, -12.3, -3.500000000000001, -11.2, -3.5000000000000004, -3.2000000000000006, -3.400000000000001, -11.2, -3.1000000000000005, -3.7000000000000006, -3.6000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2, -3.3000000000000007, -3.3000000000000007, -3.2, -3.0000000000000004, -3.6000000000000005, -3.2, -3.400000000000001, -3.500000000000001, -3.400000000000001, -3.6000000000000005, -3.2000000000000006, -3.5000000000000004, -3.1000000000000005, -3.3000000000000007, -3.4000000000000004, -3.1000000000000005, -11.3, -11.5, -3.400000000000001, -3.400000000000001, -3.4000000000000004, -3.5000000000000004, -3.500000000000001, -10.6, -3.1000000000000005, -11.8, -3.500000000000001, -3.2000000000000006, -11.5, -3.5000000000000004, -10.9, -3.8000000000000007, -10.2, -10.5, -3.3000000000000007, -12.200000000000001, -3.600000000000001, -3.400000000000001, -11.3, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.400000000000001, -3.5000000000000004, -3.2000000000000006, -3.5000000000000004, -3.3000000000000007, -3.4000000000000004, -3.4000000000000004, -3.1000000000000005, -3.400000000000001, -3.3000000000000003, -3.4000000000000004, -3.4000000000000004, -3.4000000000000004, -3.3000000000000003, -3.500000000000001, -3.500000000000001, -12.1, -3.2, -3.5000000000000013, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 12, 21, 21, 21, 15, 21, 9, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 6, 10, 21, 21, 14, 21, 21, 21, 21, 21, 19, 21, 21, 19, 3, 21, 21, 21, 2, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 5, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 1, 6, 21, 21, 21, 21, 15, 21, 9, 21, 21, 21, 21, 21, 21, 21, 15, 2, 21, 21, 21, 17, 11, 7, 21, 19, 21, 11, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 15, 21, 21, 21, 21, 21, 7, 21, 19, 21, 21, 15, 21, 9, 21, 3, 6, 21, 20, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.454123123118743, "mean_inference_ms": 17.44987410508145, "mean_action_processing_ms": 0.9191953364881029, "mean_env_wait_ms": 2.14315802674671, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07387587898655941, "StateBufferConnector_ms": 0.00917957159891083, "ViewRequirementAgentConnector_ms": 0.13468128642397065}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 108000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 171098.408, "load_time_ms": 1.107, "load_throughput": 3613443.033, "learn_time_ms": 170106.982, "learn_throughput": 23.515, "synch_weights_time_ms": 175.982}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "episodes_total": 5655, "training_iteration": 27, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-06_22-12-46", "timestamp": 1680811966, "time_this_iter_s": 170.74242997169495, "time_total_s": 4619.902191877365, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476bcc70>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01475ec280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 4619.902191877365, "timesteps_since_restore": 0, "iterations_since_restore": 27, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.468312757201646, "ram_util_percent": 23.602469135802476}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.164130056977913, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.0010000000000000005, "total_loss": 0.5157228090900488, "policy_loss": -0.12074248710827482, "vf_loss": 0.6063652591178975, "vf_explained_var": 0.49931999509052566, "kl": 0.017616849439468996, "entropy": 3.891241093348431, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 25575.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.5, "episode_reward_mean": -4.543750000000001, "episode_len_mean": 19.379807692307693, "episode_media": {}, "episodes_this_iter": 208, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.100000000000001, -3.1000000000000005, -3.4000000000000004, -3.3000000000000007, -10.3, -3.700000000000001, -3.5000000000000004, -3.400000000000001, -10.6, -12.3, -3.3000000000000007, -3.200000000000001, -11.2, -10.5, -11.8, -3.600000000000001, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.2, -3.400000000000001, -3.5000000000000004, -3.2000000000000006, -3.7000000000000015, -3.1000000000000005, -3.3000000000000007, -3.6000000000000005, -3.3000000000000007, -3.4000000000000004, -3.500000000000001, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.500000000000001, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.500000000000001, -10.1, -3.3000000000000007, -3.300000000000001, -3.6000000000000005, -3.400000000000001, -3.2000000000000006, -3.5000000000000004, -3.3000000000000007, -3.3000000000000003, -3.5000000000000004, -3.3000000000000007, -3.500000000000001, -3.500000000000001, -3.4000000000000004, -3.500000000000001, -3.2000000000000006, -10.8, -3.1000000000000005, -10.9, -10.8, -3.500000000000001, -3.500000000000001, -3.3000000000000007, -3.500000000000001, -3.6000000000000005, -3.500000000000001, -3.4000000000000012, -3.600000000000001, -11.4, -3.1000000000000005, -3.2000000000000006, -3.6000000000000005, -3.3000000000000003, -3.500000000000001, -3.400000000000001, -3.5000000000000004, -3.5000000000000004, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -11.8, -3.400000000000001, -10.1, -10.7, -10.5, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.500000000000001, -3.3000000000000007, -3.500000000000001, -3.3000000000000007, -3.2000000000000006, -3.4000000000000012, -3.6000000000000005, -3.500000000000001, -3.3000000000000003, -3.6000000000000005, -3.3000000000000003, -3.3000000000000007, -3.4000000000000004, -3.500000000000001, -3.400000000000001, -3.3000000000000003, -3.5000000000000004, -3.2000000000000006, -12.200000000000001, -3.2000000000000006, -3.6, -3.400000000000001, -3.4000000000000012, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.4000000000000004, -3.300000000000001, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.500000000000001, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.5000000000000004, -3.400000000000001, -3.500000000000001, -3.3000000000000003, -3.4000000000000004, -3.400000000000001, -3.3000000000000007, -3.500000000000001, -3.2000000000000006, -10.8, -3.4000000000000004, -10.3, -3.5000000000000004, -12.100000000000001, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -11.6, -3.3000000000000003, -3.3000000000000003, -3.6000000000000005, -11.2, -3.400000000000001, -3.0000000000000004, -3.1000000000000005, -10.5, -3.5000000000000004, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -11.0, -11.5, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.400000000000001, -10.9, -3.400000000000001, -3.6000000000000005, -3.2000000000000006, -10.8, -3.3000000000000007, -10.9, -11.3, -3.6000000000000005, -3.800000000000001, -3.400000000000001, -12.5, -3.3000000000000007, -3.600000000000001, -3.8000000000000007, -3.400000000000001, -3.5000000000000004, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.6, -3.0000000000000004, -3.400000000000001, -3.2000000000000006, -11.9, -3.2000000000000006, -3.4000000000000004, -3.8000000000000007, -3.700000000000001, -3.2000000000000006, -3.400000000000001, -3.500000000000001, -3.300000000000001, -10.7, -3.3000000000000007, -10.4, -3.2000000000000006], "episode_lengths": [21, 21, 21, 21, 3, 21, 21, 21, 6, 20, 21, 21, 12, 5, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 9, 9, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 2, 8, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 4, 21, 18, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 12, 21, 21, 21, 5, 21, 21, 21, 21, 10, 13, 21, 21, 21, 21, 10, 21, 21, 21, 9, 21, 10, 12, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 5, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.465139738051763, "mean_inference_ms": 17.450005308469922, "mean_action_processing_ms": 0.9208260969616789, "mean_env_wait_ms": 2.14919059279523, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0768252290212191, "StateBufferConnector_ms": 0.01022574993280264, "ViewRequirementAgentConnector_ms": 0.14156664793307966}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.5, "episode_reward_mean": -4.543750000000001, "episode_len_mean": 19.379807692307693, "episodes_this_iter": 208, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.100000000000001, -3.1000000000000005, -3.4000000000000004, -3.3000000000000007, -10.3, -3.700000000000001, -3.5000000000000004, -3.400000000000001, -10.6, -12.3, -3.3000000000000007, -3.200000000000001, -11.2, -10.5, -11.8, -3.600000000000001, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.2, -3.400000000000001, -3.5000000000000004, -3.2000000000000006, -3.7000000000000015, -3.1000000000000005, -3.3000000000000007, -3.6000000000000005, -3.3000000000000007, -3.4000000000000004, -3.500000000000001, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.500000000000001, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.500000000000001, -10.1, -3.3000000000000007, -3.300000000000001, -3.6000000000000005, -3.400000000000001, -3.2000000000000006, -3.5000000000000004, -3.3000000000000007, -3.3000000000000003, -3.5000000000000004, -3.3000000000000007, -3.500000000000001, -3.500000000000001, -3.4000000000000004, -3.500000000000001, -3.2000000000000006, -10.8, -3.1000000000000005, -10.9, -10.8, -3.500000000000001, -3.500000000000001, -3.3000000000000007, -3.500000000000001, -3.6000000000000005, -3.500000000000001, -3.4000000000000012, -3.600000000000001, -11.4, -3.1000000000000005, -3.2000000000000006, -3.6000000000000005, -3.3000000000000003, -3.500000000000001, -3.400000000000001, -3.5000000000000004, -3.5000000000000004, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -11.8, -3.400000000000001, -10.1, -10.7, -10.5, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.500000000000001, -3.3000000000000007, -3.500000000000001, -3.3000000000000007, -3.2000000000000006, -3.4000000000000012, -3.6000000000000005, -3.500000000000001, -3.3000000000000003, -3.6000000000000005, -3.3000000000000003, -3.3000000000000007, -3.4000000000000004, -3.500000000000001, -3.400000000000001, -3.3000000000000003, -3.5000000000000004, -3.2000000000000006, -12.200000000000001, -3.2000000000000006, -3.6, -3.400000000000001, -3.4000000000000012, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.4000000000000004, -3.300000000000001, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.500000000000001, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.5000000000000004, -3.400000000000001, -3.500000000000001, -3.3000000000000003, -3.4000000000000004, -3.400000000000001, -3.3000000000000007, -3.500000000000001, -3.2000000000000006, -10.8, -3.4000000000000004, -10.3, -3.5000000000000004, -12.100000000000001, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -11.6, -3.3000000000000003, -3.3000000000000003, -3.6000000000000005, -11.2, -3.400000000000001, -3.0000000000000004, -3.1000000000000005, -10.5, -3.5000000000000004, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -11.0, -11.5, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.400000000000001, -10.9, -3.400000000000001, -3.6000000000000005, -3.2000000000000006, -10.8, -3.3000000000000007, -10.9, -11.3, -3.6000000000000005, -3.800000000000001, -3.400000000000001, -12.5, -3.3000000000000007, -3.600000000000001, -3.8000000000000007, -3.400000000000001, -3.5000000000000004, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.6, -3.0000000000000004, -3.400000000000001, -3.2000000000000006, -11.9, -3.2000000000000006, -3.4000000000000004, -3.8000000000000007, -3.700000000000001, -3.2000000000000006, -3.400000000000001, -3.500000000000001, -3.300000000000001, -10.7, -3.3000000000000007, -10.4, -3.2000000000000006], "episode_lengths": [21, 21, 21, 21, 3, 21, 21, 21, 6, 20, 21, 21, 12, 5, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 9, 9, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 2, 8, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 4, 21, 18, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 12, 21, 21, 21, 5, 21, 21, 21, 21, 10, 13, 21, 21, 21, 21, 10, 21, 21, 21, 9, 21, 10, 12, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 5, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.465139738051763, "mean_inference_ms": 17.450005308469922, "mean_action_processing_ms": 0.9208260969616789, "mean_env_wait_ms": 2.14919059279523, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0768252290212191, "StateBufferConnector_ms": 0.01022574993280264, "ViewRequirementAgentConnector_ms": 0.14156664793307966}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 171108.17, "load_time_ms": 1.117, "load_throughput": 3582119.737, "learn_time_ms": 170119.54, "learn_throughput": 23.513, "synch_weights_time_ms": 174.754}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "episodes_total": 5863, "training_iteration": 28, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-06_22-15-37", "timestamp": 1680812137, "time_this_iter_s": 171.6209979057312, "time_total_s": 4791.523189783096, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01477a3280>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01475d8280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 4791.523189783096, "timesteps_since_restore": 0, "iterations_since_restore": 28, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.655327868852458, "ram_util_percent": 23.599180327868854}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0585324948994062, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.0010000000000000005, "total_loss": 0.6432944260397425, "policy_loss": -0.037557404871869794, "vf_loss": 0.661550214556196, "vf_explained_var": 0.3962693423353216, "kl": 0.011296788078509971, "entropy": 3.888496595557018, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 26505.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "sampler_results": {"episode_reward_max": 99.3, "episode_reward_min": -12.200000000000001, "episode_reward_mean": -3.448756218905473, "episode_len_mean": 19.442786069651742, "episode_media": {}, "episodes_this_iter": 201, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.2, -11.2, -10.9, -3.2, -3.500000000000001, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -10.0, -3.400000000000001, -3.100000000000001, -3.2, -3.200000000000001, -3.5000000000000004, -3.400000000000001, -3.400000000000001, -3.2000000000000006, -3.200000000000001, -3.4000000000000004, -11.9, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.5000000000000004, -3.400000000000001, -3.4000000000000004, -3.500000000000001, -3.400000000000001, -3.1000000000000005, -10.7, -3.500000000000001, -3.1000000000000005, -3.400000000000001, -3.3000000000000003, -11.6, -3.5000000000000004, -10.4, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.5000000000000004, -11.4, -3.2000000000000006, -11.0, -3.4000000000000004, -3.4000000000000012, -3.400000000000001, -10.8, -3.2, -3.2000000000000006, -3.3000000000000007, -3.200000000000001, -11.600000000000001, -3.4000000000000004, -3.4000000000000004, -3.5000000000000004, -3.500000000000001, -3.2000000000000006, -3.500000000000001, 97.5, -10.4, -3.5000000000000004, -3.3000000000000007, -3.3000000000000007, -10.7, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -10.5, -3.5000000000000004, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.300000000000001, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -10.8, -3.2000000000000006, -3.400000000000001, -3.8000000000000003, -3.600000000000001, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -11.3, -3.2, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.5000000000000004, -3.400000000000001, -3.400000000000001, -3.400000000000001, -3.500000000000001, -11.9, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.3000000000000003, -3.400000000000001, -3.3000000000000003, -3.500000000000001, -3.400000000000001, -3.400000000000001, -3.4000000000000004, -3.500000000000001, -3.5000000000000004, -3.6000000000000005, -3.5000000000000004, -3.400000000000001, -3.600000000000001, -3.6000000000000005, -10.1, -3.400000000000001, -3.400000000000001, -3.2, -10.2, -3.400000000000001, -3.4000000000000004, -3.500000000000001, -3.5000000000000004, -3.600000000000001, -11.3, -3.2000000000000006, -3.600000000000001, -3.3000000000000003, -3.4000000000000004, -3.4000000000000004, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.200000000000001, -12.0, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.300000000000001, 99.3, -3.400000000000001, -3.4000000000000004, -3.500000000000001, -3.0000000000000004, -3.2, -3.4000000000000004, -3.400000000000001, -3.1000000000000005, -3.7000000000000006, -3.400000000000001, -11.7, -3.3000000000000007, -3.2000000000000006, -3.6000000000000005, -3.7000000000000015, -3.400000000000001, -3.5000000000000004, -3.500000000000001, -3.400000000000001, -11.2, -3.3000000000000007, -3.500000000000001, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.4000000000000004, -3.2, -11.9, -3.4000000000000004, -12.200000000000001, -3.500000000000001, -3.1000000000000005, -3.2, -3.600000000000001, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.500000000000001, -3.0000000000000004, -3.300000000000001, -3.3000000000000007, -3.1000000000000005, -3.8000000000000003, -3.2000000000000006, -11.3, -3.300000000000001, -3.2000000000000006, -3.5000000000000004, -3.0000000000000004, -11.0, -11.2, -3.2], "episode_lengths": [3, 12, 9, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 14, 21, 5, 21, 21, 21, 21, 14, 21, 10, 21, 21, 21, 8, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 20, 5, 21, 21, 21, 8, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 3, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 18, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 10, 13, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.4531858081481, "mean_inference_ms": 17.45593809654586, "mean_action_processing_ms": 0.9206373014303162, "mean_env_wait_ms": 2.1516711468873435, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07591520375873319, "StateBufferConnector_ms": 0.009401164837737582, "ViewRequirementAgentConnector_ms": 0.14001421667450104}}, "episode_reward_max": 99.3, "episode_reward_min": -12.200000000000001, "episode_reward_mean": -3.448756218905473, "episode_len_mean": 19.442786069651742, "episodes_this_iter": 201, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10.2, -11.2, -10.9, -3.2, -3.500000000000001, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -10.0, -3.400000000000001, -3.100000000000001, -3.2, -3.200000000000001, -3.5000000000000004, -3.400000000000001, -3.400000000000001, -3.2000000000000006, -3.200000000000001, -3.4000000000000004, -11.9, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.5000000000000004, -3.400000000000001, -3.4000000000000004, -3.500000000000001, -3.400000000000001, -3.1000000000000005, -10.7, -3.500000000000001, -3.1000000000000005, -3.400000000000001, -3.3000000000000003, -11.6, -3.5000000000000004, -10.4, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.5000000000000004, -11.4, -3.2000000000000006, -11.0, -3.4000000000000004, -3.4000000000000012, -3.400000000000001, -10.8, -3.2, -3.2000000000000006, -3.3000000000000007, -3.200000000000001, -11.600000000000001, -3.4000000000000004, -3.4000000000000004, -3.5000000000000004, -3.500000000000001, -3.2000000000000006, -3.500000000000001, 97.5, -10.4, -3.5000000000000004, -3.3000000000000007, -3.3000000000000007, -10.7, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -10.5, -3.5000000000000004, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.300000000000001, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -10.8, -3.2000000000000006, -3.400000000000001, -3.8000000000000003, -3.600000000000001, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -11.3, -3.2, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.5000000000000004, -3.400000000000001, -3.400000000000001, -3.400000000000001, -3.500000000000001, -11.9, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.3000000000000003, -3.400000000000001, -3.3000000000000003, -3.500000000000001, -3.400000000000001, -3.400000000000001, -3.4000000000000004, -3.500000000000001, -3.5000000000000004, -3.6000000000000005, -3.5000000000000004, -3.400000000000001, -3.600000000000001, -3.6000000000000005, -10.1, -3.400000000000001, -3.400000000000001, -3.2, -10.2, -3.400000000000001, -3.4000000000000004, -3.500000000000001, -3.5000000000000004, -3.600000000000001, -11.3, -3.2000000000000006, -3.600000000000001, -3.3000000000000003, -3.4000000000000004, -3.4000000000000004, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.200000000000001, -12.0, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.300000000000001, 99.3, -3.400000000000001, -3.4000000000000004, -3.500000000000001, -3.0000000000000004, -3.2, -3.4000000000000004, -3.400000000000001, -3.1000000000000005, -3.7000000000000006, -3.400000000000001, -11.7, -3.3000000000000007, -3.2000000000000006, -3.6000000000000005, -3.7000000000000015, -3.400000000000001, -3.5000000000000004, -3.500000000000001, -3.400000000000001, -11.2, -3.3000000000000007, -3.500000000000001, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.4000000000000004, -3.2, -11.9, -3.4000000000000004, -12.200000000000001, -3.500000000000001, -3.1000000000000005, -3.2, -3.600000000000001, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.500000000000001, -3.0000000000000004, -3.300000000000001, -3.3000000000000007, -3.1000000000000005, -3.8000000000000003, -3.2000000000000006, -11.3, -3.300000000000001, -3.2000000000000006, -3.5000000000000004, -3.0000000000000004, -11.0, -11.2, -3.2], "episode_lengths": [3, 12, 9, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 14, 21, 5, 21, 21, 21, 21, 14, 21, 10, 21, 21, 21, 8, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 20, 5, 21, 21, 21, 8, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 3, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 18, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 10, 13, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.4531858081481, "mean_inference_ms": 17.45593809654586, "mean_action_processing_ms": 0.9206373014303162, "mean_env_wait_ms": 2.1516711468873435, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07591520375873319, "StateBufferConnector_ms": 0.009401164837737582, "ViewRequirementAgentConnector_ms": 0.14001421667450104}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 116000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 116000, "timers": {"training_iteration_time_ms": 171118.773, "load_time_ms": 1.117, "load_throughput": 3581584.442, "learn_time_ms": 170122.864, "learn_throughput": 23.512, "synch_weights_time_ms": 174.547}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "done": false, "episodes_total": 6064, "training_iteration": 29, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-06_22-18-29", "timestamp": 1680812309, "time_this_iter_s": 171.12649655342102, "time_total_s": 4962.649686336517, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01477a3b20>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01475ec700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 4962.649686336517, "timesteps_since_restore": 0, "iterations_since_restore": 29, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.358436213991769, "ram_util_percent": 23.601234567901237}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1427695367124773, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.0010000000000000005, "total_loss": 0.3681849182948911, "policy_loss": -0.028893651966611426, "vf_loss": 0.3820177045640766, "vf_explained_var": 0.5953088535416511, "kl": 0.008814772707316273, "entropy": 3.8907478281246717, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 27435.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "sampler_results": {"episode_reward_max": 98.7, "episode_reward_min": -12.0, "episode_reward_mean": -3.5850746268656724, "episode_len_mean": 19.71641791044776, "episode_media": {}, "episodes_this_iter": 201, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.7000000000000006, -3.700000000000001, -10.9, -10.2, -11.8, -3.400000000000001, -3.3000000000000003, -3.500000000000001, -10.4, -3.4000000000000012, -3.0000000000000004, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.7000000000000006, 98.7, -3.400000000000001, -3.1000000000000005, -10.5, -3.500000000000001, -3.2000000000000006, -3.600000000000001, -3.500000000000001, -3.3000000000000007, -3.2000000000000006, -10.4, -3.100000000000001, -10.8, -3.400000000000001, -3.3000000000000003, -3.3000000000000007, -3.6000000000000014, -3.2000000000000006, -3.500000000000001, -3.600000000000001, -3.300000000000001, -3.3000000000000007, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.3000000000000003, -3.4000000000000004, -3.1000000000000005, -3.2, -3.1000000000000005, -3.3000000000000007, -3.5000000000000004, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.500000000000001, -3.3000000000000007, -3.5000000000000004, -3.3000000000000007, -3.6000000000000005, -3.400000000000001, -3.600000000000001, -10.4, -3.5000000000000004, -3.0000000000000004, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.500000000000001, -3.3000000000000007, -3.400000000000001, -3.500000000000001, -3.400000000000001, -3.3000000000000003, -10.7, -3.6000000000000005, -3.4000000000000004, -3.3000000000000007, -3.500000000000001, -3.2000000000000006, -3.3000000000000007, -3.500000000000001, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.5000000000000004, -3.400000000000001, -3.3000000000000003, -3.4000000000000004, -3.400000000000001, -3.5000000000000004, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -10.2, -3.2000000000000006, -3.200000000000001, -3.3000000000000007, -3.400000000000001, -3.5000000000000004, -3.3000000000000007, -3.500000000000001, -3.7000000000000006, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.4000000000000012, -3.400000000000001, -3.400000000000001, -10.4, -3.2000000000000006, -11.2, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.4000000000000004, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -3.4000000000000004, -3.3000000000000007, -3.400000000000001, -10.8, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.4000000000000004, -3.400000000000001, -3.2000000000000006, -3.5000000000000004, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.5000000000000004, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, -3.6000000000000005, -3.0000000000000004, -3.5000000000000004, -3.400000000000001, -3.2000000000000006, -3.2, -11.9, -3.400000000000001, -10.8, -3.600000000000001, -3.400000000000001, -3.2000000000000006, -11.1, -3.400000000000001, -3.3000000000000007, -3.6000000000000005, -3.2000000000000006, -3.500000000000001, -3.1000000000000005, -3.5000000000000004, -3.600000000000001, -3.400000000000001, -3.2000000000000006, -11.5, -3.2000000000000006, -10.1, -3.300000000000001, -3.400000000000001, -3.600000000000001, -3.3000000000000007, -3.6000000000000005, -3.6000000000000005, -3.500000000000001, -3.500000000000001, -3.3000000000000007, -3.600000000000001, -3.500000000000001, -3.1000000000000005, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.500000000000001, -3.100000000000001, -3.400000000000001, -3.0000000000000004, -3.4000000000000004, -3.2000000000000006, -3.3000000000000003, -3.4000000000000004, -3.3000000000000003, -3.6000000000000005, -3.2000000000000006, -12.0, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -10.6, -3.2], "episode_lengths": [21, 21, 7, 3, 18, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 6, 21, 21, 21, 21, 21, 21, 5, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 9, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 7, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.479086790519753, "mean_inference_ms": 17.413213803057033, "mean_action_processing_ms": 0.9193323583014996, "mean_env_wait_ms": 2.1481117767336007, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07331430615477301, "StateBufferConnector_ms": 0.009270093927335977, "ViewRequirementAgentConnector_ms": 0.1347929684083853}}, "episode_reward_max": 98.7, "episode_reward_min": -12.0, "episode_reward_mean": -3.5850746268656724, "episode_len_mean": 19.71641791044776, "episodes_this_iter": 201, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.7000000000000006, -3.700000000000001, -10.9, -10.2, -11.8, -3.400000000000001, -3.3000000000000003, -3.500000000000001, -10.4, -3.4000000000000012, -3.0000000000000004, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.7000000000000006, 98.7, -3.400000000000001, -3.1000000000000005, -10.5, -3.500000000000001, -3.2000000000000006, -3.600000000000001, -3.500000000000001, -3.3000000000000007, -3.2000000000000006, -10.4, -3.100000000000001, -10.8, -3.400000000000001, -3.3000000000000003, -3.3000000000000007, -3.6000000000000014, -3.2000000000000006, -3.500000000000001, -3.600000000000001, -3.300000000000001, -3.3000000000000007, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.3000000000000003, -3.4000000000000004, -3.1000000000000005, -3.2, -3.1000000000000005, -3.3000000000000007, -3.5000000000000004, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.500000000000001, -3.3000000000000007, -3.5000000000000004, -3.3000000000000007, -3.6000000000000005, -3.400000000000001, -3.600000000000001, -10.4, -3.5000000000000004, -3.0000000000000004, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.500000000000001, -3.3000000000000007, -3.400000000000001, -3.500000000000001, -3.400000000000001, -3.3000000000000003, -10.7, -3.6000000000000005, -3.4000000000000004, -3.3000000000000007, -3.500000000000001, -3.2000000000000006, -3.3000000000000007, -3.500000000000001, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.5000000000000004, -3.400000000000001, -3.3000000000000003, -3.4000000000000004, -3.400000000000001, -3.5000000000000004, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -10.2, -3.2000000000000006, -3.200000000000001, -3.3000000000000007, -3.400000000000001, -3.5000000000000004, -3.3000000000000007, -3.500000000000001, -3.7000000000000006, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.4000000000000012, -3.400000000000001, -3.400000000000001, -10.4, -3.2000000000000006, -11.2, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.4000000000000004, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -3.4000000000000004, -3.3000000000000007, -3.400000000000001, -10.8, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.4000000000000004, -3.400000000000001, -3.2000000000000006, -3.5000000000000004, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.5000000000000004, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, -3.6000000000000005, -3.0000000000000004, -3.5000000000000004, -3.400000000000001, -3.2000000000000006, -3.2, -11.9, -3.400000000000001, -10.8, -3.600000000000001, -3.400000000000001, -3.2000000000000006, -11.1, -3.400000000000001, -3.3000000000000007, -3.6000000000000005, -3.2000000000000006, -3.500000000000001, -3.1000000000000005, -3.5000000000000004, -3.600000000000001, -3.400000000000001, -3.2000000000000006, -11.5, -3.2000000000000006, -10.1, -3.300000000000001, -3.400000000000001, -3.600000000000001, -3.3000000000000007, -3.6000000000000005, -3.6000000000000005, -3.500000000000001, -3.500000000000001, -3.3000000000000007, -3.600000000000001, -3.500000000000001, -3.1000000000000005, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.500000000000001, -3.100000000000001, -3.400000000000001, -3.0000000000000004, -3.4000000000000004, -3.2000000000000006, -3.3000000000000003, -3.4000000000000004, -3.3000000000000003, -3.6000000000000005, -3.2000000000000006, -12.0, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -10.6, -3.2], "episode_lengths": [21, 21, 7, 3, 18, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 6, 21, 21, 21, 21, 21, 21, 5, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 9, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 7, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.479086790519753, "mean_inference_ms": 17.413213803057033, "mean_action_processing_ms": 0.9193323583014996, "mean_env_wait_ms": 2.1481117767336007, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07331430615477301, "StateBufferConnector_ms": 0.009270093927335977, "ViewRequirementAgentConnector_ms": 0.1347929684083853}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 170994.879, "load_time_ms": 1.122, "load_throughput": 3565902.782, "learn_time_ms": 170050.842, "learn_throughput": 23.522, "synch_weights_time_ms": 173.981}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "episodes_total": 6265, "training_iteration": 30, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-06_22-21-19", "timestamp": 1680812479, "time_this_iter_s": 170.84243726730347, "time_total_s": 5133.492123603821, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476f2cd0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01475b0a60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 5133.492123603821, "timesteps_since_restore": 0, "iterations_since_restore": 30, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.388888888888889, "ram_util_percent": 23.600411522633745}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1411301178316917, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.0010000000000000005, "total_loss": 0.5981370974011639, "policy_loss": -0.0956475922226986, "vf_loss": 0.6678556381895017, "vf_explained_var": 0.475656593935464, "kl": 0.015175666421763248, "entropy": 3.8804293586361793, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 28365.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "sampler_results": {"episode_reward_max": 98.2, "episode_reward_min": -12.200000000000001, "episode_reward_mean": -3.9428571428571435, "episode_len_mean": 19.857142857142858, "episode_media": {}, "episodes_this_iter": 203, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3000000000000007, -3.5000000000000004, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -10.7, -3.3000000000000007, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, -3.7000000000000006, -3.3000000000000007, -3.2000000000000006, -3.6000000000000005, -3.3000000000000007, -11.8, -3.500000000000001, -3.2000000000000006, -3.3000000000000003, -3.400000000000001, -3.400000000000001, -3.500000000000001, -3.3000000000000007, -3.500000000000001, -3.400000000000001, -11.4, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.4000000000000004, -3.5000000000000004, -12.0, -3.600000000000001, -11.4, -3.4000000000000004, -3.500000000000001, -12.200000000000001, -3.6000000000000005, -3.3000000000000007, -3.2, -11.9, -3.500000000000001, -3.0000000000000004, -3.0000000000000004, -11.700000000000001, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.400000000000001, 98.2, -3.5000000000000004, -3.300000000000001, -3.6000000000000014, -3.4000000000000004, -11.0, -3.400000000000001, -10.1, -12.0, -3.3000000000000003, -12.0, -3.500000000000001, -3.2000000000000006, -12.0, -3.3000000000000007, -11.5, -3.5000000000000004, -3.3000000000000003, -3.5000000000000004, -3.3000000000000003, -3.1000000000000005, -11.7, -11.1, -3.1000000000000005, -12.200000000000001, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.4000000000000004, -12.0, -3.500000000000001, -3.4000000000000004, -3.400000000000001, -3.600000000000001, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -11.0, -10.7, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.4000000000000004, -3.500000000000001, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -12.0, -3.2, -3.7000000000000006, -3.7000000000000006, -3.2000000000000006, -3.4000000000000004, -3.700000000000001, -3.400000000000001, -3.4000000000000004, -3.400000000000001, -3.400000000000001, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.500000000000001, -3.3000000000000007, -3.600000000000001, -3.2000000000000006, -3.500000000000001, -3.4000000000000004, -3.1000000000000005, -3.3000000000000003, -3.500000000000001, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.6000000000000005, -3.300000000000001, -3.1000000000000005, -3.700000000000001, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -11.1, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.500000000000001, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.500000000000001, -3.500000000000001, -3.2, -3.400000000000001, -3.5000000000000004, -3.3000000000000007, -11.3, -3.5000000000000004, -10.1, -3.3000000000000007, -3.300000000000001, -3.400000000000001, -10.8, -3.5000000000000004, -3.200000000000001, -3.400000000000001, -3.400000000000001, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.400000000000001, -3.400000000000001, -3.4000000000000004, -3.3000000000000007, -3.300000000000001, -11.9, -3.3000000000000003, -3.1000000000000005, -10.4, -3.4000000000000004, -3.3000000000000003, -3.500000000000001, -3.100000000000001, -3.400000000000001, -3.2000000000000006, -3.3000000000000003, -3.2, -3.4000000000000004, -3.200000000000001, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.3000000000000003, -3.3000000000000007, -3.100000000000001, -3.2000000000000006, -3.1000000000000005, -3.2, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -10.7, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.5000000000000004], "episode_lengths": [21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 17, 21, 14, 21, 21, 20, 21, 21, 21, 17, 21, 21, 21, 17, 21, 21, 21, 21, 16, 21, 21, 21, 21, 9, 21, 2, 18, 21, 17, 21, 21, 16, 21, 12, 21, 21, 21, 21, 21, 16, 12, 21, 19, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 11, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 2, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.501232570149112, "mean_inference_ms": 17.39852002126165, "mean_action_processing_ms": 0.918256182383991, "mean_env_wait_ms": 2.1484358175303777, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07247161395444071, "StateBufferConnector_ms": 0.009043698240383506, "ViewRequirementAgentConnector_ms": 0.13205394369040804}}, "episode_reward_max": 98.2, "episode_reward_min": -12.200000000000001, "episode_reward_mean": -3.9428571428571435, "episode_len_mean": 19.857142857142858, "episodes_this_iter": 203, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.3000000000000007, -3.5000000000000004, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -10.7, -3.3000000000000007, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, -3.7000000000000006, -3.3000000000000007, -3.2000000000000006, -3.6000000000000005, -3.3000000000000007, -11.8, -3.500000000000001, -3.2000000000000006, -3.3000000000000003, -3.400000000000001, -3.400000000000001, -3.500000000000001, -3.3000000000000007, -3.500000000000001, -3.400000000000001, -11.4, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.4000000000000004, -3.5000000000000004, -12.0, -3.600000000000001, -11.4, -3.4000000000000004, -3.500000000000001, -12.200000000000001, -3.6000000000000005, -3.3000000000000007, -3.2, -11.9, -3.500000000000001, -3.0000000000000004, -3.0000000000000004, -11.700000000000001, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.400000000000001, 98.2, -3.5000000000000004, -3.300000000000001, -3.6000000000000014, -3.4000000000000004, -11.0, -3.400000000000001, -10.1, -12.0, -3.3000000000000003, -12.0, -3.500000000000001, -3.2000000000000006, -12.0, -3.3000000000000007, -11.5, -3.5000000000000004, -3.3000000000000003, -3.5000000000000004, -3.3000000000000003, -3.1000000000000005, -11.7, -11.1, -3.1000000000000005, -12.200000000000001, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.4000000000000004, -12.0, -3.500000000000001, -3.4000000000000004, -3.400000000000001, -3.600000000000001, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -11.0, -10.7, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.4000000000000004, -3.500000000000001, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -12.0, -3.2, -3.7000000000000006, -3.7000000000000006, -3.2000000000000006, -3.4000000000000004, -3.700000000000001, -3.400000000000001, -3.4000000000000004, -3.400000000000001, -3.400000000000001, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.500000000000001, -3.3000000000000007, -3.600000000000001, -3.2000000000000006, -3.500000000000001, -3.4000000000000004, -3.1000000000000005, -3.3000000000000003, -3.500000000000001, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.6000000000000005, -3.300000000000001, -3.1000000000000005, -3.700000000000001, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -11.1, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.500000000000001, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.500000000000001, -3.500000000000001, -3.2, -3.400000000000001, -3.5000000000000004, -3.3000000000000007, -11.3, -3.5000000000000004, -10.1, -3.3000000000000007, -3.300000000000001, -3.400000000000001, -10.8, -3.5000000000000004, -3.200000000000001, -3.400000000000001, -3.400000000000001, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.400000000000001, -3.400000000000001, -3.4000000000000004, -3.3000000000000007, -3.300000000000001, -11.9, -3.3000000000000003, -3.1000000000000005, -10.4, -3.4000000000000004, -3.3000000000000003, -3.500000000000001, -3.100000000000001, -3.400000000000001, -3.2000000000000006, -3.3000000000000003, -3.2, -3.4000000000000004, -3.200000000000001, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.3000000000000003, -3.3000000000000007, -3.100000000000001, -3.2000000000000006, -3.1000000000000005, -3.2, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -10.7, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.5000000000000004], "episode_lengths": [21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 17, 21, 14, 21, 21, 20, 21, 21, 21, 17, 21, 21, 21, 17, 21, 21, 21, 21, 16, 21, 21, 21, 21, 9, 21, 2, 18, 21, 17, 21, 21, 16, 21, 12, 21, 21, 21, 21, 21, 16, 12, 21, 19, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 11, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 2, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.501232570149112, "mean_inference_ms": 17.39852002126165, "mean_action_processing_ms": 0.918256182383991, "mean_env_wait_ms": 2.1484358175303777, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07247161395444071, "StateBufferConnector_ms": 0.009043698240383506, "ViewRequirementAgentConnector_ms": 0.13205394369040804}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 124000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 124000, "timers": {"training_iteration_time_ms": 170930.975, "load_time_ms": 1.124, "load_throughput": 3559849.774, "learn_time_ms": 169991.258, "learn_throughput": 23.531, "synch_weights_time_ms": 171.098}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "done": false, "episodes_total": 6468, "training_iteration": 31, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-06_22-24-10", "timestamp": 1680812650, "time_this_iter_s": 170.62353110313416, "time_total_s": 5304.115654706955, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476d7040>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01475ecc10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 5304.115654706955, "timesteps_since_restore": 0, "iterations_since_restore": 31, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.367489711934156, "ram_util_percent": 23.600823045267493}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0413996903966831, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.0010000000000000005, "total_loss": 0.7544606627565958, "policy_loss": -0.053874368072106875, "vf_loss": 0.7886050451496837, "vf_explained_var": 0.42519545465387326, "kl": 0.011547497837987017, "entropy": 3.8711725701567947, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "sampler_results": {"episode_reward_max": 98.2, "episode_reward_min": -12.4, "episode_reward_mean": -4.294312796208531, "episode_len_mean": 18.98578199052133, "episode_media": {}, "episodes_this_iter": 211, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.4000000000000004, -3.400000000000001, -3.3000000000000003, -3.5000000000000004, -11.2, -3.2000000000000006, -3.0000000000000004, -3.5000000000000004, -3.4000000000000004, -3.0000000000000004, -3.600000000000001, -3.3000000000000007, -3.500000000000001, -3.4000000000000004, -3.1000000000000005, -3.100000000000001, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.600000000000001, -3.3000000000000007, -3.5000000000000004, -11.2, -12.1, -3.500000000000001, -3.600000000000001, -3.500000000000001, -10.8, -3.500000000000001, -3.2000000000000006, -3.3000000000000003, -3.400000000000001, -3.6000000000000005, -11.4, -3.600000000000001, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.500000000000001, -11.4, -3.600000000000001, -3.700000000000001, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.4000000000000004, -3.5000000000000004, -3.3000000000000003, -11.3, -3.2000000000000006, -3.3000000000000007, -3.2, -10.4, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, 98.2, -3.4000000000000004, -3.5000000000000004, -3.6000000000000005, -3.1000000000000005, -11.8, -11.3, -3.1000000000000005, -3.5000000000000004, -10.9, -3.500000000000001, -3.4000000000000004, -3.400000000000001, -3.500000000000001, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -11.1, -3.0000000000000004, -3.3000000000000007, -3.2, -3.3000000000000007, -10.5, -3.3000000000000007, -3.4000000000000004, -11.9, -3.3000000000000007, -10.8, -10.5, -3.400000000000001, -3.400000000000001, -3.3000000000000003, -3.3000000000000003, -10.3, -3.5000000000000004, -3.2000000000000006, -3.700000000000001, -3.600000000000001, -3.700000000000001, -10.9, -3.6000000000000005, -3.600000000000001, -3.6000000000000005, -3.2, -3.5000000000000004, -11.6, -3.0000000000000004, -3.4000000000000012, -3.3000000000000007, -3.5000000000000004, -3.2, -3.5000000000000004, -3.500000000000001, -3.600000000000001, -3.5, -3.5000000000000004, -3.4000000000000004, -3.5000000000000004, -3.7000000000000006, -3.6000000000000014, -3.400000000000001, -3.500000000000001, -3.4000000000000004, -3.5000000000000004, -3.6000000000000005, -3.500000000000001, -3.3000000000000007, -3.1000000000000005, -3.5000000000000004, -11.3, -10.0, -12.4, -3.5000000000000004, -3.3000000000000007, -10.0, -3.5000000000000004, -10.3, -10.2, -3.6000000000000005, -10.2, -3.2000000000000006, -10.2, -10.5, -3.0000000000000004, -11.5, -10.9, -3.400000000000001, -3.2000000000000006, -3.5000000000000004, -12.1, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -10.1, -3.200000000000001, -3.1000000000000005, -3.3000000000000007, -12.0, -3.600000000000001, -3.3000000000000007, -3.2000000000000006, -3.600000000000001, -3.1000000000000005, -3.5000000000000004, -3.6000000000000005, -3.2, -10.8, -10.6, -3.2, -10.7, -3.3000000000000007, -3.6000000000000014, -11.9, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.200000000000001, -3.6000000000000005, -3.800000000000001, -11.8, -3.5000000000000004, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.5000000000000004, -3.400000000000001, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.5000000000000004, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.500000000000001, -3.500000000000001, -3.2, -3.4000000000000012, -3.3000000000000007, -3.2000000000000006, -11.0, -3.5000000000000004], "episode_lengths": [21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 18, 21, 21, 21, 9, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 5, 21, 21, 21, 21, 16, 21, 21, 21, 21, 18, 13, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 6, 21, 21, 16, 21, 8, 6, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 1, 20, 21, 21, 1, 21, 4, 3, 21, 3, 21, 3, 6, 21, 15, 10, 21, 21, 21, 19, 21, 21, 21, 2, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 8, 6, 21, 6, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.50834441478854, "mean_inference_ms": 17.42994754371942, "mean_action_processing_ms": 0.9200421984902182, "mean_env_wait_ms": 2.1557267646059897, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0751436604142754, "StateBufferConnector_ms": 0.009575387312902658, "ViewRequirementAgentConnector_ms": 0.13942978393410055}}, "episode_reward_max": 98.2, "episode_reward_min": -12.4, "episode_reward_mean": -4.294312796208531, "episode_len_mean": 18.98578199052133, "episodes_this_iter": 211, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.4000000000000004, -3.400000000000001, -3.3000000000000003, -3.5000000000000004, -11.2, -3.2000000000000006, -3.0000000000000004, -3.5000000000000004, -3.4000000000000004, -3.0000000000000004, -3.600000000000001, -3.3000000000000007, -3.500000000000001, -3.4000000000000004, -3.1000000000000005, -3.100000000000001, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.600000000000001, -3.3000000000000007, -3.5000000000000004, -11.2, -12.1, -3.500000000000001, -3.600000000000001, -3.500000000000001, -10.8, -3.500000000000001, -3.2000000000000006, -3.3000000000000003, -3.400000000000001, -3.6000000000000005, -11.4, -3.600000000000001, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.500000000000001, -11.4, -3.600000000000001, -3.700000000000001, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.4000000000000004, -3.5000000000000004, -3.3000000000000003, -11.3, -3.2000000000000006, -3.3000000000000007, -3.2, -10.4, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, 98.2, -3.4000000000000004, -3.5000000000000004, -3.6000000000000005, -3.1000000000000005, -11.8, -11.3, -3.1000000000000005, -3.5000000000000004, -10.9, -3.500000000000001, -3.4000000000000004, -3.400000000000001, -3.500000000000001, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -11.1, -3.0000000000000004, -3.3000000000000007, -3.2, -3.3000000000000007, -10.5, -3.3000000000000007, -3.4000000000000004, -11.9, -3.3000000000000007, -10.8, -10.5, -3.400000000000001, -3.400000000000001, -3.3000000000000003, -3.3000000000000003, -10.3, -3.5000000000000004, -3.2000000000000006, -3.700000000000001, -3.600000000000001, -3.700000000000001, -10.9, -3.6000000000000005, -3.600000000000001, -3.6000000000000005, -3.2, -3.5000000000000004, -11.6, -3.0000000000000004, -3.4000000000000012, -3.3000000000000007, -3.5000000000000004, -3.2, -3.5000000000000004, -3.500000000000001, -3.600000000000001, -3.5, -3.5000000000000004, -3.4000000000000004, -3.5000000000000004, -3.7000000000000006, -3.6000000000000014, -3.400000000000001, -3.500000000000001, -3.4000000000000004, -3.5000000000000004, -3.6000000000000005, -3.500000000000001, -3.3000000000000007, -3.1000000000000005, -3.5000000000000004, -11.3, -10.0, -12.4, -3.5000000000000004, -3.3000000000000007, -10.0, -3.5000000000000004, -10.3, -10.2, -3.6000000000000005, -10.2, -3.2000000000000006, -10.2, -10.5, -3.0000000000000004, -11.5, -10.9, -3.400000000000001, -3.2000000000000006, -3.5000000000000004, -12.1, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -10.1, -3.200000000000001, -3.1000000000000005, -3.3000000000000007, -12.0, -3.600000000000001, -3.3000000000000007, -3.2000000000000006, -3.600000000000001, -3.1000000000000005, -3.5000000000000004, -3.6000000000000005, -3.2, -10.8, -10.6, -3.2, -10.7, -3.3000000000000007, -3.6000000000000014, -11.9, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.200000000000001, -3.6000000000000005, -3.800000000000001, -11.8, -3.5000000000000004, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.5000000000000004, -3.400000000000001, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.5000000000000004, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.500000000000001, -3.500000000000001, -3.2, -3.4000000000000012, -3.3000000000000007, -3.2000000000000006, -11.0, -3.5000000000000004], "episode_lengths": [21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 18, 21, 21, 21, 9, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 5, 21, 21, 21, 21, 16, 21, 21, 21, 21, 18, 13, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 6, 21, 21, 16, 21, 8, 6, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 1, 20, 21, 21, 1, 21, 4, 3, 21, 3, 21, 3, 6, 21, 15, 10, 21, 21, 21, 19, 21, 21, 21, 2, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 8, 6, 21, 6, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.50834441478854, "mean_inference_ms": 17.42994754371942, "mean_action_processing_ms": 0.9200421984902182, "mean_env_wait_ms": 2.1557267646059897, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0751436604142754, "StateBufferConnector_ms": 0.009575387312902658, "ViewRequirementAgentConnector_ms": 0.13942978393410055}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 171035.547, "load_time_ms": 1.121, "load_throughput": 3569012.934, "learn_time_ms": 170075.987, "learn_throughput": 23.519, "synch_weights_time_ms": 190.265}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "episodes_total": 6679, "training_iteration": 32, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-06_22-27-02", "timestamp": 1680812822, "time_this_iter_s": 171.64524579048157, "time_total_s": 5475.7609004974365, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01477400a0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014772e040>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 5475.7609004974365, "timesteps_since_restore": 0, "iterations_since_restore": 32, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.615573770491802, "ram_util_percent": 23.597950819672132}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1438427871273409, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.0010000000000000005, "total_loss": 0.3732863734115756, "policy_loss": -0.07927502094998315, "vf_loss": 0.43211545499181875, "vf_explained_var": 0.524559949739005, "kl": 0.011966527850925422, "entropy": 3.8650676340185184, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 30225.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "sampler_results": {"episode_reward_max": 98.7, "episode_reward_min": -12.200000000000001, "episode_reward_mean": -3.6155778894472363, "episode_len_mean": 20.020100502512562, "episode_media": {}, "episodes_this_iter": 199, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.6000000000000005, -11.8, -3.6000000000000005, -3.300000000000001, -3.3000000000000007, -3.500000000000001, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.5000000000000004, -3.1000000000000005, -3.300000000000001, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.5000000000000004, -3.1000000000000005, -3.4000000000000004, -3.400000000000001, -11.8, -3.400000000000001, -3.2000000000000006, -3.200000000000001, -3.3000000000000003, -3.400000000000001, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.4000000000000004, -3.4000000000000004, -3.300000000000001, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.400000000000001, -11.3, -3.3000000000000007, -3.6000000000000005, -3.600000000000001, -11.1, -3.400000000000001, -3.2000000000000006, -3.0000000000000004, -3.3000000000000003, -3.2000000000000006, -3.2, -3.2000000000000006, -3.2000000000000006, -3.500000000000001, -3.6000000000000005, -3.2000000000000006, -3.600000000000001, -3.200000000000001, -12.200000000000001, -3.1000000000000005, -3.3000000000000007, -3.700000000000001, -3.3000000000000007, -3.400000000000001, -3.4000000000000004, -3.4000000000000004, -3.1000000000000005, -10.4, -3.3000000000000007, -11.5, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -3.400000000000001, -3.400000000000001, -3.400000000000001, -3.4000000000000004, -11.6, -3.3000000000000007, -3.3000000000000007, -3.7000000000000006, -10.8, -3.4000000000000004, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -10.0, -3.500000000000001, -3.3000000000000007, -3.6000000000000005, -3.600000000000001, -3.3000000000000007, -12.100000000000001, -3.2000000000000006, -3.500000000000001, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.3000000000000003, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.3000000000000003, -3.400000000000001, -3.500000000000001, -3.200000000000001, 98.7, -3.500000000000001, -3.400000000000001, -3.600000000000001, -3.500000000000001, -3.400000000000001, -3.500000000000001, -3.5000000000000004, -3.6000000000000005, -3.4000000000000004, -3.1000000000000005, -3.3000000000000007, -3.4000000000000004, -3.2, -3.0000000000000004, -3.3000000000000003, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.2, -3.500000000000001, -3.5000000000000004, -3.3000000000000007, -3.1000000000000005, -3.600000000000001, -10.7, -3.2000000000000006, -3.400000000000001, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.4000000000000004, -3.800000000000001, -3.0000000000000004, -3.2, -3.4000000000000012, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.500000000000001, -3.400000000000001, -3.400000000000001, -3.4000000000000012, -3.2, -3.700000000000001, -10.5, -3.3000000000000003, -3.4000000000000004, -3.2000000000000006, -3.700000000000001, -11.9, -10.4, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -10.3, -3.400000000000001, -3.3000000000000007, -3.3000000000000003, -3.400000000000001, -3.500000000000001, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.500000000000001, -3.2000000000000006, -3.7000000000000006, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.4000000000000012, -10.5, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.4000000000000004, -3.400000000000001, -11.1, -11.9, -3.3000000000000007, -3.5000000000000004, -3.3000000000000007, -11.2], "episode_lengths": [21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 9, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 18, 5, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 12, 19, 21, 21, 21, 12]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.516095073370709, "mean_inference_ms": 17.370509681173562, "mean_action_processing_ms": 0.9167715487382543, "mean_env_wait_ms": 2.14679900271244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06733671504648486, "StateBufferConnector_ms": 0.008759187094530269, "ViewRequirementAgentConnector_ms": 0.12677518566649162}}, "episode_reward_max": 98.7, "episode_reward_min": -12.200000000000001, "episode_reward_mean": -3.6155778894472363, "episode_len_mean": 20.020100502512562, "episodes_this_iter": 199, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.6000000000000005, -11.8, -3.6000000000000005, -3.300000000000001, -3.3000000000000007, -3.500000000000001, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.5000000000000004, -3.1000000000000005, -3.300000000000001, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.5000000000000004, -3.1000000000000005, -3.4000000000000004, -3.400000000000001, -11.8, -3.400000000000001, -3.2000000000000006, -3.200000000000001, -3.3000000000000003, -3.400000000000001, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.4000000000000004, -3.4000000000000004, -3.300000000000001, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.400000000000001, -11.3, -3.3000000000000007, -3.6000000000000005, -3.600000000000001, -11.1, -3.400000000000001, -3.2000000000000006, -3.0000000000000004, -3.3000000000000003, -3.2000000000000006, -3.2, -3.2000000000000006, -3.2000000000000006, -3.500000000000001, -3.6000000000000005, -3.2000000000000006, -3.600000000000001, -3.200000000000001, -12.200000000000001, -3.1000000000000005, -3.3000000000000007, -3.700000000000001, -3.3000000000000007, -3.400000000000001, -3.4000000000000004, -3.4000000000000004, -3.1000000000000005, -10.4, -3.3000000000000007, -11.5, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -3.400000000000001, -3.400000000000001, -3.400000000000001, -3.4000000000000004, -11.6, -3.3000000000000007, -3.3000000000000007, -3.7000000000000006, -10.8, -3.4000000000000004, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -10.0, -3.500000000000001, -3.3000000000000007, -3.6000000000000005, -3.600000000000001, -3.3000000000000007, -12.100000000000001, -3.2000000000000006, -3.500000000000001, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.3000000000000003, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.3000000000000003, -3.400000000000001, -3.500000000000001, -3.200000000000001, 98.7, -3.500000000000001, -3.400000000000001, -3.600000000000001, -3.500000000000001, -3.400000000000001, -3.500000000000001, -3.5000000000000004, -3.6000000000000005, -3.4000000000000004, -3.1000000000000005, -3.3000000000000007, -3.4000000000000004, -3.2, -3.0000000000000004, -3.3000000000000003, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.2, -3.500000000000001, -3.5000000000000004, -3.3000000000000007, -3.1000000000000005, -3.600000000000001, -10.7, -3.2000000000000006, -3.400000000000001, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.4000000000000004, -3.800000000000001, -3.0000000000000004, -3.2, -3.4000000000000012, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.500000000000001, -3.400000000000001, -3.400000000000001, -3.4000000000000012, -3.2, -3.700000000000001, -10.5, -3.3000000000000003, -3.4000000000000004, -3.2000000000000006, -3.700000000000001, -11.9, -10.4, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -10.3, -3.400000000000001, -3.3000000000000007, -3.3000000000000003, -3.400000000000001, -3.500000000000001, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.500000000000001, -3.2000000000000006, -3.7000000000000006, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.4000000000000012, -10.5, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.4000000000000004, -3.400000000000001, -11.1, -11.9, -3.3000000000000007, -3.5000000000000004, -3.3000000000000007, -11.2], "episode_lengths": [21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 9, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 18, 5, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 12, 19, 21, 21, 21, 12]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.516095073370709, "mean_inference_ms": 17.370509681173562, "mean_action_processing_ms": 0.9167715487382543, "mean_env_wait_ms": 2.14679900271244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06733671504648486, "StateBufferConnector_ms": 0.008759187094530269, "ViewRequirementAgentConnector_ms": 0.12677518566649162}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 132000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 171057.356, "load_time_ms": 1.12, "load_throughput": 3571444.142, "learn_time_ms": 170098.036, "learn_throughput": 23.516, "synch_weights_time_ms": 192.467}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "episodes_total": 6878, "training_iteration": 33, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-06_22-29-53", "timestamp": 1680812993, "time_this_iter_s": 170.6921820640564, "time_total_s": 5646.453082561493, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476d7040>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014757d1f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 5646.453082561493, "timesteps_since_restore": 0, "iterations_since_restore": 33, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.326337448559671, "ram_util_percent": 23.554320987654325}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1751935573034389, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.0010000000000000005, "total_loss": 0.4273951690523855, "policy_loss": -0.1192641931741188, "vf_loss": 0.5176994364718677, "vf_explained_var": 0.4994584568726119, "kl": 0.016949565900159218, "entropy": 3.847356234058257, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 31155.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.3, "episode_reward_mean": -4.307881773399015, "episode_len_mean": 20.039408866995075, "episode_media": {}, "episodes_this_iter": 203, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.3, -3.5000000000000004, -3.2000000000000006, -3.400000000000001, -11.8, -3.500000000000001, -10.4, -3.3000000000000007, -3.3000000000000003, -10.3, -3.2000000000000006, -3.3000000000000007, -10.7, -10.8, -3.600000000000001, -3.4000000000000004, -3.2000000000000006, -11.0, -3.2, -3.3000000000000003, -3.6000000000000005, -3.6000000000000005, -3.6000000000000005, -3.1000000000000005, -11.2, -3.500000000000001, -3.3000000000000007, -3.5000000000000004, -12.0, -3.600000000000001, -3.1000000000000005, -3.7000000000000006, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -11.700000000000001, -11.5, -3.500000000000001, -3.1000000000000005, -11.5, -3.5000000000000004, -3.3000000000000007, -3.500000000000001, -3.5, -3.6000000000000005, -3.7000000000000006, -11.1, -3.0000000000000004, -3.500000000000001, -3.600000000000001, -3.4000000000000004, -3.4000000000000004, -3.5000000000000004, -3.500000000000001, -3.6000000000000005, -3.500000000000001, -10.6, -3.1000000000000005, -3.3000000000000003, -10.9, -11.6, -3.3000000000000007, -10.0, -3.5000000000000004, -3.2000000000000006, -3.500000000000001, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.4000000000000004, -12.0, -3.2000000000000006, -3.400000000000001, -3.5000000000000004, -3.400000000000001, -3.400000000000001, -3.500000000000001, -3.500000000000001, -3.400000000000001, -3.2, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.300000000000001, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.5000000000000004, -3.2000000000000006, -12.1, -3.2000000000000006, -3.500000000000001, -3.400000000000001, -3.500000000000001, -3.3000000000000003, -3.400000000000001, -3.2000000000000006, -3.600000000000001, -3.2000000000000006, -3.6000000000000005, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.6000000000000005, -3.3000000000000007, -3.400000000000001, -3.700000000000001, -3.400000000000001, -3.4000000000000012, -3.0000000000000004, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.500000000000001, -3.3000000000000007, -3.3000000000000007, -3.500000000000001, -3.2000000000000006, -3.5000000000000004, -3.400000000000001, -3.5000000000000004, -3.1000000000000005, -3.500000000000001, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -11.5, -3.7000000000000006, -3.3000000000000007, -3.500000000000001, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.500000000000001, -3.400000000000001, -12.0, -3.500000000000001, -3.3000000000000007, -3.500000000000001, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.7000000000000006, -3.800000000000001, -3.3000000000000007, -3.2000000000000006, -11.9, -3.3000000000000003, -3.3000000000000007, -3.500000000000001, -3.400000000000001, -3.5000000000000013, -3.400000000000001, -3.1000000000000005, -3.500000000000001, -3.2, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -3.500000000000001, -3.400000000000001, -3.4000000000000004, -3.500000000000001, -3.500000000000001, -3.500000000000001, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.5000000000000004, -3.0000000000000004, -3.6000000000000005, -3.2000000000000006, -3.500000000000001, -3.500000000000001, -3.5000000000000004, -3.3000000000000003, -3.5000000000000004, -11.7, -3.500000000000001, -3.2000000000000006, -3.400000000000001, -3.7000000000000006, -11.1, -3.400000000000001, -3.500000000000001], "episode_lengths": [20, 21, 21, 21, 17, 21, 5, 21, 21, 4, 21, 21, 8, 9, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 18, 15, 21, 21, 16, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 10, 14, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 11, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.512797572645306, "mean_inference_ms": 17.390001722402197, "mean_action_processing_ms": 0.9175281244301698, "mean_env_wait_ms": 2.150940163663284, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07614279028230113, "StateBufferConnector_ms": 0.009565987610464613, "ViewRequirementAgentConnector_ms": 0.14071170919634438}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.3, "episode_reward_mean": -4.307881773399015, "episode_len_mean": 20.039408866995075, "episodes_this_iter": 203, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-12.3, -3.5000000000000004, -3.2000000000000006, -3.400000000000001, -11.8, -3.500000000000001, -10.4, -3.3000000000000007, -3.3000000000000003, -10.3, -3.2000000000000006, -3.3000000000000007, -10.7, -10.8, -3.600000000000001, -3.4000000000000004, -3.2000000000000006, -11.0, -3.2, -3.3000000000000003, -3.6000000000000005, -3.6000000000000005, -3.6000000000000005, -3.1000000000000005, -11.2, -3.500000000000001, -3.3000000000000007, -3.5000000000000004, -12.0, -3.600000000000001, -3.1000000000000005, -3.7000000000000006, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -11.700000000000001, -11.5, -3.500000000000001, -3.1000000000000005, -11.5, -3.5000000000000004, -3.3000000000000007, -3.500000000000001, -3.5, -3.6000000000000005, -3.7000000000000006, -11.1, -3.0000000000000004, -3.500000000000001, -3.600000000000001, -3.4000000000000004, -3.4000000000000004, -3.5000000000000004, -3.500000000000001, -3.6000000000000005, -3.500000000000001, -10.6, -3.1000000000000005, -3.3000000000000003, -10.9, -11.6, -3.3000000000000007, -10.0, -3.5000000000000004, -3.2000000000000006, -3.500000000000001, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.4000000000000004, -12.0, -3.2000000000000006, -3.400000000000001, -3.5000000000000004, -3.400000000000001, -3.400000000000001, -3.500000000000001, -3.500000000000001, -3.400000000000001, -3.2, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.300000000000001, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.5000000000000004, -3.2000000000000006, -12.1, -3.2000000000000006, -3.500000000000001, -3.400000000000001, -3.500000000000001, -3.3000000000000003, -3.400000000000001, -3.2000000000000006, -3.600000000000001, -3.2000000000000006, -3.6000000000000005, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.6000000000000005, -3.3000000000000007, -3.400000000000001, -3.700000000000001, -3.400000000000001, -3.4000000000000012, -3.0000000000000004, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.500000000000001, -3.3000000000000007, -3.3000000000000007, -3.500000000000001, -3.2000000000000006, -3.5000000000000004, -3.400000000000001, -3.5000000000000004, -3.1000000000000005, -3.500000000000001, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -11.5, -3.7000000000000006, -3.3000000000000007, -3.500000000000001, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.500000000000001, -3.400000000000001, -12.0, -3.500000000000001, -3.3000000000000007, -3.500000000000001, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.7000000000000006, -3.800000000000001, -3.3000000000000007, -3.2000000000000006, -11.9, -3.3000000000000003, -3.3000000000000007, -3.500000000000001, -3.400000000000001, -3.5000000000000013, -3.400000000000001, -3.1000000000000005, -3.500000000000001, -3.2, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -3.500000000000001, -3.400000000000001, -3.4000000000000004, -3.500000000000001, -3.500000000000001, -3.500000000000001, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.5000000000000004, -3.0000000000000004, -3.6000000000000005, -3.2000000000000006, -3.500000000000001, -3.500000000000001, -3.5000000000000004, -3.3000000000000003, -3.5000000000000004, -11.7, -3.500000000000001, -3.2000000000000006, -3.400000000000001, -3.7000000000000006, -11.1, -3.400000000000001, -3.500000000000001], "episode_lengths": [20, 21, 21, 21, 17, 21, 5, 21, 21, 4, 21, 21, 8, 9, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 18, 15, 21, 21, 16, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 10, 14, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 11, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.512797572645306, "mean_inference_ms": 17.390001722402197, "mean_action_processing_ms": 0.9175281244301698, "mean_env_wait_ms": 2.150940163663284, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07614279028230113, "StateBufferConnector_ms": 0.009565987610464613, "ViewRequirementAgentConnector_ms": 0.14071170919634438}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 136000, "timers": {"training_iteration_time_ms": 171022.713, "load_time_ms": 1.117, "load_throughput": 3580514.331, "learn_time_ms": 170064.979, "learn_throughput": 23.52, "synch_weights_time_ms": 190.745}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "done": false, "episodes_total": 7081, "training_iteration": 34, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-06_22-32-44", "timestamp": 1680813164, "time_this_iter_s": 170.95257544517517, "time_total_s": 5817.405658006668, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7effc0948310>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014772e040>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 5817.405658006668, "timesteps_since_restore": 0, "iterations_since_restore": 34, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.424279835390946, "ram_util_percent": 23.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1425765642876267, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.0010000000000000005, "total_loss": 0.3856294640069527, "policy_loss": -0.10271718524977244, "vf_loss": 0.46165228222086224, "vf_explained_var": 0.4859143903178553, "kl": 0.015623588588023658, "entropy": 3.8277205403133103, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 32085.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.5, "episode_reward_mean": -4.297512437810946, "episode_len_mean": 19.592039800995025, "episode_media": {}, "episodes_this_iter": 201, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.2, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -3.600000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -10.8, -3.3000000000000007, -11.5, -3.1000000000000005, -3.7000000000000006, -3.6000000000000005, -3.0000000000000004, -3.5000000000000004, -3.5000000000000004, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.4000000000000004, -3.400000000000001, -3.3000000000000003, -11.1, -3.3000000000000007, -10.4, -3.600000000000001, -3.500000000000001, -3.400000000000001, -3.3000000000000007, -3.2, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.500000000000001, -3.3000000000000007, -3.400000000000001, -3.4000000000000004, -3.400000000000001, -3.4000000000000004, -3.500000000000001, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.700000000000001, -3.3000000000000007, -3.2000000000000006, -3.200000000000001, -3.400000000000001, -3.3000000000000007, -11.1, -3.3000000000000003, -3.5000000000000004, -3.400000000000001, -3.500000000000001, -3.3000000000000007, -3.3000000000000003, -3.500000000000001, -3.400000000000001, -3.4000000000000004, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.5000000000000004, -10.2, -3.2000000000000006, -3.300000000000001, -3.5000000000000004, -3.6, -10.8, -3.4000000000000004, -3.100000000000001, -3.2000000000000006, -3.2000000000000006, -3.5000000000000004, -3.3000000000000007, -3.2000000000000006, -3.700000000000001, -11.5, -3.2000000000000006, -11.8, -3.4000000000000004, -11.5, -3.5000000000000013, -3.5000000000000004, -10.5, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.7000000000000006, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, -3.5000000000000004, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.500000000000001, -3.8000000000000007, -3.3000000000000007, -3.2000000000000006, -10.2, -3.1000000000000005, -3.3000000000000007, -3.5000000000000004, -3.6000000000000005, -3.500000000000001, -3.500000000000001, -3.5000000000000004, -3.2000000000000006, -3.3000000000000007, -10.6, -3.3000000000000007, -3.700000000000001, -3.3000000000000007, -3.400000000000001, -3.5000000000000004, -3.600000000000001, -3.3000000000000007, -10.0, -3.3000000000000003, -10.0, -3.3000000000000003, -3.4000000000000004, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.400000000000001, -3.2000000000000006, -3.200000000000001, -3.1000000000000005, -3.700000000000001, -11.7, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.5000000000000004, -12.5, -3.3000000000000003, -3.500000000000001, -3.2000000000000006, -11.8, -3.2, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.500000000000001, -3.3000000000000003, -3.2000000000000006, -3.600000000000001, -3.4000000000000004, -3.3000000000000007, -3.4000000000000004, -11.600000000000001, -3.3000000000000003, -3.6000000000000005, -10.6, -10.6, -3.400000000000001, -3.0000000000000004, -10.1, -3.500000000000001, -3.3000000000000007, -3.300000000000001, -3.500000000000001, -11.0, -3.3000000000000003, -3.5000000000000004, -3.400000000000001, -3.3000000000000007, -3.5000000000000004, -11.600000000000001, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.2, -3.3000000000000007, -3.6000000000000005, -3.5000000000000004, -3.2000000000000006, -3.4000000000000004, -3.5000000000000004, -3.2000000000000006, -3.2000000000000006, -3.7000000000000006, -3.3000000000000007, -3.3000000000000003, -3.6000000000000005, -3.6000000000000005], "episode_lengths": [12, 21, 21, 21, 21, 21, 21, 21, 9, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 16, 21, 14, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 1, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 20, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 7, 7, 21, 21, 2, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.513822519060318, "mean_inference_ms": 17.37935050439236, "mean_action_processing_ms": 0.9174601280296926, "mean_env_wait_ms": 2.1532774826068106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07288242453959451, "StateBufferConnector_ms": 0.009407214264371503, "ViewRequirementAgentConnector_ms": 0.1335502263918445}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.5, "episode_reward_mean": -4.297512437810946, "episode_len_mean": 19.592039800995025, "episodes_this_iter": 201, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11.2, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -3.600000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -10.8, -3.3000000000000007, -11.5, -3.1000000000000005, -3.7000000000000006, -3.6000000000000005, -3.0000000000000004, -3.5000000000000004, -3.5000000000000004, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.4000000000000004, -3.400000000000001, -3.3000000000000003, -11.1, -3.3000000000000007, -10.4, -3.600000000000001, -3.500000000000001, -3.400000000000001, -3.3000000000000007, -3.2, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.500000000000001, -3.3000000000000007, -3.400000000000001, -3.4000000000000004, -3.400000000000001, -3.4000000000000004, -3.500000000000001, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.700000000000001, -3.3000000000000007, -3.2000000000000006, -3.200000000000001, -3.400000000000001, -3.3000000000000007, -11.1, -3.3000000000000003, -3.5000000000000004, -3.400000000000001, -3.500000000000001, -3.3000000000000007, -3.3000000000000003, -3.500000000000001, -3.400000000000001, -3.4000000000000004, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.5000000000000004, -10.2, -3.2000000000000006, -3.300000000000001, -3.5000000000000004, -3.6, -10.8, -3.4000000000000004, -3.100000000000001, -3.2000000000000006, -3.2000000000000006, -3.5000000000000004, -3.3000000000000007, -3.2000000000000006, -3.700000000000001, -11.5, -3.2000000000000006, -11.8, -3.4000000000000004, -11.5, -3.5000000000000013, -3.5000000000000004, -10.5, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.7000000000000006, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, -3.5000000000000004, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.500000000000001, -3.8000000000000007, -3.3000000000000007, -3.2000000000000006, -10.2, -3.1000000000000005, -3.3000000000000007, -3.5000000000000004, -3.6000000000000005, -3.500000000000001, -3.500000000000001, -3.5000000000000004, -3.2000000000000006, -3.3000000000000007, -10.6, -3.3000000000000007, -3.700000000000001, -3.3000000000000007, -3.400000000000001, -3.5000000000000004, -3.600000000000001, -3.3000000000000007, -10.0, -3.3000000000000003, -10.0, -3.3000000000000003, -3.4000000000000004, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.400000000000001, -3.2000000000000006, -3.200000000000001, -3.1000000000000005, -3.700000000000001, -11.7, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.5000000000000004, -12.5, -3.3000000000000003, -3.500000000000001, -3.2000000000000006, -11.8, -3.2, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.500000000000001, -3.3000000000000003, -3.2000000000000006, -3.600000000000001, -3.4000000000000004, -3.3000000000000007, -3.4000000000000004, -11.600000000000001, -3.3000000000000003, -3.6000000000000005, -10.6, -10.6, -3.400000000000001, -3.0000000000000004, -10.1, -3.500000000000001, -3.3000000000000007, -3.300000000000001, -3.500000000000001, -11.0, -3.3000000000000003, -3.5000000000000004, -3.400000000000001, -3.3000000000000007, -3.5000000000000004, -11.600000000000001, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.2, -3.3000000000000007, -3.6000000000000005, -3.5000000000000004, -3.2000000000000006, -3.4000000000000004, -3.5000000000000004, -3.2000000000000006, -3.2000000000000006, -3.7000000000000006, -3.3000000000000007, -3.3000000000000003, -3.6000000000000005, -3.6000000000000005], "episode_lengths": [12, 21, 21, 21, 21, 21, 21, 21, 9, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 16, 21, 14, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 1, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 20, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 7, 7, 21, 21, 2, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.513822519060318, "mean_inference_ms": 17.37935050439236, "mean_action_processing_ms": 0.9174601280296926, "mean_env_wait_ms": 2.1532774826068106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07288242453959451, "StateBufferConnector_ms": 0.009407214264371503, "ViewRequirementAgentConnector_ms": 0.1335502263918445}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 140000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 140000, "timers": {"training_iteration_time_ms": 171036.558, "load_time_ms": 1.124, "load_throughput": 3558415.203, "learn_time_ms": 170077.27, "learn_throughput": 23.519, "synch_weights_time_ms": 190.904}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "done": false, "episodes_total": 7282, "training_iteration": 35, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-06_22-35-35", "timestamp": 1680813335, "time_this_iter_s": 171.36309385299683, "time_total_s": 5988.768751859665, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01475e2490>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014757d790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 5988.768751859665, "timesteps_since_restore": 0, "iterations_since_restore": 35, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.647736625514403, "ram_util_percent": 23.605349794238684}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1232461330070291, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.0010000000000000005, "total_loss": 0.6761110898708144, "policy_loss": -0.13045125252577247, "vf_loss": 0.7750910531258791, "vf_explained_var": 0.2892730156580607, "kl": 0.018419410772208544, "entropy": 3.818301022693675, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 33015.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.4, "episode_reward_mean": -4.649275362318841, "episode_len_mean": 19.468599033816425, "episode_media": {}, "episodes_this_iter": 207, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3000000000000003, -11.8, -3.6, -3.2000000000000006, -3.3000000000000003, -3.400000000000001, -11.5, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.5000000000000004, -3.1000000000000005, -3.400000000000001, -11.0, -3.400000000000001, -3.0000000000000004, -3.2000000000000006, -3.500000000000001, -3.3000000000000007, -3.400000000000001, -11.9, -3.2, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -11.5, -3.2000000000000006, -3.2000000000000006, -11.2, -3.3000000000000003, -3.1000000000000005, -3.400000000000001, -3.500000000000001, -3.4000000000000004, -3.500000000000001, -3.2000000000000006, -11.8, -3.4000000000000004, -11.9, -3.400000000000001, -3.1000000000000005, -3.4000000000000012, -11.4, -3.1000000000000005, -3.2000000000000006, -10.9, -3.2, -3.6000000000000005, -3.2000000000000006, -3.3000000000000007, -3.500000000000001, -3.4000000000000004, -12.100000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.500000000000001, -3.1000000000000005, -10.9, -10.3, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.2, -3.5000000000000004, -3.2000000000000006, -12.4, -10.6, -10.6, -3.8000000000000007, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.500000000000001, -3.3000000000000007, -3.400000000000001, -3.0000000000000004, -3.6000000000000005, -11.5, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -10.6, -10.6, -3.2000000000000006, -3.2000000000000006, -12.0, -3.3000000000000007, -3.3000000000000003, -3.3000000000000003, -3.0000000000000004, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.4000000000000004, -3.2000000000000006, -10.6, -3.500000000000001, -10.3, -3.500000000000001, -3.2000000000000006, -3.500000000000001, -3.400000000000001, -3.6000000000000005, -10.6, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.100000000000001, -10.6, -10.1, -3.500000000000001, -3.3000000000000007, -10.2, -3.600000000000001, -3.3000000000000007, -10.3, -3.1000000000000005, -3.4000000000000004, -3.500000000000001, -3.1000000000000005, -3.500000000000001, -3.3000000000000003, -3.7000000000000006, -3.3000000000000007, -3.2000000000000006, -3.500000000000001, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.8000000000000007, -3.0000000000000004, -11.2, -3.400000000000001, -3.7000000000000006, -12.1, -10.8, -12.100000000000001, -3.3000000000000003, -3.2, -3.2000000000000006, -3.6000000000000005, -3.500000000000001, -3.3000000000000003, -3.1000000000000005, -3.4000000000000004, -11.8, -3.3000000000000007, -3.1000000000000005, -3.600000000000001, -11.8, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.4000000000000004, -3.400000000000001, -3.1000000000000005, -3.100000000000001, -3.400000000000001, -3.200000000000001, -3.6, -3.1000000000000005, -3.300000000000001, -3.3000000000000007, -3.1000000000000005, -3.600000000000001, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -12.0, -3.200000000000001, -3.3000000000000007, -3.900000000000001, -3.100000000000001, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -11.9, -3.2], "episode_lengths": [21, 18, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 15, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 17, 21, 17, 21, 21, 21, 15, 21, 21, 8, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 4, 21, 21, 21, 21, 21, 21, 21, 19, 6, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 7, 7, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 4, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 2, 21, 21, 3, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 20, 8, 20, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.506323123202337, "mean_inference_ms": 17.384226914342644, "mean_action_processing_ms": 0.9177346361728433, "mean_env_wait_ms": 2.156121102660699, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07536169411479562, "StateBufferConnector_ms": 0.01004663642477874, "ViewRequirementAgentConnector_ms": 0.13826653577279355}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.4, "episode_reward_mean": -4.649275362318841, "episode_len_mean": 19.468599033816425, "episodes_this_iter": 207, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.3000000000000003, -11.8, -3.6, -3.2000000000000006, -3.3000000000000003, -3.400000000000001, -11.5, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.5000000000000004, -3.1000000000000005, -3.400000000000001, -11.0, -3.400000000000001, -3.0000000000000004, -3.2000000000000006, -3.500000000000001, -3.3000000000000007, -3.400000000000001, -11.9, -3.2, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -11.5, -3.2000000000000006, -3.2000000000000006, -11.2, -3.3000000000000003, -3.1000000000000005, -3.400000000000001, -3.500000000000001, -3.4000000000000004, -3.500000000000001, -3.2000000000000006, -11.8, -3.4000000000000004, -11.9, -3.400000000000001, -3.1000000000000005, -3.4000000000000012, -11.4, -3.1000000000000005, -3.2000000000000006, -10.9, -3.2, -3.6000000000000005, -3.2000000000000006, -3.3000000000000007, -3.500000000000001, -3.4000000000000004, -12.100000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.500000000000001, -3.1000000000000005, -10.9, -10.3, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.2, -3.5000000000000004, -3.2000000000000006, -12.4, -10.6, -10.6, -3.8000000000000007, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.500000000000001, -3.3000000000000007, -3.400000000000001, -3.0000000000000004, -3.6000000000000005, -11.5, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -10.6, -10.6, -3.2000000000000006, -3.2000000000000006, -12.0, -3.3000000000000007, -3.3000000000000003, -3.3000000000000003, -3.0000000000000004, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.4000000000000004, -3.2000000000000006, -10.6, -3.500000000000001, -10.3, -3.500000000000001, -3.2000000000000006, -3.500000000000001, -3.400000000000001, -3.6000000000000005, -10.6, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.100000000000001, -10.6, -10.1, -3.500000000000001, -3.3000000000000007, -10.2, -3.600000000000001, -3.3000000000000007, -10.3, -3.1000000000000005, -3.4000000000000004, -3.500000000000001, -3.1000000000000005, -3.500000000000001, -3.3000000000000003, -3.7000000000000006, -3.3000000000000007, -3.2000000000000006, -3.500000000000001, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.8000000000000007, -3.0000000000000004, -11.2, -3.400000000000001, -3.7000000000000006, -12.1, -10.8, -12.100000000000001, -3.3000000000000003, -3.2, -3.2000000000000006, -3.6000000000000005, -3.500000000000001, -3.3000000000000003, -3.1000000000000005, -3.4000000000000004, -11.8, -3.3000000000000007, -3.1000000000000005, -3.600000000000001, -11.8, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.4000000000000004, -3.400000000000001, -3.1000000000000005, -3.100000000000001, -3.400000000000001, -3.200000000000001, -3.6, -3.1000000000000005, -3.300000000000001, -3.3000000000000007, -3.1000000000000005, -3.600000000000001, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -12.0, -3.200000000000001, -3.3000000000000007, -3.900000000000001, -3.100000000000001, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -11.9, -3.2], "episode_lengths": [21, 18, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 15, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 17, 21, 17, 21, 21, 21, 15, 21, 21, 8, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 4, 21, 21, 21, 21, 21, 21, 21, 19, 6, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 7, 7, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 4, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 2, 21, 21, 3, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 20, 8, 20, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.506323123202337, "mean_inference_ms": 17.384226914342644, "mean_action_processing_ms": 0.9177346361728433, "mean_env_wait_ms": 2.156121102660699, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07536169411479562, "StateBufferConnector_ms": 0.01004663642477874, "ViewRequirementAgentConnector_ms": 0.13826653577279355}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 171002.363, "load_time_ms": 1.125, "load_throughput": 3555700.237, "learn_time_ms": 170042.678, "learn_throughput": 23.524, "synch_weights_time_ms": 191.362}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "episodes_total": 7489, "training_iteration": 36, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-06_22-38-26", "timestamp": 1680813506, "time_this_iter_s": 170.53440761566162, "time_total_s": 6159.3031594753265, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476f2eb0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014759c160>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 6159.3031594753265, "timesteps_since_restore": 0, "iterations_since_restore": 36, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.366666666666666, "ram_util_percent": 23.62880658436214}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0853245713217283, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.0010000000000000005, "total_loss": 0.5316398495114759, "policy_loss": -0.035655795033052266, "vf_loss": 0.5533870212112864, "vf_explained_var": 0.5159067058435051, "kl": 0.008140391779917051, "entropy": 3.813928383652882, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 33945.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "sampler_results": {"episode_reward_max": 98.2, "episode_reward_min": -12.1, "episode_reward_mean": -3.7411764705882353, "episode_len_mean": 19.872549019607842, "episode_media": {}, "episodes_this_iter": 204, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.4000000000000004, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.400000000000001, -3.3000000000000007, -3.500000000000001, -10.6, -3.2000000000000006, -3.3000000000000007, -3.500000000000001, -3.3000000000000007, -3.3000000000000007, -11.4, -3.2, -3.3000000000000007, -3.2000000000000006, -3.500000000000001, -3.400000000000001, -3.400000000000001, -3.2, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.6000000000000005, -3.3000000000000003, -3.3000000000000003, -3.4000000000000004, -11.600000000000001, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.500000000000001, -3.6000000000000005, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -11.9, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -10.5, -3.500000000000001, -3.3000000000000003, -3.400000000000001, -3.2000000000000006, -3.4000000000000004, -3.400000000000001, -3.5000000000000004, -3.6000000000000005, -3.2000000000000006, -10.6, -3.3000000000000003, -12.1, -11.0, -3.400000000000001, -3.4000000000000004, -10.6, -3.500000000000001, -3.400000000000001, -11.8, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.500000000000001, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -12.1, -3.5000000000000004, -3.5000000000000004, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.200000000000001, -3.4000000000000004, -3.3000000000000007, -3.200000000000001, -3.600000000000001, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.5000000000000004, -3.3000000000000007, -3.500000000000001, -3.4000000000000004, -10.5, -3.3000000000000007, -3.1000000000000005, -11.9, -3.2000000000000006, -3.4000000000000004, -3.100000000000001, -3.400000000000001, -3.400000000000001, -11.6, -3.1000000000000005, 98.2, -11.1, -10.7, -3.3000000000000007, -3.0000000000000004, -3.3000000000000003, -3.500000000000001, -11.6, -3.100000000000001, -3.2, -3.3000000000000007, -3.5000000000000004, -3.200000000000001, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.500000000000001, -3.4000000000000004, -3.4000000000000004, -11.0, -11.5, -3.2, -3.3000000000000007, -3.5000000000000004, -3.2000000000000006, -3.500000000000001, -3.4000000000000004, -3.3000000000000007, -3.500000000000001, -3.3000000000000007, -3.3000000000000007, -3.300000000000001, -3.4000000000000004, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.500000000000001, -12.0, -3.2000000000000006, -3.2, -3.2, -3.500000000000001, -11.700000000000001, -3.3000000000000007, -3.5000000000000004, -3.2, -3.400000000000001, -3.3000000000000007, -11.1, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.500000000000001, -3.2000000000000006, -3.2, -3.400000000000001, -10.0, -3.500000000000001, -3.7000000000000006, -3.1000000000000005, -3.600000000000001, -10.0, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.5000000000000004, -3.400000000000001, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.300000000000001, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.500000000000001, -3.3000000000000007, -3.1000000000000005, -3.500000000000001, -3.3000000000000003, -3.3000000000000003, -3.3000000000000003, -3.4000000000000004, -3.1000000000000005, -3.0000000000000004], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 18, 11, 21, 21, 7, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 18, 21, 21, 21, 21, 21, 16, 21, 17, 12, 8, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.509614654931259, "mean_inference_ms": 17.397155590685234, "mean_action_processing_ms": 0.9180753709450341, "mean_env_wait_ms": 2.159462462205658, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07408892407136805, "StateBufferConnector_ms": 0.009554157070085114, "ViewRequirementAgentConnector_ms": 0.1386711410447663}}, "episode_reward_max": 98.2, "episode_reward_min": -12.1, "episode_reward_mean": -3.7411764705882353, "episode_len_mean": 19.872549019607842, "episodes_this_iter": 204, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.4000000000000004, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.400000000000001, -3.3000000000000007, -3.500000000000001, -10.6, -3.2000000000000006, -3.3000000000000007, -3.500000000000001, -3.3000000000000007, -3.3000000000000007, -11.4, -3.2, -3.3000000000000007, -3.2000000000000006, -3.500000000000001, -3.400000000000001, -3.400000000000001, -3.2, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.6000000000000005, -3.3000000000000003, -3.3000000000000003, -3.4000000000000004, -11.600000000000001, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.500000000000001, -3.6000000000000005, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -11.9, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -10.5, -3.500000000000001, -3.3000000000000003, -3.400000000000001, -3.2000000000000006, -3.4000000000000004, -3.400000000000001, -3.5000000000000004, -3.6000000000000005, -3.2000000000000006, -10.6, -3.3000000000000003, -12.1, -11.0, -3.400000000000001, -3.4000000000000004, -10.6, -3.500000000000001, -3.400000000000001, -11.8, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.500000000000001, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -12.1, -3.5000000000000004, -3.5000000000000004, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.200000000000001, -3.4000000000000004, -3.3000000000000007, -3.200000000000001, -3.600000000000001, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.5000000000000004, -3.3000000000000007, -3.500000000000001, -3.4000000000000004, -10.5, -3.3000000000000007, -3.1000000000000005, -11.9, -3.2000000000000006, -3.4000000000000004, -3.100000000000001, -3.400000000000001, -3.400000000000001, -11.6, -3.1000000000000005, 98.2, -11.1, -10.7, -3.3000000000000007, -3.0000000000000004, -3.3000000000000003, -3.500000000000001, -11.6, -3.100000000000001, -3.2, -3.3000000000000007, -3.5000000000000004, -3.200000000000001, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.500000000000001, -3.4000000000000004, -3.4000000000000004, -11.0, -11.5, -3.2, -3.3000000000000007, -3.5000000000000004, -3.2000000000000006, -3.500000000000001, -3.4000000000000004, -3.3000000000000007, -3.500000000000001, -3.3000000000000007, -3.3000000000000007, -3.300000000000001, -3.4000000000000004, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.500000000000001, -12.0, -3.2000000000000006, -3.2, -3.2, -3.500000000000001, -11.700000000000001, -3.3000000000000007, -3.5000000000000004, -3.2, -3.400000000000001, -3.3000000000000007, -11.1, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.500000000000001, -3.2000000000000006, -3.2, -3.400000000000001, -10.0, -3.500000000000001, -3.7000000000000006, -3.1000000000000005, -3.600000000000001, -10.0, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.5000000000000004, -3.400000000000001, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.300000000000001, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.500000000000001, -3.3000000000000007, -3.1000000000000005, -3.500000000000001, -3.3000000000000003, -3.3000000000000003, -3.3000000000000003, -3.4000000000000004, -3.1000000000000005, -3.0000000000000004], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 18, 11, 21, 21, 7, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 18, 21, 21, 21, 21, 21, 16, 21, 17, 12, 8, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.509614654931259, "mean_inference_ms": 17.397155590685234, "mean_action_processing_ms": 0.9180753709450341, "mean_env_wait_ms": 2.159462462205658, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07408892407136805, "StateBufferConnector_ms": 0.009554157070085114, "ViewRequirementAgentConnector_ms": 0.1386711410447663}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 148000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 148000, "timers": {"training_iteration_time_ms": 171017.03, "load_time_ms": 1.13, "load_throughput": 3540468.061, "learn_time_ms": 170057.296, "learn_throughput": 23.521, "synch_weights_time_ms": 193.348}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "done": false, "episodes_total": 7693, "training_iteration": 37, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-06_22-41-17", "timestamp": 1680813677, "time_this_iter_s": 170.88883018493652, "time_total_s": 6330.191989660263, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7effc0948c10>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0147716f70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 6330.191989660263, "timesteps_since_restore": 0, "iterations_since_restore": 37, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.4407407407407415, "ram_util_percent": 23.654320987654316}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0700602517172855, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.0010000000000000005, "total_loss": 0.16094846104782434, "policy_loss": -0.024344437264697125, "vf_loss": 0.16864719504780906, "vf_explained_var": 0.7005450146172636, "kl": 0.00974234144399894, "entropy": 3.814570475137362, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 34875.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "sampler_results": {"episode_reward_max": 98.1, "episode_reward_min": -11.6, "episode_reward_mean": -3.292385786802031, "episode_len_mean": 20.16751269035533, "episode_media": {}, "episodes_this_iter": 197, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.7, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.100000000000001, -3.3000000000000007, -3.3000000000000007, -3.500000000000001, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -3.5000000000000004, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.3000000000000003, -3.500000000000001, -3.3000000000000007, -3.2, -3.3000000000000007, -3.400000000000001, -3.4000000000000004, -3.2000000000000006, -3.4000000000000004, -3.500000000000001, -3.400000000000001, -3.500000000000001, -3.3000000000000007, -3.3000000000000003, -3.2, -3.1000000000000005, -3.6000000000000005, -3.2, -3.400000000000001, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.3000000000000003, -3.500000000000001, -3.500000000000001, -3.4000000000000004, -3.500000000000001, -3.6000000000000005, -3.3000000000000007, -3.2000000000000006, -3.2, -3.1000000000000005, -3.1000000000000005, -3.500000000000001, 98.1, -3.600000000000001, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.4000000000000004, -3.5000000000000004, -3.3000000000000007, -3.4000000000000004, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.600000000000001, -3.2, -3.400000000000001, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.4000000000000004, -3.0000000000000004, -3.2000000000000006, -11.3, -3.5000000000000004, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -10.3, -3.3000000000000007, -3.600000000000001, -3.2000000000000006, -3.4000000000000004, -3.3000000000000003, -3.3000000000000007, -3.3000000000000007, -3.5000000000000004, -3.3000000000000003, -3.3000000000000003, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.5000000000000004, -3.5000000000000004, -3.3000000000000007, -3.3000000000000007, -3.300000000000001, -3.3000000000000007, -3.200000000000001, -3.400000000000001, -3.4000000000000004, -3.1000000000000005, -3.200000000000001, -10.8, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -10.7, -10.0, -3.300000000000001, -11.2, -3.5000000000000004, -10.8, -10.5, -3.3000000000000007, -3.400000000000001, -3.700000000000001, -3.4000000000000004, -3.500000000000001, -3.2, -3.2000000000000006, -11.6, -3.3000000000000007, -10.8, -3.3000000000000003, -3.2, -3.4000000000000004, -3.2, -3.400000000000001, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -3.700000000000001, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.300000000000001, -3.600000000000001, -3.4000000000000004, -3.400000000000001, -3.3000000000000007, -3.6000000000000005, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.500000000000001, -3.3000000000000007, -3.400000000000001, -11.2, -3.1000000000000005, -3.2, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.400000000000001, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.4000000000000012, -3.2, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -3.500000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2, -3.2000000000000006, -3.2000000000000006, -3.100000000000001, -3.4000000000000012, -3.1000000000000005, -3.3000000000000007, -3.6000000000000005, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -10.7, -3.3000000000000007, -3.2, -3.2000000000000006, -3.3000000000000007, -3.400000000000001], "episode_lengths": [8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 8, 1, 21, 13, 21, 8, 5, 21, 21, 21, 21, 21, 21, 21, 17, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.503187251156046, "mean_inference_ms": 17.39536504631551, "mean_action_processing_ms": 0.9183816188985616, "mean_env_wait_ms": 2.1619267425102504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07629624478102941, "StateBufferConnector_ms": 0.009414024159387888, "ViewRequirementAgentConnector_ms": 0.13822432096839557}}, "episode_reward_max": 98.1, "episode_reward_min": -11.6, "episode_reward_mean": -3.292385786802031, "episode_len_mean": 20.16751269035533, "episodes_this_iter": 197, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10.7, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.100000000000001, -3.3000000000000007, -3.3000000000000007, -3.500000000000001, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -3.5000000000000004, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.3000000000000003, -3.500000000000001, -3.3000000000000007, -3.2, -3.3000000000000007, -3.400000000000001, -3.4000000000000004, -3.2000000000000006, -3.4000000000000004, -3.500000000000001, -3.400000000000001, -3.500000000000001, -3.3000000000000007, -3.3000000000000003, -3.2, -3.1000000000000005, -3.6000000000000005, -3.2, -3.400000000000001, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.3000000000000003, -3.500000000000001, -3.500000000000001, -3.4000000000000004, -3.500000000000001, -3.6000000000000005, -3.3000000000000007, -3.2000000000000006, -3.2, -3.1000000000000005, -3.1000000000000005, -3.500000000000001, 98.1, -3.600000000000001, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.4000000000000004, -3.5000000000000004, -3.3000000000000007, -3.4000000000000004, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.600000000000001, -3.2, -3.400000000000001, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.4000000000000004, -3.0000000000000004, -3.2000000000000006, -11.3, -3.5000000000000004, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -10.3, -3.3000000000000007, -3.600000000000001, -3.2000000000000006, -3.4000000000000004, -3.3000000000000003, -3.3000000000000007, -3.3000000000000007, -3.5000000000000004, -3.3000000000000003, -3.3000000000000003, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.5000000000000004, -3.5000000000000004, -3.3000000000000007, -3.3000000000000007, -3.300000000000001, -3.3000000000000007, -3.200000000000001, -3.400000000000001, -3.4000000000000004, -3.1000000000000005, -3.200000000000001, -10.8, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -10.7, -10.0, -3.300000000000001, -11.2, -3.5000000000000004, -10.8, -10.5, -3.3000000000000007, -3.400000000000001, -3.700000000000001, -3.4000000000000004, -3.500000000000001, -3.2, -3.2000000000000006, -11.6, -3.3000000000000007, -10.8, -3.3000000000000003, -3.2, -3.4000000000000004, -3.2, -3.400000000000001, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -3.700000000000001, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.300000000000001, -3.600000000000001, -3.4000000000000004, -3.400000000000001, -3.3000000000000007, -3.6000000000000005, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.500000000000001, -3.3000000000000007, -3.400000000000001, -11.2, -3.1000000000000005, -3.2, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.400000000000001, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.4000000000000012, -3.2, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -3.500000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2, -3.2000000000000006, -3.2000000000000006, -3.100000000000001, -3.4000000000000012, -3.1000000000000005, -3.3000000000000007, -3.6000000000000005, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -10.7, -3.3000000000000007, -3.2, -3.2000000000000006, -3.3000000000000007, -3.400000000000001], "episode_lengths": [8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 8, 1, 21, 13, 21, 8, 5, 21, 21, 21, 21, 21, 21, 21, 17, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.503187251156046, "mean_inference_ms": 17.39536504631551, "mean_action_processing_ms": 0.9183816188985616, "mean_env_wait_ms": 2.1619267425102504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07629624478102941, "StateBufferConnector_ms": 0.009414024159387888, "ViewRequirementAgentConnector_ms": 0.13822432096839557}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 152000, "timers": {"training_iteration_time_ms": 170920.746, "load_time_ms": 1.12, "load_throughput": 3571900.362, "learn_time_ms": 169961.723, "learn_throughput": 23.535, "synch_weights_time_ms": 194.996}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "done": false, "episodes_total": 7890, "training_iteration": 38, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-06_22-44-07", "timestamp": 1680813847, "time_this_iter_s": 170.6564016342163, "time_total_s": 6500.848391294479, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0147740d30>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0147540310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 6500.848391294479, "timesteps_since_restore": 0, "iterations_since_restore": 38, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.3590909090909085, "ram_util_percent": 23.68347107438016}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1259136064398674, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.0010000000000000005, "total_loss": 0.8416801282109553, "policy_loss": -0.04567471864997529, "vf_loss": 0.8703697725259248, "vf_explained_var": 0.23044435356252937, "kl": 0.009940969029388902, "entropy": 3.8161853426246233, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 35805.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "sampler_results": {"episode_reward_max": 99.4, "episode_reward_min": -12.200000000000001, "episode_reward_mean": -3.850239234449761, "episode_len_mean": 19.13397129186603, "episode_media": {}, "episodes_this_iter": 209, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3000000000000003, -3.500000000000001, -10.8, -3.4000000000000004, -3.400000000000001, -3.5000000000000004, -3.2000000000000006, -11.2, -3.0000000000000004, -12.100000000000001, -3.2000000000000006, -3.500000000000001, -3.0000000000000004, -11.3, -3.400000000000001, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.5000000000000004, -3.3000000000000007, -3.400000000000001, -12.100000000000001, -11.4, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -3.400000000000001, -3.7000000000000006, -10.5, -3.400000000000001, -3.400000000000001, -11.4, -3.100000000000001, -3.3000000000000003, -11.8, -3.2000000000000006, -10.8, -3.4000000000000004, -3.2000000000000006, -3.3000000000000003, -3.200000000000001, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.200000000000001, -12.100000000000001, -3.4000000000000012, -3.6000000000000005, -3.400000000000001, -3.5000000000000004, -3.4000000000000004, -3.2, -3.6000000000000005, -3.6000000000000005, -11.700000000000001, -3.400000000000001, -11.5, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.500000000000001, -3.2000000000000006, -3.500000000000001, -3.400000000000001, -3.500000000000001, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.500000000000001, -11.700000000000001, -11.7, -10.3, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -11.8, -3.400000000000001, -3.2, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.5000000000000004, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.4000000000000012, -3.3000000000000007, -3.2000000000000006, -11.6, -3.2, -3.0000000000000004, -11.6, -3.400000000000001, -10.7, -10.0, -10.0, -3.400000000000001, -3.3000000000000003, -3.2000000000000006, -3.0000000000000004, -3.200000000000001, -3.4000000000000004, -3.6, -3.3000000000000007, -3.1000000000000005, 98.8, 99.4, -3.3000000000000007, -3.5000000000000004, -10.1, -3.400000000000001, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -3.200000000000001, -3.8000000000000007, -10.3, -3.1000000000000005, -3.5000000000000004, -3.3000000000000007, -3.2000000000000006, -10.0, -3.100000000000001, -3.3000000000000007, -3.4000000000000012, -3.5000000000000004, -3.200000000000001, -3.1000000000000005, -3.600000000000001, -3.3000000000000007, -3.0000000000000004, -3.400000000000001, -10.7, -12.200000000000001, -3.3000000000000003, -3.3000000000000007, -11.4, -3.3000000000000007, -12.100000000000001, -10.5, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -10.6, -11.7, -3.300000000000001, -3.3000000000000003, -3.5000000000000004, -11.5, -3.400000000000001, -3.600000000000001, -3.3000000000000003, -3.4000000000000004, -11.1, -3.3000000000000003, -11.1, -3.4000000000000004, -3.2000000000000006, -3.6000000000000005, -12.0, -3.400000000000001, -11.9, -3.500000000000001, -3.5000000000000004, -3.3000000000000003, -3.800000000000001, -3.4000000000000004, -3.5000000000000004, -3.3000000000000003, -3.3000000000000007, -11.9, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.7000000000000006, -3.1000000000000005, -3.4000000000000004, -11.1, -3.200000000000001, -3.6000000000000005, -3.4000000000000004, -3.3000000000000007, -3.600000000000001, -3.5000000000000004, -3.2000000000000006, -3.5000000000000004, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -10.0], "episode_lengths": [21, 21, 8, 21, 21, 21, 21, 10, 21, 18, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 15, 21, 21, 21, 21, 21, 5, 21, 21, 14, 21, 21, 17, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 16, 4, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 15, 21, 8, 1, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 7, 21, 21, 2, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 20, 21, 21, 13, 21, 19, 6, 21, 21, 21, 7, 17, 21, 21, 21, 15, 21, 21, 21, 21, 11, 21, 11, 21, 21, 21, 19, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.50421662741914, "mean_inference_ms": 17.39138121632058, "mean_action_processing_ms": 0.9185921316273808, "mean_env_wait_ms": 2.1642583241021094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0774652763987272, "StateBufferConnector_ms": 0.010132903687691574, "ViewRequirementAgentConnector_ms": 0.14289817171233693}}, "episode_reward_max": 99.4, "episode_reward_min": -12.200000000000001, "episode_reward_mean": -3.850239234449761, "episode_len_mean": 19.13397129186603, "episodes_this_iter": 209, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.3000000000000003, -3.500000000000001, -10.8, -3.4000000000000004, -3.400000000000001, -3.5000000000000004, -3.2000000000000006, -11.2, -3.0000000000000004, -12.100000000000001, -3.2000000000000006, -3.500000000000001, -3.0000000000000004, -11.3, -3.400000000000001, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.5000000000000004, -3.3000000000000007, -3.400000000000001, -12.100000000000001, -11.4, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -3.400000000000001, -3.7000000000000006, -10.5, -3.400000000000001, -3.400000000000001, -11.4, -3.100000000000001, -3.3000000000000003, -11.8, -3.2000000000000006, -10.8, -3.4000000000000004, -3.2000000000000006, -3.3000000000000003, -3.200000000000001, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.200000000000001, -12.100000000000001, -3.4000000000000012, -3.6000000000000005, -3.400000000000001, -3.5000000000000004, -3.4000000000000004, -3.2, -3.6000000000000005, -3.6000000000000005, -11.700000000000001, -3.400000000000001, -11.5, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.500000000000001, -3.2000000000000006, -3.500000000000001, -3.400000000000001, -3.500000000000001, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.500000000000001, -11.700000000000001, -11.7, -10.3, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -11.8, -3.400000000000001, -3.2, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.5000000000000004, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.4000000000000012, -3.3000000000000007, -3.2000000000000006, -11.6, -3.2, -3.0000000000000004, -11.6, -3.400000000000001, -10.7, -10.0, -10.0, -3.400000000000001, -3.3000000000000003, -3.2000000000000006, -3.0000000000000004, -3.200000000000001, -3.4000000000000004, -3.6, -3.3000000000000007, -3.1000000000000005, 98.8, 99.4, -3.3000000000000007, -3.5000000000000004, -10.1, -3.400000000000001, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -3.200000000000001, -3.8000000000000007, -10.3, -3.1000000000000005, -3.5000000000000004, -3.3000000000000007, -3.2000000000000006, -10.0, -3.100000000000001, -3.3000000000000007, -3.4000000000000012, -3.5000000000000004, -3.200000000000001, -3.1000000000000005, -3.600000000000001, -3.3000000000000007, -3.0000000000000004, -3.400000000000001, -10.7, -12.200000000000001, -3.3000000000000003, -3.3000000000000007, -11.4, -3.3000000000000007, -12.100000000000001, -10.5, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -10.6, -11.7, -3.300000000000001, -3.3000000000000003, -3.5000000000000004, -11.5, -3.400000000000001, -3.600000000000001, -3.3000000000000003, -3.4000000000000004, -11.1, -3.3000000000000003, -11.1, -3.4000000000000004, -3.2000000000000006, -3.6000000000000005, -12.0, -3.400000000000001, -11.9, -3.500000000000001, -3.5000000000000004, -3.3000000000000003, -3.800000000000001, -3.4000000000000004, -3.5000000000000004, -3.3000000000000003, -3.3000000000000007, -11.9, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.7000000000000006, -3.1000000000000005, -3.4000000000000004, -11.1, -3.200000000000001, -3.6000000000000005, -3.4000000000000004, -3.3000000000000007, -3.600000000000001, -3.5000000000000004, -3.2000000000000006, -3.5000000000000004, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -10.0], "episode_lengths": [21, 21, 8, 21, 21, 21, 21, 10, 21, 18, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 15, 21, 21, 21, 21, 21, 5, 21, 21, 14, 21, 21, 17, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 16, 4, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 15, 21, 8, 1, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 7, 21, 21, 2, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 20, 21, 21, 13, 21, 19, 6, 21, 21, 21, 7, 17, 21, 21, 21, 15, 21, 21, 21, 21, 11, 21, 11, 21, 21, 21, 19, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.50421662741914, "mean_inference_ms": 17.39138121632058, "mean_action_processing_ms": 0.9185921316273808, "mean_env_wait_ms": 2.1642583241021094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0774652763987272, "StateBufferConnector_ms": 0.010132903687691574, "ViewRequirementAgentConnector_ms": 0.14289817171233693}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 156000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 170934.93, "load_time_ms": 1.115, "load_throughput": 3586867.918, "learn_time_ms": 169976.97, "learn_throughput": 23.533, "synch_weights_time_ms": 194.314}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "episodes_total": 8099, "training_iteration": 39, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-06_22-46-59", "timestamp": 1680814019, "time_this_iter_s": 171.26827454566956, "time_total_s": 6672.116665840149, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0147569e80>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01477160d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 6672.116665840149, "timesteps_since_restore": 0, "iterations_since_restore": 39, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.56639344262295, "ram_util_percent": 23.671311475409833}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3696094258017437, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.0010000000000000005, "total_loss": 0.3615495562283022, "policy_loss": -0.03410743184547911, "vf_loss": 0.3779359020332816, "vf_explained_var": 0.5391415779949517, "kl": 0.010371737602440345, "entropy": 3.82401119073232, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 36735.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "sampler_results": {"episode_reward_max": 99.2, "episode_reward_min": -12.2, "episode_reward_mean": -1.8470297029702978, "episode_len_mean": 20.173267326732674, "episode_media": {}, "episodes_this_iter": 202, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3000000000000007, -3.3000000000000007, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -10.8, -3.400000000000001, -3.2000000000000006, -10.5, -3.5000000000000004, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.4000000000000004, -3.400000000000001, -3.3000000000000003, -3.0000000000000004, -3.3000000000000007, -3.3000000000000007, -3.3000000000000003, -3.5000000000000004, -3.2000000000000006, -3.5000000000000004, -3.1000000000000005, -3.400000000000001, -3.500000000000001, -3.2000000000000006, -11.9, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.600000000000001, -3.4000000000000004, -10.6, -3.400000000000001, -11.5, -3.6000000000000005, -3.500000000000001, -3.3000000000000007, -3.700000000000001, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.600000000000001, -3.4000000000000012, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.3000000000000003, -3.3000000000000007, -3.3000000000000007, -3.500000000000001, -3.2000000000000006, -3.400000000000001, -11.5, -3.4000000000000012, -3.5000000000000004, -3.500000000000001, -11.9, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, 98.9, -3.400000000000001, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.400000000000001, -3.2, -3.400000000000001, -3.1000000000000005, -12.2, -3.500000000000001, -3.3000000000000007, -3.6000000000000005, -3.3000000000000007, -3.500000000000001, 98.8, -3.400000000000001, -3.2, -10.5, -3.2, -3.3000000000000007, -3.400000000000001, -3.3000000000000003, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -11.1, -3.5000000000000004, -3.3000000000000007, -3.600000000000001, -3.600000000000001, 98.4, -3.3000000000000007, -3.4000000000000004, -3.400000000000001, -3.400000000000001, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -10.1, -3.200000000000001, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.500000000000001, -11.8, -3.500000000000001, -3.300000000000001, -3.5000000000000004, -3.3000000000000007, -3.5000000000000004, -10.5, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.200000000000001, -3.4000000000000004, -3.400000000000001, -3.4000000000000004, -3.300000000000001, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.5000000000000004, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -3.300000000000001, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.4000000000000004, -3.6000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.1000000000000005, -3.3000000000000003, -3.4000000000000004, -3.2000000000000006, -3.500000000000001, -3.2, -3.400000000000001, -3.4000000000000004, -3.5000000000000004, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.3000000000000007, -3.7, -3.2000000000000006, -11.7, 99.2, -3.6000000000000005, -3.500000000000001, -3.3000000000000007, -3.2000000000000006, -3.600000000000001, -3.2000000000000006], "episode_lengths": [21, 21, 21, 21, 21, 21, 8, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 17, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 12, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 8, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.511272268438749, "mean_inference_ms": 17.42956949131145, "mean_action_processing_ms": 0.9188471473360668, "mean_env_wait_ms": 2.1671149638174754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06958588515177812, "StateBufferConnector_ms": 0.009470764953311128, "ViewRequirementAgentConnector_ms": 0.12926559637088586}}, "episode_reward_max": 99.2, "episode_reward_min": -12.2, "episode_reward_mean": -1.8470297029702978, "episode_len_mean": 20.173267326732674, "episodes_this_iter": 202, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.3000000000000007, -3.3000000000000007, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -10.8, -3.400000000000001, -3.2000000000000006, -10.5, -3.5000000000000004, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.4000000000000004, -3.400000000000001, -3.3000000000000003, -3.0000000000000004, -3.3000000000000007, -3.3000000000000007, -3.3000000000000003, -3.5000000000000004, -3.2000000000000006, -3.5000000000000004, -3.1000000000000005, -3.400000000000001, -3.500000000000001, -3.2000000000000006, -11.9, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.600000000000001, -3.4000000000000004, -10.6, -3.400000000000001, -11.5, -3.6000000000000005, -3.500000000000001, -3.3000000000000007, -3.700000000000001, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.600000000000001, -3.4000000000000012, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.3000000000000003, -3.3000000000000007, -3.3000000000000007, -3.500000000000001, -3.2000000000000006, -3.400000000000001, -11.5, -3.4000000000000012, -3.5000000000000004, -3.500000000000001, -11.9, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, 98.9, -3.400000000000001, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.400000000000001, -3.2, -3.400000000000001, -3.1000000000000005, -12.2, -3.500000000000001, -3.3000000000000007, -3.6000000000000005, -3.3000000000000007, -3.500000000000001, 98.8, -3.400000000000001, -3.2, -10.5, -3.2, -3.3000000000000007, -3.400000000000001, -3.3000000000000003, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -11.1, -3.5000000000000004, -3.3000000000000007, -3.600000000000001, -3.600000000000001, 98.4, -3.3000000000000007, -3.4000000000000004, -3.400000000000001, -3.400000000000001, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -10.1, -3.200000000000001, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.500000000000001, -11.8, -3.500000000000001, -3.300000000000001, -3.5000000000000004, -3.3000000000000007, -3.5000000000000004, -10.5, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.200000000000001, -3.4000000000000004, -3.400000000000001, -3.4000000000000004, -3.300000000000001, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.5000000000000004, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -3.300000000000001, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.4000000000000004, -3.6000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.1000000000000005, -3.3000000000000003, -3.4000000000000004, -3.2000000000000006, -3.500000000000001, -3.2, -3.400000000000001, -3.4000000000000004, -3.5000000000000004, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.3000000000000007, -3.7, -3.2000000000000006, -11.7, 99.2, -3.6000000000000005, -3.500000000000001, -3.3000000000000007, -3.2000000000000006, -3.600000000000001, -3.2000000000000006], "episode_lengths": [21, 21, 21, 21, 21, 21, 8, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 17, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 12, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 8, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.511272268438749, "mean_inference_ms": 17.42956949131145, "mean_action_processing_ms": 0.9188471473360668, "mean_env_wait_ms": 2.1671149638174754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06958588515177812, "StateBufferConnector_ms": 0.009470764953311128, "ViewRequirementAgentConnector_ms": 0.12926559637088586}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 170950.567, "load_time_ms": 1.127, "load_throughput": 3549306.311, "learn_time_ms": 169988.222, "learn_throughput": 23.531, "synch_weights_time_ms": 194.152}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "episodes_total": 8301, "training_iteration": 40, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-06_22-49-50", "timestamp": 1680814190, "time_this_iter_s": 170.9992654323578, "time_total_s": 6843.115931272507, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01475a5370>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014759c430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 6843.115931272507, "timesteps_since_restore": 0, "iterations_since_restore": 40, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.354732510288067, "ram_util_percent": 23.662962962962958}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1070258973907399, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.0010000000000000005, "total_loss": 0.564376497019573, "policy_loss": -0.03644592834108319, "vf_loss": 0.5847924113173478, "vf_explained_var": 0.4650901282987287, "kl": 0.00938199377856255, "entropy": 3.8293557866927115, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 37665.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "sampler_results": {"episode_reward_max": 98.3, "episode_reward_min": -12.5, "episode_reward_mean": -3.9641860465116285, "episode_len_mean": 19.488372093023255, "episode_media": {}, "episodes_this_iter": 215, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.3, -3.2000000000000006, -3.3000000000000007, -10.8, -3.400000000000001, -3.5000000000000004, -10.1, -3.2000000000000006, -3.7000000000000015, -3.3000000000000003, -3.3000000000000007, -3.200000000000001, -3.1000000000000005, -3.5, -3.600000000000001, -3.8000000000000007, -3.400000000000001, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.5000000000000004, -3.3000000000000007, -3.3000000000000007, -11.9, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.4000000000000004, -3.600000000000001, -3.400000000000001, -3.500000000000001, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -10.8, -3.4000000000000004, -3.3000000000000007, -11.0, -3.500000000000001, -3.400000000000001, -3.3000000000000007, -10.9, -3.0000000000000004, -3.500000000000001, -3.3000000000000003, -3.4000000000000004, -10.9, -3.3000000000000007, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.3000000000000003, -3.0000000000000004, -3.3000000000000007, -11.2, -3.400000000000001, -3.2, -3.1000000000000005, -3.600000000000001, -3.1000000000000005, -3.4000000000000012, -3.3000000000000007, -3.2000000000000006, -3.2, -3.200000000000001, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -10.4, -3.300000000000001, -11.8, -10.8, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -10.3, -3.6000000000000005, -3.2, -3.3000000000000007, -3.500000000000001, -10.7, -3.3000000000000007, 98.3, -3.400000000000001, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -11.8, -3.700000000000001, -12.5, -3.2, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.400000000000001, -3.3000000000000007, -3.300000000000001, -10.5, -3.1000000000000005, -3.0000000000000004, -3.500000000000001, -3.400000000000001, -3.5000000000000004, -3.3000000000000003, -3.5, -3.3000000000000007, -3.200000000000001, -3.500000000000001, -3.3000000000000007, -3.3000000000000007, -3.4000000000000004, -3.3000000000000007, -3.600000000000001, -3.400000000000001, -3.3000000000000007, -10.5, -3.1000000000000005, -11.8, -10.0, -3.3000000000000003, -10.2, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.6000000000000005, -3.2000000000000006, -3.400000000000001, -3.4000000000000004, -3.700000000000001, -10.6, -3.1000000000000005, -3.3000000000000007, -3.5000000000000004, -10.9, -3.100000000000001, -3.3000000000000007, -3.4000000000000004, -3.1000000000000005, -3.3000000000000003, -3.400000000000001, -12.0, -3.3000000000000007, -11.6, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.500000000000001, -12.3, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.500000000000001, -3.1000000000000005, -3.3000000000000007, -3.2, -3.200000000000001, -12.0, -3.2, -3.2000000000000006, -3.2000000000000006, -3.6000000000000005, -3.1000000000000005, -3.300000000000001, -3.400000000000001, -3.5000000000000004, -12.100000000000001, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -11.9, -10.5, -3.500000000000001, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.500000000000001, -3.2000000000000006, -3.2, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -3.3000000000000003, -3.5000000000000004, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -10.5, -3.4000000000000004, -3.500000000000001, -3.300000000000001, -3.2000000000000006, -3.3000000000000007, -3.600000000000001, -3.2000000000000006], "episode_lengths": [4, 21, 21, 9, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 11, 21, 21, 21, 9, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 17, 9, 21, 21, 21, 4, 21, 21, 21, 21, 8, 21, 17, 21, 21, 21, 21, 18, 21, 20, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 18, 1, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 18, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 18, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.51632564955182, "mean_inference_ms": 17.420458027118638, "mean_action_processing_ms": 0.9176547022894807, "mean_env_wait_ms": 2.165900245724638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07278885952261992, "StateBufferConnector_ms": 0.009789134180823039, "ViewRequirementAgentConnector_ms": 0.13279815052830896}}, "episode_reward_max": 98.3, "episode_reward_min": -12.5, "episode_reward_mean": -3.9641860465116285, "episode_len_mean": 19.488372093023255, "episodes_this_iter": 215, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10.3, -3.2000000000000006, -3.3000000000000007, -10.8, -3.400000000000001, -3.5000000000000004, -10.1, -3.2000000000000006, -3.7000000000000015, -3.3000000000000003, -3.3000000000000007, -3.200000000000001, -3.1000000000000005, -3.5, -3.600000000000001, -3.8000000000000007, -3.400000000000001, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.5000000000000004, -3.3000000000000007, -3.3000000000000007, -11.9, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.4000000000000004, -3.600000000000001, -3.400000000000001, -3.500000000000001, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -10.8, -3.4000000000000004, -3.3000000000000007, -11.0, -3.500000000000001, -3.400000000000001, -3.3000000000000007, -10.9, -3.0000000000000004, -3.500000000000001, -3.3000000000000003, -3.4000000000000004, -10.9, -3.3000000000000007, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.3000000000000003, -3.0000000000000004, -3.3000000000000007, -11.2, -3.400000000000001, -3.2, -3.1000000000000005, -3.600000000000001, -3.1000000000000005, -3.4000000000000012, -3.3000000000000007, -3.2000000000000006, -3.2, -3.200000000000001, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -10.4, -3.300000000000001, -11.8, -10.8, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -10.3, -3.6000000000000005, -3.2, -3.3000000000000007, -3.500000000000001, -10.7, -3.3000000000000007, 98.3, -3.400000000000001, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -11.8, -3.700000000000001, -12.5, -3.2, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.400000000000001, -3.3000000000000007, -3.300000000000001, -10.5, -3.1000000000000005, -3.0000000000000004, -3.500000000000001, -3.400000000000001, -3.5000000000000004, -3.3000000000000003, -3.5, -3.3000000000000007, -3.200000000000001, -3.500000000000001, -3.3000000000000007, -3.3000000000000007, -3.4000000000000004, -3.3000000000000007, -3.600000000000001, -3.400000000000001, -3.3000000000000007, -10.5, -3.1000000000000005, -11.8, -10.0, -3.3000000000000003, -10.2, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.6000000000000005, -3.2000000000000006, -3.400000000000001, -3.4000000000000004, -3.700000000000001, -10.6, -3.1000000000000005, -3.3000000000000007, -3.5000000000000004, -10.9, -3.100000000000001, -3.3000000000000007, -3.4000000000000004, -3.1000000000000005, -3.3000000000000003, -3.400000000000001, -12.0, -3.3000000000000007, -11.6, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.500000000000001, -12.3, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.500000000000001, -3.1000000000000005, -3.3000000000000007, -3.2, -3.200000000000001, -12.0, -3.2, -3.2000000000000006, -3.2000000000000006, -3.6000000000000005, -3.1000000000000005, -3.300000000000001, -3.400000000000001, -3.5000000000000004, -12.100000000000001, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -11.9, -10.5, -3.500000000000001, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.500000000000001, -3.2000000000000006, -3.2, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -3.3000000000000003, -3.5000000000000004, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -10.5, -3.4000000000000004, -3.500000000000001, -3.300000000000001, -3.2000000000000006, -3.3000000000000007, -3.600000000000001, -3.2000000000000006], "episode_lengths": [4, 21, 21, 9, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 11, 21, 21, 21, 9, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 17, 9, 21, 21, 21, 4, 21, 21, 21, 21, 8, 21, 17, 21, 21, 21, 21, 18, 21, 20, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 18, 1, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 18, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 18, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.51632564955182, "mean_inference_ms": 17.420458027118638, "mean_action_processing_ms": 0.9176547022894807, "mean_env_wait_ms": 2.165900245724638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07278885952261992, "StateBufferConnector_ms": 0.009789134180823039, "ViewRequirementAgentConnector_ms": 0.13279815052830896}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 164000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 164000, "timers": {"training_iteration_time_ms": 170955.533, "load_time_ms": 1.127, "load_throughput": 3548030.284, "learn_time_ms": 169987.577, "learn_throughput": 23.531, "synch_weights_time_ms": 195.939}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "done": false, "episodes_total": 8516, "training_iteration": 41, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-06_22-52-40", "timestamp": 1680814360, "time_this_iter_s": 170.6724076271057, "time_total_s": 7013.788338899612, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01477a3910>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014754dee0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 7013.788338899612, "timesteps_since_restore": 0, "iterations_since_restore": 41, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.395867768595041, "ram_util_percent": 23.676859504132228}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1840065234611112, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.0010000000000000005, "total_loss": 0.46175950684394407, "policy_loss": -0.03266204845351768, "vf_loss": 0.47705181437214056, "vf_explained_var": 0.49172107346596255, "kl": 0.010166107085520923, "entropy": 3.827391068909758, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 38595.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "sampler_results": {"episode_reward_max": 98.8, "episode_reward_min": -12.0, "episode_reward_mean": -3.235204081632653, "episode_len_mean": 19.632653061224488, "episode_media": {}, "episodes_this_iter": 196, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3000000000000007, -3.400000000000001, -3.4000000000000004, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.3000000000000003, -10.2, -3.3000000000000007, -3.3000000000000007, -3.3000000000000003, -12.0, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.5000000000000004, -3.400000000000001, -3.4000000000000004, -3.400000000000001, -3.4000000000000012, -3.600000000000001, -3.1000000000000005, -11.6, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.5000000000000004, -3.1000000000000005, -3.2, -10.4, -3.3000000000000007, -3.600000000000001, -3.3000000000000003, -3.400000000000001, -3.1000000000000005, -10.7, -3.3000000000000007, -3.0000000000000004, -3.300000000000001, -3.2000000000000006, -3.300000000000001, -3.2000000000000006, -3.2, -3.1000000000000005, -11.7, -3.500000000000001, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.5000000000000004, -10.7, -10.5, -3.3000000000000007, -11.3, -3.600000000000001, -3.3000000000000007, -11.2, -3.4000000000000004, -3.5000000000000004, -3.400000000000001, -3.500000000000001, 98.8, -3.400000000000001, -3.6000000000000005, -3.1000000000000005, -3.2, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.400000000000001, -3.500000000000001, -3.7000000000000006, -11.8, -3.5000000000000004, -3.4000000000000012, -11.2, -3.400000000000001, -3.2000000000000006, -3.600000000000001, -10.7, -3.7000000000000006, -3.4000000000000004, 98.5, -3.5000000000000004, -3.2, -3.500000000000001, -3.4000000000000004, -3.4000000000000004, -11.5, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -10.6, -11.5, -3.500000000000001, -10.0, -3.6000000000000005, -3.2000000000000006, -11.8, -3.600000000000001, -11.2, -3.0000000000000004, -10.6, -3.5000000000000013, -11.0, -3.7000000000000006, -3.600000000000001, -3.2000000000000006, -3.2000000000000006, -3.500000000000001, -3.2000000000000006, -3.600000000000001, -3.2000000000000006, -10.9, -3.3000000000000007, -3.3000000000000003, -3.200000000000001, -3.2000000000000006, -3.6000000000000005, -3.2000000000000006, -3.5000000000000013, -3.1000000000000005, -3.2000000000000006, -3.100000000000001, -3.4000000000000004, -3.3000000000000007, -3.0000000000000004, -3.600000000000001, -3.400000000000001, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.300000000000001, -3.400000000000001, -3.400000000000001, -3.5000000000000004, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, -3.300000000000001, -3.6000000000000005, -3.400000000000001, -3.400000000000001, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.2, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.400000000000001, -3.400000000000001, -3.6000000000000005, -3.5000000000000004, -3.3000000000000007, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -3.500000000000001, -3.2000000000000006, -11.700000000000001, -3.5000000000000004, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.500000000000001, -3.3000000000000007, -3.200000000000001, -3.3000000000000007, -3.5000000000000004, -3.3000000000000003, -3.2, -10.0, -3.6000000000000005], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 7, 6, 21, 12, 21, 21, 13, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 11, 21, 21, 21, 8, 21, 21, 14, 21, 21, 21, 21, 21, 16, 21, 21, 21, 7, 16, 21, 1, 21, 21, 16, 21, 11, 21, 6, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.525748054885597, "mean_inference_ms": 17.414256890213693, "mean_action_processing_ms": 0.9162040732110485, "mean_env_wait_ms": 2.163765717358089, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06934392208955725, "StateBufferConnector_ms": 0.009133986064365931, "ViewRequirementAgentConnector_ms": 0.12671241954881318}}, "episode_reward_max": 98.8, "episode_reward_min": -12.0, "episode_reward_mean": -3.235204081632653, "episode_len_mean": 19.632653061224488, "episodes_this_iter": 196, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.3000000000000007, -3.400000000000001, -3.4000000000000004, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.3000000000000003, -10.2, -3.3000000000000007, -3.3000000000000007, -3.3000000000000003, -12.0, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.5000000000000004, -3.400000000000001, -3.4000000000000004, -3.400000000000001, -3.4000000000000012, -3.600000000000001, -3.1000000000000005, -11.6, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.5000000000000004, -3.1000000000000005, -3.2, -10.4, -3.3000000000000007, -3.600000000000001, -3.3000000000000003, -3.400000000000001, -3.1000000000000005, -10.7, -3.3000000000000007, -3.0000000000000004, -3.300000000000001, -3.2000000000000006, -3.300000000000001, -3.2000000000000006, -3.2, -3.1000000000000005, -11.7, -3.500000000000001, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.5000000000000004, -10.7, -10.5, -3.3000000000000007, -11.3, -3.600000000000001, -3.3000000000000007, -11.2, -3.4000000000000004, -3.5000000000000004, -3.400000000000001, -3.500000000000001, 98.8, -3.400000000000001, -3.6000000000000005, -3.1000000000000005, -3.2, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.400000000000001, -3.500000000000001, -3.7000000000000006, -11.8, -3.5000000000000004, -3.4000000000000012, -11.2, -3.400000000000001, -3.2000000000000006, -3.600000000000001, -10.7, -3.7000000000000006, -3.4000000000000004, 98.5, -3.5000000000000004, -3.2, -3.500000000000001, -3.4000000000000004, -3.4000000000000004, -11.5, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -10.6, -11.5, -3.500000000000001, -10.0, -3.6000000000000005, -3.2000000000000006, -11.8, -3.600000000000001, -11.2, -3.0000000000000004, -10.6, -3.5000000000000013, -11.0, -3.7000000000000006, -3.600000000000001, -3.2000000000000006, -3.2000000000000006, -3.500000000000001, -3.2000000000000006, -3.600000000000001, -3.2000000000000006, -10.9, -3.3000000000000007, -3.3000000000000003, -3.200000000000001, -3.2000000000000006, -3.6000000000000005, -3.2000000000000006, -3.5000000000000013, -3.1000000000000005, -3.2000000000000006, -3.100000000000001, -3.4000000000000004, -3.3000000000000007, -3.0000000000000004, -3.600000000000001, -3.400000000000001, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.300000000000001, -3.400000000000001, -3.400000000000001, -3.5000000000000004, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, -3.300000000000001, -3.6000000000000005, -3.400000000000001, -3.400000000000001, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.2, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.400000000000001, -3.400000000000001, -3.6000000000000005, -3.5000000000000004, -3.3000000000000007, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -3.500000000000001, -3.2000000000000006, -11.700000000000001, -3.5000000000000004, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.500000000000001, -3.3000000000000007, -3.200000000000001, -3.3000000000000007, -3.5000000000000004, -3.3000000000000003, -3.2, -10.0, -3.6000000000000005], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 7, 6, 21, 12, 21, 21, 13, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 11, 21, 21, 21, 8, 21, 21, 14, 21, 21, 21, 21, 21, 16, 21, 21, 21, 7, 16, 21, 1, 21, 21, 16, 21, 11, 21, 6, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.525748054885597, "mean_inference_ms": 17.414256890213693, "mean_action_processing_ms": 0.9162040732110485, "mean_env_wait_ms": 2.163765717358089, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06934392208955725, "StateBufferConnector_ms": 0.009133986064365931, "ViewRequirementAgentConnector_ms": 0.12671241954881318}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 170956.771, "load_time_ms": 1.125, "load_throughput": 3554193.712, "learn_time_ms": 170010.626, "learn_throughput": 23.528, "synch_weights_time_ms": 177.571}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "episodes_total": 8712, "training_iteration": 42, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-06_22-55-32", "timestamp": 1680814532, "time_this_iter_s": 171.65712141990662, "time_total_s": 7185.445460319519, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f014750b6d0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014757d8b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 7185.445460319519, "timesteps_since_restore": 0, "iterations_since_restore": 42, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.57704918032787, "ram_util_percent": 23.65491803278688}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0657426968857806, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.0010000000000000005, "total_loss": 0.39893584391202336, "policy_loss": -0.10350117109996337, "vf_loss": 0.47230892390543494, "vf_explained_var": 0.514658760575838, "kl": 0.01763326563219595, "entropy": 3.8138417982286024, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 39525.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.200000000000001, "episode_reward_mean": -4.3336683417085435, "episode_len_mean": 19.43718592964824, "episode_media": {}, "episodes_this_iter": 199, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.500000000000001, -3.1000000000000005, -3.2, -3.4000000000000004, -10.5, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.500000000000001, -3.4000000000000012, -3.200000000000001, -3.1000000000000005, -11.5, -3.3000000000000007, -3.200000000000001, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.500000000000001, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.4000000000000012, -3.1000000000000005, -10.8, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, -3.500000000000001, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.4000000000000004, -3.3000000000000003, -3.3000000000000003, -3.200000000000001, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -11.8, -3.400000000000001, -3.2000000000000006, -10.6, -10.3, -3.3000000000000007, -3.3000000000000007, -3.300000000000001, -3.5000000000000004, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -10.6, -3.5000000000000004, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.100000000000001, -3.2000000000000006, -3.5000000000000004, -3.500000000000001, -11.9, -3.5000000000000004, -3.4000000000000004, -3.600000000000001, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.500000000000001, -3.5000000000000004, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.4000000000000004, -3.0000000000000004, -3.1000000000000005, -11.0, -3.2000000000000006, -3.4000000000000004, -3.400000000000001, -11.2, -10.4, -3.3000000000000007, -3.300000000000001, -3.2000000000000006, -3.300000000000001, -3.2000000000000006, -3.400000000000001, -3.2, -3.5000000000000004, -3.2000000000000006, -3.600000000000001, -3.3000000000000007, -3.500000000000001, -3.600000000000001, -3.1000000000000005, -3.400000000000001, -10.5, -3.400000000000001, -3.400000000000001, -3.4000000000000012, -3.3000000000000007, -11.5, -11.5, -3.500000000000001, -3.400000000000001, -3.400000000000001, -3.2000000000000006, -3.3000000000000003, -3.600000000000001, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.500000000000001, -3.4000000000000004, -3.4000000000000004, -3.3000000000000003, -11.8, -3.400000000000001, -3.300000000000001, -3.3000000000000007, -3.3000000000000007, -3.7000000000000006, -3.2000000000000006, -3.1000000000000005, -12.200000000000001, -10.7, -11.9, -3.0000000000000004, -3.3000000000000007, -3.3000000000000003, -11.4, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -10.6, -3.500000000000001, -3.400000000000001, -3.0000000000000004, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.500000000000001, -3.500000000000001, -3.600000000000001, -3.400000000000001, -3.3000000000000003, -3.5000000000000004, -3.5000000000000004, -3.6000000000000005, -3.2000000000000006, -3.500000000000001, -3.3000000000000007, -3.300000000000001, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -10.0, -11.5, -10.0, -10.0, -3.300000000000001, -10.4, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -10.3, -3.3000000000000007, -10.0, -3.1000000000000005, -3.500000000000001], "episode_lengths": [21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 7, 4, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 11, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 15, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 20, 8, 19, 21, 21, 21, 14, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 14, 1, 1, 21, 5, 21, 21, 21, 21, 4, 21, 1, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.519863330786137, "mean_inference_ms": 17.422068573304934, "mean_action_processing_ms": 0.9186592824184713, "mean_env_wait_ms": 2.168850930775054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0811685868843117, "StateBufferConnector_ms": 0.00969249399463136, "ViewRequirementAgentConnector_ms": 0.151107778501271}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.200000000000001, "episode_reward_mean": -4.3336683417085435, "episode_len_mean": 19.43718592964824, "episodes_this_iter": 199, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.500000000000001, -3.1000000000000005, -3.2, -3.4000000000000004, -10.5, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.500000000000001, -3.4000000000000012, -3.200000000000001, -3.1000000000000005, -11.5, -3.3000000000000007, -3.200000000000001, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.500000000000001, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.4000000000000012, -3.1000000000000005, -10.8, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, -3.500000000000001, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.4000000000000004, -3.3000000000000003, -3.3000000000000003, -3.200000000000001, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -11.8, -3.400000000000001, -3.2000000000000006, -10.6, -10.3, -3.3000000000000007, -3.3000000000000007, -3.300000000000001, -3.5000000000000004, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -10.6, -3.5000000000000004, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.100000000000001, -3.2000000000000006, -3.5000000000000004, -3.500000000000001, -11.9, -3.5000000000000004, -3.4000000000000004, -3.600000000000001, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.500000000000001, -3.5000000000000004, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.4000000000000004, -3.0000000000000004, -3.1000000000000005, -11.0, -3.2000000000000006, -3.4000000000000004, -3.400000000000001, -11.2, -10.4, -3.3000000000000007, -3.300000000000001, -3.2000000000000006, -3.300000000000001, -3.2000000000000006, -3.400000000000001, -3.2, -3.5000000000000004, -3.2000000000000006, -3.600000000000001, -3.3000000000000007, -3.500000000000001, -3.600000000000001, -3.1000000000000005, -3.400000000000001, -10.5, -3.400000000000001, -3.400000000000001, -3.4000000000000012, -3.3000000000000007, -11.5, -11.5, -3.500000000000001, -3.400000000000001, -3.400000000000001, -3.2000000000000006, -3.3000000000000003, -3.600000000000001, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.500000000000001, -3.4000000000000004, -3.4000000000000004, -3.3000000000000003, -11.8, -3.400000000000001, -3.300000000000001, -3.3000000000000007, -3.3000000000000007, -3.7000000000000006, -3.2000000000000006, -3.1000000000000005, -12.200000000000001, -10.7, -11.9, -3.0000000000000004, -3.3000000000000007, -3.3000000000000003, -11.4, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -10.6, -3.500000000000001, -3.400000000000001, -3.0000000000000004, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.500000000000001, -3.500000000000001, -3.600000000000001, -3.400000000000001, -3.3000000000000003, -3.5000000000000004, -3.5000000000000004, -3.6000000000000005, -3.2000000000000006, -3.500000000000001, -3.3000000000000007, -3.300000000000001, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -10.0, -11.5, -10.0, -10.0, -3.300000000000001, -10.4, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -10.3, -3.3000000000000007, -10.0, -3.1000000000000005, -3.500000000000001], "episode_lengths": [21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 7, 4, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 11, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 15, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 20, 8, 19, 21, 21, 21, 14, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 14, 1, 1, 21, 5, 21, 21, 21, 21, 4, 21, 1, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.519863330786137, "mean_inference_ms": 17.422068573304934, "mean_action_processing_ms": 0.9186592824184713, "mean_env_wait_ms": 2.168850930775054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0811685868843117, "StateBufferConnector_ms": 0.00969249399463136, "ViewRequirementAgentConnector_ms": 0.151107778501271}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 172000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 172000, "timers": {"training_iteration_time_ms": 170973.411, "load_time_ms": 1.129, "load_throughput": 3543758.528, "learn_time_ms": 170022.776, "learn_throughput": 23.526, "synch_weights_time_ms": 177.9}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "done": false, "episodes_total": 8911, "training_iteration": 43, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-06_22-58-23", "timestamp": 1680814703, "time_this_iter_s": 170.86059880256653, "time_total_s": 7356.306059122086, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01477ae100>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01477160d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 7356.306059122086, "timesteps_since_restore": 0, "iterations_since_restore": 43, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.961728395061727, "ram_util_percent": 23.940329218106996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1752606354413493, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.0010000000000000005, "total_loss": 0.4750579735204097, "policy_loss": -0.11258612387433087, "vf_loss": 0.5596352866955943, "vf_explained_var": 0.41710687805247565, "kl": 0.016392902290243254, "entropy": 3.804639540180083, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 40455.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.4, "episode_reward_mean": -4.472864321608041, "episode_len_mean": 19.974874371859297, "episode_media": {}, "episodes_this_iter": 199, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3000000000000007, -10.5, -3.2000000000000006, -10.5, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.100000000000001, -3.4000000000000004, -3.2, -3.400000000000001, -3.2000000000000006, -3.2, -3.0000000000000004, -3.400000000000001, -3.300000000000001, -3.200000000000001, -3.3000000000000007, -3.500000000000001, -3.500000000000001, -3.400000000000001, -10.5, -3.400000000000001, -3.2000000000000006, -3.3000000000000003, -3.500000000000001, -3.600000000000001, -3.7000000000000006, -3.1000000000000005, -12.200000000000001, -12.0, -3.3000000000000003, -12.0, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.4000000000000004, -3.600000000000001, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.5000000000000013, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.300000000000001, -3.6000000000000005, -3.3000000000000007, -10.2, -3.500000000000001, -3.3000000000000007, -11.9, -3.2000000000000006, -3.1000000000000005, -3.500000000000001, -3.2000000000000006, -11.3, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.600000000000001, -3.4000000000000004, -10.9, -3.4000000000000004, -3.3000000000000007, -11.2, -3.3000000000000007, -3.500000000000001, -3.3000000000000007, -3.400000000000001, -11.8, -11.8, -3.600000000000001, -3.700000000000001, -3.3000000000000003, -3.500000000000001, -12.3, -3.3000000000000007, -3.2000000000000006, -3.5000000000000004, -3.1000000000000005, -3.4000000000000004, -3.400000000000001, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.300000000000001, -3.400000000000001, -12.0, -10.4, -3.300000000000001, -3.3000000000000007, -3.200000000000001, -3.3000000000000007, -11.3, -3.4000000000000004, -3.6000000000000005, -3.2000000000000006, -3.4, -3.1000000000000005, -11.5, -12.100000000000001, -3.400000000000001, -3.4000000000000004, -3.1000000000000005, -11.2, -10.0, -3.2000000000000006, -3.2000000000000006, -3.4000000000000012, -3.4000000000000004, -3.6000000000000005, -3.4000000000000004, -12.200000000000001, -3.3000000000000003, -3.100000000000001, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -11.7, -3.3000000000000007, -3.500000000000001, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.300000000000001, -3.7000000000000015, -3.3000000000000007, -3.3000000000000003, -3.5000000000000004, -3.4000000000000004, -3.2, -3.3000000000000007, -3.5000000000000004, -3.4000000000000004, -3.5000000000000004, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.4000000000000004, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.200000000000001, -12.4, -3.6000000000000005, -11.600000000000001, -3.500000000000001, -3.5000000000000004, -3.2000000000000006, -11.7, -3.6000000000000005, -3.3000000000000007, -12.0, -3.200000000000001, -3.1000000000000005, -3.600000000000001, -3.700000000000001, -3.4000000000000004, -3.5000000000000004, -3.600000000000001, -3.4000000000000004, -3.3000000000000003, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.4000000000000004, -3.3000000000000003, -3.200000000000001, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -3.4000000000000012, -10.9, -3.600000000000001, -3.3000000000000007, -3.3000000000000003, -3.500000000000001, -3.700000000000001, -3.4000000000000012], "episode_lengths": [21, 6, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 20, 20, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 19, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 10, 21, 21, 21, 21, 17, 19, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 5, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 16, 20, 21, 21, 21, 12, 1, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 16, 21, 21, 21, 15, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.519526282542602, "mean_inference_ms": 17.444019491859, "mean_action_processing_ms": 0.9183081835116518, "mean_env_wait_ms": 2.171594492419607, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07371255500831796, "StateBufferConnector_ms": 0.009495169673133736, "ViewRequirementAgentConnector_ms": 0.137283334779979}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.4, "episode_reward_mean": -4.472864321608041, "episode_len_mean": 19.974874371859297, "episodes_this_iter": 199, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.3000000000000007, -10.5, -3.2000000000000006, -10.5, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.100000000000001, -3.4000000000000004, -3.2, -3.400000000000001, -3.2000000000000006, -3.2, -3.0000000000000004, -3.400000000000001, -3.300000000000001, -3.200000000000001, -3.3000000000000007, -3.500000000000001, -3.500000000000001, -3.400000000000001, -10.5, -3.400000000000001, -3.2000000000000006, -3.3000000000000003, -3.500000000000001, -3.600000000000001, -3.7000000000000006, -3.1000000000000005, -12.200000000000001, -12.0, -3.3000000000000003, -12.0, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.4000000000000004, -3.600000000000001, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.5000000000000013, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.300000000000001, -3.6000000000000005, -3.3000000000000007, -10.2, -3.500000000000001, -3.3000000000000007, -11.9, -3.2000000000000006, -3.1000000000000005, -3.500000000000001, -3.2000000000000006, -11.3, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.600000000000001, -3.4000000000000004, -10.9, -3.4000000000000004, -3.3000000000000007, -11.2, -3.3000000000000007, -3.500000000000001, -3.3000000000000007, -3.400000000000001, -11.8, -11.8, -3.600000000000001, -3.700000000000001, -3.3000000000000003, -3.500000000000001, -12.3, -3.3000000000000007, -3.2000000000000006, -3.5000000000000004, -3.1000000000000005, -3.4000000000000004, -3.400000000000001, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.300000000000001, -3.400000000000001, -12.0, -10.4, -3.300000000000001, -3.3000000000000007, -3.200000000000001, -3.3000000000000007, -11.3, -3.4000000000000004, -3.6000000000000005, -3.2000000000000006, -3.4, -3.1000000000000005, -11.5, -12.100000000000001, -3.400000000000001, -3.4000000000000004, -3.1000000000000005, -11.2, -10.0, -3.2000000000000006, -3.2000000000000006, -3.4000000000000012, -3.4000000000000004, -3.6000000000000005, -3.4000000000000004, -12.200000000000001, -3.3000000000000003, -3.100000000000001, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -11.7, -3.3000000000000007, -3.500000000000001, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.300000000000001, -3.7000000000000015, -3.3000000000000007, -3.3000000000000003, -3.5000000000000004, -3.4000000000000004, -3.2, -3.3000000000000007, -3.5000000000000004, -3.4000000000000004, -3.5000000000000004, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.4000000000000004, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.200000000000001, -12.4, -3.6000000000000005, -11.600000000000001, -3.500000000000001, -3.5000000000000004, -3.2000000000000006, -11.7, -3.6000000000000005, -3.3000000000000007, -12.0, -3.200000000000001, -3.1000000000000005, -3.600000000000001, -3.700000000000001, -3.4000000000000004, -3.5000000000000004, -3.600000000000001, -3.4000000000000004, -3.3000000000000003, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.4000000000000004, -3.3000000000000003, -3.200000000000001, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -3.4000000000000012, -10.9, -3.600000000000001, -3.3000000000000007, -3.3000000000000003, -3.500000000000001, -3.700000000000001, -3.4000000000000012], "episode_lengths": [21, 6, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 20, 20, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 19, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 10, 21, 21, 21, 21, 17, 19, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 5, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 16, 20, 21, 21, 21, 12, 1, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 16, 21, 21, 21, 15, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.519526282542602, "mean_inference_ms": 17.444019491859, "mean_action_processing_ms": 0.9183081835116518, "mean_env_wait_ms": 2.171594492419607, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07371255500831796, "StateBufferConnector_ms": 0.009495169673133736, "ViewRequirementAgentConnector_ms": 0.137283334779979}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 170956.15, "load_time_ms": 1.127, "load_throughput": 3548630.653, "learn_time_ms": 170000.609, "learn_throughput": 23.529, "synch_weights_time_ms": 178.513}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "episodes_total": 9110, "training_iteration": 44, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-06_23-01-14", "timestamp": 1680814874, "time_this_iter_s": 170.78035593032837, "time_total_s": 7527.086415052414, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01475e2d00>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014754d820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 7527.086415052414, "timesteps_since_restore": 0, "iterations_since_restore": 44, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 6.584362139917696, "ram_util_percent": 24.129629629629626}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1520791117141964, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.0010000000000000005, "total_loss": 0.41037625922941634, "policy_loss": -0.03695996439751608, "vf_loss": 0.43739167055095074, "vf_explained_var": 0.5166841419153316, "kl": 0.005820314275533942, "entropy": 3.8049641252845845, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 41385.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "sampler_results": {"episode_reward_max": 99.1, "episode_reward_min": -12.1, "episode_reward_mean": -3.7430000000000008, "episode_len_mean": 19.935, "episode_media": {}, "episodes_this_iter": 200, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.300000000000001, -3.3000000000000007, -11.6, -11.2, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -12.1, -3.400000000000001, -3.4000000000000004, -3.4000000000000004, -3.4000000000000004, -3.3000000000000003, -3.700000000000001, -3.5000000000000004, -11.6, -3.1000000000000005, -10.0, -3.500000000000001, -3.400000000000001, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.3000000000000007, -3.3000000000000003, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.500000000000001, -3.900000000000001, -3.5000000000000004, -3.2000000000000006, -11.2, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.4000000000000004, -3.400000000000001, -3.3000000000000003, -3.200000000000001, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.400000000000001, -3.4000000000000004, -3.5000000000000004, -3.1000000000000005, -3.500000000000001, -3.2, -10.9, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -11.5, -3.1000000000000005, -10.1, -3.3000000000000007, -11.8, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.500000000000001, -3.200000000000001, -3.400000000000001, -3.600000000000001, -3.3000000000000007, -3.3000000000000007, 99.1, -3.5000000000000004, -3.1000000000000005, -3.400000000000001, -3.400000000000001, -11.9, -3.4000000000000012, -3.2000000000000006, -3.3000000000000007, -3.6000000000000005, -3.300000000000001, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -11.700000000000001, -3.2, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.400000000000001, -3.2000000000000006, -3.3000000000000003, -11.9, -10.3, -3.4000000000000004, -10.6, -3.600000000000001, -3.400000000000001, -3.5000000000000004, -3.4000000000000004, -3.3000000000000007, -3.5000000000000004, -3.3000000000000007, -11.700000000000001, -3.500000000000001, -3.3000000000000007, -3.400000000000001, -3.800000000000001, -3.4000000000000004, -3.3000000000000007, -3.500000000000001, -3.2000000000000006, -3.2, -3.3000000000000007, -3.600000000000001, -3.400000000000001, -3.1000000000000005, -3.500000000000001, -11.4, -3.4000000000000004, -3.4000000000000004, -3.5000000000000004, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.900000000000001, -3.6000000000000005, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.4000000000000004, -11.3, -3.1000000000000005, -3.5000000000000004, -3.6000000000000005, -3.2000000000000006, -3.200000000000001, -3.3000000000000007, -3.400000000000001, -3.3000000000000003, -3.2, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -11.1, -3.3000000000000007, -3.2000000000000006, -11.5, -3.1000000000000005, -3.5000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.5000000000000004, -3.400000000000001, -3.4000000000000004, -3.400000000000001, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.5000000000000004, -3.3000000000000007, -3.700000000000001, -3.500000000000001, -3.600000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.600000000000001, -3.4000000000000004, -3.200000000000001, -3.2000000000000006, -3.3000000000000007, -3.500000000000001, -3.7000000000000006, -3.3000000000000003, -11.4, -3.2000000000000006, -3.3000000000000007, -3.6000000000000005, -3.5000000000000004, -10.7, -12.0, -3.600000000000001, -3.1000000000000005, -3.400000000000001, -3.5000000000000013], "episode_lengths": [21, 21, 14, 12, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 15, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 16, 21, 2, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 17, 4, 21, 7, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 8, 18, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.507250158424249, "mean_inference_ms": 17.433918915631107, "mean_action_processing_ms": 0.9196283695568122, "mean_env_wait_ms": 2.1756211568195205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0822763442993164, "StateBufferConnector_ms": 0.010599732398986816, "ViewRequirementAgentConnector_ms": 0.15037596225738525}}, "episode_reward_max": 99.1, "episode_reward_min": -12.1, "episode_reward_mean": -3.7430000000000008, "episode_len_mean": 19.935, "episodes_this_iter": 200, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.300000000000001, -3.3000000000000007, -11.6, -11.2, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -12.1, -3.400000000000001, -3.4000000000000004, -3.4000000000000004, -3.4000000000000004, -3.3000000000000003, -3.700000000000001, -3.5000000000000004, -11.6, -3.1000000000000005, -10.0, -3.500000000000001, -3.400000000000001, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.3000000000000007, -3.3000000000000003, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.500000000000001, -3.900000000000001, -3.5000000000000004, -3.2000000000000006, -11.2, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.4000000000000004, -3.400000000000001, -3.3000000000000003, -3.200000000000001, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.400000000000001, -3.4000000000000004, -3.5000000000000004, -3.1000000000000005, -3.500000000000001, -3.2, -10.9, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -11.5, -3.1000000000000005, -10.1, -3.3000000000000007, -11.8, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.500000000000001, -3.200000000000001, -3.400000000000001, -3.600000000000001, -3.3000000000000007, -3.3000000000000007, 99.1, -3.5000000000000004, -3.1000000000000005, -3.400000000000001, -3.400000000000001, -11.9, -3.4000000000000012, -3.2000000000000006, -3.3000000000000007, -3.6000000000000005, -3.300000000000001, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -11.700000000000001, -3.2, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.400000000000001, -3.2000000000000006, -3.3000000000000003, -11.9, -10.3, -3.4000000000000004, -10.6, -3.600000000000001, -3.400000000000001, -3.5000000000000004, -3.4000000000000004, -3.3000000000000007, -3.5000000000000004, -3.3000000000000007, -11.700000000000001, -3.500000000000001, -3.3000000000000007, -3.400000000000001, -3.800000000000001, -3.4000000000000004, -3.3000000000000007, -3.500000000000001, -3.2000000000000006, -3.2, -3.3000000000000007, -3.600000000000001, -3.400000000000001, -3.1000000000000005, -3.500000000000001, -11.4, -3.4000000000000004, -3.4000000000000004, -3.5000000000000004, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.900000000000001, -3.6000000000000005, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.4000000000000004, -11.3, -3.1000000000000005, -3.5000000000000004, -3.6000000000000005, -3.2000000000000006, -3.200000000000001, -3.3000000000000007, -3.400000000000001, -3.3000000000000003, -3.2, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -11.1, -3.3000000000000007, -3.2000000000000006, -11.5, -3.1000000000000005, -3.5000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.5000000000000004, -3.400000000000001, -3.4000000000000004, -3.400000000000001, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.5000000000000004, -3.3000000000000007, -3.700000000000001, -3.500000000000001, -3.600000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.600000000000001, -3.4000000000000004, -3.200000000000001, -3.2000000000000006, -3.3000000000000007, -3.500000000000001, -3.7000000000000006, -3.3000000000000003, -11.4, -3.2000000000000006, -3.3000000000000007, -3.6000000000000005, -3.5000000000000004, -10.7, -12.0, -3.600000000000001, -3.1000000000000005, -3.400000000000001, -3.5000000000000013], "episode_lengths": [21, 21, 14, 12, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 15, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 16, 21, 2, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 17, 4, 21, 7, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 8, 18, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.507250158424249, "mean_inference_ms": 17.433918915631107, "mean_action_processing_ms": 0.9196283695568122, "mean_env_wait_ms": 2.1756211568195205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0822763442993164, "StateBufferConnector_ms": 0.010599732398986816, "ViewRequirementAgentConnector_ms": 0.15037596225738525}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 180000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 170894.856, "load_time_ms": 1.117, "load_throughput": 3580285.105, "learn_time_ms": 169933.354, "learn_throughput": 23.539, "synch_weights_time_ms": 178.906}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "episodes_total": 9310, "training_iteration": 45, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-06_23-04-05", "timestamp": 1680815045, "time_this_iter_s": 170.7494022846222, "time_total_s": 7697.835817337036, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01477915e0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014757db80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 7697.835817337036, "timesteps_since_restore": 0, "iterations_since_restore": 45, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.573251028806584, "ram_util_percent": 24.197119341563777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.157140553782704, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.0010000000000000005, "total_loss": 0.7197692479244784, "policy_loss": -0.042534409135940573, "vf_loss": 0.7462359153705659, "vf_explained_var": 0.3524184701904174, "kl": 0.009404077129507367, "entropy": 3.7968135003120667, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 42315.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "sampler_results": {"episode_reward_max": 98.6, "episode_reward_min": -12.4, "episode_reward_mean": -3.7888888888888896, "episode_len_mean": 18.97584541062802, "episode_media": {}, "episodes_this_iter": 207, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.4000000000000004, -3.1000000000000005, -11.4, -3.600000000000001, -3.3000000000000007, -12.4, -3.0000000000000004, -10.8, -3.2000000000000006, -3.2000000000000006, -10.8, -3.6000000000000005, -3.2000000000000006, -3.2, -3.2000000000000006, -3.3000000000000007, -3.4000000000000004, -3.400000000000001, -3.2, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -12.0, -3.2000000000000006, -3.3000000000000007, -3.2, -3.3000000000000007, -3.400000000000001, -11.1, -11.4, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.4000000000000012, -3.2000000000000006, -3.400000000000001, -11.8, -3.5000000000000004, -3.2000000000000006, -3.4000000000000004, -3.500000000000001, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.3000000000000003, -3.500000000000001, -3.2000000000000006, -12.4, -3.500000000000001, -3.2, -3.2000000000000006, -3.2, -3.2000000000000006, -3.400000000000001, -11.6, -3.3000000000000007, -3.500000000000001, -3.400000000000001, -10.3, -11.4, -3.2000000000000006, -3.3000000000000007, -3.4000000000000004, -11.4, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.500000000000001, -3.4000000000000004, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -10.6, -3.2000000000000006, -3.600000000000001, 98.6, -3.400000000000001, -10.5, -11.5, -3.4000000000000004, -10.9, -3.600000000000001, -3.3000000000000007, -11.3, -3.1000000000000005, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -10.0, -3.700000000000001, -3.1000000000000005, -3.3000000000000007, -3.6000000000000005, -3.2000000000000006, -3.4000000000000004, -3.300000000000001, -3.400000000000001, -11.9, -3.3000000000000007, -3.2000000000000006, -10.8, -3.0000000000000004, -10.0, -3.100000000000001, -10.0, -10.1, -10.9, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.5000000000000004, -3.2, -11.1, 97.9, -3.2000000000000006, -3.0000000000000004, -3.4000000000000004, -3.600000000000001, -3.4000000000000004, -3.1000000000000005, -3.6000000000000005, -3.4000000000000004, -11.0, -3.6000000000000005, -3.400000000000001, -3.500000000000001, -10.3, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -10.1, -10.2, -3.5000000000000004, -3.3000000000000007, -3.500000000000001, -3.400000000000001, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.5000000000000004, -3.3000000000000007, -3.200000000000001, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.600000000000001, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -10.9, -11.2, -11.3, -11.700000000000001, -3.1000000000000005, -10.8, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -10.6, -3.3000000000000003, -12.200000000000001, -3.3000000000000003, -3.600000000000001, -3.3000000000000007, -3.700000000000001, -3.2000000000000006, -3.2, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.600000000000001, -3.800000000000001, -3.3000000000000007, -3.400000000000001, -3.4000000000000004, -3.3000000000000003, -3.400000000000001, -3.1000000000000005, -3.600000000000001, -10.6, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.500000000000001, -3.0000000000000004, -3.2000000000000006, -3.400000000000001, -11.9, -3.3000000000000003], "episode_lengths": [21, 21, 15, 21, 21, 19, 21, 8, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 12, 15, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 3, 11, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 14, 21, 6, 16, 21, 9, 21, 21, 13, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 8, 21, 1, 21, 1, 2, 10, 21, 21, 21, 21, 21, 21, 12, 19, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 3, 21, 21, 21, 21, 2, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 11, 12, 17, 21, 8, 21, 21, 21, 7, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.509467212574334, "mean_inference_ms": 17.442170402862093, "mean_action_processing_ms": 0.920134099632686, "mean_env_wait_ms": 2.178677811150127, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0767794208250184, "StateBufferConnector_ms": 0.010287358565031043, "ViewRequirementAgentConnector_ms": 0.14105027424540498}}, "episode_reward_max": 98.6, "episode_reward_min": -12.4, "episode_reward_mean": -3.7888888888888896, "episode_len_mean": 18.97584541062802, "episodes_this_iter": 207, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.4000000000000004, -3.1000000000000005, -11.4, -3.600000000000001, -3.3000000000000007, -12.4, -3.0000000000000004, -10.8, -3.2000000000000006, -3.2000000000000006, -10.8, -3.6000000000000005, -3.2000000000000006, -3.2, -3.2000000000000006, -3.3000000000000007, -3.4000000000000004, -3.400000000000001, -3.2, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -12.0, -3.2000000000000006, -3.3000000000000007, -3.2, -3.3000000000000007, -3.400000000000001, -11.1, -11.4, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.4000000000000012, -3.2000000000000006, -3.400000000000001, -11.8, -3.5000000000000004, -3.2000000000000006, -3.4000000000000004, -3.500000000000001, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.3000000000000003, -3.500000000000001, -3.2000000000000006, -12.4, -3.500000000000001, -3.2, -3.2000000000000006, -3.2, -3.2000000000000006, -3.400000000000001, -11.6, -3.3000000000000007, -3.500000000000001, -3.400000000000001, -10.3, -11.4, -3.2000000000000006, -3.3000000000000007, -3.4000000000000004, -11.4, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.500000000000001, -3.4000000000000004, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -10.6, -3.2000000000000006, -3.600000000000001, 98.6, -3.400000000000001, -10.5, -11.5, -3.4000000000000004, -10.9, -3.600000000000001, -3.3000000000000007, -11.3, -3.1000000000000005, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -10.0, -3.700000000000001, -3.1000000000000005, -3.3000000000000007, -3.6000000000000005, -3.2000000000000006, -3.4000000000000004, -3.300000000000001, -3.400000000000001, -11.9, -3.3000000000000007, -3.2000000000000006, -10.8, -3.0000000000000004, -10.0, -3.100000000000001, -10.0, -10.1, -10.9, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.5000000000000004, -3.2, -11.1, 97.9, -3.2000000000000006, -3.0000000000000004, -3.4000000000000004, -3.600000000000001, -3.4000000000000004, -3.1000000000000005, -3.6000000000000005, -3.4000000000000004, -11.0, -3.6000000000000005, -3.400000000000001, -3.500000000000001, -10.3, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -10.1, -10.2, -3.5000000000000004, -3.3000000000000007, -3.500000000000001, -3.400000000000001, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.5000000000000004, -3.3000000000000007, -3.200000000000001, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.600000000000001, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -10.9, -11.2, -11.3, -11.700000000000001, -3.1000000000000005, -10.8, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -10.6, -3.3000000000000003, -12.200000000000001, -3.3000000000000003, -3.600000000000001, -3.3000000000000007, -3.700000000000001, -3.2000000000000006, -3.2, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.600000000000001, -3.800000000000001, -3.3000000000000007, -3.400000000000001, -3.4000000000000004, -3.3000000000000003, -3.400000000000001, -3.1000000000000005, -3.600000000000001, -10.6, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.500000000000001, -3.0000000000000004, -3.2000000000000006, -3.400000000000001, -11.9, -3.3000000000000003], "episode_lengths": [21, 21, 15, 21, 21, 19, 21, 8, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 12, 15, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 3, 11, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 14, 21, 6, 16, 21, 9, 21, 21, 13, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 8, 21, 1, 21, 1, 2, 10, 21, 21, 21, 21, 21, 21, 12, 19, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 3, 21, 21, 21, 21, 2, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 11, 12, 17, 21, 8, 21, 21, 21, 7, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.509467212574334, "mean_inference_ms": 17.442170402862093, "mean_action_processing_ms": 0.920134099632686, "mean_env_wait_ms": 2.178677811150127, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0767794208250184, "StateBufferConnector_ms": 0.010287358565031043, "ViewRequirementAgentConnector_ms": 0.14105027424540498}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 184000, "timers": {"training_iteration_time_ms": 170963.709, "load_time_ms": 1.13, "load_throughput": 3539123.721, "learn_time_ms": 170002.75, "learn_throughput": 23.529, "synch_weights_time_ms": 177.532}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "done": false, "episodes_total": 9517, "training_iteration": 46, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-06_23-06-56", "timestamp": 1680815216, "time_this_iter_s": 171.2228982448578, "time_total_s": 7869.058715581894, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01477a3f70>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014757d4c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 7869.058715581894, "timesteps_since_restore": 0, "iterations_since_restore": 46, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.678600823045268, "ram_util_percent": 24.199588477366248}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1345406489987526, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.0010000000000000005, "total_loss": 0.5315767036170088, "policy_loss": -0.11817033636103313, "vf_loss": 0.6166856471158725, "vf_explained_var": 0.36739038895535214, "kl": 0.019350061865000216, "entropy": 3.778307512242307, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 43245.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.3, "episode_reward_mean": -4.363636363636364, "episode_len_mean": 19.954545454545453, "episode_media": {}, "episodes_this_iter": 198, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3000000000000007, -3.500000000000001, -3.3000000000000007, -3.4000000000000004, -11.2, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.2, -3.4000000000000004, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -11.600000000000001, -3.500000000000001, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -11.7, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2, -3.3000000000000003, -3.3000000000000007, -11.9, -3.4000000000000004, -3.3000000000000007, -3.400000000000001, -3.3000000000000003, -3.1000000000000005, -3.3000000000000003, -3.200000000000001, -11.1, -11.4, -3.1000000000000005, -3.200000000000001, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.200000000000001, -3.4000000000000004, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.5000000000000004, -3.3000000000000007, -10.8, -11.700000000000001, -3.400000000000001, -3.4000000000000004, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.300000000000001, -3.500000000000001, -3.1000000000000005, -3.2000000000000006, -3.500000000000001, -3.2, -3.4000000000000004, -10.4, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.400000000000001, -3.500000000000001, -11.1, -3.4000000000000004, -3.400000000000001, -3.400000000000001, -11.8, -3.1000000000000005, -3.200000000000001, -3.2000000000000006, -3.600000000000001, -3.3000000000000007, -3.500000000000001, -3.3000000000000007, -10.4, -10.4, -3.3000000000000003, -3.3000000000000007, -10.7, -3.1000000000000005, -3.400000000000001, -3.300000000000001, -3.3000000000000007, -3.400000000000001, -3.6000000000000005, -3.3000000000000003, -3.3000000000000003, -3.500000000000001, -12.3, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.5000000000000004, -12.0, -3.3000000000000007, -3.3000000000000003, -3.300000000000001, -3.500000000000001, -3.4000000000000004, -3.3000000000000007, -3.2000000000000006, -3.200000000000001, -3.200000000000001, -11.5, -11.7, -11.2, -3.2000000000000006, -3.5000000000000004, -3.6000000000000005, -3.2, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.5000000000000004, -3.3000000000000003, -3.500000000000001, -3.1000000000000005, -3.600000000000001, -3.5000000000000004, -3.1000000000000005, -3.5000000000000004, -3.2000000000000006, -3.2000000000000006, -3.4000000000000012, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.600000000000001, -3.0000000000000004, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.3000000000000003, -3.3000000000000007, -3.2, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.5000000000000004, -12.3, -3.2, -11.4, -3.3000000000000007, -11.9, -3.3000000000000003, -10.2, -3.3000000000000007, -3.5000000000000004, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.6000000000000014, -3.6000000000000005, -3.4000000000000004, -3.2000000000000006, -3.4000000000000012, -3.5000000000000004, -3.400000000000001, -3.6000000000000005, -3.2, -3.7000000000000006, -11.9, -3.3000000000000003, -3.0000000000000004, -3.4000000000000004, -3.1000000000000005, -3.0000000000000004, -3.4000000000000004, -3.3000000000000007, -11.1, -3.5000000000000004, -3.500000000000001, -3.500000000000001, -3.2000000000000006, -11.0, -3.6000000000000005, -3.600000000000001, -3.400000000000001], "episode_lengths": [21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 12, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 4, 5, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 17, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 13, 21, 18, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 10, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.515116493010856, "mean_inference_ms": 17.45382387206933, "mean_action_processing_ms": 0.9179732411007991, "mean_env_wait_ms": 2.1761293249202214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0705230115640043, "StateBufferConnector_ms": 0.008803425413189512, "ViewRequirementAgentConnector_ms": 0.12845258520107078}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.3, "episode_reward_mean": -4.363636363636364, "episode_len_mean": 19.954545454545453, "episodes_this_iter": 198, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.3000000000000007, -3.500000000000001, -3.3000000000000007, -3.4000000000000004, -11.2, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.2, -3.4000000000000004, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -11.600000000000001, -3.500000000000001, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -11.7, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2, -3.3000000000000003, -3.3000000000000007, -11.9, -3.4000000000000004, -3.3000000000000007, -3.400000000000001, -3.3000000000000003, -3.1000000000000005, -3.3000000000000003, -3.200000000000001, -11.1, -11.4, -3.1000000000000005, -3.200000000000001, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.200000000000001, -3.4000000000000004, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.5000000000000004, -3.3000000000000007, -10.8, -11.700000000000001, -3.400000000000001, -3.4000000000000004, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.300000000000001, -3.500000000000001, -3.1000000000000005, -3.2000000000000006, -3.500000000000001, -3.2, -3.4000000000000004, -10.4, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.400000000000001, -3.500000000000001, -11.1, -3.4000000000000004, -3.400000000000001, -3.400000000000001, -11.8, -3.1000000000000005, -3.200000000000001, -3.2000000000000006, -3.600000000000001, -3.3000000000000007, -3.500000000000001, -3.3000000000000007, -10.4, -10.4, -3.3000000000000003, -3.3000000000000007, -10.7, -3.1000000000000005, -3.400000000000001, -3.300000000000001, -3.3000000000000007, -3.400000000000001, -3.6000000000000005, -3.3000000000000003, -3.3000000000000003, -3.500000000000001, -12.3, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.5000000000000004, -12.0, -3.3000000000000007, -3.3000000000000003, -3.300000000000001, -3.500000000000001, -3.4000000000000004, -3.3000000000000007, -3.2000000000000006, -3.200000000000001, -3.200000000000001, -11.5, -11.7, -11.2, -3.2000000000000006, -3.5000000000000004, -3.6000000000000005, -3.2, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.5000000000000004, -3.3000000000000003, -3.500000000000001, -3.1000000000000005, -3.600000000000001, -3.5000000000000004, -3.1000000000000005, -3.5000000000000004, -3.2000000000000006, -3.2000000000000006, -3.4000000000000012, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.600000000000001, -3.0000000000000004, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.3000000000000003, -3.3000000000000007, -3.2, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.5000000000000004, -12.3, -3.2, -11.4, -3.3000000000000007, -11.9, -3.3000000000000003, -10.2, -3.3000000000000007, -3.5000000000000004, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.6000000000000014, -3.6000000000000005, -3.4000000000000004, -3.2000000000000006, -3.4000000000000012, -3.5000000000000004, -3.400000000000001, -3.6000000000000005, -3.2, -3.7000000000000006, -11.9, -3.3000000000000003, -3.0000000000000004, -3.4000000000000004, -3.1000000000000005, -3.0000000000000004, -3.4000000000000004, -3.3000000000000007, -11.1, -3.5000000000000004, -3.500000000000001, -3.500000000000001, -3.2000000000000006, -11.0, -3.6000000000000005, -3.600000000000001, -3.400000000000001], "episode_lengths": [21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 12, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 4, 5, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 17, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 13, 21, 18, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 10, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.515116493010856, "mean_inference_ms": 17.45382387206933, "mean_action_processing_ms": 0.9179732411007991, "mean_env_wait_ms": 2.1761293249202214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0705230115640043, "StateBufferConnector_ms": 0.008803425413189512, "ViewRequirementAgentConnector_ms": 0.12845258520107078}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 188000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 188000, "timers": {"training_iteration_time_ms": 170982.042, "load_time_ms": 1.136, "load_throughput": 3521296.254, "learn_time_ms": 170026.695, "learn_throughput": 23.526, "synch_weights_time_ms": 176.344}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "done": false, "episodes_total": 9715, "training_iteration": 47, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-06_23-09-47", "timestamp": 1680815387, "time_this_iter_s": 171.07112526893616, "time_total_s": 8040.12984085083, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7effc0948b80>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0147526ee0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 8040.12984085083, "timesteps_since_restore": 0, "iterations_since_restore": 47, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.453688524590165, "ram_util_percent": 24.195901639344253}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0300935804042766, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.0010000000000000005, "total_loss": 0.5853474714407717, "policy_loss": -0.04409606207615285, "vf_loss": 0.6152036834167697, "vf_explained_var": 0.5139364939863964, "kl": 0.008334250912766263, "entropy": 3.775700279717804, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 44175.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "sampler_results": {"episode_reward_max": 98.8, "episode_reward_min": -12.200000000000001, "episode_reward_mean": -3.2391509433962264, "episode_len_mean": 19.67924528301887, "episode_media": {}, "episodes_this_iter": 212, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.400000000000001, -3.5000000000000004, -3.5000000000000013, -3.3000000000000007, -3.2000000000000006, -3.200000000000001, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.500000000000001, -3.3000000000000007, -3.4000000000000004, -3.400000000000001, -10.8, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -3.100000000000001, -3.3000000000000003, -3.2000000000000006, -3.2, -10.4, -11.5, -11.0, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -12.0, -3.3000000000000007, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.400000000000001, -3.200000000000001, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.4000000000000004, -3.4000000000000004, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -11.4, -3.3000000000000003, -3.0000000000000004, -3.2000000000000006, -3.200000000000001, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.5000000000000004, -3.200000000000001, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.0000000000000004, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.3000000000000003, -3.4000000000000004, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -10.6, -3.3000000000000007, -3.500000000000001, -3.100000000000001, -10.5, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -3.4000000000000012, -3.3000000000000007, -3.500000000000001, -3.2000000000000006, -3.500000000000001, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.4000000000000004, -10.5, -12.1, -3.2000000000000006, -3.2, -3.400000000000001, -3.0000000000000004, -3.100000000000001, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.2, -3.400000000000001, -3.1000000000000005, 98.8, -3.2000000000000006, 97.6, -3.3000000000000003, -11.1, -3.2000000000000006, -3.1000000000000005, -11.5, -3.4000000000000012, -3.3000000000000007, -12.100000000000001, -3.800000000000001, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -3.4000000000000004, -3.3000000000000007, -10.7, -3.3000000000000003, -3.2000000000000006, -12.200000000000001, -3.1000000000000005, -3.3000000000000007, -3.5000000000000004, -3.3000000000000003, -3.4000000000000004, -10.2, -10.2, -3.3000000000000007, -3.1000000000000005, -11.2, -3.3000000000000003, -3.400000000000001, -10.3, -11.4, -3.400000000000001, -3.3000000000000007, -3.600000000000001, -3.2000000000000006, -3.200000000000001, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.400000000000001, -3.2, -3.400000000000001, -3.2000000000000006, -3.500000000000001, -3.1000000000000005, -3.400000000000001, -3.4000000000000004, -3.400000000000001, -3.3000000000000007, -3.5000000000000004, -3.2000000000000006, -3.1000000000000005, -3.200000000000001, -3.4000000000000004, -3.400000000000001, -3.3000000000000007, -3.4000000000000004, -3.1000000000000005, -3.4000000000000004, -3.400000000000001, -3.3000000000000007, -10.1, -3.400000000000001, -3.2000000000000006, -3.3000000000000003, -3.4000000000000004, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.2, -3.2000000000000006, -3.1000000000000005, -3.500000000000001, -3.4000000000000004, -3.3000000000000007, -3.400000000000001, -3.700000000000001, -3.2, -3.3000000000000003, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -10.7, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.4000000000000004, -3.4000000000000004, -3.5000000000000004, -3.1000000000000005, -10.4, -3.5000000000000004, -3.2000000000000006, -10.5, -3.600000000000001, -3.1000000000000005, -3.400000000000001, -3.4000000000000012, -11.700000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 5, 16, 11, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 20, 21, 11, 21, 21, 13, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 19, 21, 21, 21, 21, 21, 3, 3, 21, 21, 13, 21, 21, 4, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 6, 21, 21, 21, 21, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.532714283665515, "mean_inference_ms": 17.442632317858997, "mean_action_processing_ms": 0.9166649939995957, "mean_env_wait_ms": 2.176552352671596, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07354358457169442, "StateBufferConnector_ms": 0.00960714412185381, "ViewRequirementAgentConnector_ms": 0.1327272856010581}}, "episode_reward_max": 98.8, "episode_reward_min": -12.200000000000001, "episode_reward_mean": -3.2391509433962264, "episode_len_mean": 19.67924528301887, "episodes_this_iter": 212, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.400000000000001, -3.5000000000000004, -3.5000000000000013, -3.3000000000000007, -3.2000000000000006, -3.200000000000001, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.500000000000001, -3.3000000000000007, -3.4000000000000004, -3.400000000000001, -10.8, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -3.100000000000001, -3.3000000000000003, -3.2000000000000006, -3.2, -10.4, -11.5, -11.0, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -12.0, -3.3000000000000007, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.400000000000001, -3.200000000000001, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.4000000000000004, -3.4000000000000004, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -11.4, -3.3000000000000003, -3.0000000000000004, -3.2000000000000006, -3.200000000000001, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.5000000000000004, -3.200000000000001, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.0000000000000004, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.3000000000000003, -3.4000000000000004, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -10.6, -3.3000000000000007, -3.500000000000001, -3.100000000000001, -10.5, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -3.4000000000000012, -3.3000000000000007, -3.500000000000001, -3.2000000000000006, -3.500000000000001, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.4000000000000004, -10.5, -12.1, -3.2000000000000006, -3.2, -3.400000000000001, -3.0000000000000004, -3.100000000000001, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.2, -3.400000000000001, -3.1000000000000005, 98.8, -3.2000000000000006, 97.6, -3.3000000000000003, -11.1, -3.2000000000000006, -3.1000000000000005, -11.5, -3.4000000000000012, -3.3000000000000007, -12.100000000000001, -3.800000000000001, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -3.4000000000000004, -3.3000000000000007, -10.7, -3.3000000000000003, -3.2000000000000006, -12.200000000000001, -3.1000000000000005, -3.3000000000000007, -3.5000000000000004, -3.3000000000000003, -3.4000000000000004, -10.2, -10.2, -3.3000000000000007, -3.1000000000000005, -11.2, -3.3000000000000003, -3.400000000000001, -10.3, -11.4, -3.400000000000001, -3.3000000000000007, -3.600000000000001, -3.2000000000000006, -3.200000000000001, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.400000000000001, -3.2, -3.400000000000001, -3.2000000000000006, -3.500000000000001, -3.1000000000000005, -3.400000000000001, -3.4000000000000004, -3.400000000000001, -3.3000000000000007, -3.5000000000000004, -3.2000000000000006, -3.1000000000000005, -3.200000000000001, -3.4000000000000004, -3.400000000000001, -3.3000000000000007, -3.4000000000000004, -3.1000000000000005, -3.4000000000000004, -3.400000000000001, -3.3000000000000007, -10.1, -3.400000000000001, -3.2000000000000006, -3.3000000000000003, -3.4000000000000004, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.2, -3.2000000000000006, -3.1000000000000005, -3.500000000000001, -3.4000000000000004, -3.3000000000000007, -3.400000000000001, -3.700000000000001, -3.2, -3.3000000000000003, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -10.7, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.4000000000000004, -3.4000000000000004, -3.5000000000000004, -3.1000000000000005, -10.4, -3.5000000000000004, -3.2000000000000006, -10.5, -3.600000000000001, -3.1000000000000005, -3.400000000000001, -3.4000000000000012, -11.700000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 5, 16, 11, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 20, 21, 11, 21, 21, 13, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 19, 21, 21, 21, 21, 21, 3, 3, 21, 21, 13, 21, 21, 4, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 6, 21, 21, 21, 21, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.532714283665515, "mean_inference_ms": 17.442632317858997, "mean_action_processing_ms": 0.9166649939995957, "mean_env_wait_ms": 2.176552352671596, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07354358457169442, "StateBufferConnector_ms": 0.00960714412185381, "ViewRequirementAgentConnector_ms": 0.1327272856010581}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 170985.899, "load_time_ms": 1.143, "load_throughput": 3500211.967, "learn_time_ms": 170030.221, "learn_throughput": 23.525, "synch_weights_time_ms": 176.425}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "episodes_total": 9927, "training_iteration": 48, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-06_23-12-38", "timestamp": 1680815558, "time_this_iter_s": 170.69609022140503, "time_total_s": 8210.825931072235, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01477aebb0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01474de9d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 8210.825931072235, "timesteps_since_restore": 0, "iterations_since_restore": 48, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.5016528925619825, "ram_util_percent": 24.148347107438013}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1167659406059531, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.0010000000000000005, "total_loss": 0.5204101619400805, "policy_loss": -0.034206133627211324, "vf_loss": 0.5388970853600611, "vf_explained_var": 0.5411170430080865, "kl": 0.009200087852302878, "entropy": 3.7673905844329507, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 45105.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "sampler_results": {"episode_reward_max": 98.8, "episode_reward_min": -12.1, "episode_reward_mean": -3.243069306930694, "episode_len_mean": 19.65841584158416, "episode_media": {}, "episodes_this_iter": 202, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.5, -11.5, -10.1, -3.3000000000000007, 98.8, -3.200000000000001, 98.7, -3.400000000000001, -3.4000000000000004, -3.2000000000000006, -3.5000000000000004, -3.0000000000000004, -3.3000000000000007, -3.6000000000000005, -3.1000000000000005, -3.300000000000001, -3.400000000000001, -3.3000000000000007, -3.2, -3.5000000000000004, -3.2000000000000006, -3.2, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.5000000000000004, -3.3000000000000007, -3.2000000000000006, -3.200000000000001, -3.3000000000000007, -3.2, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.4000000000000012, -3.0000000000000004, -11.3, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -10.7, -10.4, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -11.8, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.2, -11.3, -3.3000000000000003, -3.2, -3.2000000000000006, -11.3, -3.5000000000000004, -3.0000000000000004, -11.3, -3.3000000000000007, -11.2, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.300000000000001, -3.2000000000000006, -3.1000000000000005, -10.9, -3.5000000000000004, -3.200000000000001, -3.2000000000000006, -3.400000000000001, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -11.8, -3.4000000000000004, -3.3000000000000007, -11.6, -3.1000000000000005, -11.0, -3.300000000000001, -3.3000000000000007, -3.200000000000001, -3.2000000000000006, -3.100000000000001, -3.3000000000000007, -3.400000000000001, -3.500000000000001, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.0000000000000004, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -11.1, -11.2, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.700000000000001, -3.2000000000000006, -3.3000000000000003, -3.400000000000001, -3.0000000000000004, -3.4000000000000004, -3.500000000000001, -3.800000000000001, -12.0, -3.7000000000000006, -3.1000000000000005, -3.400000000000001, -12.1, -3.4000000000000004, -3.3000000000000007, -3.1000000000000005, -11.2, -3.2000000000000006, -10.2, -3.6000000000000005, -3.500000000000001, -3.2000000000000006, -3.0000000000000004, -3.3000000000000003, -3.500000000000001, -3.4000000000000012, -3.3000000000000003, -3.300000000000001, -3.2000000000000006, -3.2000000000000006, -3.600000000000001, -3.3000000000000007, -10.2, -3.4000000000000004, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.5000000000000004, -3.4000000000000004, -10.1, -3.4000000000000004, -3.2, -3.600000000000001, -11.9, -3.2, -3.5000000000000004, -3.3000000000000003, -3.2, -3.400000000000001, -3.100000000000001, -3.2, -3.1000000000000005, -3.5000000000000004, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.500000000000001, -3.3000000000000003, -10.6, -3.2000000000000006, -3.500000000000001, -3.7000000000000006, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.6000000000000005, -3.7000000000000006, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.500000000000001, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.4000000000000004, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.500000000000001, -3.3000000000000007, -3.2, -3.4000000000000004, -3.3000000000000007, -3.300000000000001], "episode_lengths": [6, 14, 2, 21, 11, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 8, 5, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 13, 21, 21, 21, 14, 21, 21, 12, 21, 11, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 14, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 19, 21, 21, 21, 12, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.518807743484583, "mean_inference_ms": 17.450926236029936, "mean_action_processing_ms": 0.9173792849262629, "mean_env_wait_ms": 2.179015514266631, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07371878860020402, "StateBufferConnector_ms": 0.009002307854076423, "ViewRequirementAgentConnector_ms": 0.13475547922719824}}, "episode_reward_max": 98.8, "episode_reward_min": -12.1, "episode_reward_mean": -3.243069306930694, "episode_len_mean": 19.65841584158416, "episodes_this_iter": 202, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10.5, -11.5, -10.1, -3.3000000000000007, 98.8, -3.200000000000001, 98.7, -3.400000000000001, -3.4000000000000004, -3.2000000000000006, -3.5000000000000004, -3.0000000000000004, -3.3000000000000007, -3.6000000000000005, -3.1000000000000005, -3.300000000000001, -3.400000000000001, -3.3000000000000007, -3.2, -3.5000000000000004, -3.2000000000000006, -3.2, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.5000000000000004, -3.3000000000000007, -3.2000000000000006, -3.200000000000001, -3.3000000000000007, -3.2, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.4000000000000012, -3.0000000000000004, -11.3, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -10.7, -10.4, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -11.8, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.2, -11.3, -3.3000000000000003, -3.2, -3.2000000000000006, -11.3, -3.5000000000000004, -3.0000000000000004, -11.3, -3.3000000000000007, -11.2, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.300000000000001, -3.2000000000000006, -3.1000000000000005, -10.9, -3.5000000000000004, -3.200000000000001, -3.2000000000000006, -3.400000000000001, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -11.8, -3.4000000000000004, -3.3000000000000007, -11.6, -3.1000000000000005, -11.0, -3.300000000000001, -3.3000000000000007, -3.200000000000001, -3.2000000000000006, -3.100000000000001, -3.3000000000000007, -3.400000000000001, -3.500000000000001, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.0000000000000004, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -11.1, -11.2, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.700000000000001, -3.2000000000000006, -3.3000000000000003, -3.400000000000001, -3.0000000000000004, -3.4000000000000004, -3.500000000000001, -3.800000000000001, -12.0, -3.7000000000000006, -3.1000000000000005, -3.400000000000001, -12.1, -3.4000000000000004, -3.3000000000000007, -3.1000000000000005, -11.2, -3.2000000000000006, -10.2, -3.6000000000000005, -3.500000000000001, -3.2000000000000006, -3.0000000000000004, -3.3000000000000003, -3.500000000000001, -3.4000000000000012, -3.3000000000000003, -3.300000000000001, -3.2000000000000006, -3.2000000000000006, -3.600000000000001, -3.3000000000000007, -10.2, -3.4000000000000004, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.5000000000000004, -3.4000000000000004, -10.1, -3.4000000000000004, -3.2, -3.600000000000001, -11.9, -3.2, -3.5000000000000004, -3.3000000000000003, -3.2, -3.400000000000001, -3.100000000000001, -3.2, -3.1000000000000005, -3.5000000000000004, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.500000000000001, -3.3000000000000003, -10.6, -3.2000000000000006, -3.500000000000001, -3.7000000000000006, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.6000000000000005, -3.7000000000000006, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.500000000000001, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.4000000000000004, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.500000000000001, -3.3000000000000007, -3.2, -3.4000000000000004, -3.3000000000000007, -3.300000000000001], "episode_lengths": [6, 14, 2, 21, 11, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 8, 5, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 13, 21, 21, 21, 14, 21, 21, 12, 21, 11, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 14, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 19, 21, 21, 21, 12, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.518807743484583, "mean_inference_ms": 17.450926236029936, "mean_action_processing_ms": 0.9173792849262629, "mean_env_wait_ms": 2.179015514266631, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07371878860020402, "StateBufferConnector_ms": 0.009002307854076423, "ViewRequirementAgentConnector_ms": 0.13475547922719824}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 196000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 196000, "timers": {"training_iteration_time_ms": 171021.819, "load_time_ms": 1.151, "load_throughput": 3475990.552, "learn_time_ms": 170068.915, "learn_throughput": 23.52, "synch_weights_time_ms": 175.6}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "done": false, "episodes_total": 10129, "training_iteration": 49, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-06_23-15-29", "timestamp": 1680815729, "time_this_iter_s": 171.6271071434021, "time_total_s": 8382.453038215637, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0147659130>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0147526b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 8382.453038215637, "timesteps_since_restore": 0, "iterations_since_restore": 49, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.570081967213114, "ram_util_percent": 24.1795081967213}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.147595496123196, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.0010000000000000005, "total_loss": 0.3802490394514915, "policy_loss": -0.035142405524033735, "vf_loss": 0.397631845414959, "vf_explained_var": 0.5669403846545886, "kl": 0.010394279799322092, "entropy": 3.7701122771027267, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 46035.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "sampler_results": {"episode_reward_max": 98.0, "episode_reward_min": -12.3, "episode_reward_mean": -3.6651515151515155, "episode_len_mean": 19.848484848484848, "episode_media": {}, "episodes_this_iter": 198, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.400000000000001, -3.6000000000000005, -3.3000000000000003, -3.2000000000000006, -3.500000000000001, -3.700000000000001, -3.3000000000000007, -3.1000000000000005, -3.5000000000000013, -3.400000000000001, -11.3, -3.3000000000000003, -3.0000000000000004, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.4000000000000012, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.2, -3.500000000000001, -3.3000000000000007, -3.100000000000001, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -11.5, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.600000000000001, -3.3000000000000003, -3.200000000000001, -12.0, -3.500000000000001, -3.400000000000001, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.200000000000001, -3.6000000000000005, -3.6000000000000005, -3.400000000000001, -3.4000000000000004, -3.400000000000001, -3.2, -3.2000000000000006, -10.0, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -10.8, -3.4000000000000004, -10.7, -3.3000000000000007, -3.4000000000000004, -11.5, -3.4000000000000004, -3.2, -11.6, -3.2000000000000006, -3.2000000000000006, -3.2, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.300000000000001, -3.400000000000001, -10.1, -3.3000000000000007, -11.6, -3.5000000000000004, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.2, -3.3000000000000003, -11.700000000000001, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.500000000000001, -3.2000000000000006, -12.3, -3.4000000000000004, -10.2, -3.5000000000000004, -3.3000000000000003, -3.7000000000000006, -3.400000000000001, -3.400000000000001, -3.400000000000001, -3.7000000000000006, -3.500000000000001, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -10.2, -3.3000000000000007, -3.2, -3.3000000000000007, -3.800000000000001, -3.400000000000001, -3.1000000000000005, 98.0, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.2, -3.400000000000001, -3.7000000000000006, -3.2000000000000006, -3.1000000000000005, -3.600000000000001, -3.3000000000000007, -10.5, -3.2000000000000006, -10.8, -10.5, -3.2, -3.5000000000000004, -10.2, -3.100000000000001, -3.400000000000001, -3.0000000000000004, -11.9, -3.1000000000000005, -3.600000000000001, -12.200000000000001, -3.6000000000000005, -3.7000000000000006, -3.400000000000001, -3.500000000000001, -3.3000000000000007, -3.1000000000000005, -3.4000000000000004, -3.400000000000001, -3.3000000000000007, -3.4000000000000004, -3.600000000000001, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.400000000000001, -3.3000000000000003, -3.4000000000000004, -3.600000000000001, -11.3, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -11.700000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 9, 21, 7, 21, 21, 15, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 15, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 9, 5, 21, 21, 3, 21, 21, 21, 18, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.535138583847067, "mean_inference_ms": 17.45278668762821, "mean_action_processing_ms": 0.916310775619105, "mean_env_wait_ms": 2.180659680384849, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0694922726563733, "StateBufferConnector_ms": 0.008934435218271582, "ViewRequirementAgentConnector_ms": 0.12897108540390478}}, "episode_reward_max": 98.0, "episode_reward_min": -12.3, "episode_reward_mean": -3.6651515151515155, "episode_len_mean": 19.848484848484848, "episodes_this_iter": 198, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.400000000000001, -3.6000000000000005, -3.3000000000000003, -3.2000000000000006, -3.500000000000001, -3.700000000000001, -3.3000000000000007, -3.1000000000000005, -3.5000000000000013, -3.400000000000001, -11.3, -3.3000000000000003, -3.0000000000000004, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.4000000000000012, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.2, -3.500000000000001, -3.3000000000000007, -3.100000000000001, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -11.5, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.600000000000001, -3.3000000000000003, -3.200000000000001, -12.0, -3.500000000000001, -3.400000000000001, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.200000000000001, -3.6000000000000005, -3.6000000000000005, -3.400000000000001, -3.4000000000000004, -3.400000000000001, -3.2, -3.2000000000000006, -10.0, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -10.8, -3.4000000000000004, -10.7, -3.3000000000000007, -3.4000000000000004, -11.5, -3.4000000000000004, -3.2, -11.6, -3.2000000000000006, -3.2000000000000006, -3.2, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.300000000000001, -3.400000000000001, -10.1, -3.3000000000000007, -11.6, -3.5000000000000004, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.2, -3.3000000000000003, -11.700000000000001, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.500000000000001, -3.2000000000000006, -12.3, -3.4000000000000004, -10.2, -3.5000000000000004, -3.3000000000000003, -3.7000000000000006, -3.400000000000001, -3.400000000000001, -3.400000000000001, -3.7000000000000006, -3.500000000000001, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -10.2, -3.3000000000000007, -3.2, -3.3000000000000007, -3.800000000000001, -3.400000000000001, -3.1000000000000005, 98.0, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.2, -3.400000000000001, -3.7000000000000006, -3.2000000000000006, -3.1000000000000005, -3.600000000000001, -3.3000000000000007, -10.5, -3.2000000000000006, -10.8, -10.5, -3.2, -3.5000000000000004, -10.2, -3.100000000000001, -3.400000000000001, -3.0000000000000004, -11.9, -3.1000000000000005, -3.600000000000001, -12.200000000000001, -3.6000000000000005, -3.7000000000000006, -3.400000000000001, -3.500000000000001, -3.3000000000000007, -3.1000000000000005, -3.4000000000000004, -3.400000000000001, -3.3000000000000007, -3.4000000000000004, -3.600000000000001, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.400000000000001, -3.3000000000000003, -3.4000000000000004, -3.600000000000001, -11.3, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -11.700000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 9, 21, 7, 21, 21, 15, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 15, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 9, 5, 21, 21, 3, 21, 21, 21, 18, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.535138583847067, "mean_inference_ms": 17.45278668762821, "mean_action_processing_ms": 0.916310775619105, "mean_env_wait_ms": 2.180659680384849, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0694922726563733, "StateBufferConnector_ms": 0.008934435218271582, "ViewRequirementAgentConnector_ms": 0.12897108540390478}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 171032.378, "load_time_ms": 1.14, "load_throughput": 3507236.391, "learn_time_ms": 170059.822, "learn_throughput": 23.521, "synch_weights_time_ms": 197.569}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": false, "episodes_total": 10327, "training_iteration": 50, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-06_23-18-21", "timestamp": 1680815901, "time_this_iter_s": 171.10544443130493, "time_total_s": 8553.558482646942, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476d74f0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01474de310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 8553.558482646942, "timesteps_since_restore": 0, "iterations_since_restore": 50, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.361475409836066, "ram_util_percent": 24.200409836065564}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2765752540961388, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.0010000000000000005, "total_loss": 0.3483865069906398, "policy_loss": -0.03318739743923308, "vf_loss": 0.35883909602278985, "vf_explained_var": 0.5639346177859973, "kl": 0.013306154169753113, "entropy": 3.762576585943981, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 46965.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "sampler_results": {"episode_reward_max": 98.6, "episode_reward_min": -12.3, "episode_reward_mean": -2.916500000000001, "episode_len_mean": 20.2, "episode_media": {}, "episodes_this_iter": 200, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.4000000000000004, -3.100000000000001, -3.400000000000001, -3.400000000000001, -3.2000000000000006, -3.2, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -10.7, -3.5000000000000004, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -12.0, -3.2, -3.2000000000000006, -3.3000000000000003, -3.4000000000000004, -3.2, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -11.7, -3.4000000000000012, -3.4000000000000004, -3.5000000000000004, -3.400000000000001, -3.4000000000000004, -3.3000000000000007, 97.7, -3.1000000000000005, -3.400000000000001, -3.400000000000001, -3.3000000000000003, -3.0000000000000004, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.500000000000001, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.500000000000001, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.3000000000000003, -3.1000000000000005, -10.6, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.6000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.6000000000000005, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -12.0, -3.3000000000000007, -3.3000000000000003, -11.0, -3.500000000000001, -3.400000000000001, -3.2000000000000006, -10.8, -3.500000000000001, -11.0, -3.500000000000001, -3.2000000000000006, -3.500000000000001, -3.3000000000000007, -12.3, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -3.6000000000000005, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.200000000000001, -3.3000000000000003, -3.400000000000001, -3.400000000000001, -10.5, -11.6, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -11.2, -10.2, -3.7000000000000006, -3.2000000000000006, -3.3000000000000007, -3.4000000000000004, -3.3000000000000007, -3.4000000000000004, -3.6000000000000005, -3.4000000000000004, -3.3000000000000003, -3.5000000000000004, -3.3000000000000003, -3.200000000000001, -3.3000000000000003, -3.400000000000001, -3.2, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -10.0, -3.400000000000001, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.400000000000001, -3.3000000000000007, -3.2, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.4000000000000004, -3.1000000000000005, -3.4000000000000004, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, 98.6, -3.3000000000000003, -3.7000000000000006, -10.7, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.600000000000001, -3.2, -3.500000000000001, -3.1000000000000005, -12.1, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.2, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.700000000000001, -3.4000000000000004, -3.600000000000001, -3.6000000000000005, -3.3000000000000007, -3.300000000000001, -3.900000000000001, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.2000000000000006, -3.5000000000000004, -3.5000000000000004, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.500000000000001, -3.600000000000001, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.100000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 11, 21, 21, 21, 8, 21, 11, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 16, 21, 21, 21, 13, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.523284529612184, "mean_inference_ms": 17.445393513512307, "mean_action_processing_ms": 0.9160896730002647, "mean_env_wait_ms": 2.177013835991048, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0752643346786499, "StateBufferConnector_ms": 0.009243965148925781, "ViewRequirementAgentConnector_ms": 0.13760602474212646}}, "episode_reward_max": 98.6, "episode_reward_min": -12.3, "episode_reward_mean": -2.916500000000001, "episode_len_mean": 20.2, "episodes_this_iter": 200, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.4000000000000004, -3.100000000000001, -3.400000000000001, -3.400000000000001, -3.2000000000000006, -3.2, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -10.7, -3.5000000000000004, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -12.0, -3.2, -3.2000000000000006, -3.3000000000000003, -3.4000000000000004, -3.2, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -11.7, -3.4000000000000012, -3.4000000000000004, -3.5000000000000004, -3.400000000000001, -3.4000000000000004, -3.3000000000000007, 97.7, -3.1000000000000005, -3.400000000000001, -3.400000000000001, -3.3000000000000003, -3.0000000000000004, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.500000000000001, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.500000000000001, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.3000000000000003, -3.1000000000000005, -10.6, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.6000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.6000000000000005, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -12.0, -3.3000000000000007, -3.3000000000000003, -11.0, -3.500000000000001, -3.400000000000001, -3.2000000000000006, -10.8, -3.500000000000001, -11.0, -3.500000000000001, -3.2000000000000006, -3.500000000000001, -3.3000000000000007, -12.3, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -3.6000000000000005, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.200000000000001, -3.3000000000000003, -3.400000000000001, -3.400000000000001, -10.5, -11.6, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -11.2, -10.2, -3.7000000000000006, -3.2000000000000006, -3.3000000000000007, -3.4000000000000004, -3.3000000000000007, -3.4000000000000004, -3.6000000000000005, -3.4000000000000004, -3.3000000000000003, -3.5000000000000004, -3.3000000000000003, -3.200000000000001, -3.3000000000000003, -3.400000000000001, -3.2, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -10.0, -3.400000000000001, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.400000000000001, -3.3000000000000007, -3.2, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.4000000000000004, -3.1000000000000005, -3.4000000000000004, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, 98.6, -3.3000000000000003, -3.7000000000000006, -10.7, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.600000000000001, -3.2, -3.500000000000001, -3.1000000000000005, -12.1, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.2, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.700000000000001, -3.4000000000000004, -3.600000000000001, -3.6000000000000005, -3.3000000000000007, -3.300000000000001, -3.900000000000001, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.2000000000000006, -3.5000000000000004, -3.5000000000000004, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.500000000000001, -3.600000000000001, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.100000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 11, 21, 21, 21, 8, 21, 11, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 16, 21, 21, 21, 13, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.523284529612184, "mean_inference_ms": 17.445393513512307, "mean_action_processing_ms": 0.9160896730002647, "mean_env_wait_ms": 2.177013835991048, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0752643346786499, "StateBufferConnector_ms": 0.009243965148925781, "ViewRequirementAgentConnector_ms": 0.13760602474212646}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 204000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 204000, "timers": {"training_iteration_time_ms": 171028.03, "load_time_ms": 1.136, "load_throughput": 3521961.542, "learn_time_ms": 170054.866, "learn_throughput": 23.522, "synch_weights_time_ms": 197.092}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "done": false, "episodes_total": 10527, "training_iteration": 51, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-06_23-21-11", "timestamp": 1680816071, "time_this_iter_s": 170.63060092926025, "time_total_s": 8724.189083576202, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476f20d0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014754d9d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 8724.189083576202, "timesteps_since_restore": 0, "iterations_since_restore": 51, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.476859504132231, "ram_util_percent": 24.134710743801655}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1761312880102666, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.0010000000000000005, "total_loss": 0.2803086055462719, "policy_loss": -0.029822787842763366, "vf_loss": 0.2939344103918761, "vf_explained_var": 0.6038797017066709, "kl": 0.009479715546088603, "entropy": 3.766834637426561, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 47895.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "sampler_results": {"episode_reward_max": 98.0, "episode_reward_min": -12.1, "episode_reward_mean": -2.7585, "episode_len_mean": 20.34, "episode_media": {}, "episodes_this_iter": 200, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.400000000000001, -3.3000000000000007, -3.4000000000000004, -3.3000000000000007, -3.500000000000001, -3.4000000000000012, -3.2000000000000006, -3.2000000000000006, -3.5000000000000004, -3.400000000000001, -3.2000000000000006, -3.100000000000001, -11.600000000000001, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.500000000000001, -3.400000000000001, -3.6000000000000005, -3.3000000000000007, -3.3000000000000003, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.4000000000000012, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.300000000000001, -3.3000000000000007, -3.1000000000000005, -3.400000000000001, -3.3000000000000003, -3.400000000000001, -3.400000000000001, -10.4, -3.2000000000000006, -3.400000000000001, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -10.4, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.2, -3.5000000000000004, -3.400000000000001, -3.6000000000000005, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.6000000000000005, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.4000000000000004, -3.400000000000001, -3.5000000000000004, 98.0, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -10.7, -10.0, -3.1000000000000005, -3.500000000000001, -3.6000000000000005, -3.3000000000000007, -3.2000000000000006, -3.6000000000000005, -3.2000000000000006, -3.2, -3.4000000000000004, -3.3000000000000007, -3.500000000000001, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.100000000000001, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.600000000000001, -11.4, -3.1000000000000005, -3.400000000000001, -3.5000000000000004, -3.8000000000000007, -3.0000000000000004, 98.0, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.500000000000001, -3.5000000000000004, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.5000000000000004, -3.4000000000000004, -3.3000000000000007, -10.3, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.500000000000001, -3.400000000000001, -3.100000000000001, -3.2000000000000006, -3.3000000000000003, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.500000000000001, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.500000000000001, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.2, -3.2000000000000006, -3.3000000000000003, -3.600000000000001, -3.500000000000001, -3.400000000000001, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.600000000000001, -3.1000000000000005, -3.600000000000001, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.2, -3.2000000000000006, -3.3000000000000003, -3.6000000000000005, -3.2000000000000006, -3.5000000000000004, -3.400000000000001, -3.300000000000001, -12.1, -3.3000000000000007, -12.0, -3.4000000000000004, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.300000000000001, -3.4000000000000004, -3.400000000000001, -11.700000000000001, -3.200000000000001, -10.9, -3.2, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -11.6, -3.400000000000001, -3.500000000000001, -3.3000000000000003, -3.2000000000000006, -3.400000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 8, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 9, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.51552691629137, "mean_inference_ms": 17.427637855326406, "mean_action_processing_ms": 0.9162247742058335, "mean_env_wait_ms": 2.177741792085192, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08263969421386719, "StateBufferConnector_ms": 0.009674787521362305, "ViewRequirementAgentConnector_ms": 0.14473533630371094}}, "episode_reward_max": 98.0, "episode_reward_min": -12.1, "episode_reward_mean": -2.7585, "episode_len_mean": 20.34, "episodes_this_iter": 200, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.400000000000001, -3.3000000000000007, -3.4000000000000004, -3.3000000000000007, -3.500000000000001, -3.4000000000000012, -3.2000000000000006, -3.2000000000000006, -3.5000000000000004, -3.400000000000001, -3.2000000000000006, -3.100000000000001, -11.600000000000001, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.500000000000001, -3.400000000000001, -3.6000000000000005, -3.3000000000000007, -3.3000000000000003, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.4000000000000012, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.300000000000001, -3.3000000000000007, -3.1000000000000005, -3.400000000000001, -3.3000000000000003, -3.400000000000001, -3.400000000000001, -10.4, -3.2000000000000006, -3.400000000000001, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -10.4, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.2, -3.5000000000000004, -3.400000000000001, -3.6000000000000005, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.6000000000000005, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.4000000000000004, -3.400000000000001, -3.5000000000000004, 98.0, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -10.7, -10.0, -3.1000000000000005, -3.500000000000001, -3.6000000000000005, -3.3000000000000007, -3.2000000000000006, -3.6000000000000005, -3.2000000000000006, -3.2, -3.4000000000000004, -3.3000000000000007, -3.500000000000001, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.100000000000001, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.600000000000001, -11.4, -3.1000000000000005, -3.400000000000001, -3.5000000000000004, -3.8000000000000007, -3.0000000000000004, 98.0, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.500000000000001, -3.5000000000000004, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.5000000000000004, -3.4000000000000004, -3.3000000000000007, -10.3, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.500000000000001, -3.400000000000001, -3.100000000000001, -3.2000000000000006, -3.3000000000000003, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.500000000000001, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.500000000000001, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.2, -3.2000000000000006, -3.3000000000000003, -3.600000000000001, -3.500000000000001, -3.400000000000001, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.600000000000001, -3.1000000000000005, -3.600000000000001, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.2, -3.2000000000000006, -3.3000000000000003, -3.6000000000000005, -3.2000000000000006, -3.5000000000000004, -3.400000000000001, -3.300000000000001, -12.1, -3.3000000000000007, -12.0, -3.4000000000000004, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.300000000000001, -3.4000000000000004, -3.400000000000001, -11.700000000000001, -3.200000000000001, -10.9, -3.2, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -11.6, -3.400000000000001, -3.500000000000001, -3.3000000000000003, -3.2000000000000006, -3.400000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 8, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 9, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.51552691629137, "mean_inference_ms": 17.427637855326406, "mean_action_processing_ms": 0.9162247742058335, "mean_env_wait_ms": 2.177741792085192, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08263969421386719, "StateBufferConnector_ms": 0.009674787521362305, "ViewRequirementAgentConnector_ms": 0.14473533630371094}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 170939.578, "load_time_ms": 1.148, "load_throughput": 3484654.177, "learn_time_ms": 169965.035, "learn_throughput": 23.534, "synch_weights_time_ms": 194.542}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "episodes_total": 10727, "training_iteration": 52, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-06_23-24-02", "timestamp": 1680816242, "time_this_iter_s": 170.7703742980957, "time_total_s": 8894.959457874298, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01477a32e0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014754daf0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 8894.959457874298, "timesteps_since_restore": 0, "iterations_since_restore": 52, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.4037037037037035, "ram_util_percent": 24.138271604938268}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.287541611925248, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.0010000000000000005, "total_loss": 0.30309058250809306, "policy_loss": -0.05540214308427387, "vf_loss": 0.34071698699306735, "vf_explained_var": 0.6101919450426614, "kl": 0.010403724101632433, "entropy": 3.7686415157010478, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 48825.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000}, "sampler_results": {"episode_reward_max": 99.2, "episode_reward_min": -11.8, "episode_reward_mean": -3.4231958762886605, "episode_len_mean": 20.082474226804123, "episode_media": {}, "episodes_this_iter": 194, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.600000000000001, -3.500000000000001, -3.4000000000000004, -3.2000000000000006, -11.6, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.3000000000000003, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.500000000000001, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.4000000000000004, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.500000000000001, -3.100000000000001, -3.500000000000001, -3.5000000000000004, -3.2, -3.4000000000000004, -3.2, -3.2, -3.2, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.5000000000000004, -3.400000000000001, -3.6000000000000005, -3.2, -3.1000000000000005, -10.8, -3.5000000000000004, -11.700000000000001, -10.2, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.3000000000000003, -3.6000000000000005, -3.3000000000000007, -3.3000000000000003, -3.500000000000001, -3.5, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.500000000000001, -3.1000000000000005, -3.5000000000000004, -10.6, -3.1000000000000005, -10.6, -3.3000000000000003, -3.2000000000000006, -10.3, -11.0, -11.8, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.2, -3.3000000000000003, -3.3000000000000007, -3.6000000000000005, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.6, -3.0000000000000004, -3.400000000000001, -3.4000000000000004, -3.500000000000001, -3.6000000000000005, -3.2000000000000006, -3.500000000000001, -3.5000000000000004, -3.500000000000001, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.500000000000001, -3.0000000000000004, -3.3000000000000003, -3.3000000000000007, -3.5000000000000004, -3.2000000000000006, -3.500000000000001, -3.1000000000000005, -3.4000000000000004, -3.4000000000000004, -10.6, -11.7, -3.3000000000000007, -3.3000000000000007, -3.500000000000001, -3.2000000000000006, -3.6000000000000005, -3.500000000000001, -3.400000000000001, -3.400000000000001, -3.2, -3.1000000000000005, 99.2, -3.700000000000001, -3.4000000000000004, -3.3000000000000007, -3.2, -3.500000000000001, -3.3000000000000003, -3.5000000000000004, -3.400000000000001, -3.6000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.500000000000001, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.4000000000000004, -3.6000000000000005, -10.9, -3.1000000000000005, -3.3000000000000007, -3.5000000000000004, -3.5000000000000004, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.200000000000001, -11.5, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.4000000000000004, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -11.0, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.500000000000001, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.4000000000000012, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.700000000000001, -3.2, -3.3000000000000003, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.300000000000001, -3.400000000000001, -3.100000000000001, -3.3000000000000007, -3.400000000000001, -10.9, -3.600000000000001, -3.1000000000000005, -3.1000000000000005, -3.2, -11.2], "episode_lengths": [21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 17, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 7, 21, 21, 4, 11, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 12]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.522817889465175, "mean_inference_ms": 17.447067431550497, "mean_action_processing_ms": 0.9161997213478272, "mean_env_wait_ms": 2.1799054445536026, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07138768422234919, "StateBufferConnector_ms": 0.009117421415663258, "ViewRequirementAgentConnector_ms": 0.13414154347685195}}, "episode_reward_max": 99.2, "episode_reward_min": -11.8, "episode_reward_mean": -3.4231958762886605, "episode_len_mean": 20.082474226804123, "episodes_this_iter": 194, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.600000000000001, -3.500000000000001, -3.4000000000000004, -3.2000000000000006, -11.6, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.3000000000000003, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.500000000000001, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.4000000000000004, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.500000000000001, -3.100000000000001, -3.500000000000001, -3.5000000000000004, -3.2, -3.4000000000000004, -3.2, -3.2, -3.2, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.5000000000000004, -3.400000000000001, -3.6000000000000005, -3.2, -3.1000000000000005, -10.8, -3.5000000000000004, -11.700000000000001, -10.2, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.3000000000000003, -3.6000000000000005, -3.3000000000000007, -3.3000000000000003, -3.500000000000001, -3.5, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.500000000000001, -3.1000000000000005, -3.5000000000000004, -10.6, -3.1000000000000005, -10.6, -3.3000000000000003, -3.2000000000000006, -10.3, -11.0, -11.8, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.2, -3.3000000000000003, -3.3000000000000007, -3.6000000000000005, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.6, -3.0000000000000004, -3.400000000000001, -3.4000000000000004, -3.500000000000001, -3.6000000000000005, -3.2000000000000006, -3.500000000000001, -3.5000000000000004, -3.500000000000001, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.500000000000001, -3.0000000000000004, -3.3000000000000003, -3.3000000000000007, -3.5000000000000004, -3.2000000000000006, -3.500000000000001, -3.1000000000000005, -3.4000000000000004, -3.4000000000000004, -10.6, -11.7, -3.3000000000000007, -3.3000000000000007, -3.500000000000001, -3.2000000000000006, -3.6000000000000005, -3.500000000000001, -3.400000000000001, -3.400000000000001, -3.2, -3.1000000000000005, 99.2, -3.700000000000001, -3.4000000000000004, -3.3000000000000007, -3.2, -3.500000000000001, -3.3000000000000003, -3.5000000000000004, -3.400000000000001, -3.6000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.500000000000001, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.4000000000000004, -3.6000000000000005, -10.9, -3.1000000000000005, -3.3000000000000007, -3.5000000000000004, -3.5000000000000004, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.200000000000001, -11.5, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.4000000000000004, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -11.0, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.500000000000001, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.4000000000000012, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.700000000000001, -3.2, -3.3000000000000003, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.300000000000001, -3.400000000000001, -3.100000000000001, -3.3000000000000007, -3.400000000000001, -10.9, -3.600000000000001, -3.1000000000000005, -3.1000000000000005, -3.2, -11.2], "episode_lengths": [21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 17, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 7, 21, 21, 4, 11, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 12]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.522817889465175, "mean_inference_ms": 17.447067431550497, "mean_action_processing_ms": 0.9161997213478272, "mean_env_wait_ms": 2.1799054445536026, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07138768422234919, "StateBufferConnector_ms": 0.009117421415663258, "ViewRequirementAgentConnector_ms": 0.13414154347685195}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 212000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 212000, "timers": {"training_iteration_time_ms": 171010.962, "load_time_ms": 1.146, "load_throughput": 3491252.939, "learn_time_ms": 170039.431, "learn_throughput": 23.524, "synch_weights_time_ms": 193.585}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000}, "done": false, "episodes_total": 10921, "training_iteration": 53, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-06_23-26-54", "timestamp": 1680816414, "time_this_iter_s": 171.57333755493164, "time_total_s": 9066.53279542923, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01477914c0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014754d820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 9066.53279542923, "timesteps_since_restore": 0, "iterations_since_restore": 53, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.671721311475411, "ram_util_percent": 24.104098360655744}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3505893907720044, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.0010000000000000005, "total_loss": 0.47726034321271443, "policy_loss": -0.06312155059453661, "vf_loss": 0.5189238985950347, "vf_explained_var": 0.5052482708167004, "kl": 0.01255886523767815, "entropy": 3.7584104586673037, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 49755.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "sampler_results": {"episode_reward_max": 99.9, "episode_reward_min": -12.100000000000001, "episode_reward_mean": -3.9276190476190473, "episode_len_mean": 19.233333333333334, "episode_media": {}, "episodes_this_iter": 210, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.2, -3.3000000000000007, -10.6, -3.7000000000000006, -3.500000000000001, -3.1000000000000005, -3.1000000000000005, -3.6000000000000005, -3.1000000000000005, -3.5000000000000004, -11.4, -3.5000000000000004, -3.3000000000000007, -3.400000000000001, -3.4000000000000004, -3.500000000000001, -3.500000000000001, -3.4000000000000012, -3.5000000000000004, -3.1000000000000005, -3.100000000000001, -11.1, -3.1000000000000005, -3.3000000000000003, -3.3000000000000003, -3.2, -3.0000000000000004, -3.5000000000000004, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -10.0, -3.100000000000001, -3.1000000000000005, -3.3000000000000007, -10.9, 99.9, -3.400000000000001, -10.5, -3.2000000000000006, -3.2, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.2, -3.3000000000000007, -3.100000000000001, -3.2000000000000006, -3.5000000000000004, -3.4000000000000004, -3.4000000000000004, -3.400000000000001, -3.400000000000001, -3.6000000000000005, -3.500000000000001, -3.1000000000000005, -3.2000000000000006, -11.2, -3.3000000000000003, -3.500000000000001, -3.1000000000000005, -3.4000000000000004, -3.3000000000000007, -3.500000000000001, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.2, -3.3000000000000003, -3.3000000000000007, -3.4000000000000004, -3.500000000000001, -3.6000000000000005, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.5000000000000004, -10.5, -3.600000000000001, -3.2000000000000006, -3.400000000000001, -10.1, -3.4000000000000004, -3.6000000000000005, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.4000000000000004, -3.3000000000000007, -3.500000000000001, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -10.9, -3.3000000000000007, -3.3000000000000007, -3.200000000000001, -3.3000000000000007, -3.0000000000000004, -11.0, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.5000000000000004, -3.500000000000001, -10.3, -10.4, -3.7000000000000006, -3.3000000000000007, -10.2, -3.2000000000000006, -3.200000000000001, -10.0, -3.2000000000000006, -3.0000000000000004, -12.100000000000001, -10.5, -10.9, -3.5000000000000004, -3.4000000000000012, -3.400000000000001, -3.600000000000001, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.4000000000000004, -10.8, -3.3000000000000007, -3.5000000000000013, -3.6000000000000005, -3.5000000000000004, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.500000000000001, -3.2000000000000006, -3.7000000000000006, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.4000000000000004, -3.3000000000000007, -3.3000000000000003, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.4000000000000004, -11.8, -12.0, -3.3000000000000003, -10.5, -3.2000000000000006, -3.800000000000001, -11.2, -11.9, -12.0, -3.3000000000000007, -10.6, -3.500000000000001, -3.2000000000000006, -3.8000000000000007, -11.8, -3.500000000000001, -3.3000000000000007, -3.5000000000000004, -3.6000000000000014, -3.9000000000000012, -3.400000000000001, -3.4000000000000004, -3.1000000000000005, -3.5000000000000004, -3.5000000000000004, -3.5000000000000013, -3.2, -3.3000000000000007, -3.400000000000001, -3.600000000000001, -3.2000000000000006, -3.6000000000000005, -3.3000000000000007, -10.6, -3.1000000000000005, -3.2000000000000006, -3.6000000000000005, -3.6000000000000005, -3.500000000000001, -3.300000000000001, -3.300000000000001, -10.6], "episode_lengths": [12, 21, 7, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21, 21, 21, 8, 2, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 5, 21, 21, 3, 21, 21, 1, 21, 21, 20, 5, 8, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 17, 21, 6, 21, 21, 12, 17, 18, 21, 7, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 7]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.52872980548907, "mean_inference_ms": 17.469594099569843, "mean_action_processing_ms": 0.9173367696787038, "mean_env_wait_ms": 2.1867108163337474, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.074746949332101, "StateBufferConnector_ms": 0.009554681323823474, "ViewRequirementAgentConnector_ms": 0.1386790048508417}}, "episode_reward_max": 99.9, "episode_reward_min": -12.100000000000001, "episode_reward_mean": -3.9276190476190473, "episode_len_mean": 19.233333333333334, "episodes_this_iter": 210, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11.2, -3.3000000000000007, -10.6, -3.7000000000000006, -3.500000000000001, -3.1000000000000005, -3.1000000000000005, -3.6000000000000005, -3.1000000000000005, -3.5000000000000004, -11.4, -3.5000000000000004, -3.3000000000000007, -3.400000000000001, -3.4000000000000004, -3.500000000000001, -3.500000000000001, -3.4000000000000012, -3.5000000000000004, -3.1000000000000005, -3.100000000000001, -11.1, -3.1000000000000005, -3.3000000000000003, -3.3000000000000003, -3.2, -3.0000000000000004, -3.5000000000000004, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -10.0, -3.100000000000001, -3.1000000000000005, -3.3000000000000007, -10.9, 99.9, -3.400000000000001, -10.5, -3.2000000000000006, -3.2, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.2, -3.3000000000000007, -3.100000000000001, -3.2000000000000006, -3.5000000000000004, -3.4000000000000004, -3.4000000000000004, -3.400000000000001, -3.400000000000001, -3.6000000000000005, -3.500000000000001, -3.1000000000000005, -3.2000000000000006, -11.2, -3.3000000000000003, -3.500000000000001, -3.1000000000000005, -3.4000000000000004, -3.3000000000000007, -3.500000000000001, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.2, -3.3000000000000003, -3.3000000000000007, -3.4000000000000004, -3.500000000000001, -3.6000000000000005, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.5000000000000004, -10.5, -3.600000000000001, -3.2000000000000006, -3.400000000000001, -10.1, -3.4000000000000004, -3.6000000000000005, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.4000000000000004, -3.3000000000000007, -3.500000000000001, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -10.9, -3.3000000000000007, -3.3000000000000007, -3.200000000000001, -3.3000000000000007, -3.0000000000000004, -11.0, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.5000000000000004, -3.500000000000001, -10.3, -10.4, -3.7000000000000006, -3.3000000000000007, -10.2, -3.2000000000000006, -3.200000000000001, -10.0, -3.2000000000000006, -3.0000000000000004, -12.100000000000001, -10.5, -10.9, -3.5000000000000004, -3.4000000000000012, -3.400000000000001, -3.600000000000001, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.4000000000000004, -10.8, -3.3000000000000007, -3.5000000000000013, -3.6000000000000005, -3.5000000000000004, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.500000000000001, -3.2000000000000006, -3.7000000000000006, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.4000000000000004, -3.3000000000000007, -3.3000000000000003, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.4000000000000004, -11.8, -12.0, -3.3000000000000003, -10.5, -3.2000000000000006, -3.800000000000001, -11.2, -11.9, -12.0, -3.3000000000000007, -10.6, -3.500000000000001, -3.2000000000000006, -3.8000000000000007, -11.8, -3.500000000000001, -3.3000000000000007, -3.5000000000000004, -3.6000000000000014, -3.9000000000000012, -3.400000000000001, -3.4000000000000004, -3.1000000000000005, -3.5000000000000004, -3.5000000000000004, -3.5000000000000013, -3.2, -3.3000000000000007, -3.400000000000001, -3.600000000000001, -3.2000000000000006, -3.6000000000000005, -3.3000000000000007, -10.6, -3.1000000000000005, -3.2000000000000006, -3.6000000000000005, -3.6000000000000005, -3.500000000000001, -3.300000000000001, -3.300000000000001, -10.6], "episode_lengths": [12, 21, 7, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21, 21, 21, 8, 2, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 5, 21, 21, 3, 21, 21, 1, 21, 21, 20, 5, 8, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 17, 21, 6, 21, 21, 12, 17, 18, 21, 7, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 7]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.52872980548907, "mean_inference_ms": 17.469594099569843, "mean_action_processing_ms": 0.9173367696787038, "mean_env_wait_ms": 2.1867108163337474, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.074746949332101, "StateBufferConnector_ms": 0.009554681323823474, "ViewRequirementAgentConnector_ms": 0.1386790048508417}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 171018.258, "load_time_ms": 1.148, "load_throughput": 3484437.06, "learn_time_ms": 170043.171, "learn_throughput": 23.523, "synch_weights_time_ms": 195.245}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "done": false, "episodes_total": 11131, "training_iteration": 54, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-06_23-29-45", "timestamp": 1680816585, "time_this_iter_s": 170.85316681861877, "time_total_s": 9237.385962247849, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0147569880>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014754daf0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 9237.385962247849, "timesteps_since_restore": 0, "iterations_since_restore": 54, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.454320987654321, "ram_util_percent": 24.18806584362139}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2318905583793116, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.0010000000000000005, "total_loss": 0.3459295409173274, "policy_loss": -0.03460520016366205, "vf_loss": 0.3662590654476756, "vf_explained_var": 0.5911669737549239, "kl": 0.008355219177282115, "entropy": 3.748890713978839, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 50685.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000}, "sampler_results": {"episode_reward_max": 99.2, "episode_reward_min": -12.100000000000001, "episode_reward_mean": -3.0522388059701493, "episode_len_mean": 20.069651741293534, "episode_media": {}, "episodes_this_iter": 201, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.5000000000000004, -12.100000000000001, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.600000000000001, -3.0000000000000004, -3.300000000000001, -11.1, -3.700000000000001, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.5000000000000004, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.600000000000001, -3.200000000000001, -3.3000000000000007, -3.400000000000001, -3.5000000000000004, -3.4000000000000012, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.6000000000000005, 99.1, -11.1, -3.2000000000000006, -3.2000000000000006, -3.200000000000001, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.300000000000001, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.500000000000001, -3.400000000000001, -3.3000000000000003, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.200000000000001, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -11.4, -10.7, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.5000000000000004, -3.400000000000001, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -10.9, -3.7000000000000006, -3.2, -3.2000000000000006, -11.1, -3.3000000000000003, -3.2, -3.400000000000001, -3.1000000000000005, -11.6, -3.2000000000000006, -3.5000000000000004, -3.500000000000001, -3.400000000000001, -3.3000000000000007, -11.8, -3.400000000000001, -3.400000000000001, -3.300000000000001, -3.400000000000001, -3.3000000000000007, -3.7000000000000006, -3.2000000000000006, -3.600000000000001, -3.3000000000000007, -3.0000000000000004, -3.2, -3.2, -3.4000000000000012, -3.4000000000000004, -3.4000000000000004, -3.2, -3.3000000000000007, -3.1000000000000005, -3.500000000000001, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.4000000000000004, -3.400000000000001, -3.400000000000001, -3.5000000000000004, -3.300000000000001, -3.1000000000000005, -3.3000000000000007, -10.6, -10.9, -3.1000000000000005, -3.3000000000000007, -3.4000000000000004, -3.5000000000000004, -3.400000000000001, -10.4, -3.1000000000000005, -3.2000000000000006, -11.0, -11.5, -12.100000000000001, -3.2000000000000006, -3.400000000000001, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.4000000000000004, -3.500000000000001, -3.3000000000000007, -3.700000000000001, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.2000000000000006, -3.7000000000000006, -3.2, -3.400000000000001, -3.7000000000000006, -11.9, -3.2, -3.7000000000000006, -3.400000000000001, -3.1000000000000005, -3.500000000000001, -3.2000000000000006, -3.600000000000001, -3.1000000000000005, -3.1000000000000005, -11.2, -3.400000000000001, -3.5000000000000004, -3.600000000000001, -3.500000000000001, -3.400000000000001, 99.2, -3.400000000000001, -3.0000000000000004, -3.3000000000000003, -3.2, -3.400000000000001, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.200000000000001, -3.400000000000001, -3.3000000000000003, -3.3000000000000007, -3.400000000000001, -3.3000000000000003, -3.400000000000001, -3.7000000000000006, -3.600000000000001, -3.400000000000001, -3.2, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.2, -3.0000000000000004, -3.2000000000000006, -3.2, -3.2000000000000006, -3.400000000000001, -3.500000000000001, -3.400000000000001, -3.400000000000001, -3.5000000000000004, -11.0, -11.8, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.4000000000000004, -3.6000000000000005], "episode_lengths": [21, 19, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 10, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 9, 21, 21, 21, 21, 21, 4, 21, 21, 11, 15, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 18, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.534160518060594, "mean_inference_ms": 17.45795922424994, "mean_action_processing_ms": 0.9165144406879916, "mean_env_wait_ms": 2.1839233732864103, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07808054264505111, "StateBufferConnector_ms": 0.009809323211214435, "ViewRequirementAgentConnector_ms": 0.14987098636911877}}, "episode_reward_max": 99.2, "episode_reward_min": -12.100000000000001, "episode_reward_mean": -3.0522388059701493, "episode_len_mean": 20.069651741293534, "episodes_this_iter": 201, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.5000000000000004, -12.100000000000001, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.600000000000001, -3.0000000000000004, -3.300000000000001, -11.1, -3.700000000000001, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.5000000000000004, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.600000000000001, -3.200000000000001, -3.3000000000000007, -3.400000000000001, -3.5000000000000004, -3.4000000000000012, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.6000000000000005, 99.1, -11.1, -3.2000000000000006, -3.2000000000000006, -3.200000000000001, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.300000000000001, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.500000000000001, -3.400000000000001, -3.3000000000000003, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.200000000000001, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -11.4, -10.7, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.5000000000000004, -3.400000000000001, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -10.9, -3.7000000000000006, -3.2, -3.2000000000000006, -11.1, -3.3000000000000003, -3.2, -3.400000000000001, -3.1000000000000005, -11.6, -3.2000000000000006, -3.5000000000000004, -3.500000000000001, -3.400000000000001, -3.3000000000000007, -11.8, -3.400000000000001, -3.400000000000001, -3.300000000000001, -3.400000000000001, -3.3000000000000007, -3.7000000000000006, -3.2000000000000006, -3.600000000000001, -3.3000000000000007, -3.0000000000000004, -3.2, -3.2, -3.4000000000000012, -3.4000000000000004, -3.4000000000000004, -3.2, -3.3000000000000007, -3.1000000000000005, -3.500000000000001, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.4000000000000004, -3.400000000000001, -3.400000000000001, -3.5000000000000004, -3.300000000000001, -3.1000000000000005, -3.3000000000000007, -10.6, -10.9, -3.1000000000000005, -3.3000000000000007, -3.4000000000000004, -3.5000000000000004, -3.400000000000001, -10.4, -3.1000000000000005, -3.2000000000000006, -11.0, -11.5, -12.100000000000001, -3.2000000000000006, -3.400000000000001, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.4000000000000004, -3.500000000000001, -3.3000000000000007, -3.700000000000001, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.2000000000000006, -3.7000000000000006, -3.2, -3.400000000000001, -3.7000000000000006, -11.9, -3.2, -3.7000000000000006, -3.400000000000001, -3.1000000000000005, -3.500000000000001, -3.2000000000000006, -3.600000000000001, -3.1000000000000005, -3.1000000000000005, -11.2, -3.400000000000001, -3.5000000000000004, -3.600000000000001, -3.500000000000001, -3.400000000000001, 99.2, -3.400000000000001, -3.0000000000000004, -3.3000000000000003, -3.2, -3.400000000000001, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.200000000000001, -3.400000000000001, -3.3000000000000003, -3.3000000000000007, -3.400000000000001, -3.3000000000000003, -3.400000000000001, -3.7000000000000006, -3.600000000000001, -3.400000000000001, -3.2, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.2, -3.0000000000000004, -3.2000000000000006, -3.2, -3.2000000000000006, -3.400000000000001, -3.500000000000001, -3.400000000000001, -3.400000000000001, -3.5000000000000004, -11.0, -11.8, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.4000000000000004, -3.6000000000000005], "episode_lengths": [21, 19, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 10, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 9, 21, 21, 21, 21, 21, 4, 21, 21, 11, 15, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 18, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.534160518060594, "mean_inference_ms": 17.45795922424994, "mean_action_processing_ms": 0.9165144406879916, "mean_env_wait_ms": 2.1839233732864103, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07808054264505111, "StateBufferConnector_ms": 0.009809323211214435, "ViewRequirementAgentConnector_ms": 0.14987098636911877}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 220000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 220000, "timers": {"training_iteration_time_ms": 171035.939, "load_time_ms": 1.152, "load_throughput": 3471315.719, "learn_time_ms": 170068.014, "learn_throughput": 23.52, "synch_weights_time_ms": 194.006}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000}, "done": false, "episodes_total": 11332, "training_iteration": 55, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-06_23-32-36", "timestamp": 1680816756, "time_this_iter_s": 170.92433643341064, "time_total_s": 9408.31029868126, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476f2e20>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014754d9d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 9408.31029868126, "timesteps_since_restore": 0, "iterations_since_restore": 55, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.420164609053497, "ram_util_percent": 24.201234567901224}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1320389816036789, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.0010000000000000005, "total_loss": 0.4703046626181051, "policy_loss": -0.046071396746562535, "vf_loss": 0.5001398193439649, "vf_explained_var": 0.5218238420383905, "kl": 0.009502693745576756, "entropy": 3.745664943161831, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 51615.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "sampler_results": {"episode_reward_max": 99.1, "episode_reward_min": -12.3, "episode_reward_mean": -3.664646464646465, "episode_len_mean": 19.914141414141415, "episode_media": {}, "episodes_this_iter": 198, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3000000000000003, -3.300000000000001, -3.700000000000001, -3.700000000000001, -3.400000000000001, -3.5000000000000004, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.2, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.500000000000001, -3.500000000000001, -3.3000000000000007, -11.8, -3.500000000000001, -11.0, -3.3000000000000007, -3.4000000000000004, -3.400000000000001, -3.400000000000001, -3.600000000000001, -11.6, -3.0000000000000004, -3.400000000000001, -3.5000000000000004, -3.300000000000001, -3.100000000000001, -3.1000000000000005, -3.1000000000000005, -10.3, -3.300000000000001, -3.2000000000000006, -3.2, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -11.4, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -12.3, -3.3000000000000003, -3.3000000000000003, -3.4000000000000004, -3.500000000000001, -3.3000000000000007, -3.2000000000000006, -10.3, -3.3000000000000007, -3.4000000000000012, -3.5000000000000004, -3.7000000000000006, -12.100000000000001, -10.9, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.2, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -3.5000000000000004, -3.4000000000000012, -3.4000000000000012, -3.3000000000000003, -3.3000000000000007, -3.200000000000001, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.4000000000000004, -11.700000000000001, -3.4000000000000004, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -11.1, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.500000000000001, -3.2000000000000006, -10.7, -11.3, -3.500000000000001, -11.7, -10.9, -3.1000000000000005, -10.4, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -11.5, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -11.7, -3.2000000000000006, -3.5000000000000004, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.600000000000001, -11.4, -3.400000000000001, -3.500000000000001, -3.6000000000000005, -3.0000000000000004, -3.3000000000000007, -3.600000000000001, -3.400000000000001, -3.3000000000000007, -3.4000000000000004, -3.3000000000000007, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, 99.1, -3.2000000000000006, -3.500000000000001, -3.3000000000000003, -3.400000000000001, -3.2000000000000006, -10.8, -10.9, -3.500000000000001, -3.3000000000000007, -3.2000000000000006, -10.6, -3.3000000000000003, -3.5000000000000004, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.4000000000000004, -3.4000000000000004, -3.300000000000001, -3.5000000000000013, -3.6000000000000005, -3.6000000000000005, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.5000000000000004, -3.400000000000001, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.600000000000001, -3.3000000000000007, -3.500000000000001, -3.3000000000000003, -3.2000000000000006, -3.5000000000000004, -3.500000000000001, -3.2000000000000006, -3.200000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 11, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 20, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 12, 21, 16, 9, 21, 5, 21, 21, 21, 14, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 9, 10, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.529992554681224, "mean_inference_ms": 17.45724987397857, "mean_action_processing_ms": 0.9161735749895418, "mean_env_wait_ms": 2.1837944038272252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06940328713619348, "StateBufferConnector_ms": 0.008957915835910372, "ViewRequirementAgentConnector_ms": 0.12929969363742405}}, "episode_reward_max": 99.1, "episode_reward_min": -12.3, "episode_reward_mean": -3.664646464646465, "episode_len_mean": 19.914141414141415, "episodes_this_iter": 198, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.3000000000000003, -3.300000000000001, -3.700000000000001, -3.700000000000001, -3.400000000000001, -3.5000000000000004, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.2, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.500000000000001, -3.500000000000001, -3.3000000000000007, -11.8, -3.500000000000001, -11.0, -3.3000000000000007, -3.4000000000000004, -3.400000000000001, -3.400000000000001, -3.600000000000001, -11.6, -3.0000000000000004, -3.400000000000001, -3.5000000000000004, -3.300000000000001, -3.100000000000001, -3.1000000000000005, -3.1000000000000005, -10.3, -3.300000000000001, -3.2000000000000006, -3.2, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -11.4, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -12.3, -3.3000000000000003, -3.3000000000000003, -3.4000000000000004, -3.500000000000001, -3.3000000000000007, -3.2000000000000006, -10.3, -3.3000000000000007, -3.4000000000000012, -3.5000000000000004, -3.7000000000000006, -12.100000000000001, -10.9, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.2, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -3.5000000000000004, -3.4000000000000012, -3.4000000000000012, -3.3000000000000003, -3.3000000000000007, -3.200000000000001, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.4000000000000004, -11.700000000000001, -3.4000000000000004, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -11.1, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.500000000000001, -3.2000000000000006, -10.7, -11.3, -3.500000000000001, -11.7, -10.9, -3.1000000000000005, -10.4, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -11.5, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -11.7, -3.2000000000000006, -3.5000000000000004, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.600000000000001, -11.4, -3.400000000000001, -3.500000000000001, -3.6000000000000005, -3.0000000000000004, -3.3000000000000007, -3.600000000000001, -3.400000000000001, -3.3000000000000007, -3.4000000000000004, -3.3000000000000007, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, 99.1, -3.2000000000000006, -3.500000000000001, -3.3000000000000003, -3.400000000000001, -3.2000000000000006, -10.8, -10.9, -3.500000000000001, -3.3000000000000007, -3.2000000000000006, -10.6, -3.3000000000000003, -3.5000000000000004, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.4000000000000004, -3.4000000000000004, -3.300000000000001, -3.5000000000000013, -3.6000000000000005, -3.6000000000000005, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.5000000000000004, -3.400000000000001, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.600000000000001, -3.3000000000000007, -3.500000000000001, -3.3000000000000003, -3.2000000000000006, -3.5000000000000004, -3.500000000000001, -3.2000000000000006, -3.200000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 11, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 20, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 12, 21, 16, 9, 21, 5, 21, 21, 21, 14, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 9, 10, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.529992554681224, "mean_inference_ms": 17.45724987397857, "mean_action_processing_ms": 0.9161735749895418, "mean_env_wait_ms": 2.1837944038272252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06940328713619348, "StateBufferConnector_ms": 0.008957915835910372, "ViewRequirementAgentConnector_ms": 0.12929969363742405}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 171078.483, "load_time_ms": 1.131, "load_throughput": 3535320.297, "learn_time_ms": 170059.151, "learn_throughput": 23.521, "synch_weights_time_ms": 246.751}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "episodes_total": 11530, "training_iteration": 56, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-06_23-35-27", "timestamp": 1680816927, "time_this_iter_s": 171.64804697036743, "time_total_s": 9579.958345651627, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7effc0948c70>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014754daf0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 9579.958345651627, "timesteps_since_restore": 0, "iterations_since_restore": 56, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.6245901639344265, "ram_util_percent": 24.12172131147541}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2676579329916227, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.0010000000000000005, "total_loss": 0.31586384829384107, "policy_loss": -0.027440330690187302, "vf_loss": 0.3251406835417153, "vf_explained_var": 0.5903144690939175, "kl": 0.010630669146219159, "entropy": 3.7411908888047742, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 52545.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "sampler_results": {"episode_reward_max": 98.4, "episode_reward_min": -12.2, "episode_reward_mean": -3.3040000000000003, "episode_len_mean": 20.45, "episode_media": {}, "episodes_this_iter": 200, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.300000000000001, -3.3000000000000007, -3.4000000000000004, -3.1000000000000005, -3.100000000000001, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.500000000000001, -3.400000000000001, -3.3000000000000003, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -11.4, -3.4000000000000004, -10.9, -3.3000000000000003, -3.2000000000000006, -11.0, -3.400000000000001, -3.3000000000000007, -3.500000000000001, -3.4000000000000004, -3.3000000000000003, -3.2000000000000006, -3.300000000000001, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.500000000000001, -3.400000000000001, -3.3000000000000007, -3.4000000000000004, -11.5, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.6000000000000005, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.200000000000001, -3.400000000000001, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -11.0, -3.2000000000000006, -3.2000000000000006, -3.500000000000001, -11.6, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.0000000000000004, -3.3000000000000007, -3.400000000000001, -10.7, -3.0000000000000004, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.2, -3.3000000000000007, -3.4000000000000004, -3.0000000000000004, -3.5000000000000004, -3.3000000000000007, -3.500000000000001, -12.2, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.500000000000001, -3.3000000000000003, -3.2000000000000006, -3.5000000000000004, -3.3000000000000007, -3.3000000000000007, -10.7, -3.3000000000000007, -11.6, -3.3000000000000003, -3.1000000000000005, -3.2, -3.3000000000000007, -3.300000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.4000000000000012, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.2, -3.3000000000000003, -10.5, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.5000000000000004, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.4000000000000004, -3.3000000000000003, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.200000000000001, -3.400000000000001, -3.8000000000000003, -3.2000000000000006, -3.3000000000000007, -11.600000000000001, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.5000000000000004, -3.1000000000000005, -3.5000000000000004, -3.4000000000000004, -3.400000000000001, -3.4000000000000012, -3.4000000000000004, -3.400000000000001, -3.1000000000000005, -3.500000000000001, 98.4, -3.2000000000000006, -3.3000000000000007, -3.4000000000000012, -3.2000000000000006, -3.3000000000000003, -3.200000000000001, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.5000000000000004, -3.2, -3.4000000000000004, -3.5000000000000004, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.200000000000001, -12.100000000000001, -3.500000000000001, -3.8000000000000007, -3.3000000000000003, -3.400000000000001, -3.1000000000000005, -3.4000000000000004, -3.3000000000000007, -3.400000000000001, -3.7000000000000006, -3.400000000000001, -3.1000000000000005, -3.400000000000001, -3.4000000000000004, -3.500000000000001, -3.6, -3.600000000000001, -3.2000000000000006, -3.2000000000000006, -3.500000000000001, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.5000000000000004], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 10, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.53304788483328, "mean_inference_ms": 17.451001996016103, "mean_action_processing_ms": 0.9157954800243863, "mean_env_wait_ms": 2.1833020809133465, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0711510181427002, "StateBufferConnector_ms": 0.008834481239318848, "ViewRequirementAgentConnector_ms": 0.1311805248260498}}, "episode_reward_max": 98.4, "episode_reward_min": -12.2, "episode_reward_mean": -3.3040000000000003, "episode_len_mean": 20.45, "episodes_this_iter": 200, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.300000000000001, -3.3000000000000007, -3.4000000000000004, -3.1000000000000005, -3.100000000000001, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.500000000000001, -3.400000000000001, -3.3000000000000003, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -11.4, -3.4000000000000004, -10.9, -3.3000000000000003, -3.2000000000000006, -11.0, -3.400000000000001, -3.3000000000000007, -3.500000000000001, -3.4000000000000004, -3.3000000000000003, -3.2000000000000006, -3.300000000000001, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.500000000000001, -3.400000000000001, -3.3000000000000007, -3.4000000000000004, -11.5, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.6000000000000005, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.200000000000001, -3.400000000000001, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -11.0, -3.2000000000000006, -3.2000000000000006, -3.500000000000001, -11.6, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.0000000000000004, -3.3000000000000007, -3.400000000000001, -10.7, -3.0000000000000004, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.2, -3.3000000000000007, -3.4000000000000004, -3.0000000000000004, -3.5000000000000004, -3.3000000000000007, -3.500000000000001, -12.2, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.500000000000001, -3.3000000000000003, -3.2000000000000006, -3.5000000000000004, -3.3000000000000007, -3.3000000000000007, -10.7, -3.3000000000000007, -11.6, -3.3000000000000003, -3.1000000000000005, -3.2, -3.3000000000000007, -3.300000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.4000000000000012, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.2, -3.3000000000000003, -10.5, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.5000000000000004, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.4000000000000004, -3.3000000000000003, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.200000000000001, -3.400000000000001, -3.8000000000000003, -3.2000000000000006, -3.3000000000000007, -11.600000000000001, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.5000000000000004, -3.1000000000000005, -3.5000000000000004, -3.4000000000000004, -3.400000000000001, -3.4000000000000012, -3.4000000000000004, -3.400000000000001, -3.1000000000000005, -3.500000000000001, 98.4, -3.2000000000000006, -3.3000000000000007, -3.4000000000000012, -3.2000000000000006, -3.3000000000000003, -3.200000000000001, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.5000000000000004, -3.2, -3.4000000000000004, -3.5000000000000004, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.200000000000001, -12.100000000000001, -3.500000000000001, -3.8000000000000007, -3.3000000000000003, -3.400000000000001, -3.1000000000000005, -3.4000000000000004, -3.3000000000000007, -3.400000000000001, -3.7000000000000006, -3.400000000000001, -3.1000000000000005, -3.400000000000001, -3.4000000000000004, -3.500000000000001, -3.6, -3.600000000000001, -3.2000000000000006, -3.2000000000000006, -3.500000000000001, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.5000000000000004], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 10, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.53304788483328, "mean_inference_ms": 17.451001996016103, "mean_action_processing_ms": 0.9157954800243863, "mean_env_wait_ms": 2.1833020809133465, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0711510181427002, "StateBufferConnector_ms": 0.008834481239318848, "ViewRequirementAgentConnector_ms": 0.1311805248260498}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 228000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 228000, "timers": {"training_iteration_time_ms": 171018.661, "load_time_ms": 1.121, "load_throughput": 3566736.681, "learn_time_ms": 169998.982, "learn_throughput": 23.53, "synch_weights_time_ms": 248.025}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "done": false, "episodes_total": 11730, "training_iteration": 57, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-06_23-38-18", "timestamp": 1680817098, "time_this_iter_s": 170.47323942184448, "time_total_s": 9750.431585073471, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f014746edf0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014754d820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 9750.431585073471, "timesteps_since_restore": 0, "iterations_since_restore": 57, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.38641975308642, "ram_util_percent": 24.160082304526743}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3328785300735504, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.0010000000000000005, "total_loss": 0.557818497538877, "policy_loss": -0.03616080215605732, "vf_loss": 0.576939293920433, "vf_explained_var": 0.47896318788169534, "kl": 0.009973116940239779, "entropy": 3.7563118045048047, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 53475.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "sampler_results": {"episode_reward_max": 99.4, "episode_reward_min": -12.200000000000001, "episode_reward_mean": -3.233830845771145, "episode_len_mean": 19.756218905472636, "episode_media": {}, "episodes_this_iter": 201, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.500000000000001, -3.600000000000001, -3.3000000000000007, -3.5000000000000004, -3.2000000000000006, -3.1000000000000005, -3.5000000000000004, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -11.2, -3.3000000000000003, -3.100000000000001, -3.2000000000000006, -11.8, -3.2000000000000006, -12.200000000000001, -3.3000000000000007, -3.4000000000000004, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.5, -3.2, -3.1000000000000005, -3.4000000000000004, -3.3000000000000003, -10.7, -10.9, -11.3, -3.1000000000000005, -3.5000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.7000000000000006, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.3000000000000003, -3.4000000000000004, -3.3000000000000007, -3.500000000000001, -3.400000000000001, -3.5000000000000004, -3.3000000000000007, -3.400000000000001, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -11.5, -3.3000000000000007, -10.4, -11.9, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -12.0, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.3000000000000003, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, 98.7, -3.400000000000001, -3.2000000000000006, -3.500000000000001, -3.600000000000001, -3.3000000000000007, -12.1, -3.4000000000000004, -3.400000000000001, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.4000000000000004, -10.9, -3.4000000000000004, -3.7000000000000006, -3.200000000000001, -11.5, -3.2000000000000006, -3.4000000000000004, -3.400000000000001, -3.0000000000000004, -3.3000000000000003, -3.2000000000000006, -3.200000000000001, -3.3000000000000007, -3.6000000000000005, -3.3000000000000007, -3.3000000000000007, -3.6000000000000005, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -3.300000000000001, -3.400000000000001, -3.400000000000001, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -11.7, -3.0000000000000004, -3.500000000000001, -3.3000000000000007, -3.3000000000000007, -3.3000000000000003, -3.2, -3.900000000000001, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -10.8, -10.5, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -10.2, -3.2000000000000006, -11.3, -3.2000000000000006, -11.2, -3.500000000000001, -3.500000000000001, -3.2000000000000006, -10.8, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.200000000000001, -3.400000000000001, -10.5, -11.8, -3.2, -3.3000000000000007, -3.500000000000001, -3.7000000000000006, -3.2000000000000006, -3.2, -3.3000000000000007, -3.3000000000000003, -3.4000000000000004, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.3000000000000007, -3.4000000000000004, -11.0, -3.100000000000001, -3.3000000000000003, -3.3000000000000007, -3.3000000000000007, -3.200000000000001, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.500000000000001, -3.600000000000001, -3.400000000000001, -3.2000000000000006, -3.7000000000000006, -3.8000000000000007, -3.200000000000001, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.4000000000000004, -3.1000000000000005, -3.4000000000000004, -10.3, 99.4, -3.2000000000000006, -3.3000000000000003, -3.4000000000000004, -3.3000000000000007, -3.6000000000000005, -3.200000000000001, -3.2000000000000006], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 19, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 9, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 5, 18, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 6, 21, 21, 21, 21, 21, 21, 3, 21, 14, 21, 12, 21, 21, 21, 7, 21, 21, 21, 21, 21, 6, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 7, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.53831398466198, "mean_inference_ms": 17.44417989933053, "mean_action_processing_ms": 0.9151141680437207, "mean_env_wait_ms": 2.185832423213172, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07023028473355877, "StateBufferConnector_ms": 0.00922739209227301, "ViewRequirementAgentConnector_ms": 0.13036704182031736}}, "episode_reward_max": 99.4, "episode_reward_min": -12.200000000000001, "episode_reward_mean": -3.233830845771145, "episode_len_mean": 19.756218905472636, "episodes_this_iter": 201, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.500000000000001, -3.600000000000001, -3.3000000000000007, -3.5000000000000004, -3.2000000000000006, -3.1000000000000005, -3.5000000000000004, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -11.2, -3.3000000000000003, -3.100000000000001, -3.2000000000000006, -11.8, -3.2000000000000006, -12.200000000000001, -3.3000000000000007, -3.4000000000000004, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.5, -3.2, -3.1000000000000005, -3.4000000000000004, -3.3000000000000003, -10.7, -10.9, -11.3, -3.1000000000000005, -3.5000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.7000000000000006, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.3000000000000003, -3.4000000000000004, -3.3000000000000007, -3.500000000000001, -3.400000000000001, -3.5000000000000004, -3.3000000000000007, -3.400000000000001, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -11.5, -3.3000000000000007, -10.4, -11.9, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -12.0, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.3000000000000003, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, 98.7, -3.400000000000001, -3.2000000000000006, -3.500000000000001, -3.600000000000001, -3.3000000000000007, -12.1, -3.4000000000000004, -3.400000000000001, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.4000000000000004, -10.9, -3.4000000000000004, -3.7000000000000006, -3.200000000000001, -11.5, -3.2000000000000006, -3.4000000000000004, -3.400000000000001, -3.0000000000000004, -3.3000000000000003, -3.2000000000000006, -3.200000000000001, -3.3000000000000007, -3.6000000000000005, -3.3000000000000007, -3.3000000000000007, -3.6000000000000005, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -3.300000000000001, -3.400000000000001, -3.400000000000001, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -11.7, -3.0000000000000004, -3.500000000000001, -3.3000000000000007, -3.3000000000000007, -3.3000000000000003, -3.2, -3.900000000000001, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -10.8, -10.5, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -10.2, -3.2000000000000006, -11.3, -3.2000000000000006, -11.2, -3.500000000000001, -3.500000000000001, -3.2000000000000006, -10.8, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.200000000000001, -3.400000000000001, -10.5, -11.8, -3.2, -3.3000000000000007, -3.500000000000001, -3.7000000000000006, -3.2000000000000006, -3.2, -3.3000000000000007, -3.3000000000000003, -3.4000000000000004, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.3000000000000007, -3.4000000000000004, -11.0, -3.100000000000001, -3.3000000000000003, -3.3000000000000007, -3.3000000000000007, -3.200000000000001, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.500000000000001, -3.600000000000001, -3.400000000000001, -3.2000000000000006, -3.7000000000000006, -3.8000000000000007, -3.200000000000001, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.4000000000000004, -3.1000000000000005, -3.4000000000000004, -10.3, 99.4, -3.2000000000000006, -3.3000000000000003, -3.4000000000000004, -3.3000000000000007, -3.6000000000000005, -3.200000000000001, -3.2000000000000006], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 19, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 9, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 5, 18, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 6, 21, 21, 21, 21, 21, 21, 3, 21, 14, 21, 12, 21, 21, 21, 7, 21, 21, 21, 21, 21, 6, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 7, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.53831398466198, "mean_inference_ms": 17.44417989933053, "mean_action_processing_ms": 0.9151141680437207, "mean_env_wait_ms": 2.185832423213172, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07023028473355877, "StateBufferConnector_ms": 0.00922739209227301, "ViewRequirementAgentConnector_ms": 0.13036704182031736}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 232000, "timers": {"training_iteration_time_ms": 171036.539, "load_time_ms": 1.118, "load_throughput": 3576773.973, "learn_time_ms": 170019.025, "learn_throughput": 23.527, "synch_weights_time_ms": 247.334}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "done": false, "episodes_total": 11931, "training_iteration": 58, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-06_23-41-09", "timestamp": 1680817269, "time_this_iter_s": 170.8752613067627, "time_total_s": 9921.306846380234, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476d7400>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014772e040>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 9921.306846380234, "timesteps_since_restore": 0, "iterations_since_restore": 58, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.486008230452675, "ram_util_percent": 24.146090534979425}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1054927829933423, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.0010000000000000005, "total_loss": 0.2944456958201944, "policy_loss": -0.026871602336803493, "vf_loss": 0.30514835908518284, "vf_explained_var": 0.6210577606513936, "kl": 0.009463302523410324, "entropy": 3.7553792758654523, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 54405.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000}, "sampler_results": {"episode_reward_max": 98.2, "episode_reward_min": -12.1, "episode_reward_mean": -3.3651282051282054, "episode_len_mean": 20.41025641025641, "episode_media": {}, "episodes_this_iter": 195, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.300000000000001, -3.2000000000000006, -3.2000000000000006, -3.500000000000001, -3.2, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -11.700000000000001, -3.500000000000001, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.2, -3.3000000000000007, -3.4000000000000004, -3.2, -3.3000000000000007, -3.2, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.4000000000000004, -3.500000000000001, -3.400000000000001, -3.2000000000000006, -3.4000000000000004, -3.5000000000000004, -3.400000000000001, -3.6000000000000005, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.2, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.500000000000001, -3.3000000000000007, -3.1000000000000005, -3.2, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -11.3, -3.400000000000001, -3.400000000000001, -3.500000000000001, -3.3000000000000007, -3.4000000000000004, -3.1000000000000005, -3.100000000000001, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.200000000000001, -3.1000000000000005, -3.1000000000000005, -11.8, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.100000000000001, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, 98.2, -3.300000000000001, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.100000000000001, -3.5000000000000004, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -3.500000000000001, -3.600000000000001, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.3000000000000007, -3.5000000000000004, -3.1000000000000005, -3.4000000000000004, -3.5000000000000004, -3.400000000000001, -3.3000000000000007, -3.3000000000000003, -3.400000000000001, -3.3000000000000007, -3.2, -3.4000000000000004, -3.2000000000000006, -3.4000000000000004, -3.400000000000001, -3.6000000000000005, -3.2000000000000006, -3.4000000000000004, -3.5000000000000004, -3.3000000000000007, -3.3000000000000003, -3.100000000000001, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.100000000000001, -3.200000000000001, -3.3000000000000007, -10.0, -3.400000000000001, -12.0, -3.5000000000000004, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.4000000000000004, -3.400000000000001, -11.7, -12.1, -3.500000000000001, -10.6, -3.400000000000001, -3.3000000000000007, -3.500000000000001, -3.3000000000000007, -11.4, -3.2000000000000006, -3.4000000000000004, -10.8, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.6000000000000005, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.4000000000000004, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, -3.500000000000001, -3.2000000000000006, -3.3000000000000003, -3.4000000000000004, -3.1000000000000005, -3.2, -3.3000000000000007, -11.9, -11.5, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.600000000000001, -3.1000000000000005, -3.8000000000000007, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -11.3, -3.500000000000001, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -3.5000000000000004, -3.3000000000000003, -3.4000000000000004, -3.200000000000001, -3.500000000000001, -3.2000000000000006, -3.3000000000000007, -3.600000000000001, -3.500000000000001, -3.500000000000001, -3.600000000000001, -3.400000000000001, -3.3000000000000007, -10.4, -3.2000000000000006], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 20, 21, 7, 21, 21, 21, 21, 15, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.544153776773218, "mean_inference_ms": 17.448360008548338, "mean_action_processing_ms": 0.9157919910127532, "mean_env_wait_ms": 2.184820984755687, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07239818572998047, "StateBufferConnector_ms": 0.008958180745442709, "ViewRequirementAgentConnector_ms": 0.13224369440323266}}, "episode_reward_max": 98.2, "episode_reward_min": -12.1, "episode_reward_mean": -3.3651282051282054, "episode_len_mean": 20.41025641025641, "episodes_this_iter": 195, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.300000000000001, -3.2000000000000006, -3.2000000000000006, -3.500000000000001, -3.2, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -11.700000000000001, -3.500000000000001, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.2, -3.3000000000000007, -3.4000000000000004, -3.2, -3.3000000000000007, -3.2, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.4000000000000004, -3.500000000000001, -3.400000000000001, -3.2000000000000006, -3.4000000000000004, -3.5000000000000004, -3.400000000000001, -3.6000000000000005, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.2, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.500000000000001, -3.3000000000000007, -3.1000000000000005, -3.2, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -11.3, -3.400000000000001, -3.400000000000001, -3.500000000000001, -3.3000000000000007, -3.4000000000000004, -3.1000000000000005, -3.100000000000001, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.200000000000001, -3.1000000000000005, -3.1000000000000005, -11.8, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.100000000000001, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, 98.2, -3.300000000000001, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.100000000000001, -3.5000000000000004, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -3.500000000000001, -3.600000000000001, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.3000000000000007, -3.5000000000000004, -3.1000000000000005, -3.4000000000000004, -3.5000000000000004, -3.400000000000001, -3.3000000000000007, -3.3000000000000003, -3.400000000000001, -3.3000000000000007, -3.2, -3.4000000000000004, -3.2000000000000006, -3.4000000000000004, -3.400000000000001, -3.6000000000000005, -3.2000000000000006, -3.4000000000000004, -3.5000000000000004, -3.3000000000000007, -3.3000000000000003, -3.100000000000001, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.100000000000001, -3.200000000000001, -3.3000000000000007, -10.0, -3.400000000000001, -12.0, -3.5000000000000004, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.4000000000000004, -3.400000000000001, -11.7, -12.1, -3.500000000000001, -10.6, -3.400000000000001, -3.3000000000000007, -3.500000000000001, -3.3000000000000007, -11.4, -3.2000000000000006, -3.4000000000000004, -10.8, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.6000000000000005, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.4000000000000004, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, -3.500000000000001, -3.2000000000000006, -3.3000000000000003, -3.4000000000000004, -3.1000000000000005, -3.2, -3.3000000000000007, -11.9, -11.5, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.600000000000001, -3.1000000000000005, -3.8000000000000007, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -11.3, -3.500000000000001, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -3.5000000000000004, -3.3000000000000003, -3.4000000000000004, -3.200000000000001, -3.500000000000001, -3.2000000000000006, -3.3000000000000007, -3.600000000000001, -3.500000000000001, -3.500000000000001, -3.600000000000001, -3.400000000000001, -3.3000000000000007, -10.4, -3.2000000000000006], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 20, 21, 7, 21, 21, 21, 21, 15, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.544153776773218, "mean_inference_ms": 17.448360008548338, "mean_action_processing_ms": 0.9157919910127532, "mean_env_wait_ms": 2.184820984755687, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07239818572998047, "StateBufferConnector_ms": 0.008958180745442709, "ViewRequirementAgentConnector_ms": 0.13224369440323266}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 236000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 236000, "timers": {"training_iteration_time_ms": 170952.495, "load_time_ms": 1.122, "load_throughput": 3566205.973, "learn_time_ms": 169940.099, "learn_throughput": 23.538, "synch_weights_time_ms": 247.513}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000}, "done": false, "episodes_total": 12126, "training_iteration": 59, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-06_23-44-00", "timestamp": 1680817440, "time_this_iter_s": 170.78609466552734, "time_total_s": 10092.092941045761, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476597f0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0147464dc0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 10092.092941045761, "timesteps_since_restore": 0, "iterations_since_restore": 59, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.364197530864198, "ram_util_percent": 24.187654320987647}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.415103982212723, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.0010000000000000005, "total_loss": 0.28352105999065025, "policy_loss": -0.0940231702951414, "vf_loss": 0.34888421409733356, "vf_explained_var": 0.6276480187011021, "kl": 0.016774038980359472, "entropy": 3.7543235348116966, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 55335.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.3, "episode_reward_mean": -4.02974358974359, "episode_len_mean": 20.138461538461538, "episode_media": {}, "episodes_this_iter": 195, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -3.600000000000001, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.500000000000001, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.4, -3.4000000000000004, -10.9, -10.6, -3.3000000000000007, -3.2, -3.3000000000000007, -3.1000000000000005, -3.2, -3.500000000000001, -3.1000000000000005, -10.6, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.200000000000001, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.3000000000000003, -3.1000000000000005, -3.3000000000000003, -3.4000000000000004, -3.5000000000000004, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.100000000000001, -3.1000000000000005, -3.0000000000000004, -3.2, -3.400000000000001, -10.0, -3.3000000000000003, -3.3000000000000007, -3.4000000000000004, -3.500000000000001, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.500000000000001, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.2, -11.9, -3.3000000000000007, -3.2000000000000006, -10.6, -3.3000000000000007, -3.3000000000000003, -3.200000000000001, -3.3000000000000007, -3.400000000000001, -3.2, -3.100000000000001, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -11.8, -3.3000000000000003, -3.2000000000000006, -3.500000000000001, -3.500000000000001, -3.4000000000000004, -3.3000000000000007, -3.5000000000000004, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.4000000000000004, -3.5000000000000004, -3.400000000000001, -3.3000000000000007, -10.7, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2, -3.3000000000000003, -3.1000000000000005, -3.600000000000001, -3.0000000000000004, -3.5000000000000004, -3.4000000000000004, -3.5000000000000004, -3.3000000000000007, -3.4000000000000004, -3.600000000000001, -3.3000000000000003, -3.500000000000001, -11.700000000000001, -3.400000000000001, -3.400000000000001, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -11.2, -3.2000000000000006, -3.0000000000000004, -3.4000000000000012, -10.8, -3.3000000000000007, -3.4000000000000004, -11.700000000000001, -12.3, -3.500000000000001, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -11.6, -11.3, -3.5000000000000004, -3.3000000000000007, -3.3000000000000003, -3.4000000000000004, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.200000000000001, -3.3000000000000007, -11.5, -3.100000000000001, -3.500000000000001, -3.1000000000000005, -3.400000000000001, -3.6000000000000005, -3.500000000000001, -3.600000000000001, -3.3000000000000007, -3.2, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.200000000000001, -3.400000000000001, -3.3000000000000007, -3.3000000000000003, -11.3, -3.5000000000000004, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.500000000000001, -3.4000000000000004, -3.600000000000001, -3.400000000000001, -3.5000000000000004, -3.2000000000000006, -3.500000000000001, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -11.2, -3.400000000000001, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 7, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 11, 21, 21, 21, 9, 21, 21, 18, 20, 21, 21, 21, 21, 15, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.554034715743397, "mean_inference_ms": 17.43050118790059, "mean_action_processing_ms": 0.9142556904438286, "mean_env_wait_ms": 2.183170852460783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07815825633513622, "StateBufferConnector_ms": 0.009643236796061197, "ViewRequirementAgentConnector_ms": 0.1434913048377404}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.3, "episode_reward_mean": -4.02974358974359, "episode_len_mean": 20.138461538461538, "episodes_this_iter": 195, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -3.600000000000001, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.500000000000001, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.4, -3.4000000000000004, -10.9, -10.6, -3.3000000000000007, -3.2, -3.3000000000000007, -3.1000000000000005, -3.2, -3.500000000000001, -3.1000000000000005, -10.6, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.200000000000001, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.3000000000000003, -3.1000000000000005, -3.3000000000000003, -3.4000000000000004, -3.5000000000000004, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.100000000000001, -3.1000000000000005, -3.0000000000000004, -3.2, -3.400000000000001, -10.0, -3.3000000000000003, -3.3000000000000007, -3.4000000000000004, -3.500000000000001, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.500000000000001, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.2, -11.9, -3.3000000000000007, -3.2000000000000006, -10.6, -3.3000000000000007, -3.3000000000000003, -3.200000000000001, -3.3000000000000007, -3.400000000000001, -3.2, -3.100000000000001, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -11.8, -3.3000000000000003, -3.2000000000000006, -3.500000000000001, -3.500000000000001, -3.4000000000000004, -3.3000000000000007, -3.5000000000000004, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.4000000000000004, -3.5000000000000004, -3.400000000000001, -3.3000000000000007, -10.7, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2, -3.3000000000000003, -3.1000000000000005, -3.600000000000001, -3.0000000000000004, -3.5000000000000004, -3.4000000000000004, -3.5000000000000004, -3.3000000000000007, -3.4000000000000004, -3.600000000000001, -3.3000000000000003, -3.500000000000001, -11.700000000000001, -3.400000000000001, -3.400000000000001, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -11.2, -3.2000000000000006, -3.0000000000000004, -3.4000000000000012, -10.8, -3.3000000000000007, -3.4000000000000004, -11.700000000000001, -12.3, -3.500000000000001, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -11.6, -11.3, -3.5000000000000004, -3.3000000000000007, -3.3000000000000003, -3.4000000000000004, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.200000000000001, -3.3000000000000007, -11.5, -3.100000000000001, -3.500000000000001, -3.1000000000000005, -3.400000000000001, -3.6000000000000005, -3.500000000000001, -3.600000000000001, -3.3000000000000007, -3.2, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.200000000000001, -3.400000000000001, -3.3000000000000007, -3.3000000000000003, -11.3, -3.5000000000000004, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.500000000000001, -3.4000000000000004, -3.600000000000001, -3.400000000000001, -3.5000000000000004, -3.2000000000000006, -3.500000000000001, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -11.2, -3.400000000000001, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 7, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 11, 21, 21, 21, 9, 21, 21, 18, 20, 21, 21, 21, 21, 15, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.554034715743397, "mean_inference_ms": 17.43050118790059, "mean_action_processing_ms": 0.9142556904438286, "mean_env_wait_ms": 2.183170852460783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07815825633513622, "StateBufferConnector_ms": 0.009643236796061197, "ViewRequirementAgentConnector_ms": 0.1434913048377404}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 170903.322, "load_time_ms": 1.117, "load_throughput": 3582425.692, "learn_time_ms": 169912.347, "learn_throughput": 23.542, "synch_weights_time_ms": 225.427}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "episodes_total": 12321, "training_iteration": 60, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-06_23-46-50", "timestamp": 1680817610, "time_this_iter_s": 170.61268210411072, "time_total_s": 10262.705623149872, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01475e2580>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014772e040>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 10262.705623149872, "timesteps_since_restore": 0, "iterations_since_restore": 60, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.571900826446281, "ram_util_percent": 24.19834710743801}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1874557309173128, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.0010000000000000005, "total_loss": 0.5674070218838351, "policy_loss": -0.04085141263541675, "vf_loss": 0.5874096116651931, "vf_explained_var": 0.6018880835784379, "kl": 0.012202328551618222, "entropy": 3.7490380305115893, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 56265.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000}, "sampler_results": {"episode_reward_max": 98.7, "episode_reward_min": -12.4, "episode_reward_mean": -2.6475247524752477, "episode_len_mean": 20.123762376237625, "episode_media": {}, "episodes_this_iter": 202, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.4000000000000004, -3.400000000000001, -3.2000000000000006, -3.3000000000000003, -11.5, 98.4, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.2000000000000006, -11.9, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.200000000000001, -3.400000000000001, -3.5000000000000004, -3.400000000000001, -3.300000000000001, -3.3000000000000007, -3.1000000000000005, -3.2, -3.300000000000001, -3.1000000000000005, -3.1000000000000005, -3.6000000000000005, -3.400000000000001, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -11.7, -10.6, 98.0, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.5000000000000004, -3.500000000000001, -10.1, -3.3000000000000007, -3.200000000000001, -3.3000000000000003, -3.3000000000000003, -3.6000000000000005, -11.4, -3.3000000000000007, -12.100000000000001, -3.2000000000000006, -11.7, -3.3000000000000007, -10.6, -3.1000000000000005, -3.2000000000000006, -3.5000000000000004, -3.400000000000001, -12.4, -3.4000000000000004, -11.5, -3.6000000000000005, -3.2000000000000006, -3.2, -3.3000000000000003, -3.6000000000000005, -3.400000000000001, -3.3000000000000003, -3.3000000000000003, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.4000000000000004, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.4000000000000004, -3.1000000000000005, -3.5000000000000004, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.400000000000001, -3.5000000000000004, -3.500000000000001, -3.2000000000000006, -3.400000000000001, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, -3.0000000000000004, -3.400000000000001, -3.1000000000000005, -3.5000000000000004, -11.9, -3.6000000000000005, -3.400000000000001, -3.500000000000001, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -11.3, -3.1000000000000005, -3.200000000000001, -3.3000000000000007, -3.5000000000000013, -3.0000000000000004, -3.3000000000000003, -3.7000000000000006, -3.2, -3.2000000000000006, -3.4000000000000012, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.400000000000001, -11.9, -11.3, -3.1000000000000005, -3.6000000000000005, -3.5000000000000004, -3.6000000000000005, -3.2000000000000006, -3.2000000000000006, -3.600000000000001, -3.3000000000000007, -3.700000000000001, -3.3000000000000007, -3.6000000000000005, -3.3000000000000003, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -11.1, -3.500000000000001, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, 98.7, -11.9, -3.4000000000000004, -3.5000000000000004, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.500000000000001, -3.2000000000000006, -3.200000000000001, -3.200000000000001, -3.2000000000000006, -11.0, -3.3000000000000003, -10.7, -10.8, -3.6000000000000005, -3.3000000000000007, -3.3000000000000007, -3.500000000000001, -3.600000000000001, -12.3, -3.3000000000000007, -3.500000000000001, -3.400000000000001, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.5000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.300000000000001, -3.2000000000000006, -3.4000000000000004, -3.500000000000001, -3.400000000000001, -3.4000000000000004, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.3000000000000003, -3.4000000000000012, -3.4000000000000004], "episode_lengths": [21, 21, 21, 21, 15, 16, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 6, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 12, 21, 20, 21, 14, 21, 7, 21, 21, 21, 21, 20, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 12, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 8, 9, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.556383588980838, "mean_inference_ms": 17.464583401141716, "mean_action_processing_ms": 0.9157810094331965, "mean_env_wait_ms": 2.187953595131209, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0781889009003592, "StateBufferConnector_ms": 0.010152146367743463, "ViewRequirementAgentConnector_ms": 0.14245356663618938}}, "episode_reward_max": 98.7, "episode_reward_min": -12.4, "episode_reward_mean": -2.6475247524752477, "episode_len_mean": 20.123762376237625, "episodes_this_iter": 202, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.4000000000000004, -3.400000000000001, -3.2000000000000006, -3.3000000000000003, -11.5, 98.4, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.2000000000000006, -11.9, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.200000000000001, -3.400000000000001, -3.5000000000000004, -3.400000000000001, -3.300000000000001, -3.3000000000000007, -3.1000000000000005, -3.2, -3.300000000000001, -3.1000000000000005, -3.1000000000000005, -3.6000000000000005, -3.400000000000001, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -11.7, -10.6, 98.0, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.5000000000000004, -3.500000000000001, -10.1, -3.3000000000000007, -3.200000000000001, -3.3000000000000003, -3.3000000000000003, -3.6000000000000005, -11.4, -3.3000000000000007, -12.100000000000001, -3.2000000000000006, -11.7, -3.3000000000000007, -10.6, -3.1000000000000005, -3.2000000000000006, -3.5000000000000004, -3.400000000000001, -12.4, -3.4000000000000004, -11.5, -3.6000000000000005, -3.2000000000000006, -3.2, -3.3000000000000003, -3.6000000000000005, -3.400000000000001, -3.3000000000000003, -3.3000000000000003, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.4000000000000004, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.4000000000000004, -3.1000000000000005, -3.5000000000000004, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.400000000000001, -3.5000000000000004, -3.500000000000001, -3.2000000000000006, -3.400000000000001, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, -3.0000000000000004, -3.400000000000001, -3.1000000000000005, -3.5000000000000004, -11.9, -3.6000000000000005, -3.400000000000001, -3.500000000000001, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -11.3, -3.1000000000000005, -3.200000000000001, -3.3000000000000007, -3.5000000000000013, -3.0000000000000004, -3.3000000000000003, -3.7000000000000006, -3.2, -3.2000000000000006, -3.4000000000000012, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.400000000000001, -11.9, -11.3, -3.1000000000000005, -3.6000000000000005, -3.5000000000000004, -3.6000000000000005, -3.2000000000000006, -3.2000000000000006, -3.600000000000001, -3.3000000000000007, -3.700000000000001, -3.3000000000000007, -3.6000000000000005, -3.3000000000000003, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -11.1, -3.500000000000001, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, 98.7, -11.9, -3.4000000000000004, -3.5000000000000004, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.500000000000001, -3.2000000000000006, -3.200000000000001, -3.200000000000001, -3.2000000000000006, -11.0, -3.3000000000000003, -10.7, -10.8, -3.6000000000000005, -3.3000000000000007, -3.3000000000000007, -3.500000000000001, -3.600000000000001, -12.3, -3.3000000000000007, -3.500000000000001, -3.400000000000001, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.5000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.300000000000001, -3.2000000000000006, -3.4000000000000004, -3.500000000000001, -3.400000000000001, -3.4000000000000004, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.3000000000000003, -3.4000000000000012, -3.4000000000000004], "episode_lengths": [21, 21, 21, 21, 15, 16, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 6, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 12, 21, 20, 21, 14, 21, 7, 21, 21, 21, 21, 20, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 12, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 8, 9, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.556383588980838, "mean_inference_ms": 17.464583401141716, "mean_action_processing_ms": 0.9157810094331965, "mean_env_wait_ms": 2.187953595131209, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0781889009003592, "StateBufferConnector_ms": 0.010152146367743463, "ViewRequirementAgentConnector_ms": 0.14245356663618938}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 244000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 244000, "timers": {"training_iteration_time_ms": 170914.784, "load_time_ms": 1.156, "load_throughput": 3461575.092, "learn_time_ms": 169916.406, "learn_throughput": 23.541, "synch_weights_time_ms": 225.654}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000}, "done": false, "episodes_total": 12523, "training_iteration": 61, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-06_23-49-41", "timestamp": 1680817781, "time_this_iter_s": 170.74538445472717, "time_total_s": 10433.451007604599, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7effc272fb20>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0147464f70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 10433.451007604599, "timesteps_since_restore": 0, "iterations_since_restore": 61, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.344444444444444, "ram_util_percent": 24.149794238683125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.363191482104281, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.0010000000000000005, "total_loss": 0.5308105986738096, "policy_loss": -0.038318339690581085, "vf_loss": 0.5572833007241609, "vf_explained_var": 0.5013716538747152, "kl": 0.00693297682371321, "entropy": 3.757105928338984, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 57195.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000}, "sampler_results": {"episode_reward_max": 98.7, "episode_reward_min": -12.4, "episode_reward_mean": -3.786274509803922, "episode_len_mean": 19.936274509803923, "episode_media": {}, "episodes_this_iter": 204, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3000000000000003, -3.400000000000001, -3.2000000000000006, -3.7000000000000006, -3.3000000000000007, -3.3000000000000007, -3.6000000000000005, -3.3000000000000007, -3.4000000000000004, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.3000000000000003, -3.5000000000000004, -3.3000000000000007, -11.6, -3.500000000000001, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.400000000000001, -3.600000000000001, -11.9, -3.3000000000000007, -11.0, -3.400000000000001, -3.400000000000001, -3.400000000000001, -11.5, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.400000000000001, -3.200000000000001, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.2, -3.0000000000000004, -3.3000000000000007, -3.6000000000000005, -3.4000000000000004, -11.5, -3.2000000000000006, -3.3000000000000007, -3.6000000000000005, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.6000000000000005, -3.400000000000001, -3.2, -10.9, -3.400000000000001, -3.500000000000001, -3.200000000000001, -3.5000000000000004, -3.2, -11.3, -3.2000000000000006, -3.1000000000000005, -3.5000000000000004, -11.8, -3.3000000000000007, -3.400000000000001, -3.4000000000000012, -3.2000000000000006, -11.6, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.3000000000000003, -3.3000000000000003, -3.4000000000000004, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -11.0, -3.1000000000000005, -3.400000000000001, -3.7000000000000006, -3.3000000000000003, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -11.3, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -11.9, -12.100000000000001, -3.400000000000001, -3.2000000000000006, -11.8, -12.4, -3.400000000000001, -3.3000000000000003, -3.400000000000001, -3.3000000000000007, -3.3000000000000003, -3.3000000000000003, -3.500000000000001, -3.3000000000000003, -3.4000000000000004, -10.8, -3.4000000000000004, -11.2, -3.2, -3.300000000000001, -10.5, -3.4000000000000004, -3.2, -3.700000000000001, -3.400000000000001, -3.2, -3.5000000000000004, -3.1000000000000005, -3.2000000000000006, -3.5000000000000004, -3.1000000000000005, -3.3000000000000003, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.400000000000001, -3.3000000000000003, -3.300000000000001, -3.3000000000000003, -3.1000000000000005, -10.1, -10.2, -11.1, -3.3000000000000003, -3.2000000000000006, -3.200000000000001, -3.400000000000001, -3.3000000000000003, -3.400000000000001, -12.0, -3.400000000000001, -3.1000000000000005, -11.5, -3.1000000000000005, -11.0, -3.400000000000001, -10.2, -3.5000000000000004, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.7000000000000006, -3.3000000000000007, -3.600000000000001, -3.4000000000000004, -3.7000000000000006, -3.3000000000000003, -3.1000000000000005, -3.5000000000000004, -3.2, -3.3000000000000003, -3.4000000000000004, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -3.5000000000000004, -3.5000000000000004, -3.500000000000001, -3.3000000000000003, -3.500000000000001, -3.200000000000001, -3.1000000000000005, -3.100000000000001, -3.400000000000001, -3.200000000000001, -3.200000000000001, 98.7], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 18, 21, 11, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 12, 21, 21, 21, 16, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 17, 20, 21, 21, 17, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 13, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 3, 12, 21, 21, 21, 21, 21, 21, 19, 21, 21, 15, 21, 10, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.54809744615614, "mean_inference_ms": 17.430793144535997, "mean_action_processing_ms": 0.9146653606286234, "mean_env_wait_ms": 2.18655341845833, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07248415666468003, "StateBufferConnector_ms": 0.00922855208901798, "ViewRequirementAgentConnector_ms": 0.1335613867815803}}, "episode_reward_max": 98.7, "episode_reward_min": -12.4, "episode_reward_mean": -3.786274509803922, "episode_len_mean": 19.936274509803923, "episodes_this_iter": 204, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.3000000000000003, -3.400000000000001, -3.2000000000000006, -3.7000000000000006, -3.3000000000000007, -3.3000000000000007, -3.6000000000000005, -3.3000000000000007, -3.4000000000000004, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.3000000000000003, -3.5000000000000004, -3.3000000000000007, -11.6, -3.500000000000001, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.400000000000001, -3.600000000000001, -11.9, -3.3000000000000007, -11.0, -3.400000000000001, -3.400000000000001, -3.400000000000001, -11.5, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.400000000000001, -3.200000000000001, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.2, -3.0000000000000004, -3.3000000000000007, -3.6000000000000005, -3.4000000000000004, -11.5, -3.2000000000000006, -3.3000000000000007, -3.6000000000000005, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.6000000000000005, -3.400000000000001, -3.2, -10.9, -3.400000000000001, -3.500000000000001, -3.200000000000001, -3.5000000000000004, -3.2, -11.3, -3.2000000000000006, -3.1000000000000005, -3.5000000000000004, -11.8, -3.3000000000000007, -3.400000000000001, -3.4000000000000012, -3.2000000000000006, -11.6, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.3000000000000003, -3.3000000000000003, -3.4000000000000004, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -11.0, -3.1000000000000005, -3.400000000000001, -3.7000000000000006, -3.3000000000000003, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -11.3, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -11.9, -12.100000000000001, -3.400000000000001, -3.2000000000000006, -11.8, -12.4, -3.400000000000001, -3.3000000000000003, -3.400000000000001, -3.3000000000000007, -3.3000000000000003, -3.3000000000000003, -3.500000000000001, -3.3000000000000003, -3.4000000000000004, -10.8, -3.4000000000000004, -11.2, -3.2, -3.300000000000001, -10.5, -3.4000000000000004, -3.2, -3.700000000000001, -3.400000000000001, -3.2, -3.5000000000000004, -3.1000000000000005, -3.2000000000000006, -3.5000000000000004, -3.1000000000000005, -3.3000000000000003, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.400000000000001, -3.3000000000000003, -3.300000000000001, -3.3000000000000003, -3.1000000000000005, -10.1, -10.2, -11.1, -3.3000000000000003, -3.2000000000000006, -3.200000000000001, -3.400000000000001, -3.3000000000000003, -3.400000000000001, -12.0, -3.400000000000001, -3.1000000000000005, -11.5, -3.1000000000000005, -11.0, -3.400000000000001, -10.2, -3.5000000000000004, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.7000000000000006, -3.3000000000000007, -3.600000000000001, -3.4000000000000004, -3.7000000000000006, -3.3000000000000003, -3.1000000000000005, -3.5000000000000004, -3.2, -3.3000000000000003, -3.4000000000000004, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -3.5000000000000004, -3.5000000000000004, -3.500000000000001, -3.3000000000000003, -3.500000000000001, -3.200000000000001, -3.1000000000000005, -3.100000000000001, -3.400000000000001, -3.200000000000001, -3.200000000000001, 98.7], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 18, 21, 11, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 12, 21, 21, 21, 16, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 17, 20, 21, 21, 17, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 13, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 3, 12, 21, 21, 21, 21, 21, 21, 19, 21, 21, 15, 21, 10, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.54809744615614, "mean_inference_ms": 17.430793144535997, "mean_action_processing_ms": 0.9146653606286234, "mean_env_wait_ms": 2.18655341845833, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07248415666468003, "StateBufferConnector_ms": 0.00922855208901798, "ViewRequirementAgentConnector_ms": 0.1335613867815803}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 248000, "timers": {"training_iteration_time_ms": 170921.444, "load_time_ms": 1.155, "load_throughput": 3462146.557, "learn_time_ms": 169922.0, "learn_throughput": 23.54, "synch_weights_time_ms": 227.574}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000}, "done": false, "episodes_total": 12727, "training_iteration": 62, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-06_23-52-32", "timestamp": 1680817952, "time_this_iter_s": 170.83753728866577, "time_total_s": 10604.288544893265, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f014746e0d0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01473d8820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 10604.288544893265, "timesteps_since_restore": 0, "iterations_since_restore": 62, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.377366255144033, "ram_util_percent": 24.197119341563777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3245392133632015, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.0010000000000000005, "total_loss": 0.34697126164952274, "policy_loss": -0.10078490130322915, "vf_loss": 0.41837206634302293, "vf_explained_var": 0.5950841858181902, "kl": 0.017197825150088324, "entropy": 3.746529914999521, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 58125.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "sampler_results": {"episode_reward_max": -3.1000000000000005, "episode_reward_min": -12.200000000000001, "episode_reward_mean": -4.046428571428572, "episode_len_mean": 20.270408163265305, "episode_media": {}, "episodes_this_iter": 196, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3000000000000003, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.3000000000000003, -12.200000000000001, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.500000000000001, -3.1000000000000005, -3.3000000000000007, -3.5000000000000004, -3.1000000000000005, -3.600000000000001, -3.3000000000000007, -3.600000000000001, -3.2, -11.5, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.500000000000001, -3.3000000000000007, -3.2000000000000006, -3.7000000000000006, -3.2, -11.1, -3.3000000000000007, -3.2000000000000006, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.5000000000000004, -10.2, -12.100000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.5000000000000004, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -12.0, -3.4000000000000004, -3.3000000000000003, -3.7000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.500000000000001, -3.600000000000001, -3.5000000000000004, -3.2000000000000006, -3.4000000000000004, -3.600000000000001, -3.1000000000000005, -3.100000000000001, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.5000000000000004, -3.400000000000001, -3.3000000000000007, -3.3000000000000003, -3.4000000000000004, -3.400000000000001, -3.4000000000000004, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -12.1, -3.3000000000000007, -3.4000000000000004, -3.500000000000001, -12.0, -3.5000000000000013, -3.400000000000001, -10.8, -3.500000000000001, -3.2000000000000006, -3.200000000000001, -3.3000000000000003, -3.6000000000000005, -3.400000000000001, -3.3000000000000007, -3.300000000000001, -3.400000000000001, -3.7000000000000006, -3.1000000000000005, -11.5, -3.1000000000000005, -3.1000000000000005, -3.600000000000001, -3.2000000000000006, -3.4000000000000012, -3.400000000000001, -3.500000000000001, -3.2000000000000006, -3.700000000000001, -3.3000000000000007, -3.6000000000000005, -3.400000000000001, -3.100000000000001, -12.0, -3.2000000000000006, -3.5000000000000004, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -10.6, -3.1000000000000005, -10.4, -3.1000000000000005, -10.3, -3.4000000000000004, -3.2000000000000006, -3.400000000000001, -3.2, -3.5000000000000004, -3.1000000000000005, -3.500000000000001, -3.2000000000000006, -11.3, -11.9, -3.5000000000000004, -3.100000000000001, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.500000000000001, -3.7000000000000006, -3.9000000000000012, -3.3000000000000003, -3.400000000000001, -3.3000000000000007, -3.5000000000000004, -3.2000000000000006, -3.200000000000001, -3.400000000000001, -3.7, -3.1000000000000005, -3.100000000000001, -3.600000000000001, -3.3000000000000007, -3.3000000000000007, -3.2, -3.1000000000000005, -3.1000000000000005, -10.6, -3.1000000000000005, -3.2, -3.600000000000001, -3.4000000000000004, -3.4000000000000004, -3.3000000000000007, -3.5, -3.1000000000000005, -11.4, -3.1000000000000005], "episode_lengths": [21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 3, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 19, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 7, 21, 5, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 12, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.54670403159541, "mean_inference_ms": 17.453128441795158, "mean_action_processing_ms": 0.9144515768107112, "mean_env_wait_ms": 2.1895334568544436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07017619755803323, "StateBufferConnector_ms": 0.008423352728084641, "ViewRequirementAgentConnector_ms": 0.1297636907927844}}, "episode_reward_max": -3.1000000000000005, "episode_reward_min": -12.200000000000001, "episode_reward_mean": -4.046428571428572, "episode_len_mean": 20.270408163265305, "episodes_this_iter": 196, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.3000000000000003, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.3000000000000003, -12.200000000000001, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.500000000000001, -3.1000000000000005, -3.3000000000000007, -3.5000000000000004, -3.1000000000000005, -3.600000000000001, -3.3000000000000007, -3.600000000000001, -3.2, -11.5, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.500000000000001, -3.3000000000000007, -3.2000000000000006, -3.7000000000000006, -3.2, -11.1, -3.3000000000000007, -3.2000000000000006, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.5000000000000004, -10.2, -12.100000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.5000000000000004, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -12.0, -3.4000000000000004, -3.3000000000000003, -3.7000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.500000000000001, -3.600000000000001, -3.5000000000000004, -3.2000000000000006, -3.4000000000000004, -3.600000000000001, -3.1000000000000005, -3.100000000000001, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.5000000000000004, -3.400000000000001, -3.3000000000000007, -3.3000000000000003, -3.4000000000000004, -3.400000000000001, -3.4000000000000004, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -12.1, -3.3000000000000007, -3.4000000000000004, -3.500000000000001, -12.0, -3.5000000000000013, -3.400000000000001, -10.8, -3.500000000000001, -3.2000000000000006, -3.200000000000001, -3.3000000000000003, -3.6000000000000005, -3.400000000000001, -3.3000000000000007, -3.300000000000001, -3.400000000000001, -3.7000000000000006, -3.1000000000000005, -11.5, -3.1000000000000005, -3.1000000000000005, -3.600000000000001, -3.2000000000000006, -3.4000000000000012, -3.400000000000001, -3.500000000000001, -3.2000000000000006, -3.700000000000001, -3.3000000000000007, -3.6000000000000005, -3.400000000000001, -3.100000000000001, -12.0, -3.2000000000000006, -3.5000000000000004, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -10.6, -3.1000000000000005, -10.4, -3.1000000000000005, -10.3, -3.4000000000000004, -3.2000000000000006, -3.400000000000001, -3.2, -3.5000000000000004, -3.1000000000000005, -3.500000000000001, -3.2000000000000006, -11.3, -11.9, -3.5000000000000004, -3.100000000000001, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.500000000000001, -3.7000000000000006, -3.9000000000000012, -3.3000000000000003, -3.400000000000001, -3.3000000000000007, -3.5000000000000004, -3.2000000000000006, -3.200000000000001, -3.400000000000001, -3.7, -3.1000000000000005, -3.100000000000001, -3.600000000000001, -3.3000000000000007, -3.3000000000000007, -3.2, -3.1000000000000005, -3.1000000000000005, -10.6, -3.1000000000000005, -3.2, -3.600000000000001, -3.4000000000000004, -3.4000000000000004, -3.3000000000000007, -3.5, -3.1000000000000005, -11.4, -3.1000000000000005], "episode_lengths": [21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 3, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 19, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 7, 21, 5, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 12, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.54670403159541, "mean_inference_ms": 17.453128441795158, "mean_action_processing_ms": 0.9144515768107112, "mean_env_wait_ms": 2.1895334568544436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07017619755803323, "StateBufferConnector_ms": 0.008423352728084641, "ViewRequirementAgentConnector_ms": 0.1297636907927844}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 252000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 252000, "timers": {"training_iteration_time_ms": 170878.101, "load_time_ms": 1.157, "load_throughput": 3458506.7, "learn_time_ms": 169849.559, "learn_throughput": 23.55, "synch_weights_time_ms": 257.873}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "done": false, "episodes_total": 12923, "training_iteration": 63, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-06_23-55-23", "timestamp": 1680818123, "time_this_iter_s": 171.13852095603943, "time_total_s": 10775.427065849304, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0147756970>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0147464160>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 10775.427065849304, "timesteps_since_restore": 0, "iterations_since_restore": 63, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.617283950617284, "ram_util_percent": 24.19999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.34274931585276, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.0010000000000000005, "total_loss": 0.3218215786551516, "policy_loss": -0.0972111444179249, "vf_loss": 0.39313712148997254, "vf_explained_var": 0.5163641817467187, "kl": 0.01515609137225716, "entropy": 3.7293756779804026, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 59055.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.2, "episode_reward_mean": -4.104477611940299, "episode_len_mean": 20.238805970149254, "episode_media": {}, "episodes_this_iter": 201, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.200000000000001, -3.400000000000001, -12.0, -3.3000000000000003, -3.3000000000000007, -3.200000000000001, -3.0000000000000004, -3.400000000000001, -3.5000000000000004, -3.500000000000001, -3.200000000000001, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.2, -3.2000000000000006, -3.1000000000000005, -3.600000000000001, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.4000000000000004, -3.700000000000001, -3.600000000000001, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.3000000000000003, -12.2, -3.4000000000000004, -3.100000000000001, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.500000000000001, -3.100000000000001, -3.3000000000000007, -3.4000000000000004, -3.400000000000001, -3.2000000000000006, -3.4000000000000012, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -10.6, -3.1000000000000005, -10.4, -3.3000000000000007, -11.3, -3.3000000000000007, -3.1000000000000005, -3.600000000000001, -3.0000000000000004, -3.4000000000000004, -3.2000000000000006, -3.0000000000000004, -10.6, -3.2000000000000006, -3.5000000000000004, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.2, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.300000000000001, -3.3000000000000007, -3.400000000000001, -3.2, -3.3000000000000007, -3.4000000000000004, -3.5000000000000004, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.500000000000001, -3.3000000000000007, -11.9, -3.2000000000000006, -11.3, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.4000000000000004, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.500000000000001, -3.4000000000000004, -3.2, -11.7, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -11.6, -3.1000000000000005, -12.0, -3.5000000000000004, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.500000000000001, -3.2000000000000006, -11.1, -3.2000000000000006, -3.600000000000001, -3.4000000000000004, -3.600000000000001, -3.1000000000000005, -3.500000000000001, -3.3000000000000007, -3.2000000000000006, -3.100000000000001, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -11.8, -3.2000000000000006, -3.400000000000001, -3.6000000000000005, -3.3000000000000007, -3.600000000000001, -3.5000000000000013, -3.2000000000000006, -11.2, -3.3000000000000007, -11.700000000000001, -3.2000000000000006, -3.1000000000000005, -3.200000000000001, -3.5000000000000004, -3.4000000000000004, -3.4000000000000004, -3.2000000000000006, -3.500000000000001, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.2, -10.6, -3.4000000000000004, -12.1, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -12.0, -3.3000000000000007, -3.7000000000000006, -3.3000000000000007, -3.3000000000000003, -3.1000000000000005, -11.3, -3.5000000000000004, -3.400000000000001, -3.100000000000001, -3.400000000000001, -3.3000000000000007, -3.600000000000001, -3.6000000000000005, -3.1000000000000005, -3.4000000000000004, -3.4000000000000004, -3.400000000000001, -3.400000000000001, -3.2000000000000006, -3.500000000000001, -3.3000000000000003, -3.4000000000000004, -3.7000000000000006, -3.200000000000001, -3.3000000000000007, -3.400000000000001, -3.2, -3.3000000000000003, -3.2000000000000006, -3.4000000000000004, -3.600000000000001, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -10.5, -3.4, -3.1000000000000005, -3.5000000000000004, -3.500000000000001], "episode_lengths": [21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 5, 21, 14, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 15, 21, 19, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 11, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 18, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.547136509986244, "mean_inference_ms": 17.449339133165918, "mean_action_processing_ms": 0.9134775371433657, "mean_env_wait_ms": 2.186234082413441, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07052113167682098, "StateBufferConnector_ms": 0.008481414756964688, "ViewRequirementAgentConnector_ms": 0.12957931157961414}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.2, "episode_reward_mean": -4.104477611940299, "episode_len_mean": 20.238805970149254, "episodes_this_iter": 201, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.200000000000001, -3.400000000000001, -12.0, -3.3000000000000003, -3.3000000000000007, -3.200000000000001, -3.0000000000000004, -3.400000000000001, -3.5000000000000004, -3.500000000000001, -3.200000000000001, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.2, -3.2000000000000006, -3.1000000000000005, -3.600000000000001, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.4000000000000004, -3.700000000000001, -3.600000000000001, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.3000000000000003, -12.2, -3.4000000000000004, -3.100000000000001, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.500000000000001, -3.100000000000001, -3.3000000000000007, -3.4000000000000004, -3.400000000000001, -3.2000000000000006, -3.4000000000000012, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -10.6, -3.1000000000000005, -10.4, -3.3000000000000007, -11.3, -3.3000000000000007, -3.1000000000000005, -3.600000000000001, -3.0000000000000004, -3.4000000000000004, -3.2000000000000006, -3.0000000000000004, -10.6, -3.2000000000000006, -3.5000000000000004, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.2, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.300000000000001, -3.3000000000000007, -3.400000000000001, -3.2, -3.3000000000000007, -3.4000000000000004, -3.5000000000000004, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.500000000000001, -3.3000000000000007, -11.9, -3.2000000000000006, -11.3, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.4000000000000004, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.500000000000001, -3.4000000000000004, -3.2, -11.7, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -11.6, -3.1000000000000005, -12.0, -3.5000000000000004, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.500000000000001, -3.2000000000000006, -11.1, -3.2000000000000006, -3.600000000000001, -3.4000000000000004, -3.600000000000001, -3.1000000000000005, -3.500000000000001, -3.3000000000000007, -3.2000000000000006, -3.100000000000001, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -11.8, -3.2000000000000006, -3.400000000000001, -3.6000000000000005, -3.3000000000000007, -3.600000000000001, -3.5000000000000013, -3.2000000000000006, -11.2, -3.3000000000000007, -11.700000000000001, -3.2000000000000006, -3.1000000000000005, -3.200000000000001, -3.5000000000000004, -3.4000000000000004, -3.4000000000000004, -3.2000000000000006, -3.500000000000001, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.2, -10.6, -3.4000000000000004, -12.1, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -12.0, -3.3000000000000007, -3.7000000000000006, -3.3000000000000007, -3.3000000000000003, -3.1000000000000005, -11.3, -3.5000000000000004, -3.400000000000001, -3.100000000000001, -3.400000000000001, -3.3000000000000007, -3.600000000000001, -3.6000000000000005, -3.1000000000000005, -3.4000000000000004, -3.4000000000000004, -3.400000000000001, -3.400000000000001, -3.2000000000000006, -3.500000000000001, -3.3000000000000003, -3.4000000000000004, -3.7000000000000006, -3.200000000000001, -3.3000000000000007, -3.400000000000001, -3.2, -3.3000000000000003, -3.2000000000000006, -3.4000000000000004, -3.600000000000001, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -10.5, -3.4, -3.1000000000000005, -3.5000000000000004, -3.500000000000001], "episode_lengths": [21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 5, 21, 14, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 15, 21, 19, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 11, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 18, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.547136509986244, "mean_inference_ms": 17.449339133165918, "mean_action_processing_ms": 0.9134775371433657, "mean_env_wait_ms": 2.186234082413441, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07052113167682098, "StateBufferConnector_ms": 0.008481414756964688, "ViewRequirementAgentConnector_ms": 0.12957931157961414}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 170815.865, "load_time_ms": 1.159, "load_throughput": 3452315.163, "learn_time_ms": 169797.358, "learn_throughput": 23.557, "synch_weights_time_ms": 255.294}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "done": false, "episodes_total": 13124, "training_iteration": 64, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-06_23-58-14", "timestamp": 1680818294, "time_this_iter_s": 170.23204565048218, "time_total_s": 10945.659111499786, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f014746e0a0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01473d8820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 10945.659111499786, "timesteps_since_restore": 0, "iterations_since_restore": 64, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.335537190082644, "ram_util_percent": 24.199999999999992}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2245333691758493, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.0010000000000000005, "total_loss": 0.4824782303744747, "policy_loss": -0.017397874861114448, "vf_loss": 0.48659330861422645, "vf_explained_var": 0.4915479633756863, "kl": 0.007774110331878527, "entropy": 3.729724515638044, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 59985.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000}, "sampler_results": {"episode_reward_max": 99.1, "episode_reward_min": -12.100000000000001, "episode_reward_mean": -2.6522613065326635, "episode_len_mean": 19.748743718592966, "episode_media": {}, "episodes_this_iter": 199, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.2000000000000006, -3.5000000000000004, -11.3, -3.2000000000000006, -3.5000000000000004, -3.3000000000000003, -11.7, -3.4, -3.2000000000000006, -12.0, -3.400000000000001, -3.400000000000001, -3.5000000000000004, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.4000000000000004, -3.3000000000000007, -3.200000000000001, -3.2000000000000006, -11.2, -3.3000000000000007, -3.3000000000000007, -3.5000000000000013, -3.4000000000000004, -3.500000000000001, -10.9, -3.7000000000000006, -10.9, -3.0000000000000004, -3.500000000000001, -3.200000000000001, -3.1000000000000005, -3.3000000000000003, -3.4000000000000004, -3.1000000000000005, -3.2, -3.3000000000000007, -3.3000000000000007, -3.0000000000000004, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -11.7, -3.4000000000000004, -3.6000000000000005, -11.5, -3.3000000000000007, -3.2000000000000006, -3.2, -11.4, -3.3000000000000003, -3.3000000000000003, -3.400000000000001, -3.2, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, 99.1, -3.0000000000000004, -3.3000000000000003, -3.200000000000001, -3.5, 98.6, -11.1, -10.4, -3.3000000000000007, -3.3000000000000003, -3.200000000000001, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.500000000000001, -3.3000000000000003, -3.400000000000001, -3.3000000000000003, -3.4000000000000012, -3.3000000000000007, -3.2, -3.2000000000000006, -3.3000000000000007, -3.2, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.2, -3.1000000000000005, -3.2000000000000006, -3.100000000000001, -3.3000000000000007, -3.1000000000000005, -11.6, -10.3, -12.100000000000001, -10.6, -10.2, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -10.4, -3.1000000000000005, -3.2000000000000006, -3.2, -10.5, -3.400000000000001, -3.2000000000000006, -10.2, -3.2000000000000006, -3.400000000000001, -3.600000000000001, -3.2000000000000006, -3.2000000000000006, -3.100000000000001, -3.2000000000000006, -12.1, -3.300000000000001, -3.4000000000000004, -3.2, -3.3000000000000007, -3.4000000000000004, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.3000000000000003, -3.4000000000000004, -3.3000000000000003, -11.0, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.4000000000000004, -3.100000000000001, -3.2000000000000006, -3.2, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -11.8, -3.3000000000000007, -3.3000000000000007, -3.5000000000000004, -3.3000000000000007, -3.4000000000000004, -3.3000000000000003, -3.400000000000001, -3.900000000000001, -3.500000000000001, -3.3000000000000007, -3.600000000000001, -3.3000000000000007, -3.0000000000000004, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.5000000000000004, -11.2, -3.5000000000000004, 99.0, -3.600000000000001, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.5000000000000004, -3.3000000000000007], "episode_lengths": [21, 21, 13, 21, 21, 21, 17, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 9, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 16, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 14, 12, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 4, 20, 7, 3, 21, 21, 21, 5, 21, 21, 21, 6, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 10, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.53932346282714, "mean_inference_ms": 17.423827331218696, "mean_action_processing_ms": 0.9131310325454794, "mean_env_wait_ms": 2.190497132985816, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07009326513089127, "StateBufferConnector_ms": 0.008817174326834367, "ViewRequirementAgentConnector_ms": 0.12901092893514202}}, "episode_reward_max": 99.1, "episode_reward_min": -12.100000000000001, "episode_reward_mean": -2.6522613065326635, "episode_len_mean": 19.748743718592966, "episodes_this_iter": 199, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.2000000000000006, -3.5000000000000004, -11.3, -3.2000000000000006, -3.5000000000000004, -3.3000000000000003, -11.7, -3.4, -3.2000000000000006, -12.0, -3.400000000000001, -3.400000000000001, -3.5000000000000004, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.4000000000000004, -3.3000000000000007, -3.200000000000001, -3.2000000000000006, -11.2, -3.3000000000000007, -3.3000000000000007, -3.5000000000000013, -3.4000000000000004, -3.500000000000001, -10.9, -3.7000000000000006, -10.9, -3.0000000000000004, -3.500000000000001, -3.200000000000001, -3.1000000000000005, -3.3000000000000003, -3.4000000000000004, -3.1000000000000005, -3.2, -3.3000000000000007, -3.3000000000000007, -3.0000000000000004, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -11.7, -3.4000000000000004, -3.6000000000000005, -11.5, -3.3000000000000007, -3.2000000000000006, -3.2, -11.4, -3.3000000000000003, -3.3000000000000003, -3.400000000000001, -3.2, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, 99.1, -3.0000000000000004, -3.3000000000000003, -3.200000000000001, -3.5, 98.6, -11.1, -10.4, -3.3000000000000007, -3.3000000000000003, -3.200000000000001, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.500000000000001, -3.3000000000000003, -3.400000000000001, -3.3000000000000003, -3.4000000000000012, -3.3000000000000007, -3.2, -3.2000000000000006, -3.3000000000000007, -3.2, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.2, -3.1000000000000005, -3.2000000000000006, -3.100000000000001, -3.3000000000000007, -3.1000000000000005, -11.6, -10.3, -12.100000000000001, -10.6, -10.2, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -10.4, -3.1000000000000005, -3.2000000000000006, -3.2, -10.5, -3.400000000000001, -3.2000000000000006, -10.2, -3.2000000000000006, -3.400000000000001, -3.600000000000001, -3.2000000000000006, -3.2000000000000006, -3.100000000000001, -3.2000000000000006, -12.1, -3.300000000000001, -3.4000000000000004, -3.2, -3.3000000000000007, -3.4000000000000004, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.3000000000000003, -3.4000000000000004, -3.3000000000000003, -11.0, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.4000000000000004, -3.100000000000001, -3.2000000000000006, -3.2, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -11.8, -3.3000000000000007, -3.3000000000000007, -3.5000000000000004, -3.3000000000000007, -3.4000000000000004, -3.3000000000000003, -3.400000000000001, -3.900000000000001, -3.500000000000001, -3.3000000000000007, -3.600000000000001, -3.3000000000000007, -3.0000000000000004, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.5000000000000004, -11.2, -3.5000000000000004, 99.0, -3.600000000000001, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.5000000000000004, -3.3000000000000007], "episode_lengths": [21, 21, 13, 21, 21, 21, 17, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 9, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 16, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 14, 12, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 4, 20, 7, 3, 21, 21, 21, 5, 21, 21, 21, 6, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 10, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.53932346282714, "mean_inference_ms": 17.423827331218696, "mean_action_processing_ms": 0.9131310325454794, "mean_env_wait_ms": 2.190497132985816, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07009326513089127, "StateBufferConnector_ms": 0.008817174326834367, "ViewRequirementAgentConnector_ms": 0.12901092893514202}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 260000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 260000, "timers": {"training_iteration_time_ms": 170827.689, "load_time_ms": 1.159, "load_throughput": 3449972.445, "learn_time_ms": 169809.642, "learn_throughput": 23.556, "synch_weights_time_ms": 255.479}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000}, "done": false, "episodes_total": 13323, "training_iteration": 65, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_00-01-05", "timestamp": 1680818465, "time_this_iter_s": 171.04242086410522, "time_total_s": 11116.701532363892, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0147740c10>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0147520700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 11116.701532363892, "timesteps_since_restore": 0, "iterations_since_restore": 65, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 6.26311475409836, "ram_util_percent": 24.099590163934423}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2562272502770346, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.0010000000000000005, "total_loss": 0.5017210660046667, "policy_loss": -0.03883808928551853, "vf_loss": 0.5280847141108606, "vf_explained_var": 0.4438168226390757, "kl": 0.007300999170007755, "entropy": 3.7357149711219213, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 60915.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "sampler_results": {"episode_reward_max": 98.4, "episode_reward_min": -12.4, "episode_reward_mean": -3.892039800995025, "episode_len_mean": 19.427860696517413, "episode_media": {}, "episodes_this_iter": 201, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.1000000000000005, -3.4000000000000004, -3.400000000000001, -3.4000000000000004, -3.500000000000001, -3.1000000000000005, -3.3000000000000003, -3.400000000000001, -3.4000000000000004, -11.5, -3.1000000000000005, -3.4000000000000004, -3.3000000000000007, -3.4000000000000004, -10.9, -3.1000000000000005, -3.500000000000001, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -11.1, -10.2, -3.2000000000000006, -3.6000000000000005, -3.2000000000000006, -3.400000000000001, -3.4000000000000004, -3.5000000000000004, -12.3, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -10.5, -3.3000000000000007, -3.300000000000001, -3.3000000000000003, -10.3, -10.1, -3.200000000000001, -3.100000000000001, -3.2000000000000006, -3.5000000000000004, -10.9, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.0000000000000004, -10.8, -3.3000000000000007, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.3000000000000003, -3.100000000000001, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -12.3, -3.200000000000001, -3.3000000000000007, -10.7, -3.300000000000001, -10.4, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -10.4, -3.400000000000001, -3.2, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -11.8, -3.3000000000000007, -3.100000000000001, -3.4000000000000004, -3.4000000000000004, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -11.1, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.500000000000001, -3.0000000000000004, -3.3000000000000003, -3.3000000000000007, -11.2, -3.600000000000001, -3.2000000000000006, -12.4, -3.2000000000000006, -3.2000000000000006, -3.300000000000001, -3.400000000000001, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.100000000000001, -11.700000000000001, -3.3000000000000007, -3.2000000000000006, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -11.0, -3.3000000000000007, -3.3000000000000007, 98.4, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -10.8, -3.2000000000000006, -3.3000000000000007, -3.500000000000001, -10.1, -10.9, -10.4, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.3000000000000003, -3.3000000000000007, -3.2, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -3.2, -3.2000000000000006, -12.0, -3.3000000000000007, -11.0, -3.600000000000001, -3.500000000000001, -3.3000000000000007, -10.9, -3.3000000000000003, -3.4000000000000004, -3.400000000000001, -3.1000000000000005, -3.5000000000000004, -3.2000000000000006, -3.3000000000000003, -10.4, -3.3000000000000003, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.3000000000000003, -12.0, -3.400000000000001, -3.5000000000000004, -3.100000000000001, -3.400000000000001, -3.4000000000000004, -3.500000000000001, -3.3000000000000007, -3.400000000000001, -3.0000000000000004, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.200000000000001, -3.0000000000000004, -3.2000000000000006, -3.5000000000000004, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.500000000000001, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 11, 3, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 4, 2, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 8, 21, 5, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 9, 21, 21, 15, 21, 21, 21, 21, 9, 21, 21, 21, 2, 8, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 11, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.529848299624833, "mean_inference_ms": 17.454694396641244, "mean_action_processing_ms": 0.9140117805928025, "mean_env_wait_ms": 2.1916920109891285, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07912424666371512, "StateBufferConnector_ms": 0.010401811172713094, "ViewRequirementAgentConnector_ms": 0.14426542158743635}}, "episode_reward_max": 98.4, "episode_reward_min": -12.4, "episode_reward_mean": -3.892039800995025, "episode_len_mean": 19.427860696517413, "episodes_this_iter": 201, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.1000000000000005, -3.4000000000000004, -3.400000000000001, -3.4000000000000004, -3.500000000000001, -3.1000000000000005, -3.3000000000000003, -3.400000000000001, -3.4000000000000004, -11.5, -3.1000000000000005, -3.4000000000000004, -3.3000000000000007, -3.4000000000000004, -10.9, -3.1000000000000005, -3.500000000000001, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -11.1, -10.2, -3.2000000000000006, -3.6000000000000005, -3.2000000000000006, -3.400000000000001, -3.4000000000000004, -3.5000000000000004, -12.3, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -10.5, -3.3000000000000007, -3.300000000000001, -3.3000000000000003, -10.3, -10.1, -3.200000000000001, -3.100000000000001, -3.2000000000000006, -3.5000000000000004, -10.9, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.0000000000000004, -10.8, -3.3000000000000007, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.3000000000000003, -3.100000000000001, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -12.3, -3.200000000000001, -3.3000000000000007, -10.7, -3.300000000000001, -10.4, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -10.4, -3.400000000000001, -3.2, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -11.8, -3.3000000000000007, -3.100000000000001, -3.4000000000000004, -3.4000000000000004, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -11.1, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.500000000000001, -3.0000000000000004, -3.3000000000000003, -3.3000000000000007, -11.2, -3.600000000000001, -3.2000000000000006, -12.4, -3.2000000000000006, -3.2000000000000006, -3.300000000000001, -3.400000000000001, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.100000000000001, -11.700000000000001, -3.3000000000000007, -3.2000000000000006, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -11.0, -3.3000000000000007, -3.3000000000000007, 98.4, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -10.8, -3.2000000000000006, -3.3000000000000007, -3.500000000000001, -10.1, -10.9, -10.4, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.3000000000000003, -3.3000000000000007, -3.2, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -3.2, -3.2000000000000006, -12.0, -3.3000000000000007, -11.0, -3.600000000000001, -3.500000000000001, -3.3000000000000007, -10.9, -3.3000000000000003, -3.4000000000000004, -3.400000000000001, -3.1000000000000005, -3.5000000000000004, -3.2000000000000006, -3.3000000000000003, -10.4, -3.3000000000000003, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.3000000000000003, -12.0, -3.400000000000001, -3.5000000000000004, -3.100000000000001, -3.400000000000001, -3.4000000000000004, -3.500000000000001, -3.3000000000000007, -3.400000000000001, -3.0000000000000004, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.200000000000001, -3.0000000000000004, -3.2000000000000006, -3.5000000000000004, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.500000000000001, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 11, 3, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 4, 2, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 8, 21, 5, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 9, 21, 21, 15, 21, 21, 21, 21, 9, 21, 21, 21, 2, 8, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 11, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.529848299624833, "mean_inference_ms": 17.454694396641244, "mean_action_processing_ms": 0.9140117805928025, "mean_env_wait_ms": 2.1916920109891285, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07912424666371512, "StateBufferConnector_ms": 0.010401811172713094, "ViewRequirementAgentConnector_ms": 0.14426542158743635}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 264000, "timers": {"training_iteration_time_ms": 170774.059, "load_time_ms": 1.161, "load_throughput": 3445225.784, "learn_time_ms": 169803.528, "learn_throughput": 23.557, "synch_weights_time_ms": 202.126}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "done": false, "episodes_total": 13524, "training_iteration": 66, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_00-03-56", "timestamp": 1680818636, "time_this_iter_s": 171.11247634887695, "time_total_s": 11287.814008712769, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f014746ed00>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014740d280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 11287.814008712769, "timesteps_since_restore": 0, "iterations_since_restore": 66, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.465432098765432, "ram_util_percent": 24.009876543209877}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3032582012555933, "cur_kl_coeff": 1.7085937499999995, "cur_lr": 0.0010000000000000005, "total_loss": 0.6147603322962119, "policy_loss": -0.12793671633166973, "vf_loss": 0.7072613267473356, "vf_explained_var": 0.48430420833249244, "kl": 0.020739698757871895, "entropy": 3.714603035937073, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 61845.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.5, "episode_reward_mean": -4.3722772277227735, "episode_len_mean": 19.91089108910891, "episode_media": {}, "episodes_this_iter": 202, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.6000000000000005, -3.2, -10.4, -3.2000000000000006, -3.4000000000000004, -3.600000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.100000000000001, -3.400000000000001, -3.4000000000000004, -3.500000000000001, -3.2000000000000006, -3.0000000000000004, -3.3000000000000003, -3.1000000000000005, -3.5000000000000004, -3.1000000000000005, -3.100000000000001, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.2, -3.400000000000001, -11.7, -11.700000000000001, -11.0, -11.1, -3.500000000000001, -3.0000000000000004, -3.400000000000001, -11.3, -3.5000000000000004, -3.0000000000000004, -3.1000000000000005, -3.200000000000001, -3.3000000000000007, -3.4000000000000004, -3.0000000000000004, -3.5000000000000013, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.0000000000000004, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.400000000000001, -12.200000000000001, -3.3000000000000003, -3.4000000000000012, -11.1, -3.4000000000000004, -3.2000000000000006, -3.400000000000001, -3.5000000000000004, -11.6, -3.400000000000001, -11.2, -3.1000000000000005, -3.4000000000000004, -3.7000000000000006, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.0000000000000004, -3.2, -10.9, -3.0000000000000004, -3.3000000000000003, -3.2, -3.500000000000001, -3.3000000000000007, -3.6000000000000005, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.5000000000000004, -10.9, -10.8, -3.400000000000001, -3.3000000000000007, -3.6000000000000005, -3.2, -3.500000000000001, -3.5000000000000004, -3.2000000000000006, -3.1000000000000005, -3.5000000000000004, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -3.4000000000000004, -3.5000000000000004, -10.0, -3.3000000000000003, -3.3000000000000007, -3.4000000000000004, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -11.0, -3.0000000000000004, -3.200000000000001, -3.4000000000000004, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.600000000000001, -10.6, -3.3000000000000003, -3.3000000000000007, -11.6, -3.100000000000001, -3.2, -3.4000000000000004, -3.5000000000000004, -11.2, -12.3, -11.4, -3.400000000000001, -12.5, -3.300000000000001, -3.400000000000001, -3.4000000000000004, -3.3000000000000003, -3.2, -3.500000000000001, -3.2000000000000006, -3.400000000000001, -3.4000000000000012, -3.5000000000000004, -11.8, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.600000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.600000000000001, -3.2000000000000006, -3.5000000000000004, -12.1, -3.400000000000001, -3.600000000000001, -3.500000000000001, -3.3000000000000007, -10.8, -12.1, -11.4, -3.4000000000000004, -3.1000000000000005, -3.3000000000000007, -3.4000000000000004, -10.6, -3.4000000000000004, -3.0000000000000004, -3.7000000000000006, -3.0000000000000004, -3.1000000000000005, -3.5000000000000004, -3.2000000000000006, -3.600000000000001, -3.400000000000001, -3.3000000000000007, -3.5000000000000004, -3.600000000000001, -3.200000000000001, -3.500000000000001, -3.4000000000000004, -3.600000000000001, -3.400000000000001, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.3000000000000007], "episode_lengths": [21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 18, 10, 11, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 12, 21, 21, 21, 21, 14, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 17, 21, 21, 21, 21, 11, 20, 12, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 9, 19, 14, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.521427249428937, "mean_inference_ms": 17.42800385209443, "mean_action_processing_ms": 0.9134284422363657, "mean_env_wait_ms": 2.1929454124337973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06977130871007939, "StateBufferConnector_ms": 0.008952853703262782, "ViewRequirementAgentConnector_ms": 0.13023791926922185}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.5, "episode_reward_mean": -4.3722772277227735, "episode_len_mean": 19.91089108910891, "episodes_this_iter": 202, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.6000000000000005, -3.2, -10.4, -3.2000000000000006, -3.4000000000000004, -3.600000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.100000000000001, -3.400000000000001, -3.4000000000000004, -3.500000000000001, -3.2000000000000006, -3.0000000000000004, -3.3000000000000003, -3.1000000000000005, -3.5000000000000004, -3.1000000000000005, -3.100000000000001, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.2, -3.400000000000001, -11.7, -11.700000000000001, -11.0, -11.1, -3.500000000000001, -3.0000000000000004, -3.400000000000001, -11.3, -3.5000000000000004, -3.0000000000000004, -3.1000000000000005, -3.200000000000001, -3.3000000000000007, -3.4000000000000004, -3.0000000000000004, -3.5000000000000013, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.0000000000000004, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.400000000000001, -12.200000000000001, -3.3000000000000003, -3.4000000000000012, -11.1, -3.4000000000000004, -3.2000000000000006, -3.400000000000001, -3.5000000000000004, -11.6, -3.400000000000001, -11.2, -3.1000000000000005, -3.4000000000000004, -3.7000000000000006, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.0000000000000004, -3.2, -10.9, -3.0000000000000004, -3.3000000000000003, -3.2, -3.500000000000001, -3.3000000000000007, -3.6000000000000005, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.5000000000000004, -10.9, -10.8, -3.400000000000001, -3.3000000000000007, -3.6000000000000005, -3.2, -3.500000000000001, -3.5000000000000004, -3.2000000000000006, -3.1000000000000005, -3.5000000000000004, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -3.4000000000000004, -3.5000000000000004, -10.0, -3.3000000000000003, -3.3000000000000007, -3.4000000000000004, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -11.0, -3.0000000000000004, -3.200000000000001, -3.4000000000000004, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.600000000000001, -10.6, -3.3000000000000003, -3.3000000000000007, -11.6, -3.100000000000001, -3.2, -3.4000000000000004, -3.5000000000000004, -11.2, -12.3, -11.4, -3.400000000000001, -12.5, -3.300000000000001, -3.400000000000001, -3.4000000000000004, -3.3000000000000003, -3.2, -3.500000000000001, -3.2000000000000006, -3.400000000000001, -3.4000000000000012, -3.5000000000000004, -11.8, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.600000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.600000000000001, -3.2000000000000006, -3.5000000000000004, -12.1, -3.400000000000001, -3.600000000000001, -3.500000000000001, -3.3000000000000007, -10.8, -12.1, -11.4, -3.4000000000000004, -3.1000000000000005, -3.3000000000000007, -3.4000000000000004, -10.6, -3.4000000000000004, -3.0000000000000004, -3.7000000000000006, -3.0000000000000004, -3.1000000000000005, -3.5000000000000004, -3.2000000000000006, -3.600000000000001, -3.400000000000001, -3.3000000000000007, -3.5000000000000004, -3.600000000000001, -3.200000000000001, -3.500000000000001, -3.4000000000000004, -3.600000000000001, -3.400000000000001, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.3000000000000007], "episode_lengths": [21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 18, 10, 11, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 12, 21, 21, 21, 21, 14, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 17, 21, 21, 21, 21, 11, 20, 12, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 9, 19, 14, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.521427249428937, "mean_inference_ms": 17.42800385209443, "mean_action_processing_ms": 0.9134284422363657, "mean_env_wait_ms": 2.1929454124337973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06977130871007939, "StateBufferConnector_ms": 0.008952853703262782, "ViewRequirementAgentConnector_ms": 0.13023791926922185}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 268000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 268000, "timers": {"training_iteration_time_ms": 170897.018, "load_time_ms": 1.166, "load_throughput": 3430502.597, "learn_time_ms": 169850.498, "learn_throughput": 23.55, "synch_weights_time_ms": 199.661}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000}, "done": false, "episodes_total": 13726, "training_iteration": 67, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_00-06-48", "timestamp": 1680818808, "time_this_iter_s": 171.7032024860382, "time_total_s": 11459.517211198807, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476b9460>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0147464160>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 11459.517211198807, "timesteps_since_restore": 0, "iterations_since_restore": 67, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.623360655737706, "ram_util_percent": 24.097950819672132}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2049340955192043, "cur_kl_coeff": 2.562890625, "cur_lr": 0.0010000000000000005, "total_loss": 0.47379279137158425, "policy_loss": -0.03408236578310294, "vf_loss": 0.4882499478386855, "vf_explained_var": 0.5476495829961633, "kl": 0.00765745078241052, "entropy": 3.7274135976709344, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 62775.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "sampler_results": {"episode_reward_max": 98.5, "episode_reward_min": -12.3, "episode_reward_mean": -3.7871921182266015, "episode_len_mean": 19.64039408866995, "episode_media": {}, "episodes_this_iter": 203, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.2, -3.3000000000000003, -3.2000000000000006, -10.5, -3.3000000000000003, -3.5000000000000004, -3.200000000000001, -3.5000000000000004, -3.1000000000000005, -3.3000000000000003, -3.400000000000001, -3.2, -3.6000000000000005, -10.7, -3.3000000000000007, -3.3000000000000007, -3.5000000000000004, -3.3000000000000003, -3.400000000000001, -3.4000000000000004, -11.5, -3.1000000000000005, -3.2, -3.400000000000001, -11.5, -3.4000000000000004, -3.1000000000000005, -3.3000000000000007, -10.7, -3.500000000000001, -11.0, -11.0, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -10.3, -10.8, -11.8, -3.1000000000000005, -3.2000000000000006, -10.1, 98.5, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.4000000000000004, -3.1000000000000005, -3.200000000000001, -3.400000000000001, -12.3, -10.5, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2, -3.3000000000000007, -3.300000000000001, -3.3000000000000007, -3.400000000000001, -3.4000000000000004, -3.400000000000001, -3.4000000000000004, -3.1000000000000005, -3.3000000000000007, -3.2, -3.2000000000000006, -11.1, -3.200000000000001, -3.1000000000000005, -3.3000000000000003, -3.400000000000001, -10.1, -3.500000000000001, -3.4000000000000004, -3.400000000000001, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.500000000000001, -3.2000000000000006, -3.4000000000000004, -3.400000000000001, -3.500000000000001, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -11.2, -3.400000000000001, -3.400000000000001, -3.4000000000000004, -3.400000000000001, -3.2000000000000006, -3.100000000000001, -3.4000000000000004, -3.3000000000000007, -3.2000000000000006, -3.700000000000001, -3.1000000000000005, -3.2000000000000006, -3.5000000000000004, -3.3000000000000003, -3.3000000000000007, -3.3000000000000007, -3.5000000000000004, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -11.3, -3.3000000000000007, -3.3000000000000007, -12.1, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -10.5, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -11.3, -3.2000000000000006, -3.400000000000001, -12.100000000000001, -10.0, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.400000000000001, -3.5, -3.600000000000001, -3.4000000000000004, -3.100000000000001, -3.200000000000001, -3.5000000000000004, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.500000000000001, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.300000000000001, -3.3000000000000007, -3.600000000000001, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.6000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -11.1, -3.5000000000000004, -3.2000000000000006, -11.3, -3.2000000000000006, -11.6, -3.2, -3.2000000000000006, -3.600000000000001, -11.5, -3.400000000000001, -3.1000000000000005, -3.400000000000001, -3.6000000000000005, -3.4000000000000004, -3.2, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.200000000000001, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.500000000000001, -3.400000000000001, -3.200000000000001, -3.4000000000000004, -3.4000000000000004, -3.600000000000001, -3.1000000000000005, -3.2, -3.400000000000001, -3.400000000000001, -3.2000000000000006], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 13, 21, 21, 21, 8, 21, 9, 11, 21, 21, 21, 4, 8, 17, 21, 21, 2, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 18, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 12, 21, 21, 20, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 13, 21, 15, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.52101638915366, "mean_inference_ms": 17.448294731995603, "mean_action_processing_ms": 0.9134378417797984, "mean_env_wait_ms": 2.196769987600145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07144594427400035, "StateBufferConnector_ms": 0.009253811953690252, "ViewRequirementAgentConnector_ms": 0.13320880570435173}}, "episode_reward_max": 98.5, "episode_reward_min": -12.3, "episode_reward_mean": -3.7871921182266015, "episode_len_mean": 19.64039408866995, "episodes_this_iter": 203, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.2, -3.3000000000000003, -3.2000000000000006, -10.5, -3.3000000000000003, -3.5000000000000004, -3.200000000000001, -3.5000000000000004, -3.1000000000000005, -3.3000000000000003, -3.400000000000001, -3.2, -3.6000000000000005, -10.7, -3.3000000000000007, -3.3000000000000007, -3.5000000000000004, -3.3000000000000003, -3.400000000000001, -3.4000000000000004, -11.5, -3.1000000000000005, -3.2, -3.400000000000001, -11.5, -3.4000000000000004, -3.1000000000000005, -3.3000000000000007, -10.7, -3.500000000000001, -11.0, -11.0, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -10.3, -10.8, -11.8, -3.1000000000000005, -3.2000000000000006, -10.1, 98.5, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.4000000000000004, -3.1000000000000005, -3.200000000000001, -3.400000000000001, -12.3, -10.5, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2, -3.3000000000000007, -3.300000000000001, -3.3000000000000007, -3.400000000000001, -3.4000000000000004, -3.400000000000001, -3.4000000000000004, -3.1000000000000005, -3.3000000000000007, -3.2, -3.2000000000000006, -11.1, -3.200000000000001, -3.1000000000000005, -3.3000000000000003, -3.400000000000001, -10.1, -3.500000000000001, -3.4000000000000004, -3.400000000000001, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.500000000000001, -3.2000000000000006, -3.4000000000000004, -3.400000000000001, -3.500000000000001, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -11.2, -3.400000000000001, -3.400000000000001, -3.4000000000000004, -3.400000000000001, -3.2000000000000006, -3.100000000000001, -3.4000000000000004, -3.3000000000000007, -3.2000000000000006, -3.700000000000001, -3.1000000000000005, -3.2000000000000006, -3.5000000000000004, -3.3000000000000003, -3.3000000000000007, -3.3000000000000007, -3.5000000000000004, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -11.3, -3.3000000000000007, -3.3000000000000007, -12.1, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -10.5, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -11.3, -3.2000000000000006, -3.400000000000001, -12.100000000000001, -10.0, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.400000000000001, -3.5, -3.600000000000001, -3.4000000000000004, -3.100000000000001, -3.200000000000001, -3.5000000000000004, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.500000000000001, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.300000000000001, -3.3000000000000007, -3.600000000000001, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.6000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -11.1, -3.5000000000000004, -3.2000000000000006, -11.3, -3.2000000000000006, -11.6, -3.2, -3.2000000000000006, -3.600000000000001, -11.5, -3.400000000000001, -3.1000000000000005, -3.400000000000001, -3.6000000000000005, -3.4000000000000004, -3.2, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.200000000000001, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.500000000000001, -3.400000000000001, -3.200000000000001, -3.4000000000000004, -3.4000000000000004, -3.600000000000001, -3.1000000000000005, -3.2, -3.400000000000001, -3.400000000000001, -3.2000000000000006], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 13, 21, 21, 21, 8, 21, 9, 11, 21, 21, 21, 4, 8, 17, 21, 21, 2, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 18, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 12, 21, 21, 20, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 13, 21, 15, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.52101638915366, "mean_inference_ms": 17.448294731995603, "mean_action_processing_ms": 0.9134378417797984, "mean_env_wait_ms": 2.196769987600145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07144594427400035, "StateBufferConnector_ms": 0.009253811953690252, "ViewRequirementAgentConnector_ms": 0.13320880570435173}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 170901.714, "load_time_ms": 1.171, "load_throughput": 3416878.679, "learn_time_ms": 169852.262, "learn_throughput": 23.55, "synch_weights_time_ms": 199.647}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "done": false, "episodes_total": 13929, "training_iteration": 68, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_00-09-39", "timestamp": 1680818979, "time_this_iter_s": 170.923278093338, "time_total_s": 11630.440489292145, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0147569bb0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0147488040>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 11630.440489292145, "timesteps_since_restore": 0, "iterations_since_restore": 68, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.417695473251028, "ram_util_percent": 24.098765432098766}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4321522862680496, "cur_kl_coeff": 2.562890625, "cur_lr": 0.0010000000000000005, "total_loss": 0.5088022064840702, "policy_loss": 0.017487059640748207, "vf_loss": 0.48015365385029823, "vf_explained_var": 0.49201595385869346, "kl": 0.004355040757906854, "entropy": 3.7194521514318324, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 63705.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "sampler_results": {"episode_reward_max": 99.2, "episode_reward_min": -12.200000000000001, "episode_reward_mean": -3.663902439024391, "episode_len_mean": 20.165853658536584, "episode_media": {}, "episodes_this_iter": 205, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.2000000000000006, -3.3000000000000007, -3.100000000000001, -3.5000000000000013, -3.3000000000000003, -3.3000000000000007, -3.400000000000001, -3.4000000000000004, -3.3000000000000007, -10.0, -11.1, -3.400000000000001, -3.3000000000000003, -3.3000000000000003, -3.1000000000000005, -3.4000000000000004, -3.200000000000001, -3.2, -3.2, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.500000000000001, -3.400000000000001, -3.0000000000000004, -11.4, -3.3000000000000003, -3.3000000000000007, -3.4000000000000004, -3.4000000000000004, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.400000000000001, -3.200000000000001, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -11.8, -3.400000000000001, -3.5000000000000004, -3.3000000000000007, -3.3000000000000007, -3.3000000000000003, -3.400000000000001, -3.200000000000001, -3.3000000000000003, -3.4000000000000004, -3.4000000000000004, -3.400000000000001, -11.4, -11.2, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.100000000000001, -12.100000000000001, -3.2000000000000006, -3.2, -3.300000000000001, -3.0000000000000004, -3.6000000000000005, -3.1000000000000005, -3.1000000000000005, -12.200000000000001, -3.0000000000000004, -3.3000000000000007, -3.3000000000000003, -3.500000000000001, -3.3000000000000007, -3.400000000000001, -3.5000000000000004, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.100000000000001, -11.3, -3.1000000000000005, -11.700000000000001, -3.0000000000000004, -3.400000000000001, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.4000000000000012, -3.2000000000000006, -3.3000000000000007, -3.700000000000001, -3.5000000000000004, -3.400000000000001, -3.0000000000000004, -3.600000000000001, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.600000000000001, -3.2000000000000006, -3.3000000000000003, -3.2, -3.1000000000000005, -3.2000000000000006, -3.500000000000001, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -11.4, -3.500000000000001, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.500000000000001, -12.100000000000001, -3.400000000000001, -3.500000000000001, -3.0000000000000004, -3.200000000000001, -3.2000000000000006, -3.5000000000000004, -3.4000000000000004, -3.6000000000000005, -3.0000000000000004, -3.0000000000000004, -11.9, -3.3000000000000003, -11.7, -3.1000000000000005, -3.3000000000000003, -3.400000000000001, -3.500000000000001, -3.4000000000000004, -3.400000000000001, -3.4000000000000004, -3.200000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.4000000000000004, -3.4000000000000004, -3.600000000000001, -3.4000000000000012, -3.400000000000001, -3.2, -3.2000000000000006, -3.400000000000001, -3.100000000000001, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -11.5, -3.2000000000000006, -3.3000000000000007, -3.500000000000001, -3.1000000000000005, -11.0, -10.8, -3.2000000000000006, -11.4, -3.600000000000001, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.500000000000001, -3.500000000000001, -3.400000000000001, -3.200000000000001, -3.6000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -11.8, -3.1000000000000005, -3.3000000000000007, -3.5000000000000004, -11.1, -12.1, -3.3000000000000007, -3.1000000000000005, -3.300000000000001, -3.500000000000001, -3.1000000000000005, -3.2000000000000006, 99.2, -3.1000000000000005, -3.500000000000001, -10.7, -3.4000000000000004, -3.3000000000000003], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 12, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 9, 9, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 12, 20, 21, 21, 21, 21, 21, 21, 9, 21, 21, 7, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.526396041887365, "mean_inference_ms": 17.4472931506336, "mean_action_processing_ms": 0.9139822603179457, "mean_env_wait_ms": 2.1935046227598423, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07829514945425638, "StateBufferConnector_ms": 0.01081268961836652, "ViewRequirementAgentConnector_ms": 0.1442174213688548}}, "episode_reward_max": 99.2, "episode_reward_min": -12.200000000000001, "episode_reward_mean": -3.663902439024391, "episode_len_mean": 20.165853658536584, "episodes_this_iter": 205, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.2000000000000006, -3.3000000000000007, -3.100000000000001, -3.5000000000000013, -3.3000000000000003, -3.3000000000000007, -3.400000000000001, -3.4000000000000004, -3.3000000000000007, -10.0, -11.1, -3.400000000000001, -3.3000000000000003, -3.3000000000000003, -3.1000000000000005, -3.4000000000000004, -3.200000000000001, -3.2, -3.2, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.500000000000001, -3.400000000000001, -3.0000000000000004, -11.4, -3.3000000000000003, -3.3000000000000007, -3.4000000000000004, -3.4000000000000004, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.400000000000001, -3.200000000000001, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -11.8, -3.400000000000001, -3.5000000000000004, -3.3000000000000007, -3.3000000000000007, -3.3000000000000003, -3.400000000000001, -3.200000000000001, -3.3000000000000003, -3.4000000000000004, -3.4000000000000004, -3.400000000000001, -11.4, -11.2, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.100000000000001, -12.100000000000001, -3.2000000000000006, -3.2, -3.300000000000001, -3.0000000000000004, -3.6000000000000005, -3.1000000000000005, -3.1000000000000005, -12.200000000000001, -3.0000000000000004, -3.3000000000000007, -3.3000000000000003, -3.500000000000001, -3.3000000000000007, -3.400000000000001, -3.5000000000000004, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.100000000000001, -11.3, -3.1000000000000005, -11.700000000000001, -3.0000000000000004, -3.400000000000001, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.4000000000000012, -3.2000000000000006, -3.3000000000000007, -3.700000000000001, -3.5000000000000004, -3.400000000000001, -3.0000000000000004, -3.600000000000001, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.600000000000001, -3.2000000000000006, -3.3000000000000003, -3.2, -3.1000000000000005, -3.2000000000000006, -3.500000000000001, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -11.4, -3.500000000000001, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.500000000000001, -12.100000000000001, -3.400000000000001, -3.500000000000001, -3.0000000000000004, -3.200000000000001, -3.2000000000000006, -3.5000000000000004, -3.4000000000000004, -3.6000000000000005, -3.0000000000000004, -3.0000000000000004, -11.9, -3.3000000000000003, -11.7, -3.1000000000000005, -3.3000000000000003, -3.400000000000001, -3.500000000000001, -3.4000000000000004, -3.400000000000001, -3.4000000000000004, -3.200000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.4000000000000004, -3.4000000000000004, -3.600000000000001, -3.4000000000000012, -3.400000000000001, -3.2, -3.2000000000000006, -3.400000000000001, -3.100000000000001, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -11.5, -3.2000000000000006, -3.3000000000000007, -3.500000000000001, -3.1000000000000005, -11.0, -10.8, -3.2000000000000006, -11.4, -3.600000000000001, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.500000000000001, -3.500000000000001, -3.400000000000001, -3.200000000000001, -3.6000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -11.8, -3.1000000000000005, -3.3000000000000007, -3.5000000000000004, -11.1, -12.1, -3.3000000000000007, -3.1000000000000005, -3.300000000000001, -3.500000000000001, -3.1000000000000005, -3.2000000000000006, 99.2, -3.1000000000000005, -3.500000000000001, -10.7, -3.4000000000000004, -3.3000000000000003], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 12, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 9, 9, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 12, 20, 21, 21, 21, 21, 21, 21, 9, 21, 21, 7, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.526396041887365, "mean_inference_ms": 17.4472931506336, "mean_action_processing_ms": 0.9139822603179457, "mean_env_wait_ms": 2.1935046227598423, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07829514945425638, "StateBufferConnector_ms": 0.01081268961836652, "ViewRequirementAgentConnector_ms": 0.1442174213688548}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 276000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 276000, "timers": {"training_iteration_time_ms": 170944.959, "load_time_ms": 1.168, "load_throughput": 3425529.534, "learn_time_ms": 169885.545, "learn_throughput": 23.545, "synch_weights_time_ms": 200.71}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "done": false, "episodes_total": 14134, "training_iteration": 69, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_00-12-30", "timestamp": 1680819150, "time_this_iter_s": 171.2194447517395, "time_total_s": 11801.659934043884, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476f20a0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01474a8ee0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 11801.659934043884, "timesteps_since_restore": 0, "iterations_since_restore": 69, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.393415637860082, "ram_util_percent": 24.097119341563786}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1817144366842445, "cur_kl_coeff": 1.2814453125, "cur_lr": 0.0010000000000000005, "total_loss": 0.2596749978004805, "policy_loss": -0.09322540515743356, "vf_loss": 0.33032128634732416, "vf_explained_var": 0.520404250262886, "kl": 0.01762003746069592, "entropy": 3.7018639023585984, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 64635.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.3, "episode_reward_mean": -4.1015625, "episode_len_mean": 20.140625, "episode_media": {}, "episodes_this_iter": 192, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.5, -3.1000000000000005, -3.5000000000000004, -3.1000000000000005, -3.100000000000001, -11.3, -3.1000000000000005, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.3000000000000003, -3.400000000000001, -3.2, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.400000000000001, -3.4000000000000004, -3.6000000000000005, -3.3000000000000003, -3.3000000000000007, -3.4000000000000004, -3.700000000000001, -3.400000000000001, -3.4000000000000004, -3.3000000000000007, -3.400000000000001, -11.1, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -11.9, -3.5000000000000004, -3.400000000000001, -3.200000000000001, -3.5000000000000004, -11.6, -3.400000000000001, -3.1000000000000005, -11.5, -3.2000000000000006, -12.0, -3.2000000000000006, -3.400000000000001, -3.3000000000000003, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.300000000000001, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -11.9, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -12.3, -3.3000000000000007, -3.400000000000001, -3.3000000000000003, -3.400000000000001, -3.400000000000001, -3.4000000000000004, -3.4000000000000004, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.600000000000001, -3.500000000000001, -3.1000000000000005, -3.4000000000000004, -3.400000000000001, -3.500000000000001, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.5000000000000004, -3.4000000000000004, -10.6, -3.3000000000000007, -10.0, -3.300000000000001, -3.5000000000000004, -3.1000000000000005, -3.3000000000000003, -3.4000000000000004, -10.2, -3.4000000000000004, -3.3000000000000007, -3.5000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2, -3.500000000000001, -3.4000000000000004, -11.9, -3.2000000000000006, -10.0, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.5000000000000004, -3.600000000000001, -3.3000000000000007, -3.2000000000000006, -3.500000000000001, -3.3000000000000007, -3.600000000000001, -3.5000000000000004, -3.500000000000001, -3.500000000000001, -3.5000000000000004, -3.3000000000000007, -3.400000000000001, -3.5000000000000004, -3.2000000000000006, -10.5, -3.0000000000000004, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -10.4, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.4, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.5000000000000004, -3.200000000000001, -12.100000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.2, -3.5000000000000004, -3.500000000000001, -3.7000000000000006, -3.400000000000001, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.3000000000000003, -3.0000000000000004, -12.0, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.5000000000000004, -3.6000000000000014, -3.3000000000000003, -3.4000000000000004, -3.4000000000000004, -3.2000000000000006, -3.4000000000000004, -3.4000000000000004, -11.8, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006], "episode_lengths": [15, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 13, 21, 21, 14, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 1, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.522519408812729, "mean_inference_ms": 17.455433185345044, "mean_action_processing_ms": 0.914167972645418, "mean_env_wait_ms": 2.1947889291627503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07551275193691254, "StateBufferConnector_ms": 0.010215739409128824, "ViewRequirementAgentConnector_ms": 0.14114889005819956}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.3, "episode_reward_mean": -4.1015625, "episode_len_mean": 20.140625, "episodes_this_iter": 192, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11.5, -3.1000000000000005, -3.5000000000000004, -3.1000000000000005, -3.100000000000001, -11.3, -3.1000000000000005, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.3000000000000003, -3.400000000000001, -3.2, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.400000000000001, -3.4000000000000004, -3.6000000000000005, -3.3000000000000003, -3.3000000000000007, -3.4000000000000004, -3.700000000000001, -3.400000000000001, -3.4000000000000004, -3.3000000000000007, -3.400000000000001, -11.1, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -11.9, -3.5000000000000004, -3.400000000000001, -3.200000000000001, -3.5000000000000004, -11.6, -3.400000000000001, -3.1000000000000005, -11.5, -3.2000000000000006, -12.0, -3.2000000000000006, -3.400000000000001, -3.3000000000000003, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.300000000000001, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -11.9, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -12.3, -3.3000000000000007, -3.400000000000001, -3.3000000000000003, -3.400000000000001, -3.400000000000001, -3.4000000000000004, -3.4000000000000004, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.600000000000001, -3.500000000000001, -3.1000000000000005, -3.4000000000000004, -3.400000000000001, -3.500000000000001, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.5000000000000004, -3.4000000000000004, -10.6, -3.3000000000000007, -10.0, -3.300000000000001, -3.5000000000000004, -3.1000000000000005, -3.3000000000000003, -3.4000000000000004, -10.2, -3.4000000000000004, -3.3000000000000007, -3.5000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2, -3.500000000000001, -3.4000000000000004, -11.9, -3.2000000000000006, -10.0, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.5000000000000004, -3.600000000000001, -3.3000000000000007, -3.2000000000000006, -3.500000000000001, -3.3000000000000007, -3.600000000000001, -3.5000000000000004, -3.500000000000001, -3.500000000000001, -3.5000000000000004, -3.3000000000000007, -3.400000000000001, -3.5000000000000004, -3.2000000000000006, -10.5, -3.0000000000000004, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -10.4, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.4, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.5000000000000004, -3.200000000000001, -12.100000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.2, -3.5000000000000004, -3.500000000000001, -3.7000000000000006, -3.400000000000001, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.3000000000000003, -3.0000000000000004, -12.0, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.5000000000000004, -3.6000000000000014, -3.3000000000000003, -3.4000000000000004, -3.4000000000000004, -3.2000000000000006, -3.4000000000000004, -3.4000000000000004, -11.8, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006], "episode_lengths": [15, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 13, 21, 21, 14, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 1, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.522519408812729, "mean_inference_ms": 17.455433185345044, "mean_action_processing_ms": 0.914167972645418, "mean_env_wait_ms": 2.1947889291627503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07551275193691254, "StateBufferConnector_ms": 0.010215739409128824, "ViewRequirementAgentConnector_ms": 0.14114889005819956}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 280000, "timers": {"training_iteration_time_ms": 171030.111, "load_time_ms": 1.171, "load_throughput": 3414722.788, "learn_time_ms": 169961.906, "learn_throughput": 23.535, "synch_weights_time_ms": 200.593}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "done": false, "episodes_total": 14326, "training_iteration": 70, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_00-15-21", "timestamp": 1680819321, "time_this_iter_s": 171.46470618247986, "time_total_s": 11973.124640226364, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01477ae5b0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01473d8ee0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 11973.124640226364, "timesteps_since_restore": 0, "iterations_since_restore": 70, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.55983606557377, "ram_util_percent": 24.101229508196724}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3421644069334513, "cur_kl_coeff": 1.2814453125, "cur_lr": 0.0010000000000000005, "total_loss": 0.31751274303783494, "policy_loss": -0.03518219035931222, "vf_loss": 0.3428264211693038, "vf_explained_var": 0.6701067000307063, "kl": 0.007701080142938462, "entropy": 3.7089876326181557, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 65565.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000}, "sampler_results": {"episode_reward_max": 98.8, "episode_reward_min": -12.2, "episode_reward_mean": -3.3533678756476686, "episode_len_mean": 20.367875647668395, "episode_media": {}, "episodes_this_iter": 193, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.400000000000001, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.600000000000001, -3.2000000000000006, -3.400000000000001, -3.7000000000000006, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.400000000000001, -3.500000000000001, -3.3000000000000007, -3.4000000000000004, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.400000000000001, -3.300000000000001, -3.1000000000000005, -3.500000000000001, -3.4000000000000004, -3.1000000000000005, -3.400000000000001, -3.400000000000001, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.7000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -11.5, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.2, -12.2, -3.3000000000000007, -3.2000000000000006, 98.8, -12.0, -3.3000000000000007, -3.6000000000000005, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.200000000000001, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -3.400000000000001, -3.0000000000000004, -3.3000000000000007, -3.600000000000001, -3.3000000000000003, -3.4000000000000004, -3.2000000000000006, -3.2, -3.2000000000000006, -3.4000000000000012, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.3000000000000003, -3.3000000000000007, -11.700000000000001, -3.3000000000000003, -3.4000000000000004, -3.3000000000000007, -3.3000000000000003, -3.1000000000000005, -3.3000000000000003, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.400000000000001, -3.2000000000000006, -3.6000000000000005, -3.3000000000000007, -10.5, -3.2000000000000006, -3.3000000000000003, -3.400000000000001, -3.4000000000000004, -3.400000000000001, -3.2000000000000006, -11.2, -3.2000000000000006, -3.2000000000000006, -3.5000000000000004, -3.3000000000000003, -3.0000000000000004, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.3000000000000007, -10.4, -3.400000000000001, -3.4000000000000004, -3.3000000000000003, -3.200000000000001, -3.500000000000001, -3.1000000000000005, -11.9, -3.2, -3.5000000000000004, -3.3000000000000003, -11.1, -3.4000000000000012, -3.2000000000000006, -3.3000000000000007, -3.2, -11.4, -3.5000000000000004, -3.500000000000001, -3.1000000000000005, -3.200000000000001, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -12.100000000000001, -3.400000000000001, -3.400000000000001, -3.1000000000000005, -3.400000000000001, -3.6000000000000005, -3.400000000000001, -3.2000000000000006, -3.200000000000001, -3.2, -3.0000000000000004, -3.400000000000001, -3.2000000000000006, -10.1, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.5000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.500000000000001, -3.2, -11.3, -3.8000000000000007, -3.6000000000000005, -3.600000000000001, -3.2000000000000006, -3.3000000000000003, -3.400000000000001, -3.400000000000001, -3.400000000000001, -3.0000000000000004, -10.7, -3.2000000000000006, -3.400000000000001, -3.5000000000000004, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.600000000000001, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.4000000000000004, -3.400000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 20, 21, 21, 13, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 11, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.52486546634478, "mean_inference_ms": 17.425512188059983, "mean_action_processing_ms": 0.9130732909953952, "mean_env_wait_ms": 2.194930928887752, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07313953162474954, "StateBufferConnector_ms": 0.009467441183297745, "ViewRequirementAgentConnector_ms": 0.1370821592103632}}, "episode_reward_max": 98.8, "episode_reward_min": -12.2, "episode_reward_mean": -3.3533678756476686, "episode_len_mean": 20.367875647668395, "episodes_this_iter": 193, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.400000000000001, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.600000000000001, -3.2000000000000006, -3.400000000000001, -3.7000000000000006, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.400000000000001, -3.500000000000001, -3.3000000000000007, -3.4000000000000004, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.400000000000001, -3.300000000000001, -3.1000000000000005, -3.500000000000001, -3.4000000000000004, -3.1000000000000005, -3.400000000000001, -3.400000000000001, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.7000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -11.5, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.2, -12.2, -3.3000000000000007, -3.2000000000000006, 98.8, -12.0, -3.3000000000000007, -3.6000000000000005, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.200000000000001, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -3.400000000000001, -3.0000000000000004, -3.3000000000000007, -3.600000000000001, -3.3000000000000003, -3.4000000000000004, -3.2000000000000006, -3.2, -3.2000000000000006, -3.4000000000000012, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.3000000000000003, -3.3000000000000007, -11.700000000000001, -3.3000000000000003, -3.4000000000000004, -3.3000000000000007, -3.3000000000000003, -3.1000000000000005, -3.3000000000000003, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.400000000000001, -3.2000000000000006, -3.6000000000000005, -3.3000000000000007, -10.5, -3.2000000000000006, -3.3000000000000003, -3.400000000000001, -3.4000000000000004, -3.400000000000001, -3.2000000000000006, -11.2, -3.2000000000000006, -3.2000000000000006, -3.5000000000000004, -3.3000000000000003, -3.0000000000000004, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.3000000000000007, -10.4, -3.400000000000001, -3.4000000000000004, -3.3000000000000003, -3.200000000000001, -3.500000000000001, -3.1000000000000005, -11.9, -3.2, -3.5000000000000004, -3.3000000000000003, -11.1, -3.4000000000000012, -3.2000000000000006, -3.3000000000000007, -3.2, -11.4, -3.5000000000000004, -3.500000000000001, -3.1000000000000005, -3.200000000000001, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -12.100000000000001, -3.400000000000001, -3.400000000000001, -3.1000000000000005, -3.400000000000001, -3.6000000000000005, -3.400000000000001, -3.2000000000000006, -3.200000000000001, -3.2, -3.0000000000000004, -3.400000000000001, -3.2000000000000006, -10.1, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.5000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.500000000000001, -3.2, -11.3, -3.8000000000000007, -3.6000000000000005, -3.600000000000001, -3.2000000000000006, -3.3000000000000003, -3.400000000000001, -3.400000000000001, -3.400000000000001, -3.0000000000000004, -10.7, -3.2000000000000006, -3.400000000000001, -3.5000000000000004, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.600000000000001, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.4000000000000004, -3.400000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 20, 21, 21, 13, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 11, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.52486546634478, "mean_inference_ms": 17.425512188059983, "mean_action_processing_ms": 0.9130732909953952, "mean_env_wait_ms": 2.194930928887752, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07313953162474954, "StateBufferConnector_ms": 0.009467441183297745, "ViewRequirementAgentConnector_ms": 0.1370821592103632}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 284000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 284000, "timers": {"training_iteration_time_ms": 171017.206, "load_time_ms": 1.141, "load_throughput": 3506063.696, "learn_time_ms": 169958.05, "learn_throughput": 23.535, "synch_weights_time_ms": 201.982}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000}, "done": false, "episodes_total": 14519, "training_iteration": 71, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_00-18-12", "timestamp": 1680819492, "time_this_iter_s": 170.6156289577484, "time_total_s": 12143.740269184113, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476f2820>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01474a88b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 12143.740269184113, "timesteps_since_restore": 0, "iterations_since_restore": 71, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.360493827160494, "ram_util_percent": 24.101234567901237}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2955433562718413, "cur_kl_coeff": 1.2814453125, "cur_lr": 0.0010000000000000005, "total_loss": 0.3183814282809454, "policy_loss": -0.027312165344170275, "vf_loss": 0.3308080076520401, "vf_explained_var": 0.5280077631755542, "kl": 0.011616248673442076, "entropy": 3.6996149575838477, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 66495.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "sampler_results": {"episode_reward_max": 98.2, "episode_reward_min": -12.100000000000001, "episode_reward_mean": -3.4238805970149255, "episode_len_mean": 20.27860696517413, "episode_media": {}, "episodes_this_iter": 201, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.6000000000000005, -3.0000000000000004, -3.200000000000001, -11.7, -3.2000000000000006, -3.300000000000001, -3.600000000000001, -3.1000000000000005, -3.600000000000001, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.5000000000000004, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.200000000000001, -3.2000000000000006, -3.1000000000000005, -3.100000000000001, -3.2000000000000006, -3.400000000000001, -3.4000000000000004, -3.7000000000000006, -3.400000000000001, -3.2, -3.3000000000000003, -3.1000000000000005, -3.9000000000000012, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.6000000000000005, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -10.6, -3.2, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.300000000000001, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.5000000000000004, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.8000000000000007, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -10.7, -3.4000000000000004, -3.400000000000001, -3.600000000000001, -3.1000000000000005, -3.100000000000001, -3.4000000000000012, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.600000000000001, -3.200000000000001, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -11.700000000000001, -11.9, -3.2000000000000006, -3.3000000000000007, -3.6000000000000005, -3.600000000000001, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -12.0, -3.100000000000001, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -11.7, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -10.3, -3.500000000000001, -3.500000000000001, -3.3000000000000007, -3.400000000000001, -3.5000000000000004, -3.600000000000001, -3.300000000000001, -3.2000000000000006, -3.3000000000000003, -11.4, -12.100000000000001, -3.2000000000000006, -3.700000000000001, -3.4000000000000004, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.5000000000000004, -3.3000000000000007, -3.400000000000001, -3.2, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, 98.2, -3.3000000000000007, -3.2000000000000006, -3.300000000000001, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -10.2, -3.3000000000000007, -3.3000000000000007, -3.5000000000000004, -3.5000000000000004, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.2, -3.2000000000000006, -3.2000000000000006, -10.4, -11.9, -3.3000000000000007, -10.5, -3.2000000000000006, -3.2000000000000006, -12.0, -3.5000000000000004, -3.5000000000000004, -3.0000000000000004, -3.400000000000001, -3.2000000000000006, -3.7000000000000006, -3.500000000000001, -3.500000000000001, -3.6000000000000005, -3.100000000000001, -3.5000000000000004, -3.400000000000001, -3.2, -3.1000000000000005, -3.2000000000000006, -3.500000000000001, -3.3000000000000003, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.600000000000001, -3.3000000000000007, -3.3000000000000003, -3.400000000000001, -10.4, -3.2000000000000006, -3.5000000000000004, -3.400000000000001], "episode_lengths": [21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 17, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 19, 21, 6, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.534054795494756, "mean_inference_ms": 17.43675763307867, "mean_action_processing_ms": 0.9124083663543894, "mean_env_wait_ms": 2.194692497006209, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07349282354857792, "StateBufferConnector_ms": 0.009524762927003168, "ViewRequirementAgentConnector_ms": 0.13494467853906736}}, "episode_reward_max": 98.2, "episode_reward_min": -12.100000000000001, "episode_reward_mean": -3.4238805970149255, "episode_len_mean": 20.27860696517413, "episodes_this_iter": 201, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.6000000000000005, -3.0000000000000004, -3.200000000000001, -11.7, -3.2000000000000006, -3.300000000000001, -3.600000000000001, -3.1000000000000005, -3.600000000000001, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.5000000000000004, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.200000000000001, -3.2000000000000006, -3.1000000000000005, -3.100000000000001, -3.2000000000000006, -3.400000000000001, -3.4000000000000004, -3.7000000000000006, -3.400000000000001, -3.2, -3.3000000000000003, -3.1000000000000005, -3.9000000000000012, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.6000000000000005, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -10.6, -3.2, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.300000000000001, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.5000000000000004, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.8000000000000007, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -10.7, -3.4000000000000004, -3.400000000000001, -3.600000000000001, -3.1000000000000005, -3.100000000000001, -3.4000000000000012, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.600000000000001, -3.200000000000001, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -11.700000000000001, -11.9, -3.2000000000000006, -3.3000000000000007, -3.6000000000000005, -3.600000000000001, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -12.0, -3.100000000000001, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -11.7, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -10.3, -3.500000000000001, -3.500000000000001, -3.3000000000000007, -3.400000000000001, -3.5000000000000004, -3.600000000000001, -3.300000000000001, -3.2000000000000006, -3.3000000000000003, -11.4, -12.100000000000001, -3.2000000000000006, -3.700000000000001, -3.4000000000000004, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.5000000000000004, -3.3000000000000007, -3.400000000000001, -3.2, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, 98.2, -3.3000000000000007, -3.2000000000000006, -3.300000000000001, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -10.2, -3.3000000000000007, -3.3000000000000007, -3.5000000000000004, -3.5000000000000004, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.2, -3.2000000000000006, -3.2000000000000006, -10.4, -11.9, -3.3000000000000007, -10.5, -3.2000000000000006, -3.2000000000000006, -12.0, -3.5000000000000004, -3.5000000000000004, -3.0000000000000004, -3.400000000000001, -3.2000000000000006, -3.7000000000000006, -3.500000000000001, -3.500000000000001, -3.6000000000000005, -3.100000000000001, -3.5000000000000004, -3.400000000000001, -3.2, -3.1000000000000005, -3.2000000000000006, -3.500000000000001, -3.3000000000000003, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.600000000000001, -3.3000000000000007, -3.3000000000000003, -3.400000000000001, -10.4, -3.2000000000000006, -3.5000000000000004, -3.400000000000001], "episode_lengths": [21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 17, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 19, 21, 6, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.534054795494756, "mean_inference_ms": 17.43675763307867, "mean_action_processing_ms": 0.9124083663543894, "mean_env_wait_ms": 2.194692497006209, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07349282354857792, "StateBufferConnector_ms": 0.009524762927003168, "ViewRequirementAgentConnector_ms": 0.13494467853906736}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 171009.498, "load_time_ms": 1.128, "load_throughput": 3545855.648, "learn_time_ms": 169953.714, "learn_throughput": 23.536, "synch_weights_time_ms": 202.406}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "episodes_total": 14720, "training_iteration": 72, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_00-21-03", "timestamp": 1680819663, "time_this_iter_s": 170.76078820228577, "time_total_s": 12314.501057386398, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01473e24c0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0147473430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 12314.501057386398, "timesteps_since_restore": 0, "iterations_since_restore": 72, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.379423868312758, "ram_util_percent": 24.101234567901237}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5060770167778896, "cur_kl_coeff": 1.2814453125, "cur_lr": 0.0010000000000000005, "total_loss": 0.3612317776267407, "policy_loss": -0.029641868994491154, "vf_loss": 0.3731670221749453, "vf_explained_var": 0.6043240016506565, "kl": 0.013817697250026389, "entropy": 3.681856333055804, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 67425.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000}, "sampler_results": {"episode_reward_max": 97.8, "episode_reward_min": -12.5, "episode_reward_mean": -3.5651515151515154, "episode_len_mean": 19.863636363636363, "episode_media": {}, "episodes_this_iter": 198, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.1000000000000005, -3.2, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.600000000000001, -3.3000000000000003, -3.400000000000001, -10.0, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.5000000000000004, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.5000000000000004, -3.3000000000000007, -3.5, -3.100000000000001, -3.3000000000000003, -3.600000000000001, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.500000000000001, -3.3000000000000007, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.4000000000000004, -3.2, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.2, -3.5000000000000004, -3.4000000000000004, -3.1000000000000005, -3.4000000000000004, -3.3000000000000007, -3.2000000000000006, -3.2, -3.1000000000000005, -3.500000000000001, -3.3000000000000007, -3.3000000000000003, -3.4000000000000004, -3.3000000000000007, -10.3, -3.2, -3.4000000000000004, -3.400000000000001, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.4000000000000004, -3.3000000000000007, -3.4000000000000004, -3.3000000000000007, -3.2000000000000006, -3.2, -3.3000000000000007, -3.1000000000000005, -11.2, -3.3000000000000007, -3.3000000000000007, -3.3000000000000003, -3.5000000000000013, -3.5000000000000004, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.400000000000001, -10.2, 97.8, -3.4000000000000004, -3.3000000000000007, -3.3000000000000003, -3.0000000000000004, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.200000000000001, -10.3, -3.5000000000000004, -3.1000000000000005, -10.6, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.500000000000001, -10.4, -11.6, -3.500000000000001, -3.100000000000001, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.1000000000000005, -11.2, -3.2000000000000006, -3.3000000000000003, -10.3, -11.9, -3.200000000000001, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.4000000000000004, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -10.8, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -11.1, -3.3000000000000007, -3.5000000000000004, -11.0, -3.500000000000001, -3.3000000000000007, -3.1000000000000005, -3.5000000000000004, -3.2000000000000006, -11.3, -11.6, -3.0000000000000004, -11.8, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -3.3000000000000003, -3.4000000000000004, -3.1000000000000005, -3.5000000000000004, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.2, -3.4000000000000012, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -11.3, -3.3000000000000007, -10.4, -3.5000000000000004, -3.5000000000000013, -3.400000000000001, -3.200000000000001, -3.400000000000001, -3.6000000000000005, -3.400000000000001, -3.600000000000001, -3.800000000000001, -3.400000000000001, -3.2000000000000006, -3.600000000000001, -3.1000000000000005, -3.500000000000001, -3.500000000000001, -3.600000000000001, -3.400000000000001, -3.500000000000001, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.100000000000001, -3.5000000000000004, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -12.5, -3.2], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 18, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 5, 17, 21, 21, 21, 21, 21, 21, 11, 21, 21, 4, 18, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 10, 21, 21, 10, 21, 21, 21, 21, 21, 13, 15, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.536189242954615, "mean_inference_ms": 17.45059232992213, "mean_action_processing_ms": 0.9134087490922876, "mean_env_wait_ms": 2.1986555354747277, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0702626777417732, "StateBufferConnector_ms": 0.009088443987297289, "ViewRequirementAgentConnector_ms": 0.1306520567999946}}, "episode_reward_max": 97.8, "episode_reward_min": -12.5, "episode_reward_mean": -3.5651515151515154, "episode_len_mean": 19.863636363636363, "episodes_this_iter": 198, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.1000000000000005, -3.2, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.600000000000001, -3.3000000000000003, -3.400000000000001, -10.0, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.5000000000000004, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.5000000000000004, -3.3000000000000007, -3.5, -3.100000000000001, -3.3000000000000003, -3.600000000000001, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.500000000000001, -3.3000000000000007, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.4000000000000004, -3.2, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.2, -3.5000000000000004, -3.4000000000000004, -3.1000000000000005, -3.4000000000000004, -3.3000000000000007, -3.2000000000000006, -3.2, -3.1000000000000005, -3.500000000000001, -3.3000000000000007, -3.3000000000000003, -3.4000000000000004, -3.3000000000000007, -10.3, -3.2, -3.4000000000000004, -3.400000000000001, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.4000000000000004, -3.3000000000000007, -3.4000000000000004, -3.3000000000000007, -3.2000000000000006, -3.2, -3.3000000000000007, -3.1000000000000005, -11.2, -3.3000000000000007, -3.3000000000000007, -3.3000000000000003, -3.5000000000000013, -3.5000000000000004, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.400000000000001, -10.2, 97.8, -3.4000000000000004, -3.3000000000000007, -3.3000000000000003, -3.0000000000000004, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.200000000000001, -10.3, -3.5000000000000004, -3.1000000000000005, -10.6, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.500000000000001, -10.4, -11.6, -3.500000000000001, -3.100000000000001, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.1000000000000005, -11.2, -3.2000000000000006, -3.3000000000000003, -10.3, -11.9, -3.200000000000001, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.4000000000000004, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -10.8, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -11.1, -3.3000000000000007, -3.5000000000000004, -11.0, -3.500000000000001, -3.3000000000000007, -3.1000000000000005, -3.5000000000000004, -3.2000000000000006, -11.3, -11.6, -3.0000000000000004, -11.8, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -3.3000000000000003, -3.4000000000000004, -3.1000000000000005, -3.5000000000000004, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.2, -3.4000000000000012, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -11.3, -3.3000000000000007, -10.4, -3.5000000000000004, -3.5000000000000013, -3.400000000000001, -3.200000000000001, -3.400000000000001, -3.6000000000000005, -3.400000000000001, -3.600000000000001, -3.800000000000001, -3.400000000000001, -3.2000000000000006, -3.600000000000001, -3.1000000000000005, -3.500000000000001, -3.500000000000001, -3.600000000000001, -3.400000000000001, -3.500000000000001, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.100000000000001, -3.5000000000000004, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -12.5, -3.2], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 18, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 5, 17, 21, 21, 21, 21, 21, 21, 11, 21, 21, 4, 18, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 10, 21, 21, 10, 21, 21, 21, 21, 21, 13, 15, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.536189242954615, "mean_inference_ms": 17.45059232992213, "mean_action_processing_ms": 0.9134087490922876, "mean_env_wait_ms": 2.1986555354747277, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0702626777417732, "StateBufferConnector_ms": 0.009088443987297289, "ViewRequirementAgentConnector_ms": 0.1306520567999946}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 292000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 292000, "timers": {"training_iteration_time_ms": 170942.869, "load_time_ms": 1.129, "load_throughput": 3543533.984, "learn_time_ms": 169916.287, "learn_throughput": 23.541, "synch_weights_time_ms": 172.238}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000}, "done": false, "episodes_total": 14918, "training_iteration": 73, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_00-23-54", "timestamp": 1680819834, "time_this_iter_s": 170.4725637435913, "time_total_s": 12484.97362112999, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01475696d0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01474a8040>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 12484.97362112999, "timesteps_since_restore": 0, "iterations_since_restore": 73, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.343801652892562, "ram_util_percent": 24.10206611570248}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2115357193094427, "cur_kl_coeff": 1.2814453125, "cur_lr": 0.0010000000000000005, "total_loss": 0.3816780127104252, "policy_loss": -0.03495723551479719, "vf_loss": 0.4016750277721033, "vf_explained_var": 0.6086307955685483, "kl": 0.01167449108290521, "entropy": 3.6852062814979143, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 68355.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000}, "sampler_results": {"episode_reward_max": 99.8, "episode_reward_min": -11.8, "episode_reward_mean": -2.9341346153846155, "episode_len_mean": 19.91826923076923, "episode_media": {}, "episodes_this_iter": 208, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.400000000000001, -3.600000000000001, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -10.2, -10.3, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.5000000000000004, -11.6, -10.0, -3.5000000000000004, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.200000000000001, -3.3000000000000007, -3.5000000000000004, -3.5000000000000004, -11.6, -3.1000000000000005, -3.400000000000001, -3.5000000000000004, -3.4000000000000012, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.5000000000000004, -3.3000000000000003, -11.8, -3.500000000000001, -3.400000000000001, -3.3000000000000007, 98.4, -3.200000000000001, -3.4000000000000004, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.5000000000000004, -3.4000000000000004, -11.3, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.500000000000001, -3.3000000000000007, -3.3000000000000007, -3.5000000000000004, -3.3000000000000003, -11.4, -3.5000000000000004, -3.500000000000001, -3.3000000000000007, 99.8, -3.500000000000001, -3.3000000000000007, -3.500000000000001, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.100000000000001, -3.400000000000001, -3.2000000000000006, -3.3000000000000003, -3.400000000000001, -3.4000000000000004, -3.3000000000000007, -3.1000000000000005, -3.300000000000001, -3.3000000000000007, -3.4000000000000004, -11.5, -3.1000000000000005, -3.3000000000000007, -3.4000000000000004, -3.0000000000000004, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.2, -3.2000000000000006, -3.0000000000000004, -3.5000000000000004, -3.100000000000001, -3.100000000000001, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -3.7000000000000006, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.600000000000001, -3.3000000000000007, -3.2, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -11.1, -3.7000000000000006, -3.4000000000000004, -3.3000000000000003, -3.500000000000001, -3.400000000000001, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.4000000000000004, -3.3000000000000007, -11.6, -3.2, -3.2000000000000006, -3.2, -3.100000000000001, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.4000000000000004, -3.3000000000000003, -3.3000000000000003, -3.5000000000000004, -3.4000000000000004, -3.500000000000001, -3.2000000000000006, -3.300000000000001, -3.3000000000000007, -3.5000000000000004, -3.3000000000000007, -3.1000000000000005, -10.1, -3.2, -3.2, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.3000000000000003, -3.400000000000001, -3.100000000000001, -3.3000000000000003, -3.5000000000000004, -10.9, -3.100000000000001, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.3000000000000003, -11.4, -3.2, -10.2, -3.500000000000001, -3.200000000000001, -3.2000000000000006, -3.5000000000000004, -3.700000000000001, -3.400000000000001, -3.400000000000001, -3.500000000000001, -3.4000000000000004, -3.400000000000001, -3.0000000000000004, -3.2000000000000006, -3.5000000000000004, -3.300000000000001, -3.3000000000000007, -3.1000000000000005, -3.200000000000001, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.4000000000000004, -10.0, -3.8000000000000007, -3.3000000000000007, -10.1, -3.2000000000000006, -3.7000000000000006, -3.2000000000000006, -3.1000000000000005], "episode_lengths": [21, 21, 21, 21, 21, 3, 4, 21, 21, 21, 21, 21, 15, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 13, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21, 21, 2, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.532085767233395, "mean_inference_ms": 17.446427794361725, "mean_action_processing_ms": 0.913421792568668, "mean_env_wait_ms": 2.1999843172090108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0741965495623075, "StateBufferConnector_ms": 0.009549581087552585, "ViewRequirementAgentConnector_ms": 0.13641371176793024}}, "episode_reward_max": 99.8, "episode_reward_min": -11.8, "episode_reward_mean": -2.9341346153846155, "episode_len_mean": 19.91826923076923, "episodes_this_iter": 208, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.400000000000001, -3.600000000000001, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -10.2, -10.3, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.5000000000000004, -11.6, -10.0, -3.5000000000000004, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.200000000000001, -3.3000000000000007, -3.5000000000000004, -3.5000000000000004, -11.6, -3.1000000000000005, -3.400000000000001, -3.5000000000000004, -3.4000000000000012, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.5000000000000004, -3.3000000000000003, -11.8, -3.500000000000001, -3.400000000000001, -3.3000000000000007, 98.4, -3.200000000000001, -3.4000000000000004, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.5000000000000004, -3.4000000000000004, -11.3, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.500000000000001, -3.3000000000000007, -3.3000000000000007, -3.5000000000000004, -3.3000000000000003, -11.4, -3.5000000000000004, -3.500000000000001, -3.3000000000000007, 99.8, -3.500000000000001, -3.3000000000000007, -3.500000000000001, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.100000000000001, -3.400000000000001, -3.2000000000000006, -3.3000000000000003, -3.400000000000001, -3.4000000000000004, -3.3000000000000007, -3.1000000000000005, -3.300000000000001, -3.3000000000000007, -3.4000000000000004, -11.5, -3.1000000000000005, -3.3000000000000007, -3.4000000000000004, -3.0000000000000004, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.2, -3.2000000000000006, -3.0000000000000004, -3.5000000000000004, -3.100000000000001, -3.100000000000001, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -3.7000000000000006, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.600000000000001, -3.3000000000000007, -3.2, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -11.1, -3.7000000000000006, -3.4000000000000004, -3.3000000000000003, -3.500000000000001, -3.400000000000001, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.4000000000000004, -3.3000000000000007, -11.6, -3.2, -3.2000000000000006, -3.2, -3.100000000000001, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.4000000000000004, -3.3000000000000003, -3.3000000000000003, -3.5000000000000004, -3.4000000000000004, -3.500000000000001, -3.2000000000000006, -3.300000000000001, -3.3000000000000007, -3.5000000000000004, -3.3000000000000007, -3.1000000000000005, -10.1, -3.2, -3.2, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.3000000000000003, -3.400000000000001, -3.100000000000001, -3.3000000000000003, -3.5000000000000004, -10.9, -3.100000000000001, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.3000000000000003, -11.4, -3.2, -10.2, -3.500000000000001, -3.200000000000001, -3.2000000000000006, -3.5000000000000004, -3.700000000000001, -3.400000000000001, -3.400000000000001, -3.500000000000001, -3.4000000000000004, -3.400000000000001, -3.0000000000000004, -3.2000000000000006, -3.5000000000000004, -3.300000000000001, -3.3000000000000007, -3.1000000000000005, -3.200000000000001, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.4000000000000004, -10.0, -3.8000000000000007, -3.3000000000000007, -10.1, -3.2000000000000006, -3.7000000000000006, -3.2000000000000006, -3.1000000000000005], "episode_lengths": [21, 21, 21, 21, 21, 3, 4, 21, 21, 21, 21, 21, 15, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 13, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21, 21, 2, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.532085767233395, "mean_inference_ms": 17.446427794361725, "mean_action_processing_ms": 0.913421792568668, "mean_env_wait_ms": 2.1999843172090108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0741965495623075, "StateBufferConnector_ms": 0.009549581087552585, "ViewRequirementAgentConnector_ms": 0.13641371176793024}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 296000, "timers": {"training_iteration_time_ms": 171013.324, "load_time_ms": 1.124, "load_throughput": 3558717.122, "learn_time_ms": 169980.581, "learn_throughput": 23.532, "synch_weights_time_ms": 172.479}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000}, "done": false, "episodes_total": 15126, "training_iteration": 74, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_00-26-44", "timestamp": 1680820004, "time_this_iter_s": 170.93684077262878, "time_total_s": 12655.910461902618, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0147423ac0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01474a81f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 12655.910461902618, "timesteps_since_restore": 0, "iterations_since_restore": 74, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.572427983539094, "ram_util_percent": 24.104115226337452}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.222285890859622, "cur_kl_coeff": 1.2814453125, "cur_lr": 0.0010000000000000005, "total_loss": 0.32972429487053107, "policy_loss": -0.036882778910058804, "vf_loss": 0.3547147884974957, "vf_explained_var": 0.5866588529720101, "kl": 0.009280370924245036, "entropy": 3.68786912374599, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 69285.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "sampler_results": {"episode_reward_max": 99.2, "episode_reward_min": -11.9, "episode_reward_mean": -2.9753768844221113, "episode_len_mean": 20.07537688442211, "episode_media": {}, "episodes_this_iter": 199, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.2, -3.2000000000000006, -3.3000000000000007, -3.200000000000001, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -11.5, -3.2000000000000006, -3.3000000000000007, -3.5000000000000004, -11.5, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.300000000000001, -3.500000000000001, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.200000000000001, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.0000000000000004, -11.5, -3.3000000000000007, 99.2, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.5000000000000004, -3.500000000000001, -3.5000000000000004, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.2, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.4000000000000004, -3.2000000000000006, -3.3000000000000003, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.4000000000000004, -11.9, -3.2, -3.3000000000000007, -10.0, -3.1000000000000005, -3.2000000000000006, -10.8, -3.3000000000000007, -3.3000000000000007, -3.500000000000001, -11.2, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.400000000000001, -3.5000000000000004, -10.9, -10.2, -3.1000000000000005, -3.4000000000000004, -3.3000000000000007, 98.1, -3.400000000000001, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.4000000000000004, -3.5000000000000013, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.7000000000000006, -3.4000000000000004, -3.2, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -11.9, -3.6000000000000005, -3.6000000000000005, -3.3000000000000007, -11.1, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.2, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.300000000000001, -3.3000000000000007, -3.3000000000000003, -3.300000000000001, -3.4000000000000004, -3.400000000000001, -3.3000000000000003, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.300000000000001, -3.700000000000001, -3.5000000000000004, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.0000000000000004, -10.7, -3.6000000000000005, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.5000000000000004, -11.8, -3.2000000000000006, -3.2, -3.3000000000000007, -3.4000000000000012, -3.3000000000000003, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.100000000000001, -3.4000000000000004, -11.2, -3.2, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.400000000000001, -3.500000000000001, -3.2, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.500000000000001, -3.2000000000000006, -3.500000000000001, -3.5000000000000013, -3.3000000000000007, -3.7000000000000006, -3.400000000000001, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.500000000000001, -11.4, -3.0000000000000004, -3.1000000000000005, -11.700000000000001, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.100000000000001, -3.400000000000001, -11.6], "episode_lengths": [3, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 1, 21, 21, 8, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 3, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 17, 21, 21, 21, 21, 21, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.536130615031622, "mean_inference_ms": 17.448977171967442, "mean_action_processing_ms": 0.913450212104989, "mean_env_wait_ms": 2.1995294884253966, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07442996729558436, "StateBufferConnector_ms": 0.009441375732421875, "ViewRequirementAgentConnector_ms": 0.13719467661488596}}, "episode_reward_max": 99.2, "episode_reward_min": -11.9, "episode_reward_mean": -2.9753768844221113, "episode_len_mean": 20.07537688442211, "episodes_this_iter": 199, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10.2, -3.2000000000000006, -3.3000000000000007, -3.200000000000001, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -11.5, -3.2000000000000006, -3.3000000000000007, -3.5000000000000004, -11.5, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.300000000000001, -3.500000000000001, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.200000000000001, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.0000000000000004, -11.5, -3.3000000000000007, 99.2, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.5000000000000004, -3.500000000000001, -3.5000000000000004, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.2, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.4000000000000004, -3.2000000000000006, -3.3000000000000003, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.4000000000000004, -11.9, -3.2, -3.3000000000000007, -10.0, -3.1000000000000005, -3.2000000000000006, -10.8, -3.3000000000000007, -3.3000000000000007, -3.500000000000001, -11.2, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.400000000000001, -3.5000000000000004, -10.9, -10.2, -3.1000000000000005, -3.4000000000000004, -3.3000000000000007, 98.1, -3.400000000000001, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.4000000000000004, -3.5000000000000013, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.7000000000000006, -3.4000000000000004, -3.2, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -11.9, -3.6000000000000005, -3.6000000000000005, -3.3000000000000007, -11.1, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.2, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.300000000000001, -3.3000000000000007, -3.3000000000000003, -3.300000000000001, -3.4000000000000004, -3.400000000000001, -3.3000000000000003, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.300000000000001, -3.700000000000001, -3.5000000000000004, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.0000000000000004, -10.7, -3.6000000000000005, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.5000000000000004, -11.8, -3.2000000000000006, -3.2, -3.3000000000000007, -3.4000000000000012, -3.3000000000000003, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.100000000000001, -3.4000000000000004, -11.2, -3.2, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.400000000000001, -3.500000000000001, -3.2, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.500000000000001, -3.2000000000000006, -3.500000000000001, -3.5000000000000013, -3.3000000000000007, -3.7000000000000006, -3.400000000000001, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.500000000000001, -11.4, -3.0000000000000004, -3.1000000000000005, -11.700000000000001, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.100000000000001, -3.400000000000001, -11.6], "episode_lengths": [3, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 1, 21, 21, 8, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 3, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 17, 21, 21, 21, 21, 21, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.536130615031622, "mean_inference_ms": 17.448977171967442, "mean_action_processing_ms": 0.913450212104989, "mean_env_wait_ms": 2.1995294884253966, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07442996729558436, "StateBufferConnector_ms": 0.009441375732421875, "ViewRequirementAgentConnector_ms": 0.13719467661488596}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 300000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 300000, "timers": {"training_iteration_time_ms": 170955.924, "load_time_ms": 1.15, "load_throughput": 3477503.576, "learn_time_ms": 169918.882, "learn_throughput": 23.541, "synch_weights_time_ms": 173.323}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "done": false, "episodes_total": 15325, "training_iteration": 75, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_00-29-35", "timestamp": 1680820175, "time_this_iter_s": 170.46854877471924, "time_total_s": 12826.379010677338, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0147569100>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0147473820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 12826.379010677338, "timesteps_since_restore": 0, "iterations_since_restore": 75, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.343209876543209, "ram_util_percent": 24.104938271604947}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.418977676035576, "cur_kl_coeff": 1.2814453125, "cur_lr": 0.0010000000000000005, "total_loss": 0.26830195855344297, "policy_loss": -0.024923563549831454, "vf_loss": 0.2737807468370965, "vf_explained_var": 0.7027367825790118, "kl": 0.015174094885644022, "entropy": 3.6937470579660068, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 70215.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "sampler_results": {"episode_reward_max": 97.8, "episode_reward_min": -12.2, "episode_reward_mean": -3.3171717171717168, "episode_len_mean": 20.404040404040405, "episode_media": {}, "episodes_this_iter": 198, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.6, -3.5000000000000004, -3.2000000000000006, -3.2000000000000006, -3.500000000000001, -3.500000000000001, -3.3000000000000007, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.2, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.200000000000001, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.600000000000001, -3.500000000000001, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.5000000000000004, -3.1000000000000005, -3.2000000000000006, -3.300000000000001, -3.3000000000000003, -3.5000000000000004, -3.5000000000000004, -3.600000000000001, -3.2, -3.5000000000000004, -3.1000000000000005, -3.500000000000001, -3.5000000000000004, -3.3000000000000003, -3.500000000000001, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -11.2, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.5000000000000004, -3.3000000000000003, -3.2000000000000006, -3.3000000000000003, -3.4000000000000004, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.4000000000000004, -3.400000000000001, -3.2000000000000006, -3.900000000000001, -3.400000000000001, -3.6000000000000014, -3.6000000000000005, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.7000000000000006, -3.1000000000000005, -3.3000000000000007, -3.4000000000000004, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.600000000000001, -3.3000000000000007, -3.3000000000000007, -12.100000000000001, -3.400000000000001, -3.3000000000000003, -3.1000000000000005, -3.5000000000000004, -3.500000000000001, -3.1000000000000005, -3.400000000000001, -3.2, -3.2, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.200000000000001, -3.200000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.600000000000001, -11.1, -3.500000000000001, -3.400000000000001, -3.300000000000001, -3.500000000000001, 97.8, -3.3000000000000003, -3.0000000000000004, -10.1, -10.3, -3.3000000000000003, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.300000000000001, -3.6000000000000005, -3.400000000000001, -3.2000000000000006, -3.4000000000000004, -3.300000000000001, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.0000000000000004, -3.3000000000000007, -3.3000000000000007, -3.600000000000001, -3.3000000000000007, -3.4000000000000004, -3.200000000000001, -3.500000000000001, -3.4000000000000004, -3.2, -3.100000000000001, -3.200000000000001, -3.2000000000000006, -3.3000000000000007, -3.5000000000000004, -12.2, -11.7, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -10.9, -3.300000000000001, -3.3000000000000007, -3.500000000000001, -3.500000000000001, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.3000000000000003, -3.2, -11.3, -3.0000000000000004, -3.500000000000001, -3.2, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -3.500000000000001, -11.4, -3.3000000000000007, -3.500000000000001, -3.3000000000000007, -3.3000000000000003, -3.300000000000001, -3.400000000000001, -11.4, -10.6, -3.2000000000000006, -3.400000000000001], "episode_lengths": [15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 20, 21, 21, 2, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 16, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 13, 7, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.540959063681404, "mean_inference_ms": 17.435380117472, "mean_action_processing_ms": 0.9119905861583415, "mean_env_wait_ms": 2.19569051212437, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06660451792707348, "StateBufferConnector_ms": 0.00838775827427103, "ViewRequirementAgentConnector_ms": 0.12403100427955088}}, "episode_reward_max": 97.8, "episode_reward_min": -12.2, "episode_reward_mean": -3.3171717171717168, "episode_len_mean": 20.404040404040405, "episodes_this_iter": 198, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11.6, -3.5000000000000004, -3.2000000000000006, -3.2000000000000006, -3.500000000000001, -3.500000000000001, -3.3000000000000007, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.2, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.200000000000001, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.600000000000001, -3.500000000000001, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.5000000000000004, -3.1000000000000005, -3.2000000000000006, -3.300000000000001, -3.3000000000000003, -3.5000000000000004, -3.5000000000000004, -3.600000000000001, -3.2, -3.5000000000000004, -3.1000000000000005, -3.500000000000001, -3.5000000000000004, -3.3000000000000003, -3.500000000000001, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -11.2, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.5000000000000004, -3.3000000000000003, -3.2000000000000006, -3.3000000000000003, -3.4000000000000004, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.4000000000000004, -3.400000000000001, -3.2000000000000006, -3.900000000000001, -3.400000000000001, -3.6000000000000014, -3.6000000000000005, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.7000000000000006, -3.1000000000000005, -3.3000000000000007, -3.4000000000000004, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.600000000000001, -3.3000000000000007, -3.3000000000000007, -12.100000000000001, -3.400000000000001, -3.3000000000000003, -3.1000000000000005, -3.5000000000000004, -3.500000000000001, -3.1000000000000005, -3.400000000000001, -3.2, -3.2, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.200000000000001, -3.200000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.600000000000001, -11.1, -3.500000000000001, -3.400000000000001, -3.300000000000001, -3.500000000000001, 97.8, -3.3000000000000003, -3.0000000000000004, -10.1, -10.3, -3.3000000000000003, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.300000000000001, -3.6000000000000005, -3.400000000000001, -3.2000000000000006, -3.4000000000000004, -3.300000000000001, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.0000000000000004, -3.3000000000000007, -3.3000000000000007, -3.600000000000001, -3.3000000000000007, -3.4000000000000004, -3.200000000000001, -3.500000000000001, -3.4000000000000004, -3.2, -3.100000000000001, -3.200000000000001, -3.2000000000000006, -3.3000000000000007, -3.5000000000000004, -12.2, -11.7, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -10.9, -3.300000000000001, -3.3000000000000007, -3.500000000000001, -3.500000000000001, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.3000000000000003, -3.2, -11.3, -3.0000000000000004, -3.500000000000001, -3.2, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -3.500000000000001, -11.4, -3.3000000000000007, -3.500000000000001, -3.3000000000000007, -3.3000000000000003, -3.300000000000001, -3.400000000000001, -11.4, -10.6, -3.2000000000000006, -3.400000000000001], "episode_lengths": [15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 20, 21, 21, 2, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 16, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 13, 7, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.540959063681404, "mean_inference_ms": 17.435380117472, "mean_action_processing_ms": 0.9119905861583415, "mean_env_wait_ms": 2.19569051212437, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06660451792707348, "StateBufferConnector_ms": 0.00838775827427103, "ViewRequirementAgentConnector_ms": 0.12403100427955088}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 170912.192, "load_time_ms": 1.157, "load_throughput": 3456725.25, "learn_time_ms": 169881.764, "learn_throughput": 23.546, "synch_weights_time_ms": 174.694}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "done": false, "episodes_total": 15523, "training_iteration": 76, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_00-32-26", "timestamp": 1680820346, "time_this_iter_s": 170.67565846443176, "time_total_s": 12997.05466914177, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01475a5dc0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01473a59d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 12997.05466914177, "timesteps_since_restore": 0, "iterations_since_restore": 76, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.38305785123967, "ram_util_percent": 24.11446280991736}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4650115124160243, "cur_kl_coeff": 1.2814453125, "cur_lr": 0.0010000000000000005, "total_loss": 0.39443975424353955, "policy_loss": -0.10641964389992657, "vf_loss": 0.47250416620324054, "vf_explained_var": 0.5775681284807062, "kl": 0.02212754213692425, "entropy": 3.678378871179396, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 71145.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.100000000000001, "episode_reward_mean": -4.118719211822661, "episode_len_mean": 20.221674876847292, "episode_media": {}, "episodes_this_iter": 203, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.2, -3.1000000000000005, -3.400000000000001, -3.2, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.500000000000001, -3.3000000000000003, -3.3000000000000007, -3.3000000000000003, -3.300000000000001, -3.400000000000001, -3.0000000000000004, -3.2000000000000006, -3.5000000000000004, -3.400000000000001, -3.2000000000000006, -11.2, -3.0000000000000004, -3.4000000000000004, -3.400000000000001, -3.4000000000000004, -3.400000000000001, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.5000000000000004, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.600000000000001, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.600000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.5000000000000004, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -11.8, -3.2000000000000006, -3.3000000000000007, -11.6, -11.3, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.2, -3.2000000000000006, -3.1000000000000005, -3.200000000000001, -11.4, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -10.0, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.2, -3.300000000000001, -3.4000000000000004, -3.3000000000000007, -3.2000000000000006, -3.5000000000000004, -11.3, -3.400000000000001, -3.0000000000000004, -3.3000000000000003, -3.2000000000000006, -3.300000000000001, -3.100000000000001, -3.400000000000001, -3.3000000000000003, -3.1000000000000005, -3.100000000000001, -3.0000000000000004, -3.3000000000000007, -3.500000000000001, -11.2, -3.500000000000001, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.600000000000001, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.500000000000001, -11.8, -3.400000000000001, -3.2000000000000006, -3.4000000000000004, -3.3000000000000003, -3.0000000000000004, -11.0, -10.8, -3.3000000000000007, -3.2, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -12.0, -3.400000000000001, -3.3000000000000007, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -11.0, -3.1000000000000005, -3.2000000000000006, -3.5000000000000004, -3.4000000000000004, -11.8, -3.1000000000000005, -3.6000000000000005, -3.3000000000000007, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.100000000000001, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.5000000000000004, -3.1000000000000005, -3.1000000000000005, -3.4000000000000004, -3.3000000000000007, -12.0, -3.3000000000000007, -11.4, -3.2000000000000006, -3.1000000000000005, -10.3, -3.4000000000000004, -3.400000000000001, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.500000000000001, -3.3000000000000007, -3.300000000000001, -3.300000000000001, -3.5000000000000004, -3.2000000000000006, -3.3000000000000003, -3.3000000000000003, -3.7000000000000006, -3.5, -3.300000000000001, -3.3000000000000003, -3.2, -3.400000000000001, -3.3000000000000007, -3.500000000000001, -3.3000000000000003, -3.4000000000000012, -3.4000000000000004, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -11.700000000000001, -12.0, -3.3000000000000007, -3.4000000000000004, -10.7, -12.100000000000001, -3.300000000000001, -3.0000000000000004], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 17, 14, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 10, 9, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 14, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 20, 21, 21, 8, 20, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.534288900856088, "mean_inference_ms": 17.43612881529118, "mean_action_processing_ms": 0.9124106890256902, "mean_env_wait_ms": 2.2031580171369147, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07385115318110423, "StateBufferConnector_ms": 0.009433036954532115, "ViewRequirementAgentConnector_ms": 0.13888469470545575}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.100000000000001, "episode_reward_mean": -4.118719211822661, "episode_len_mean": 20.221674876847292, "episodes_this_iter": 203, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.2, -3.1000000000000005, -3.400000000000001, -3.2, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.500000000000001, -3.3000000000000003, -3.3000000000000007, -3.3000000000000003, -3.300000000000001, -3.400000000000001, -3.0000000000000004, -3.2000000000000006, -3.5000000000000004, -3.400000000000001, -3.2000000000000006, -11.2, -3.0000000000000004, -3.4000000000000004, -3.400000000000001, -3.4000000000000004, -3.400000000000001, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.5000000000000004, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.600000000000001, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.600000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.5000000000000004, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -11.8, -3.2000000000000006, -3.3000000000000007, -11.6, -11.3, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.2, -3.2000000000000006, -3.1000000000000005, -3.200000000000001, -11.4, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -10.0, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.2, -3.300000000000001, -3.4000000000000004, -3.3000000000000007, -3.2000000000000006, -3.5000000000000004, -11.3, -3.400000000000001, -3.0000000000000004, -3.3000000000000003, -3.2000000000000006, -3.300000000000001, -3.100000000000001, -3.400000000000001, -3.3000000000000003, -3.1000000000000005, -3.100000000000001, -3.0000000000000004, -3.3000000000000007, -3.500000000000001, -11.2, -3.500000000000001, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.600000000000001, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.500000000000001, -11.8, -3.400000000000001, -3.2000000000000006, -3.4000000000000004, -3.3000000000000003, -3.0000000000000004, -11.0, -10.8, -3.3000000000000007, -3.2, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -12.0, -3.400000000000001, -3.3000000000000007, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -11.0, -3.1000000000000005, -3.2000000000000006, -3.5000000000000004, -3.4000000000000004, -11.8, -3.1000000000000005, -3.6000000000000005, -3.3000000000000007, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.100000000000001, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.5000000000000004, -3.1000000000000005, -3.1000000000000005, -3.4000000000000004, -3.3000000000000007, -12.0, -3.3000000000000007, -11.4, -3.2000000000000006, -3.1000000000000005, -10.3, -3.4000000000000004, -3.400000000000001, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.500000000000001, -3.3000000000000007, -3.300000000000001, -3.300000000000001, -3.5000000000000004, -3.2000000000000006, -3.3000000000000003, -3.3000000000000003, -3.7000000000000006, -3.5, -3.300000000000001, -3.3000000000000003, -3.2, -3.400000000000001, -3.3000000000000007, -3.500000000000001, -3.3000000000000003, -3.4000000000000012, -3.4000000000000004, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -11.700000000000001, -12.0, -3.3000000000000007, -3.4000000000000004, -10.7, -12.100000000000001, -3.300000000000001, -3.0000000000000004], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 17, 14, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 10, 9, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 14, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 20, 21, 21, 8, 20, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.534288900856088, "mean_inference_ms": 17.43612881529118, "mean_action_processing_ms": 0.9124106890256902, "mean_env_wait_ms": 2.2031580171369147, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07385115318110423, "StateBufferConnector_ms": 0.009433036954532115, "ViewRequirementAgentConnector_ms": 0.13888469470545575}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 308000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 308000, "timers": {"training_iteration_time_ms": 170813.539, "load_time_ms": 1.157, "load_throughput": 3457010.158, "learn_time_ms": 169854.766, "learn_throughput": 23.55, "synch_weights_time_ms": 175.017}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000}, "done": false, "episodes_total": 15726, "training_iteration": 77, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_00-35-17", "timestamp": 1680820517, "time_this_iter_s": 170.71636819839478, "time_total_s": 13167.771037340164, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0147569400>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01474738b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 13167.771037340164, "timesteps_since_restore": 0, "iterations_since_restore": 77, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.348148148148148, "ram_util_percent": 24.108230452674903}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1879374290986728, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.4397559759026814, "policy_loss": -0.10949602259062631, "vf_loss": 0.5189558448910874, "vf_explained_var": 0.5409635245159108, "kl": 0.015761448934070905, "entropy": 3.6733949502309162, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 72075.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.100000000000001, "episode_reward_mean": -4.305769230769231, "episode_len_mean": 19.75, "episode_media": {}, "episodes_this_iter": 208, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.500000000000001, -3.1000000000000005, -3.200000000000001, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -11.5, -3.5000000000000004, -3.5000000000000004, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.500000000000001, -3.1000000000000005, -3.600000000000001, -3.400000000000001, -3.6000000000000005, -3.3000000000000007, -3.6000000000000005, -3.3000000000000007, -3.500000000000001, -3.1000000000000005, -3.300000000000001, -3.7000000000000006, -3.5000000000000013, -11.0, -3.100000000000001, -3.1000000000000005, -11.4, -3.2, -3.3000000000000003, -10.8, -3.2000000000000006, -3.6, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -11.8, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -11.5, -3.500000000000001, -3.4000000000000004, -3.0000000000000004, -3.500000000000001, -3.2000000000000006, -10.9, -3.2000000000000006, -3.2000000000000006, -10.4, -3.200000000000001, -10.6, -3.600000000000001, -3.300000000000001, -3.4000000000000012, -3.4000000000000004, -3.100000000000001, -3.4000000000000004, -3.0000000000000004, -3.4000000000000004, -3.3000000000000007, -3.5000000000000004, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.3000000000000003, -3.600000000000001, -3.400000000000001, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.2, -3.3000000000000003, -3.3000000000000007, -3.3000000000000007, -12.100000000000001, -3.2000000000000006, -10.2, -3.0000000000000004, -11.8, -12.0, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2, -3.3000000000000007, -11.4, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.400000000000001, -3.3000000000000007, -3.4000000000000004, -10.1, -3.3000000000000007, -3.5000000000000004, -3.5000000000000004, -3.4000000000000004, -3.2, -3.3000000000000007, -3.600000000000001, -11.9, -3.2000000000000006, -3.2000000000000006, -10.4, -3.200000000000001, -11.0, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -11.1, -3.1000000000000005, -3.5000000000000004, -10.5, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.200000000000001, -3.1000000000000005, -3.2000000000000006, -10.4, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -12.0, -3.3000000000000007, -11.4, -3.2000000000000006, -3.600000000000001, -10.3, -3.2000000000000006, -11.5, -3.400000000000001, -3.500000000000001, -3.400000000000001, -3.100000000000001, -3.8000000000000007, -3.2000000000000006, -3.4000000000000004, -3.5000000000000004, -3.3000000000000003, -3.600000000000001, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.500000000000001, -3.3000000000000003, -3.300000000000001, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.5000000000000004, -3.3000000000000007, -11.8, -3.500000000000001, -11.0, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.2000000000000006], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 13, 21, 21, 9, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 10, 21, 21, 5, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 3, 21, 18, 18, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 5, 21, 11, 21, 21, 21, 21, 21, 21, 11, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 16, 21, 14, 21, 21, 4, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 10, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.530115868878072, "mean_inference_ms": 17.426039259341987, "mean_action_processing_ms": 0.9117198308810204, "mean_env_wait_ms": 2.2022055350664433, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07163137197494507, "StateBufferConnector_ms": 0.00886149131334745, "ViewRequirementAgentConnector_ms": 0.13044487971525925}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.100000000000001, "episode_reward_mean": -4.305769230769231, "episode_len_mean": 19.75, "episodes_this_iter": 208, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.500000000000001, -3.1000000000000005, -3.200000000000001, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -11.5, -3.5000000000000004, -3.5000000000000004, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.500000000000001, -3.1000000000000005, -3.600000000000001, -3.400000000000001, -3.6000000000000005, -3.3000000000000007, -3.6000000000000005, -3.3000000000000007, -3.500000000000001, -3.1000000000000005, -3.300000000000001, -3.7000000000000006, -3.5000000000000013, -11.0, -3.100000000000001, -3.1000000000000005, -11.4, -3.2, -3.3000000000000003, -10.8, -3.2000000000000006, -3.6, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -11.8, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -11.5, -3.500000000000001, -3.4000000000000004, -3.0000000000000004, -3.500000000000001, -3.2000000000000006, -10.9, -3.2000000000000006, -3.2000000000000006, -10.4, -3.200000000000001, -10.6, -3.600000000000001, -3.300000000000001, -3.4000000000000012, -3.4000000000000004, -3.100000000000001, -3.4000000000000004, -3.0000000000000004, -3.4000000000000004, -3.3000000000000007, -3.5000000000000004, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.3000000000000003, -3.600000000000001, -3.400000000000001, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.2, -3.3000000000000003, -3.3000000000000007, -3.3000000000000007, -12.100000000000001, -3.2000000000000006, -10.2, -3.0000000000000004, -11.8, -12.0, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2, -3.3000000000000007, -11.4, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.400000000000001, -3.3000000000000007, -3.4000000000000004, -10.1, -3.3000000000000007, -3.5000000000000004, -3.5000000000000004, -3.4000000000000004, -3.2, -3.3000000000000007, -3.600000000000001, -11.9, -3.2000000000000006, -3.2000000000000006, -10.4, -3.200000000000001, -11.0, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -11.1, -3.1000000000000005, -3.5000000000000004, -10.5, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.200000000000001, -3.1000000000000005, -3.2000000000000006, -10.4, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -12.0, -3.3000000000000007, -11.4, -3.2000000000000006, -3.600000000000001, -10.3, -3.2000000000000006, -11.5, -3.400000000000001, -3.500000000000001, -3.400000000000001, -3.100000000000001, -3.8000000000000007, -3.2000000000000006, -3.4000000000000004, -3.5000000000000004, -3.3000000000000003, -3.600000000000001, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.500000000000001, -3.3000000000000003, -3.300000000000001, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.5000000000000004, -3.3000000000000007, -11.8, -3.500000000000001, -11.0, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.2000000000000006], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 13, 21, 21, 9, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 10, 21, 21, 5, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 3, 21, 18, 18, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 5, 21, 11, 21, 21, 21, 21, 21, 21, 11, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 16, 21, 14, 21, 21, 4, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 10, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.530115868878072, "mean_inference_ms": 17.426039259341987, "mean_action_processing_ms": 0.9117198308810204, "mean_env_wait_ms": 2.2022055350664433, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07163137197494507, "StateBufferConnector_ms": 0.00886149131334745, "ViewRequirementAgentConnector_ms": 0.13044487971525925}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 312000, "timers": {"training_iteration_time_ms": 170790.812, "load_time_ms": 1.182, "load_throughput": 3384550.333, "learn_time_ms": 169832.38, "learn_throughput": 23.553, "synch_weights_time_ms": 174.33}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "done": false, "episodes_total": 15934, "training_iteration": 78, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_00-38-07", "timestamp": 1680820687, "time_this_iter_s": 170.69500470161438, "time_total_s": 13338.466042041779, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0147569dc0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01473a54c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 13338.466042041779, "timesteps_since_restore": 0, "iterations_since_restore": 78, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.5436213991769545, "ram_util_percent": 24.12716049382716}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.449730906827796, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.37695607801859254, "policy_loss": -0.033042341667177066, "vf_loss": 0.3996261596153941, "vf_explained_var": 0.5805762898537421, "kl": 0.005396125717270088, "entropy": 3.6697704351076514, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 73005.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 316000}, "sampler_results": {"episode_reward_max": 98.9, "episode_reward_min": -12.100000000000001, "episode_reward_mean": -3.492631578947369, "episode_len_mean": 20.07894736842105, "episode_media": {}, "episodes_this_iter": 190, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.100000000000001, -3.5000000000000004, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.5000000000000004, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.4000000000000004, -3.5000000000000004, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -10.7, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.500000000000001, -3.200000000000001, -3.400000000000001, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.0000000000000004, -3.600000000000001, -3.1000000000000005, -3.1000000000000005, -3.4, -3.2000000000000006, -3.3000000000000003, -3.4000000000000004, -3.2000000000000006, -11.4, -3.500000000000001, -3.4000000000000004, -12.0, -3.3000000000000003, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.5000000000000004, -11.2, -3.3000000000000007, -3.4000000000000012, -3.2000000000000006, -3.2, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -3.5000000000000004, -3.2000000000000006, -3.1000000000000005, -3.5000000000000004, -3.4000000000000004, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.3000000000000003, 98.9, -3.3000000000000007, -3.500000000000001, -3.3000000000000003, -12.0, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.4000000000000004, -3.500000000000001, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.200000000000001, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.600000000000001, -3.4000000000000004, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -3.500000000000001, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -11.6, -3.1000000000000005, -10.6, -3.1000000000000005, -3.400000000000001, -3.4000000000000004, -3.3000000000000007, -12.100000000000001, -3.2000000000000006, -3.5000000000000013, -11.1, -3.6000000000000005, -3.400000000000001, -3.500000000000001, -10.4, -3.2000000000000006, -10.1, -3.4000000000000004, -3.2000000000000006, -10.7, -3.4000000000000004, -3.1000000000000005, -3.300000000000001, -3.3000000000000007, -10.7, -3.2, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.5000000000000004, -3.400000000000001, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -11.1, -3.1000000000000005, -10.9, -3.2000000000000006, -3.6000000000000005, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.0000000000000004, -3.100000000000001, -3.500000000000001, -3.400000000000001, -3.300000000000001, -3.3000000000000007, -3.500000000000001, -11.9, -3.3000000000000007, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.2, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.8000000000000007, -3.700000000000001, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -11.6, -3.0000000000000004, -3.1000000000000005, -3.400000000000001, -11.0, -3.1000000000000005, -3.5000000000000004, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.2, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.400000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 17, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 6, 21, 21, 21, 21, 20, 21, 21, 11, 21, 21, 21, 5, 21, 2, 21, 21, 8, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.529513889989484, "mean_inference_ms": 17.416996160428656, "mean_action_processing_ms": 0.91234004157429, "mean_env_wait_ms": 2.203823015341338, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07285180844758686, "StateBufferConnector_ms": 0.009491318150570518, "ViewRequirementAgentConnector_ms": 0.13481378555297852}}, "episode_reward_max": 98.9, "episode_reward_min": -12.100000000000001, "episode_reward_mean": -3.492631578947369, "episode_len_mean": 20.07894736842105, "episodes_this_iter": 190, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.100000000000001, -3.5000000000000004, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.5000000000000004, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.4000000000000004, -3.5000000000000004, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -10.7, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.500000000000001, -3.200000000000001, -3.400000000000001, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.0000000000000004, -3.600000000000001, -3.1000000000000005, -3.1000000000000005, -3.4, -3.2000000000000006, -3.3000000000000003, -3.4000000000000004, -3.2000000000000006, -11.4, -3.500000000000001, -3.4000000000000004, -12.0, -3.3000000000000003, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.5000000000000004, -11.2, -3.3000000000000007, -3.4000000000000012, -3.2000000000000006, -3.2, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -3.5000000000000004, -3.2000000000000006, -3.1000000000000005, -3.5000000000000004, -3.4000000000000004, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.3000000000000003, 98.9, -3.3000000000000007, -3.500000000000001, -3.3000000000000003, -12.0, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.4000000000000004, -3.500000000000001, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.200000000000001, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.600000000000001, -3.4000000000000004, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -3.500000000000001, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -11.6, -3.1000000000000005, -10.6, -3.1000000000000005, -3.400000000000001, -3.4000000000000004, -3.3000000000000007, -12.100000000000001, -3.2000000000000006, -3.5000000000000013, -11.1, -3.6000000000000005, -3.400000000000001, -3.500000000000001, -10.4, -3.2000000000000006, -10.1, -3.4000000000000004, -3.2000000000000006, -10.7, -3.4000000000000004, -3.1000000000000005, -3.300000000000001, -3.3000000000000007, -10.7, -3.2, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.5000000000000004, -3.400000000000001, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -11.1, -3.1000000000000005, -10.9, -3.2000000000000006, -3.6000000000000005, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.0000000000000004, -3.100000000000001, -3.500000000000001, -3.400000000000001, -3.300000000000001, -3.3000000000000007, -3.500000000000001, -11.9, -3.3000000000000007, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.2, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.8000000000000007, -3.700000000000001, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -11.6, -3.0000000000000004, -3.1000000000000005, -3.400000000000001, -11.0, -3.1000000000000005, -3.5000000000000004, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.2, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.400000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 17, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 6, 21, 21, 21, 21, 20, 21, 21, 11, 21, 21, 21, 5, 21, 2, 21, 21, 8, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.529513889989484, "mean_inference_ms": 17.416996160428656, "mean_action_processing_ms": 0.91234004157429, "mean_env_wait_ms": 2.203823015341338, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07285180844758686, "StateBufferConnector_ms": 0.009491318150570518, "ViewRequirementAgentConnector_ms": 0.13481378555297852}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 316000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 316000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 316000, "timers": {"training_iteration_time_ms": 170776.543, "load_time_ms": 1.271, "load_throughput": 3146042.604, "learn_time_ms": 169821.39, "learn_throughput": 23.554, "synch_weights_time_ms": 173.751}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 316000}, "done": false, "episodes_total": 16124, "training_iteration": 79, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_00-40-58", "timestamp": 1680820858, "time_this_iter_s": 171.07532739639282, "time_total_s": 13509.541369438171, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01474235e0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014740d9d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 13509.541369438171, "timesteps_since_restore": 0, "iterations_since_restore": 79, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.321810699588478, "ram_util_percent": 24.169547325102872}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3678553463710892, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.49327167642292796, "policy_loss": -0.03295029133398046, "vf_loss": 0.5062786738593532, "vf_explained_var": 0.49671432760453993, "kl": 0.010375418419363253, "entropy": 3.66396491630103, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 73935.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "sampler_results": {"episode_reward_max": 99.2, "episode_reward_min": -12.2, "episode_reward_mean": -2.6502512562814076, "episode_len_mean": 19.798994974874372, "episode_media": {}, "episodes_this_iter": 199, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.4, -10.4, -3.1000000000000005, -10.8, -3.300000000000001, -3.600000000000001, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.500000000000001, -3.100000000000001, -3.200000000000001, -3.500000000000001, -3.300000000000001, -3.1000000000000005, -3.2, -3.3000000000000007, -3.400000000000001, -3.500000000000001, -3.4000000000000004, -3.2000000000000006, -11.8, -3.100000000000001, -3.1000000000000005, -11.8, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.500000000000001, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.0000000000000004, -3.3000000000000003, -3.2000000000000006, -11.1, -3.400000000000001, -3.3000000000000003, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -11.9, -11.0, -3.500000000000001, -3.400000000000001, -10.4, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.2, -10.4, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -10.6, -3.3000000000000007, -3.200000000000001, -3.2, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.300000000000001, -3.300000000000001, -12.2, -3.4000000000000004, -3.6000000000000005, -3.2000000000000006, -3.600000000000001, -3.3000000000000007, -3.300000000000001, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -10.4, -3.0000000000000004, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.200000000000001, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.600000000000001, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -10.5, -3.400000000000001, -3.0000000000000004, -3.1000000000000005, -12.100000000000001, -3.2000000000000006, -11.2, -3.4000000000000004, -3.1000000000000005, -3.0000000000000004, -3.400000000000001, -3.1000000000000005, -11.5, -3.2000000000000006, -3.1000000000000005, 98.7, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -11.8, -3.5000000000000004, -3.4000000000000004, -3.300000000000001, -3.0000000000000004, -3.200000000000001, -3.2000000000000006, -11.6, -3.1000000000000005, -3.2, -3.3000000000000007, -3.5000000000000004, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.600000000000001, 99.2, -3.3000000000000007, -10.2, -3.400000000000001, 98.1, -11.6, -3.500000000000001, -3.1000000000000005, -11.8, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -11.3, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.500000000000001, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.200000000000001, -3.7000000000000006, -3.6000000000000005, -3.4000000000000004, -3.5000000000000004, -3.1000000000000005, -3.500000000000001, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.4000000000000004, -3.0000000000000004, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.700000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.0000000000000004, -3.4000000000000004, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.4000000000000004, -3.500000000000001, -3.2, -3.2000000000000006, -3.2000000000000006], "episode_lengths": [5, 5, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 17, 9, 21, 21, 5, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 19, 21, 13, 21, 21, 21, 21, 21, 15, 21, 21, 13, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 3, 21, 18, 16, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.524534772262806, "mean_inference_ms": 17.439043773059527, "mean_action_processing_ms": 0.9124606523266575, "mean_env_wait_ms": 2.2036311673571904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07669099012211938, "StateBufferConnector_ms": 0.009500561048038042, "ViewRequirementAgentConnector_ms": 0.14042722519917702}}, "episode_reward_max": 99.2, "episode_reward_min": -12.2, "episode_reward_mean": -2.6502512562814076, "episode_len_mean": 19.798994974874372, "episodes_this_iter": 199, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10.4, -10.4, -3.1000000000000005, -10.8, -3.300000000000001, -3.600000000000001, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.500000000000001, -3.100000000000001, -3.200000000000001, -3.500000000000001, -3.300000000000001, -3.1000000000000005, -3.2, -3.3000000000000007, -3.400000000000001, -3.500000000000001, -3.4000000000000004, -3.2000000000000006, -11.8, -3.100000000000001, -3.1000000000000005, -11.8, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.500000000000001, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.0000000000000004, -3.3000000000000003, -3.2000000000000006, -11.1, -3.400000000000001, -3.3000000000000003, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -11.9, -11.0, -3.500000000000001, -3.400000000000001, -10.4, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.2, -10.4, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -10.6, -3.3000000000000007, -3.200000000000001, -3.2, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.300000000000001, -3.300000000000001, -12.2, -3.4000000000000004, -3.6000000000000005, -3.2000000000000006, -3.600000000000001, -3.3000000000000007, -3.300000000000001, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -10.4, -3.0000000000000004, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.200000000000001, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.600000000000001, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -10.5, -3.400000000000001, -3.0000000000000004, -3.1000000000000005, -12.100000000000001, -3.2000000000000006, -11.2, -3.4000000000000004, -3.1000000000000005, -3.0000000000000004, -3.400000000000001, -3.1000000000000005, -11.5, -3.2000000000000006, -3.1000000000000005, 98.7, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -11.8, -3.5000000000000004, -3.4000000000000004, -3.300000000000001, -3.0000000000000004, -3.200000000000001, -3.2000000000000006, -11.6, -3.1000000000000005, -3.2, -3.3000000000000007, -3.5000000000000004, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.600000000000001, 99.2, -3.3000000000000007, -10.2, -3.400000000000001, 98.1, -11.6, -3.500000000000001, -3.1000000000000005, -11.8, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -11.3, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.500000000000001, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.200000000000001, -3.7000000000000006, -3.6000000000000005, -3.4000000000000004, -3.5000000000000004, -3.1000000000000005, -3.500000000000001, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.4000000000000004, -3.0000000000000004, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.700000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.0000000000000004, -3.4000000000000004, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.4000000000000004, -3.500000000000001, -3.2, -3.2000000000000006, -3.2000000000000006], "episode_lengths": [5, 5, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 17, 9, 21, 21, 5, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 19, 21, 13, 21, 21, 21, 21, 21, 15, 21, 21, 13, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 3, 21, 18, 16, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.524534772262806, "mean_inference_ms": 17.439043773059527, "mean_action_processing_ms": 0.9124606523266575, "mean_env_wait_ms": 2.2036311673571904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07669099012211938, "StateBufferConnector_ms": 0.009500561048038042, "ViewRequirementAgentConnector_ms": 0.14042722519917702}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 170858.065, "load_time_ms": 1.299, "load_throughput": 3078557.719, "learn_time_ms": 169910.839, "learn_throughput": 23.542, "synch_weights_time_ms": 173.258}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "episodes_total": 16323, "training_iteration": 80, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_00-43-51", "timestamp": 1680821031, "time_this_iter_s": 172.28036189079285, "time_total_s": 13681.821731328964, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01477a3c40>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01474a85e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 13681.821731328964, "timesteps_since_restore": 0, "iterations_since_restore": 80, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.308163265306122, "ram_util_percent": 24.132653061224488}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3639951789411164, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.2523634978379774, "policy_loss": -0.09094772309825946, "vf_loss": 0.31467002022771107, "vf_explained_var": 0.5626065408670774, "kl": 0.014900466566154312, "entropy": 3.650658113725724, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 74865.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.200000000000001, "episode_reward_mean": -3.951063829787235, "episode_len_mean": 20.22340425531915, "episode_media": {}, "episodes_this_iter": 188, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.2, -3.0000000000000004, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.0000000000000004, -3.2, -3.5000000000000004, -3.400000000000001, -11.5, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.200000000000001, -3.2000000000000006, -3.5000000000000004, -3.4000000000000004, -10.5, -3.500000000000001, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.500000000000001, -3.1000000000000005, -3.4000000000000004, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.1000000000000005, -3.500000000000001, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.0000000000000004, -3.2000000000000006, -3.5000000000000004, -3.3000000000000007, -10.4, -3.1000000000000005, -3.400000000000001, -3.300000000000001, -3.5000000000000004, -3.2000000000000006, -3.3000000000000003, -3.0000000000000004, -3.2000000000000006, -3.500000000000001, -3.3000000000000007, -3.1000000000000005, -3.5000000000000004, -3.6000000000000005, -10.8, -3.4000000000000004, -3.2, -3.500000000000001, -3.5000000000000004, -3.3000000000000003, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -11.1, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.400000000000001, -3.500000000000001, -3.5000000000000004, -3.3000000000000007, -3.100000000000001, -3.500000000000001, -3.5000000000000004, -3.3000000000000007, -3.2000000000000006, -3.500000000000001, -3.5000000000000004, -3.4000000000000004, -10.3, -3.2000000000000006, -3.400000000000001, -11.9, -3.2000000000000006, -3.5000000000000004, -3.0000000000000004, -3.3000000000000007, -3.2, -3.2, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.0000000000000004, -10.1, -3.200000000000001, -3.3000000000000007, -3.2, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.0000000000000004, -3.3000000000000003, -3.4000000000000004, -12.0, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.6000000000000005, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.300000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -12.200000000000001, -3.3000000000000003, -3.2000000000000006, -10.9, -11.4, -3.2000000000000006, -3.400000000000001, -3.4000000000000004, -3.3000000000000003, -3.200000000000001, -3.3000000000000007, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.500000000000001, -11.2, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.5000000000000004, -3.2, -3.2000000000000006, -10.7, -3.1000000000000005, -3.5000000000000004, -3.6000000000000005, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.600000000000001, -3.400000000000001, -3.400000000000001, -3.5000000000000004, -3.4000000000000004, -3.1000000000000005, -3.2, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -11.700000000000001, -3.1000000000000005, -3.400000000000001, -3.2, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -11.9], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 10, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.523446052438413, "mean_inference_ms": 17.431471674266454, "mean_action_processing_ms": 0.9111164920727824, "mean_env_wait_ms": 2.2013726672174636, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07637307998981882, "StateBufferConnector_ms": 0.009464583498366336, "ViewRequirementAgentConnector_ms": 0.13953320523525806}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.200000000000001, "episode_reward_mean": -3.951063829787235, "episode_len_mean": 20.22340425531915, "episodes_this_iter": 188, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.2, -3.0000000000000004, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.0000000000000004, -3.2, -3.5000000000000004, -3.400000000000001, -11.5, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.200000000000001, -3.2000000000000006, -3.5000000000000004, -3.4000000000000004, -10.5, -3.500000000000001, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.500000000000001, -3.1000000000000005, -3.4000000000000004, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.1000000000000005, -3.500000000000001, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.0000000000000004, -3.2000000000000006, -3.5000000000000004, -3.3000000000000007, -10.4, -3.1000000000000005, -3.400000000000001, -3.300000000000001, -3.5000000000000004, -3.2000000000000006, -3.3000000000000003, -3.0000000000000004, -3.2000000000000006, -3.500000000000001, -3.3000000000000007, -3.1000000000000005, -3.5000000000000004, -3.6000000000000005, -10.8, -3.4000000000000004, -3.2, -3.500000000000001, -3.5000000000000004, -3.3000000000000003, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -11.1, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.400000000000001, -3.500000000000001, -3.5000000000000004, -3.3000000000000007, -3.100000000000001, -3.500000000000001, -3.5000000000000004, -3.3000000000000007, -3.2000000000000006, -3.500000000000001, -3.5000000000000004, -3.4000000000000004, -10.3, -3.2000000000000006, -3.400000000000001, -11.9, -3.2000000000000006, -3.5000000000000004, -3.0000000000000004, -3.3000000000000007, -3.2, -3.2, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.0000000000000004, -10.1, -3.200000000000001, -3.3000000000000007, -3.2, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.0000000000000004, -3.3000000000000003, -3.4000000000000004, -12.0, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.6000000000000005, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.300000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -12.200000000000001, -3.3000000000000003, -3.2000000000000006, -10.9, -11.4, -3.2000000000000006, -3.400000000000001, -3.4000000000000004, -3.3000000000000003, -3.200000000000001, -3.3000000000000007, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.500000000000001, -11.2, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.5000000000000004, -3.2, -3.2000000000000006, -10.7, -3.1000000000000005, -3.5000000000000004, -3.6000000000000005, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.600000000000001, -3.400000000000001, -3.400000000000001, -3.5000000000000004, -3.4000000000000004, -3.1000000000000005, -3.2, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -11.700000000000001, -3.1000000000000005, -3.400000000000001, -3.2, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -11.9], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 10, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.523446052438413, "mean_inference_ms": 17.431471674266454, "mean_action_processing_ms": 0.9111164920727824, "mean_env_wait_ms": 2.2013726672174636, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07637307998981882, "StateBufferConnector_ms": 0.009464583498366336, "ViewRequirementAgentConnector_ms": 0.13953320523525806}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 324000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 324000, "timers": {"training_iteration_time_ms": 170917.735, "load_time_ms": 1.295, "load_throughput": 3089271.562, "learn_time_ms": 169970.139, "learn_throughput": 23.534, "synch_weights_time_ms": 172.952}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "done": false, "episodes_total": 16511, "training_iteration": 81, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_00-46-42", "timestamp": 1680821202, "time_this_iter_s": 171.2113926410675, "time_total_s": 13853.033123970032, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0147791520>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01474a81f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 13853.033123970032, "timesteps_since_restore": 0, "iterations_since_restore": 81, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.577459016393443, "ram_util_percent": 24.13565573770492}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3847810209678706, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.20047504652156345, "policy_loss": -0.02616837089627816, "vf_loss": 0.21463255383504895, "vf_explained_var": 0.7105568603161843, "kl": 0.006248601312093156, "entropy": 3.647464910373893, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 75795.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000}, "sampler_results": {"episode_reward_max": 99.3, "episode_reward_min": -11.8, "episode_reward_mean": -3.1846938775510205, "episode_len_mean": 20.25, "episode_media": {}, "episodes_this_iter": 196, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0000000000000004, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.300000000000001, -3.2000000000000006, -3.3000000000000007, -3.300000000000001, -3.5000000000000004, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.2, -3.3000000000000007, -3.7000000000000006, -3.2, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, -3.3000000000000003, -3.5000000000000004, -3.3000000000000007, -3.300000000000001, -3.2000000000000006, -3.2, -3.2000000000000006, -3.3000000000000007, -10.0, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -11.5, -3.200000000000001, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.500000000000001, -3.400000000000001, -3.3000000000000007, -3.4000000000000004, -3.400000000000001, -11.5, -3.5000000000000004, -3.700000000000001, -3.300000000000001, -3.2000000000000006, -10.1, -11.1, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -10.5, -3.0000000000000004, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -10.5, -3.4000000000000004, -3.3000000000000007, -3.100000000000001, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.7000000000000006, -3.500000000000001, -3.2, -3.400000000000001, -3.200000000000001, -3.3000000000000003, -3.0000000000000004, -3.7000000000000006, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.500000000000001, -11.0, -3.4000000000000004, -3.1000000000000005, -3.5000000000000004, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.3000000000000003, -3.500000000000001, -3.3000000000000003, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.0000000000000004, -11.8, -3.2, -3.2000000000000006, -3.5000000000000004, -3.1000000000000005, -3.2000000000000006, -3.200000000000001, -3.2000000000000006, -3.6000000000000005, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -10.2, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.500000000000001, -3.400000000000001, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.2, -3.0000000000000004, -3.3000000000000007, -3.600000000000001, -3.2000000000000006, -3.2000000000000006, -3.100000000000001, -3.5000000000000004, -3.600000000000001, -3.100000000000001, -3.400000000000001, -3.3000000000000007, -3.600000000000001, -3.2, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, 99.3, -11.3, -3.5000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.6000000000000005, -3.5000000000000004, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.500000000000001, -3.500000000000001, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.100000000000001, -3.400000000000001, -3.4000000000000004, -3.3000000000000007, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.3000000000000007, -3.6000000000000005, -3.3000000000000003], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 2, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.520403056015494, "mean_inference_ms": 17.423350688043048, "mean_action_processing_ms": 0.9117130134121959, "mean_env_wait_ms": 2.2064116434059504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07797905376979283, "StateBufferConnector_ms": 0.010301142322773836, "ViewRequirementAgentConnector_ms": 0.14245996669847139}}, "episode_reward_max": 99.3, "episode_reward_min": -11.8, "episode_reward_mean": -3.1846938775510205, "episode_len_mean": 20.25, "episodes_this_iter": 196, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.0000000000000004, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.300000000000001, -3.2000000000000006, -3.3000000000000007, -3.300000000000001, -3.5000000000000004, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.2, -3.3000000000000007, -3.7000000000000006, -3.2, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, -3.3000000000000003, -3.5000000000000004, -3.3000000000000007, -3.300000000000001, -3.2000000000000006, -3.2, -3.2000000000000006, -3.3000000000000007, -10.0, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -11.5, -3.200000000000001, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.500000000000001, -3.400000000000001, -3.3000000000000007, -3.4000000000000004, -3.400000000000001, -11.5, -3.5000000000000004, -3.700000000000001, -3.300000000000001, -3.2000000000000006, -10.1, -11.1, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -10.5, -3.0000000000000004, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -10.5, -3.4000000000000004, -3.3000000000000007, -3.100000000000001, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.7000000000000006, -3.500000000000001, -3.2, -3.400000000000001, -3.200000000000001, -3.3000000000000003, -3.0000000000000004, -3.7000000000000006, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.500000000000001, -11.0, -3.4000000000000004, -3.1000000000000005, -3.5000000000000004, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.3000000000000003, -3.500000000000001, -3.3000000000000003, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.0000000000000004, -11.8, -3.2, -3.2000000000000006, -3.5000000000000004, -3.1000000000000005, -3.2000000000000006, -3.200000000000001, -3.2000000000000006, -3.6000000000000005, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -10.2, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.500000000000001, -3.400000000000001, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.2, -3.0000000000000004, -3.3000000000000007, -3.600000000000001, -3.2000000000000006, -3.2000000000000006, -3.100000000000001, -3.5000000000000004, -3.600000000000001, -3.100000000000001, -3.400000000000001, -3.3000000000000007, -3.600000000000001, -3.2, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, 99.3, -11.3, -3.5000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.6000000000000005, -3.5000000000000004, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.500000000000001, -3.500000000000001, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.100000000000001, -3.400000000000001, -3.4000000000000004, -3.3000000000000007, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.3000000000000007, -3.6000000000000005, -3.3000000000000003], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 2, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.520403056015494, "mean_inference_ms": 17.423350688043048, "mean_action_processing_ms": 0.9117130134121959, "mean_env_wait_ms": 2.2064116434059504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07797905376979283, "StateBufferConnector_ms": 0.010301142322773836, "ViewRequirementAgentConnector_ms": 0.14245996669847139}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 328000, "timers": {"training_iteration_time_ms": 170940.81, "load_time_ms": 1.301, "load_throughput": 3075453.879, "learn_time_ms": 169991.554, "learn_throughput": 23.531, "synch_weights_time_ms": 173.296}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000}, "done": false, "episodes_total": 16707, "training_iteration": 82, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_00-49-33", "timestamp": 1680821373, "time_this_iter_s": 170.99058365821838, "time_total_s": 14024.02370762825, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0147423820>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0147488ee0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 14024.02370762825, "timesteps_since_restore": 0, "iterations_since_restore": 82, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.35514403292181, "ram_util_percent": 24.183127572016453}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5661214042414902, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.40295877334090974, "policy_loss": -0.03407373215842952, "vf_loss": 0.4202046001565352, "vf_explained_var": 0.56473696859934, "kl": 0.00875464723623384, "entropy": 3.6539923665344074, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 76725.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 332000}, "sampler_results": {"episode_reward_max": 99.1, "episode_reward_min": -12.100000000000001, "episode_reward_mean": -2.900000000000001, "episode_len_mean": 20.182266009852217, "episode_media": {}, "episodes_this_iter": 203, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.400000000000001, -3.2000000000000006, -3.0000000000000004, -3.500000000000001, -3.3000000000000007, -11.4, -3.4000000000000004, -3.2000000000000006, -3.4000000000000004, -3.4000000000000004, -3.1000000000000005, -3.4000000000000012, -3.2000000000000006, -3.2000000000000006, -3.5000000000000004, -3.1000000000000005, -3.3000000000000007, -3.4000000000000004, -3.700000000000001, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.4000000000000012, -3.2, -3.4000000000000004, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.500000000000001, -3.1000000000000005, -3.400000000000001, -3.3000000000000003, -3.400000000000001, -3.5000000000000004, -3.3000000000000003, -3.3000000000000007, -11.0, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.500000000000001, -3.3000000000000007, -3.2, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.4000000000000004, -3.3000000000000007, 98.4, -3.3000000000000007, -3.4000000000000012, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.5, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -11.1, -3.600000000000001, -3.4000000000000004, -3.2000000000000006, -3.4000000000000004, -10.3, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.500000000000001, -3.1000000000000005, -11.0, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.2, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.4000000000000012, -3.1000000000000005, -3.3000000000000003, -3.5000000000000004, -3.1000000000000005, -3.0000000000000004, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -10.8, -3.300000000000001, -3.3000000000000003, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.100000000000001, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -12.100000000000001, -3.2, -3.2000000000000006, -3.500000000000001, -3.2000000000000006, -11.700000000000001, -3.1000000000000005, -3.4000000000000004, -3.400000000000001, -3.6000000000000005, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -11.1, -3.5000000000000004, -3.1000000000000005, -10.1, -3.500000000000001, -3.2000000000000006, -11.8, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.400000000000001, -3.4000000000000012, -3.2000000000000006, -3.400000000000001, 99.1, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.500000000000001, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -10.6, -11.1, -3.6000000000000005, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.5000000000000004, -3.3000000000000003, -3.3000000000000007, -3.3000000000000007, -3.100000000000001, -11.5, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.500000000000001, -3.700000000000001, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.400000000000001, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.4000000000000004, -3.2, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.100000000000001, -3.3000000000000007, -11.2, -12.0, -3.400000000000001, -3.6000000000000005, -3.600000000000001, -3.800000000000001, -3.1000000000000005], "episode_lengths": [21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 2, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 18, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.513084416632944, "mean_inference_ms": 17.42859479019391, "mean_action_processing_ms": 0.9120971610800006, "mean_env_wait_ms": 2.206947213339155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07719007031670932, "StateBufferConnector_ms": 0.010300857092946621, "ViewRequirementAgentConnector_ms": 0.14378824844736185}}, "episode_reward_max": 99.1, "episode_reward_min": -12.100000000000001, "episode_reward_mean": -2.900000000000001, "episode_len_mean": 20.182266009852217, "episodes_this_iter": 203, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.400000000000001, -3.2000000000000006, -3.0000000000000004, -3.500000000000001, -3.3000000000000007, -11.4, -3.4000000000000004, -3.2000000000000006, -3.4000000000000004, -3.4000000000000004, -3.1000000000000005, -3.4000000000000012, -3.2000000000000006, -3.2000000000000006, -3.5000000000000004, -3.1000000000000005, -3.3000000000000007, -3.4000000000000004, -3.700000000000001, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.4000000000000012, -3.2, -3.4000000000000004, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.500000000000001, -3.1000000000000005, -3.400000000000001, -3.3000000000000003, -3.400000000000001, -3.5000000000000004, -3.3000000000000003, -3.3000000000000007, -11.0, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.500000000000001, -3.3000000000000007, -3.2, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.4000000000000004, -3.3000000000000007, 98.4, -3.3000000000000007, -3.4000000000000012, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.5, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -11.1, -3.600000000000001, -3.4000000000000004, -3.2000000000000006, -3.4000000000000004, -10.3, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.500000000000001, -3.1000000000000005, -11.0, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.2, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.4000000000000012, -3.1000000000000005, -3.3000000000000003, -3.5000000000000004, -3.1000000000000005, -3.0000000000000004, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -10.8, -3.300000000000001, -3.3000000000000003, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.100000000000001, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -12.100000000000001, -3.2, -3.2000000000000006, -3.500000000000001, -3.2000000000000006, -11.700000000000001, -3.1000000000000005, -3.4000000000000004, -3.400000000000001, -3.6000000000000005, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -11.1, -3.5000000000000004, -3.1000000000000005, -10.1, -3.500000000000001, -3.2000000000000006, -11.8, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.400000000000001, -3.4000000000000012, -3.2000000000000006, -3.400000000000001, 99.1, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.500000000000001, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -10.6, -11.1, -3.6000000000000005, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.5000000000000004, -3.3000000000000003, -3.3000000000000007, -3.3000000000000007, -3.100000000000001, -11.5, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.500000000000001, -3.700000000000001, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.400000000000001, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.4000000000000004, -3.2, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.100000000000001, -3.3000000000000007, -11.2, -12.0, -3.400000000000001, -3.6000000000000005, -3.600000000000001, -3.800000000000001, -3.1000000000000005], "episode_lengths": [21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 2, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 18, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.513084416632944, "mean_inference_ms": 17.42859479019391, "mean_action_processing_ms": 0.9120971610800006, "mean_env_wait_ms": 2.206947213339155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07719007031670932, "StateBufferConnector_ms": 0.010300857092946621, "ViewRequirementAgentConnector_ms": 0.14378824844736185}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 332000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 332000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 332000, "timers": {"training_iteration_time_ms": 170962.663, "load_time_ms": 1.3, "load_throughput": 3075904.957, "learn_time_ms": 170009.653, "learn_throughput": 23.528, "synch_weights_time_ms": 173.963}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 332000}, "done": false, "episodes_total": 16910, "training_iteration": 83, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_00-52-24", "timestamp": 1680821544, "time_this_iter_s": 170.69088172912598, "time_total_s": 14194.714589357376, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01477912b0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01474a8940>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 14194.714589357376, "timesteps_since_restore": 0, "iterations_since_restore": 83, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.354958677685951, "ram_util_percent": 24.188016528925612}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3261822288395255, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.3785479597156487, "policy_loss": -0.0558533989749248, "vf_loss": 0.41280551311529934, "vf_explained_var": 0.4905783014912759, "kl": 0.011235148847473645, "entropy": 3.647303900667416, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 77655.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "sampler_results": {"episode_reward_max": 99.9, "episode_reward_min": -12.4, "episode_reward_mean": -3.6078431372549025, "episode_len_mean": 19.808823529411764, "episode_media": {}, "episodes_this_iter": 204, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3000000000000003, -3.0000000000000004, -3.3000000000000003, -10.2, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.0000000000000004, -3.500000000000001, -3.0000000000000004, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.7000000000000006, -3.3000000000000007, -3.400000000000001, -3.5000000000000004, -3.4000000000000004, -3.600000000000001, -3.2000000000000006, -3.400000000000001, -11.3, -3.100000000000001, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.2, -10.0, -3.400000000000001, -3.1000000000000005, -3.4000000000000004, -3.3000000000000007, -3.5000000000000004, -10.6, -3.2, -3.0000000000000004, -3.3000000000000003, -3.500000000000001, -3.500000000000001, -3.1000000000000005, -3.5000000000000004, -3.400000000000001, -11.2, -3.2000000000000006, -3.4000000000000004, -10.7, -3.0000000000000004, -3.2000000000000006, -3.200000000000001, -3.3000000000000007, -3.3000000000000003, -11.8, -12.4, -3.2000000000000006, -3.2000000000000006, -3.5, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.300000000000001, -3.2000000000000006, -3.0000000000000004, -11.1, -3.0000000000000004, -3.300000000000001, -3.2000000000000006, -3.100000000000001, -3.3000000000000007, -3.500000000000001, -3.0000000000000004, -3.3000000000000007, -11.2, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -10.7, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.5000000000000004, -3.6000000000000005, -3.400000000000001, -3.1000000000000005, -10.9, -3.4000000000000004, -3.5000000000000004, -10.7, -11.8, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -3.2, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.2, -3.4000000000000004, -3.6000000000000005, -3.400000000000001, -3.5000000000000004, 99.9, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.6000000000000005, -3.1000000000000005, -3.2000000000000006, -10.6, -11.700000000000001, -3.500000000000001, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.2, -3.1000000000000005, -3.2000000000000006, -12.0, -3.1000000000000005, -3.2000000000000006, -3.2, -3.1000000000000005, -10.6, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -11.1, -3.2, -3.3000000000000003, -3.3000000000000007, -10.5, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.500000000000001, -3.500000000000001, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.6000000000000005, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -11.3, -3.3000000000000007, -3.4000000000000004, -10.9, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005], "episode_lengths": [21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 7, 21, 21, 21, 21, 21, 18, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 8, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 8, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.51621852624287, "mean_inference_ms": 17.424124859388062, "mean_action_processing_ms": 0.9113515826805942, "mean_env_wait_ms": 2.208274348636377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06711483001708984, "StateBufferConnector_ms": 0.008905401416853363, "ViewRequirementAgentConnector_ms": 0.12308359146118164}}, "episode_reward_max": 99.9, "episode_reward_min": -12.4, "episode_reward_mean": -3.6078431372549025, "episode_len_mean": 19.808823529411764, "episodes_this_iter": 204, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.3000000000000003, -3.0000000000000004, -3.3000000000000003, -10.2, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.0000000000000004, -3.500000000000001, -3.0000000000000004, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.7000000000000006, -3.3000000000000007, -3.400000000000001, -3.5000000000000004, -3.4000000000000004, -3.600000000000001, -3.2000000000000006, -3.400000000000001, -11.3, -3.100000000000001, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.2, -10.0, -3.400000000000001, -3.1000000000000005, -3.4000000000000004, -3.3000000000000007, -3.5000000000000004, -10.6, -3.2, -3.0000000000000004, -3.3000000000000003, -3.500000000000001, -3.500000000000001, -3.1000000000000005, -3.5000000000000004, -3.400000000000001, -11.2, -3.2000000000000006, -3.4000000000000004, -10.7, -3.0000000000000004, -3.2000000000000006, -3.200000000000001, -3.3000000000000007, -3.3000000000000003, -11.8, -12.4, -3.2000000000000006, -3.2000000000000006, -3.5, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.300000000000001, -3.2000000000000006, -3.0000000000000004, -11.1, -3.0000000000000004, -3.300000000000001, -3.2000000000000006, -3.100000000000001, -3.3000000000000007, -3.500000000000001, -3.0000000000000004, -3.3000000000000007, -11.2, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -10.7, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.5000000000000004, -3.6000000000000005, -3.400000000000001, -3.1000000000000005, -10.9, -3.4000000000000004, -3.5000000000000004, -10.7, -11.8, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -3.2, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.2, -3.4000000000000004, -3.6000000000000005, -3.400000000000001, -3.5000000000000004, 99.9, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.6000000000000005, -3.1000000000000005, -3.2000000000000006, -10.6, -11.700000000000001, -3.500000000000001, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.2, -3.1000000000000005, -3.2000000000000006, -12.0, -3.1000000000000005, -3.2000000000000006, -3.2, -3.1000000000000005, -10.6, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -11.1, -3.2, -3.3000000000000003, -3.3000000000000007, -10.5, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.500000000000001, -3.500000000000001, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.6000000000000005, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -11.3, -3.3000000000000007, -3.4000000000000004, -10.9, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005], "episode_lengths": [21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 7, 21, 21, 21, 21, 21, 18, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 8, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 8, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.51621852624287, "mean_inference_ms": 17.424124859388062, "mean_action_processing_ms": 0.9113515826805942, "mean_env_wait_ms": 2.208274348636377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06711483001708984, "StateBufferConnector_ms": 0.008905401416853363, "ViewRequirementAgentConnector_ms": 0.12308359146118164}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 170923.691, "load_time_ms": 1.301, "load_throughput": 3073988.787, "learn_time_ms": 169974.686, "learn_throughput": 23.533, "synch_weights_time_ms": 174.573}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "episodes_total": 17114, "training_iteration": 84, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_00-55-14", "timestamp": 1680821714, "time_this_iter_s": 170.5481379032135, "time_total_s": 14365.26272726059, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01473e2e50>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0147473d30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 14365.26272726059, "timesteps_since_restore": 0, "iterations_since_restore": 84, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.383539094650206, "ram_util_percent": 24.165843621399173}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.452360034742022, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.28508356361479686, "policy_loss": -0.029120924069436005, "vf_loss": 0.2950508940679532, "vf_explained_var": 0.6897456747870292, "kl": 0.009964577220874758, "entropy": 3.6443948743163896, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 78585.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000}, "sampler_results": {"episode_reward_max": 97.9, "episode_reward_min": -12.3, "episode_reward_mean": -2.6868686868686873, "episode_len_mean": 20.3989898989899, "episode_media": {}, "episodes_this_iter": 198, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3000000000000007, -3.3000000000000007, -3.0000000000000004, -3.0000000000000004, -3.3000000000000007, -3.3000000000000003, -10.5, -11.3, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.100000000000001, -3.0000000000000004, -3.3000000000000003, -3.0000000000000004, -3.500000000000001, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.100000000000001, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.2, -3.4000000000000004, -3.7, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.0000000000000004, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.400000000000001, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.5000000000000004, -3.500000000000001, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.600000000000001, -3.100000000000001, -3.0000000000000004, -10.7, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.6000000000000005, -3.3000000000000007, -3.2, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.200000000000001, -3.3000000000000003, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, 97.9, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.5000000000000004, -3.1000000000000005, -3.4000000000000004, -3.2, -3.3000000000000007, -3.500000000000001, -3.100000000000001, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.300000000000001, -3.300000000000001, -3.2000000000000006, -3.0000000000000004, -3.4000000000000004, -3.500000000000001, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -11.2, -3.500000000000001, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, 97.9, -3.3000000000000007, -3.3000000000000007, -3.5000000000000004, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -3.100000000000001, -3.1000000000000005, -11.5, -10.8, -3.3000000000000007, -12.3, -3.3000000000000003, -10.8, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.500000000000001, -3.400000000000001, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -10.9, -3.1000000000000005, -3.5000000000000004, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -10.2, -3.500000000000001, -3.3000000000000007, -3.500000000000001, -3.500000000000001, -3.300000000000001, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -11.6, -3.400000000000001, -3.2000000000000006, -3.600000000000001, -3.1000000000000005, -3.4000000000000004, -3.4000000000000012, -3.600000000000001, -3.400000000000001, -3.7000000000000006, -3.6000000000000005, -3.6000000000000005, -3.3000000000000003, -3.400000000000001, -3.1000000000000005, -3.400000000000001, -3.500000000000001, -3.2000000000000006, -3.100000000000001, -3.0000000000000004, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.5000000000000004, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.500000000000001, -3.300000000000001, -3.2000000000000006], "episode_lengths": [21, 21, 21, 21, 21, 21, 4, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 9, 21, 20, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.514598551831117, "mean_inference_ms": 17.424103181585377, "mean_action_processing_ms": 0.9120639967149193, "mean_env_wait_ms": 2.2100085819246575, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0781886505358147, "StateBufferConnector_ms": 0.009999130711410984, "ViewRequirementAgentConnector_ms": 0.14111694663462013}}, "episode_reward_max": 97.9, "episode_reward_min": -12.3, "episode_reward_mean": -2.6868686868686873, "episode_len_mean": 20.3989898989899, "episodes_this_iter": 198, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.3000000000000007, -3.3000000000000007, -3.0000000000000004, -3.0000000000000004, -3.3000000000000007, -3.3000000000000003, -10.5, -11.3, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.100000000000001, -3.0000000000000004, -3.3000000000000003, -3.0000000000000004, -3.500000000000001, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.100000000000001, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.2, -3.4000000000000004, -3.7, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.0000000000000004, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.400000000000001, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.5000000000000004, -3.500000000000001, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.600000000000001, -3.100000000000001, -3.0000000000000004, -10.7, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.6000000000000005, -3.3000000000000007, -3.2, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.200000000000001, -3.3000000000000003, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, 97.9, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.5000000000000004, -3.1000000000000005, -3.4000000000000004, -3.2, -3.3000000000000007, -3.500000000000001, -3.100000000000001, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.300000000000001, -3.300000000000001, -3.2000000000000006, -3.0000000000000004, -3.4000000000000004, -3.500000000000001, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -11.2, -3.500000000000001, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, 97.9, -3.3000000000000007, -3.3000000000000007, -3.5000000000000004, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -3.100000000000001, -3.1000000000000005, -11.5, -10.8, -3.3000000000000007, -12.3, -3.3000000000000003, -10.8, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.500000000000001, -3.400000000000001, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -10.9, -3.1000000000000005, -3.5000000000000004, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -10.2, -3.500000000000001, -3.3000000000000007, -3.500000000000001, -3.500000000000001, -3.300000000000001, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -11.6, -3.400000000000001, -3.2000000000000006, -3.600000000000001, -3.1000000000000005, -3.4000000000000004, -3.4000000000000012, -3.600000000000001, -3.400000000000001, -3.7000000000000006, -3.6000000000000005, -3.6000000000000005, -3.3000000000000003, -3.400000000000001, -3.1000000000000005, -3.400000000000001, -3.500000000000001, -3.2000000000000006, -3.100000000000001, -3.0000000000000004, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.5000000000000004, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.500000000000001, -3.300000000000001, -3.2000000000000006], "episode_lengths": [21, 21, 21, 21, 21, 21, 4, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 9, 21, 20, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.514598551831117, "mean_inference_ms": 17.424103181585377, "mean_action_processing_ms": 0.9120639967149193, "mean_env_wait_ms": 2.2100085819246575, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0781886505358147, "StateBufferConnector_ms": 0.009999130711410984, "ViewRequirementAgentConnector_ms": 0.14111694663462013}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 340000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 340000, "timers": {"training_iteration_time_ms": 171038.761, "load_time_ms": 1.275, "load_throughput": 3136045.46, "learn_time_ms": 170087.523, "learn_throughput": 23.517, "synch_weights_time_ms": 175.086}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000}, "done": false, "episodes_total": 17312, "training_iteration": 85, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_00-58-06", "timestamp": 1680821886, "time_this_iter_s": 171.62001013755798, "time_total_s": 14536.882737398148, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01477569a0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01473a53a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 14536.882737398148, "timesteps_since_restore": 0, "iterations_since_restore": 85, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.55, "ram_util_percent": 24.099180327868854}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4136099851419848, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.252828326627552, "policy_loss": -0.09327235313693202, "vf_loss": 0.31617400312936433, "vf_explained_var": 0.6251746567346717, "kl": 0.015569230146087727, "entropy": 3.639170575398271, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 79515.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.0, "episode_reward_mean": -3.8985000000000003, "episode_len_mean": 20.1, "episode_media": {}, "episodes_this_iter": 200, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.300000000000001, -3.0000000000000004, -3.3000000000000007, -3.4000000000000004, -3.4000000000000004, -3.300000000000001, -3.4000000000000004, -3.2000000000000006, -3.0000000000000004, -3.500000000000001, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.500000000000001, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -10.9, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.4000000000000004, -3.2000000000000006, -10.7, -3.3000000000000007, -3.4000000000000004, -3.4000000000000004, -3.3000000000000007, -3.100000000000001, -3.400000000000001, -11.700000000000001, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -11.4, -3.0000000000000004, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.3000000000000003, -10.3, -3.5000000000000004, -3.400000000000001, -3.2, -3.2000000000000006, -11.7, -3.200000000000001, -3.1000000000000005, -10.5, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.3000000000000003, -3.4000000000000004, -3.1000000000000005, -11.3, -3.200000000000001, -3.1000000000000005, -3.3000000000000003, -3.500000000000001, -3.3000000000000007, -3.0000000000000004, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.5000000000000004, -3.400000000000001, -3.2, -3.100000000000001, -3.400000000000001, -3.500000000000001, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.3000000000000003, -3.5, -3.6000000000000005, -3.0000000000000004, -3.2000000000000006, -3.400000000000001, -3.100000000000001, -3.500000000000001, -3.500000000000001, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.4000000000000004, -3.500000000000001, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.2, -3.3000000000000007, -3.5000000000000004, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2, -3.3000000000000007, -3.3000000000000007, -3.4000000000000004, -3.4000000000000004, -3.3000000000000003, -3.3000000000000007, -3.6000000000000005, -3.1000000000000005, -10.9, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.3000000000000003, -3.600000000000001, -3.6000000000000005, -3.2000000000000006, -3.200000000000001, -3.6000000000000005, -3.5000000000000004, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2, -11.9, -3.3000000000000007, -3.6000000000000005, -3.3000000000000003, -3.500000000000001, -3.500000000000001, -3.1000000000000005, -3.1000000000000005, -3.2, -3.4000000000000004, -3.1000000000000005, -10.5, -3.2000000000000006, -3.2, -3.400000000000001, -10.4, -3.4000000000000004, -3.4000000000000004, -3.1000000000000005, -3.3000000000000007, -12.0, -3.200000000000001, -3.3000000000000007, -3.1000000000000005, -10.2, -10.1, -3.400000000000001, -3.4000000000000004, -3.2, -3.6000000000000005, -3.400000000000001, -10.6, -3.700000000000001, -3.600000000000001, -3.3000000000000007, -3.3000000000000007, -3.600000000000001, -3.200000000000001, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.5000000000000004, -3.300000000000001, -3.400000000000001, -3.400000000000001, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.200000000000001, -3.2000000000000006, -3.2, -3.2000000000000006, -3.3000000000000007, -3.400000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 16, 21, 21, 6, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 4, 21, 21, 21, 21, 20, 21, 21, 21, 3, 2, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.511123031741445, "mean_inference_ms": 17.43273677208062, "mean_action_processing_ms": 0.9121388075727146, "mean_env_wait_ms": 2.20918271238204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07420122623443604, "StateBufferConnector_ms": 0.009958744049072266, "ViewRequirementAgentConnector_ms": 0.1385442018508911}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.0, "episode_reward_mean": -3.8985000000000003, "episode_len_mean": 20.1, "episodes_this_iter": 200, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.300000000000001, -3.0000000000000004, -3.3000000000000007, -3.4000000000000004, -3.4000000000000004, -3.300000000000001, -3.4000000000000004, -3.2000000000000006, -3.0000000000000004, -3.500000000000001, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.500000000000001, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -10.9, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.4000000000000004, -3.2000000000000006, -10.7, -3.3000000000000007, -3.4000000000000004, -3.4000000000000004, -3.3000000000000007, -3.100000000000001, -3.400000000000001, -11.700000000000001, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -11.4, -3.0000000000000004, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.3000000000000003, -10.3, -3.5000000000000004, -3.400000000000001, -3.2, -3.2000000000000006, -11.7, -3.200000000000001, -3.1000000000000005, -10.5, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.3000000000000003, -3.4000000000000004, -3.1000000000000005, -11.3, -3.200000000000001, -3.1000000000000005, -3.3000000000000003, -3.500000000000001, -3.3000000000000007, -3.0000000000000004, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.5000000000000004, -3.400000000000001, -3.2, -3.100000000000001, -3.400000000000001, -3.500000000000001, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.3000000000000003, -3.5, -3.6000000000000005, -3.0000000000000004, -3.2000000000000006, -3.400000000000001, -3.100000000000001, -3.500000000000001, -3.500000000000001, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.4000000000000004, -3.500000000000001, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.2, -3.3000000000000007, -3.5000000000000004, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2, -3.3000000000000007, -3.3000000000000007, -3.4000000000000004, -3.4000000000000004, -3.3000000000000003, -3.3000000000000007, -3.6000000000000005, -3.1000000000000005, -10.9, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.3000000000000003, -3.600000000000001, -3.6000000000000005, -3.2000000000000006, -3.200000000000001, -3.6000000000000005, -3.5000000000000004, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2, -11.9, -3.3000000000000007, -3.6000000000000005, -3.3000000000000003, -3.500000000000001, -3.500000000000001, -3.1000000000000005, -3.1000000000000005, -3.2, -3.4000000000000004, -3.1000000000000005, -10.5, -3.2000000000000006, -3.2, -3.400000000000001, -10.4, -3.4000000000000004, -3.4000000000000004, -3.1000000000000005, -3.3000000000000007, -12.0, -3.200000000000001, -3.3000000000000007, -3.1000000000000005, -10.2, -10.1, -3.400000000000001, -3.4000000000000004, -3.2, -3.6000000000000005, -3.400000000000001, -10.6, -3.700000000000001, -3.600000000000001, -3.3000000000000007, -3.3000000000000007, -3.600000000000001, -3.200000000000001, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.5000000000000004, -3.300000000000001, -3.400000000000001, -3.400000000000001, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.200000000000001, -3.2000000000000006, -3.2, -3.2000000000000006, -3.3000000000000007, -3.400000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 16, 21, 21, 6, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 4, 21, 21, 21, 21, 20, 21, 21, 21, 3, 2, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.511123031741445, "mean_inference_ms": 17.43273677208062, "mean_action_processing_ms": 0.9121388075727146, "mean_env_wait_ms": 2.20918271238204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07420122623443604, "StateBufferConnector_ms": 0.009958744049072266, "ViewRequirementAgentConnector_ms": 0.1385442018508911}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 344000, "timers": {"training_iteration_time_ms": 171053.41, "load_time_ms": 1.27, "load_throughput": 3150828.403, "learn_time_ms": 170094.654, "learn_throughput": 23.516, "synch_weights_time_ms": 178.107}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000}, "done": false, "episodes_total": 17512, "training_iteration": 86, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_01-00-57", "timestamp": 1680822057, "time_this_iter_s": 170.82183933258057, "time_total_s": 14707.704576730728, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01477a3c10>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0147473d30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 14707.704576730728, "timesteps_since_restore": 0, "iterations_since_restore": 86, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 6.07037037037037, "ram_util_percent": 24.17201646090534}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4076210271206595, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.3064908913416808, "policy_loss": -0.030844824034745696, "vf_loss": 0.3269137397007917, "vf_explained_var": 0.6093171331190294, "kl": 0.0054219906251834985, "entropy": 3.643775838164873, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 80445.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "sampler_results": {"episode_reward_max": 99.0, "episode_reward_min": -12.1, "episode_reward_mean": -3.403517587939698, "episode_len_mean": 20.21105527638191, "episode_media": {}, "episodes_this_iter": 199, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.1000000000000005, -3.3000000000000007, -3.5000000000000004, -3.3000000000000003, -3.0000000000000004, -3.400000000000001, -3.3000000000000007, -3.0000000000000004, -3.5000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.3000000000000003, -3.3000000000000007, -3.3000000000000003, -3.0000000000000004, -3.0000000000000004, -3.400000000000001, -3.100000000000001, -3.2, -3.400000000000001, -3.5000000000000004, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2, -3.400000000000001, -3.1000000000000005, -3.400000000000001, -3.500000000000001, -3.1000000000000005, -3.400000000000001, -3.400000000000001, -11.7, -3.1000000000000005, -3.2, -3.3000000000000007, -3.1000000000000005, -3.7000000000000006, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -10.7, -3.2000000000000006, -3.2, -3.600000000000001, -3.3000000000000007, -3.5000000000000004, -11.4, -3.3000000000000007, -11.6, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.2, -3.6000000000000005, -11.4, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.500000000000001, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.500000000000001, -3.2000000000000006, -11.3, -3.500000000000001, -3.3000000000000007, -3.3000000000000007, -3.2, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.600000000000001, -3.0000000000000004, -3.3000000000000003, -3.500000000000001, -11.9, -3.5000000000000004, -3.300000000000001, -3.2000000000000006, -3.200000000000001, -3.3000000000000003, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -10.4, -3.2000000000000006, -3.4000000000000004, -3.400000000000001, -3.3000000000000003, -3.7000000000000006, -3.400000000000001, -3.500000000000001, -3.1000000000000005, -3.100000000000001, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.4000000000000012, -3.200000000000001, -11.3, -3.500000000000001, -3.600000000000001, -3.6000000000000005, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.4000000000000012, -3.3000000000000003, -3.1000000000000005, -3.2, -3.1000000000000005, -3.2000000000000006, -11.8, -3.3000000000000007, -3.4000000000000012, -3.2000000000000006, -3.4000000000000004, -12.1, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -11.700000000000001, -3.4000000000000004, -10.3, -3.3000000000000003, -3.2, -3.3000000000000007, -3.2000000000000006, 99.0, -3.4000000000000012, -3.1000000000000005, -3.0000000000000004, -3.4000000000000004, -3.2000000000000006, -3.5000000000000004, -3.500000000000001, -3.3000000000000003, -11.600000000000001, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -10.3, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -10.1, -3.400000000000001, -3.600000000000001, -3.2000000000000006, -3.500000000000001, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.600000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.2, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.2, -3.3000000000000007, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.4000000000000004, -3.0000000000000004], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 14, 21, 13, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 20, 21, 21, 21, 16, 21, 4, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.507307300701571, "mean_inference_ms": 17.42399692957929, "mean_action_processing_ms": 0.9123103304044099, "mean_env_wait_ms": 2.2103961824961678, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0756698637152437, "StateBufferConnector_ms": 0.010229235318437892, "ViewRequirementAgentConnector_ms": 0.14023888650251992}}, "episode_reward_max": 99.0, "episode_reward_min": -12.1, "episode_reward_mean": -3.403517587939698, "episode_len_mean": 20.21105527638191, "episodes_this_iter": 199, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.1000000000000005, -3.3000000000000007, -3.5000000000000004, -3.3000000000000003, -3.0000000000000004, -3.400000000000001, -3.3000000000000007, -3.0000000000000004, -3.5000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.3000000000000003, -3.3000000000000007, -3.3000000000000003, -3.0000000000000004, -3.0000000000000004, -3.400000000000001, -3.100000000000001, -3.2, -3.400000000000001, -3.5000000000000004, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2, -3.400000000000001, -3.1000000000000005, -3.400000000000001, -3.500000000000001, -3.1000000000000005, -3.400000000000001, -3.400000000000001, -11.7, -3.1000000000000005, -3.2, -3.3000000000000007, -3.1000000000000005, -3.7000000000000006, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -10.7, -3.2000000000000006, -3.2, -3.600000000000001, -3.3000000000000007, -3.5000000000000004, -11.4, -3.3000000000000007, -11.6, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.2, -3.6000000000000005, -11.4, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.500000000000001, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.500000000000001, -3.2000000000000006, -11.3, -3.500000000000001, -3.3000000000000007, -3.3000000000000007, -3.2, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.600000000000001, -3.0000000000000004, -3.3000000000000003, -3.500000000000001, -11.9, -3.5000000000000004, -3.300000000000001, -3.2000000000000006, -3.200000000000001, -3.3000000000000003, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -10.4, -3.2000000000000006, -3.4000000000000004, -3.400000000000001, -3.3000000000000003, -3.7000000000000006, -3.400000000000001, -3.500000000000001, -3.1000000000000005, -3.100000000000001, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.4000000000000012, -3.200000000000001, -11.3, -3.500000000000001, -3.600000000000001, -3.6000000000000005, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.4000000000000012, -3.3000000000000003, -3.1000000000000005, -3.2, -3.1000000000000005, -3.2000000000000006, -11.8, -3.3000000000000007, -3.4000000000000012, -3.2000000000000006, -3.4000000000000004, -12.1, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -11.700000000000001, -3.4000000000000004, -10.3, -3.3000000000000003, -3.2, -3.3000000000000007, -3.2000000000000006, 99.0, -3.4000000000000012, -3.1000000000000005, -3.0000000000000004, -3.4000000000000004, -3.2000000000000006, -3.5000000000000004, -3.500000000000001, -3.3000000000000003, -11.600000000000001, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -10.3, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -10.1, -3.400000000000001, -3.600000000000001, -3.2000000000000006, -3.500000000000001, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.600000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.2, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.2, -3.3000000000000007, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.4000000000000004, -3.0000000000000004], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 14, 21, 13, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 20, 21, 21, 21, 16, 21, 4, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.507307300701571, "mean_inference_ms": 17.42399692957929, "mean_action_processing_ms": 0.9123103304044099, "mean_env_wait_ms": 2.2103961824961678, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0756698637152437, "StateBufferConnector_ms": 0.010229235318437892, "ViewRequirementAgentConnector_ms": 0.14023888650251992}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 348000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 348000, "timers": {"training_iteration_time_ms": 171075.304, "load_time_ms": 1.288, "load_throughput": 3106661.729, "learn_time_ms": 170102.977, "learn_throughput": 23.515, "synch_weights_time_ms": 192.988}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "done": false, "episodes_total": 17711, "training_iteration": 87, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_01-03-48", "timestamp": 1680822228, "time_this_iter_s": 170.93638849258423, "time_total_s": 14878.640965223312, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476f2bb0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014731fca0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 14878.640965223312, "timesteps_since_restore": 0, "iterations_since_restore": 87, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.577777777777778, "ram_util_percent": 24.20082304526748}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2296856085940073, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.3363480513695107, "policy_loss": -0.05404314456747905, "vf_loss": 0.3724730103862502, "vf_explained_var": 0.558599280734216, "kl": 0.009321862199344992, "entropy": 3.6397330296936854, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 81375.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "sampler_results": {"episode_reward_max": 98.7, "episode_reward_min": -12.5, "episode_reward_mean": -3.5512562814070354, "episode_len_mean": 19.889447236180903, "episode_media": {}, "episodes_this_iter": 199, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.4000000000000004, -3.3000000000000007, -3.400000000000001, -11.1, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.2, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.5000000000000004, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.2, -3.3000000000000007, -3.3000000000000003, -3.2, -3.1000000000000005, -3.2000000000000006, 98.7, -3.2000000000000006, -3.1000000000000005, -3.500000000000001, -3.400000000000001, -3.5000000000000004, -3.300000000000001, -3.400000000000001, -3.2000000000000006, -3.2, -3.0000000000000004, -3.2000000000000006, -3.3000000000000003, -3.3000000000000003, -3.4000000000000004, -3.6000000000000005, -3.3000000000000007, -3.5000000000000004, -3.500000000000001, -12.0, -3.3000000000000007, -3.500000000000001, -3.100000000000001, -11.1, -3.2000000000000006, -3.5000000000000013, -3.300000000000001, -3.2000000000000006, -3.2, -10.5, -3.2000000000000006, -3.100000000000001, -10.4, -3.400000000000001, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.500000000000001, -3.500000000000001, -3.3000000000000003, -3.500000000000001, -3.2, -3.3000000000000003, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.4000000000000004, -3.2000000000000006, -3.4000000000000012, -3.5000000000000004, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -10.9, -3.300000000000001, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.300000000000001, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.600000000000001, -3.5000000000000004, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.4000000000000004, -10.7, -3.200000000000001, -3.400000000000001, -3.1000000000000005, -3.500000000000001, -3.0000000000000004, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.0000000000000004, -3.3000000000000003, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.4000000000000004, -3.5000000000000004, -3.100000000000001, -3.200000000000001, -11.6, -3.2000000000000006, -3.4000000000000012, -3.4000000000000004, -3.700000000000001, -11.4, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -10.8, -3.0000000000000004, -3.2, -10.4, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -10.8, -3.200000000000001, -10.7, -3.1000000000000005, -3.500000000000001, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -11.2, -3.500000000000001, -3.1000000000000005, -3.3000000000000007, -3.100000000000001, -3.3000000000000003, -3.3000000000000007, -3.500000000000001, -10.7, -3.2, -3.2000000000000006, -3.2000000000000006, -11.5, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -10.0, -3.3000000000000007, -3.600000000000001, -12.5, -3.3000000000000007, -3.500000000000001, -3.7000000000000006, -3.1000000000000005, -3.1000000000000005, -3.5000000000000004, -3.700000000000001, -3.3000000000000007, -3.0000000000000004, -3.3000000000000003, -3.2, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.3000000000000003, -3.0000000000000004, -3.2, -11.1, -3.200000000000001, -3.400000000000001, -3.100000000000001, -3.3000000000000007, -3.3000000000000007, -3.4000000000000004, -11.1, -3.4000000000000004, -3.400000000000001], "episode_lengths": [21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 12, 21, 21, 21, 21, 21, 6, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 9, 21, 21, 5, 21, 21, 21, 9, 21, 8, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 14, 21, 21, 21, 1, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 12, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.512542371315629, "mean_inference_ms": 17.426725345408332, "mean_action_processing_ms": 0.912427854597698, "mean_env_wait_ms": 2.215576226166339, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0743846797463882, "StateBufferConnector_ms": 0.009526319839247507, "ViewRequirementAgentConnector_ms": 0.1378882470442422}}, "episode_reward_max": 98.7, "episode_reward_min": -12.5, "episode_reward_mean": -3.5512562814070354, "episode_len_mean": 19.889447236180903, "episodes_this_iter": 199, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.4000000000000004, -3.3000000000000007, -3.400000000000001, -11.1, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.2, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.5000000000000004, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.2, -3.3000000000000007, -3.3000000000000003, -3.2, -3.1000000000000005, -3.2000000000000006, 98.7, -3.2000000000000006, -3.1000000000000005, -3.500000000000001, -3.400000000000001, -3.5000000000000004, -3.300000000000001, -3.400000000000001, -3.2000000000000006, -3.2, -3.0000000000000004, -3.2000000000000006, -3.3000000000000003, -3.3000000000000003, -3.4000000000000004, -3.6000000000000005, -3.3000000000000007, -3.5000000000000004, -3.500000000000001, -12.0, -3.3000000000000007, -3.500000000000001, -3.100000000000001, -11.1, -3.2000000000000006, -3.5000000000000013, -3.300000000000001, -3.2000000000000006, -3.2, -10.5, -3.2000000000000006, -3.100000000000001, -10.4, -3.400000000000001, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.500000000000001, -3.500000000000001, -3.3000000000000003, -3.500000000000001, -3.2, -3.3000000000000003, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.4000000000000004, -3.2000000000000006, -3.4000000000000012, -3.5000000000000004, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -10.9, -3.300000000000001, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.300000000000001, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.600000000000001, -3.5000000000000004, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.4000000000000004, -10.7, -3.200000000000001, -3.400000000000001, -3.1000000000000005, -3.500000000000001, -3.0000000000000004, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.0000000000000004, -3.3000000000000003, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.4000000000000004, -3.5000000000000004, -3.100000000000001, -3.200000000000001, -11.6, -3.2000000000000006, -3.4000000000000012, -3.4000000000000004, -3.700000000000001, -11.4, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -10.8, -3.0000000000000004, -3.2, -10.4, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -10.8, -3.200000000000001, -10.7, -3.1000000000000005, -3.500000000000001, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -11.2, -3.500000000000001, -3.1000000000000005, -3.3000000000000007, -3.100000000000001, -3.3000000000000003, -3.3000000000000007, -3.500000000000001, -10.7, -3.2, -3.2000000000000006, -3.2000000000000006, -11.5, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -10.0, -3.3000000000000007, -3.600000000000001, -12.5, -3.3000000000000007, -3.500000000000001, -3.7000000000000006, -3.1000000000000005, -3.1000000000000005, -3.5000000000000004, -3.700000000000001, -3.3000000000000007, -3.0000000000000004, -3.3000000000000003, -3.2, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.3000000000000003, -3.0000000000000004, -3.2, -11.1, -3.200000000000001, -3.400000000000001, -3.100000000000001, -3.3000000000000007, -3.3000000000000007, -3.4000000000000004, -11.1, -3.4000000000000004, -3.400000000000001], "episode_lengths": [21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 12, 21, 21, 21, 21, 21, 6, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 9, 21, 21, 5, 21, 21, 21, 9, 21, 8, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 14, 21, 21, 21, 1, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 12, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.512542371315629, "mean_inference_ms": 17.426725345408332, "mean_action_processing_ms": 0.912427854597698, "mean_env_wait_ms": 2.215576226166339, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0743846797463882, "StateBufferConnector_ms": 0.009526319839247507, "ViewRequirementAgentConnector_ms": 0.1378882470442422}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 171165.881, "load_time_ms": 1.266, "load_throughput": 3159134.577, "learn_time_ms": 170175.364, "learn_throughput": 23.505, "synch_weights_time_ms": 193.057}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "done": false, "episodes_total": 17910, "training_iteration": 88, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_01-06-40", "timestamp": 1680822400, "time_this_iter_s": 171.6000199317932, "time_total_s": 15050.240985155106, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01477ae070>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014731f280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 15050.240985155106, "timesteps_since_restore": 0, "iterations_since_restore": 88, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.649590163934426, "ram_util_percent": 24.202459016393433}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4370548080372554, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.4198410548830545, "policy_loss": -0.03154934033030464, "vf_loss": 0.4325390252605161, "vf_explained_var": 0.5857493173050624, "kl": 0.009807345845238355, "entropy": 3.624599892349653, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 82305.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 356000}, "sampler_results": {"episode_reward_max": 98.7, "episode_reward_min": -12.0, "episode_reward_mean": -2.9326633165829152, "episode_len_mean": 20.276381909547737, "episode_media": {}, "episodes_this_iter": 199, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.4000000000000004, -3.3000000000000003, -3.2000000000000006, -11.7, -3.3000000000000007, -3.100000000000001, -3.2000000000000006, -3.500000000000001, -10.4, -3.400000000000001, -3.2000000000000006, -11.3, -3.5000000000000004, -3.2000000000000006, -3.2, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.100000000000001, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.4000000000000004, -3.400000000000001, -3.100000000000001, -3.500000000000001, -3.2, -3.1000000000000005, -3.500000000000001, -3.0000000000000004, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.3000000000000003, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.0000000000000004, -3.400000000000001, -3.400000000000001, -3.4000000000000004, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.5000000000000004, -11.9, -3.200000000000001, -11.2, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -10.9, -3.2000000000000006, -3.0000000000000004, -3.4000000000000004, -3.1000000000000005, -3.500000000000001, -3.3000000000000003, -11.2, -3.2000000000000006, -3.400000000000001, 98.4, -3.3000000000000007, -3.3000000000000007, 98.7, -3.3000000000000007, -3.2000000000000006, -3.600000000000001, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.400000000000001, -3.0000000000000004, -3.3000000000000007, -3.3000000000000007, -3.2, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -12.0, -3.2000000000000006, -3.3000000000000003, -3.400000000000001, -3.3000000000000003, -11.8, -3.400000000000001, -3.600000000000001, -3.4000000000000004, -3.2, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.0000000000000004, -3.1000000000000005, -10.7, -3.1000000000000005, -3.3000000000000003, -11.4, -3.3000000000000007, -3.0000000000000004, -3.3000000000000007, -3.200000000000001, -3.2, -3.2000000000000006, -3.3000000000000003, -3.100000000000001, -10.9, -11.5, -3.400000000000001, -3.4000000000000004, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.200000000000001, -11.5, -3.2000000000000006, -3.600000000000001, -3.2000000000000006, -3.3000000000000007, -3.2, -3.500000000000001, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.7000000000000006, -3.400000000000001, -3.400000000000001, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.300000000000001, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.4000000000000004, -11.6, -10.4, -3.3000000000000007, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.6000000000000005, -11.9, -3.5000000000000004, -3.400000000000001, -3.3000000000000007, -3.600000000000001, -3.3000000000000007, -3.3000000000000003, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.3000000000000003, -3.400000000000001, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.100000000000001, -3.3000000000000007, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, -3.500000000000001], "episode_lengths": [21, 21, 21, 17, 21, 21, 21, 21, 5, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 12, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 13, 21, 21, 16, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 10, 15, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.507162937378505, "mean_inference_ms": 17.41884524967963, "mean_action_processing_ms": 0.9120219100639975, "mean_env_wait_ms": 2.21480496261986, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07149382452269894, "StateBufferConnector_ms": 0.009028755839745602, "ViewRequirementAgentConnector_ms": 0.13132107317747183}}, "episode_reward_max": 98.7, "episode_reward_min": -12.0, "episode_reward_mean": -2.9326633165829152, "episode_len_mean": 20.276381909547737, "episodes_this_iter": 199, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.4000000000000004, -3.3000000000000003, -3.2000000000000006, -11.7, -3.3000000000000007, -3.100000000000001, -3.2000000000000006, -3.500000000000001, -10.4, -3.400000000000001, -3.2000000000000006, -11.3, -3.5000000000000004, -3.2000000000000006, -3.2, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.100000000000001, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.4000000000000004, -3.400000000000001, -3.100000000000001, -3.500000000000001, -3.2, -3.1000000000000005, -3.500000000000001, -3.0000000000000004, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.3000000000000003, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.0000000000000004, -3.400000000000001, -3.400000000000001, -3.4000000000000004, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.5000000000000004, -11.9, -3.200000000000001, -11.2, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -10.9, -3.2000000000000006, -3.0000000000000004, -3.4000000000000004, -3.1000000000000005, -3.500000000000001, -3.3000000000000003, -11.2, -3.2000000000000006, -3.400000000000001, 98.4, -3.3000000000000007, -3.3000000000000007, 98.7, -3.3000000000000007, -3.2000000000000006, -3.600000000000001, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.400000000000001, -3.0000000000000004, -3.3000000000000007, -3.3000000000000007, -3.2, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -12.0, -3.2000000000000006, -3.3000000000000003, -3.400000000000001, -3.3000000000000003, -11.8, -3.400000000000001, -3.600000000000001, -3.4000000000000004, -3.2, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.0000000000000004, -3.1000000000000005, -10.7, -3.1000000000000005, -3.3000000000000003, -11.4, -3.3000000000000007, -3.0000000000000004, -3.3000000000000007, -3.200000000000001, -3.2, -3.2000000000000006, -3.3000000000000003, -3.100000000000001, -10.9, -11.5, -3.400000000000001, -3.4000000000000004, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.200000000000001, -11.5, -3.2000000000000006, -3.600000000000001, -3.2000000000000006, -3.3000000000000007, -3.2, -3.500000000000001, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.7000000000000006, -3.400000000000001, -3.400000000000001, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.300000000000001, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.4000000000000004, -11.6, -10.4, -3.3000000000000007, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.6000000000000005, -11.9, -3.5000000000000004, -3.400000000000001, -3.3000000000000007, -3.600000000000001, -3.3000000000000007, -3.3000000000000003, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.3000000000000003, -3.400000000000001, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.100000000000001, -3.3000000000000007, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, -3.500000000000001], "episode_lengths": [21, 21, 21, 17, 21, 21, 21, 21, 5, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 12, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 13, 21, 21, 16, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 10, 15, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.507162937378505, "mean_inference_ms": 17.41884524967963, "mean_action_processing_ms": 0.9120219100639975, "mean_env_wait_ms": 2.21480496261986, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07149382452269894, "StateBufferConnector_ms": 0.009028755839745602, "ViewRequirementAgentConnector_ms": 0.13132107317747183}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 356000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 356000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 356000, "timers": {"training_iteration_time_ms": 171110.509, "load_time_ms": 1.197, "load_throughput": 3342008.327, "learn_time_ms": 170125.45, "learn_throughput": 23.512, "synch_weights_time_ms": 193.266}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 356000}, "done": false, "episodes_total": 18109, "training_iteration": 89, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_01-09-30", "timestamp": 1680822570, "time_this_iter_s": 170.5238049030304, "time_total_s": 15220.764790058136, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476f2580>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014731f8b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 15220.764790058136, "timesteps_since_restore": 0, "iterations_since_restore": 89, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.297119341563787, "ram_util_percent": 24.20493827160493}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5510355118782289, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.2664845011607614, "policy_loss": -0.09232823146727456, "vf_loss": 0.32893196755158965, "vf_explained_var": 0.5820137116216844, "kl": 0.015545346605421234, "entropy": 3.6155374949978243, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 83235.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.100000000000001, "episode_reward_mean": -3.970558375634518, "episode_len_mean": 20.258883248730964, "episode_media": {}, "episodes_this_iter": 197, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.400000000000001, -3.3000000000000007, -3.0000000000000004, -3.5000000000000004, -3.2, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.5000000000000013, -3.7000000000000006, -3.3000000000000003, -3.3000000000000003, -3.3000000000000003, -3.2000000000000006, -3.4000000000000004, -3.3000000000000003, -3.3000000000000007, -11.2, -3.2000000000000006, -3.3000000000000007, -3.5000000000000004, -11.0, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2, -10.5, -3.400000000000001, -3.4000000000000004, -3.3000000000000003, -3.4000000000000004, -3.100000000000001, -3.2000000000000006, -3.500000000000001, -3.2000000000000006, -11.2, -3.3000000000000007, -3.2000000000000006, -3.6000000000000005, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.4000000000000004, -3.1000000000000005, -3.400000000000001, -3.0000000000000004, -3.4000000000000004, -3.200000000000001, -3.0000000000000004, -3.200000000000001, -3.4000000000000004, -3.200000000000001, -3.2000000000000006, -11.700000000000001, -3.3000000000000007, -3.200000000000001, -12.100000000000001, -3.2000000000000006, -10.1, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -12.0, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.200000000000001, -3.400000000000001, -3.2000000000000006, -3.2, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.3000000000000003, -3.8000000000000007, -3.2000000000000006, -3.2000000000000006, -3.5000000000000013, -3.6000000000000005, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.4000000000000004, -3.400000000000001, -3.4000000000000004, -3.700000000000001, -3.2000000000000006, -3.2, -3.500000000000001, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.2, -3.2000000000000006, -3.2, -3.200000000000001, -3.3000000000000007, -3.4000000000000004, -3.7000000000000006, -3.3000000000000007, -3.700000000000001, -3.3000000000000003, -10.7, -3.4000000000000004, -3.2, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.500000000000001, -3.2000000000000006, -11.9, -3.4000000000000004, -3.7000000000000006, -3.300000000000001, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.3000000000000003, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -11.700000000000001, -11.9, -12.0, -3.2000000000000006, -3.1000000000000005, -3.600000000000001, -3.2000000000000006, -3.500000000000001, -3.400000000000001, -10.7, -3.3000000000000007, -3.1000000000000005, -10.9, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.500000000000001, -3.2000000000000006, -3.5000000000000004, -3.2000000000000006, -3.1000000000000005, -3.700000000000001, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.2, -3.500000000000001, -3.5000000000000004, -3.6000000000000005, -3.300000000000001, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -11.700000000000001, -3.100000000000001, -3.1000000000000005, -3.400000000000001, -3.0000000000000004, -3.2000000000000006, -10.1, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 19, 21, 2, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 17, 16, 21, 21, 21, 21, 21, 21, 8, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.51287327647028, "mean_inference_ms": 17.42350486342804, "mean_action_processing_ms": 0.9114488564058735, "mean_env_wait_ms": 2.2153934625392457, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06812078698637522, "StateBufferConnector_ms": 0.008837220632485326, "ViewRequirementAgentConnector_ms": 0.12550511335963524}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.100000000000001, "episode_reward_mean": -3.970558375634518, "episode_len_mean": 20.258883248730964, "episodes_this_iter": 197, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.400000000000001, -3.3000000000000007, -3.0000000000000004, -3.5000000000000004, -3.2, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.5000000000000013, -3.7000000000000006, -3.3000000000000003, -3.3000000000000003, -3.3000000000000003, -3.2000000000000006, -3.4000000000000004, -3.3000000000000003, -3.3000000000000007, -11.2, -3.2000000000000006, -3.3000000000000007, -3.5000000000000004, -11.0, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2, -10.5, -3.400000000000001, -3.4000000000000004, -3.3000000000000003, -3.4000000000000004, -3.100000000000001, -3.2000000000000006, -3.500000000000001, -3.2000000000000006, -11.2, -3.3000000000000007, -3.2000000000000006, -3.6000000000000005, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.4000000000000004, -3.1000000000000005, -3.400000000000001, -3.0000000000000004, -3.4000000000000004, -3.200000000000001, -3.0000000000000004, -3.200000000000001, -3.4000000000000004, -3.200000000000001, -3.2000000000000006, -11.700000000000001, -3.3000000000000007, -3.200000000000001, -12.100000000000001, -3.2000000000000006, -10.1, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -12.0, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.200000000000001, -3.400000000000001, -3.2000000000000006, -3.2, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.3000000000000003, -3.8000000000000007, -3.2000000000000006, -3.2000000000000006, -3.5000000000000013, -3.6000000000000005, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.4000000000000004, -3.400000000000001, -3.4000000000000004, -3.700000000000001, -3.2000000000000006, -3.2, -3.500000000000001, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.2, -3.2000000000000006, -3.2, -3.200000000000001, -3.3000000000000007, -3.4000000000000004, -3.7000000000000006, -3.3000000000000007, -3.700000000000001, -3.3000000000000003, -10.7, -3.4000000000000004, -3.2, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.500000000000001, -3.2000000000000006, -11.9, -3.4000000000000004, -3.7000000000000006, -3.300000000000001, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.3000000000000003, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -11.700000000000001, -11.9, -12.0, -3.2000000000000006, -3.1000000000000005, -3.600000000000001, -3.2000000000000006, -3.500000000000001, -3.400000000000001, -10.7, -3.3000000000000007, -3.1000000000000005, -10.9, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.500000000000001, -3.2000000000000006, -3.5000000000000004, -3.2000000000000006, -3.1000000000000005, -3.700000000000001, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.2, -3.500000000000001, -3.5000000000000004, -3.6000000000000005, -3.300000000000001, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -11.700000000000001, -3.100000000000001, -3.1000000000000005, -3.400000000000001, -3.0000000000000004, -3.2000000000000006, -10.1, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 19, 21, 2, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 17, 16, 21, 21, 21, 21, 21, 21, 8, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.51287327647028, "mean_inference_ms": 17.42350486342804, "mean_action_processing_ms": 0.9114488564058735, "mean_env_wait_ms": 2.2153934625392457, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06812078698637522, "StateBufferConnector_ms": 0.008837220632485326, "ViewRequirementAgentConnector_ms": 0.12550511335963524}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 170926.676, "load_time_ms": 1.179, "load_throughput": 3392420.584, "learn_time_ms": 169943.015, "learn_throughput": 23.537, "synch_weights_time_ms": 193.431}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "episodes_total": 18306, "training_iteration": 90, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_01-12-21", "timestamp": 1680822741, "time_this_iter_s": 170.44165539741516, "time_total_s": 15391.206445455551, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0147423640>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0147357d30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 15391.206445455551, "timesteps_since_restore": 0, "iterations_since_restore": 90, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.37396694214876, "ram_util_percent": 24.204132231404948}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3944031032182838, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.227494574157441, "policy_loss": -0.0895785348189454, "vf_loss": 0.2907010145986112, "vf_explained_var": 0.7047297539249543, "kl": 0.013719972771447231, "entropy": 3.608633739204817, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 84165.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 364000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.0, "episode_reward_mean": -3.84559585492228, "episode_len_mean": 20.27979274611399, "episode_media": {}, "episodes_this_iter": 193, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.1000000000000005, -11.3, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.400000000000001, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.5000000000000004, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -11.8, -3.4000000000000012, -3.2000000000000006, -3.5000000000000004, -3.400000000000001, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.3000000000000003, -3.3000000000000003, -3.3000000000000007, -3.3000000000000007, -3.5000000000000004, -11.9, -3.3000000000000003, -3.4000000000000004, -3.2000000000000006, -12.0, -3.4000000000000004, -10.4, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.2, -3.5000000000000004, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.100000000000001, -3.400000000000001, -3.7000000000000006, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.4000000000000004, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.2, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, -3.200000000000001, -3.2000000000000006, -3.2, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.4000000000000012, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.500000000000001, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.600000000000001, -3.1000000000000005, -3.9000000000000012, -3.2000000000000006, -3.700000000000001, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -10.9, -3.400000000000001, -3.0000000000000004, -10.4, -3.2, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2, -3.4000000000000004, -3.2000000000000006, -3.100000000000001, -3.400000000000001, -3.400000000000001, -3.400000000000001, -3.400000000000001, -3.3000000000000003, -3.2, -3.3000000000000003, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2, -3.0000000000000004, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.400000000000001, -3.3000000000000003, -3.3000000000000007, -3.400000000000001, -11.3, -3.3000000000000007, -3.300000000000001, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.200000000000001, -3.6000000000000014, -3.400000000000001, -10.3, -11.2, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.400000000000001, -3.4000000000000004, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.700000000000001, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.6000000000000005, -3.1000000000000005, -3.200000000000001, -3.3000000000000007, -3.3000000000000003, -3.4000000000000012, -3.2000000000000006, -3.1000000000000005, -11.1, -3.4000000000000004, -3.400000000000001, -3.2, -10.9, -3.4000000000000004, -3.2000000000000006, -10.8, -3.3000000000000007, -11.4, -3.2000000000000006, -3.500000000000001, -3.3000000000000003, -3.1000000000000005], "episode_lengths": [21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 18, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 4, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 9, 21, 21, 8, 21, 14, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.512946005073482, "mean_inference_ms": 17.423634710200446, "mean_action_processing_ms": 0.9114033840352992, "mean_env_wait_ms": 2.216909792141497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0728846831642902, "StateBufferConnector_ms": 0.009663487963108201, "ViewRequirementAgentConnector_ms": 0.13571489660233413}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.0, "episode_reward_mean": -3.84559585492228, "episode_len_mean": 20.27979274611399, "episodes_this_iter": 193, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.1000000000000005, -11.3, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.400000000000001, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.5000000000000004, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -11.8, -3.4000000000000012, -3.2000000000000006, -3.5000000000000004, -3.400000000000001, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.3000000000000003, -3.3000000000000003, -3.3000000000000007, -3.3000000000000007, -3.5000000000000004, -11.9, -3.3000000000000003, -3.4000000000000004, -3.2000000000000006, -12.0, -3.4000000000000004, -10.4, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.2, -3.5000000000000004, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.100000000000001, -3.400000000000001, -3.7000000000000006, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.4000000000000004, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.2, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, -3.200000000000001, -3.2000000000000006, -3.2, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.4000000000000012, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.500000000000001, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.600000000000001, -3.1000000000000005, -3.9000000000000012, -3.2000000000000006, -3.700000000000001, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -10.9, -3.400000000000001, -3.0000000000000004, -10.4, -3.2, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2, -3.4000000000000004, -3.2000000000000006, -3.100000000000001, -3.400000000000001, -3.400000000000001, -3.400000000000001, -3.400000000000001, -3.3000000000000003, -3.2, -3.3000000000000003, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2, -3.0000000000000004, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.400000000000001, -3.3000000000000003, -3.3000000000000007, -3.400000000000001, -11.3, -3.3000000000000007, -3.300000000000001, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.200000000000001, -3.6000000000000014, -3.400000000000001, -10.3, -11.2, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.400000000000001, -3.4000000000000004, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.700000000000001, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.6000000000000005, -3.1000000000000005, -3.200000000000001, -3.3000000000000007, -3.3000000000000003, -3.4000000000000012, -3.2000000000000006, -3.1000000000000005, -11.1, -3.4000000000000004, -3.400000000000001, -3.2, -10.9, -3.4000000000000004, -3.2000000000000006, -10.8, -3.3000000000000007, -11.4, -3.2000000000000006, -3.500000000000001, -3.3000000000000003, -3.1000000000000005], "episode_lengths": [21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 18, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 4, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 9, 21, 21, 8, 21, 14, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.512946005073482, "mean_inference_ms": 17.423634710200446, "mean_action_processing_ms": 0.9114033840352992, "mean_env_wait_ms": 2.216909792141497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0728846831642902, "StateBufferConnector_ms": 0.009663487963108201, "ViewRequirementAgentConnector_ms": 0.13571489660233413}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 364000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 364000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 364000, "timers": {"training_iteration_time_ms": 170881.978, "load_time_ms": 1.179, "load_throughput": 3393038.062, "learn_time_ms": 169897.497, "learn_throughput": 23.544, "synch_weights_time_ms": 191.164}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 364000}, "done": false, "episodes_total": 18499, "training_iteration": 91, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_01-15-12", "timestamp": 1680822912, "time_this_iter_s": 170.76480531692505, "time_total_s": 15561.971250772476, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476f2ca0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01474a81f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 15561.971250772476, "timesteps_since_restore": 0, "iterations_since_restore": 91, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.320987654320987, "ram_util_percent": 24.20576131687242}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3656314771021567, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.39579827290388847, "policy_loss": -0.10541138934392122, "vf_loss": 0.47250974444592353, "vf_explained_var": 0.4981286335376001, "kl": 0.014931015157571403, "entropy": 3.5911264742574383, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 85095.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.3, "episode_reward_mean": -4.132211538461539, "episode_len_mean": 19.942307692307693, "episode_media": {}, "episodes_this_iter": 208, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.1000000000000005, -3.3000000000000007, -3.500000000000001, -3.2, -3.2000000000000006, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.5000000000000004, -11.3, -11.3, -3.2000000000000006, -3.3000000000000007, -3.5000000000000004, -3.2000000000000006, -11.9, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.0000000000000004, -3.500000000000001, -3.3000000000000007, -3.200000000000001, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -10.5, -11.2, -3.2000000000000006, -11.0, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -12.0, -3.1000000000000005, -10.2, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.500000000000001, -3.400000000000001, -3.3000000000000007, -10.2, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.2, -3.500000000000001, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.400000000000001, -3.1000000000000005, -3.5000000000000004, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -11.4, -3.200000000000001, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -11.6, -3.3000000000000003, -3.0000000000000004, -3.500000000000001, -3.3000000000000007, -3.0000000000000004, -3.5000000000000004, -3.400000000000001, -3.3000000000000007, -3.3000000000000003, -3.4000000000000004, -3.100000000000001, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.500000000000001, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.3000000000000003, -3.400000000000001, -3.3000000000000007, -3.5000000000000004, -3.2000000000000006, -3.200000000000001, -3.400000000000001, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -3.100000000000001, -10.2, -3.8000000000000007, -10.8, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.5000000000000004, -3.1000000000000005, -3.2, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -10.5, -3.1000000000000005, -3.200000000000001, -3.2000000000000006, -3.0000000000000004, -3.3000000000000003, -11.2, -12.100000000000001, -3.3000000000000003, -11.4, -3.1000000000000005, -3.4000000000000004, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -10.2, -3.3000000000000007, -3.600000000000001, -10.4, -3.200000000000001, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.4000000000000004, -3.3000000000000003, -3.300000000000001, -3.1000000000000005, -3.2000000000000006, -3.5000000000000004, -3.2000000000000006, -3.3000000000000007, -3.5000000000000004, -3.1000000000000005, -3.2000000000000006, -3.2, -3.400000000000001, -3.2000000000000006, -3.500000000000001, -3.8000000000000007, -3.100000000000001, -3.3000000000000003, -3.3000000000000003, -3.3000000000000007, -11.7, -12.0, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.5, -3.3000000000000003, -3.100000000000001, -3.3000000000000003, -10.9, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.3000000000000003, -3.0000000000000004, -3.400000000000001, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -12.3, -3.3000000000000007, -3.1000000000000005, -3.400000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 13, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 13, 21, 10, 21, 21, 21, 21, 21, 21, 19, 21, 3, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 13, 18, 21, 13, 21, 21, 21, 21, 21, 21, 3, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.508960506019774, "mean_inference_ms": 17.436028744699925, "mean_action_processing_ms": 0.9122500782529366, "mean_env_wait_ms": 2.2178125767244996, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08008950031720675, "StateBufferConnector_ms": 0.010683100957136888, "ViewRequirementAgentConnector_ms": 0.1478972343298105}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.3, "episode_reward_mean": -4.132211538461539, "episode_len_mean": 19.942307692307693, "episodes_this_iter": 208, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.1000000000000005, -3.3000000000000007, -3.500000000000001, -3.2, -3.2000000000000006, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.5000000000000004, -11.3, -11.3, -3.2000000000000006, -3.3000000000000007, -3.5000000000000004, -3.2000000000000006, -11.9, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.0000000000000004, -3.500000000000001, -3.3000000000000007, -3.200000000000001, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -10.5, -11.2, -3.2000000000000006, -11.0, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -12.0, -3.1000000000000005, -10.2, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.500000000000001, -3.400000000000001, -3.3000000000000007, -10.2, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.2, -3.500000000000001, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.400000000000001, -3.1000000000000005, -3.5000000000000004, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -11.4, -3.200000000000001, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -11.6, -3.3000000000000003, -3.0000000000000004, -3.500000000000001, -3.3000000000000007, -3.0000000000000004, -3.5000000000000004, -3.400000000000001, -3.3000000000000007, -3.3000000000000003, -3.4000000000000004, -3.100000000000001, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.500000000000001, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.3000000000000003, -3.400000000000001, -3.3000000000000007, -3.5000000000000004, -3.2000000000000006, -3.200000000000001, -3.400000000000001, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -3.100000000000001, -10.2, -3.8000000000000007, -10.8, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.5000000000000004, -3.1000000000000005, -3.2, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -10.5, -3.1000000000000005, -3.200000000000001, -3.2000000000000006, -3.0000000000000004, -3.3000000000000003, -11.2, -12.100000000000001, -3.3000000000000003, -11.4, -3.1000000000000005, -3.4000000000000004, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -10.2, -3.3000000000000007, -3.600000000000001, -10.4, -3.200000000000001, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.4000000000000004, -3.3000000000000003, -3.300000000000001, -3.1000000000000005, -3.2000000000000006, -3.5000000000000004, -3.2000000000000006, -3.3000000000000007, -3.5000000000000004, -3.1000000000000005, -3.2000000000000006, -3.2, -3.400000000000001, -3.2000000000000006, -3.500000000000001, -3.8000000000000007, -3.100000000000001, -3.3000000000000003, -3.3000000000000003, -3.3000000000000007, -11.7, -12.0, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.5, -3.3000000000000003, -3.100000000000001, -3.3000000000000003, -10.9, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.3000000000000003, -3.0000000000000004, -3.400000000000001, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -12.3, -3.3000000000000007, -3.1000000000000005, -3.400000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 13, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 13, 21, 10, 21, 21, 21, 21, 21, 21, 19, 21, 3, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 13, 18, 21, 13, 21, 21, 21, 21, 21, 21, 3, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.508960506019774, "mean_inference_ms": 17.436028744699925, "mean_action_processing_ms": 0.9122500782529366, "mean_env_wait_ms": 2.2178125767244996, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08008950031720675, "StateBufferConnector_ms": 0.010683100957136888, "ViewRequirementAgentConnector_ms": 0.1478972343298105}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 368000, "timers": {"training_iteration_time_ms": 170929.714, "load_time_ms": 1.187, "load_throughput": 3368986.526, "learn_time_ms": 169940.6, "learn_throughput": 23.538, "synch_weights_time_ms": 190.867}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "done": false, "episodes_total": 18707, "training_iteration": 92, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_01-18-03", "timestamp": 1680823083, "time_this_iter_s": 171.46797704696655, "time_total_s": 15733.439227819443, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01477a3c10>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014731fd30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 15733.439227819443, "timesteps_since_restore": 0, "iterations_since_restore": 92, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.581147540983605, "ram_util_percent": 24.202459016393433}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5005553560792118, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.3047980463427682, "policy_loss": -0.0285546770790011, "vf_loss": 0.32023964764760626, "vf_explained_var": 0.629637643342377, "kl": 0.006822024367847329, "entropy": 3.597681368550947, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 86025.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "sampler_results": {"episode_reward_max": 98.0, "episode_reward_min": -12.200000000000001, "episode_reward_mean": -3.2532994923857874, "episode_len_mean": 20.375634517766496, "episode_media": {}, "episodes_this_iter": 197, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.400000000000001, -3.300000000000001, -3.300000000000001, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -3.5000000000000004, -3.3000000000000003, -3.2000000000000006, -3.5000000000000004, -3.3000000000000007, -3.0000000000000004, -3.3000000000000007, -3.3000000000000007, -3.100000000000001, -3.1000000000000005, -11.7, -3.1000000000000005, -3.3000000000000007, -3.100000000000001, -3.6000000000000005, -11.5, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.0000000000000004, -10.8, -3.2000000000000006, -3.200000000000001, -3.1000000000000005, -3.4000000000000004, -3.4000000000000004, -3.400000000000001, -3.4000000000000004, -3.3000000000000003, -3.0000000000000004, -3.3000000000000007, -3.3000000000000007, -10.4, -10.8, -3.2000000000000006, -3.2000000000000006, -3.600000000000001, -3.500000000000001, -3.2000000000000006, -10.8, -3.3000000000000007, -3.3000000000000007, -3.3000000000000003, -3.400000000000001, -3.2000000000000006, -11.8, -3.2, -3.3000000000000007, -3.2000000000000006, -3.100000000000001, -3.2000000000000006, -3.0000000000000004, -3.400000000000001, -3.5000000000000004, -3.1000000000000005, -3.2, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.2, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.500000000000001, -3.1000000000000005, -3.4000000000000004, -3.2, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -3.4000000000000004, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.6000000000000005, -3.1000000000000005, -3.400000000000001, -3.400000000000001, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.200000000000001, -3.500000000000001, -12.200000000000001, -3.0000000000000004, -3.0000000000000004, -3.3000000000000003, -3.600000000000001, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.2, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -11.1, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.3000000000000007, 98.0, -3.2000000000000006, -3.5000000000000004, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.2, -3.0000000000000004, -3.2000000000000006, -10.6, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.0000000000000004, -10.4, -3.0000000000000004, -3.5000000000000004, -3.4000000000000004, -3.3000000000000007, -3.100000000000001, -3.2, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.4000000000000004, -3.3000000000000007, -3.0000000000000004, -3.0000000000000004, -3.2, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.600000000000001, -3.2, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.600000000000001, -3.3000000000000007, -3.4000000000000004, -3.1000000000000005, -3.5000000000000004, -3.3000000000000007, -3.2000000000000006, -3.5000000000000004, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -11.4, -3.400000000000001, -3.4000000000000012, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.4000000000000004, -3.400000000000001, -3.0000000000000004, -11.8], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 15, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 8, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.51531837252113, "mean_inference_ms": 17.441317120625424, "mean_action_processing_ms": 0.9113125504059005, "mean_env_wait_ms": 2.2158418560547544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06972521089660334, "StateBufferConnector_ms": 0.009233092293521475, "ViewRequirementAgentConnector_ms": 0.12951599159821642}}, "episode_reward_max": 98.0, "episode_reward_min": -12.200000000000001, "episode_reward_mean": -3.2532994923857874, "episode_len_mean": 20.375634517766496, "episodes_this_iter": 197, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.400000000000001, -3.300000000000001, -3.300000000000001, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -3.5000000000000004, -3.3000000000000003, -3.2000000000000006, -3.5000000000000004, -3.3000000000000007, -3.0000000000000004, -3.3000000000000007, -3.3000000000000007, -3.100000000000001, -3.1000000000000005, -11.7, -3.1000000000000005, -3.3000000000000007, -3.100000000000001, -3.6000000000000005, -11.5, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.0000000000000004, -10.8, -3.2000000000000006, -3.200000000000001, -3.1000000000000005, -3.4000000000000004, -3.4000000000000004, -3.400000000000001, -3.4000000000000004, -3.3000000000000003, -3.0000000000000004, -3.3000000000000007, -3.3000000000000007, -10.4, -10.8, -3.2000000000000006, -3.2000000000000006, -3.600000000000001, -3.500000000000001, -3.2000000000000006, -10.8, -3.3000000000000007, -3.3000000000000007, -3.3000000000000003, -3.400000000000001, -3.2000000000000006, -11.8, -3.2, -3.3000000000000007, -3.2000000000000006, -3.100000000000001, -3.2000000000000006, -3.0000000000000004, -3.400000000000001, -3.5000000000000004, -3.1000000000000005, -3.2, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.2, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.500000000000001, -3.1000000000000005, -3.4000000000000004, -3.2, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -3.4000000000000004, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.6000000000000005, -3.1000000000000005, -3.400000000000001, -3.400000000000001, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.200000000000001, -3.500000000000001, -12.200000000000001, -3.0000000000000004, -3.0000000000000004, -3.3000000000000003, -3.600000000000001, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.2, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -11.1, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.3000000000000007, 98.0, -3.2000000000000006, -3.5000000000000004, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.2, -3.0000000000000004, -3.2000000000000006, -10.6, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.0000000000000004, -10.4, -3.0000000000000004, -3.5000000000000004, -3.4000000000000004, -3.3000000000000007, -3.100000000000001, -3.2, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.4000000000000004, -3.3000000000000007, -3.0000000000000004, -3.0000000000000004, -3.2, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.600000000000001, -3.2, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.600000000000001, -3.3000000000000007, -3.4000000000000004, -3.1000000000000005, -3.5000000000000004, -3.3000000000000007, -3.2000000000000006, -3.5000000000000004, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -11.4, -3.400000000000001, -3.4000000000000012, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.4000000000000004, -3.400000000000001, -3.0000000000000004, -11.8], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 15, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 8, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.51531837252113, "mean_inference_ms": 17.441317120625424, "mean_action_processing_ms": 0.9113125504059005, "mean_env_wait_ms": 2.2158418560547544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06972521089660334, "StateBufferConnector_ms": 0.009233092293521475, "ViewRequirementAgentConnector_ms": 0.12951599159821642}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 372000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 372000, "timers": {"training_iteration_time_ms": 170946.296, "load_time_ms": 1.184, "load_throughput": 3377872.272, "learn_time_ms": 169961.51, "learn_throughput": 23.535, "synch_weights_time_ms": 189.338}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "done": false, "episodes_total": 18904, "training_iteration": 93, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_01-20-54", "timestamp": 1680823254, "time_this_iter_s": 170.85724210739136, "time_total_s": 15904.296469926834, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01472fcf70>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014738fe50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 15904.296469926834, "timesteps_since_restore": 0, "iterations_since_restore": 93, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.301646090534979, "ram_util_percent": 24.201234567901224}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4532564685710014, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.2237250008730478, "policy_loss": -0.09194043769090567, "vf_loss": 0.28851337606858424, "vf_explained_var": 0.690704474526067, "kl": 0.014125748444614577, "entropy": 3.579962247161455, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 86955.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.4, "episode_reward_mean": -3.820100502512563, "episode_len_mean": 20.386934673366834, "episode_media": {}, "episodes_this_iter": 199, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3000000000000003, -11.2, -3.2, -3.2000000000000006, -3.2, -10.9, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.5000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.7000000000000006, -3.5000000000000004, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.3000000000000003, -3.3000000000000003, -11.5, -3.500000000000001, -3.3000000000000007, -3.2000000000000006, -3.2, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.2, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.200000000000001, -3.3000000000000007, -3.500000000000001, -3.3000000000000007, -3.4000000000000004, -3.3000000000000003, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.200000000000001, -3.2000000000000006, -3.1000000000000005, -10.3, -3.200000000000001, -3.2000000000000006, -3.3000000000000003, -3.0000000000000004, -3.300000000000001, -3.6000000000000005, -3.500000000000001, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.100000000000001, -10.1, -3.400000000000001, -11.6, -3.0000000000000004, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.500000000000001, -3.400000000000001, -3.300000000000001, -3.300000000000001, -3.4000000000000004, -3.400000000000001, -3.0000000000000004, -3.0000000000000004, -3.400000000000001, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.300000000000001, -3.500000000000001, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -11.3, -3.2000000000000006, -3.1000000000000005, -3.300000000000001, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.4000000000000012, -3.1000000000000005, -3.2, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.2, -3.2000000000000006, -3.1000000000000005, -3.2, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.0000000000000004, -3.2000000000000006, -3.400000000000001, -3.3000000000000003, -3.400000000000001, -3.6000000000000005, -3.500000000000001, -3.2000000000000006, -12.4, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.400000000000001, -10.6, -3.3000000000000003, -11.3, -3.5000000000000004, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.3000000000000003, -3.0000000000000004, -3.200000000000001, -3.400000000000001, -3.3000000000000007, -3.200000000000001, -3.3000000000000007, -3.400000000000001, -3.500000000000001, -3.1000000000000005, -3.5000000000000004, -3.1000000000000005, -3.6000000000000005, -3.4000000000000004, -3.500000000000001, -12.200000000000001, -3.3000000000000007, -3.3000000000000003, -3.100000000000001, -3.3000000000000007, -3.100000000000001, -3.2, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.500000000000001, -3.100000000000001, -3.200000000000001, -11.8, -12.100000000000001, -3.1000000000000005, -3.200000000000001, -3.2, -3.3000000000000007, -10.3], "episode_lengths": [21, 13, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 7, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 20, 21, 21, 21, 21, 4]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.519067624384823, "mean_inference_ms": 17.425501980247464, "mean_action_processing_ms": 0.9116206755966315, "mean_env_wait_ms": 2.217167155048809, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07313639674354439, "StateBufferConnector_ms": 0.009694291119599463, "ViewRequirementAgentConnector_ms": 0.13561560280958013}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.4, "episode_reward_mean": -3.820100502512563, "episode_len_mean": 20.386934673366834, "episodes_this_iter": 199, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.3000000000000003, -11.2, -3.2, -3.2000000000000006, -3.2, -10.9, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.5000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.7000000000000006, -3.5000000000000004, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.3000000000000003, -3.3000000000000003, -11.5, -3.500000000000001, -3.3000000000000007, -3.2000000000000006, -3.2, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.2, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.200000000000001, -3.3000000000000007, -3.500000000000001, -3.3000000000000007, -3.4000000000000004, -3.3000000000000003, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.200000000000001, -3.2000000000000006, -3.1000000000000005, -10.3, -3.200000000000001, -3.2000000000000006, -3.3000000000000003, -3.0000000000000004, -3.300000000000001, -3.6000000000000005, -3.500000000000001, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.100000000000001, -10.1, -3.400000000000001, -11.6, -3.0000000000000004, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.500000000000001, -3.400000000000001, -3.300000000000001, -3.300000000000001, -3.4000000000000004, -3.400000000000001, -3.0000000000000004, -3.0000000000000004, -3.400000000000001, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.300000000000001, -3.500000000000001, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -11.3, -3.2000000000000006, -3.1000000000000005, -3.300000000000001, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.4000000000000012, -3.1000000000000005, -3.2, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.2, -3.2000000000000006, -3.1000000000000005, -3.2, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.0000000000000004, -3.2000000000000006, -3.400000000000001, -3.3000000000000003, -3.400000000000001, -3.6000000000000005, -3.500000000000001, -3.2000000000000006, -12.4, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.400000000000001, -10.6, -3.3000000000000003, -11.3, -3.5000000000000004, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.3000000000000003, -3.0000000000000004, -3.200000000000001, -3.400000000000001, -3.3000000000000007, -3.200000000000001, -3.3000000000000007, -3.400000000000001, -3.500000000000001, -3.1000000000000005, -3.5000000000000004, -3.1000000000000005, -3.6000000000000005, -3.4000000000000004, -3.500000000000001, -12.200000000000001, -3.3000000000000007, -3.3000000000000003, -3.100000000000001, -3.3000000000000007, -3.100000000000001, -3.2, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.500000000000001, -3.100000000000001, -3.200000000000001, -11.8, -12.100000000000001, -3.1000000000000005, -3.200000000000001, -3.2, -3.3000000000000007, -10.3], "episode_lengths": [21, 13, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 7, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 20, 21, 21, 21, 21, 4]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.519067624384823, "mean_inference_ms": 17.425501980247464, "mean_action_processing_ms": 0.9116206755966315, "mean_env_wait_ms": 2.217167155048809, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07313639674354439, "StateBufferConnector_ms": 0.009694291119599463, "ViewRequirementAgentConnector_ms": 0.13561560280958013}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 376000, "timers": {"training_iteration_time_ms": 170952.431, "load_time_ms": 1.196, "load_throughput": 3343606.832, "learn_time_ms": 169964.392, "learn_throughput": 23.534, "synch_weights_time_ms": 190.139}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000}, "done": false, "episodes_total": 19103, "training_iteration": 94, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_01-23-45", "timestamp": 1680823425, "time_this_iter_s": 170.6063268184662, "time_total_s": 16074.9027967453, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01475a5490>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01474a81f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 16074.9027967453, "timesteps_since_restore": 0, "iterations_since_restore": 94, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.350413223140497, "ram_util_percent": 24.206611570247926}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0527814501315675, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.2648237292905168, "policy_loss": -0.03602561436403262, "vf_loss": 0.29000096376184176, "vf_explained_var": 0.6543784194736071, "kl": 0.005643824466081056, "entropy": 3.5836490461903234, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 87885.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000}, "sampler_results": {"episode_reward_max": 98.1, "episode_reward_min": -12.100000000000001, "episode_reward_mean": -3.3471502590673587, "episode_len_mean": 20.22279792746114, "episode_media": {}, "episodes_this_iter": 193, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0000000000000004, -3.3000000000000007, -3.0000000000000004, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.100000000000001, -3.2000000000000006, -3.0000000000000004, -3.3000000000000003, -3.4000000000000004, -3.400000000000001, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.500000000000001, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.2, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -11.2, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.6000000000000005, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, 98.1, -3.4000000000000004, -3.4000000000000012, -10.4, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.600000000000001, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.2, -10.3, -10.1, -3.3000000000000003, -3.2000000000000006, -3.200000000000001, -3.300000000000001, -3.400000000000001, -3.2, -3.4000000000000004, -3.200000000000001, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.5000000000000004, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2, -3.3000000000000007, -3.0000000000000004, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.6000000000000005, -3.3000000000000007, -3.1000000000000005, -3.5000000000000004, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.400000000000001, -3.3000000000000003, -3.2000000000000006, -3.500000000000001, -3.500000000000001, -3.5000000000000004, -3.2000000000000006, -3.3000000000000003, -11.2, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.5000000000000004, -3.1000000000000005, -3.2, -3.400000000000001, -3.5000000000000004, -3.4000000000000004, -3.3000000000000003, -3.1000000000000005, -10.7, -11.9, -10.5, -3.5000000000000004, -3.4000000000000004, -3.2000000000000006, -3.400000000000001, -3.2, -3.3000000000000003, -3.100000000000001, -3.3000000000000007, -12.0, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.100000000000001, -3.400000000000001, -3.0000000000000004, -3.3000000000000003, -3.3000000000000003, -3.4000000000000004, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.0000000000000004, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.6000000000000005, -3.2, -11.3, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.5000000000000004, -11.5, -3.400000000000001, -3.3000000000000003, -3.600000000000001, -3.1000000000000005, -3.3000000000000007, -3.5000000000000004, -3.4000000000000004, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -11.2, -3.500000000000001, -11.2, -3.200000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -11.3, -12.100000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 18, 6, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 12, 21, 21, 21, 21, 21, 21, 13, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.51578259504924, "mean_inference_ms": 17.43391289046494, "mean_action_processing_ms": 0.9119763233588137, "mean_env_wait_ms": 2.2203678506986773, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07560351969664579, "StateBufferConnector_ms": 0.009776767671417079, "ViewRequirementAgentConnector_ms": 0.14108746780632692}}, "episode_reward_max": 98.1, "episode_reward_min": -12.100000000000001, "episode_reward_mean": -3.3471502590673587, "episode_len_mean": 20.22279792746114, "episodes_this_iter": 193, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.0000000000000004, -3.3000000000000007, -3.0000000000000004, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.100000000000001, -3.2000000000000006, -3.0000000000000004, -3.3000000000000003, -3.4000000000000004, -3.400000000000001, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.500000000000001, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.2, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -11.2, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.6000000000000005, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, 98.1, -3.4000000000000004, -3.4000000000000012, -10.4, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.600000000000001, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.2, -10.3, -10.1, -3.3000000000000003, -3.2000000000000006, -3.200000000000001, -3.300000000000001, -3.400000000000001, -3.2, -3.4000000000000004, -3.200000000000001, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.5000000000000004, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2, -3.3000000000000007, -3.0000000000000004, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.6000000000000005, -3.3000000000000007, -3.1000000000000005, -3.5000000000000004, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.400000000000001, -3.3000000000000003, -3.2000000000000006, -3.500000000000001, -3.500000000000001, -3.5000000000000004, -3.2000000000000006, -3.3000000000000003, -11.2, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.5000000000000004, -3.1000000000000005, -3.2, -3.400000000000001, -3.5000000000000004, -3.4000000000000004, -3.3000000000000003, -3.1000000000000005, -10.7, -11.9, -10.5, -3.5000000000000004, -3.4000000000000004, -3.2000000000000006, -3.400000000000001, -3.2, -3.3000000000000003, -3.100000000000001, -3.3000000000000007, -12.0, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.100000000000001, -3.400000000000001, -3.0000000000000004, -3.3000000000000003, -3.3000000000000003, -3.4000000000000004, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.0000000000000004, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.6000000000000005, -3.2, -11.3, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.5000000000000004, -11.5, -3.400000000000001, -3.3000000000000003, -3.600000000000001, -3.1000000000000005, -3.3000000000000007, -3.5000000000000004, -3.4000000000000004, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -11.2, -3.500000000000001, -11.2, -3.200000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -11.3, -12.100000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 18, 6, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 12, 21, 21, 21, 21, 21, 21, 13, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.51578259504924, "mean_inference_ms": 17.43391289046494, "mean_action_processing_ms": 0.9119763233588137, "mean_env_wait_ms": 2.2203678506986773, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07560351969664579, "StateBufferConnector_ms": 0.009776767671417079, "ViewRequirementAgentConnector_ms": 0.14108746780632692}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 380000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 380000, "timers": {"training_iteration_time_ms": 170934.756, "load_time_ms": 1.193, "load_throughput": 3352426.017, "learn_time_ms": 169945.65, "learn_throughput": 23.537, "synch_weights_time_ms": 190.976}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000}, "done": false, "episodes_total": 19296, "training_iteration": 95, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_01-26-36", "timestamp": 1680823596, "time_this_iter_s": 171.44359135627747, "time_total_s": 16246.346388101578, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0147569910>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014736b5e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 16246.346388101578, "timesteps_since_restore": 0, "iterations_since_restore": 95, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.567622950819672, "ram_util_percent": 24.202049180327858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.433323888240322, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.3469692380898582, "policy_loss": -0.09905122272389871, "vf_loss": 0.41389154473379736, "vf_explained_var": 0.5471152894599464, "kl": 0.016714935848784824, "entropy": 3.5606197641741844, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 88815.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -11.9, "episode_reward_mean": -4.068627450980393, "episode_len_mean": 19.66176470588235, "episode_media": {}, "episodes_this_iter": 204, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.4000000000000004, -3.3000000000000003, -3.2000000000000006, -3.3000000000000003, -3.2, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.400000000000001, -10.3, -3.0000000000000004, -3.1000000000000005, -10.6, -3.0000000000000004, -3.200000000000001, -3.1000000000000005, -3.3000000000000007, -3.500000000000001, -3.600000000000001, -3.0000000000000004, -3.3000000000000007, -3.3000000000000007, -3.100000000000001, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -11.5, -3.0000000000000004, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -11.1, -3.2000000000000006, -3.300000000000001, -3.3000000000000003, -3.3000000000000003, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -11.9, -3.1000000000000005, -3.4000000000000012, -11.0, -3.400000000000001, -3.4000000000000004, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.2, -3.4000000000000004, -3.0000000000000004, -3.1000000000000005, -11.2, -3.5000000000000004, -3.0000000000000004, -3.200000000000001, -3.2000000000000006, -3.2000000000000006, -10.7, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.3000000000000003, -10.1, -10.8, -3.500000000000001, -3.3000000000000003, -3.3000000000000003, -3.400000000000001, -3.2000000000000006, -3.100000000000001, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.5000000000000013, -3.3000000000000007, -3.3000000000000003, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.200000000000001, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.0000000000000004, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.2, -3.1000000000000005, -3.600000000000001, -3.3000000000000007, -3.3000000000000007, -3.4000000000000004, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.2, -10.4, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.600000000000001, -3.3000000000000007, -10.2, -3.1000000000000005, -3.3000000000000007, -3.500000000000001, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -10.0, -10.0, -3.500000000000001, -3.300000000000001, -3.1000000000000005, -10.3, -3.500000000000001, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -10.4, -3.500000000000001, -3.5000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.4000000000000004, -3.2, -3.0000000000000004, -3.2000000000000006, -10.6, -3.3000000000000007, -3.400000000000001, -3.500000000000001, -11.8, -3.500000000000001, -3.400000000000001, -3.9000000000000012, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.6000000000000005, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.4000000000000004, -11.6, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.300000000000001, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -11.2, -3.3000000000000003, -3.1000000000000005, -10.7, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.500000000000001, -3.500000000000001, -3.400000000000001, -3.0000000000000004, -3.1000000000000005, -11.5, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.2, -3.0000000000000004, -3.3000000000000007, -3.400000000000001, -3.3000000000000003, -3.2000000000000006, -3.5000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.2, -3.4000000000000004], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 2, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 1, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.520675689151448, "mean_inference_ms": 17.406981137815333, "mean_action_processing_ms": 0.9105615287021723, "mean_env_wait_ms": 2.218954126632713, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06926386964087393, "StateBufferConnector_ms": 0.009032441120521695, "ViewRequirementAgentConnector_ms": 0.1271033988279455}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -11.9, "episode_reward_mean": -4.068627450980393, "episode_len_mean": 19.66176470588235, "episodes_this_iter": 204, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.4000000000000004, -3.3000000000000003, -3.2000000000000006, -3.3000000000000003, -3.2, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.400000000000001, -10.3, -3.0000000000000004, -3.1000000000000005, -10.6, -3.0000000000000004, -3.200000000000001, -3.1000000000000005, -3.3000000000000007, -3.500000000000001, -3.600000000000001, -3.0000000000000004, -3.3000000000000007, -3.3000000000000007, -3.100000000000001, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -11.5, -3.0000000000000004, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -11.1, -3.2000000000000006, -3.300000000000001, -3.3000000000000003, -3.3000000000000003, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -11.9, -3.1000000000000005, -3.4000000000000012, -11.0, -3.400000000000001, -3.4000000000000004, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.2, -3.4000000000000004, -3.0000000000000004, -3.1000000000000005, -11.2, -3.5000000000000004, -3.0000000000000004, -3.200000000000001, -3.2000000000000006, -3.2000000000000006, -10.7, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.3000000000000003, -10.1, -10.8, -3.500000000000001, -3.3000000000000003, -3.3000000000000003, -3.400000000000001, -3.2000000000000006, -3.100000000000001, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.5000000000000013, -3.3000000000000007, -3.3000000000000003, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.200000000000001, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.0000000000000004, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.2, -3.1000000000000005, -3.600000000000001, -3.3000000000000007, -3.3000000000000007, -3.4000000000000004, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.2, -10.4, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.600000000000001, -3.3000000000000007, -10.2, -3.1000000000000005, -3.3000000000000007, -3.500000000000001, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -10.0, -10.0, -3.500000000000001, -3.300000000000001, -3.1000000000000005, -10.3, -3.500000000000001, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -10.4, -3.500000000000001, -3.5000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.4000000000000004, -3.2, -3.0000000000000004, -3.2000000000000006, -10.6, -3.3000000000000007, -3.400000000000001, -3.500000000000001, -11.8, -3.500000000000001, -3.400000000000001, -3.9000000000000012, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.6000000000000005, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.4000000000000004, -11.6, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.300000000000001, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -11.2, -3.3000000000000003, -3.1000000000000005, -10.7, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.500000000000001, -3.500000000000001, -3.400000000000001, -3.0000000000000004, -3.1000000000000005, -11.5, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.2, -3.0000000000000004, -3.3000000000000007, -3.400000000000001, -3.3000000000000003, -3.2000000000000006, -3.5000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.2, -3.4000000000000004], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 2, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 1, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.520675689151448, "mean_inference_ms": 17.406981137815333, "mean_action_processing_ms": 0.9105615287021723, "mean_env_wait_ms": 2.218954126632713, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06926386964087393, "StateBufferConnector_ms": 0.009032441120521695, "ViewRequirementAgentConnector_ms": 0.1271033988279455}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 170899.571, "load_time_ms": 1.209, "load_throughput": 3309311.399, "learn_time_ms": 169917.583, "learn_throughput": 23.541, "synch_weights_time_ms": 185.146}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "episodes_total": 19500, "training_iteration": 96, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_01-29-27", "timestamp": 1680823767, "time_this_iter_s": 170.46888852119446, "time_total_s": 16416.815276622772, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476d1b50>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014736b3a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 16416.815276622772, "timesteps_since_restore": 0, "iterations_since_restore": 96, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.2407407407407405, "ram_util_percent": 24.201234567901224}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4032015507740359, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.23861591088215028, "policy_loss": -0.027151079726016138, "vf_loss": 0.2537697538883696, "vf_explained_var": 0.6527129804575315, "kl": 0.006241512543118749, "entropy": 3.566111684358248, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 89745.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 388000}, "sampler_results": {"episode_reward_max": 99.0, "episode_reward_min": -12.100000000000001, "episode_reward_mean": -3.28888888888889, "episode_len_mean": 20.156565656565657, "episode_media": {}, "episodes_this_iter": 198, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.4000000000000012, -3.1000000000000005, -3.6000000000000005, -3.7000000000000006, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.200000000000001, -3.3000000000000007, -3.200000000000001, -3.4000000000000004, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.300000000000001, -11.5, -3.2, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2, -3.3000000000000003, -3.3000000000000007, -3.600000000000001, -10.3, -3.400000000000001, -3.500000000000001, -3.2000000000000006, -3.300000000000001, -3.2, -12.0, -3.500000000000001, -3.5000000000000004, -3.2000000000000006, -3.5000000000000013, -3.0000000000000004, -3.2000000000000006, -3.4000000000000004, -3.400000000000001, -3.3000000000000003, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.2, -3.3000000000000003, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.4000000000000004, -3.4000000000000012, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.300000000000001, -3.1000000000000005, -10.3, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.200000000000001, -3.3000000000000003, -3.300000000000001, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.5000000000000004, -3.0000000000000004, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.5000000000000004, -3.4000000000000004, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.5000000000000004, -3.3000000000000007, -11.4, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.5000000000000004, -3.3000000000000007, -3.2, -3.4000000000000004, 99.0, -3.3000000000000007, -3.2000000000000006, -3.100000000000001, -10.2, -3.3000000000000003, -11.1, -3.4000000000000004, -3.3000000000000007, -3.2000000000000006, -3.600000000000001, -12.100000000000001, -3.400000000000001, -3.2, -3.3000000000000007, -3.500000000000001, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -11.700000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.6000000000000005, -10.5, -3.1000000000000005, -3.400000000000001, -3.2, -3.2, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -10.8, -3.2, -3.400000000000001, -3.3000000000000003, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.0000000000000004, -10.4, -3.1000000000000005, -3.1000000000000005, -3.6000000000000005, -3.6000000000000005, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.6000000000000005, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.2, -3.500000000000001, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -11.1, -3.1000000000000005, -3.4000000000000004, -3.100000000000001, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -10.4, -3.3000000000000003], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 3, 21, 11, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.52332757117712, "mean_inference_ms": 17.409479531407108, "mean_action_processing_ms": 0.9105345937568587, "mean_env_wait_ms": 2.2201141391636408, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07274813122219509, "StateBufferConnector_ms": 0.009514587094085385, "ViewRequirementAgentConnector_ms": 0.13469240882179953}}, "episode_reward_max": 99.0, "episode_reward_min": -12.100000000000001, "episode_reward_mean": -3.28888888888889, "episode_len_mean": 20.156565656565657, "episodes_this_iter": 198, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.4000000000000012, -3.1000000000000005, -3.6000000000000005, -3.7000000000000006, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.200000000000001, -3.3000000000000007, -3.200000000000001, -3.4000000000000004, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.300000000000001, -11.5, -3.2, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2, -3.3000000000000003, -3.3000000000000007, -3.600000000000001, -10.3, -3.400000000000001, -3.500000000000001, -3.2000000000000006, -3.300000000000001, -3.2, -12.0, -3.500000000000001, -3.5000000000000004, -3.2000000000000006, -3.5000000000000013, -3.0000000000000004, -3.2000000000000006, -3.4000000000000004, -3.400000000000001, -3.3000000000000003, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.2, -3.3000000000000003, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.4000000000000004, -3.4000000000000012, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.300000000000001, -3.1000000000000005, -10.3, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.200000000000001, -3.3000000000000003, -3.300000000000001, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.5000000000000004, -3.0000000000000004, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.5000000000000004, -3.4000000000000004, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.5000000000000004, -3.3000000000000007, -11.4, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.5000000000000004, -3.3000000000000007, -3.2, -3.4000000000000004, 99.0, -3.3000000000000007, -3.2000000000000006, -3.100000000000001, -10.2, -3.3000000000000003, -11.1, -3.4000000000000004, -3.3000000000000007, -3.2000000000000006, -3.600000000000001, -12.100000000000001, -3.400000000000001, -3.2, -3.3000000000000007, -3.500000000000001, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -11.700000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.6000000000000005, -10.5, -3.1000000000000005, -3.400000000000001, -3.2, -3.2, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -10.8, -3.2, -3.400000000000001, -3.3000000000000003, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.0000000000000004, -10.4, -3.1000000000000005, -3.1000000000000005, -3.6000000000000005, -3.6000000000000005, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.6000000000000005, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.2, -3.500000000000001, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -11.1, -3.1000000000000005, -3.4000000000000004, -3.100000000000001, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -10.4, -3.3000000000000003], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 3, 21, 11, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.52332757117712, "mean_inference_ms": 17.409479531407108, "mean_action_processing_ms": 0.9105345937568587, "mean_env_wait_ms": 2.2201141391636408, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07274813122219509, "StateBufferConnector_ms": 0.009514587094085385, "ViewRequirementAgentConnector_ms": 0.13469240882179953}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 388000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 388000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 388000, "timers": {"training_iteration_time_ms": 170928.219, "load_time_ms": 1.206, "load_throughput": 3315393.25, "learn_time_ms": 169961.579, "learn_throughput": 23.535, "synch_weights_time_ms": 172.341}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 388000}, "done": false, "episodes_total": 19698, "training_iteration": 97, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_01-32-18", "timestamp": 1680823938, "time_this_iter_s": 171.22292613983154, "time_total_s": 16588.038202762604, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01472fc5b0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01474a81f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 16588.038202762604, "timesteps_since_restore": 0, "iterations_since_restore": 97, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.303292181069958, "ram_util_percent": 24.202057613168716}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.351181885215544, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.2280140391293092, "policy_loss": -0.031140728126078474, "vf_loss": 0.24692626300027534, "vf_explained_var": 0.742922475581528, "kl": 0.006361829491785317, "entropy": 3.5636760727051766, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 90675.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000}, "sampler_results": {"episode_reward_max": 98.3, "episode_reward_min": -12.100000000000001, "episode_reward_mean": -3.2298969072164954, "episode_len_mean": 20.36082474226804, "episode_media": {}, "episodes_this_iter": 194, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.4000000000000004, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -11.0, -3.3000000000000003, -3.0000000000000004, -3.300000000000001, -3.2000000000000006, -3.2000000000000006, -3.2, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -10.3, -11.2, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2, -3.1000000000000005, -3.400000000000001, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.300000000000001, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -12.100000000000001, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.5000000000000004, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.6000000000000005, -3.5000000000000004, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.400000000000001, -3.2, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.4000000000000004, -3.2, -3.4000000000000004, -3.6000000000000005, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -12.0, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.400000000000001, -3.2000000000000006, -10.8, -3.3000000000000007, -3.2000000000000006, -12.0, -3.3000000000000003, -3.1000000000000005, -3.400000000000001, -3.6000000000000005, -3.2000000000000006, -3.3000000000000007, 98.3, -3.6000000000000005, -3.3000000000000007, -3.5000000000000004, -3.4000000000000004, -3.2, -3.2, -3.500000000000001, -3.4000000000000012, -3.7000000000000006, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.7000000000000006, -3.1000000000000005, -10.8, -3.2, -3.0000000000000004, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.5000000000000004, -3.2, -3.300000000000001, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.4000000000000004, -3.2, -3.0000000000000004, -3.6000000000000005, -3.1000000000000005, -10.2, -3.2, -3.300000000000001, -3.4000000000000004, -3.2, -3.2000000000000006, -3.2, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.200000000000001, -3.400000000000001, -3.400000000000001, -3.4000000000000004, -3.5000000000000004, -3.5000000000000004, -3.2, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.4000000000000004, -3.5000000000000004, -3.2000000000000006, -3.2, -3.0000000000000004, -3.2, -3.4000000000000004, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.500000000000001, -3.3000000000000007, -3.400000000000001, -11.3, -3.3000000000000007, -3.2000000000000006, -3.700000000000001, -3.1000000000000005, -3.200000000000001, -11.0, -10.6], "episode_lengths": [21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 19, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 11, 7]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.523525367072454, "mean_inference_ms": 17.408130351498023, "mean_action_processing_ms": 0.9103909090917361, "mean_env_wait_ms": 2.221231309736759, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07009629121760733, "StateBufferConnector_ms": 0.00906961480366815, "ViewRequirementAgentConnector_ms": 0.13197168861467815}}, "episode_reward_max": 98.3, "episode_reward_min": -12.100000000000001, "episode_reward_mean": -3.2298969072164954, "episode_len_mean": 20.36082474226804, "episodes_this_iter": 194, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.4000000000000004, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -11.0, -3.3000000000000003, -3.0000000000000004, -3.300000000000001, -3.2000000000000006, -3.2000000000000006, -3.2, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -10.3, -11.2, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2, -3.1000000000000005, -3.400000000000001, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.300000000000001, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -12.100000000000001, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.5000000000000004, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.6000000000000005, -3.5000000000000004, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.400000000000001, -3.2, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.4000000000000004, -3.2, -3.4000000000000004, -3.6000000000000005, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -12.0, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.400000000000001, -3.2000000000000006, -10.8, -3.3000000000000007, -3.2000000000000006, -12.0, -3.3000000000000003, -3.1000000000000005, -3.400000000000001, -3.6000000000000005, -3.2000000000000006, -3.3000000000000007, 98.3, -3.6000000000000005, -3.3000000000000007, -3.5000000000000004, -3.4000000000000004, -3.2, -3.2, -3.500000000000001, -3.4000000000000012, -3.7000000000000006, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.7000000000000006, -3.1000000000000005, -10.8, -3.2, -3.0000000000000004, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.5000000000000004, -3.2, -3.300000000000001, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.4000000000000004, -3.2, -3.0000000000000004, -3.6000000000000005, -3.1000000000000005, -10.2, -3.2, -3.300000000000001, -3.4000000000000004, -3.2, -3.2000000000000006, -3.2, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.200000000000001, -3.400000000000001, -3.400000000000001, -3.4000000000000004, -3.5000000000000004, -3.5000000000000004, -3.2, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.4000000000000004, -3.5000000000000004, -3.2000000000000006, -3.2, -3.0000000000000004, -3.2, -3.4000000000000004, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.500000000000001, -3.3000000000000007, -3.400000000000001, -11.3, -3.3000000000000007, -3.2000000000000006, -3.700000000000001, -3.1000000000000005, -3.200000000000001, -11.0, -10.6], "episode_lengths": [21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 19, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 11, 7]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.523525367072454, "mean_inference_ms": 17.408130351498023, "mean_action_processing_ms": 0.9103909090917361, "mean_env_wait_ms": 2.221231309736759, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07009629121760733, "StateBufferConnector_ms": 0.00906961480366815, "ViewRequirementAgentConnector_ms": 0.13197168861467815}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 392000, "timers": {"training_iteration_time_ms": 170825.357, "load_time_ms": 1.204, "load_throughput": 3322023.642, "learn_time_ms": 169879.044, "learn_throughput": 23.546, "synch_weights_time_ms": 172.923}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000}, "done": false, "episodes_total": 19892, "training_iteration": 98, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_01-35-09", "timestamp": 1680824109, "time_this_iter_s": 170.5729124546051, "time_total_s": 16758.61111521721, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0147286460>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014736b670>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 16758.61111521721, "timesteps_since_restore": 0, "iterations_since_restore": 98, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.349586776859503, "ram_util_percent": 24.202066115702472}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4002400902971144, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.22423051890907109, "policy_loss": -0.02307431972735832, "vf_loss": 0.22598370454244077, "vf_explained_var": 0.6646385360148646, "kl": 0.011092232070942735, "entropy": 3.573491559746445, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 91605.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "sampler_results": {"episode_reward_max": 98.9, "episode_reward_min": -11.6, "episode_reward_mean": -2.691133004926109, "episode_len_mean": 20.113300492610836, "episode_media": {}, "episodes_this_iter": 203, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.100000000000001, -3.1000000000000005, -3.100000000000001, -10.8, -3.500000000000001, -3.2000000000000006, -3.1000000000000005, -3.2, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -3.300000000000001, 98.3, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.6000000000000005, -3.3000000000000007, -3.2, -3.600000000000001, -3.2, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.5000000000000004, -3.0000000000000004, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.4000000000000004, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.100000000000001, -3.1000000000000005, -3.4000000000000004, -3.3000000000000003, -3.3000000000000003, -10.1, -3.3000000000000007, -3.3000000000000007, -11.1, -3.1000000000000005, -3.3000000000000007, -3.5000000000000004, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.600000000000001, -3.3000000000000003, -3.1000000000000005, -3.5000000000000004, -3.200000000000001, -10.5, -3.0000000000000004, 98.9, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.5000000000000004, -3.3000000000000007, -3.500000000000001, -3.500000000000001, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -11.6, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2, -3.5000000000000004, -3.0000000000000004, -3.3000000000000007, -10.0, -3.400000000000001, -3.200000000000001, -3.3000000000000007, -3.1000000000000005, -3.6000000000000005, -3.4000000000000004, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.4000000000000004, -3.100000000000001, -3.2000000000000006, -3.3000000000000007, -3.4000000000000004, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.2, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -10.1, -3.3000000000000007, -3.4000000000000004, -3.0000000000000004, -3.3000000000000007, -10.6, -3.3000000000000007, -3.2, -3.400000000000001, -3.1000000000000005, -10.6, -3.6000000000000005, -3.500000000000001, -3.100000000000001, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -10.7, -3.2000000000000006, -3.3000000000000007, -3.6000000000000005, -3.400000000000001, -3.400000000000001, -11.4, -3.2000000000000006, -3.4000000000000004, -3.2, -3.100000000000001, -3.4000000000000012, -3.2000000000000006, -3.500000000000001, -3.1000000000000005, -3.1000000000000005, -3.200000000000001, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.2, -3.3000000000000003, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.200000000000001, -3.3000000000000007, -3.3000000000000007, -3.3000000000000003, -3.600000000000001, -3.4000000000000004, -3.3000000000000007, -3.2000000000000006, -3.900000000000001, -3.600000000000001, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.200000000000001, -10.4, -3.2000000000000006, -3.1000000000000005, -3.5000000000000004, -3.400000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 7, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.519203770424888, "mean_inference_ms": 17.40256682868066, "mean_action_processing_ms": 0.9109986986186123, "mean_env_wait_ms": 2.2249505164044066, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07262547027888556, "StateBufferConnector_ms": 0.009000947322751501, "ViewRequirementAgentConnector_ms": 0.13281887975232354}}, "episode_reward_max": 98.9, "episode_reward_min": -11.6, "episode_reward_mean": -2.691133004926109, "episode_len_mean": 20.113300492610836, "episodes_this_iter": 203, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.100000000000001, -3.1000000000000005, -3.100000000000001, -10.8, -3.500000000000001, -3.2000000000000006, -3.1000000000000005, -3.2, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -3.300000000000001, 98.3, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.6000000000000005, -3.3000000000000007, -3.2, -3.600000000000001, -3.2, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.5000000000000004, -3.0000000000000004, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.4000000000000004, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.100000000000001, -3.1000000000000005, -3.4000000000000004, -3.3000000000000003, -3.3000000000000003, -10.1, -3.3000000000000007, -3.3000000000000007, -11.1, -3.1000000000000005, -3.3000000000000007, -3.5000000000000004, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.600000000000001, -3.3000000000000003, -3.1000000000000005, -3.5000000000000004, -3.200000000000001, -10.5, -3.0000000000000004, 98.9, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.5000000000000004, -3.3000000000000007, -3.500000000000001, -3.500000000000001, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -11.6, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2, -3.5000000000000004, -3.0000000000000004, -3.3000000000000007, -10.0, -3.400000000000001, -3.200000000000001, -3.3000000000000007, -3.1000000000000005, -3.6000000000000005, -3.4000000000000004, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.4000000000000004, -3.100000000000001, -3.2000000000000006, -3.3000000000000007, -3.4000000000000004, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.2, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -10.1, -3.3000000000000007, -3.4000000000000004, -3.0000000000000004, -3.3000000000000007, -10.6, -3.3000000000000007, -3.2, -3.400000000000001, -3.1000000000000005, -10.6, -3.6000000000000005, -3.500000000000001, -3.100000000000001, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -10.7, -3.2000000000000006, -3.3000000000000007, -3.6000000000000005, -3.400000000000001, -3.400000000000001, -11.4, -3.2000000000000006, -3.4000000000000004, -3.2, -3.100000000000001, -3.4000000000000012, -3.2000000000000006, -3.500000000000001, -3.1000000000000005, -3.1000000000000005, -3.200000000000001, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.2, -3.3000000000000003, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.200000000000001, -3.3000000000000007, -3.3000000000000007, -3.3000000000000003, -3.600000000000001, -3.4000000000000004, -3.3000000000000007, -3.2000000000000006, -3.900000000000001, -3.600000000000001, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.200000000000001, -10.4, -3.2000000000000006, -3.1000000000000005, -3.5000000000000004, -3.400000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 7, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.519203770424888, "mean_inference_ms": 17.40256682868066, "mean_action_processing_ms": 0.9109986986186123, "mean_env_wait_ms": 2.2249505164044066, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07262547027888556, "StateBufferConnector_ms": 0.009000947322751501, "ViewRequirementAgentConnector_ms": 0.13281887975232354}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 396000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 396000, "timers": {"training_iteration_time_ms": 170878.12, "load_time_ms": 1.192, "load_throughput": 3356315.842, "learn_time_ms": 169924.702, "learn_throughput": 23.54, "synch_weights_time_ms": 174.313}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "done": false, "episodes_total": 20095, "training_iteration": 99, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_01-38-00", "timestamp": 1680824280, "time_this_iter_s": 171.0509536266327, "time_total_s": 16929.66206884384, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01472af670>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01472bc790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 16929.66206884384, "timesteps_since_restore": 0, "iterations_since_restore": 99, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.474180327868852, "ram_util_percent": 24.201229508196707}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2980067532389394, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.4491977959618433, "policy_loss": -0.04973581889343839, "vf_loss": 0.48144730963714183, "vf_explained_var": 0.5465309349439478, "kl": 0.009097179308282062, "entropy": 3.581427928965579, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 92535.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "sampler_results": {"episode_reward_max": 98.4, "episode_reward_min": -12.200000000000001, "episode_reward_mean": -3.625520833333334, "episode_len_mean": 19.916666666666668, "episode_media": {}, "episodes_this_iter": 192, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.400000000000001, -3.2, -3.2, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -10.9, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -12.1, -3.3000000000000007, -3.0000000000000004, -3.4000000000000004, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.100000000000001, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.4000000000000004, -3.2000000000000006, -3.400000000000001, -3.300000000000001, -3.2000000000000006, -12.0, -3.3000000000000007, -12.2, -10.7, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -10.0, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.0000000000000004, -10.3, -3.100000000000001, -11.3, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -10.8, 98.4, -3.400000000000001, -3.0000000000000004, -11.4, -10.0, -3.1000000000000005, -3.2, -3.4000000000000004, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.2, -11.4, -3.0000000000000004, -3.2000000000000006, -3.3000000000000003, -11.6, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.2, -3.5000000000000004, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.100000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.600000000000001, -3.1000000000000005, -3.3000000000000007, -10.8, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.500000000000001, -3.1000000000000005, -3.6, -3.2000000000000006, -3.3000000000000007, -10.7, -3.7, -3.2, -3.1000000000000005, -3.3000000000000007, -10.9, -3.200000000000001, -3.2000000000000006, -10.4, -3.1000000000000005, -12.0, -3.1000000000000005, -12.200000000000001, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.5000000000000004, -3.100000000000001, -3.3000000000000007, -3.2000000000000006, -10.8, -3.5000000000000004, -3.1000000000000005, -3.2000000000000006, -3.500000000000001, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.500000000000001, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.4000000000000004, -3.5000000000000013, -11.8, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.0000000000000004, -3.2000000000000006, -3.500000000000001, -3.2000000000000006, -3.0000000000000004, -3.400000000000001, -3.0000000000000004, -3.400000000000001, -3.5000000000000004, -3.3000000000000003, -3.4000000000000004, -3.3000000000000007, -3.5000000000000004, -3.300000000000001, -3.2000000000000006, -3.1000000000000005, -3.2, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.5000000000000004, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -12.0, -3.100000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 20, 8, 21, 21, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 4, 21, 14, 21, 21, 21, 21, 21, 9, 15, 21, 21, 15, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 10, 21, 21, 5, 21, 19, 21, 20, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.51703304055828, "mean_inference_ms": 17.41928288872274, "mean_action_processing_ms": 0.9115075172185302, "mean_env_wait_ms": 2.227217907853351, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07275976240634918, "StateBufferConnector_ms": 0.008798390626907349, "ViewRequirementAgentConnector_ms": 0.13305805623531342}}, "episode_reward_max": 98.4, "episode_reward_min": -12.200000000000001, "episode_reward_mean": -3.625520833333334, "episode_len_mean": 19.916666666666668, "episodes_this_iter": 192, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.400000000000001, -3.2, -3.2, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -10.9, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -12.1, -3.3000000000000007, -3.0000000000000004, -3.4000000000000004, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.100000000000001, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.4000000000000004, -3.2000000000000006, -3.400000000000001, -3.300000000000001, -3.2000000000000006, -12.0, -3.3000000000000007, -12.2, -10.7, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -10.0, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.0000000000000004, -10.3, -3.100000000000001, -11.3, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -10.8, 98.4, -3.400000000000001, -3.0000000000000004, -11.4, -10.0, -3.1000000000000005, -3.2, -3.4000000000000004, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.2, -11.4, -3.0000000000000004, -3.2000000000000006, -3.3000000000000003, -11.6, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.2, -3.5000000000000004, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.100000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.600000000000001, -3.1000000000000005, -3.3000000000000007, -10.8, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.500000000000001, -3.1000000000000005, -3.6, -3.2000000000000006, -3.3000000000000007, -10.7, -3.7, -3.2, -3.1000000000000005, -3.3000000000000007, -10.9, -3.200000000000001, -3.2000000000000006, -10.4, -3.1000000000000005, -12.0, -3.1000000000000005, -12.200000000000001, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.5000000000000004, -3.100000000000001, -3.3000000000000007, -3.2000000000000006, -10.8, -3.5000000000000004, -3.1000000000000005, -3.2000000000000006, -3.500000000000001, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.500000000000001, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.4000000000000004, -3.5000000000000013, -11.8, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.0000000000000004, -3.2000000000000006, -3.500000000000001, -3.2000000000000006, -3.0000000000000004, -3.400000000000001, -3.0000000000000004, -3.400000000000001, -3.5000000000000004, -3.3000000000000003, -3.4000000000000004, -3.3000000000000007, -3.5000000000000004, -3.300000000000001, -3.2000000000000006, -3.1000000000000005, -3.2, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.5000000000000004, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -12.0, -3.100000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 20, 8, 21, 21, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 4, 21, 14, 21, 21, 21, 21, 21, 9, 15, 21, 21, 15, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 10, 21, 21, 5, 21, 19, 21, 20, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.51703304055828, "mean_inference_ms": 17.41928288872274, "mean_action_processing_ms": 0.9115075172185302, "mean_env_wait_ms": 2.227217907853351, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07275976240634918, "StateBufferConnector_ms": 0.008798390626907349, "ViewRequirementAgentConnector_ms": 0.13305805623531342}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 170942.565, "load_time_ms": 1.184, "load_throughput": 3377532.261, "learn_time_ms": 169984.473, "learn_throughput": 23.532, "synch_weights_time_ms": 175.732}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": false, "episodes_total": 20287, "training_iteration": 100, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_01-40-51", "timestamp": 1680824451, "time_this_iter_s": 171.08651304244995, "time_total_s": 17100.74858188629, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01472afe80>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01474a81f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 17100.74858188629, "timesteps_since_restore": 0, "iterations_since_restore": 100, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.448559670781893, "ram_util_percent": 24.25144032921811}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3033958365119274, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.32426398766317194, "policy_loss": -0.034622556195026064, "vf_loss": 0.3455969880525303, "vf_explained_var": 0.5242795686567984, "kl": 0.006913836618574957, "entropy": 3.5677163495812363, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 93465.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_agent_steps_sampled": 404000, "num_agent_steps_trained": 404000}, "sampler_results": {"episode_reward_max": 99.6, "episode_reward_min": -11.9, "episode_reward_mean": -2.9065656565656566, "episode_len_mean": 20.12121212121212, "episode_media": {}, "episodes_this_iter": 198, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.100000000000001, -3.1000000000000005, -3.400000000000001, -3.0000000000000004, -3.2, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -11.9, -3.7000000000000006, -3.2, -3.3000000000000007, -3.2000000000000006, -11.2, -3.5000000000000004, -3.200000000000001, -3.3000000000000007, -3.400000000000001, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.4000000000000004, -3.400000000000001, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.5000000000000004, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.6000000000000005, -10.4, -3.2000000000000006, -3.2000000000000006, -3.500000000000001, -3.5000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.5000000000000004, -3.1000000000000005, -10.9, -3.200000000000001, -11.7, -3.2000000000000006, -3.1000000000000005, -3.300000000000001, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.2, -11.0, -3.4000000000000004, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2, 99.6, -10.7, -3.500000000000001, -3.200000000000001, -3.4000000000000012, -3.2000000000000006, -3.400000000000001, -3.0000000000000004, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.2, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -11.700000000000001, -3.2000000000000006, -3.2000000000000006, -11.4, -3.2000000000000006, -11.6, -3.500000000000001, -3.300000000000001, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.300000000000001, -3.2000000000000006, -3.400000000000001, -3.4000000000000004, -3.3000000000000007, -11.0, -3.3000000000000007, -3.1000000000000005, 98.9, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.2, -3.1000000000000005, -3.1000000000000005, -3.600000000000001, -3.2000000000000006, -3.4000000000000004, -11.0, -3.600000000000001, -3.3000000000000003, -3.3000000000000007, -3.300000000000001, -3.500000000000001, -3.4000000000000004, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -11.6, -3.2000000000000006, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.0000000000000004, -3.400000000000001, -3.100000000000001, -3.500000000000001, -3.400000000000001, -3.1000000000000005, -3.100000000000001, -3.3000000000000007, -3.4000000000000004, -3.3000000000000007, -3.200000000000001, -3.400000000000001, -3.2, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.6, -3.2, -3.3000000000000007, -3.2, -3.3000000000000007, -3.3000000000000007, -3.500000000000001, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.600000000000001, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -11.9, -3.2000000000000006, -3.100000000000001, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -11.3, -10.9, -3.400000000000001, -11.2, -3.2000000000000006, -3.3000000000000007, -3.4000000000000004], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 5, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 12, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 10, 9, 21, 12, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.506154536078418, "mean_inference_ms": 17.395609306190085, "mean_action_processing_ms": 0.9101663450801314, "mean_env_wait_ms": 2.2216204137091298, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0704454653190844, "StateBufferConnector_ms": 0.008874348919801038, "ViewRequirementAgentConnector_ms": 0.13087867486356486}}, "episode_reward_max": 99.6, "episode_reward_min": -11.9, "episode_reward_mean": -2.9065656565656566, "episode_len_mean": 20.12121212121212, "episodes_this_iter": 198, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.100000000000001, -3.1000000000000005, -3.400000000000001, -3.0000000000000004, -3.2, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -11.9, -3.7000000000000006, -3.2, -3.3000000000000007, -3.2000000000000006, -11.2, -3.5000000000000004, -3.200000000000001, -3.3000000000000007, -3.400000000000001, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.4000000000000004, -3.400000000000001, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.5000000000000004, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.6000000000000005, -10.4, -3.2000000000000006, -3.2000000000000006, -3.500000000000001, -3.5000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.5000000000000004, -3.1000000000000005, -10.9, -3.200000000000001, -11.7, -3.2000000000000006, -3.1000000000000005, -3.300000000000001, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.2, -11.0, -3.4000000000000004, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2, 99.6, -10.7, -3.500000000000001, -3.200000000000001, -3.4000000000000012, -3.2000000000000006, -3.400000000000001, -3.0000000000000004, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.2, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -11.700000000000001, -3.2000000000000006, -3.2000000000000006, -11.4, -3.2000000000000006, -11.6, -3.500000000000001, -3.300000000000001, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.300000000000001, -3.2000000000000006, -3.400000000000001, -3.4000000000000004, -3.3000000000000007, -11.0, -3.3000000000000007, -3.1000000000000005, 98.9, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.2, -3.1000000000000005, -3.1000000000000005, -3.600000000000001, -3.2000000000000006, -3.4000000000000004, -11.0, -3.600000000000001, -3.3000000000000003, -3.3000000000000007, -3.300000000000001, -3.500000000000001, -3.4000000000000004, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -11.6, -3.2000000000000006, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.0000000000000004, -3.400000000000001, -3.100000000000001, -3.500000000000001, -3.400000000000001, -3.1000000000000005, -3.100000000000001, -3.3000000000000007, -3.4000000000000004, -3.3000000000000007, -3.200000000000001, -3.400000000000001, -3.2, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.6, -3.2, -3.3000000000000007, -3.2, -3.3000000000000007, -3.3000000000000007, -3.500000000000001, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.600000000000001, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -11.9, -3.2000000000000006, -3.100000000000001, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -11.3, -10.9, -3.400000000000001, -11.2, -3.2000000000000006, -3.3000000000000007, -3.4000000000000004], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 5, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 12, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 10, 9, 21, 12, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.506154536078418, "mean_inference_ms": 17.395609306190085, "mean_action_processing_ms": 0.9101663450801314, "mean_env_wait_ms": 2.2216204137091298, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0704454653190844, "StateBufferConnector_ms": 0.008874348919801038, "ViewRequirementAgentConnector_ms": 0.13087867486356486}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 404000, "num_agent_steps_trained": 404000, "num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 404000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 404000, "timers": {"training_iteration_time_ms": 170905.557, "load_time_ms": 1.186, "load_throughput": 3374000.201, "learn_time_ms": 169945.821, "learn_throughput": 23.537, "synch_weights_time_ms": 177.861}, "counters": {"num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_agent_steps_sampled": 404000, "num_agent_steps_trained": 404000}, "done": false, "episodes_total": 20485, "training_iteration": 101, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_01-43-41", "timestamp": 1680824621, "time_this_iter_s": 170.3947720527649, "time_total_s": 17271.143353939056, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0147423e20>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014736b670>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 17271.143353939056, "timesteps_since_restore": 0, "iterations_since_restore": 101, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.341322314049586, "ram_util_percent": 24.271074380165295}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.298054655312851, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.22645460017706437, "policy_loss": -0.0258445839767666, "vf_loss": 0.2353575616243786, "vf_explained_var": 0.7557871161609567, "kl": 0.008813809551347437, "entropy": 3.5822745438544983, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 94395.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000}, "sampler_results": {"episode_reward_max": 98.4, "episode_reward_min": -11.9, "episode_reward_mean": -3.14468085106383, "episode_len_mean": 20.54787234042553, "episode_media": {}, "episodes_this_iter": 188, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3000000000000003, -3.400000000000001, -3.2, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.5000000000000004, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.400000000000001, -3.2000000000000006, -3.3000000000000003, -3.3000000000000003, -3.400000000000001, -3.1000000000000005, -3.3000000000000003, -3.5000000000000004, -3.2000000000000006, -3.1000000000000005, -3.5000000000000004, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2, -3.2000000000000006, -3.2000000000000006, -3.6000000000000005, -3.4000000000000004, -3.5000000000000004, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.2, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, -3.2, -3.3000000000000007, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.2, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.500000000000001, -11.4, -3.2000000000000006, -3.3000000000000007, -3.2, -3.400000000000001, -11.9, -3.5000000000000004, -3.3000000000000003, -3.3000000000000003, -3.2000000000000006, -3.0000000000000004, -3.5000000000000004, -3.1000000000000005, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.2, -3.2000000000000006, -3.200000000000001, -3.3000000000000007, -3.2000000000000006, -3.2, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.3000000000000007, -11.3, -3.3000000000000003, -3.2000000000000006, -3.500000000000001, -3.1000000000000005, -3.3000000000000007, -11.9, -11.9, -3.3000000000000003, -3.2, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.2, -3.500000000000001, -3.1000000000000005, 98.4, -11.8, -11.6, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.500000000000001, -3.3000000000000007, -3.6000000000000005, -11.0, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.5000000000000004, -3.3000000000000003, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -10.5, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.2, -3.3000000000000007, -3.200000000000001, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -10.0, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.0000000000000004, -3.500000000000001, -3.500000000000001, -3.5000000000000004, -3.3000000000000007, -3.200000000000001, -3.500000000000001, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.200000000000001, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.2, -3.4000000000000004, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.3000000000000007], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 19, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 17, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.508819029056244, "mean_inference_ms": 17.42038452839145, "mean_action_processing_ms": 0.9115464789721731, "mean_env_wait_ms": 2.228802702463123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07525061039214438, "StateBufferConnector_ms": 0.009569335491099257, "ViewRequirementAgentConnector_ms": 0.1409169207227991}}, "episode_reward_max": 98.4, "episode_reward_min": -11.9, "episode_reward_mean": -3.14468085106383, "episode_len_mean": 20.54787234042553, "episodes_this_iter": 188, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.3000000000000003, -3.400000000000001, -3.2, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.5000000000000004, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.400000000000001, -3.2000000000000006, -3.3000000000000003, -3.3000000000000003, -3.400000000000001, -3.1000000000000005, -3.3000000000000003, -3.5000000000000004, -3.2000000000000006, -3.1000000000000005, -3.5000000000000004, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2, -3.2000000000000006, -3.2000000000000006, -3.6000000000000005, -3.4000000000000004, -3.5000000000000004, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.2, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, -3.2, -3.3000000000000007, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.2, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.500000000000001, -11.4, -3.2000000000000006, -3.3000000000000007, -3.2, -3.400000000000001, -11.9, -3.5000000000000004, -3.3000000000000003, -3.3000000000000003, -3.2000000000000006, -3.0000000000000004, -3.5000000000000004, -3.1000000000000005, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.2, -3.2000000000000006, -3.200000000000001, -3.3000000000000007, -3.2000000000000006, -3.2, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.3000000000000007, -11.3, -3.3000000000000003, -3.2000000000000006, -3.500000000000001, -3.1000000000000005, -3.3000000000000007, -11.9, -11.9, -3.3000000000000003, -3.2, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.2, -3.500000000000001, -3.1000000000000005, 98.4, -11.8, -11.6, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.500000000000001, -3.3000000000000007, -3.6000000000000005, -11.0, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.5000000000000004, -3.3000000000000003, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -10.5, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.2, -3.3000000000000007, -3.200000000000001, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -10.0, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.0000000000000004, -3.500000000000001, -3.500000000000001, -3.5000000000000004, -3.3000000000000007, -3.200000000000001, -3.500000000000001, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.200000000000001, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.2, -3.4000000000000004, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.3000000000000007], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 19, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 17, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.508819029056244, "mean_inference_ms": 17.42038452839145, "mean_action_processing_ms": 0.9115464789721731, "mean_env_wait_ms": 2.228802702463123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07525061039214438, "StateBufferConnector_ms": 0.009569335491099257, "ViewRequirementAgentConnector_ms": 0.1409169207227991}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 408000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 408000, "timers": {"training_iteration_time_ms": 170886.58, "load_time_ms": 1.181, "load_throughput": 3386873.385, "learn_time_ms": 169926.444, "learn_throughput": 23.54, "synch_weights_time_ms": 180.18}, "counters": {"num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000}, "done": false, "episodes_total": 20673, "training_iteration": 102, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_01-46-33", "timestamp": 1680824793, "time_this_iter_s": 171.2789933681488, "time_total_s": 17442.422347307205, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01473e2160>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01472bc550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 17442.422347307205, "timesteps_since_restore": 0, "iterations_since_restore": 102, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.571311475409836, "ram_util_percent": 24.293852459016403}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.403954367403702, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.4159771327349928, "policy_loss": -0.10577726968594135, "vf_loss": 0.487208450533029, "vf_explained_var": 0.563610706598528, "kl": 0.017972388285805562, "entropy": 3.562714833854347, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 95325.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_agent_steps_sampled": 412000, "num_agent_steps_trained": 412000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.2, "episode_reward_mean": -4.043478260869565, "episode_len_mean": 20.0, "episode_media": {}, "episodes_this_iter": 207, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.5000000000000004, -3.2000000000000006, -11.8, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.2, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.200000000000001, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -11.4, -3.300000000000001, -3.3000000000000007, -10.7, -3.2, -3.400000000000001, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.600000000000001, -3.600000000000001, -3.2, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -10.9, -3.3000000000000003, -3.1000000000000005, -3.400000000000001, -11.3, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.400000000000001, -3.400000000000001, -3.1000000000000005, -11.3, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.400000000000001, -11.2, -3.400000000000001, -3.3000000000000003, -3.1000000000000005, -3.5000000000000004, -3.400000000000001, -3.3000000000000003, -3.300000000000001, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.200000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -10.4, -10.5, -3.400000000000001, -3.400000000000001, -3.1000000000000005, -11.9, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.2, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.6000000000000005, -3.2000000000000006, -12.2, -3.2000000000000006, -3.2000000000000006, -3.5000000000000004, -11.3, -3.3000000000000007, -3.3000000000000007, -3.4000000000000004, -3.4000000000000004, -3.3000000000000007, -11.3, -10.0, -11.3, -3.2, -11.1, -11.0, -3.400000000000001, -3.5000000000000004, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -10.8, -3.3000000000000003, -3.0000000000000004, -3.400000000000001, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.100000000000001, -3.6000000000000005, -3.4000000000000004, -3.2000000000000006, -3.3000000000000003, -3.3000000000000003, -3.400000000000001, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -10.6, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.2, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.100000000000001, -3.0000000000000004, -3.400000000000001, -3.3000000000000003, -10.3, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.2, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.4000000000000004, -3.400000000000001, -3.3000000000000003, -3.3000000000000003, -11.1, -3.3000000000000007, -3.3000000000000007, -3.500000000000001, -3.6000000000000005, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.100000000000001, -3.200000000000001, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.2, -3.7000000000000006, -3.3000000000000007, -3.500000000000001, -3.100000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.400000000000001, -3.300000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 6, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 14, 21, 21, 21, 21, 21, 13, 1, 13, 21, 12, 11, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.498292508395219, "mean_inference_ms": 17.405223916514775, "mean_action_processing_ms": 0.9113691912170236, "mean_env_wait_ms": 2.2307817417452336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07416246017972053, "StateBufferConnector_ms": 0.00925847297705314, "ViewRequirementAgentConnector_ms": 0.13554810325880556}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.2, "episode_reward_mean": -4.043478260869565, "episode_len_mean": 20.0, "episodes_this_iter": 207, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.5000000000000004, -3.2000000000000006, -11.8, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.2, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.200000000000001, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -11.4, -3.300000000000001, -3.3000000000000007, -10.7, -3.2, -3.400000000000001, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.600000000000001, -3.600000000000001, -3.2, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -10.9, -3.3000000000000003, -3.1000000000000005, -3.400000000000001, -11.3, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.400000000000001, -3.400000000000001, -3.1000000000000005, -11.3, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.400000000000001, -11.2, -3.400000000000001, -3.3000000000000003, -3.1000000000000005, -3.5000000000000004, -3.400000000000001, -3.3000000000000003, -3.300000000000001, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.200000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -10.4, -10.5, -3.400000000000001, -3.400000000000001, -3.1000000000000005, -11.9, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.2, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.6000000000000005, -3.2000000000000006, -12.2, -3.2000000000000006, -3.2000000000000006, -3.5000000000000004, -11.3, -3.3000000000000007, -3.3000000000000007, -3.4000000000000004, -3.4000000000000004, -3.3000000000000007, -11.3, -10.0, -11.3, -3.2, -11.1, -11.0, -3.400000000000001, -3.5000000000000004, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -10.8, -3.3000000000000003, -3.0000000000000004, -3.400000000000001, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.100000000000001, -3.6000000000000005, -3.4000000000000004, -3.2000000000000006, -3.3000000000000003, -3.3000000000000003, -3.400000000000001, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -10.6, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.2, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.100000000000001, -3.0000000000000004, -3.400000000000001, -3.3000000000000003, -10.3, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.2, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.4000000000000004, -3.400000000000001, -3.3000000000000003, -3.3000000000000003, -11.1, -3.3000000000000007, -3.3000000000000007, -3.500000000000001, -3.6000000000000005, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.100000000000001, -3.200000000000001, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.2, -3.7000000000000006, -3.3000000000000007, -3.500000000000001, -3.100000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.400000000000001, -3.300000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 6, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 14, 21, 21, 21, 21, 21, 13, 1, 13, 21, 12, 11, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.498292508395219, "mean_inference_ms": 17.405223916514775, "mean_action_processing_ms": 0.9113691912170236, "mean_env_wait_ms": 2.2307817417452336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07416246017972053, "StateBufferConnector_ms": 0.00925847297705314, "ViewRequirementAgentConnector_ms": 0.13554810325880556}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 412000, "num_agent_steps_trained": 412000, "num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 412000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 412000, "timers": {"training_iteration_time_ms": 170867.03, "load_time_ms": 1.183, "load_throughput": 3381071.724, "learn_time_ms": 169903.446, "learn_throughput": 23.543, "synch_weights_time_ms": 180.802}, "counters": {"num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_agent_steps_sampled": 412000, "num_agent_steps_trained": 412000}, "done": false, "episodes_total": 20880, "training_iteration": 103, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_01-49-23", "timestamp": 1680824963, "time_this_iter_s": 170.6639506816864, "time_total_s": 17613.08629798889, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0147659100>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014736b160>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 17613.08629798889, "timesteps_since_restore": 0, "iterations_since_restore": 103, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.2818930041152266, "ram_util_percent": 24.28971193415638}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5383556893195516, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.1904045586123742, "policy_loss": -0.027555984769877726, "vf_loss": 0.20605627370257212, "vf_explained_var": 0.7314298345837542, "kl": 0.006193146586195335, "entropy": 3.564735839443822, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 96255.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "sampler_results": {"episode_reward_max": 99.1, "episode_reward_min": -12.200000000000001, "episode_reward_mean": -2.5707070707070714, "episode_len_mean": 20.560606060606062, "episode_media": {}, "episodes_this_iter": 198, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.5000000000000004, -3.1000000000000005, 97.9, -3.3000000000000003, -3.2, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.5000000000000004, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.200000000000001, -3.3000000000000007, -3.5000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.200000000000001, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.5000000000000004, -3.3000000000000007, -3.600000000000001, -3.400000000000001, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.200000000000001, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.300000000000001, -3.500000000000001, -3.7000000000000006, -3.3000000000000007, -3.600000000000001, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.500000000000001, -3.6000000000000005, -3.1000000000000005, -10.5, -3.3000000000000003, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -11.3, -3.5000000000000004, -11.0, -3.2000000000000006, -3.400000000000001, -10.4, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.2, -3.4000000000000012, -3.2000000000000006, -3.3000000000000003, -12.200000000000001, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.2, -3.600000000000001, -3.4000000000000004, -3.1000000000000005, -3.2, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.1000000000000005, -3.4000000000000004, -3.0000000000000004, -3.3000000000000003, -3.400000000000001, -3.3000000000000003, -3.4000000000000004, -11.3, -3.1000000000000005, -3.2000000000000006, -11.700000000000001, -3.3000000000000007, -3.2000000000000006, -3.300000000000001, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -11.3, -3.2000000000000006, -3.3000000000000007, -3.2, -3.500000000000001, 99.1, -3.4000000000000004, -3.5000000000000004, -3.400000000000001, -3.1000000000000005, -3.2, -3.2000000000000006, -3.1000000000000005, -3.5000000000000004, -3.3000000000000007, -3.400000000000001, -3.100000000000001, -3.4000000000000004, -3.2, -3.3000000000000007, -3.3000000000000003, -3.0000000000000004, -3.3000000000000007, -3.2, -3.400000000000001, -3.500000000000001, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.2, -3.500000000000001, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.4000000000000004, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.7000000000000006, -3.2000000000000006, -3.2000000000000006, -3.4000000000000012, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.200000000000001, -3.500000000000001, -3.500000000000001, -3.3000000000000003, -3.3000000000000003, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.500000000000001, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.500000000000001, -3.500000000000001, -3.4000000000000004, -3.3000000000000007], "episode_lengths": [21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 13, 21, 11, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.50642959356108, "mean_inference_ms": 17.40155321107264, "mean_action_processing_ms": 0.9109946648093505, "mean_env_wait_ms": 2.230204693353457, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07119997583254419, "StateBufferConnector_ms": 0.008654233181115353, "ViewRequirementAgentConnector_ms": 0.1331882043318315}}, "episode_reward_max": 99.1, "episode_reward_min": -12.200000000000001, "episode_reward_mean": -2.5707070707070714, "episode_len_mean": 20.560606060606062, "episodes_this_iter": 198, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.5000000000000004, -3.1000000000000005, 97.9, -3.3000000000000003, -3.2, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.5000000000000004, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.200000000000001, -3.3000000000000007, -3.5000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.200000000000001, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.5000000000000004, -3.3000000000000007, -3.600000000000001, -3.400000000000001, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.200000000000001, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.300000000000001, -3.500000000000001, -3.7000000000000006, -3.3000000000000007, -3.600000000000001, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.500000000000001, -3.6000000000000005, -3.1000000000000005, -10.5, -3.3000000000000003, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -11.3, -3.5000000000000004, -11.0, -3.2000000000000006, -3.400000000000001, -10.4, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.2, -3.4000000000000012, -3.2000000000000006, -3.3000000000000003, -12.200000000000001, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.2, -3.600000000000001, -3.4000000000000004, -3.1000000000000005, -3.2, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.1000000000000005, -3.4000000000000004, -3.0000000000000004, -3.3000000000000003, -3.400000000000001, -3.3000000000000003, -3.4000000000000004, -11.3, -3.1000000000000005, -3.2000000000000006, -11.700000000000001, -3.3000000000000007, -3.2000000000000006, -3.300000000000001, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -11.3, -3.2000000000000006, -3.3000000000000007, -3.2, -3.500000000000001, 99.1, -3.4000000000000004, -3.5000000000000004, -3.400000000000001, -3.1000000000000005, -3.2, -3.2000000000000006, -3.1000000000000005, -3.5000000000000004, -3.3000000000000007, -3.400000000000001, -3.100000000000001, -3.4000000000000004, -3.2, -3.3000000000000007, -3.3000000000000003, -3.0000000000000004, -3.3000000000000007, -3.2, -3.400000000000001, -3.500000000000001, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.2, -3.500000000000001, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.4000000000000004, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.7000000000000006, -3.2000000000000006, -3.2000000000000006, -3.4000000000000012, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.200000000000001, -3.500000000000001, -3.500000000000001, -3.3000000000000003, -3.3000000000000003, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.500000000000001, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.500000000000001, -3.500000000000001, -3.4000000000000004, -3.3000000000000007], "episode_lengths": [21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 13, 21, 11, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.50642959356108, "mean_inference_ms": 17.40155321107264, "mean_action_processing_ms": 0.9109946648093505, "mean_env_wait_ms": 2.230204693353457, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07119997583254419, "StateBufferConnector_ms": 0.008654233181115353, "ViewRequirementAgentConnector_ms": 0.1331882043318315}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 416000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 416000, "timers": {"training_iteration_time_ms": 170906.02, "load_time_ms": 1.184, "load_throughput": 3379777.599, "learn_time_ms": 169933.765, "learn_throughput": 23.539, "synch_weights_time_ms": 179.094}, "counters": {"num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "done": false, "episodes_total": 21078, "training_iteration": 104, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_01-52-14", "timestamp": 1680825134, "time_this_iter_s": 170.99683594703674, "time_total_s": 17784.08313393593, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01474232e0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014728cca0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 17784.08313393593, "timesteps_since_restore": 0, "iterations_since_restore": 104, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.334567901234567, "ram_util_percent": 24.227983539094648}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4969136372849505, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.28330449975065647, "policy_loss": -0.09212900458144084, "vf_loss": 0.34638514051223873, "vf_explained_var": 0.6191422295185828, "kl": 0.015112291403009646, "entropy": 3.5414742005768645, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 97185.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.200000000000001, "episode_reward_mean": -3.930653266331659, "episode_len_mean": 20.20603015075377, "episode_media": {}, "episodes_this_iter": 199, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.0000000000000004, -3.3000000000000007, -11.700000000000001, -11.7, -3.2000000000000006, -3.500000000000001, -3.2, -11.7, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.4000000000000004, -3.0000000000000004, -3.400000000000001, -3.100000000000001, -3.3000000000000007, -3.500000000000001, -3.1000000000000005, -3.400000000000001, -3.0000000000000004, -3.2, -3.2, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -10.6, -3.5000000000000004, -3.3000000000000007, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.900000000000001, -3.3000000000000007, -3.3000000000000003, -3.2, -3.3000000000000003, -3.0000000000000004, -3.4000000000000004, -3.4000000000000004, -3.2000000000000006, -3.3000000000000003, -3.3000000000000003, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.6000000000000005, -3.4000000000000004, -10.1, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.500000000000001, -3.6000000000000014, -3.5000000000000013, -3.0000000000000004, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.3000000000000003, -3.1000000000000005, -3.5000000000000004, -3.3000000000000007, -3.5000000000000004, -3.100000000000001, -3.3000000000000007, -3.300000000000001, -3.3000000000000007, -3.1000000000000005, -3.100000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -11.1, -3.5000000000000004, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2, -3.500000000000001, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.3000000000000003, -11.8, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -12.200000000000001, -3.2000000000000006, -11.7, -3.300000000000001, -3.2000000000000006, -3.5000000000000004, -3.1000000000000005, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -11.8, -3.2000000000000006, -10.4, -10.8, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.5000000000000004, -3.500000000000001, -3.1000000000000005, -3.1000000000000005, -3.100000000000001, -3.1000000000000005, -10.6, -3.600000000000001, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -10.7, -3.700000000000001, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.300000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -11.6, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.3000000000000003, -3.5000000000000004, -10.8, -3.3000000000000003, -3.0000000000000004, -3.3000000000000007, -3.100000000000001, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.4000000000000012, -3.0000000000000004, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2, -3.4000000000000004, -3.1000000000000005, -3.4000000000000004, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.2, -3.3000000000000007, -3.4000000000000004, -3.100000000000001, -3.3000000000000007, -3.7, -3.500000000000001, -3.3000000000000007, -3.1000000000000005, -3.500000000000001, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.300000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.5000000000000004, -3.1000000000000005, -3.400000000000001, -10.6, -3.2000000000000006], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 17, 17, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 20, 21, 16, 21, 21, 21, 21, 21, 21, 21, 17, 21, 5, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.500295985988414, "mean_inference_ms": 17.408436560610898, "mean_action_processing_ms": 0.9114767694841985, "mean_env_wait_ms": 2.229029380272602, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0723964604900111, "StateBufferConnector_ms": 0.008861383601049683, "ViewRequirementAgentConnector_ms": 0.13432382938250825}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.200000000000001, "episode_reward_mean": -3.930653266331659, "episode_len_mean": 20.20603015075377, "episodes_this_iter": 199, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.0000000000000004, -3.3000000000000007, -11.700000000000001, -11.7, -3.2000000000000006, -3.500000000000001, -3.2, -11.7, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.4000000000000004, -3.0000000000000004, -3.400000000000001, -3.100000000000001, -3.3000000000000007, -3.500000000000001, -3.1000000000000005, -3.400000000000001, -3.0000000000000004, -3.2, -3.2, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -10.6, -3.5000000000000004, -3.3000000000000007, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.900000000000001, -3.3000000000000007, -3.3000000000000003, -3.2, -3.3000000000000003, -3.0000000000000004, -3.4000000000000004, -3.4000000000000004, -3.2000000000000006, -3.3000000000000003, -3.3000000000000003, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.6000000000000005, -3.4000000000000004, -10.1, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.500000000000001, -3.6000000000000014, -3.5000000000000013, -3.0000000000000004, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.3000000000000003, -3.1000000000000005, -3.5000000000000004, -3.3000000000000007, -3.5000000000000004, -3.100000000000001, -3.3000000000000007, -3.300000000000001, -3.3000000000000007, -3.1000000000000005, -3.100000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -11.1, -3.5000000000000004, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2, -3.500000000000001, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.3000000000000003, -11.8, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -12.200000000000001, -3.2000000000000006, -11.7, -3.300000000000001, -3.2000000000000006, -3.5000000000000004, -3.1000000000000005, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -11.8, -3.2000000000000006, -10.4, -10.8, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.5000000000000004, -3.500000000000001, -3.1000000000000005, -3.1000000000000005, -3.100000000000001, -3.1000000000000005, -10.6, -3.600000000000001, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -10.7, -3.700000000000001, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.300000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -11.6, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.3000000000000003, -3.5000000000000004, -10.8, -3.3000000000000003, -3.0000000000000004, -3.3000000000000007, -3.100000000000001, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.4000000000000012, -3.0000000000000004, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2, -3.4000000000000004, -3.1000000000000005, -3.4000000000000004, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.2, -3.3000000000000007, -3.4000000000000004, -3.100000000000001, -3.3000000000000007, -3.7, -3.500000000000001, -3.3000000000000007, -3.1000000000000005, -3.500000000000001, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.300000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.5000000000000004, -3.1000000000000005, -3.400000000000001, -10.6, -3.2000000000000006], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 17, 17, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 20, 21, 16, 21, 21, 21, 21, 21, 21, 21, 17, 21, 5, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.500295985988414, "mean_inference_ms": 17.408436560610898, "mean_action_processing_ms": 0.9114767694841985, "mean_env_wait_ms": 2.229029380272602, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0723964604900111, "StateBufferConnector_ms": 0.008861383601049683, "ViewRequirementAgentConnector_ms": 0.13432382938250825}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 420000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 420000, "timers": {"training_iteration_time_ms": 170836.247, "load_time_ms": 1.185, "load_throughput": 3376784.478, "learn_time_ms": 169865.891, "learn_throughput": 23.548, "synch_weights_time_ms": 180.2}, "counters": {"num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000}, "done": false, "episodes_total": 21277, "training_iteration": 105, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_01-55-05", "timestamp": 1680825305, "time_this_iter_s": 170.74612188339233, "time_total_s": 17954.82925581932, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7effc01230d0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014728c430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 17954.82925581932, "timesteps_since_restore": 0, "iterations_since_restore": 105, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.359504132231405, "ram_util_percent": 24.284710743801657}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3715942953542997, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.11543660982041269, "policy_loss": -0.07697875594610087, "vf_loss": 0.1682676550191176, "vf_explained_var": 0.7817936626813745, "kl": 0.012562746174010118, "entropy": 3.532272889537196, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 98115.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 424000, "num_agent_steps_trained": 424000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -11.9, "episode_reward_mean": -3.691709844559586, "episode_len_mean": 20.367875647668395, "episode_media": {}, "episodes_this_iter": 193, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3000000000000003, -3.2, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.4000000000000012, -3.2, -3.400000000000001, -3.3000000000000003, -3.4000000000000004, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.200000000000001, -3.100000000000001, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.2, -11.1, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.4000000000000004, -3.500000000000001, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.200000000000001, -3.2000000000000006, -3.100000000000001, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.500000000000001, -3.1000000000000005, -11.700000000000001, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.500000000000001, -3.3000000000000007, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.300000000000001, -3.3000000000000007, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.2, -3.3000000000000007, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -3.0000000000000004, -3.0000000000000004, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.4000000000000004, -3.0000000000000004, -3.4000000000000004, -3.3000000000000007, -3.2000000000000006, -3.6000000000000005, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.4000000000000004, -3.200000000000001, -3.0000000000000004, -3.3000000000000007, -3.0000000000000004, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.200000000000001, -3.3000000000000007, -3.3000000000000007, -10.4, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.600000000000001, -3.3000000000000003, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -10.6, -10.0, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -10.7, -3.3000000000000007, -3.6000000000000005, -3.2000000000000006, -3.500000000000001, -3.0000000000000004, -10.6, -3.2000000000000006, -11.6, -3.3000000000000007, -3.1000000000000005, -3.5000000000000004, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.500000000000001, -11.0, -3.500000000000001, -11.0, -3.2000000000000006, -3.3000000000000007, -3.600000000000001, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.500000000000001, -3.2000000000000006, -3.4000000000000012, -3.2, -3.2, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -11.9, -3.200000000000001, -3.4000000000000004, -3.2000000000000006, -3.200000000000001, -3.1000000000000005, -3.500000000000001, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.500000000000001, -3.5000000000000004, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.2, -3.3000000000000007, -3.4000000000000004, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.200000000000001, -3.2000000000000006, -3.2, -3.100000000000001, -3.700000000000001, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.2], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 1, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 7, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.496647375258581, "mean_inference_ms": 17.39625005448095, "mean_action_processing_ms": 0.9109914721154716, "mean_env_wait_ms": 2.231156121893163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07589888696225813, "StateBufferConnector_ms": 0.009043970256271757, "ViewRequirementAgentConnector_ms": 0.13959728992047088}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -11.9, "episode_reward_mean": -3.691709844559586, "episode_len_mean": 20.367875647668395, "episodes_this_iter": 193, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.3000000000000003, -3.2, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.4000000000000012, -3.2, -3.400000000000001, -3.3000000000000003, -3.4000000000000004, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.200000000000001, -3.100000000000001, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.2, -11.1, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.4000000000000004, -3.500000000000001, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.200000000000001, -3.2000000000000006, -3.100000000000001, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.500000000000001, -3.1000000000000005, -11.700000000000001, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.500000000000001, -3.3000000000000007, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.300000000000001, -3.3000000000000007, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.2, -3.3000000000000007, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -3.0000000000000004, -3.0000000000000004, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.4000000000000004, -3.0000000000000004, -3.4000000000000004, -3.3000000000000007, -3.2000000000000006, -3.6000000000000005, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.4000000000000004, -3.200000000000001, -3.0000000000000004, -3.3000000000000007, -3.0000000000000004, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.200000000000001, -3.3000000000000007, -3.3000000000000007, -10.4, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.600000000000001, -3.3000000000000003, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -10.6, -10.0, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -10.7, -3.3000000000000007, -3.6000000000000005, -3.2000000000000006, -3.500000000000001, -3.0000000000000004, -10.6, -3.2000000000000006, -11.6, -3.3000000000000007, -3.1000000000000005, -3.5000000000000004, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.500000000000001, -11.0, -3.500000000000001, -11.0, -3.2000000000000006, -3.3000000000000007, -3.600000000000001, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.500000000000001, -3.2000000000000006, -3.4000000000000012, -3.2, -3.2, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -11.9, -3.200000000000001, -3.4000000000000004, -3.2000000000000006, -3.200000000000001, -3.1000000000000005, -3.500000000000001, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.500000000000001, -3.5000000000000004, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.2, -3.3000000000000007, -3.4000000000000004, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.200000000000001, -3.2000000000000006, -3.2, -3.100000000000001, -3.700000000000001, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.2], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 1, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 7, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.496647375258581, "mean_inference_ms": 17.39625005448095, "mean_action_processing_ms": 0.9109914721154716, "mean_env_wait_ms": 2.231156121893163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07589888696225813, "StateBufferConnector_ms": 0.009043970256271757, "ViewRequirementAgentConnector_ms": 0.13959728992047088}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 424000, "num_agent_steps_trained": 424000, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 424000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 424000, "timers": {"training_iteration_time_ms": 170896.796, "load_time_ms": 1.173, "load_throughput": 3409933.944, "learn_time_ms": 169917.614, "learn_throughput": 23.541, "synch_weights_time_ms": 184.196}, "counters": {"num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 424000, "num_agent_steps_trained": 424000}, "done": false, "episodes_total": 21470, "training_iteration": 106, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_01-57-56", "timestamp": 1680825476, "time_this_iter_s": 171.07615423202515, "time_total_s": 18125.905410051346, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01477aee20>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7effc010f8b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 18125.905410051346, "timesteps_since_restore": 0, "iterations_since_restore": 106, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.501229508196722, "ram_util_percent": 24.30000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7451758723105153, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.3449195287187874, "policy_loss": -0.032161800742339625, "vf_loss": 0.3658007703245848, "vf_explained_var": 0.5903343379497528, "kl": 0.005868666835557369, "entropy": 3.5421433569282614, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 99045.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_agent_steps_sampled": 428000, "num_agent_steps_trained": 428000}, "sampler_results": {"episode_reward_max": 98.6, "episode_reward_min": -11.8, "episode_reward_mean": -3.4970149253731346, "episode_len_mean": 19.865671641791046, "episode_media": {}, "episodes_this_iter": 201, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -11.6, -3.400000000000001, -3.5000000000000004, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.200000000000001, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.6000000000000005, -3.2, -3.100000000000001, -3.400000000000001, -3.1000000000000005, -3.0000000000000004, -10.9, -11.700000000000001, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -10.2, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -11.2, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -10.5, -3.2000000000000006, -11.0, -3.3000000000000007, -11.0, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.5000000000000004, -3.3000000000000003, -3.7000000000000006, -3.1000000000000005, -11.5, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.7000000000000006, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.5000000000000004, -3.2000000000000006, -10.3, -3.0000000000000004, -3.0000000000000004, -3.3000000000000003, -3.5000000000000004, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.400000000000001, -3.0000000000000004, -3.0000000000000004, -3.3000000000000007, -10.2, -3.2, -10.8, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.400000000000001, -3.400000000000001, -3.400000000000001, -3.5000000000000004, -3.3000000000000007, -3.2, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.100000000000001, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.500000000000001, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.0000000000000004, -3.5000000000000004, -11.0, -3.2, -3.2000000000000006, -3.200000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -11.0, -3.3000000000000003, -3.2, -3.5000000000000004, 98.6, -10.8, -3.2000000000000006, -3.1000000000000005, -3.100000000000001, -3.2000000000000006, -3.600000000000001, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.2, -3.1000000000000005, -3.2, -11.4, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -10.5, -3.1000000000000005, -11.8, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.300000000000001, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.4000000000000004, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -10.3, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.5000000000000004, -3.1000000000000005, -3.2, -3.5000000000000004, -3.2000000000000006, -3.300000000000001, -3.3000000000000007, -3.5000000000000004, -3.2000000000000006, -3.6000000000000005, -3.400000000000001, -3.3000000000000003, -3.0000000000000004, -3.5000000000000004, -3.4000000000000004, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.100000000000001, -3.1000000000000005, -10.8, -3.2000000000000006, -3.2000000000000006, -3.2, -3.1000000000000005], "episode_lengths": [21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 18, 21, 21, 21, 3, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 6, 21, 11, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 15, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 6, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.499077883277112, "mean_inference_ms": 17.436006413613573, "mean_action_processing_ms": 0.9119713173544716, "mean_env_wait_ms": 2.235269822190365, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07233216394832478, "StateBufferConnector_ms": 0.009475062735638215, "ViewRequirementAgentConnector_ms": 0.13578815839776945}}, "episode_reward_max": 98.6, "episode_reward_min": -11.8, "episode_reward_mean": -3.4970149253731346, "episode_len_mean": 19.865671641791046, "episodes_this_iter": 201, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -11.6, -3.400000000000001, -3.5000000000000004, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.200000000000001, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.6000000000000005, -3.2, -3.100000000000001, -3.400000000000001, -3.1000000000000005, -3.0000000000000004, -10.9, -11.700000000000001, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -10.2, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -11.2, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -10.5, -3.2000000000000006, -11.0, -3.3000000000000007, -11.0, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.5000000000000004, -3.3000000000000003, -3.7000000000000006, -3.1000000000000005, -11.5, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.7000000000000006, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.5000000000000004, -3.2000000000000006, -10.3, -3.0000000000000004, -3.0000000000000004, -3.3000000000000003, -3.5000000000000004, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.400000000000001, -3.0000000000000004, -3.0000000000000004, -3.3000000000000007, -10.2, -3.2, -10.8, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.400000000000001, -3.400000000000001, -3.400000000000001, -3.5000000000000004, -3.3000000000000007, -3.2, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.100000000000001, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.500000000000001, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.0000000000000004, -3.5000000000000004, -11.0, -3.2, -3.2000000000000006, -3.200000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -11.0, -3.3000000000000003, -3.2, -3.5000000000000004, 98.6, -10.8, -3.2000000000000006, -3.1000000000000005, -3.100000000000001, -3.2000000000000006, -3.600000000000001, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.2, -3.1000000000000005, -3.2, -11.4, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -10.5, -3.1000000000000005, -11.8, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.300000000000001, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.4000000000000004, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -10.3, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.5000000000000004, -3.1000000000000005, -3.2, -3.5000000000000004, -3.2000000000000006, -3.300000000000001, -3.3000000000000007, -3.5000000000000004, -3.2000000000000006, -3.6000000000000005, -3.400000000000001, -3.3000000000000003, -3.0000000000000004, -3.5000000000000004, -3.4000000000000004, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.100000000000001, -3.1000000000000005, -10.8, -3.2000000000000006, -3.2000000000000006, -3.2, -3.1000000000000005], "episode_lengths": [21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 18, 21, 21, 21, 3, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 6, 21, 11, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 15, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 6, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.499077883277112, "mean_inference_ms": 17.436006413613573, "mean_action_processing_ms": 0.9119713173544716, "mean_env_wait_ms": 2.235269822190365, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07233216394832478, "StateBufferConnector_ms": 0.009475062735638215, "ViewRequirementAgentConnector_ms": 0.13578815839776945}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 428000, "num_agent_steps_trained": 428000, "num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 428000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 428000, "timers": {"training_iteration_time_ms": 170837.232, "load_time_ms": 1.162, "load_throughput": 3441762.606, "learn_time_ms": 169856.083, "learn_throughput": 23.549, "synch_weights_time_ms": 183.32}, "counters": {"num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_agent_steps_sampled": 428000, "num_agent_steps_trained": 428000}, "done": false, "episodes_total": 21671, "training_iteration": 107, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_02-00-47", "timestamp": 1680825647, "time_this_iter_s": 170.62683391571045, "time_total_s": 18296.532243967056, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0147659970>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7effc010f550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 18296.532243967056, "timesteps_since_restore": 0, "iterations_since_restore": 107, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 6.005785123966942, "ram_util_percent": 24.29669421487604}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0545231348724775, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.2701843014878211, "policy_loss": -0.025072652390176652, "vf_loss": 0.27514402425837936, "vf_explained_var": 0.7023544085923061, "kl": 0.01046367085192062, "entropy": 3.5320797692063035, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 99975.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "sampler_results": {"episode_reward_max": 97.6, "episode_reward_min": -12.3, "episode_reward_mean": -3.1984848484848496, "episode_len_mean": 20.46969696969697, "episode_media": {}, "episodes_this_iter": 198, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.200000000000001, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.7000000000000006, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.2, -3.200000000000001, -3.3000000000000003, -3.200000000000001, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.2, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.0000000000000004, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.300000000000001, -3.3000000000000007, -12.0, -3.400000000000001, -3.1000000000000005, -3.2, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -3.4000000000000004, -10.4, -3.2, -3.3000000000000003, -3.2, -3.1000000000000005, -3.1000000000000005, 97.6, -11.0, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -12.0, -3.400000000000001, -3.4000000000000004, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -10.6, -3.100000000000001, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -11.2, -3.3000000000000007, -3.1000000000000005, -10.9, -10.8, -12.2, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.5000000000000004, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.200000000000001, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -10.5, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.2, -3.1000000000000005, -3.400000000000001, -3.0000000000000004, -12.3, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -3.4000000000000004, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.500000000000001, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.0000000000000004, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.400000000000001, -3.4000000000000004, -3.1000000000000005, -3.0000000000000004, -3.200000000000001, -3.2, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.2, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.0000000000000004, -3.2, -11.6, -3.200000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.2, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.400000000000001, -3.400000000000001, -3.400000000000001, -3.100000000000001, -3.500000000000001, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.4000000000000004, -3.5000000000000004, -3.300000000000001, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2, -3.1000000000000005, -3.2, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 20, 10, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 11, 21, 21, 10, 9, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.495323865461664, "mean_inference_ms": 17.42040181173458, "mean_action_processing_ms": 0.9117440581731266, "mean_env_wait_ms": 2.2357975996584996, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07278762682519778, "StateBufferConnector_ms": 0.009381650674222695, "ViewRequirementAgentConnector_ms": 0.13511530076614534}}, "episode_reward_max": 97.6, "episode_reward_min": -12.3, "episode_reward_mean": -3.1984848484848496, "episode_len_mean": 20.46969696969697, "episodes_this_iter": 198, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.200000000000001, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.7000000000000006, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.2, -3.200000000000001, -3.3000000000000003, -3.200000000000001, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.2, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.0000000000000004, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.300000000000001, -3.3000000000000007, -12.0, -3.400000000000001, -3.1000000000000005, -3.2, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -3.4000000000000004, -10.4, -3.2, -3.3000000000000003, -3.2, -3.1000000000000005, -3.1000000000000005, 97.6, -11.0, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -12.0, -3.400000000000001, -3.4000000000000004, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -10.6, -3.100000000000001, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -11.2, -3.3000000000000007, -3.1000000000000005, -10.9, -10.8, -12.2, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.5000000000000004, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.200000000000001, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -10.5, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.2, -3.1000000000000005, -3.400000000000001, -3.0000000000000004, -12.3, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -3.4000000000000004, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.500000000000001, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.0000000000000004, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.400000000000001, -3.4000000000000004, -3.1000000000000005, -3.0000000000000004, -3.200000000000001, -3.2, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.2, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.0000000000000004, -3.2, -11.6, -3.200000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.2, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.400000000000001, -3.400000000000001, -3.400000000000001, -3.100000000000001, -3.500000000000001, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.4000000000000004, -3.5000000000000004, -3.300000000000001, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2, -3.1000000000000005, -3.2, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 20, 10, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 11, 21, 21, 10, 9, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.495323865461664, "mean_inference_ms": 17.42040181173458, "mean_action_processing_ms": 0.9117440581731266, "mean_env_wait_ms": 2.2357975996584996, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07278762682519778, "StateBufferConnector_ms": 0.009381650674222695, "ViewRequirementAgentConnector_ms": 0.13511530076614534}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 432000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 170839.733, "load_time_ms": 1.158, "load_throughput": 3452812.513, "learn_time_ms": 169856.127, "learn_throughput": 23.549, "synch_weights_time_ms": 183.547}, "counters": {"num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "episodes_total": 21869, "training_iteration": 108, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_02-03-38", "timestamp": 1680825818, "time_this_iter_s": 170.59736561775208, "time_total_s": 18467.12960958481, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7effc0130340>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014736b160>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 18467.12960958481, "timesteps_since_restore": 0, "iterations_since_restore": 108, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.74320987654321, "ram_util_percent": 24.297942386831284}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6432479130965407, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.19836871894977748, "policy_loss": -0.08442396545602429, "vf_loss": 0.2539032929972495, "vf_explained_var": 0.7178066684353737, "kl": 0.015029588267044414, "entropy": 3.528029223924042, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 100905.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_agent_steps_sampled": 436000, "num_agent_steps_trained": 436000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.0, "episode_reward_mean": -3.7091836734693877, "episode_len_mean": 20.556122448979593, "episode_media": {}, "episodes_this_iter": 196, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.2000000000000006, -3.200000000000001, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.4000000000000012, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.4000000000000004, -3.3000000000000007, -3.4000000000000004, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.300000000000001, -3.5000000000000004, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.200000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -11.5, -3.2000000000000006, -3.3000000000000003, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.4000000000000012, -3.3000000000000007, -3.3000000000000007, -3.5000000000000004, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -10.8, -3.400000000000001, -3.5000000000000004, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -3.4000000000000004, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.5000000000000004, -3.400000000000001, -11.3, -3.0000000000000004, -3.700000000000001, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -11.1, -3.200000000000001, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.3000000000000003, -3.600000000000001, -3.3000000000000007, -3.5000000000000004, -3.4000000000000004, -3.400000000000001, -3.3000000000000003, -3.1000000000000005, -3.300000000000001, -3.2000000000000006, -10.2, -3.400000000000001, -3.1000000000000005, -3.500000000000001, -3.100000000000001, -3.600000000000001, -3.3000000000000003, -3.500000000000001, -3.0000000000000004, -3.2, -11.0, -3.200000000000001, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.4000000000000004, -3.3000000000000007, -3.500000000000001, -3.1000000000000005, -3.2000000000000006, -3.2, -3.100000000000001, -3.0000000000000004, -3.5000000000000004, -3.400000000000001, -3.1000000000000005, -3.5000000000000004, -11.4, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.100000000000001, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.200000000000001, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.500000000000001, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.2, -3.300000000000001, -3.400000000000001, -3.0000000000000004, -3.400000000000001, -3.2000000000000006, -11.8, -3.3000000000000007, -3.2000000000000006, -3.200000000000001, -3.2000000000000006, -3.3000000000000003, -12.0, -3.7000000000000006, -3.400000000000001, -3.3000000000000007, -3.2, -3.0000000000000004, -11.1, -3.0000000000000004, -3.3000000000000007, -3.3000000000000007, -11.9, -3.400000000000001, -3.3000000000000007, -3.2], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 11, 21, 21, 21, 18, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.50025495042865, "mean_inference_ms": 17.419486443993684, "mean_action_processing_ms": 0.9114682629231377, "mean_env_wait_ms": 2.236313035552848, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06961518404435138, "StateBufferConnector_ms": 0.008803849317589584, "ViewRequirementAgentConnector_ms": 0.12882157247893664}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.0, "episode_reward_mean": -3.7091836734693877, "episode_len_mean": 20.556122448979593, "episodes_this_iter": 196, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.2000000000000006, -3.200000000000001, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.4000000000000012, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.4000000000000004, -3.3000000000000007, -3.4000000000000004, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.300000000000001, -3.5000000000000004, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.200000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -11.5, -3.2000000000000006, -3.3000000000000003, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.4000000000000012, -3.3000000000000007, -3.3000000000000007, -3.5000000000000004, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -10.8, -3.400000000000001, -3.5000000000000004, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -3.4000000000000004, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.5000000000000004, -3.400000000000001, -11.3, -3.0000000000000004, -3.700000000000001, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -11.1, -3.200000000000001, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.3000000000000003, -3.600000000000001, -3.3000000000000007, -3.5000000000000004, -3.4000000000000004, -3.400000000000001, -3.3000000000000003, -3.1000000000000005, -3.300000000000001, -3.2000000000000006, -10.2, -3.400000000000001, -3.1000000000000005, -3.500000000000001, -3.100000000000001, -3.600000000000001, -3.3000000000000003, -3.500000000000001, -3.0000000000000004, -3.2, -11.0, -3.200000000000001, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.4000000000000004, -3.3000000000000007, -3.500000000000001, -3.1000000000000005, -3.2000000000000006, -3.2, -3.100000000000001, -3.0000000000000004, -3.5000000000000004, -3.400000000000001, -3.1000000000000005, -3.5000000000000004, -11.4, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.100000000000001, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.200000000000001, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.500000000000001, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.2, -3.300000000000001, -3.400000000000001, -3.0000000000000004, -3.400000000000001, -3.2000000000000006, -11.8, -3.3000000000000007, -3.2000000000000006, -3.200000000000001, -3.2000000000000006, -3.3000000000000003, -12.0, -3.7000000000000006, -3.400000000000001, -3.3000000000000007, -3.2, -3.0000000000000004, -11.1, -3.0000000000000004, -3.3000000000000007, -3.3000000000000007, -11.9, -3.400000000000001, -3.3000000000000007, -3.2], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 11, 21, 21, 21, 18, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.50025495042865, "mean_inference_ms": 17.419486443993684, "mean_action_processing_ms": 0.9114682629231377, "mean_env_wait_ms": 2.236313035552848, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06961518404435138, "StateBufferConnector_ms": 0.008803849317589584, "ViewRequirementAgentConnector_ms": 0.12882157247893664}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 436000, "num_agent_steps_trained": 436000, "num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 436000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 436000, "timers": {"training_iteration_time_ms": 170870.522, "load_time_ms": 1.143, "load_throughput": 3500650.169, "learn_time_ms": 169893.884, "learn_throughput": 23.544, "synch_weights_time_ms": 182.11}, "counters": {"num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_agent_steps_sampled": 436000, "num_agent_steps_trained": 436000}, "done": false, "episodes_total": 22065, "training_iteration": 109, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_02-06-29", "timestamp": 1680825989, "time_this_iter_s": 171.35718250274658, "time_total_s": 18638.486792087555, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476bc0d0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014728ca60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 18638.486792087555, "timesteps_since_restore": 0, "iterations_since_restore": 109, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.550819672131148, "ram_util_percent": 24.300409836065587}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.415073500910113, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.10433282615536804, "policy_loss": -0.07755878862439185, "vf_loss": 0.1583629025226479, "vf_explained_var": 0.7441220564867861, "kl": 0.012240714970750794, "entropy": 3.5098435476262084, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 101835.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -11.8, "episode_reward_mean": -3.5875647668393786, "episode_len_mean": 20.66839378238342, "episode_media": {}, "episodes_this_iter": 193, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.500000000000001, -3.400000000000001, -11.3, -3.500000000000001, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -3.500000000000001, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.5000000000000004, -3.200000000000001, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.100000000000001, -3.2, -3.2000000000000006, -3.100000000000001, -3.3000000000000007, -3.3000000000000007, -11.8, -3.1000000000000005, -3.200000000000001, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.4000000000000004, -3.3000000000000007, -3.1000000000000005, -3.100000000000001, -3.5000000000000004, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -11.3, -3.1000000000000005, -3.6000000000000005, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.2, -3.700000000000001, -3.1000000000000005, -3.4000000000000004, -3.400000000000001, -11.1, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.3000000000000003, -3.0000000000000004, -11.6, -3.6000000000000005, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.5000000000000004, -3.500000000000001, -3.1000000000000005, -3.500000000000001, -3.4000000000000004, -3.3000000000000003, -3.3000000000000007, -3.100000000000001, -3.3000000000000003, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.2, -3.6000000000000005, -3.400000000000001, -3.1000000000000005, -11.1, -3.2000000000000006, -3.200000000000001, -3.0000000000000004, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.400000000000001, -3.200000000000001, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.5000000000000004, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.200000000000001, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.600000000000001, -10.5, -3.3000000000000003, -3.1000000000000005, -3.400000000000001, -3.4000000000000004, -3.300000000000001, -3.3000000000000003, -3.5000000000000004, -3.3000000000000003, -3.3000000000000003, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.500000000000001, -3.1000000000000005, -3.2, -3.400000000000001, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -11.700000000000001, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.5000000000000004, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.500000000000001, -3.1000000000000005, -3.5000000000000004, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.200000000000001, -3.1000000000000005, -3.3000000000000007, -3.5000000000000004, -3.6000000000000014, -3.3000000000000003, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.400000000000001], "episode_lengths": [21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.50106037225464, "mean_inference_ms": 17.422189252696747, "mean_action_processing_ms": 0.9118211921476568, "mean_env_wait_ms": 2.235235290560031, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07597967750667908, "StateBufferConnector_ms": 0.009816915877742471, "ViewRequirementAgentConnector_ms": 0.1396658507035804}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -11.8, "episode_reward_mean": -3.5875647668393786, "episode_len_mean": 20.66839378238342, "episodes_this_iter": 193, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.500000000000001, -3.400000000000001, -11.3, -3.500000000000001, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -3.500000000000001, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.5000000000000004, -3.200000000000001, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.100000000000001, -3.2, -3.2000000000000006, -3.100000000000001, -3.3000000000000007, -3.3000000000000007, -11.8, -3.1000000000000005, -3.200000000000001, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.4000000000000004, -3.3000000000000007, -3.1000000000000005, -3.100000000000001, -3.5000000000000004, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -11.3, -3.1000000000000005, -3.6000000000000005, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.2, -3.700000000000001, -3.1000000000000005, -3.4000000000000004, -3.400000000000001, -11.1, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.3000000000000003, -3.0000000000000004, -11.6, -3.6000000000000005, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.5000000000000004, -3.500000000000001, -3.1000000000000005, -3.500000000000001, -3.4000000000000004, -3.3000000000000003, -3.3000000000000007, -3.100000000000001, -3.3000000000000003, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.2, -3.6000000000000005, -3.400000000000001, -3.1000000000000005, -11.1, -3.2000000000000006, -3.200000000000001, -3.0000000000000004, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.400000000000001, -3.200000000000001, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.5000000000000004, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.200000000000001, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.600000000000001, -10.5, -3.3000000000000003, -3.1000000000000005, -3.400000000000001, -3.4000000000000004, -3.300000000000001, -3.3000000000000003, -3.5000000000000004, -3.3000000000000003, -3.3000000000000003, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.500000000000001, -3.1000000000000005, -3.2, -3.400000000000001, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -11.700000000000001, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.5000000000000004, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.500000000000001, -3.1000000000000005, -3.5000000000000004, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.200000000000001, -3.1000000000000005, -3.3000000000000007, -3.5000000000000004, -3.6000000000000014, -3.3000000000000003, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.400000000000001], "episode_lengths": [21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.50106037225464, "mean_inference_ms": 17.422189252696747, "mean_action_processing_ms": 0.9118211921476568, "mean_env_wait_ms": 2.235235290560031, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07597967750667908, "StateBufferConnector_ms": 0.009816915877742471, "ViewRequirementAgentConnector_ms": 0.1396658507035804}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 440000, "timers": {"training_iteration_time_ms": 170840.313, "load_time_ms": 1.137, "load_throughput": 3518785.209, "learn_time_ms": 169865.549, "learn_throughput": 23.548, "synch_weights_time_ms": 181.25}, "counters": {"num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000}, "done": false, "episodes_total": 22258, "training_iteration": 110, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_02-09-20", "timestamp": 1680826160, "time_this_iter_s": 170.78517127037048, "time_total_s": 18809.271963357925, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476d72e0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7effc0134820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 18809.271963357925, "timesteps_since_restore": 0, "iterations_since_restore": 110, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.35843621399177, "ram_util_percent": 24.296296296296305}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5535550184467788, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.18333559320658765, "policy_loss": -0.098548969690017, "vf_loss": 0.25593363845180117, "vf_explained_var": 0.6779201435786422, "kl": 0.013500861221578933, "entropy": 3.491747031673308, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 102765.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -11.600000000000001, "episode_reward_mean": -3.74848484848485, "episode_len_mean": 20.383838383838384, "episode_media": {}, "episodes_this_iter": 198, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.300000000000001, -3.400000000000001, -3.300000000000001, -3.300000000000001, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.2, -3.500000000000001, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -10.7, -3.2000000000000006, -3.500000000000001, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2, -3.1000000000000005, -3.2, -3.1000000000000005, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.0000000000000004, -3.0000000000000004, -3.5000000000000004, -3.1000000000000005, -3.1000000000000005, -11.0, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.500000000000001, -3.3000000000000007, -3.3000000000000003, -3.0000000000000004, -3.400000000000001, -3.300000000000001, -11.3, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.400000000000001, -3.3000000000000007, -3.500000000000001, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.3000000000000007, -3.100000000000001, -3.200000000000001, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -10.3, -10.2, -3.1000000000000005, -11.0, -3.3000000000000007, -3.0000000000000004, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.4000000000000012, -3.3000000000000003, -3.1000000000000005, -3.400000000000001, -3.5000000000000004, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.0000000000000004, -3.200000000000001, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.6000000000000005, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.6000000000000005, -11.4, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.300000000000001, -3.1000000000000005, -11.2, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.3000000000000003, -3.400000000000001, -3.400000000000001, -3.0000000000000004, -3.100000000000001, -3.2000000000000006, -3.2000000000000006, -11.5, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.5000000000000004, -3.600000000000001, -3.3000000000000003, -3.400000000000001, -3.400000000000001, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.5000000000000004, -3.2000000000000006, -3.4000000000000004, -3.400000000000001, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -11.1, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.100000000000001, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.4000000000000004, -3.300000000000001, -3.2000000000000006, -3.2, -3.300000000000001, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.300000000000001, -3.4000000000000004, -11.5, -3.2, -3.400000000000001, -3.1000000000000005, -11.600000000000001, -3.500000000000001, -3.3000000000000007, -3.2000000000000006, -11.6, -3.3000000000000007], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 3, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 16, 21, 21, 21, 17, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.502123169135217, "mean_inference_ms": 17.44369000715709, "mean_action_processing_ms": 0.9130938074307817, "mean_env_wait_ms": 2.241796150231114, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07302676788484207, "StateBufferConnector_ms": 0.00926918453640408, "ViewRequirementAgentConnector_ms": 0.13589521851202455}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -11.600000000000001, "episode_reward_mean": -3.74848484848485, "episode_len_mean": 20.383838383838384, "episodes_this_iter": 198, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.300000000000001, -3.400000000000001, -3.300000000000001, -3.300000000000001, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.2, -3.500000000000001, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -10.7, -3.2000000000000006, -3.500000000000001, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2, -3.1000000000000005, -3.2, -3.1000000000000005, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.0000000000000004, -3.0000000000000004, -3.5000000000000004, -3.1000000000000005, -3.1000000000000005, -11.0, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.500000000000001, -3.3000000000000007, -3.3000000000000003, -3.0000000000000004, -3.400000000000001, -3.300000000000001, -11.3, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.400000000000001, -3.3000000000000007, -3.500000000000001, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.3000000000000007, -3.100000000000001, -3.200000000000001, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -10.3, -10.2, -3.1000000000000005, -11.0, -3.3000000000000007, -3.0000000000000004, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.4000000000000012, -3.3000000000000003, -3.1000000000000005, -3.400000000000001, -3.5000000000000004, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.0000000000000004, -3.200000000000001, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.6000000000000005, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.6000000000000005, -11.4, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.300000000000001, -3.1000000000000005, -11.2, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.3000000000000003, -3.400000000000001, -3.400000000000001, -3.0000000000000004, -3.100000000000001, -3.2000000000000006, -3.2000000000000006, -11.5, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.5000000000000004, -3.600000000000001, -3.3000000000000003, -3.400000000000001, -3.400000000000001, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.5000000000000004, -3.2000000000000006, -3.4000000000000004, -3.400000000000001, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -11.1, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.100000000000001, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.4000000000000004, -3.300000000000001, -3.2000000000000006, -3.2, -3.300000000000001, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.300000000000001, -3.4000000000000004, -11.5, -3.2, -3.400000000000001, -3.1000000000000005, -11.600000000000001, -3.500000000000001, -3.3000000000000007, -3.2000000000000006, -11.6, -3.3000000000000007], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 3, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 16, 21, 21, 21, 17, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.502123169135217, "mean_inference_ms": 17.44369000715709, "mean_action_processing_ms": 0.9130938074307817, "mean_env_wait_ms": 2.241796150231114, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07302676788484207, "StateBufferConnector_ms": 0.00926918453640408, "ViewRequirementAgentConnector_ms": 0.13589521851202455}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 444000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 444000, "timers": {"training_iteration_time_ms": 170881.737, "load_time_ms": 1.138, "load_throughput": 3515319.951, "learn_time_ms": 169903.383, "learn_throughput": 23.543, "synch_weights_time_ms": 181.064}, "counters": {"num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000}, "done": false, "episodes_total": 22456, "training_iteration": 111, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_02-12-11", "timestamp": 1680826331, "time_this_iter_s": 170.80968141555786, "time_total_s": 18980.081644773483, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f014746ec40>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7effc01345e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 18980.081644773483, "timesteps_since_restore": 0, "iterations_since_restore": 111, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.351652892561983, "ram_util_percent": 24.29669421487604}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3652897396235055, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.19099290660452298, "policy_loss": -0.08424089993400279, "vf_loss": 0.24915987621161645, "vf_explained_var": 0.7424650472979392, "kl": 0.013564854339566283, "entropy": 3.4818482306695753, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 103695.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.100000000000001, "episode_reward_mean": -3.647422680412372, "episode_len_mean": 20.567010309278352, "episode_media": {}, "episodes_this_iter": 194, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -10.8, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.2, -3.3000000000000003, -3.3000000000000003, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.400000000000001, -3.2000000000000006, -10.8, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.500000000000001, -3.4000000000000004, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -12.0, -3.3000000000000007, -3.1000000000000005, -3.100000000000001, -3.5000000000000004, -3.3000000000000007, -11.6, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.300000000000001, -3.4000000000000004, -3.3000000000000003, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -11.0, -12.100000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.6000000000000005, -3.1000000000000005, -3.2000000000000006, -3.100000000000001, -3.3000000000000007, -3.100000000000001, -3.3000000000000003, -3.0000000000000004, -3.300000000000001, -3.3000000000000003, -3.4000000000000004, -3.300000000000001, -3.2, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -11.1, -3.1000000000000005, -3.3000000000000003, -3.500000000000001, -3.1000000000000005, -3.4000000000000004, -11.6, -3.4000000000000012, -3.100000000000001, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.400000000000001, -3.3000000000000003, -3.4000000000000004, -3.2000000000000006, -3.4000000000000004, -3.6000000000000005, -3.3000000000000007, -10.5, -3.2, -3.2000000000000006, -3.600000000000001, -3.400000000000001, -3.2, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.5000000000000004, -3.400000000000001, -3.400000000000001, -3.0000000000000004, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.2, -3.6000000000000005, -3.0000000000000004, -3.400000000000001, -3.3000000000000007, -3.0000000000000004, -11.2, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.200000000000001, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.5000000000000004, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.2, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.100000000000001, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2, -3.3000000000000007, -3.500000000000001, -3.3000000000000007, -3.3000000000000007, -3.2, -3.3000000000000007], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.492693622607028, "mean_inference_ms": 17.427266400589655, "mean_action_processing_ms": 0.9124740774020355, "mean_env_wait_ms": 2.242137457695452, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07642519842718065, "StateBufferConnector_ms": 0.009727355131168956, "ViewRequirementAgentConnector_ms": 0.14087797440204425}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.100000000000001, "episode_reward_mean": -3.647422680412372, "episode_len_mean": 20.567010309278352, "episodes_this_iter": 194, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -10.8, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.2, -3.3000000000000003, -3.3000000000000003, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.400000000000001, -3.2000000000000006, -10.8, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.500000000000001, -3.4000000000000004, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -12.0, -3.3000000000000007, -3.1000000000000005, -3.100000000000001, -3.5000000000000004, -3.3000000000000007, -11.6, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.300000000000001, -3.4000000000000004, -3.3000000000000003, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -11.0, -12.100000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.6000000000000005, -3.1000000000000005, -3.2000000000000006, -3.100000000000001, -3.3000000000000007, -3.100000000000001, -3.3000000000000003, -3.0000000000000004, -3.300000000000001, -3.3000000000000003, -3.4000000000000004, -3.300000000000001, -3.2, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -11.1, -3.1000000000000005, -3.3000000000000003, -3.500000000000001, -3.1000000000000005, -3.4000000000000004, -11.6, -3.4000000000000012, -3.100000000000001, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.400000000000001, -3.3000000000000003, -3.4000000000000004, -3.2000000000000006, -3.4000000000000004, -3.6000000000000005, -3.3000000000000007, -10.5, -3.2, -3.2000000000000006, -3.600000000000001, -3.400000000000001, -3.2, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.5000000000000004, -3.400000000000001, -3.400000000000001, -3.0000000000000004, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.2, -3.6000000000000005, -3.0000000000000004, -3.400000000000001, -3.3000000000000007, -3.0000000000000004, -11.2, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.200000000000001, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.5000000000000004, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.2, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.100000000000001, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2, -3.3000000000000007, -3.500000000000001, -3.3000000000000007, -3.3000000000000007, -3.2, -3.3000000000000007], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.492693622607028, "mean_inference_ms": 17.427266400589655, "mean_action_processing_ms": 0.9124740774020355, "mean_env_wait_ms": 2.242137457695452, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07642519842718065, "StateBufferConnector_ms": 0.009727355131168956, "ViewRequirementAgentConnector_ms": 0.14087797440204425}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 448000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 170846.966, "load_time_ms": 1.136, "load_throughput": 3521517.988, "learn_time_ms": 169873.255, "learn_throughput": 23.547, "synch_weights_time_ms": 178.358}, "counters": {"num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "episodes_total": 22650, "training_iteration": 112, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_02-15-02", "timestamp": 1680826502, "time_this_iter_s": 170.9324221611023, "time_total_s": 19151.014066934586, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476f2640>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7effc01340d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 19151.014066934586, "timesteps_since_restore": 0, "iterations_since_restore": 112, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.320901639344263, "ram_util_percent": 24.296721311475423}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3590616809905216, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.2319914043840942, "policy_loss": -0.08579126722830277, "vf_loss": 0.2910271489592169, "vf_explained_var": 0.6534431907438463, "kl": 0.013919451052569583, "entropy": 3.4773855109368603, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 104625.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 452000, "num_agent_steps_trained": 452000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -11.4, "episode_reward_mean": -3.8196969696969707, "episode_len_mean": 20.12121212121212, "episode_media": {}, "episodes_this_iter": 198, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.1000000000000005, -3.2000000000000006, -3.200000000000001, -3.2000000000000006, -3.200000000000001, -3.2, -3.0000000000000004, -3.3000000000000007, -3.7000000000000006, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.100000000000001, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.200000000000001, -3.3000000000000007, -3.1000000000000005, -3.400000000000001, -10.5, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.2, -3.3000000000000007, -3.2000000000000006, -11.4, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.500000000000001, -3.2, -3.2000000000000006, -3.5000000000000013, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -10.2, -3.2000000000000006, -11.0, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.3000000000000003, -3.400000000000001, -10.3, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.5000000000000004, -3.200000000000001, -3.500000000000001, -3.5000000000000004, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.100000000000001, -3.400000000000001, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.100000000000001, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -11.3, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -10.4, -3.6000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.0000000000000004, -11.1, -3.100000000000001, -3.2000000000000006, -3.5000000000000004, -11.3, -3.200000000000001, -11.2, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.0000000000000004, -3.100000000000001, -3.400000000000001, -3.3000000000000007, -3.2, -3.400000000000001, -3.2000000000000006, -3.200000000000001, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.2, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.3000000000000007, -3.500000000000001, -3.3000000000000007, -11.1, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.4000000000000004, -3.400000000000001, -11.3, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.5000000000000004, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.3000000000000003, -3.100000000000001, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.500000000000001, -3.3000000000000007, -3.7000000000000006, -3.3000000000000007, -3.0000000000000004, -3.3000000000000003, -3.2, -3.3000000000000007, -3.4000000000000004, -3.0000000000000004, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.4, -3.3000000000000007, -10.3, -3.3000000000000007, -11.2, -3.0000000000000004, -3.1000000000000005, -11.0, -3.4000000000000004], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 9, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 12, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 11, 21, 21, 10, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.499013065295374, "mean_inference_ms": 17.4332379216884, "mean_action_processing_ms": 0.9123501005575733, "mean_env_wait_ms": 2.242339222486111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08028938312723179, "StateBufferConnector_ms": 0.009937960692126342, "ViewRequirementAgentConnector_ms": 0.1483512647224195}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -11.4, "episode_reward_mean": -3.8196969696969707, "episode_len_mean": 20.12121212121212, "episodes_this_iter": 198, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.1000000000000005, -3.2000000000000006, -3.200000000000001, -3.2000000000000006, -3.200000000000001, -3.2, -3.0000000000000004, -3.3000000000000007, -3.7000000000000006, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.100000000000001, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.200000000000001, -3.3000000000000007, -3.1000000000000005, -3.400000000000001, -10.5, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.2, -3.3000000000000007, -3.2000000000000006, -11.4, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.500000000000001, -3.2, -3.2000000000000006, -3.5000000000000013, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -10.2, -3.2000000000000006, -11.0, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.3000000000000003, -3.400000000000001, -10.3, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.5000000000000004, -3.200000000000001, -3.500000000000001, -3.5000000000000004, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.100000000000001, -3.400000000000001, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.100000000000001, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -11.3, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -10.4, -3.6000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.0000000000000004, -11.1, -3.100000000000001, -3.2000000000000006, -3.5000000000000004, -11.3, -3.200000000000001, -11.2, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.0000000000000004, -3.100000000000001, -3.400000000000001, -3.3000000000000007, -3.2, -3.400000000000001, -3.2000000000000006, -3.200000000000001, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.2, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.3000000000000007, -3.500000000000001, -3.3000000000000007, -11.1, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.4000000000000004, -3.400000000000001, -11.3, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.5000000000000004, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.3000000000000003, -3.100000000000001, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.500000000000001, -3.3000000000000007, -3.7000000000000006, -3.3000000000000007, -3.0000000000000004, -3.3000000000000003, -3.2, -3.3000000000000007, -3.4000000000000004, -3.0000000000000004, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.4, -3.3000000000000007, -10.3, -3.3000000000000007, -11.2, -3.0000000000000004, -3.1000000000000005, -11.0, -3.4000000000000004], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 9, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 12, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 11, 21, 21, 10, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.499013065295374, "mean_inference_ms": 17.4332379216884, "mean_action_processing_ms": 0.9123501005575733, "mean_env_wait_ms": 2.242339222486111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08028938312723179, "StateBufferConnector_ms": 0.009937960692126342, "ViewRequirementAgentConnector_ms": 0.1483512647224195}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 452000, "num_agent_steps_trained": 452000, "num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 452000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 452000, "timers": {"training_iteration_time_ms": 170940.038, "load_time_ms": 1.132, "load_throughput": 3534873.372, "learn_time_ms": 169965.092, "learn_throughput": 23.534, "synch_weights_time_ms": 179.302}, "counters": {"num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 452000, "num_agent_steps_trained": 452000}, "done": false, "episodes_total": 22848, "training_iteration": 113, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_02-17-53", "timestamp": 1680826673, "time_this_iter_s": 171.59421396255493, "time_total_s": 19322.60828089714, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01477a3ca0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7effc0134790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 19322.60828089714, "timesteps_since_restore": 0, "iterations_since_restore": 113, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.533744855967077, "ram_util_percent": 24.296296296296305}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3510145073536264, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.23821432492495465, "policy_loss": -0.03139209346182304, "vf_loss": 0.25816887122358606, "vf_explained_var": 0.5860872089221913, "kl": 0.0059503362738146815, "entropy": 3.471112256665384, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 105555.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "sampler_results": {"episode_reward_max": 99.4, "episode_reward_min": -11.8, "episode_reward_mean": -3.366153846153846, "episode_len_mean": 20.107692307692307, "episode_media": {}, "episodes_this_iter": 195, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3000000000000003, -3.3000000000000007, 99.4, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.4000000000000004, -3.400000000000001, -3.5000000000000004, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2, -3.1000000000000005, -3.2000000000000006, -3.2, -3.1000000000000005, -3.2, -3.1000000000000005, -3.3000000000000007, -3.200000000000001, -3.4, -3.2000000000000006, -11.6, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.4000000000000004, -3.1000000000000005, -11.1, -3.2, -3.3000000000000007, -3.1000000000000005, -10.8, -3.1000000000000005, -3.2, -3.0000000000000004, -3.400000000000001, -3.4000000000000004, -3.2, -3.3000000000000003, -3.4000000000000004, -3.1000000000000005, -10.8, -3.3000000000000007, -3.2000000000000006, -3.5000000000000004, -3.2000000000000006, -3.400000000000001, -3.3000000000000003, -3.200000000000001, -3.2000000000000006, -3.500000000000001, -3.2000000000000006, -3.2, -3.200000000000001, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.200000000000001, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.2, -3.100000000000001, -3.1000000000000005, -3.4000000000000004, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -3.0000000000000004, -11.7, -3.2000000000000006, -3.0000000000000004, -3.4000000000000004, -3.2, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -11.7, -3.1000000000000005, -3.500000000000001, -11.1, -3.1000000000000005, -3.3000000000000007, -3.100000000000001, -3.2000000000000006, -3.100000000000001, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -11.2, -3.3000000000000007, -3.500000000000001, -3.500000000000001, -3.500000000000001, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -11.7, -3.100000000000001, -3.2000000000000006, -3.2, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.500000000000001, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.500000000000001, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -11.4, -3.3000000000000007, -3.2000000000000006, -3.5000000000000004, -3.3000000000000007, -3.100000000000001, -3.2, -3.5000000000000004, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -10.0, -3.2000000000000006, -3.4000000000000004, -3.3000000000000003, -3.3000000000000007, -3.7000000000000006, -11.8, -3.200000000000001, -3.3000000000000003, -3.600000000000001, -3.2000000000000006, -3.1000000000000005, -10.4, -3.5000000000000004, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.400000000000001, -10.8, -10.4, -3.0000000000000004, -10.6, -3.2, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.3000000000000003], "episode_lengths": [21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 12, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 5, 21, 7, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.501240768632444, "mean_inference_ms": 17.443365622923434, "mean_action_processing_ms": 0.9125948314083343, "mean_env_wait_ms": 2.2411624415009603, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07207564818553436, "StateBufferConnector_ms": 0.008942530705378605, "ViewRequirementAgentConnector_ms": 0.13328319940811548}}, "episode_reward_max": 99.4, "episode_reward_min": -11.8, "episode_reward_mean": -3.366153846153846, "episode_len_mean": 20.107692307692307, "episodes_this_iter": 195, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.3000000000000003, -3.3000000000000007, 99.4, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.4000000000000004, -3.400000000000001, -3.5000000000000004, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2, -3.1000000000000005, -3.2000000000000006, -3.2, -3.1000000000000005, -3.2, -3.1000000000000005, -3.3000000000000007, -3.200000000000001, -3.4, -3.2000000000000006, -11.6, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.4000000000000004, -3.1000000000000005, -11.1, -3.2, -3.3000000000000007, -3.1000000000000005, -10.8, -3.1000000000000005, -3.2, -3.0000000000000004, -3.400000000000001, -3.4000000000000004, -3.2, -3.3000000000000003, -3.4000000000000004, -3.1000000000000005, -10.8, -3.3000000000000007, -3.2000000000000006, -3.5000000000000004, -3.2000000000000006, -3.400000000000001, -3.3000000000000003, -3.200000000000001, -3.2000000000000006, -3.500000000000001, -3.2000000000000006, -3.2, -3.200000000000001, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.200000000000001, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.2, -3.100000000000001, -3.1000000000000005, -3.4000000000000004, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -3.0000000000000004, -11.7, -3.2000000000000006, -3.0000000000000004, -3.4000000000000004, -3.2, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -11.7, -3.1000000000000005, -3.500000000000001, -11.1, -3.1000000000000005, -3.3000000000000007, -3.100000000000001, -3.2000000000000006, -3.100000000000001, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -11.2, -3.3000000000000007, -3.500000000000001, -3.500000000000001, -3.500000000000001, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -11.7, -3.100000000000001, -3.2000000000000006, -3.2, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.500000000000001, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.500000000000001, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -11.4, -3.3000000000000007, -3.2000000000000006, -3.5000000000000004, -3.3000000000000007, -3.100000000000001, -3.2, -3.5000000000000004, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -10.0, -3.2000000000000006, -3.4000000000000004, -3.3000000000000003, -3.3000000000000007, -3.7000000000000006, -11.8, -3.200000000000001, -3.3000000000000003, -3.600000000000001, -3.2000000000000006, -3.1000000000000005, -10.4, -3.5000000000000004, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.400000000000001, -10.8, -10.4, -3.0000000000000004, -10.6, -3.2, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.3000000000000003], "episode_lengths": [21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 12, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 5, 21, 7, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.501240768632444, "mean_inference_ms": 17.443365622923434, "mean_action_processing_ms": 0.9125948314083343, "mean_env_wait_ms": 2.2411624415009603, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07207564818553436, "StateBufferConnector_ms": 0.008942530705378605, "ViewRequirementAgentConnector_ms": 0.13328319940811548}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 456000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 456000, "timers": {"training_iteration_time_ms": 170901.564, "load_time_ms": 1.127, "load_throughput": 3549606.686, "learn_time_ms": 169937.147, "learn_throughput": 23.538, "synch_weights_time_ms": 180.034}, "counters": {"num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "done": false, "episodes_total": 23043, "training_iteration": 114, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_02-20-44", "timestamp": 1680826844, "time_this_iter_s": 170.61276984214783, "time_total_s": 19493.22105073929, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01472af760>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7effc01345e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 19493.22105073929, "timesteps_since_restore": 0, "iterations_since_restore": 114, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.418930041152263, "ram_util_percent": 24.288477366255144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.601766492650714, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.18374314697919994, "policy_loss": -0.0793448205676771, "vf_loss": 0.2340596324944448, "vf_explained_var": 0.7723044524910629, "kl": 0.015101872947410009, "entropy": 3.452861548495549, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 106485.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_agent_steps_sampled": 460000, "num_agent_steps_trained": 460000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -11.9, "episode_reward_mean": -3.67313432835821, "episode_len_mean": 20.492537313432837, "episode_media": {}, "episodes_this_iter": 201, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.2000000000000006, -3.300000000000001, -3.0000000000000004, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.6000000000000005, -3.500000000000001, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.100000000000001, -3.2000000000000006, -3.2000000000000006, -3.2, -3.3000000000000007, -3.3000000000000003, -3.2, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.500000000000001, -3.0000000000000004, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.100000000000001, -3.2, -3.3000000000000007, -11.5, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.5, -3.3000000000000007, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -10.7, -3.3000000000000007, -3.2, -11.1, -3.2, -3.1000000000000005, -3.3000000000000007, -10.3, -3.2000000000000006, -3.3000000000000007, -10.8, -3.4000000000000004, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -11.8, -11.1, -3.1000000000000005, -3.0000000000000004, -11.8, -3.0000000000000004, -3.3000000000000007, -3.400000000000001, -11.6, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.2, -3.1000000000000005, -3.300000000000001, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.200000000000001, -3.5000000000000013, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.200000000000001, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.100000000000001, -3.2000000000000006, -3.400000000000001, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.200000000000001, -3.400000000000001, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.5000000000000004, -3.3000000000000007, -3.100000000000001, -3.1000000000000005, -3.3000000000000003, -3.600000000000001, -3.3000000000000007, -3.200000000000001, -11.9, -3.2000000000000006, -3.2000000000000006, -10.3, -3.100000000000001, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.400000000000001, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.100000000000001, -3.100000000000001, -3.4000000000000004, -3.4000000000000004, -3.3000000000000007, -3.3000000000000003, -3.500000000000001, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.500000000000001, -3.5000000000000004, -3.3000000000000007, -3.1000000000000005, -3.2, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.600000000000001, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.2, -3.1000000000000005, -3.3000000000000007, -3.100000000000001, -3.700000000000001, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.1000000000000005], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 11, 21, 21, 21, 4, 21, 21, 9, 21, 21, 21, 21, 21, 17, 10, 21, 21, 18, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.506533968647389, "mean_inference_ms": 17.44771651807879, "mean_action_processing_ms": 0.9129689916304028, "mean_env_wait_ms": 2.2446672430209618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07690600494840252, "StateBufferConnector_ms": 0.009487280205114563, "ViewRequirementAgentConnector_ms": 0.143454323953657}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -11.9, "episode_reward_mean": -3.67313432835821, "episode_len_mean": 20.492537313432837, "episodes_this_iter": 201, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.2000000000000006, -3.300000000000001, -3.0000000000000004, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.6000000000000005, -3.500000000000001, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.100000000000001, -3.2000000000000006, -3.2000000000000006, -3.2, -3.3000000000000007, -3.3000000000000003, -3.2, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.500000000000001, -3.0000000000000004, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.100000000000001, -3.2, -3.3000000000000007, -11.5, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.5, -3.3000000000000007, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -10.7, -3.3000000000000007, -3.2, -11.1, -3.2, -3.1000000000000005, -3.3000000000000007, -10.3, -3.2000000000000006, -3.3000000000000007, -10.8, -3.4000000000000004, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -11.8, -11.1, -3.1000000000000005, -3.0000000000000004, -11.8, -3.0000000000000004, -3.3000000000000007, -3.400000000000001, -11.6, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.2, -3.1000000000000005, -3.300000000000001, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.200000000000001, -3.5000000000000013, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.200000000000001, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.100000000000001, -3.2000000000000006, -3.400000000000001, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.200000000000001, -3.400000000000001, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.5000000000000004, -3.3000000000000007, -3.100000000000001, -3.1000000000000005, -3.3000000000000003, -3.600000000000001, -3.3000000000000007, -3.200000000000001, -11.9, -3.2000000000000006, -3.2000000000000006, -10.3, -3.100000000000001, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.400000000000001, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.100000000000001, -3.100000000000001, -3.4000000000000004, -3.4000000000000004, -3.3000000000000007, -3.3000000000000003, -3.500000000000001, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.500000000000001, -3.5000000000000004, -3.3000000000000007, -3.1000000000000005, -3.2, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.600000000000001, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.2, -3.1000000000000005, -3.3000000000000007, -3.100000000000001, -3.700000000000001, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.1000000000000005], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 11, 21, 21, 21, 4, 21, 21, 9, 21, 21, 21, 21, 21, 17, 10, 21, 21, 18, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.506533968647389, "mean_inference_ms": 17.44771651807879, "mean_action_processing_ms": 0.9129689916304028, "mean_env_wait_ms": 2.2446672430209618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07690600494840252, "StateBufferConnector_ms": 0.009487280205114563, "ViewRequirementAgentConnector_ms": 0.143454323953657}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 460000, "num_agent_steps_trained": 460000, "num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 460000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 460000, "timers": {"training_iteration_time_ms": 170941.394, "load_time_ms": 1.138, "load_throughput": 3516425.143, "learn_time_ms": 169976.33, "learn_throughput": 23.533, "synch_weights_time_ms": 178.536}, "counters": {"num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_agent_steps_sampled": 460000, "num_agent_steps_trained": 460000}, "done": false, "episodes_total": 23244, "training_iteration": 115, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_02-23-35", "timestamp": 1680827015, "time_this_iter_s": 171.1454758644104, "time_total_s": 19664.3665266037, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476f2be0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7effc010f790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 19664.3665266037, "timesteps_since_restore": 0, "iterations_since_restore": 115, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.416872427983539, "ram_util_percent": 24.297119341563796}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.366140098004572, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.20200509838259187, "policy_loss": -0.08231629669786461, "vf_loss": 0.2559841091694531, "vf_explained_var": 0.6928536440095594, "kl": 0.014742356429867928, "entropy": 3.4303417751866, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 107415.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.0, "episode_reward_mean": -3.6623762376237634, "episode_len_mean": 20.5, "episode_media": {}, "episodes_this_iter": 202, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.4000000000000004, -3.100000000000001, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -11.2, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.200000000000001, -11.9, -3.3000000000000007, -10.6, -3.4000000000000004, -3.3000000000000007, -3.400000000000001, -3.200000000000001, -3.100000000000001, -3.2000000000000006, -3.1000000000000005, -10.9, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.2, -3.3000000000000003, -3.4000000000000004, -11.6, -3.2000000000000006, -11.2, -3.300000000000001, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2, -3.2000000000000006, -3.0000000000000004, -3.5000000000000004, -3.400000000000001, -3.1000000000000005, -3.5000000000000004, -3.0000000000000004, -3.2000000000000006, -3.300000000000001, -11.0, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.100000000000001, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.4000000000000004, -10.4, -3.3000000000000007, -3.3000000000000003, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.2, -3.400000000000001, -3.600000000000001, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -11.1, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.5000000000000004, -3.6000000000000005, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.600000000000001, -3.2000000000000006, -3.2000000000000006, -3.600000000000001, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.300000000000001, -3.1000000000000005, -10.9, -3.3000000000000003, -3.300000000000001, -3.3000000000000007, -3.2, -3.200000000000001, -3.2000000000000006, -3.3000000000000007, -3.2, -12.0, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.2, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -3.4000000000000004, -3.0000000000000004, -3.100000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.5000000000000004, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.400000000000001, -3.6000000000000014, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.2, -3.500000000000001, -3.2, -3.3000000000000003, -3.3000000000000003, -3.2, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.100000000000001, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.6, -3.2000000000000006, -3.400000000000001, -3.7000000000000006, -3.1000000000000005, -3.4000000000000004], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 18, 21, 7, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.508773220264251, "mean_inference_ms": 17.44543066281932, "mean_action_processing_ms": 0.912798707028878, "mean_env_wait_ms": 2.246332335579203, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07359627449866568, "StateBufferConnector_ms": 0.00916813859845152, "ViewRequirementAgentConnector_ms": 0.1347214868753263}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.0, "episode_reward_mean": -3.6623762376237634, "episode_len_mean": 20.5, "episodes_this_iter": 202, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.4000000000000004, -3.100000000000001, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -11.2, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.200000000000001, -11.9, -3.3000000000000007, -10.6, -3.4000000000000004, -3.3000000000000007, -3.400000000000001, -3.200000000000001, -3.100000000000001, -3.2000000000000006, -3.1000000000000005, -10.9, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.2, -3.3000000000000003, -3.4000000000000004, -11.6, -3.2000000000000006, -11.2, -3.300000000000001, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2, -3.2000000000000006, -3.0000000000000004, -3.5000000000000004, -3.400000000000001, -3.1000000000000005, -3.5000000000000004, -3.0000000000000004, -3.2000000000000006, -3.300000000000001, -11.0, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.100000000000001, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.4000000000000004, -10.4, -3.3000000000000007, -3.3000000000000003, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.2, -3.400000000000001, -3.600000000000001, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -11.1, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.5000000000000004, -3.6000000000000005, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.600000000000001, -3.2000000000000006, -3.2000000000000006, -3.600000000000001, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.300000000000001, -3.1000000000000005, -10.9, -3.3000000000000003, -3.300000000000001, -3.3000000000000007, -3.2, -3.200000000000001, -3.2000000000000006, -3.3000000000000007, -3.2, -12.0, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.2, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -3.4000000000000004, -3.0000000000000004, -3.100000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.5000000000000004, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.400000000000001, -3.6000000000000014, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.2, -3.500000000000001, -3.2, -3.3000000000000003, -3.3000000000000003, -3.2, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.100000000000001, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.6, -3.2000000000000006, -3.400000000000001, -3.7000000000000006, -3.1000000000000005, -3.4000000000000004], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 18, 21, 7, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.508773220264251, "mean_inference_ms": 17.44543066281932, "mean_action_processing_ms": 0.912798707028878, "mean_env_wait_ms": 2.246332335579203, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07359627449866568, "StateBufferConnector_ms": 0.00916813859845152, "ViewRequirementAgentConnector_ms": 0.1347214868753263}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 464000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 464000, "timers": {"training_iteration_time_ms": 170974.784, "load_time_ms": 1.141, "load_throughput": 3506576.654, "learn_time_ms": 170013.972, "learn_throughput": 23.527, "synch_weights_time_ms": 178.285}, "counters": {"num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "done": false, "episodes_total": 23446, "training_iteration": 116, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_02-26-27", "timestamp": 1680827187, "time_this_iter_s": 171.40849113464355, "time_total_s": 19835.775017738342, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01473e2c70>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7effc00b5d30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 19835.775017738342, "timesteps_since_restore": 0, "iterations_since_restore": 116, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.573770491803278, "ram_util_percent": 24.30081967213116}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4590861044423555, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.12602602809226962, "policy_loss": -0.03696653547431392, "vf_loss": 0.1477847575891002, "vf_explained_var": 0.7769854609684278, "kl": 0.007911799746904752, "entropy": 3.4388453573308966, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 108345.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "sampler_results": {"episode_reward_max": 98.1, "episode_reward_min": -12.3, "episode_reward_mean": -2.9219895287958124, "episode_len_mean": 20.87434554973822, "episode_media": {}, "episodes_this_iter": 191, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.4000000000000004, -3.400000000000001, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.500000000000001, -12.0, -3.3000000000000007, -3.100000000000001, -3.3000000000000007, -3.400000000000001, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.200000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.200000000000001, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.300000000000001, -3.5000000000000004, -3.2000000000000006, -3.5000000000000004, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.2, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.2, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.5000000000000004, -3.3000000000000003, -3.2000000000000006, -3.100000000000001, -3.2000000000000006, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.200000000000001, -3.7, -3.3000000000000007, -3.0000000000000004, -3.500000000000001, -3.3000000000000003, -3.3000000000000003, -3.400000000000001, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.200000000000001, -3.1000000000000005, -3.200000000000001, -3.4000000000000004, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.100000000000001, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -12.0, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.2, -3.2000000000000006, -3.2, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -12.200000000000001, -3.5000000000000004, -3.6000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, 98.1, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.2, -3.3000000000000003, -3.2000000000000006, -3.0000000000000004, -3.5000000000000004, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.300000000000001, -3.1000000000000005, -3.300000000000001, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.6000000000000005, -3.4000000000000004, -11.0, -3.400000000000001, -3.2, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.4000000000000004, -3.1000000000000005, -3.3000000000000007, -3.2, -3.1000000000000005, -3.4000000000000004, -3.500000000000001, -3.6000000000000005, -3.300000000000001, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.400000000000001, -3.400000000000001, -3.200000000000001, -3.3000000000000007, -3.2, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -12.3, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.51151853844677, "mean_inference_ms": 17.434908425724956, "mean_action_processing_ms": 0.9117278090893283, "mean_env_wait_ms": 2.2459597703944416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06897062531316468, "StateBufferConnector_ms": 0.008842957581525073, "ViewRequirementAgentConnector_ms": 0.1282457281781741}}, "episode_reward_max": 98.1, "episode_reward_min": -12.3, "episode_reward_mean": -2.9219895287958124, "episode_len_mean": 20.87434554973822, "episodes_this_iter": 191, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.4000000000000004, -3.400000000000001, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.500000000000001, -12.0, -3.3000000000000007, -3.100000000000001, -3.3000000000000007, -3.400000000000001, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.200000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.200000000000001, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.300000000000001, -3.5000000000000004, -3.2000000000000006, -3.5000000000000004, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.2, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.2, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.5000000000000004, -3.3000000000000003, -3.2000000000000006, -3.100000000000001, -3.2000000000000006, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.200000000000001, -3.7, -3.3000000000000007, -3.0000000000000004, -3.500000000000001, -3.3000000000000003, -3.3000000000000003, -3.400000000000001, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.200000000000001, -3.1000000000000005, -3.200000000000001, -3.4000000000000004, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.100000000000001, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -12.0, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.2, -3.2000000000000006, -3.2, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -12.200000000000001, -3.5000000000000004, -3.6000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, 98.1, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.2, -3.3000000000000003, -3.2000000000000006, -3.0000000000000004, -3.5000000000000004, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.300000000000001, -3.1000000000000005, -3.300000000000001, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.6000000000000005, -3.4000000000000004, -11.0, -3.400000000000001, -3.2, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.4000000000000004, -3.1000000000000005, -3.3000000000000007, -3.2, -3.1000000000000005, -3.4000000000000004, -3.500000000000001, -3.6000000000000005, -3.300000000000001, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.400000000000001, -3.400000000000001, -3.200000000000001, -3.3000000000000007, -3.2, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -12.3, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.51151853844677, "mean_inference_ms": 17.434908425724956, "mean_action_processing_ms": 0.9117278090893283, "mean_env_wait_ms": 2.2459597703944416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06897062531316468, "StateBufferConnector_ms": 0.008842957581525073, "ViewRequirementAgentConnector_ms": 0.1282457281781741}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 468000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 468000, "timers": {"training_iteration_time_ms": 170966.321, "load_time_ms": 1.133, "load_throughput": 3530038.925, "learn_time_ms": 170009.627, "learn_throughput": 23.528, "synch_weights_time_ms": 177.909}, "counters": {"num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "done": false, "episodes_total": 23637, "training_iteration": 117, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_02-29-17", "timestamp": 1680827357, "time_this_iter_s": 170.54191064834595, "time_total_s": 20006.31692838669, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f014746e220>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7effc00b5c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 20006.31692838669, "timesteps_since_restore": 0, "iterations_since_restore": 117, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.42798353909465, "ram_util_percent": 24.05514403292181}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3539825398274647, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.23177181852440681, "policy_loss": -0.0339290185280705, "vf_loss": 0.2454564451560458, "vf_explained_var": 0.7514404855107748, "kl": 0.010532060902695902, "entropy": 3.4355372751912765, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 109275.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 472000, "num_agent_steps_trained": 472000}, "sampler_results": {"episode_reward_max": 99.0, "episode_reward_min": -11.9, "episode_reward_mean": -2.5401015228426407, "episode_len_mean": 20.456852791878173, "episode_media": {}, "episodes_this_iter": 197, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.2, -3.4000000000000004, -3.3000000000000007, -11.2, -3.3000000000000007, -3.1000000000000005, -10.5, -3.3000000000000007, -3.1000000000000005, -3.4000000000000004, 98.9, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.5000000000000004, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.0000000000000004, -3.4000000000000004, -3.1000000000000005, -3.3000000000000003, -3.4000000000000004, -3.1000000000000005, -3.200000000000001, -3.3000000000000003, -3.1000000000000005, -3.0000000000000004, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -3.0000000000000004, -3.2000000000000006, -3.500000000000001, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.0000000000000004, -3.500000000000001, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.3000000000000003, -3.4000000000000004, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.400000000000001, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, 99.0, -3.2000000000000006, -3.5000000000000004, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.2, -3.3000000000000007, -3.200000000000001, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.300000000000001, -11.4, -3.2000000000000006, -11.9, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -10.2, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -11.6, -3.200000000000001, -3.4000000000000004, -3.2, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.300000000000001, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -10.4, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.100000000000001, -10.7, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.500000000000001, -3.1000000000000005, -3.2, -3.4000000000000004, -11.600000000000001, -3.4000000000000004, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.400000000000001, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.100000000000001, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.500000000000001, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.700000000000001, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.500000000000001, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.4000000000000012, -3.4000000000000004, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.200000000000001, -3.3000000000000007, -3.0000000000000004, -3.5000000000000004, -3.3000000000000003, -3.0000000000000004, -3.1000000000000005], "episode_lengths": [21, 21, 21, 12, 21, 21, 6, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 19, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.510588950658851, "mean_inference_ms": 17.435487961401417, "mean_action_processing_ms": 0.912320653151809, "mean_env_wait_ms": 2.245397909160561, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0689812723150108, "StateBufferConnector_ms": 0.008697558175488777, "ViewRequirementAgentConnector_ms": 0.1282198174955881}}, "episode_reward_max": 99.0, "episode_reward_min": -11.9, "episode_reward_mean": -2.5401015228426407, "episode_len_mean": 20.456852791878173, "episodes_this_iter": 197, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.2, -3.4000000000000004, -3.3000000000000007, -11.2, -3.3000000000000007, -3.1000000000000005, -10.5, -3.3000000000000007, -3.1000000000000005, -3.4000000000000004, 98.9, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.5000000000000004, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.0000000000000004, -3.4000000000000004, -3.1000000000000005, -3.3000000000000003, -3.4000000000000004, -3.1000000000000005, -3.200000000000001, -3.3000000000000003, -3.1000000000000005, -3.0000000000000004, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -3.0000000000000004, -3.2000000000000006, -3.500000000000001, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.0000000000000004, -3.500000000000001, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.3000000000000003, -3.4000000000000004, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.400000000000001, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, 99.0, -3.2000000000000006, -3.5000000000000004, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.2, -3.3000000000000007, -3.200000000000001, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.300000000000001, -11.4, -3.2000000000000006, -11.9, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -10.2, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -11.6, -3.200000000000001, -3.4000000000000004, -3.2, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.300000000000001, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -10.4, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.100000000000001, -10.7, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.500000000000001, -3.1000000000000005, -3.2, -3.4000000000000004, -11.600000000000001, -3.4000000000000004, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.400000000000001, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.100000000000001, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.500000000000001, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.700000000000001, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.500000000000001, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.4000000000000012, -3.4000000000000004, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.200000000000001, -3.3000000000000007, -3.0000000000000004, -3.5000000000000004, -3.3000000000000003, -3.0000000000000004, -3.1000000000000005], "episode_lengths": [21, 21, 21, 12, 21, 21, 6, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 19, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.510588950658851, "mean_inference_ms": 17.435487961401417, "mean_action_processing_ms": 0.912320653151809, "mean_env_wait_ms": 2.245397909160561, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0689812723150108, "StateBufferConnector_ms": 0.008697558175488777, "ViewRequirementAgentConnector_ms": 0.1282198174955881}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 472000, "num_agent_steps_trained": 472000, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 472000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 472000, "timers": {"training_iteration_time_ms": 170955.424, "load_time_ms": 1.152, "load_throughput": 3471028.447, "learn_time_ms": 169999.309, "learn_throughput": 23.53, "synch_weights_time_ms": 179.087}, "counters": {"num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 472000, "num_agent_steps_trained": 472000}, "done": false, "episodes_total": 23834, "training_iteration": 118, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_02-32-08", "timestamp": 1680827528, "time_this_iter_s": 170.4873788356781, "time_total_s": 20176.804307222366, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01472fccd0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7effc00b5d30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 20176.804307222366, "timesteps_since_restore": 0, "iterations_since_restore": 118, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.406198347107439, "ram_util_percent": 23.90289256198347}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9020568677815057, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.2557977562970532, "policy_loss": -0.08648876521375871, "vf_loss": 0.31171871018195424, "vf_explained_var": 0.687007962824196, "kl": 0.01590277770420246, "entropy": 3.4267666729547646, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 110205.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 476000, "num_agent_steps_trained": 476000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.0, "episode_reward_mean": -3.777083333333334, "episode_len_mean": 20.359375, "episode_media": {}, "episodes_this_iter": 192, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.3, -3.4000000000000004, -3.4000000000000004, -3.3000000000000007, -3.2, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.2, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.3000000000000003, -3.600000000000001, -3.400000000000001, -10.5, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -11.9, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.2, -3.2, -3.3000000000000003, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.2, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.3000000000000007, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.100000000000001, -3.2, -3.1000000000000005, -10.7, -10.9, -3.4000000000000004, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.200000000000001, -3.2, -3.4000000000000004, -3.2000000000000006, -3.200000000000001, -3.500000000000001, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.4000000000000004, -10.7, -11.0, -3.2, -3.2000000000000006, -3.5000000000000004, -3.2000000000000006, -3.400000000000001, -3.6000000000000005, -3.3000000000000003, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -10.8, -3.3000000000000003, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.500000000000001, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.500000000000001, -3.500000000000001, -3.500000000000001, -3.5, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -11.3, -3.2000000000000006, -3.5000000000000004, -3.600000000000001, -3.3000000000000007, -12.0, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.400000000000001, -3.500000000000001, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -11.0, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.200000000000001, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.300000000000001, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.4000000000000004, -3.2, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.4000000000000004, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.2, -3.3000000000000007, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -12.0, -3.2000000000000006, -3.5000000000000004, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.3000000000000003, -3.4000000000000004, -3.2000000000000006, -3.0000000000000004, -3.2, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.3000000000000003, -3.200000000000001, -3.2, -3.0000000000000004, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.400000000000001, -11.5, -3.3000000000000003], "episode_lengths": [4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.508533507431153, "mean_inference_ms": 17.438562606460955, "mean_action_processing_ms": 0.9118515085968738, "mean_env_wait_ms": 2.2497757003034646, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07414904733498891, "StateBufferConnector_ms": 0.009069467584292093, "ViewRequirementAgentConnector_ms": 0.13599321246147156}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.0, "episode_reward_mean": -3.777083333333334, "episode_len_mean": 20.359375, "episodes_this_iter": 192, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10.3, -3.4000000000000004, -3.4000000000000004, -3.3000000000000007, -3.2, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.2, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.3000000000000003, -3.600000000000001, -3.400000000000001, -10.5, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -11.9, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.2, -3.2, -3.3000000000000003, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.2, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.3000000000000007, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.100000000000001, -3.2, -3.1000000000000005, -10.7, -10.9, -3.4000000000000004, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.200000000000001, -3.2, -3.4000000000000004, -3.2000000000000006, -3.200000000000001, -3.500000000000001, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.4000000000000004, -10.7, -11.0, -3.2, -3.2000000000000006, -3.5000000000000004, -3.2000000000000006, -3.400000000000001, -3.6000000000000005, -3.3000000000000003, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -10.8, -3.3000000000000003, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.500000000000001, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.500000000000001, -3.500000000000001, -3.500000000000001, -3.5, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -11.3, -3.2000000000000006, -3.5000000000000004, -3.600000000000001, -3.3000000000000007, -12.0, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.400000000000001, -3.500000000000001, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -11.0, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.200000000000001, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.300000000000001, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.4000000000000004, -3.2, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.4000000000000004, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.2, -3.3000000000000007, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -12.0, -3.2000000000000006, -3.5000000000000004, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.3000000000000003, -3.4000000000000004, -3.2000000000000006, -3.0000000000000004, -3.2, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.3000000000000003, -3.200000000000001, -3.2, -3.0000000000000004, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.400000000000001, -11.5, -3.3000000000000003], "episode_lengths": [4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.508533507431153, "mean_inference_ms": 17.438562606460955, "mean_action_processing_ms": 0.9118515085968738, "mean_env_wait_ms": 2.2497757003034646, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07414904733498891, "StateBufferConnector_ms": 0.009069467584292093, "ViewRequirementAgentConnector_ms": 0.13599321246147156}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 476000, "num_agent_steps_trained": 476000, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 476000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 476000, "timers": {"training_iteration_time_ms": 170886.476, "load_time_ms": 1.162, "load_throughput": 3443457.986, "learn_time_ms": 169928.26, "learn_throughput": 23.539, "synch_weights_time_ms": 180.208}, "counters": {"num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 476000, "num_agent_steps_trained": 476000}, "done": false, "episodes_total": 24026, "training_iteration": 119, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_02-34-59", "timestamp": 1680827699, "time_this_iter_s": 170.66875171661377, "time_total_s": 20347.47305893898, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f014746e4c0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7effc0095310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 20347.47305893898, "timesteps_since_restore": 0, "iterations_since_restore": 119, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.309465020576133, "ram_util_percent": 23.775308641975307}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1783775854655492, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.27798966847119794, "policy_loss": -0.08816387899099819, "vf_loss": 0.337305805103613, "vf_explained_var": 0.6636220172528298, "kl": 0.015007918933625533, "entropy": 3.4206481592629547, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 111135.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.3, "episode_reward_mean": -3.7738461538461543, "episode_len_mean": 20.502564102564104, "episode_media": {}, "episodes_this_iter": 195, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -10.7, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.5000000000000004, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -11.8, -3.1000000000000005, -3.2000000000000006, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.5000000000000004, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.5000000000000004, -3.3000000000000007, -3.4000000000000004, -3.3000000000000007, -3.2, -3.5000000000000004, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.2, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -11.0, -3.5000000000000004, -3.200000000000001, -3.0000000000000004, -3.4000000000000004, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -11.7, -3.100000000000001, -3.2, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.2, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.4000000000000004, -3.200000000000001, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.500000000000001, -3.1000000000000005, -3.2, -12.100000000000001, -3.5000000000000004, -3.1000000000000005, -3.0000000000000004, -3.100000000000001, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.3000000000000003, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -3.0000000000000004, -3.200000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.6000000000000005, -3.3000000000000007, -3.400000000000001, -3.100000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2, -11.1, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.600000000000001, -3.2000000000000006, -3.5000000000000004, -3.2000000000000006, -3.200000000000001, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.4000000000000004, -3.3000000000000003, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.100000000000001, -3.5000000000000004, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -11.0, -3.1000000000000005, -3.4000000000000004, -3.5000000000000004, -3.3000000000000003, -3.1000000000000005, -3.200000000000001, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.200000000000001, -3.400000000000001, -10.9, -3.5000000000000004, -3.1000000000000005, -3.1000000000000005, -11.1, -3.400000000000001, -3.4, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -10.7, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -12.100000000000001, -3.400000000000001, -12.3, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -11.4, -3.2000000000000006], "episode_lengths": [21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 20, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.507714577948637, "mean_inference_ms": 17.43578278212165, "mean_action_processing_ms": 0.9121066055670201, "mean_env_wait_ms": 2.2470451867631716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07695454817551833, "StateBufferConnector_ms": 0.009896082755846854, "ViewRequirementAgentConnector_ms": 0.14050740462083083}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.3, "episode_reward_mean": -3.7738461538461543, "episode_len_mean": 20.502564102564104, "episodes_this_iter": 195, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -10.7, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.5000000000000004, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -11.8, -3.1000000000000005, -3.2000000000000006, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.5000000000000004, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.5000000000000004, -3.3000000000000007, -3.4000000000000004, -3.3000000000000007, -3.2, -3.5000000000000004, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.2, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -11.0, -3.5000000000000004, -3.200000000000001, -3.0000000000000004, -3.4000000000000004, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -11.7, -3.100000000000001, -3.2, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.2, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.4000000000000004, -3.200000000000001, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.500000000000001, -3.1000000000000005, -3.2, -12.100000000000001, -3.5000000000000004, -3.1000000000000005, -3.0000000000000004, -3.100000000000001, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.3000000000000003, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -3.0000000000000004, -3.200000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.6000000000000005, -3.3000000000000007, -3.400000000000001, -3.100000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2, -11.1, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.600000000000001, -3.2000000000000006, -3.5000000000000004, -3.2000000000000006, -3.200000000000001, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.4000000000000004, -3.3000000000000003, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.100000000000001, -3.5000000000000004, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -11.0, -3.1000000000000005, -3.4000000000000004, -3.5000000000000004, -3.3000000000000003, -3.1000000000000005, -3.200000000000001, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.200000000000001, -3.400000000000001, -10.9, -3.5000000000000004, -3.1000000000000005, -3.1000000000000005, -11.1, -3.400000000000001, -3.4, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -10.7, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -12.100000000000001, -3.400000000000001, -12.3, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -11.4, -3.2000000000000006], "episode_lengths": [21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 20, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.507714577948637, "mean_inference_ms": 17.43578278212165, "mean_action_processing_ms": 0.9121066055670201, "mean_env_wait_ms": 2.2470451867631716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07695454817551833, "StateBufferConnector_ms": 0.009896082755846854, "ViewRequirementAgentConnector_ms": 0.14050740462083083}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 170940.801, "load_time_ms": 1.171, "load_throughput": 3415278.886, "learn_time_ms": 169982.829, "learn_throughput": 23.532, "synch_weights_time_ms": 180.4}, "counters": {"num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "episodes_total": 24221, "training_iteration": 120, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_02-37-50", "timestamp": 1680827870, "time_this_iter_s": 171.32616090774536, "time_total_s": 20518.799219846725, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01472afa30>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7effc0095430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 20518.799219846725, "timesteps_since_restore": 0, "iterations_since_restore": 120, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.601234567901234, "ram_util_percent": 23.70082304526748}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.176439270585455, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.20926662892984446, "policy_loss": -0.08323381745046185, "vf_loss": 0.2659532080199169, "vf_explained_var": 0.6888406360021202, "kl": 0.01381109285848065, "entropy": 3.410237775310393, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 112065.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_agent_steps_sampled": 484000, "num_agent_steps_trained": 484000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.3, "episode_reward_mean": -3.7738461538461543, "episode_len_mean": 20.143589743589743, "episode_media": {}, "episodes_this_iter": 195, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.2000000000000006, -3.0000000000000004, -3.500000000000001, -3.2, -3.3000000000000007, -3.3000000000000003, -3.0000000000000004, -10.2, -10.3, -3.2, -3.3000000000000007, -10.5, -3.2, -3.3000000000000007, -3.200000000000001, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.100000000000001, -3.2000000000000006, -3.3000000000000003, -3.200000000000001, -3.200000000000001, -3.2000000000000006, -3.2000000000000006, -3.500000000000001, -3.2, -3.0000000000000004, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.500000000000001, -3.4000000000000004, -3.0000000000000004, -3.300000000000001, -3.0000000000000004, -3.200000000000001, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.2, -3.3000000000000007, -3.2, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.400000000000001, -3.0000000000000004, -3.2, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -10.4, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -10.5, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2, -3.600000000000001, -3.3000000000000003, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.4000000000000004, -3.4000000000000004, -3.2000000000000006, -10.6, -3.5000000000000004, -3.3000000000000003, -11.5, -10.2, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.0000000000000004, -3.400000000000001, -3.3000000000000007, -10.9, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -11.9, -3.4000000000000004, -3.500000000000001, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -10.4, -3.3000000000000003, -3.2000000000000006, -3.3000000000000003, -3.400000000000001, -3.300000000000001, -3.2000000000000006, -3.2000000000000006, -3.2, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -10.7, -3.3000000000000003, -3.3000000000000007, -3.2, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -11.700000000000001, -3.0000000000000004, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.200000000000001, -3.100000000000001, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.6000000000000005, -3.200000000000001, -3.2000000000000006, -3.1000000000000005, -3.200000000000001, -3.3000000000000007, -3.2, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -12.3, -3.0000000000000004, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.0000000000000004, -3.2, -3.2000000000000006], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 3, 4, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 14, 3, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.507259264336632, "mean_inference_ms": 17.448305269330483, "mean_action_processing_ms": 0.9135007249724298, "mean_env_wait_ms": 2.2545834800912443, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07458026592548077, "StateBufferConnector_ms": 0.00944369878524389, "ViewRequirementAgentConnector_ms": 0.13556614900246644}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.3, "episode_reward_mean": -3.7738461538461543, "episode_len_mean": 20.143589743589743, "episodes_this_iter": 195, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.2000000000000006, -3.0000000000000004, -3.500000000000001, -3.2, -3.3000000000000007, -3.3000000000000003, -3.0000000000000004, -10.2, -10.3, -3.2, -3.3000000000000007, -10.5, -3.2, -3.3000000000000007, -3.200000000000001, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.100000000000001, -3.2000000000000006, -3.3000000000000003, -3.200000000000001, -3.200000000000001, -3.2000000000000006, -3.2000000000000006, -3.500000000000001, -3.2, -3.0000000000000004, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.500000000000001, -3.4000000000000004, -3.0000000000000004, -3.300000000000001, -3.0000000000000004, -3.200000000000001, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.2, -3.3000000000000007, -3.2, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.400000000000001, -3.0000000000000004, -3.2, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -10.4, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -10.5, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2, -3.600000000000001, -3.3000000000000003, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.4000000000000004, -3.4000000000000004, -3.2000000000000006, -10.6, -3.5000000000000004, -3.3000000000000003, -11.5, -10.2, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.0000000000000004, -3.400000000000001, -3.3000000000000007, -10.9, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -11.9, -3.4000000000000004, -3.500000000000001, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -10.4, -3.3000000000000003, -3.2000000000000006, -3.3000000000000003, -3.400000000000001, -3.300000000000001, -3.2000000000000006, -3.2000000000000006, -3.2, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -10.7, -3.3000000000000003, -3.3000000000000007, -3.2, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -11.700000000000001, -3.0000000000000004, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.200000000000001, -3.100000000000001, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.6000000000000005, -3.200000000000001, -3.2000000000000006, -3.1000000000000005, -3.200000000000001, -3.3000000000000007, -3.2, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.400000000000001, -3.400000000000001, -12.3, -3.0000000000000004, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.0000000000000004, -3.2, -3.2000000000000006], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 3, 4, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 14, 3, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.507259264336632, "mean_inference_ms": 17.448305269330483, "mean_action_processing_ms": 0.9135007249724298, "mean_env_wait_ms": 2.2545834800912443, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07458026592548077, "StateBufferConnector_ms": 0.00944369878524389, "ViewRequirementAgentConnector_ms": 0.13556614900246644}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 484000, "num_agent_steps_trained": 484000, "num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 484000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 484000, "timers": {"training_iteration_time_ms": 170931.694, "load_time_ms": 1.173, "load_throughput": 3409033.202, "learn_time_ms": 169970.345, "learn_throughput": 23.534, "synch_weights_time_ms": 183.101}, "counters": {"num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_agent_steps_sampled": 484000, "num_agent_steps_trained": 484000}, "done": false, "episodes_total": 24416, "training_iteration": 121, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_02-40-41", "timestamp": 1680828041, "time_this_iter_s": 170.71563124656677, "time_total_s": 20689.514851093292, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0147423490>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014728cca0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 20689.514851093292, "timesteps_since_restore": 0, "iterations_since_restore": 121, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.378600823045267, "ram_util_percent": 23.76625514403293}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4976172697640235, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.025159172675702522, "policy_loss": -0.07611742502989709, "vf_loss": 0.07616824211042014, "vf_explained_var": 0.8001943072965069, "kl": 0.013062518067477692, "entropy": 3.3919278908801336, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 112995.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_agent_steps_sampled": 488000, "num_agent_steps_trained": 488000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -11.9, "episode_reward_mean": -3.500523560209425, "episode_len_mean": 20.554973821989527, "episode_media": {}, "episodes_this_iter": 191, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.500000000000001, -3.2, -3.1000000000000005, -3.4000000000000004, -3.2, -3.4000000000000012, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.0000000000000004, -11.9, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.3000000000000007, -3.4000000000000004, -3.4000000000000004, -3.400000000000001, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.2, -3.1000000000000005, -10.2, -3.5000000000000004, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.100000000000001, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -11.0, -3.2000000000000006, -3.2000000000000006, -3.200000000000001, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -10.0, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.3000000000000003, -3.5000000000000004, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.400000000000001, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.5000000000000004, -3.4000000000000004, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.5000000000000013, -3.4000000000000004, -3.1000000000000005, -3.4000000000000004, -3.3000000000000007, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.200000000000001, -3.0000000000000004, -3.4000000000000004, -3.1000000000000005, -3.5000000000000004, -3.2000000000000006, -3.2000000000000006, -3.5000000000000004, -3.5000000000000004, -3.3000000000000007, -3.100000000000001, -3.4000000000000004, -3.5000000000000004, -3.1000000000000005, -3.0000000000000004, -3.7000000000000006, -3.0000000000000004, -3.3000000000000007, -3.100000000000001, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.2, -3.0000000000000004, -3.3000000000000003, -3.3000000000000007, -3.0000000000000004, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -10.7, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.300000000000001, -11.0, -3.2, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.3000000000000003, -3.500000000000001, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.200000000000001, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.2, -3.2000000000000006, -3.400000000000001, -11.2, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.509836597285082, "mean_inference_ms": 17.43922442713201, "mean_action_processing_ms": 0.911998110993195, "mean_env_wait_ms": 2.250016486451624, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07672921525246186, "StateBufferConnector_ms": 0.009814606911224844, "ViewRequirementAgentConnector_ms": 0.14200972012824414}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -11.9, "episode_reward_mean": -3.500523560209425, "episode_len_mean": 20.554973821989527, "episodes_this_iter": 191, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.500000000000001, -3.2, -3.1000000000000005, -3.4000000000000004, -3.2, -3.4000000000000012, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.0000000000000004, -11.9, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.3000000000000007, -3.4000000000000004, -3.4000000000000004, -3.400000000000001, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.2, -3.1000000000000005, -10.2, -3.5000000000000004, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.100000000000001, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -11.0, -3.2000000000000006, -3.2000000000000006, -3.200000000000001, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -10.0, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.3000000000000003, -3.5000000000000004, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.400000000000001, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.5000000000000004, -3.4000000000000004, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.5000000000000013, -3.4000000000000004, -3.1000000000000005, -3.4000000000000004, -3.3000000000000007, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.200000000000001, -3.0000000000000004, -3.4000000000000004, -3.1000000000000005, -3.5000000000000004, -3.2000000000000006, -3.2000000000000006, -3.5000000000000004, -3.5000000000000004, -3.3000000000000007, -3.100000000000001, -3.4000000000000004, -3.5000000000000004, -3.1000000000000005, -3.0000000000000004, -3.7000000000000006, -3.0000000000000004, -3.3000000000000007, -3.100000000000001, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.2, -3.0000000000000004, -3.3000000000000003, -3.3000000000000007, -3.0000000000000004, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -10.7, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.300000000000001, -11.0, -3.2, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.3000000000000003, -3.500000000000001, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.200000000000001, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.2, -3.2000000000000006, -3.400000000000001, -11.2, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.509836597285082, "mean_inference_ms": 17.43922442713201, "mean_action_processing_ms": 0.911998110993195, "mean_env_wait_ms": 2.250016486451624, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07672921525246186, "StateBufferConnector_ms": 0.009814606911224844, "ViewRequirementAgentConnector_ms": 0.14200972012824414}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 488000, "num_agent_steps_trained": 488000, "num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 488000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 488000, "timers": {"training_iteration_time_ms": 170913.639, "load_time_ms": 1.171, "load_throughput": 3416530.77, "learn_time_ms": 169954.728, "learn_throughput": 23.536, "synch_weights_time_ms": 181.494}, "counters": {"num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_agent_steps_sampled": 488000, "num_agent_steps_trained": 488000}, "done": false, "episodes_total": 24607, "training_iteration": 122, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_02-43-32", "timestamp": 1680828212, "time_this_iter_s": 170.75101280212402, "time_total_s": 20860.265863895416, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f014746e160>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff947c5ee0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 20860.265863895416, "timesteps_since_restore": 0, "iterations_since_restore": 122, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.326748971193416, "ram_util_percent": 23.79835390946503}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3004100664729072, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.2606497503376456, "policy_loss": -0.027188630909668356, "vf_loss": 0.2757710732679854, "vf_explained_var": 0.6910855659233627, "kl": 0.006277968654701967, "entropy": 3.393623149010443, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 113925.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000}, "sampler_results": {"episode_reward_max": 98.6, "episode_reward_min": -11.9, "episode_reward_mean": -3.09030612244898, "episode_len_mean": 20.510204081632654, "episode_media": {}, "episodes_this_iter": 196, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -10.7, -11.9, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.4000000000000004, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.300000000000001, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.3000000000000007, -3.400000000000001, -3.3000000000000003, -3.200000000000001, -3.0000000000000004, -3.0000000000000004, -3.500000000000001, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.2, -3.200000000000001, -3.300000000000001, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.0000000000000004, -3.1000000000000005, -3.3000000000000003, -3.3000000000000003, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, 98.6, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -10.1, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.5000000000000004, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -11.8, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.100000000000001, -3.400000000000001, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -11.2, -3.0000000000000004, -3.2, -3.0000000000000004, -3.3000000000000003, -3.6000000000000005, -3.2000000000000006, -11.8, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.300000000000001, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.5000000000000004, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.2, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -11.9, -3.200000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.300000000000001, -3.3000000000000007, -3.2, -3.100000000000001, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.4000000000000004, -3.3000000000000007, -3.2000000000000006, -3.300000000000001, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.2, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -11.8, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.3000000000000003, -3.3000000000000007, -3.5000000000000004, -3.3000000000000007, -3.3000000000000007, -3.500000000000001, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.200000000000001, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.0000000000000004, -3.2, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -10.3, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.4000000000000004, -3.4000000000000012, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.100000000000001, -10.4, -3.2000000000000006, -3.500000000000001, -3.5000000000000004, -3.3000000000000007, -3.3000000000000003, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.700000000000001, -3.2000000000000006, -3.1000000000000005], "episode_lengths": [21, 21, 21, 21, 21, 21, 7, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.510152027503342, "mean_inference_ms": 17.454262767908762, "mean_action_processing_ms": 0.9125597304613928, "mean_env_wait_ms": 2.2508126917752063, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07420328198647012, "StateBufferConnector_ms": 0.009337858277924207, "ViewRequirementAgentConnector_ms": 0.1353117884421835}}, "episode_reward_max": 98.6, "episode_reward_min": -11.9, "episode_reward_mean": -3.09030612244898, "episode_len_mean": 20.510204081632654, "episodes_this_iter": 196, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -10.7, -11.9, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.4000000000000004, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.300000000000001, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.3000000000000007, -3.400000000000001, -3.3000000000000003, -3.200000000000001, -3.0000000000000004, -3.0000000000000004, -3.500000000000001, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.2, -3.200000000000001, -3.300000000000001, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.0000000000000004, -3.1000000000000005, -3.3000000000000003, -3.3000000000000003, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, 98.6, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -10.1, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.5000000000000004, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -11.8, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.100000000000001, -3.400000000000001, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -11.2, -3.0000000000000004, -3.2, -3.0000000000000004, -3.3000000000000003, -3.6000000000000005, -3.2000000000000006, -11.8, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.300000000000001, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.5000000000000004, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.2, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -11.9, -3.200000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.300000000000001, -3.3000000000000007, -3.2, -3.100000000000001, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.4000000000000004, -3.3000000000000007, -3.2000000000000006, -3.300000000000001, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.2, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -11.8, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.3000000000000003, -3.3000000000000007, -3.5000000000000004, -3.3000000000000007, -3.3000000000000007, -3.500000000000001, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.200000000000001, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.0000000000000004, -3.2, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -10.3, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.4000000000000004, -3.4000000000000012, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.100000000000001, -10.4, -3.2000000000000006, -3.500000000000001, -3.5000000000000004, -3.3000000000000007, -3.3000000000000003, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.700000000000001, -3.2000000000000006, -3.1000000000000005], "episode_lengths": [21, 21, 21, 21, 21, 21, 7, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.510152027503342, "mean_inference_ms": 17.454262767908762, "mean_action_processing_ms": 0.9125597304613928, "mean_env_wait_ms": 2.2508126917752063, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07420328198647012, "StateBufferConnector_ms": 0.009337858277924207, "ViewRequirementAgentConnector_ms": 0.1353117884421835}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 492000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 492000, "timers": {"training_iteration_time_ms": 170886.003, "load_time_ms": 1.179, "load_throughput": 3391460.511, "learn_time_ms": 169934.759, "learn_throughput": 23.538, "synch_weights_time_ms": 180.083}, "counters": {"num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000}, "done": false, "episodes_total": 24803, "training_iteration": 123, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_02-46-23", "timestamp": 1680828383, "time_this_iter_s": 171.31717681884766, "time_total_s": 21031.583040714264, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0147659ee0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7effc00b59d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 21031.583040714264, "timesteps_since_restore": 0, "iterations_since_restore": 123, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.595491803278688, "ram_util_percent": 23.80122950819673}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.355117198792837, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.2101442676898773, "policy_loss": -0.08143750512471763, "vf_loss": 0.26250759866288914, "vf_explained_var": 0.7835985512502732, "kl": 0.015125720359629736, "entropy": 3.3840036071756834, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 114855.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.100000000000001, "episode_reward_mean": -3.655958549222799, "episode_len_mean": 20.60103626943005, "episode_media": {}, "episodes_this_iter": 193, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.0000000000000004, -3.300000000000001, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -11.7, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.100000000000001, -3.400000000000001, -3.3000000000000003, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.100000000000001, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.200000000000001, -3.2000000000000006, -3.400000000000001, -3.2, -3.1000000000000005, -3.5000000000000004, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.2, -3.2000000000000006, -3.3000000000000007, -10.9, -3.4000000000000004, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -11.1, -3.2000000000000006, -3.100000000000001, -11.9, -11.5, -3.2000000000000006, -3.2000000000000006, -3.200000000000001, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.4000000000000004, -3.3000000000000007, -3.4000000000000004, -3.4000000000000004, -3.2000000000000006, -3.400000000000001, -3.2, -3.1000000000000005, -3.1000000000000005, -3.4000000000000004, -3.100000000000001, -10.7, -3.400000000000001, -3.0000000000000004, -3.400000000000001, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -11.1, -3.200000000000001, -10.9, -3.2000000000000006, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.500000000000001, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.2, -3.5000000000000004, -3.5000000000000004, -3.400000000000001, -3.1000000000000005, -3.3000000000000003, -3.3000000000000003, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.100000000000001, -3.0000000000000004, -3.3000000000000007, -3.5000000000000004, -3.400000000000001, -3.3000000000000003, -3.5000000000000004, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.2, -3.1000000000000005, -3.2, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.200000000000001, -3.3000000000000003, -3.3000000000000003, -3.3000000000000003, -3.3000000000000003, -3.1000000000000005, -3.300000000000001, -3.2, -3.3000000000000007, -11.4, -3.200000000000001, -3.3000000000000007, -3.3000000000000003, -3.500000000000001, -3.1000000000000005, -3.2000000000000006, -12.100000000000001, -3.0000000000000004, -3.5000000000000004, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.600000000000001, -3.700000000000001, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.2, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.2, -3.400000000000001, -3.1000000000000005, -3.500000000000001, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 12, 21, 21, 20, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 11, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.506840677038266, "mean_inference_ms": 17.437080364614992, "mean_action_processing_ms": 0.9116772864866023, "mean_env_wait_ms": 2.2499523483141157, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0714011760573313, "StateBufferConnector_ms": 0.00887855964621114, "ViewRequirementAgentConnector_ms": 0.1294699357581262}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.100000000000001, "episode_reward_mean": -3.655958549222799, "episode_len_mean": 20.60103626943005, "episodes_this_iter": 193, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.0000000000000004, -3.300000000000001, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -11.7, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.100000000000001, -3.400000000000001, -3.3000000000000003, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.100000000000001, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.200000000000001, -3.2000000000000006, -3.400000000000001, -3.2, -3.1000000000000005, -3.5000000000000004, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.2, -3.2000000000000006, -3.3000000000000007, -10.9, -3.4000000000000004, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -11.1, -3.2000000000000006, -3.100000000000001, -11.9, -11.5, -3.2000000000000006, -3.2000000000000006, -3.200000000000001, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.4000000000000004, -3.3000000000000007, -3.4000000000000004, -3.4000000000000004, -3.2000000000000006, -3.400000000000001, -3.2, -3.1000000000000005, -3.1000000000000005, -3.4000000000000004, -3.100000000000001, -10.7, -3.400000000000001, -3.0000000000000004, -3.400000000000001, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -11.1, -3.200000000000001, -10.9, -3.2000000000000006, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.500000000000001, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.2, -3.5000000000000004, -3.5000000000000004, -3.400000000000001, -3.1000000000000005, -3.3000000000000003, -3.3000000000000003, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.100000000000001, -3.0000000000000004, -3.3000000000000007, -3.5000000000000004, -3.400000000000001, -3.3000000000000003, -3.5000000000000004, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.2, -3.1000000000000005, -3.2, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.200000000000001, -3.3000000000000003, -3.3000000000000003, -3.3000000000000003, -3.3000000000000003, -3.1000000000000005, -3.300000000000001, -3.2, -3.3000000000000007, -11.4, -3.200000000000001, -3.3000000000000007, -3.3000000000000003, -3.500000000000001, -3.1000000000000005, -3.2000000000000006, -12.100000000000001, -3.0000000000000004, -3.5000000000000004, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.600000000000001, -3.700000000000001, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.2, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.2, -3.400000000000001, -3.1000000000000005, -3.500000000000001, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 12, 21, 21, 20, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 11, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.506840677038266, "mean_inference_ms": 17.437080364614992, "mean_action_processing_ms": 0.9116772864866023, "mean_env_wait_ms": 2.2499523483141157, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0714011760573313, "StateBufferConnector_ms": 0.00887855964621114, "ViewRequirementAgentConnector_ms": 0.1294699357581262}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000, "num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 496000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 496000, "timers": {"training_iteration_time_ms": 170913.976, "load_time_ms": 1.189, "load_throughput": 3364122.636, "learn_time_ms": 169962.195, "learn_throughput": 23.535, "synch_weights_time_ms": 183.07}, "counters": {"num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "done": false, "episodes_total": 24996, "training_iteration": 124, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_02-49-14", "timestamp": 1680828554, "time_this_iter_s": 170.8919038772583, "time_total_s": 21202.474944591522, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01473e2f40>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff947c51f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 21202.474944591522, "timesteps_since_restore": 0, "iterations_since_restore": 124, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.34320987654321, "ram_util_percent": 23.802469135802475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4501609405923275, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.24140258246371823, "policy_loss": -0.02931478967419475, "vf_loss": 0.2573469288156478, "vf_explained_var": 0.5931098079168668, "kl": 0.006955917061667048, "entropy": 3.381444295760124, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 115785.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_agent_steps_sampled": 500000, "num_agent_steps_trained": 500000}, "sampler_results": {"episode_reward_max": 98.5, "episode_reward_min": -11.9, "episode_reward_mean": -3.2251256281407046, "episode_len_mean": 20.301507537688444, "episode_media": {}, "episodes_this_iter": 199, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.400000000000001, -3.4000000000000004, -10.2, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.2, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.100000000000001, -3.0000000000000004, -3.600000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.2, -3.2000000000000006, -3.600000000000001, -3.2, -3.3000000000000007, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -11.700000000000001, -3.3000000000000007, -10.8, -3.0000000000000004, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.2, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.400000000000001, -3.4000000000000004, -3.3000000000000007, -3.2000000000000006, -10.3, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.6000000000000005, -3.1000000000000005, -3.1000000000000005, -3.700000000000001, -3.2000000000000006, -3.2, -3.3000000000000003, -3.2000000000000006, -3.2, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -11.9, -3.4000000000000004, -11.2, -11.4, -11.6, -3.3000000000000007, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -10.4, -3.0000000000000004, -3.2000000000000006, -3.0000000000000004, -3.300000000000001, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.400000000000001, -10.4, -3.3000000000000003, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, 98.5, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.2, -3.3000000000000003, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.4000000000000004, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.300000000000001, -3.2, -3.2, -3.1000000000000005, -3.3000000000000007, -11.700000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2, -3.400000000000001, -3.0000000000000004, -10.7, -3.4000000000000004, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.6000000000000005, -3.1000000000000005, -3.5000000000000004, -3.3000000000000003, -3.4000000000000004, -3.0000000000000004, -3.3000000000000003, -11.3, -3.2, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.2, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.100000000000001, -3.3000000000000007, -3.3000000000000003, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 12, 15, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.505089765350968, "mean_inference_ms": 17.443117088327725, "mean_action_processing_ms": 0.911537128955803, "mean_env_wait_ms": 2.2512010281654007, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08350868320944321, "StateBufferConnector_ms": 0.01059465072861868, "ViewRequirementAgentConnector_ms": 0.15248114140189473}}, "episode_reward_max": 98.5, "episode_reward_min": -11.9, "episode_reward_mean": -3.2251256281407046, "episode_len_mean": 20.301507537688444, "episodes_this_iter": 199, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.400000000000001, -3.4000000000000004, -10.2, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.2, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.100000000000001, -3.0000000000000004, -3.600000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.2, -3.2000000000000006, -3.600000000000001, -3.2, -3.3000000000000007, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -11.700000000000001, -3.3000000000000007, -10.8, -3.0000000000000004, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.2, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.400000000000001, -3.4000000000000004, -3.3000000000000007, -3.2000000000000006, -10.3, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.6000000000000005, -3.1000000000000005, -3.1000000000000005, -3.700000000000001, -3.2000000000000006, -3.2, -3.3000000000000003, -3.2000000000000006, -3.2, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -11.9, -3.4000000000000004, -11.2, -11.4, -11.6, -3.3000000000000007, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -10.4, -3.0000000000000004, -3.2000000000000006, -3.0000000000000004, -3.300000000000001, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.400000000000001, -10.4, -3.3000000000000003, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, 98.5, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.2, -3.3000000000000003, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.4000000000000004, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.300000000000001, -3.2, -3.2, -3.1000000000000005, -3.3000000000000007, -11.700000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2, -3.400000000000001, -3.0000000000000004, -10.7, -3.4000000000000004, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.6000000000000005, -3.1000000000000005, -3.5000000000000004, -3.3000000000000003, -3.4000000000000004, -3.0000000000000004, -3.3000000000000003, -11.3, -3.2, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.2, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.100000000000001, -3.3000000000000007, -3.3000000000000003, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 12, 15, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.505089765350968, "mean_inference_ms": 17.443117088327725, "mean_action_processing_ms": 0.911537128955803, "mean_env_wait_ms": 2.2512010281654007, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08350868320944321, "StateBufferConnector_ms": 0.01059465072861868, "ViewRequirementAgentConnector_ms": 0.15248114140189473}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 500000, "num_agent_steps_trained": 500000, "num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 500000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 500000, "timers": {"training_iteration_time_ms": 170869.245, "load_time_ms": 1.183, "load_throughput": 3382639.623, "learn_time_ms": 169914.186, "learn_throughput": 23.541, "synch_weights_time_ms": 183.092}, "counters": {"num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_agent_steps_sampled": 500000, "num_agent_steps_trained": 500000}, "done": false, "episodes_total": 25195, "training_iteration": 125, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_02-52-05", "timestamp": 1680828725, "time_this_iter_s": 170.69674158096313, "time_total_s": 21373.171686172485, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01475e2d90>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff947c59d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 21373.171686172485, "timesteps_since_restore": 0, "iterations_since_restore": 125, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.314462809917355, "ram_util_percent": 23.800826446281}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6810180065772866, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.16373911420263912, "policy_loss": -0.07754487109831183, "vf_loss": 0.21126225981560925, "vf_explained_var": 0.7734851914067422, "kl": 0.015618679329868086, "entropy": 3.38524808063302, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 116715.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.0, "episode_reward_mean": -3.5538860103626946, "episode_len_mean": 20.575129533678755, "episode_media": {}, "episodes_this_iter": 193, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.5000000000000004, -3.3000000000000003, -11.0, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.4000000000000004, -3.2, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.4000000000000004, -3.1000000000000005, -3.200000000000001, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.6000000000000005, -3.3000000000000007, -3.400000000000001, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.100000000000001, -3.5000000000000013, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.200000000000001, -3.5000000000000004, -3.100000000000001, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.5000000000000004, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.2, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -10.5, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.100000000000001, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -11.2, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -10.9, -3.2000000000000006, -3.2000000000000006, -10.9, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.100000000000001, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -3.2, -3.100000000000001, -3.0000000000000004, -3.2, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.6000000000000005, -3.3000000000000007, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.8000000000000007, -3.400000000000001, -10.8, -3.4000000000000004, -3.500000000000001, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -12.0, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.4000000000000012, -3.3000000000000007, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.6, -3.100000000000001, -3.3000000000000007, -3.4000000000000004, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.2, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.3000000000000003, -3.2, -10.9, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.200000000000001], "episode_lengths": [21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.507025679607278, "mean_inference_ms": 17.446009645723645, "mean_action_processing_ms": 0.9121707101634247, "mean_env_wait_ms": 2.2518571241114227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0758121668365953, "StateBufferConnector_ms": 0.0098057979129139, "ViewRequirementAgentConnector_ms": 0.13760705068321424}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.0, "episode_reward_mean": -3.5538860103626946, "episode_len_mean": 20.575129533678755, "episodes_this_iter": 193, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.5000000000000004, -3.3000000000000003, -11.0, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.4000000000000004, -3.2, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.4000000000000004, -3.1000000000000005, -3.200000000000001, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.6000000000000005, -3.3000000000000007, -3.400000000000001, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.100000000000001, -3.5000000000000013, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.200000000000001, -3.5000000000000004, -3.100000000000001, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.5000000000000004, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.2, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -10.5, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.100000000000001, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -11.2, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -10.9, -3.2000000000000006, -3.2000000000000006, -10.9, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.100000000000001, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -3.2, -3.100000000000001, -3.0000000000000004, -3.2, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.6000000000000005, -3.3000000000000007, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.8000000000000007, -3.400000000000001, -10.8, -3.4000000000000004, -3.500000000000001, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -12.0, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.4000000000000012, -3.3000000000000007, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.6, -3.100000000000001, -3.3000000000000007, -3.4000000000000004, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.2, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.3000000000000003, -3.2, -10.9, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.200000000000001], "episode_lengths": [21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.507025679607278, "mean_inference_ms": 17.446009645723645, "mean_action_processing_ms": 0.9121707101634247, "mean_env_wait_ms": 2.2518571241114227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0758121668365953, "StateBufferConnector_ms": 0.0098057979129139, "ViewRequirementAgentConnector_ms": 0.13760705068321424}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 504000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 504000, "timers": {"training_iteration_time_ms": 170789.379, "load_time_ms": 1.188, "load_throughput": 3367498.846, "learn_time_ms": 169837.989, "learn_throughput": 23.552, "synch_weights_time_ms": 181.84}, "counters": {"num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "done": false, "episodes_total": 25388, "training_iteration": 126, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_02-54-55", "timestamp": 1680828895, "time_this_iter_s": 170.60885620117188, "time_total_s": 21543.780542373657, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7effc01303d0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014728cca0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 21543.780542373657, "timesteps_since_restore": 0, "iterations_since_restore": 126, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.2818930041152266, "ram_util_percent": 23.804526748971202}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.653159707792664, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.16439969476152172, "policy_loss": -0.03179320925208289, "vf_loss": 0.18307207818693852, "vf_explained_var": 0.715514035699188, "kl": 0.006826056285400785, "entropy": 3.382038438191978, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 117645.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_agent_steps_sampled": 508000, "num_agent_steps_trained": 508000}, "sampler_results": {"episode_reward_max": 98.5, "episode_reward_min": -11.8, "episode_reward_mean": -3.0030612244897967, "episode_len_mean": 20.54591836734694, "episode_media": {}, "episodes_this_iter": 196, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.2000000000000006, -11.1, -3.0000000000000004, -3.2000000000000006, -3.400000000000001, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.300000000000001, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.6000000000000005, -3.2000000000000006, -3.2, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.5000000000000004, -3.3000000000000007, -3.2, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.5000000000000004, -3.100000000000001, -3.3000000000000003, -3.2000000000000006, -3.100000000000001, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.400000000000001, 98.5, -3.1000000000000005, -3.0000000000000004, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.2, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.3000000000000003, -3.3000000000000003, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.100000000000001, -3.2000000000000006, -10.2, -11.3, -3.200000000000001, -3.500000000000001, -3.2000000000000006, -3.4000000000000004, -11.700000000000001, -3.3000000000000007, -10.7, -3.5000000000000004, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.200000000000001, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.4000000000000004, -3.5000000000000004, -3.2000000000000006, -3.400000000000001, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.100000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.4000000000000004, -3.1000000000000005, -3.2, -3.2000000000000006, -3.2, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -11.1, -3.200000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.500000000000001, -3.0000000000000004, -3.4000000000000004, -3.500000000000001, -3.2000000000000006, -3.400000000000001, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.2, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.200000000000001, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -11.8, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -10.2, -3.0000000000000004, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.2, -3.500000000000001, -3.4000000000000004, -3.0000000000000004], "episode_lengths": [21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 14, 21, 21, 21, 21, 17, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.511950873205734, "mean_inference_ms": 17.444870480456373, "mean_action_processing_ms": 0.9118594179374877, "mean_env_wait_ms": 2.2563215445585203, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07340360660942233, "StateBufferConnector_ms": 0.00922473109498316, "ViewRequirementAgentConnector_ms": 0.13391339049047354}}, "episode_reward_max": 98.5, "episode_reward_min": -11.8, "episode_reward_mean": -3.0030612244897967, "episode_len_mean": 20.54591836734694, "episodes_this_iter": 196, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.2000000000000006, -11.1, -3.0000000000000004, -3.2000000000000006, -3.400000000000001, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.300000000000001, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.6000000000000005, -3.2000000000000006, -3.2, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.5000000000000004, -3.3000000000000007, -3.2, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.5000000000000004, -3.100000000000001, -3.3000000000000003, -3.2000000000000006, -3.100000000000001, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.400000000000001, 98.5, -3.1000000000000005, -3.0000000000000004, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.2, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.3000000000000003, -3.3000000000000003, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.100000000000001, -3.2000000000000006, -10.2, -11.3, -3.200000000000001, -3.500000000000001, -3.2000000000000006, -3.4000000000000004, -11.700000000000001, -3.3000000000000007, -10.7, -3.5000000000000004, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.200000000000001, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.4000000000000004, -3.5000000000000004, -3.2000000000000006, -3.400000000000001, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.100000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.4000000000000004, -3.1000000000000005, -3.2, -3.2000000000000006, -3.2, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -11.1, -3.200000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.500000000000001, -3.0000000000000004, -3.4000000000000004, -3.500000000000001, -3.2000000000000006, -3.400000000000001, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.2, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.200000000000001, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -11.8, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -10.2, -3.0000000000000004, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.2, -3.500000000000001, -3.4000000000000004, -3.0000000000000004], "episode_lengths": [21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 14, 21, 21, 21, 21, 17, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.511950873205734, "mean_inference_ms": 17.444870480456373, "mean_action_processing_ms": 0.9118594179374877, "mean_env_wait_ms": 2.2563215445585203, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07340360660942233, "StateBufferConnector_ms": 0.00922473109498316, "ViewRequirementAgentConnector_ms": 0.13391339049047354}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 508000, "num_agent_steps_trained": 508000, "num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 508000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 508000, "timers": {"training_iteration_time_ms": 170850.835, "load_time_ms": 1.19, "load_throughput": 3361359.192, "learn_time_ms": 169899.723, "learn_throughput": 23.543, "synch_weights_time_ms": 180.767}, "counters": {"num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_agent_steps_sampled": 508000, "num_agent_steps_trained": 508000}, "done": false, "episodes_total": 25584, "training_iteration": 127, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_02-57-46", "timestamp": 1680829066, "time_this_iter_s": 171.15533113479614, "time_total_s": 21714.935873508453, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476f2a00>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff947c1280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 21714.935873508453, "timesteps_since_restore": 0, "iterations_since_restore": 127, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.607818930041152, "ram_util_percent": 23.815637860082315}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4192388526053838, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.19700752542008676, "policy_loss": -0.030524942507749543, "vf_loss": 0.21249438369576568, "vf_explained_var": 0.794999074807731, "kl": 0.007823501537949527, "entropy": 3.38302529499095, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 118575.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "sampler_results": {"episode_reward_max": 97.9, "episode_reward_min": -12.200000000000001, "episode_reward_mean": -3.1333333333333337, "episode_len_mean": 20.28205128205128, "episode_media": {}, "episodes_this_iter": 195, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.4000000000000004, -3.400000000000001, -3.0000000000000004, -3.3000000000000007, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.2, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.2, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.0000000000000004, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.3000000000000003, -3.0000000000000004, -3.4, -3.2, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.4000000000000004, -12.200000000000001, -3.0000000000000004, -3.2000000000000006, -3.5000000000000004, -3.400000000000001, -3.3000000000000003, -10.2, -3.3000000000000003, -11.6, -10.3, -11.8, -3.3000000000000007, -10.2, -3.2000000000000006, -3.500000000000001, -3.3000000000000007, -3.200000000000001, -3.2000000000000006, -3.3000000000000003, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -11.1, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.100000000000001, -3.100000000000001, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -10.6, -3.5000000000000004, -3.3000000000000007, -3.3000000000000007, -3.4000000000000004, -3.3000000000000003, -3.3000000000000003, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.600000000000001, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.200000000000001, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.200000000000001, -3.3000000000000007, -3.2, -3.2000000000000006, -3.3000000000000007, -3.5000000000000004, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, -3.0000000000000004, 97.9, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2, -3.5000000000000004, -3.0000000000000004, -3.3000000000000007, -10.0, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.500000000000001, -3.100000000000001, -3.1000000000000005, -3.400000000000001, -3.400000000000001, -10.1, -3.3000000000000007, -3.100000000000001, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.2, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.500000000000001, -3.2000000000000006, -3.3000000000000007, -3.2, -3.100000000000001, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.4000000000000004, -10.9, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 3, 21, 15, 4, 17, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.510109591939283, "mean_inference_ms": 17.46682110183568, "mean_action_processing_ms": 0.9117646894750093, "mean_env_wait_ms": 2.2533470185088817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07286842052753155, "StateBufferConnector_ms": 0.009173735594138121, "ViewRequirementAgentConnector_ms": 0.1351127869043595}}, "episode_reward_max": 97.9, "episode_reward_min": -12.200000000000001, "episode_reward_mean": -3.1333333333333337, "episode_len_mean": 20.28205128205128, "episodes_this_iter": 195, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.4000000000000004, -3.400000000000001, -3.0000000000000004, -3.3000000000000007, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.2, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.2, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.0000000000000004, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.3000000000000003, -3.0000000000000004, -3.4, -3.2, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.4000000000000004, -12.200000000000001, -3.0000000000000004, -3.2000000000000006, -3.5000000000000004, -3.400000000000001, -3.3000000000000003, -10.2, -3.3000000000000003, -11.6, -10.3, -11.8, -3.3000000000000007, -10.2, -3.2000000000000006, -3.500000000000001, -3.3000000000000007, -3.200000000000001, -3.2000000000000006, -3.3000000000000003, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -11.1, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.100000000000001, -3.100000000000001, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -10.6, -3.5000000000000004, -3.3000000000000007, -3.3000000000000007, -3.4000000000000004, -3.3000000000000003, -3.3000000000000003, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.600000000000001, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.200000000000001, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.200000000000001, -3.3000000000000007, -3.2, -3.2000000000000006, -3.3000000000000007, -3.5000000000000004, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, -3.0000000000000004, 97.9, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2, -3.5000000000000004, -3.0000000000000004, -3.3000000000000007, -10.0, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.500000000000001, -3.100000000000001, -3.1000000000000005, -3.400000000000001, -3.400000000000001, -10.1, -3.3000000000000007, -3.100000000000001, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.2, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.500000000000001, -3.2000000000000006, -3.3000000000000007, -3.2, -3.100000000000001, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.4000000000000004, -10.9, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 3, 21, 15, 4, 17, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.510109591939283, "mean_inference_ms": 17.46682110183568, "mean_action_processing_ms": 0.9117646894750093, "mean_env_wait_ms": 2.2533470185088817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07286842052753155, "StateBufferConnector_ms": 0.009173735594138121, "ViewRequirementAgentConnector_ms": 0.1351127869043595}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000, "num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 512000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 512000, "timers": {"training_iteration_time_ms": 170886.897, "load_time_ms": 1.172, "load_throughput": 3411806.239, "learn_time_ms": 169928.074, "learn_throughput": 23.539, "synch_weights_time_ms": 179.998}, "counters": {"num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "done": false, "episodes_total": 25779, "training_iteration": 128, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_03-00-37", "timestamp": 1680829237, "time_this_iter_s": 170.84857296943665, "time_total_s": 21885.78444647789, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01472afb50>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7effc0095670>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 21885.78444647789, "timesteps_since_restore": 0, "iterations_since_restore": 128, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.815226337448559, "ram_util_percent": 23.80617283950618}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2752050472763918, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.2722625893710922, "policy_loss": -0.02710620244584417, "vf_loss": 0.2762899519154622, "vf_explained_var": 0.6961275614077045, "kl": 0.012006672748467154, "entropy": 3.3737446877264206, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 119505.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000}, "sampler_results": {"episode_reward_max": 97.9, "episode_reward_min": -11.8, "episode_reward_mean": -3.195477386934674, "episode_len_mean": 20.2964824120603, "episode_media": {}, "episodes_this_iter": 199, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.4000000000000004, -3.6000000000000005, -3.500000000000001, -3.2000000000000006, -3.3000000000000003, -3.3000000000000003, -3.3000000000000003, -3.100000000000001, -3.0000000000000004, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -11.7, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.300000000000001, -3.2000000000000006, -3.1000000000000005, -3.2, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.2, -3.2000000000000006, -3.3000000000000007, -3.2, -11.6, -3.0000000000000004, -3.5000000000000004, -3.200000000000001, -3.3000000000000007, -3.500000000000001, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -10.5, -10.3, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -11.2, -3.1000000000000005, -3.2000000000000006, -10.4, -3.1000000000000005, -3.2000000000000006, -11.6, -3.2000000000000006, -3.3000000000000007, -10.5, -3.2000000000000006, -3.5000000000000004, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -11.8, -3.5000000000000004, -3.600000000000001, -3.400000000000001, -3.0000000000000004, -3.2000000000000006, -3.0000000000000004, -3.4000000000000004, -10.4, -11.1, -3.0000000000000004, -3.500000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.500000000000001, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.6000000000000005, -3.1000000000000005, -3.3000000000000007, -3.6000000000000005, -3.4000000000000004, -3.3000000000000007, -3.1000000000000005, -3.200000000000001, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.100000000000001, -3.5000000000000004, -3.4000000000000004, -3.1000000000000005, -3.3000000000000007, -3.2, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -10.1, -3.2000000000000006, 97.9, -3.5000000000000004, -3.2000000000000006, -3.100000000000001, -3.5000000000000004, -3.400000000000001, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.2, -3.2000000000000006, -3.2, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.300000000000001, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.2, -3.0000000000000004, -3.1000000000000005, -3.100000000000001, -3.500000000000001, -3.4000000000000004, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.400000000000001, -3.5000000000000004, -3.3000000000000007, -3.0000000000000004, -3.3000000000000007, -3.3000000000000003, -3.1000000000000005, -3.2, -3.2, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2, -3.2000000000000006, -3.3000000000000003, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.700000000000001, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.5000000000000004], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 4, 21, 21, 21, 21, 21, 13, 21, 21, 5, 21, 21, 15, 21, 21, 6, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 5, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.503790026545735, "mean_inference_ms": 17.463561631510892, "mean_action_processing_ms": 0.912835579660944, "mean_env_wait_ms": 2.2605285408089673, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07844546332431199, "StateBufferConnector_ms": 0.009175640853805159, "ViewRequirementAgentConnector_ms": 0.14465729794909607}}, "episode_reward_max": 97.9, "episode_reward_min": -11.8, "episode_reward_mean": -3.195477386934674, "episode_len_mean": 20.2964824120603, "episodes_this_iter": 199, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.4000000000000004, -3.6000000000000005, -3.500000000000001, -3.2000000000000006, -3.3000000000000003, -3.3000000000000003, -3.3000000000000003, -3.100000000000001, -3.0000000000000004, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -11.7, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.300000000000001, -3.2000000000000006, -3.1000000000000005, -3.2, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.2, -3.2000000000000006, -3.3000000000000007, -3.2, -11.6, -3.0000000000000004, -3.5000000000000004, -3.200000000000001, -3.3000000000000007, -3.500000000000001, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -10.5, -10.3, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -11.2, -3.1000000000000005, -3.2000000000000006, -10.4, -3.1000000000000005, -3.2000000000000006, -11.6, -3.2000000000000006, -3.3000000000000007, -10.5, -3.2000000000000006, -3.5000000000000004, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -11.8, -3.5000000000000004, -3.600000000000001, -3.400000000000001, -3.0000000000000004, -3.2000000000000006, -3.0000000000000004, -3.4000000000000004, -10.4, -11.1, -3.0000000000000004, -3.500000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.500000000000001, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.6000000000000005, -3.1000000000000005, -3.3000000000000007, -3.6000000000000005, -3.4000000000000004, -3.3000000000000007, -3.1000000000000005, -3.200000000000001, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.100000000000001, -3.5000000000000004, -3.4000000000000004, -3.1000000000000005, -3.3000000000000007, -3.2, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -10.1, -3.2000000000000006, 97.9, -3.5000000000000004, -3.2000000000000006, -3.100000000000001, -3.5000000000000004, -3.400000000000001, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.2, -3.2000000000000006, -3.2, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.300000000000001, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.2, -3.0000000000000004, -3.1000000000000005, -3.100000000000001, -3.500000000000001, -3.4000000000000004, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.400000000000001, -3.5000000000000004, -3.3000000000000007, -3.0000000000000004, -3.3000000000000007, -3.3000000000000003, -3.1000000000000005, -3.2, -3.2, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2, -3.2000000000000006, -3.3000000000000003, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.700000000000001, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.5000000000000004], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 4, 21, 21, 21, 21, 21, 13, 21, 21, 5, 21, 21, 15, 21, 21, 6, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 5, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.503790026545735, "mean_inference_ms": 17.463561631510892, "mean_action_processing_ms": 0.912835579660944, "mean_env_wait_ms": 2.2605285408089673, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07844546332431199, "StateBufferConnector_ms": 0.009175640853805159, "ViewRequirementAgentConnector_ms": 0.14465729794909607}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 516000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 516000, "timers": {"training_iteration_time_ms": 170899.106, "load_time_ms": 1.178, "load_throughput": 3396747.651, "learn_time_ms": 169920.915, "learn_throughput": 23.54, "synch_weights_time_ms": 179.274}, "counters": {"num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000}, "done": false, "episodes_total": 25978, "training_iteration": 129, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_03-03-28", "timestamp": 1680829408, "time_this_iter_s": 170.79245948791504, "time_total_s": 22056.576905965805, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476d7f10>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff947c1280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 22056.576905965805, "timesteps_since_restore": 0, "iterations_since_restore": 129, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.891358024691358, "ram_util_percent": 23.825514403292186}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3962754889040865, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.22933613890681856, "policy_loss": -0.08420358891648952, "vf_loss": 0.2825282494497475, "vf_explained_var": 0.6848991899721084, "kl": 0.016133594870071617, "entropy": 3.3750376509081934, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 120435.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.0, "episode_reward_mean": -3.753846153846155, "episode_len_mean": 20.394871794871793, "episode_media": {}, "episodes_this_iter": 195, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.1000000000000005, -3.0000000000000004, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.5000000000000004, -3.2, -3.0000000000000004, -3.1000000000000005, -3.300000000000001, -3.1000000000000005, -3.300000000000001, -11.7, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.300000000000001, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.500000000000001, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.3000000000000003, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.2, -3.0000000000000004, -3.3000000000000007, -3.600000000000001, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.2, -3.3000000000000003, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -10.9, -11.2, -11.7, -3.400000000000001, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.0000000000000004, -11.1, -3.400000000000001, -3.4000000000000004, -3.3000000000000007, -3.3000000000000003, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.4000000000000004, -3.400000000000001, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.100000000000001, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -12.0, -3.3000000000000003, -10.9, -3.200000000000001, -3.2, -3.3000000000000007, -3.0000000000000004, -3.0000000000000004, -3.3000000000000003, -3.2, -3.1000000000000005, -3.5000000000000004, -3.3000000000000007, -3.4000000000000004, -3.3000000000000003, -3.400000000000001, -3.400000000000001, -3.400000000000001, -11.3, -3.0000000000000004, -3.2, -3.2000000000000006, -10.4, -3.2000000000000006, -3.600000000000001, -3.6000000000000005, -3.3000000000000003, -3.2000000000000006, -10.6, -3.0000000000000004, -3.2000000000000006, -3.3000000000000003, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.100000000000001, -3.5000000000000004, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.500000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.100000000000001, -3.2, -11.4, -3.400000000000001, -3.2, -3.2000000000000006, -3.100000000000001, -3.100000000000001, -3.5000000000000004, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.0000000000000004, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.2, -3.100000000000001, -3.1000000000000005, -3.4000000000000004, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -11.6, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -10.3, -3.6000000000000005, -3.3000000000000003, -3.0000000000000004, -3.200000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 13, 15, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 5, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 4, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.501768658407226, "mean_inference_ms": 17.444529537757912, "mean_action_processing_ms": 0.9119992992345578, "mean_env_wait_ms": 2.256685696156436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07062251751239483, "StateBufferConnector_ms": 0.008417398501665164, "ViewRequirementAgentConnector_ms": 0.13041019439697266}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.0, "episode_reward_mean": -3.753846153846155, "episode_len_mean": 20.394871794871793, "episodes_this_iter": 195, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.1000000000000005, -3.0000000000000004, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.5000000000000004, -3.2, -3.0000000000000004, -3.1000000000000005, -3.300000000000001, -3.1000000000000005, -3.300000000000001, -11.7, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.300000000000001, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.500000000000001, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.3000000000000003, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.2, -3.0000000000000004, -3.3000000000000007, -3.600000000000001, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.2, -3.3000000000000003, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -10.9, -11.2, -11.7, -3.400000000000001, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.0000000000000004, -11.1, -3.400000000000001, -3.4000000000000004, -3.3000000000000007, -3.3000000000000003, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.4000000000000004, -3.400000000000001, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.100000000000001, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -12.0, -3.3000000000000003, -10.9, -3.200000000000001, -3.2, -3.3000000000000007, -3.0000000000000004, -3.0000000000000004, -3.3000000000000003, -3.2, -3.1000000000000005, -3.5000000000000004, -3.3000000000000007, -3.4000000000000004, -3.3000000000000003, -3.400000000000001, -3.400000000000001, -3.400000000000001, -11.3, -3.0000000000000004, -3.2, -3.2000000000000006, -10.4, -3.2000000000000006, -3.600000000000001, -3.6000000000000005, -3.3000000000000003, -3.2000000000000006, -10.6, -3.0000000000000004, -3.2000000000000006, -3.3000000000000003, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.100000000000001, -3.5000000000000004, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.500000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.100000000000001, -3.2, -11.4, -3.400000000000001, -3.2, -3.2000000000000006, -3.100000000000001, -3.100000000000001, -3.5000000000000004, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.0000000000000004, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.2, -3.100000000000001, -3.1000000000000005, -3.4000000000000004, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -11.6, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -10.3, -3.6000000000000005, -3.3000000000000003, -3.0000000000000004, -3.200000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 13, 15, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 5, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 4, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.501768658407226, "mean_inference_ms": 17.444529537757912, "mean_action_processing_ms": 0.9119992992345578, "mean_env_wait_ms": 2.256685696156436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07062251751239483, "StateBufferConnector_ms": 0.008417398501665164, "ViewRequirementAgentConnector_ms": 0.13041019439697266}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000, "num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 520000, "timers": {"training_iteration_time_ms": 170846.348, "load_time_ms": 1.163, "load_throughput": 3438799.705, "learn_time_ms": 169869.015, "learn_throughput": 23.548, "synch_weights_time_ms": 180.805}, "counters": {"num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000}, "done": false, "episodes_total": 26173, "training_iteration": 130, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_03-06-19", "timestamp": 1680829579, "time_this_iter_s": 170.8000500202179, "time_total_s": 22227.376955986023, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0147423880>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7effc0095670>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 22227.376955986023, "timesteps_since_restore": 0, "iterations_since_restore": 130, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.543801652892562, "ram_util_percent": 23.802892561983477}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6971985054592933, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.0584259543888351, "policy_loss": -0.07458586814257527, "vf_loss": 0.10703599951430275, "vf_explained_var": 0.8404942793230856, "kl": 0.01351381365885152, "entropy": 3.3730394909458776, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 121365.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_agent_steps_sampled": 524000, "num_agent_steps_trained": 524000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.0, "episode_reward_mean": -3.393010752688173, "episode_len_mean": 20.833333333333332, "episode_media": {}, "episodes_this_iter": 186, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3000000000000007, -3.300000000000001, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.100000000000001, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.2, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -12.0, -3.2000000000000006, -3.300000000000001, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.100000000000001, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.100000000000001, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.300000000000001, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.100000000000001, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2, -3.1000000000000005, -3.2, -3.2000000000000006, -3.300000000000001, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -10.7, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2, -3.200000000000001, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.600000000000001, -3.500000000000001, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -11.700000000000001, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.100000000000001, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.600000000000001, -3.3000000000000003, -3.2, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.0000000000000004, -3.2, -3.1000000000000005, -3.0000000000000004, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.2, -3.300000000000001, -3.2000000000000006, -3.1000000000000005, -3.5000000000000004, -3.3000000000000003, -3.2, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.500000000000001, -3.2, -3.3000000000000007, -3.5000000000000004, -3.6000000000000005, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.5000000000000004, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.3000000000000003, -10.7, -3.2000000000000006, -3.300000000000001, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.5000000000000004, -3.2000000000000006], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.499205649198139, "mean_inference_ms": 17.44482628581315, "mean_action_processing_ms": 0.9115555660311669, "mean_env_wait_ms": 2.256343220081642, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07447440137145339, "StateBufferConnector_ms": 0.008779956448462701, "ViewRequirementAgentConnector_ms": 0.1365030965497417}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.0, "episode_reward_mean": -3.393010752688173, "episode_len_mean": 20.833333333333332, "episodes_this_iter": 186, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.3000000000000007, -3.300000000000001, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.100000000000001, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.2, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -12.0, -3.2000000000000006, -3.300000000000001, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.100000000000001, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.100000000000001, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.300000000000001, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.100000000000001, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2, -3.1000000000000005, -3.2, -3.2000000000000006, -3.300000000000001, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -10.7, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2, -3.200000000000001, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.600000000000001, -3.500000000000001, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -11.700000000000001, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.100000000000001, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.600000000000001, -3.3000000000000003, -3.2, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.0000000000000004, -3.2, -3.1000000000000005, -3.0000000000000004, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.2, -3.300000000000001, -3.2000000000000006, -3.1000000000000005, -3.5000000000000004, -3.3000000000000003, -3.2, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.500000000000001, -3.2, -3.3000000000000007, -3.5000000000000004, -3.6000000000000005, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.5000000000000004, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.3000000000000003, -10.7, -3.2000000000000006, -3.300000000000001, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.5000000000000004, -3.2000000000000006], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.499205649198139, "mean_inference_ms": 17.44482628581315, "mean_action_processing_ms": 0.9115555660311669, "mean_env_wait_ms": 2.256343220081642, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07447440137145339, "StateBufferConnector_ms": 0.008779956448462701, "ViewRequirementAgentConnector_ms": 0.1365030965497417}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 524000, "num_agent_steps_trained": 524000, "num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 524000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 524000, "timers": {"training_iteration_time_ms": 170883.38, "load_time_ms": 1.16, "load_throughput": 3446853.762, "learn_time_ms": 169914.48, "learn_throughput": 23.541, "synch_weights_time_ms": 178.404}, "counters": {"num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_agent_steps_sampled": 524000, "num_agent_steps_trained": 524000}, "done": false, "episodes_total": 26359, "training_iteration": 131, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_03-09-10", "timestamp": 1680829750, "time_this_iter_s": 171.08762121200562, "time_total_s": 22398.46457719803, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0147659460>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014728cca0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 22398.46457719803, "timesteps_since_restore": 0, "iterations_since_restore": 131, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.309836065573771, "ram_util_percent": 23.801639344262306}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4063803641065475, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.22524849936285968, "policy_loss": -0.08526304330957192, "vf_loss": 0.28248122487046945, "vf_explained_var": 0.6826088527838389, "kl": 0.014582659142036792, "entropy": 3.345746639723419, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 122295.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.2, "episode_reward_mean": -3.6525, "episode_len_mean": 20.545, "episode_media": {}, "episodes_this_iter": 200, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3000000000000003, -3.3000000000000007, -3.100000000000001, -3.2000000000000006, -3.5000000000000004, -3.3000000000000003, -3.200000000000001, -3.1000000000000005, -11.6, -3.2000000000000006, -3.2000000000000006, -3.100000000000001, -3.2000000000000006, -3.1000000000000005, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -11.3, -3.100000000000001, -12.2, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.500000000000001, -3.1000000000000005, -3.6000000000000005, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.0000000000000004, -3.400000000000001, -3.3000000000000007, -3.4000000000000004, -3.1000000000000005, -3.5000000000000004, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2, -3.3000000000000003, -12.0, -3.2000000000000006, -3.3000000000000003, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.8000000000000007, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -10.9, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -11.700000000000001, -3.2000000000000006, -3.3000000000000003, -3.2, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -3.6000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2, -3.1000000000000005, -3.2000000000000006, -3.300000000000001, -3.2, -3.1000000000000005, -3.2, -11.6, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.2, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.200000000000001, -3.1000000000000005, -3.4000000000000004, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.300000000000001, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -3.300000000000001, -10.3, -3.0000000000000004, -11.3, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.3000000000000003, -3.4000000000000004, -3.100000000000001, -3.1000000000000005, -3.1000000000000005, -3.100000000000001, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -10.4, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.4000000000000004, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.4000000000000004, -3.2, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.1000000000000005, -3.2, -10.9, -3.2, -3.400000000000001, -3.2000000000000006, -3.1000000000000005], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.502495063610574, "mean_inference_ms": 17.449628030292377, "mean_action_processing_ms": 0.9122607636659356, "mean_env_wait_ms": 2.2595055935645547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07281804084777832, "StateBufferConnector_ms": 0.009005427360534668, "ViewRequirementAgentConnector_ms": 0.13421952724456787}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.2, "episode_reward_mean": -3.6525, "episode_len_mean": 20.545, "episodes_this_iter": 200, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.3000000000000003, -3.3000000000000007, -3.100000000000001, -3.2000000000000006, -3.5000000000000004, -3.3000000000000003, -3.200000000000001, -3.1000000000000005, -11.6, -3.2000000000000006, -3.2000000000000006, -3.100000000000001, -3.2000000000000006, -3.1000000000000005, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -11.3, -3.100000000000001, -12.2, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.500000000000001, -3.1000000000000005, -3.6000000000000005, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.0000000000000004, -3.400000000000001, -3.3000000000000007, -3.4000000000000004, -3.1000000000000005, -3.5000000000000004, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2, -3.3000000000000003, -12.0, -3.2000000000000006, -3.3000000000000003, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.8000000000000007, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -10.9, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -11.700000000000001, -3.2000000000000006, -3.3000000000000003, -3.2, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -3.6000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2, -3.1000000000000005, -3.2000000000000006, -3.300000000000001, -3.2, -3.1000000000000005, -3.2, -11.6, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.2, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.200000000000001, -3.1000000000000005, -3.4000000000000004, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.300000000000001, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -3.300000000000001, -10.3, -3.0000000000000004, -11.3, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.3000000000000003, -3.4000000000000004, -3.100000000000001, -3.1000000000000005, -3.1000000000000005, -3.100000000000001, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -10.4, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.4000000000000004, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.4000000000000004, -3.2, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.1000000000000005, -3.2, -10.9, -3.2, -3.400000000000001, -3.2000000000000006, -3.1000000000000005], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.502495063610574, "mean_inference_ms": 17.449628030292377, "mean_action_processing_ms": 0.9122607636659356, "mean_env_wait_ms": 2.2595055935645547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07281804084777832, "StateBufferConnector_ms": 0.009005427360534668, "ViewRequirementAgentConnector_ms": 0.13421952724456787}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 528000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 170891.537, "load_time_ms": 1.16, "load_throughput": 3448554.162, "learn_time_ms": 169922.246, "learn_throughput": 23.54, "synch_weights_time_ms": 180.846}, "counters": {"num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "episodes_total": 26559, "training_iteration": 132, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_03-12-01", "timestamp": 1680829921, "time_this_iter_s": 170.83291459083557, "time_total_s": 22569.297491788864, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01473e2b50>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff947a2430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 22569.297491788864, "timesteps_since_restore": 0, "iterations_since_restore": 132, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.298765432098765, "ram_util_percent": 23.804115226337455}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4875647801224903, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.16274407485960632, "policy_loss": -0.0775014478933587, "vf_loss": 0.21458293795385347, "vf_explained_var": 0.7313277351599867, "kl": 0.013350853587435658, "entropy": 3.3272480113531953, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 123225.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_agent_steps_sampled": 532000, "num_agent_steps_trained": 532000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.100000000000001, "episode_reward_mean": -3.661734693877552, "episode_len_mean": 20.474489795918366, "episode_media": {}, "episodes_this_iter": 196, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.3000000000000003, -3.3000000000000007, -3.3000000000000007, -3.500000000000001, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -11.3, -3.200000000000001, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.0000000000000004, -3.0000000000000004, -3.4000000000000004, -3.0000000000000004, -3.2, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.4000000000000004, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -11.1, -3.6000000000000005, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -10.9, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.200000000000001, -3.3000000000000003, -3.1000000000000005, -3.500000000000001, -3.2, -3.2, -11.700000000000001, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.300000000000001, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -10.9, -11.1, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.200000000000001, -3.2000000000000006, -3.3000000000000003, -3.0000000000000004, -3.400000000000001, -12.100000000000001, -3.1000000000000005, -3.1000000000000005, -3.100000000000001, -10.5, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.200000000000001, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -11.5, -3.3000000000000003, -3.3000000000000007, -3.500000000000001, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.400000000000001, -3.3000000000000007, -3.5000000000000013, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -10.2, -3.200000000000001, -3.400000000000001, -3.6000000000000005, -3.1000000000000005, -3.3000000000000007, -3.4000000000000004, -3.1000000000000005, -3.500000000000001, -3.2000000000000006, -3.3000000000000003, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.3000000000000003, -3.100000000000001, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.200000000000001, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.3000000000000003, -3.2000000000000006, -3.3000000000000003, -3.100000000000001, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.2, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.2, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -10.9, -3.0000000000000004, -3.200000000000001, -3.400000000000001, -3.200000000000001, -3.2000000000000006, -3.200000000000001, -3.2000000000000006], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.505067814327994, "mean_inference_ms": 17.473125055215522, "mean_action_processing_ms": 0.9133091841555954, "mean_env_wait_ms": 2.2656310275619305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08497992340399295, "StateBufferConnector_ms": 0.01027109671612175, "ViewRequirementAgentConnector_ms": 0.15654588232235034}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.100000000000001, "episode_reward_mean": -3.661734693877552, "episode_len_mean": 20.474489795918366, "episodes_this_iter": 196, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.3000000000000003, -3.3000000000000007, -3.3000000000000007, -3.500000000000001, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -11.3, -3.200000000000001, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.0000000000000004, -3.0000000000000004, -3.4000000000000004, -3.0000000000000004, -3.2, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.4000000000000004, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -11.1, -3.6000000000000005, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -10.9, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.200000000000001, -3.3000000000000003, -3.1000000000000005, -3.500000000000001, -3.2, -3.2, -11.700000000000001, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.300000000000001, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -10.9, -11.1, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.200000000000001, -3.2000000000000006, -3.3000000000000003, -3.0000000000000004, -3.400000000000001, -12.100000000000001, -3.1000000000000005, -3.1000000000000005, -3.100000000000001, -10.5, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.200000000000001, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -11.5, -3.3000000000000003, -3.3000000000000007, -3.500000000000001, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.400000000000001, -3.3000000000000007, -3.5000000000000013, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -10.2, -3.200000000000001, -3.400000000000001, -3.6000000000000005, -3.1000000000000005, -3.3000000000000007, -3.4000000000000004, -3.1000000000000005, -3.500000000000001, -3.2000000000000006, -3.3000000000000003, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.3000000000000003, -3.100000000000001, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.200000000000001, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.3000000000000003, -3.2000000000000006, -3.3000000000000003, -3.100000000000001, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.2, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.2, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -10.9, -3.0000000000000004, -3.200000000000001, -3.400000000000001, -3.200000000000001, -3.2000000000000006, -3.200000000000001, -3.2000000000000006], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.505067814327994, "mean_inference_ms": 17.473125055215522, "mean_action_processing_ms": 0.9133091841555954, "mean_env_wait_ms": 2.2656310275619305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08497992340399295, "StateBufferConnector_ms": 0.01027109671612175, "ViewRequirementAgentConnector_ms": 0.15654588232235034}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 532000, "num_agent_steps_trained": 532000, "num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 532000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 532000, "timers": {"training_iteration_time_ms": 170852.621, "load_time_ms": 1.156, "load_throughput": 3459647.791, "learn_time_ms": 169866.598, "learn_throughput": 23.548, "synch_weights_time_ms": 182.067}, "counters": {"num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_agent_steps_sampled": 532000, "num_agent_steps_trained": 532000}, "done": false, "episodes_total": 26755, "training_iteration": 133, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_03-14-52", "timestamp": 1680830092, "time_this_iter_s": 170.92621755599976, "time_total_s": 22740.223709344864, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7eff9479a430>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff947a28b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 22740.223709344864, "timesteps_since_restore": 0, "iterations_since_restore": 133, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.327160493827161, "ram_util_percent": 23.817695473251035}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5077506164869954, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.23687538914182174, "policy_loss": -0.08607847065995297, "vf_loss": 0.29671839046872833, "vf_explained_var": 0.6218325845656857, "kl": 0.013648896270884722, "entropy": 3.31686462279289, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 124155.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_agent_steps_sampled": 536000, "num_agent_steps_trained": 536000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -11.700000000000001, "episode_reward_mean": -3.788659793814434, "episode_len_mean": 20.350515463917525, "episode_media": {}, "episodes_this_iter": 194, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.500000000000001, -3.1000000000000005, -11.2, -3.0000000000000004, -3.400000000000001, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -11.0, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.400000000000001, -3.2, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.300000000000001, -3.2000000000000006, -3.700000000000001, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.200000000000001, -3.4000000000000004, -3.200000000000001, -3.5000000000000004, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.100000000000001, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.2, -3.1000000000000005, -11.3, -3.2000000000000006, -3.5000000000000004, -3.3000000000000007, -3.2, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -10.9, -3.0000000000000004, -3.1000000000000005, -10.8, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.600000000000001, -3.3000000000000007, -11.6, -3.0000000000000004, -3.2000000000000006, -3.0000000000000004, -3.400000000000001, -11.5, -3.1000000000000005, -3.2000000000000006, -11.700000000000001, -3.3000000000000007, -3.3000000000000007, -3.0000000000000004, -3.5000000000000004, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -11.1, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -11.6, -3.400000000000001, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.3000000000000003, -3.1000000000000005, -3.2, -3.100000000000001, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.4000000000000004, -3.100000000000001, -3.300000000000001, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.3000000000000003, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.3000000000000007, -11.4, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -11.4, -3.2000000000000006, -3.3000000000000003, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.2, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.2, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -10.5, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -10.3, -3.2, -3.1000000000000005], "episode_lengths": [21, 21, 12, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 16, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 4, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.504278297952977, "mean_inference_ms": 17.452601646493864, "mean_action_processing_ms": 0.9123481870228852, "mean_env_wait_ms": 2.2624346468950374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07486933285428077, "StateBufferConnector_ms": 0.009275465896449139, "ViewRequirementAgentConnector_ms": 0.13818777713579}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -11.700000000000001, "episode_reward_mean": -3.788659793814434, "episode_len_mean": 20.350515463917525, "episodes_this_iter": 194, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.500000000000001, -3.1000000000000005, -11.2, -3.0000000000000004, -3.400000000000001, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -11.0, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.400000000000001, -3.2, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.300000000000001, -3.2000000000000006, -3.700000000000001, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.200000000000001, -3.4000000000000004, -3.200000000000001, -3.5000000000000004, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.100000000000001, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.2, -3.1000000000000005, -11.3, -3.2000000000000006, -3.5000000000000004, -3.3000000000000007, -3.2, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -10.9, -3.0000000000000004, -3.1000000000000005, -10.8, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.600000000000001, -3.3000000000000007, -11.6, -3.0000000000000004, -3.2000000000000006, -3.0000000000000004, -3.400000000000001, -11.5, -3.1000000000000005, -3.2000000000000006, -11.700000000000001, -3.3000000000000007, -3.3000000000000007, -3.0000000000000004, -3.5000000000000004, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -11.1, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -11.6, -3.400000000000001, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.3000000000000003, -3.1000000000000005, -3.2, -3.100000000000001, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.4000000000000004, -3.100000000000001, -3.300000000000001, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.3000000000000003, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.3000000000000007, -11.4, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -11.4, -3.2000000000000006, -3.3000000000000003, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.2, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.2, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -10.5, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -10.3, -3.2, -3.1000000000000005], "episode_lengths": [21, 21, 12, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 16, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 4, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.504278297952977, "mean_inference_ms": 17.452601646493864, "mean_action_processing_ms": 0.9123481870228852, "mean_env_wait_ms": 2.2624346468950374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07486933285428077, "StateBufferConnector_ms": 0.009275465896449139, "ViewRequirementAgentConnector_ms": 0.13818777713579}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 536000, "num_agent_steps_trained": 536000, "num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 536000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 536000, "timers": {"training_iteration_time_ms": 170891.29, "load_time_ms": 1.154, "load_throughput": 3465149.844, "learn_time_ms": 169905.346, "learn_throughput": 23.543, "synch_weights_time_ms": 181.127}, "counters": {"num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_agent_steps_sampled": 536000, "num_agent_steps_trained": 536000}, "done": false, "episodes_total": 26949, "training_iteration": 134, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_03-17-43", "timestamp": 1680830263, "time_this_iter_s": 171.2778618335724, "time_total_s": 22911.501571178436, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476cb190>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff947c11f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 22911.501571178436, "timesteps_since_restore": 0, "iterations_since_restore": 134, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.5, "ram_util_percent": 23.802469135802475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3716756726545032, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.11605103213880812, "policy_loss": -0.02242459982598541, "vf_loss": 0.12514647955815958, "vf_explained_var": 0.7963943587836398, "kl": 0.006934436419396661, "entropy": 3.3363239396002986, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 125085.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "sampler_results": {"episode_reward_max": 99.2, "episode_reward_min": -12.1, "episode_reward_mean": -2.924102564102565, "episode_len_mean": 20.584615384615386, "episode_media": {}, "episodes_this_iter": 195, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.0000000000000004, -3.200000000000001, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.100000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.2, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -12.0, -3.0000000000000004, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.3000000000000003, -3.0000000000000004, -3.3000000000000007, -3.500000000000001, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.100000000000001, -3.2, -3.1000000000000005, -3.200000000000001, -3.4000000000000004, -3.3000000000000003, -3.2000000000000006, -10.3, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -12.1, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -10.9, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, 99.2, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.500000000000001, -3.1000000000000005, -3.2000000000000006, -10.1, -3.1000000000000005, -3.300000000000001, -3.100000000000001, -3.400000000000001, -3.2000000000000006, -3.200000000000001, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.3000000000000003, -3.6000000000000005, -3.2000000000000006, -3.2000000000000006, -3.600000000000001, -3.1000000000000005, -3.7000000000000006, -3.2000000000000006, -3.3000000000000007, -3.100000000000001, -3.0000000000000004, -3.1000000000000005, -3.600000000000001, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.300000000000001, -3.0000000000000004, -3.1000000000000005, -3.2, -3.3000000000000007, -3.2000000000000006, -3.500000000000001, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.500000000000001, -3.0000000000000004, -3.2, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.5000000000000004, -3.3000000000000007, -3.200000000000001, -3.0000000000000004, -3.2, -3.3000000000000007, -3.2000000000000006, -3.2, -3.2000000000000006, -3.2000000000000006, -3.300000000000001, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.500000000000001, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -10.2, -3.2, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.9000000000000012, -3.400000000000001, -3.2000000000000006, -3.500000000000001, -3.2000000000000006, -3.3000000000000007, -3.600000000000001, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.200000000000001, -3.1000000000000005, -3.4000000000000004, -3.0000000000000004, -3.3000000000000003, -3.2000000000000006], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.508451358022116, "mean_inference_ms": 17.477228522480655, "mean_action_processing_ms": 0.9131982455314577, "mean_env_wait_ms": 2.2646069939732967, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07848837436773838, "StateBufferConnector_ms": 0.009829447819636418, "ViewRequirementAgentConnector_ms": 0.1446665250338041}}, "episode_reward_max": 99.2, "episode_reward_min": -12.1, "episode_reward_mean": -2.924102564102565, "episode_len_mean": 20.584615384615386, "episodes_this_iter": 195, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.0000000000000004, -3.200000000000001, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.100000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.2, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -12.0, -3.0000000000000004, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.3000000000000003, -3.0000000000000004, -3.3000000000000007, -3.500000000000001, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.100000000000001, -3.2, -3.1000000000000005, -3.200000000000001, -3.4000000000000004, -3.3000000000000003, -3.2000000000000006, -10.3, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -12.1, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -10.9, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, 99.2, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.500000000000001, -3.1000000000000005, -3.2000000000000006, -10.1, -3.1000000000000005, -3.300000000000001, -3.100000000000001, -3.400000000000001, -3.2000000000000006, -3.200000000000001, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.3000000000000003, -3.6000000000000005, -3.2000000000000006, -3.2000000000000006, -3.600000000000001, -3.1000000000000005, -3.7000000000000006, -3.2000000000000006, -3.3000000000000007, -3.100000000000001, -3.0000000000000004, -3.1000000000000005, -3.600000000000001, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.300000000000001, -3.0000000000000004, -3.1000000000000005, -3.2, -3.3000000000000007, -3.2000000000000006, -3.500000000000001, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.500000000000001, -3.0000000000000004, -3.2, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.5000000000000004, -3.3000000000000007, -3.200000000000001, -3.0000000000000004, -3.2, -3.3000000000000007, -3.2000000000000006, -3.2, -3.2000000000000006, -3.2000000000000006, -3.300000000000001, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.500000000000001, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -10.2, -3.2, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.9000000000000012, -3.400000000000001, -3.2000000000000006, -3.500000000000001, -3.2000000000000006, -3.3000000000000007, -3.600000000000001, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.200000000000001, -3.1000000000000005, -3.4000000000000004, -3.0000000000000004, -3.3000000000000003, -3.2000000000000006], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.508451358022116, "mean_inference_ms": 17.477228522480655, "mean_action_processing_ms": 0.9131982455314577, "mean_env_wait_ms": 2.2646069939732967, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07848837436773838, "StateBufferConnector_ms": 0.009829447819636418, "ViewRequirementAgentConnector_ms": 0.1446665250338041}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 540000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 540000, "timers": {"training_iteration_time_ms": 170917.051, "load_time_ms": 1.168, "load_throughput": 3423991.51, "learn_time_ms": 169934.365, "learn_throughput": 23.538, "synch_weights_time_ms": 179.354}, "counters": {"num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "done": false, "episodes_total": 27144, "training_iteration": 135, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_03-20-34", "timestamp": 1680830434, "time_this_iter_s": 170.95444345474243, "time_total_s": 23082.45601463318, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01473e24c0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7effc004f040>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 23082.45601463318, "timesteps_since_restore": 0, "iterations_since_restore": 135, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.379835390946503, "ram_util_percent": 23.80205761316873}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4220358274316276, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.22206442276596702, "policy_loss": -0.08392643569217574, "vf_loss": 0.2761633812529986, "vf_explained_var": 0.68136121842169, "kl": 0.015517623366985811, "entropy": 3.3101471790703396, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 126015.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.0, "episode_reward_mean": -3.6050251256281416, "episode_len_mean": 20.633165829145728, "episode_media": {}, "episodes_this_iter": 199, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.2000000000000006, -3.2, -3.1000000000000005, -10.3, -3.0000000000000004, -11.9, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.5000000000000004, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -3.0000000000000004, -3.100000000000001, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.300000000000001, -3.100000000000001, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.500000000000001, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.3000000000000003, -3.400000000000001, -3.400000000000001, -3.0000000000000004, -3.2000000000000006, -3.2, -3.2, -3.3000000000000007, -3.0000000000000004, -10.9, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.0000000000000004, -11.0, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.200000000000001, -3.3000000000000007, -3.3000000000000003, -11.2, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.2, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.200000000000001, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.2, -3.200000000000001, -3.3000000000000003, -3.200000000000001, -3.400000000000001, -11.9, -3.100000000000001, -3.2, -3.2000000000000006, -3.3000000000000007, -3.5000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -12.0, -11.7, -3.3000000000000003, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.2, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -11.1, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.200000000000001, -3.1000000000000005, -3.3000000000000007, -3.4000000000000004, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.2, -3.1000000000000005, -3.2, -3.2000000000000006, -3.1000000000000005, -3.5000000000000004, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.200000000000001, -3.2000000000000006, -3.0000000000000004, -3.600000000000001, -3.0000000000000004, -3.500000000000001, -3.2000000000000006, -11.7, -3.3000000000000003, -3.1000000000000005], "episode_lengths": [21, 21, 21, 4, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.509303941734945, "mean_inference_ms": 17.47179201155578, "mean_action_processing_ms": 0.9124905909072631, "mean_env_wait_ms": 2.262545674083544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06911874416485504, "StateBufferConnector_ms": 0.008550480981567996, "ViewRequirementAgentConnector_ms": 0.12940701527811174}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.0, "episode_reward_mean": -3.6050251256281416, "episode_len_mean": 20.633165829145728, "episodes_this_iter": 199, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.2000000000000006, -3.2, -3.1000000000000005, -10.3, -3.0000000000000004, -11.9, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.5000000000000004, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -3.0000000000000004, -3.100000000000001, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.300000000000001, -3.100000000000001, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.500000000000001, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.3000000000000003, -3.400000000000001, -3.400000000000001, -3.0000000000000004, -3.2000000000000006, -3.2, -3.2, -3.3000000000000007, -3.0000000000000004, -10.9, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.0000000000000004, -11.0, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.200000000000001, -3.3000000000000007, -3.3000000000000003, -11.2, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.2, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.200000000000001, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.2, -3.200000000000001, -3.3000000000000003, -3.200000000000001, -3.400000000000001, -11.9, -3.100000000000001, -3.2, -3.2000000000000006, -3.3000000000000007, -3.5000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -12.0, -11.7, -3.3000000000000003, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.2, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -11.1, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.200000000000001, -3.1000000000000005, -3.3000000000000007, -3.4000000000000004, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.2, -3.1000000000000005, -3.2, -3.2000000000000006, -3.1000000000000005, -3.5000000000000004, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.200000000000001, -3.2000000000000006, -3.0000000000000004, -3.600000000000001, -3.0000000000000004, -3.500000000000001, -3.2000000000000006, -11.7, -3.3000000000000003, -3.1000000000000005], "episode_lengths": [21, 21, 21, 4, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.509303941734945, "mean_inference_ms": 17.47179201155578, "mean_action_processing_ms": 0.9124905909072631, "mean_env_wait_ms": 2.262545674083544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06911874416485504, "StateBufferConnector_ms": 0.008550480981567996, "ViewRequirementAgentConnector_ms": 0.12940701527811174}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000, "num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 544000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 544000, "timers": {"training_iteration_time_ms": 170915.496, "load_time_ms": 1.16, "load_throughput": 3449334.073, "learn_time_ms": 169924.757, "learn_throughput": 23.54, "synch_weights_time_ms": 186.589}, "counters": {"num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "done": false, "episodes_total": 27343, "training_iteration": 136, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_03-23-25", "timestamp": 1680830605, "time_this_iter_s": 170.5938093662262, "time_total_s": 23253.049823999405, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f014746e490>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff947c11f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 23253.049823999405, "timesteps_since_restore": 0, "iterations_since_restore": 136, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.351028806584362, "ram_util_percent": 23.802880658436223}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6704157021096957, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.16849868102700158, "policy_loss": -0.0782786151664632, "vf_loss": 0.2197793375465378, "vf_explained_var": 0.7682910538488819, "kl": 0.014045576872279046, "entropy": 3.314046057065328, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 126945.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_agent_steps_sampled": 548000, "num_agent_steps_trained": 548000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.0, "episode_reward_mean": -3.5945000000000005, "episode_len_mean": 20.51, "episode_media": {}, "episodes_this_iter": 200, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0000000000000004, -3.300000000000001, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.600000000000001, -3.3000000000000007, -3.3000000000000003, -3.0000000000000004, -3.100000000000001, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.5000000000000004, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.0000000000000004, -3.3000000000000003, -3.100000000000001, -3.3000000000000007, -3.200000000000001, -3.3000000000000003, -3.1000000000000005, -11.0, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -11.3, -3.2000000000000006, -3.2, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.3000000000000003, -10.9, -3.400000000000001, -11.3, -11.2, -3.4000000000000004, -3.3000000000000007, -3.400000000000001, -3.7000000000000006, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -10.7, -3.3000000000000007, -3.1000000000000005, -10.6, -11.3, -3.3000000000000003, -3.3000000000000007, -3.0000000000000004, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.100000000000001, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.2, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.0000000000000004, -3.400000000000001, -3.200000000000001, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.500000000000001, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.5000000000000004, -3.2000000000000006, -12.0, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.200000000000001, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.0000000000000004, -3.400000000000001, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.5000000000000004, -3.0000000000000004, -3.5000000000000004, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.500000000000001, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.500000000000001, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -10.6, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 8, 21, 13, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 6, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.50659565828178, "mean_inference_ms": 17.475180022258122, "mean_action_processing_ms": 0.9130329335096848, "mean_env_wait_ms": 2.2656172142112307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07222390174865723, "StateBufferConnector_ms": 0.009232044219970703, "ViewRequirementAgentConnector_ms": 0.13424277305603027}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.0, "episode_reward_mean": -3.5945000000000005, "episode_len_mean": 20.51, "episodes_this_iter": 200, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.0000000000000004, -3.300000000000001, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.600000000000001, -3.3000000000000007, -3.3000000000000003, -3.0000000000000004, -3.100000000000001, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.5000000000000004, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.0000000000000004, -3.3000000000000003, -3.100000000000001, -3.3000000000000007, -3.200000000000001, -3.3000000000000003, -3.1000000000000005, -11.0, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -11.3, -3.2000000000000006, -3.2, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.3000000000000003, -10.9, -3.400000000000001, -11.3, -11.2, -3.4000000000000004, -3.3000000000000007, -3.400000000000001, -3.7000000000000006, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -10.7, -3.3000000000000007, -3.1000000000000005, -10.6, -11.3, -3.3000000000000003, -3.3000000000000007, -3.0000000000000004, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.100000000000001, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.2, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.0000000000000004, -3.400000000000001, -3.200000000000001, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.500000000000001, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.5000000000000004, -3.2000000000000006, -12.0, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.200000000000001, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.0000000000000004, -3.400000000000001, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.5000000000000004, -3.0000000000000004, -3.5000000000000004, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.500000000000001, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.500000000000001, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -10.6, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 8, 21, 13, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 6, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.50659565828178, "mean_inference_ms": 17.475180022258122, "mean_action_processing_ms": 0.9130329335096848, "mean_env_wait_ms": 2.2656172142112307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07222390174865723, "StateBufferConnector_ms": 0.009232044219970703, "ViewRequirementAgentConnector_ms": 0.13424277305603027}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 548000, "num_agent_steps_trained": 548000, "num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 548000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 548000, "timers": {"training_iteration_time_ms": 170909.71, "load_time_ms": 1.163, "load_throughput": 3440351.064, "learn_time_ms": 169912.834, "learn_throughput": 23.541, "synch_weights_time_ms": 188.381}, "counters": {"num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_agent_steps_sampled": 548000, "num_agent_steps_trained": 548000}, "done": false, "episodes_total": 27543, "training_iteration": 137, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_03-26-16", "timestamp": 1680830776, "time_this_iter_s": 171.0996105670929, "time_total_s": 23424.149434566498, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01472afa00>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7effc00b5f70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 23424.149434566498, "timesteps_since_restore": 0, "iterations_since_restore": 137, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.549382716049383, "ram_util_percent": 23.8008230452675}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5535960179343018, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.19959288458990795, "policy_loss": -0.07901392631052483, "vf_loss": 0.2515616066318246, "vf_explained_var": 0.6569612576115516, "kl": 0.01407015509875266, "entropy": 3.2885613843958863, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 127875.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.2, "episode_reward_mean": -3.7494680851063835, "episode_len_mean": 20.675531914893618, "episode_media": {}, "episodes_this_iter": 188, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.100000000000001, -3.0000000000000004, -3.400000000000001, -11.9, -10.7, -3.1000000000000005, -3.1000000000000005, -12.0, -3.0000000000000004, -3.0000000000000004, -3.200000000000001, -3.0000000000000004, -3.400000000000001, -3.400000000000001, -3.200000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.5000000000000004, -3.300000000000001, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.4000000000000004, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.100000000000001, -3.0000000000000004, -3.400000000000001, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.500000000000001, -3.4000000000000004, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.2, -3.400000000000001, -3.2000000000000006, -3.0000000000000004, -3.0000000000000004, -3.4000000000000004, -3.2, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -11.5, -3.0000000000000004, -3.400000000000001, -3.2000000000000006, -3.0000000000000004, -3.3000000000000003, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -11.700000000000001, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.200000000000001, -3.1000000000000005, -3.2000000000000006, -3.500000000000001, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.400000000000001, -3.1000000000000005, -3.400000000000001, -3.0000000000000004, -3.2, -3.400000000000001, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.3000000000000003, -10.9, -3.1000000000000005, -3.5000000000000004, -11.5, -3.0000000000000004, -3.400000000000001, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2, -3.2000000000000006, -3.3000000000000003, -3.0000000000000004, -3.3000000000000007, -3.400000000000001, -12.2, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -11.6, -3.3000000000000007, -12.0, -3.0000000000000004, -3.4000000000000004, -3.400000000000001, -3.4000000000000004, -3.1000000000000005, -3.500000000000001, -3.3000000000000007, -3.400000000000001, -3.100000000000001, -3.0000000000000004, -3.0000000000000004, -3.5000000000000004, -3.3000000000000007, -3.2, -3.3000000000000003, -3.3000000000000007, -3.600000000000001, -3.3000000000000003, -3.2, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.400000000000001, -11.6, -3.4000000000000004, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.100000000000001, -3.2000000000000006, -3.500000000000001, -3.4000000000000004, -3.0000000000000004, -3.4000000000000004, -3.5000000000000004, -3.400000000000001, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.2, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.400000000000001, -3.2000000000000006, -3.200000000000001, -3.2000000000000006, -3.5000000000000004, -3.3000000000000003, -3.0000000000000004, -3.300000000000001], "episode_lengths": [20, 21, 21, 18, 7, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 16, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.506417526182737, "mean_inference_ms": 17.469559094061566, "mean_action_processing_ms": 0.9124606402911146, "mean_env_wait_ms": 2.2667765992176143, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07462881981058324, "StateBufferConnector_ms": 0.009599010995093813, "ViewRequirementAgentConnector_ms": 0.1374480572152645}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.2, "episode_reward_mean": -3.7494680851063835, "episode_len_mean": 20.675531914893618, "episodes_this_iter": 188, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-12.100000000000001, -3.0000000000000004, -3.400000000000001, -11.9, -10.7, -3.1000000000000005, -3.1000000000000005, -12.0, -3.0000000000000004, -3.0000000000000004, -3.200000000000001, -3.0000000000000004, -3.400000000000001, -3.400000000000001, -3.200000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.5000000000000004, -3.300000000000001, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.4000000000000004, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.100000000000001, -3.0000000000000004, -3.400000000000001, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.500000000000001, -3.4000000000000004, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.2, -3.400000000000001, -3.2000000000000006, -3.0000000000000004, -3.0000000000000004, -3.4000000000000004, -3.2, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -11.5, -3.0000000000000004, -3.400000000000001, -3.2000000000000006, -3.0000000000000004, -3.3000000000000003, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -11.700000000000001, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.200000000000001, -3.1000000000000005, -3.2000000000000006, -3.500000000000001, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.400000000000001, -3.1000000000000005, -3.400000000000001, -3.0000000000000004, -3.2, -3.400000000000001, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.3000000000000003, -10.9, -3.1000000000000005, -3.5000000000000004, -11.5, -3.0000000000000004, -3.400000000000001, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2, -3.2000000000000006, -3.3000000000000003, -3.0000000000000004, -3.3000000000000007, -3.400000000000001, -12.2, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -11.6, -3.3000000000000007, -12.0, -3.0000000000000004, -3.4000000000000004, -3.400000000000001, -3.4000000000000004, -3.1000000000000005, -3.500000000000001, -3.3000000000000007, -3.400000000000001, -3.100000000000001, -3.0000000000000004, -3.0000000000000004, -3.5000000000000004, -3.3000000000000007, -3.2, -3.3000000000000003, -3.3000000000000007, -3.600000000000001, -3.3000000000000003, -3.2, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.400000000000001, -11.6, -3.4000000000000004, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.100000000000001, -3.2000000000000006, -3.500000000000001, -3.4000000000000004, -3.0000000000000004, -3.4000000000000004, -3.5000000000000004, -3.400000000000001, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.2, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.400000000000001, -3.2000000000000006, -3.200000000000001, -3.2000000000000006, -3.5000000000000004, -3.3000000000000003, -3.0000000000000004, -3.300000000000001], "episode_lengths": [20, 21, 21, 18, 7, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 16, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.506417526182737, "mean_inference_ms": 17.469559094061566, "mean_action_processing_ms": 0.9124606402911146, "mean_env_wait_ms": 2.2667765992176143, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07462881981058324, "StateBufferConnector_ms": 0.009599010995093813, "ViewRequirementAgentConnector_ms": 0.1374480572152645}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 552000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 552000, "timers": {"training_iteration_time_ms": 170898.945, "load_time_ms": 1.159, "load_throughput": 3452670.398, "learn_time_ms": 169905.089, "learn_throughput": 23.543, "synch_weights_time_ms": 188.022}, "counters": {"num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000}, "done": false, "episodes_total": 27731, "training_iteration": 138, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_03-29-07", "timestamp": 1680830947, "time_this_iter_s": 170.74120664596558, "time_total_s": 23594.890641212463, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01473e2310>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7effc006c550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 23594.890641212463, "timesteps_since_restore": 0, "iterations_since_restore": 138, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.388477366255144, "ram_util_percent": 23.8008230452675}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4293128763635954, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.2111697371808752, "policy_loss": -0.07920098369540547, "vf_loss": 0.2629183509617403, "vf_explained_var": 0.6884845541369531, "kl": 0.014281981656833562, "entropy": 3.260571422628177, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 128805.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_agent_steps_sampled": 556000, "num_agent_steps_trained": 556000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.200000000000001, "episode_reward_mean": -3.7356783919598002, "episode_len_mean": 20.42713567839196, "episode_media": {}, "episodes_this_iter": 199, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.1000000000000005, -3.5000000000000004, -3.2000000000000006, -3.2000000000000006, -3.500000000000001, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.4000000000000004, -3.4000000000000004, -3.2000000000000006, -3.400000000000001, -3.3000000000000003, -3.1000000000000005, -3.2, -11.9, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.0000000000000004, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.0000000000000004, -10.5, -3.4000000000000004, -3.2000000000000006, -3.0000000000000004, -3.0000000000000004, -3.300000000000001, -3.5000000000000004, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -10.1, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -10.2, -3.0000000000000004, -3.2000000000000006, -3.400000000000001, -3.3000000000000003, -3.2, -3.1000000000000005, -3.200000000000001, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.2, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.3000000000000003, -3.3000000000000003, -3.4000000000000004, -3.3000000000000007, -3.200000000000001, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.2, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -10.2, -3.2000000000000006, -3.3000000000000003, -3.100000000000001, -3.100000000000001, -3.2, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2, -3.0000000000000004, -3.2000000000000006, -11.700000000000001, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -11.1, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -11.600000000000001, -12.200000000000001, -3.1000000000000005, -3.600000000000001, -3.0000000000000004, -3.2000000000000006, -3.2, -11.2, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.4000000000000004, -3.3000000000000007, -3.0000000000000004, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.6000000000000005, -3.3000000000000007, -3.400000000000001, -3.4000000000000004, -3.5000000000000004, -3.100000000000001, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -11.9, -3.2000000000000006, -3.3000000000000007, -3.5000000000000004, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.300000000000001, -3.2000000000000006, -3.6000000000000005, -3.3000000000000007, -3.500000000000001, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.2, -3.2, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.2, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -11.3, -3.2000000000000006, -3.5000000000000004, -3.100000000000001, -12.100000000000001, -3.0000000000000004], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 15, 19, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 20, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.50752163954025, "mean_inference_ms": 17.48799016771433, "mean_action_processing_ms": 0.9131254658743468, "mean_env_wait_ms": 2.2666336195630534, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07252717137935773, "StateBufferConnector_ms": 0.009496966798101837, "ViewRequirementAgentConnector_ms": 0.1365117691270071}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.200000000000001, "episode_reward_mean": -3.7356783919598002, "episode_len_mean": 20.42713567839196, "episodes_this_iter": 199, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.1000000000000005, -3.5000000000000004, -3.2000000000000006, -3.2000000000000006, -3.500000000000001, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.4000000000000004, -3.4000000000000004, -3.2000000000000006, -3.400000000000001, -3.3000000000000003, -3.1000000000000005, -3.2, -11.9, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.0000000000000004, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.0000000000000004, -10.5, -3.4000000000000004, -3.2000000000000006, -3.0000000000000004, -3.0000000000000004, -3.300000000000001, -3.5000000000000004, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -10.1, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -10.2, -3.0000000000000004, -3.2000000000000006, -3.400000000000001, -3.3000000000000003, -3.2, -3.1000000000000005, -3.200000000000001, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.2, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.3000000000000003, -3.3000000000000003, -3.4000000000000004, -3.3000000000000007, -3.200000000000001, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.2, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -10.2, -3.2000000000000006, -3.3000000000000003, -3.100000000000001, -3.100000000000001, -3.2, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2, -3.0000000000000004, -3.2000000000000006, -11.700000000000001, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -11.1, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -11.600000000000001, -12.200000000000001, -3.1000000000000005, -3.600000000000001, -3.0000000000000004, -3.2000000000000006, -3.2, -11.2, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.4000000000000004, -3.3000000000000007, -3.0000000000000004, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.6000000000000005, -3.3000000000000007, -3.400000000000001, -3.4000000000000004, -3.5000000000000004, -3.100000000000001, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -11.9, -3.2000000000000006, -3.3000000000000007, -3.5000000000000004, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.300000000000001, -3.2000000000000006, -3.6000000000000005, -3.3000000000000007, -3.500000000000001, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.2, -3.2, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.2, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -11.3, -3.2000000000000006, -3.5000000000000004, -3.100000000000001, -12.100000000000001, -3.0000000000000004], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 15, 19, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 20, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.50752163954025, "mean_inference_ms": 17.48799016771433, "mean_action_processing_ms": 0.9131254658743468, "mean_env_wait_ms": 2.2666336195630534, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07252717137935773, "StateBufferConnector_ms": 0.009496966798101837, "ViewRequirementAgentConnector_ms": 0.1365117691270071}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 556000, "num_agent_steps_trained": 556000, "num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 556000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 556000, "timers": {"training_iteration_time_ms": 170880.719, "load_time_ms": 1.15, "load_throughput": 3479450.827, "learn_time_ms": 169901.699, "learn_throughput": 23.543, "synch_weights_time_ms": 192.204}, "counters": {"num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_agent_steps_sampled": 556000, "num_agent_steps_trained": 556000}, "done": false, "episodes_total": 27930, "training_iteration": 139, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_03-31-58", "timestamp": 1680831118, "time_this_iter_s": 170.60892629623413, "time_total_s": 23765.499567508698, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01475e2e50>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff947c11f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 23765.499567508698, "timesteps_since_restore": 0, "iterations_since_restore": 139, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.33801652892562, "ram_util_percent": 23.800826446281}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5405235814231057, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.4118491458641465, "policy_loss": -0.030840568857327583, "vf_loss": 0.42245835068645654, "vf_explained_var": 0.6516803274872482, "kl": 0.010525281618597107, "entropy": 3.2641270755439677, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 129735.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "sampler_results": {"episode_reward_max": 98.1, "episode_reward_min": -12.200000000000001, "episode_reward_mean": -3.179899497487438, "episode_len_mean": 20.55778894472362, "episode_media": {}, "episodes_this_iter": 199, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.2, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.0000000000000004, -11.9, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.2, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.600000000000001, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.300000000000001, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.100000000000001, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.500000000000001, -3.2, -3.1000000000000005, -3.2000000000000006, -10.5, -3.300000000000001, -3.3000000000000007, -3.400000000000001, -3.300000000000001, -12.2, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -12.0, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -10.7, -3.0000000000000004, -3.3000000000000003, -3.0000000000000004, -3.0000000000000004, -3.3000000000000003, -3.1000000000000005, -3.300000000000001, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -11.0, -11.2, -3.2, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.200000000000001, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -12.100000000000001, -3.2, -3.2000000000000006, -3.200000000000001, 98.1, -3.2, -12.200000000000001, -3.3000000000000007, -3.0000000000000004, -3.5000000000000004, -3.2000000000000006, -3.3000000000000003, -3.3000000000000003, -3.0000000000000004, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.1000000000000005, -3.500000000000001, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -10.5, -3.3000000000000003, -3.4000000000000004, -3.4000000000000012, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.200000000000001, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.200000000000001, -3.0000000000000004, -11.4, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.5000000000000004, -3.2, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.0000000000000004, -3.2000000000000006, -3.500000000000001, -3.5000000000000004, -3.2, -3.3000000000000007, -3.2000000000000006, -3.200000000000001, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.3000000000000003, -3.200000000000001, -3.2000000000000006, -3.2, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -10.9, -3.1000000000000005, -3.5000000000000004, -3.400000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 20, 21, 21, 21, 19, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 20, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.500815383586383, "mean_inference_ms": 17.47309618517932, "mean_action_processing_ms": 0.9126029626820377, "mean_env_wait_ms": 2.2709661780451307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07870472855304354, "StateBufferConnector_ms": 0.010163819969598972, "ViewRequirementAgentConnector_ms": 0.14330538073975838}}, "episode_reward_max": 98.1, "episode_reward_min": -12.200000000000001, "episode_reward_mean": -3.179899497487438, "episode_len_mean": 20.55778894472362, "episodes_this_iter": 199, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.2, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.0000000000000004, -11.9, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.2, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.600000000000001, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.300000000000001, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.100000000000001, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.500000000000001, -3.2, -3.1000000000000005, -3.2000000000000006, -10.5, -3.300000000000001, -3.3000000000000007, -3.400000000000001, -3.300000000000001, -12.2, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -12.0, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -10.7, -3.0000000000000004, -3.3000000000000003, -3.0000000000000004, -3.0000000000000004, -3.3000000000000003, -3.1000000000000005, -3.300000000000001, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -11.0, -11.2, -3.2, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.200000000000001, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -12.100000000000001, -3.2, -3.2000000000000006, -3.200000000000001, 98.1, -3.2, -12.200000000000001, -3.3000000000000007, -3.0000000000000004, -3.5000000000000004, -3.2000000000000006, -3.3000000000000003, -3.3000000000000003, -3.0000000000000004, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.1000000000000005, -3.500000000000001, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -10.5, -3.3000000000000003, -3.4000000000000004, -3.4000000000000012, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.200000000000001, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.200000000000001, -3.0000000000000004, -11.4, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.5000000000000004, -3.2, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.0000000000000004, -3.2000000000000006, -3.500000000000001, -3.5000000000000004, -3.2, -3.3000000000000007, -3.2000000000000006, -3.200000000000001, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.3000000000000003, -3.200000000000001, -3.2000000000000006, -3.2, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -10.9, -3.1000000000000005, -3.5000000000000004, -3.400000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 20, 21, 21, 21, 19, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 20, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.500815383586383, "mean_inference_ms": 17.47309618517932, "mean_action_processing_ms": 0.9126029626820377, "mean_env_wait_ms": 2.2709661780451307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07870472855304354, "StateBufferConnector_ms": 0.010163819969598972, "ViewRequirementAgentConnector_ms": 0.14330538073975838}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 560000, "timers": {"training_iteration_time_ms": 170905.416, "load_time_ms": 1.157, "load_throughput": 3458078.984, "learn_time_ms": 169915.516, "learn_throughput": 23.541, "synch_weights_time_ms": 193.357}, "counters": {"num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "done": false, "episodes_total": 28129, "training_iteration": 140, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_03-34-49", "timestamp": 1680831289, "time_this_iter_s": 171.04551076889038, "time_total_s": 23936.545078277588, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7effc0130f10>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7effc006c550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 23936.545078277588, "timesteps_since_restore": 0, "iterations_since_restore": 140, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.367078189300411, "ram_util_percent": 23.821810699588482}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3940882876515388, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.22242976575188578, "policy_loss": -0.10393215398234065, "vf_loss": 0.29771060969615454, "vf_explained_var": 0.6746335655130365, "kl": 0.014905724503689505, "entropy": 3.249202452680116, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 130665.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.0, "episode_reward_mean": -3.806632653061225, "episode_len_mean": 20.270408163265305, "episode_media": {}, "episodes_this_iter": 196, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.1, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.2, -3.2000000000000006, -3.100000000000001, -3.1000000000000005, -11.3, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.300000000000001, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.2, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.300000000000001, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.5000000000000013, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.300000000000001, -3.3000000000000007, -3.100000000000001, -3.1000000000000005, -3.0000000000000004, -3.3000000000000003, -3.0000000000000004, -3.2000000000000006, -3.0000000000000004, -3.3000000000000003, -10.3, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.1000000000000005, -3.2, -3.3000000000000007, -3.0000000000000004, -3.4000000000000004, -3.4000000000000004, -3.3000000000000003, -3.2, -3.3000000000000007, -11.7, -11.1, -12.0, -3.5000000000000013, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.400000000000001, -3.200000000000001, -3.3000000000000003, -10.1, -3.2000000000000006, -10.9, -3.0000000000000004, -3.0000000000000004, -3.500000000000001, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.3000000000000003, -3.2, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.5000000000000004, -3.0000000000000004, -3.3000000000000007, -10.4, -3.200000000000001, -3.2000000000000006, -3.2000000000000006, -3.6000000000000005, -3.5000000000000004, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.2, -3.2, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.100000000000001, -3.400000000000001, -3.1000000000000005, -11.5, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.100000000000001, -3.2, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -10.9, -3.100000000000001, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.5000000000000004, -3.0000000000000004, -3.2000000000000006, -3.600000000000001, -3.400000000000001, -3.400000000000001, -3.2, -3.2000000000000006, -11.4, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -11.8, -3.1000000000000005, -3.300000000000001, -3.3000000000000007, -3.0000000000000004, -11.6, -11.4, -3.3000000000000007, -3.2000000000000006], "episode_lengths": [2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 11, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 17, 15, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.502278946613522, "mean_inference_ms": 17.45873411784811, "mean_action_processing_ms": 0.9120035630652858, "mean_env_wait_ms": 2.269768584854211, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07202844230496154, "StateBufferConnector_ms": 0.009247234889439173, "ViewRequirementAgentConnector_ms": 0.13162822139506436}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.0, "episode_reward_mean": -3.806632653061225, "episode_len_mean": 20.270408163265305, "episodes_this_iter": 196, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10.1, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.2, -3.2000000000000006, -3.100000000000001, -3.1000000000000005, -11.3, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.300000000000001, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.2, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.300000000000001, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.5000000000000013, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.300000000000001, -3.3000000000000007, -3.100000000000001, -3.1000000000000005, -3.0000000000000004, -3.3000000000000003, -3.0000000000000004, -3.2000000000000006, -3.0000000000000004, -3.3000000000000003, -10.3, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.1000000000000005, -3.2, -3.3000000000000007, -3.0000000000000004, -3.4000000000000004, -3.4000000000000004, -3.3000000000000003, -3.2, -3.3000000000000007, -11.7, -11.1, -12.0, -3.5000000000000013, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.400000000000001, -3.200000000000001, -3.3000000000000003, -10.1, -3.2000000000000006, -10.9, -3.0000000000000004, -3.0000000000000004, -3.500000000000001, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.3000000000000003, -3.2, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.5000000000000004, -3.0000000000000004, -3.3000000000000007, -10.4, -3.200000000000001, -3.2000000000000006, -3.2000000000000006, -3.6000000000000005, -3.5000000000000004, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.2, -3.2, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.100000000000001, -3.400000000000001, -3.1000000000000005, -11.5, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.100000000000001, -3.2, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -10.9, -3.100000000000001, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.5000000000000004, -3.0000000000000004, -3.2000000000000006, -3.600000000000001, -3.400000000000001, -3.400000000000001, -3.2, -3.2000000000000006, -11.4, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -11.8, -3.1000000000000005, -3.300000000000001, -3.3000000000000007, -3.0000000000000004, -11.6, -11.4, -3.3000000000000007, -3.2000000000000006], "episode_lengths": [2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 11, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 17, 15, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.502278946613522, "mean_inference_ms": 17.45873411784811, "mean_action_processing_ms": 0.9120035630652858, "mean_env_wait_ms": 2.269768584854211, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07202844230496154, "StateBufferConnector_ms": 0.009247234889439173, "ViewRequirementAgentConnector_ms": 0.13162822139506436}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 564000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 564000, "timers": {"training_iteration_time_ms": 170880.199, "load_time_ms": 1.151, "load_throughput": 3476062.571, "learn_time_ms": 169892.085, "learn_throughput": 23.544, "synch_weights_time_ms": 191.828}, "counters": {"num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000}, "done": false, "episodes_total": 28325, "training_iteration": 141, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_03-37-40", "timestamp": 1680831460, "time_this_iter_s": 170.835768699646, "time_total_s": 24107.380846977234, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7effc0123430>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff947c11f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 24107.380846977234, "timesteps_since_restore": 0, "iterations_since_restore": 141, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.550617283950616, "ram_util_percent": 23.801234567901243}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4212591431313946, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.09456386633057107, "policy_loss": -0.0694926768356073, "vf_loss": 0.13933578829671586, "vf_explained_var": 0.815864287396913, "kl": 0.012860870066252838, "entropy": 3.2492855218149, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 131595.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_agent_steps_sampled": 568000, "num_agent_steps_trained": 568000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.100000000000001, "episode_reward_mean": -3.5102150537634413, "episode_len_mean": 20.655913978494624, "episode_media": {}, "episodes_this_iter": 186, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -10.1, -3.1000000000000005, -3.1000000000000005, -11.8, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.2, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.3000000000000003, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.200000000000001, -3.0000000000000004, -12.100000000000001, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.5000000000000004, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.400000000000001, -3.2, -3.3000000000000003, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.5000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.200000000000001, -3.2000000000000006, -3.2, -3.1000000000000005, -3.500000000000001, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -10.7, -3.0000000000000004, -3.4000000000000004, -10.3, -11.1, -3.400000000000001, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.0000000000000004, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.2, -3.1000000000000005, -3.200000000000001, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.500000000000001, -3.3000000000000007, -3.3000000000000003, -3.400000000000001, -3.300000000000001, -3.2, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.4000000000000012, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.2, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.4000000000000004, -3.3000000000000007, -3.2, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.400000000000001, -3.100000000000001, -3.3000000000000003, -3.100000000000001, -3.1000000000000005, -3.2, -3.3000000000000007, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.4, -3.100000000000001, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.300000000000001, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -11.9, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006], "episode_lengths": [21, 21, 21, 21, 21, 2, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 4, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.505399469438409, "mean_inference_ms": 17.48722954978639, "mean_action_processing_ms": 0.9135202112031948, "mean_env_wait_ms": 2.271919780126871, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07605091218025453, "StateBufferConnector_ms": 0.01037684820031607, "ViewRequirementAgentConnector_ms": 0.14074822907806725}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.100000000000001, "episode_reward_mean": -3.5102150537634413, "episode_len_mean": 20.655913978494624, "episodes_this_iter": 186, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -10.1, -3.1000000000000005, -3.1000000000000005, -11.8, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.2, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.3000000000000003, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.200000000000001, -3.0000000000000004, -12.100000000000001, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.5000000000000004, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.400000000000001, -3.2, -3.3000000000000003, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.5000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.200000000000001, -3.2000000000000006, -3.2, -3.1000000000000005, -3.500000000000001, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -10.7, -3.0000000000000004, -3.4000000000000004, -10.3, -11.1, -3.400000000000001, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.0000000000000004, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.2, -3.1000000000000005, -3.200000000000001, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.500000000000001, -3.3000000000000007, -3.3000000000000003, -3.400000000000001, -3.300000000000001, -3.2, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.4000000000000012, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.2, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.4000000000000004, -3.3000000000000007, -3.2, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.400000000000001, -3.100000000000001, -3.3000000000000003, -3.100000000000001, -3.1000000000000005, -3.2, -3.3000000000000007, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.4, -3.100000000000001, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.300000000000001, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -11.9, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006], "episode_lengths": [21, 21, 21, 21, 21, 2, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 4, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.505399469438409, "mean_inference_ms": 17.48722954978639, "mean_action_processing_ms": 0.9135202112031948, "mean_env_wait_ms": 2.271919780126871, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07605091218025453, "StateBufferConnector_ms": 0.01037684820031607, "ViewRequirementAgentConnector_ms": 0.14074822907806725}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 568000, "num_agent_steps_trained": 568000, "num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 568000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 568000, "timers": {"training_iteration_time_ms": 170859.603, "load_time_ms": 1.15, "load_throughput": 3478080.312, "learn_time_ms": 169868.369, "learn_throughput": 23.548, "synch_weights_time_ms": 191.467}, "counters": {"num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_agent_steps_sampled": 568000, "num_agent_steps_trained": 568000}, "done": false, "episodes_total": 28511, "training_iteration": 142, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_03-40-30", "timestamp": 1680831630, "time_this_iter_s": 170.6261022090912, "time_total_s": 24278.006949186325, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476b91f0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7effc004f5e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 24278.006949186325, "timesteps_since_restore": 0, "iterations_since_restore": 142, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.348148148148149, "ram_util_percent": 23.80534979423869}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6509228673593332, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.11085133441593699, "policy_loss": -0.01944042733502424, "vf_loss": 0.11521071417317275, "vf_explained_var": 0.8456005743754808, "kl": 0.00784585273042897, "entropy": 3.25038239443174, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 132525.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_agent_steps_sampled": 572000, "num_agent_steps_trained": 572000}, "sampler_results": {"episode_reward_max": 98.6, "episode_reward_min": -12.0, "episode_reward_mean": -2.902061855670104, "episode_len_mean": 20.603092783505154, "episode_media": {}, "episodes_this_iter": 194, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.1000000000000005, -3.0000000000000004, -3.4000000000000004, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.100000000000001, -3.600000000000001, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.2, -3.400000000000001, -12.0, -3.100000000000001, -3.3000000000000003, -11.9, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.100000000000001, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.100000000000001, -3.3000000000000007, -3.2000000000000006, -11.1, -3.2, -3.0000000000000004, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.100000000000001, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.2, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.6000000000000005, -3.2000000000000006, -3.0000000000000004, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.100000000000001, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.6000000000000005, -3.2000000000000006, -3.5000000000000004, -3.400000000000001, -3.3000000000000007, -3.3000000000000003, -3.1000000000000005, -3.0000000000000004, -3.3000000000000003, -3.2, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2, -3.3000000000000007, -3.2, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.100000000000001, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.100000000000001, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.2, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.400000000000001, -3.0000000000000004, -3.3000000000000007, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.5000000000000004, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.2, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.0000000000000004, -3.400000000000001, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.2, -3.1000000000000005, -3.2000000000000006, -3.100000000000001, -3.2000000000000006, -3.2, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.100000000000001, 98.6, -3.0000000000000004, -3.3000000000000007, -10.3, -3.3000000000000003, -10.1, -3.400000000000001, -10.0], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 4, 21, 2, 21, 1]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.503398080583597, "mean_inference_ms": 17.449811491802688, "mean_action_processing_ms": 0.9113234663866865, "mean_env_wait_ms": 2.2679675533780306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0743590679365335, "StateBufferConnector_ms": 0.009744437699465407, "ViewRequirementAgentConnector_ms": 0.13504900883153542}}, "episode_reward_max": 98.6, "episode_reward_min": -12.0, "episode_reward_mean": -2.902061855670104, "episode_len_mean": 20.603092783505154, "episodes_this_iter": 194, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.1000000000000005, -3.0000000000000004, -3.4000000000000004, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.100000000000001, -3.600000000000001, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.2, -3.400000000000001, -12.0, -3.100000000000001, -3.3000000000000003, -11.9, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.100000000000001, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.100000000000001, -3.3000000000000007, -3.2000000000000006, -11.1, -3.2, -3.0000000000000004, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.100000000000001, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.2, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.6000000000000005, -3.2000000000000006, -3.0000000000000004, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.100000000000001, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.6000000000000005, -3.2000000000000006, -3.5000000000000004, -3.400000000000001, -3.3000000000000007, -3.3000000000000003, -3.1000000000000005, -3.0000000000000004, -3.3000000000000003, -3.2, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2, -3.3000000000000007, -3.2, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.100000000000001, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.100000000000001, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.2, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.400000000000001, -3.0000000000000004, -3.3000000000000007, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.5000000000000004, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.2, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.0000000000000004, -3.400000000000001, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.2, -3.1000000000000005, -3.2000000000000006, -3.100000000000001, -3.2000000000000006, -3.2, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.100000000000001, 98.6, -3.0000000000000004, -3.3000000000000007, -10.3, -3.3000000000000003, -10.1, -3.400000000000001, -10.0], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 4, 21, 2, 21, 1]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.503398080583597, "mean_inference_ms": 17.449811491802688, "mean_action_processing_ms": 0.9113234663866865, "mean_env_wait_ms": 2.2679675533780306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0743590679365335, "StateBufferConnector_ms": 0.009744437699465407, "ViewRequirementAgentConnector_ms": 0.13504900883153542}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 572000, "num_agent_steps_trained": 572000, "num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 572000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 572000, "timers": {"training_iteration_time_ms": 170838.819, "load_time_ms": 1.15, "load_throughput": 3477287.349, "learn_time_ms": 169864.012, "learn_throughput": 23.548, "synch_weights_time_ms": 191.074}, "counters": {"num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_agent_steps_sampled": 572000, "num_agent_steps_trained": 572000}, "done": false, "episodes_total": 28705, "training_iteration": 143, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_03-43-21", "timestamp": 1680831801, "time_this_iter_s": 170.7208263874054, "time_total_s": 24448.72777557373, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01474231f0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff94701dc0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 24448.72777557373, "timesteps_since_restore": 0, "iterations_since_restore": 143, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.333744855967079, "ram_util_percent": 23.80781893004116}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6439808025155016, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.19205594171359333, "policy_loss": -0.031784772578506704, "vf_loss": 0.2069308420217606, "vf_explained_var": 0.8137165047148223, "kl": 0.008797292207303251, "entropy": 3.2479060842144873, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 133455.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "sampler_results": {"episode_reward_max": 98.1, "episode_reward_min": -11.8, "episode_reward_mean": -3.0292553191489366, "episode_len_mean": 20.47872340425532, "episode_media": {}, "episodes_this_iter": 188, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3000000000000003, -3.2, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.2, -3.3000000000000007, -3.2000000000000006, -3.2, -3.4000000000000004, -3.0000000000000004, -3.1000000000000005, -3.100000000000001, -3.2000000000000006, -3.2, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -11.0, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.300000000000001, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -10.7, -3.1000000000000005, -11.5, -3.3000000000000007, -3.2000000000000006, -3.200000000000001, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.4000000000000004, -3.3000000000000003, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.5000000000000013, -3.0000000000000004, -11.1, -3.200000000000001, -3.2000000000000006, -3.600000000000001, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -11.8, -3.1000000000000005, -3.2, -3.1000000000000005, -3.1000000000000005, 98.1, -3.0000000000000004, -3.2000000000000006, -3.300000000000001, -11.4, -3.200000000000001, -3.3000000000000003, -3.0000000000000004, -3.200000000000001, -3.1000000000000005, -3.300000000000001, -3.3000000000000007, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.200000000000001, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.5000000000000004, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2, -3.2, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.3000000000000007, -3.300000000000001, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.400000000000001, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.6, -3.2000000000000006, -3.400000000000001, -3.3000000000000003, -3.600000000000001, -3.5000000000000004, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2, -3.2, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -10.4, -3.3000000000000007, -10.1, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.4000000000000012, -10.8, -3.1000000000000005, -3.1000000000000005], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 18, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 2, 21, 21, 21, 21, 9, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.505439299976205, "mean_inference_ms": 17.484290715134858, "mean_action_processing_ms": 0.9127006207522279, "mean_env_wait_ms": 2.27392401186358, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08129059000218168, "StateBufferConnector_ms": 0.010394542775255568, "ViewRequirementAgentConnector_ms": 0.14950417457742893}}, "episode_reward_max": 98.1, "episode_reward_min": -11.8, "episode_reward_mean": -3.0292553191489366, "episode_len_mean": 20.47872340425532, "episodes_this_iter": 188, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.3000000000000003, -3.2, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.2, -3.3000000000000007, -3.2000000000000006, -3.2, -3.4000000000000004, -3.0000000000000004, -3.1000000000000005, -3.100000000000001, -3.2000000000000006, -3.2, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -11.0, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.300000000000001, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -10.7, -3.1000000000000005, -11.5, -3.3000000000000007, -3.2000000000000006, -3.200000000000001, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.4000000000000004, -3.3000000000000003, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.5000000000000013, -3.0000000000000004, -11.1, -3.200000000000001, -3.2000000000000006, -3.600000000000001, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -11.8, -3.1000000000000005, -3.2, -3.1000000000000005, -3.1000000000000005, 98.1, -3.0000000000000004, -3.2000000000000006, -3.300000000000001, -11.4, -3.200000000000001, -3.3000000000000003, -3.0000000000000004, -3.200000000000001, -3.1000000000000005, -3.300000000000001, -3.3000000000000007, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.200000000000001, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.5000000000000004, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2, -3.2, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.3000000000000007, -3.300000000000001, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.400000000000001, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.6, -3.2000000000000006, -3.400000000000001, -3.3000000000000003, -3.600000000000001, -3.5000000000000004, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2, -3.2, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -10.4, -3.3000000000000007, -10.1, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.4000000000000012, -10.8, -3.1000000000000005, -3.1000000000000005], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 18, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 2, 21, 21, 21, 21, 9, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.505439299976205, "mean_inference_ms": 17.484290715134858, "mean_action_processing_ms": 0.9127006207522279, "mean_env_wait_ms": 2.27392401186358, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08129059000218168, "StateBufferConnector_ms": 0.010394542775255568, "ViewRequirementAgentConnector_ms": 0.14950417457742893}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 576000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 170817.966, "load_time_ms": 1.132, "load_throughput": 3532491.683, "learn_time_ms": 169842.02, "learn_throughput": 23.551, "synch_weights_time_ms": 190.486}, "counters": {"num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "episodes_total": 28893, "training_iteration": 144, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_03-46-12", "timestamp": 1680831972, "time_this_iter_s": 171.06863284111023, "time_total_s": 24619.79640841484, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7eff9479ae50>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff947c11f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 24619.79640841484, "timesteps_since_restore": 0, "iterations_since_restore": 144, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.611522633744856, "ram_util_percent": 23.80864197530865}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4455936513200243, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.21709121961787503, "policy_loss": -0.04196507478913953, "vf_loss": 0.2332898893884273, "vf_explained_var": 0.7318283670051123, "kl": 0.013404865969055062, "entropy": 3.2636911999794744, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 134385.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_agent_steps_sampled": 580000, "num_agent_steps_trained": 580000}, "sampler_results": {"episode_reward_max": 99.1, "episode_reward_min": -11.9, "episode_reward_mean": -1.8533333333333337, "episode_len_mean": 20.702564102564104, "episode_media": {}, "episodes_this_iter": 195, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.5000000000000004, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.4000000000000004, -10.7, -3.2, -3.0000000000000004, -3.3000000000000003, -11.2, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.100000000000001, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.3000000000000007, -3.500000000000001, -3.0000000000000004, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.100000000000001, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.1000000000000005, -3.0000000000000004, -3.100000000000001, -3.1000000000000005, -3.1000000000000005, -3.500000000000001, -3.2000000000000006, -3.3000000000000007, -3.200000000000001, -3.4000000000000004, -3.4000000000000004, 98.1, -3.1000000000000005, -3.3000000000000003, -3.600000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.0000000000000004, -3.4000000000000004, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.100000000000001, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, 99.1, -3.800000000000001, -3.5000000000000004, -3.400000000000001, -3.3000000000000007, 98.1, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.500000000000001, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -10.8, -3.3000000000000007, -3.2000000000000006, -3.5000000000000004, -11.9, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.200000000000001, -3.700000000000001, -3.2, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.200000000000001, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.200000000000001, -3.2, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.2, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.5000000000000004, -3.2, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.4000000000000004, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -11.6, -3.0000000000000004, -3.3000000000000003, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.3000000000000007], "episode_lengths": [21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.496354983124967, "mean_inference_ms": 17.464331820503006, "mean_action_processing_ms": 0.9124379380593761, "mean_env_wait_ms": 2.2724799793598685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07573482317802234, "StateBufferConnector_ms": 0.009618783608461037, "ViewRequirementAgentConnector_ms": 0.13961217342278895}}, "episode_reward_max": 99.1, "episode_reward_min": -11.9, "episode_reward_mean": -1.8533333333333337, "episode_len_mean": 20.702564102564104, "episodes_this_iter": 195, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.5000000000000004, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.4000000000000004, -10.7, -3.2, -3.0000000000000004, -3.3000000000000003, -11.2, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.100000000000001, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.3000000000000007, -3.500000000000001, -3.0000000000000004, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.100000000000001, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.1000000000000005, -3.0000000000000004, -3.100000000000001, -3.1000000000000005, -3.1000000000000005, -3.500000000000001, -3.2000000000000006, -3.3000000000000007, -3.200000000000001, -3.4000000000000004, -3.4000000000000004, 98.1, -3.1000000000000005, -3.3000000000000003, -3.600000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.0000000000000004, -3.4000000000000004, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.100000000000001, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, 99.1, -3.800000000000001, -3.5000000000000004, -3.400000000000001, -3.3000000000000007, 98.1, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.500000000000001, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -10.8, -3.3000000000000007, -3.2000000000000006, -3.5000000000000004, -11.9, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.200000000000001, -3.700000000000001, -3.2, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.200000000000001, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.200000000000001, -3.2, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.2, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.5000000000000004, -3.2, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.4000000000000004, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -11.6, -3.0000000000000004, -3.3000000000000003, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.3000000000000007], "episode_lengths": [21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.496354983124967, "mean_inference_ms": 17.464331820503006, "mean_action_processing_ms": 0.9124379380593761, "mean_env_wait_ms": 2.2724799793598685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07573482317802234, "StateBufferConnector_ms": 0.009618783608461037, "ViewRequirementAgentConnector_ms": 0.13961217342278895}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 580000, "num_agent_steps_trained": 580000, "num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 580000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 580000, "timers": {"training_iteration_time_ms": 170790.672, "load_time_ms": 1.116, "load_throughput": 3582731.699, "learn_time_ms": 169819.817, "learn_throughput": 23.554, "synch_weights_time_ms": 190.425}, "counters": {"num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_agent_steps_sampled": 580000, "num_agent_steps_trained": 580000}, "done": false, "episodes_total": 29088, "training_iteration": 145, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_03-49-03", "timestamp": 1680832143, "time_this_iter_s": 170.6801462173462, "time_total_s": 24790.476554632187, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01475e20d0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7effc004f5e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 24790.476554632187, "timesteps_since_restore": 0, "iterations_since_restore": 145, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.361316872427984, "ram_util_percent": 23.806584362139926}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4276943280171324, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.36733844710453867, "policy_loss": -0.04229605844024048, "vf_loss": 0.38521376909708144, "vf_explained_var": 0.6531902931069815, "kl": 0.012704788840917861, "entropy": 3.2621012877392515, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 135315.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_agent_steps_sampled": 584000, "num_agent_steps_trained": 584000}, "sampler_results": {"episode_reward_max": 98.3, "episode_reward_min": -11.8, "episode_reward_mean": -2.699009900990099, "episode_len_mean": 20.301980198019802, "episode_media": {}, "episodes_this_iter": 202, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -11.6, -3.3000000000000007, 98.3, -10.4, -3.0000000000000004, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.5000000000000004, -3.500000000000001, -3.1000000000000005, -3.1000000000000005, -3.4, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.0000000000000004, -3.3000000000000003, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.3000000000000003, -3.600000000000001, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.2, -3.1000000000000005, -3.100000000000001, -3.0000000000000004, -3.200000000000001, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -11.6, -3.2, -3.3000000000000003, -11.5, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -10.4, -3.1000000000000005, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.2, -3.2000000000000006, -3.3000000000000003, -10.8, -3.2000000000000006, -10.7, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -11.5, -10.6, 98.0, -3.400000000000001, -3.2000000000000006, -3.5000000000000004, -3.2000000000000006, -3.1000000000000005, -3.2, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.3000000000000007, -3.2, -3.4000000000000004, -11.8, -3.1000000000000005, -10.2, -3.2000000000000006, -3.1000000000000005, -3.200000000000001, -3.0000000000000004, -3.1000000000000005, -11.5, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.6000000000000005, -3.1000000000000005, -3.200000000000001, -3.2000000000000006, -3.4000000000000004, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.0000000000000004, -3.400000000000001, -3.4000000000000004, -3.3000000000000007, -10.4, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.100000000000001, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.4000000000000004, -3.5000000000000004, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.2, -3.0000000000000004, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.4000000000000004, -3.1000000000000005, -3.4000000000000004, -3.0000000000000004, -3.4000000000000004, -3.2, -3.6000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.200000000000001, -3.4000000000000004, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.5000000000000004, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006], "episode_lengths": [21, 21, 21, 21, 21, 21, 16, 21, 16, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 16, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 7, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 3, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.499797415393678, "mean_inference_ms": 17.469332610126653, "mean_action_processing_ms": 0.9127603039676266, "mean_env_wait_ms": 2.276045890585007, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0718573532482185, "StateBufferConnector_ms": 0.009024851392991471, "ViewRequirementAgentConnector_ms": 0.13350295548391813}}, "episode_reward_max": 98.3, "episode_reward_min": -11.8, "episode_reward_mean": -2.699009900990099, "episode_len_mean": 20.301980198019802, "episodes_this_iter": 202, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -11.6, -3.3000000000000007, 98.3, -10.4, -3.0000000000000004, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.5000000000000004, -3.500000000000001, -3.1000000000000005, -3.1000000000000005, -3.4, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.0000000000000004, -3.3000000000000003, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.3000000000000003, -3.600000000000001, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.2, -3.1000000000000005, -3.100000000000001, -3.0000000000000004, -3.200000000000001, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -11.6, -3.2, -3.3000000000000003, -11.5, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -10.4, -3.1000000000000005, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.2, -3.2000000000000006, -3.3000000000000003, -10.8, -3.2000000000000006, -10.7, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -11.5, -10.6, 98.0, -3.400000000000001, -3.2000000000000006, -3.5000000000000004, -3.2000000000000006, -3.1000000000000005, -3.2, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.3000000000000007, -3.2, -3.4000000000000004, -11.8, -3.1000000000000005, -10.2, -3.2000000000000006, -3.1000000000000005, -3.200000000000001, -3.0000000000000004, -3.1000000000000005, -11.5, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.6000000000000005, -3.1000000000000005, -3.200000000000001, -3.2000000000000006, -3.4000000000000004, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.0000000000000004, -3.400000000000001, -3.4000000000000004, -3.3000000000000007, -10.4, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.100000000000001, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.4000000000000004, -3.5000000000000004, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.2, -3.0000000000000004, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.4000000000000004, -3.1000000000000005, -3.4000000000000004, -3.0000000000000004, -3.4000000000000004, -3.2, -3.6000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.200000000000001, -3.4000000000000004, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.5000000000000004, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006], "episode_lengths": [21, 21, 21, 21, 21, 21, 16, 21, 16, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 16, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 7, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 3, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.499797415393678, "mean_inference_ms": 17.469332610126653, "mean_action_processing_ms": 0.9127603039676266, "mean_env_wait_ms": 2.276045890585007, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0718573532482185, "StateBufferConnector_ms": 0.009024851392991471, "ViewRequirementAgentConnector_ms": 0.13350295548391813}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 584000, "num_agent_steps_trained": 584000, "num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 584000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 584000, "timers": {"training_iteration_time_ms": 170786.108, "load_time_ms": 1.114, "load_throughput": 3590091.586, "learn_time_ms": 169815.229, "learn_throughput": 23.555, "synch_weights_time_ms": 190.6}, "counters": {"num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_agent_steps_sampled": 584000, "num_agent_steps_trained": 584000}, "done": false, "episodes_total": 29290, "training_iteration": 146, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_03-51-54", "timestamp": 1680832314, "time_this_iter_s": 170.54763984680176, "time_total_s": 24961.02419447899, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7eff9479aee0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7effc004fe50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 24961.02419447899, "timesteps_since_restore": 0, "iterations_since_restore": 146, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.291322314049586, "ram_util_percent": 23.803305785123975}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1677673189710545, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.3585475356067701, "policy_loss": -0.03157253629898512, "vf_loss": 0.3701101232675575, "vf_explained_var": 0.6093715877943141, "kl": 0.010410093003320658, "entropy": 3.262270248833523, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 136245.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000}, "sampler_results": {"episode_reward_max": 98.4, "episode_reward_min": -12.100000000000001, "episode_reward_mean": -2.7193877551020416, "episode_len_mean": 20.474489795918366, "episode_media": {}, "episodes_this_iter": 196, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.400000000000001, -3.5000000000000004, -3.3000000000000003, 97.7, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -3.3000000000000003, -3.3000000000000003, -3.2, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.500000000000001, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -10.7, -3.3000000000000007, -3.0000000000000004, -3.100000000000001, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.300000000000001, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -11.5, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.5000000000000004, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.200000000000001, -3.1000000000000005, -12.0, -3.1000000000000005, -11.3, -3.2, -3.500000000000001, -3.2000000000000006, -11.9, -3.3000000000000003, -3.200000000000001, -3.2, -3.2000000000000006, -3.3000000000000007, -3.100000000000001, -3.4000000000000012, -3.2000000000000006, -3.2, -3.3000000000000007, -10.2, 98.4, -3.400000000000001, -3.5000000000000004, -11.0, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -3.400000000000001, -3.0000000000000004, -3.3000000000000007, -3.0000000000000004, -3.4000000000000004, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -12.100000000000001, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -10.4, -3.0000000000000004, -3.0000000000000004, -3.2, -3.100000000000001, -3.2000000000000006, -3.5000000000000004, -3.0000000000000004, -12.100000000000001, -3.2000000000000006, -3.1000000000000005, -3.100000000000001, -11.8, -3.1000000000000005, -3.2, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.4000000000000004, -3.1000000000000005, -3.2, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.3000000000000007, -3.1000000000000005, -3.500000000000001, -3.200000000000001, -3.400000000000001, -3.2000000000000006, -3.200000000000001, -3.1000000000000005, -3.5000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.2, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.100000000000001, -3.400000000000001, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -11.6, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.6000000000000005, -3.2000000000000006, -3.0000000000000004, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -11.0, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.400000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 13, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 17, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.496048013964561, "mean_inference_ms": 17.460160406432166, "mean_action_processing_ms": 0.9120161587008951, "mean_env_wait_ms": 2.273382471610823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07032496588570732, "StateBufferConnector_ms": 0.00921305345029247, "ViewRequirementAgentConnector_ms": 0.1304103403675313}}, "episode_reward_max": 98.4, "episode_reward_min": -12.100000000000001, "episode_reward_mean": -2.7193877551020416, "episode_len_mean": 20.474489795918366, "episodes_this_iter": 196, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.400000000000001, -3.5000000000000004, -3.3000000000000003, 97.7, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -3.3000000000000003, -3.3000000000000003, -3.2, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.500000000000001, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -10.7, -3.3000000000000007, -3.0000000000000004, -3.100000000000001, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.300000000000001, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -11.5, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.5000000000000004, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.200000000000001, -3.1000000000000005, -12.0, -3.1000000000000005, -11.3, -3.2, -3.500000000000001, -3.2000000000000006, -11.9, -3.3000000000000003, -3.200000000000001, -3.2, -3.2000000000000006, -3.3000000000000007, -3.100000000000001, -3.4000000000000012, -3.2000000000000006, -3.2, -3.3000000000000007, -10.2, 98.4, -3.400000000000001, -3.5000000000000004, -11.0, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -3.400000000000001, -3.0000000000000004, -3.3000000000000007, -3.0000000000000004, -3.4000000000000004, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -12.100000000000001, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -10.4, -3.0000000000000004, -3.0000000000000004, -3.2, -3.100000000000001, -3.2000000000000006, -3.5000000000000004, -3.0000000000000004, -12.100000000000001, -3.2000000000000006, -3.1000000000000005, -3.100000000000001, -11.8, -3.1000000000000005, -3.2, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.4000000000000004, -3.1000000000000005, -3.2, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.3000000000000007, -3.1000000000000005, -3.500000000000001, -3.200000000000001, -3.400000000000001, -3.2000000000000006, -3.200000000000001, -3.1000000000000005, -3.5000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.2, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.100000000000001, -3.400000000000001, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -11.6, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.6000000000000005, -3.2000000000000006, -3.0000000000000004, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -11.0, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.400000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 13, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 17, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.496048013964561, "mean_inference_ms": 17.460160406432166, "mean_action_processing_ms": 0.9120161587008951, "mean_env_wait_ms": 2.273382471610823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07032496588570732, "StateBufferConnector_ms": 0.00921305345029247, "ViewRequirementAgentConnector_ms": 0.1304103403675313}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 588000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 588000, "timers": {"training_iteration_time_ms": 170771.215, "load_time_ms": 1.126, "load_throughput": 3550959.003, "learn_time_ms": 169805.117, "learn_throughput": 23.556, "synch_weights_time_ms": 190.043}, "counters": {"num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000}, "done": false, "episodes_total": 29486, "training_iteration": 147, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_03-54-45", "timestamp": 1680832485, "time_this_iter_s": 170.94875192642212, "time_total_s": 25131.97294640541, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01475a53d0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff94701820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 25131.97294640541, "timesteps_since_restore": 0, "iterations_since_restore": 147, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.307407407407407, "ram_util_percent": 23.811934156378605}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4329944083447097, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.23264648760643897, "policy_loss": -0.029649826623837375, "vf_loss": 0.24706778179964312, "vf_explained_var": 0.6920140867592186, "kl": 0.00792258095446228, "entropy": 3.2910574033696163, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 137175.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "sampler_results": {"episode_reward_max": 98.7, "episode_reward_min": -12.0, "episode_reward_mean": -3.0939393939393947, "episode_len_mean": 20.46969696969697, "episode_media": {}, "episodes_this_iter": 198, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.4000000000000004, -3.4000000000000004, -10.1, -3.500000000000001, -3.0000000000000004, -10.9, -3.400000000000001, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -10.8, -3.2, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.500000000000001, -3.2000000000000006, -3.3000000000000007, -3.500000000000001, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -12.0, -3.2000000000000006, -3.3000000000000003, -3.200000000000001, -3.2000000000000006, -3.500000000000001, -3.3000000000000007, -3.1000000000000005, -3.5000000000000004, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.200000000000001, -3.3000000000000007, -3.5000000000000004, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -11.600000000000001, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.2, -3.400000000000001, -3.4000000000000004, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -10.9, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.2, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, -11.7, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2, -3.4000000000000004, -10.0, -3.3000000000000003, -3.5000000000000004, -3.3000000000000007, -3.300000000000001, -3.400000000000001, -11.6, -3.2000000000000006, 98.7, -3.2000000000000006, -3.1000000000000005, -3.6000000000000005, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.2, -3.300000000000001, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.4000000000000004, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -3.0000000000000004, -3.3000000000000007, -3.0000000000000004, -3.100000000000001, -3.1000000000000005, -3.1000000000000005, -3.2, -3.100000000000001, -3.400000000000001, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.4000000000000012, -3.0000000000000004, -3.200000000000001, -3.2, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -11.2, -3.1000000000000005, -3.2, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.1000000000000005], "episode_lengths": [21, 21, 21, 21, 21, 2, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 16, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.4938035433686, "mean_inference_ms": 17.459098081276522, "mean_action_processing_ms": 0.9122014696785553, "mean_env_wait_ms": 2.2758460866242247, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07027700693920405, "StateBufferConnector_ms": 0.009277131822374132, "ViewRequirementAgentConnector_ms": 0.1309535720131614}}, "episode_reward_max": 98.7, "episode_reward_min": -12.0, "episode_reward_mean": -3.0939393939393947, "episode_len_mean": 20.46969696969697, "episodes_this_iter": 198, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.4000000000000004, -3.4000000000000004, -10.1, -3.500000000000001, -3.0000000000000004, -10.9, -3.400000000000001, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -10.8, -3.2, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.500000000000001, -3.2000000000000006, -3.3000000000000007, -3.500000000000001, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -12.0, -3.2000000000000006, -3.3000000000000003, -3.200000000000001, -3.2000000000000006, -3.500000000000001, -3.3000000000000007, -3.1000000000000005, -3.5000000000000004, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.200000000000001, -3.3000000000000007, -3.5000000000000004, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -11.600000000000001, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.2, -3.400000000000001, -3.4000000000000004, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -10.9, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.2, -3.4000000000000004, -3.3000000000000007, -3.3000000000000007, -11.7, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2, -3.4000000000000004, -10.0, -3.3000000000000003, -3.5000000000000004, -3.3000000000000007, -3.300000000000001, -3.400000000000001, -11.6, -3.2000000000000006, 98.7, -3.2000000000000006, -3.1000000000000005, -3.6000000000000005, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.2, -3.300000000000001, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.4000000000000004, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -3.0000000000000004, -3.3000000000000007, -3.0000000000000004, -3.100000000000001, -3.1000000000000005, -3.1000000000000005, -3.2, -3.100000000000001, -3.400000000000001, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.4000000000000012, -3.0000000000000004, -3.200000000000001, -3.2, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -11.2, -3.1000000000000005, -3.2, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.1000000000000005], "episode_lengths": [21, 21, 21, 21, 21, 2, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 16, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.4938035433686, "mean_inference_ms": 17.459098081276522, "mean_action_processing_ms": 0.9122014696785553, "mean_env_wait_ms": 2.2758460866242247, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07027700693920405, "StateBufferConnector_ms": 0.009277131822374132, "ViewRequirementAgentConnector_ms": 0.1309535720131614}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000, "num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 592000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 592000, "timers": {"training_iteration_time_ms": 170782.62, "load_time_ms": 1.129, "load_throughput": 3544057.965, "learn_time_ms": 169825.423, "learn_throughput": 23.554, "synch_weights_time_ms": 188.71}, "counters": {"num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "done": false, "episodes_total": 29684, "training_iteration": 148, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_03-57-36", "timestamp": 1680832656, "time_this_iter_s": 170.85560512542725, "time_total_s": 25302.828551530838, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476cb4f0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff9471bd30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 25302.828551530838, "timesteps_since_restore": 0, "iterations_since_restore": 148, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.59917695473251, "ram_util_percent": 23.813991769547332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8447354799797457, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.1894631625093039, "policy_loss": -0.07774215429190105, "vf_loss": 0.2392286341682437, "vf_explained_var": 0.706693079907407, "kl": 0.014554754058581336, "entropy": 3.2585800396498814, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 138105.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_agent_steps_sampled": 596000, "num_agent_steps_trained": 596000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.100000000000001, "episode_reward_mean": -3.6880000000000006, "episode_len_mean": 20.44, "episode_media": {}, "episodes_this_iter": 200, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.5000000000000004, -3.2000000000000006, -11.700000000000001, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.500000000000001, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.2, -3.1000000000000005, -3.5000000000000004, -3.400000000000001, -3.0000000000000004, -3.2000000000000006, -3.5000000000000004, -3.1000000000000005, -3.0000000000000004, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.500000000000001, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.7000000000000006, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.5000000000000004, -3.3000000000000003, -3.0000000000000004, -3.5, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.100000000000001, -3.1000000000000005, -3.600000000000001, -10.7, -10.4, -3.400000000000001, -3.3000000000000003, -3.2, -3.3000000000000003, -3.3000000000000007, -12.100000000000001, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.500000000000001, -11.6, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.2, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.3000000000000007, -3.0000000000000004, -3.200000000000001, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -10.8, -3.2000000000000006, -3.4000000000000004, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -10.5, -3.2000000000000006, -10.4, -3.600000000000001, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -10.8, -3.2000000000000006, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.3000000000000003, -3.5000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.4000000000000012, -3.3000000000000007, -3.1000000000000005, -3.2, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.200000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.2, -3.100000000000001, -3.4000000000000004, -3.2000000000000006, -11.1, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -12.100000000000001, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.3000000000000007, -3.200000000000001, -3.100000000000001, -3.200000000000001, -11.4, -3.2000000000000006, -3.400000000000001, -3.2, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.3000000000000003, -3.3000000000000003, -3.0000000000000004, -3.3000000000000003, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.200000000000001, -3.1000000000000005, -3.2000000000000006], "episode_lengths": [21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 5, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 6, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.492688016977857, "mean_inference_ms": 17.476737877139705, "mean_action_processing_ms": 0.9127245190078801, "mean_env_wait_ms": 2.2758149944748185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08375489711761475, "StateBufferConnector_ms": 0.010680079460144043, "ViewRequirementAgentConnector_ms": 0.1514286994934082}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.100000000000001, "episode_reward_mean": -3.6880000000000006, "episode_len_mean": 20.44, "episodes_this_iter": 200, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.5000000000000004, -3.2000000000000006, -11.700000000000001, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.500000000000001, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.2, -3.1000000000000005, -3.5000000000000004, -3.400000000000001, -3.0000000000000004, -3.2000000000000006, -3.5000000000000004, -3.1000000000000005, -3.0000000000000004, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.500000000000001, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.7000000000000006, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.5000000000000004, -3.3000000000000003, -3.0000000000000004, -3.5, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.100000000000001, -3.1000000000000005, -3.600000000000001, -10.7, -10.4, -3.400000000000001, -3.3000000000000003, -3.2, -3.3000000000000003, -3.3000000000000007, -12.100000000000001, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.500000000000001, -11.6, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.2, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.3000000000000007, -3.0000000000000004, -3.200000000000001, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -10.8, -3.2000000000000006, -3.4000000000000004, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -10.5, -3.2000000000000006, -10.4, -3.600000000000001, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -10.8, -3.2000000000000006, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.3000000000000003, -3.5000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.4000000000000012, -3.3000000000000007, -3.1000000000000005, -3.2, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.200000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.2, -3.100000000000001, -3.4000000000000004, -3.2000000000000006, -11.1, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -12.100000000000001, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.3000000000000007, -3.200000000000001, -3.100000000000001, -3.200000000000001, -11.4, -3.2000000000000006, -3.400000000000001, -3.2, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.3000000000000003, -3.3000000000000003, -3.0000000000000004, -3.3000000000000003, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.200000000000001, -3.1000000000000005, -3.2000000000000006], "episode_lengths": [21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 5, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 6, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.492688016977857, "mean_inference_ms": 17.476737877139705, "mean_action_processing_ms": 0.9127245190078801, "mean_env_wait_ms": 2.2758149944748185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08375489711761475, "StateBufferConnector_ms": 0.010680079460144043, "ViewRequirementAgentConnector_ms": 0.1514286994934082}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 596000, "num_agent_steps_trained": 596000, "num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 596000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 596000, "timers": {"training_iteration_time_ms": 170800.641, "load_time_ms": 1.133, "load_throughput": 3531004.756, "learn_time_ms": 169841.94, "learn_throughput": 23.551, "synch_weights_time_ms": 184.041}, "counters": {"num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_agent_steps_sampled": 596000, "num_agent_steps_trained": 596000}, "done": false, "episodes_total": 29884, "training_iteration": 149, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_04-00-26", "timestamp": 1680832826, "time_this_iter_s": 170.78855204582214, "time_total_s": 25473.61710357666, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01473e2880>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7effc004fe50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 25473.61710357666, "timesteps_since_restore": 0, "iterations_since_restore": 149, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.745267489711935, "ram_util_percent": 23.816872427983547}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3597462939158562, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.17873009447088486, "policy_loss": -0.07698968319642928, "vf_loss": 0.22753009926778095, "vf_explained_var": 0.7072695659693852, "kl": 0.014665564577287984, "entropy": 3.2527764999738302, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 139035.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -11.8, "episode_reward_mean": -3.823857868020305, "episode_len_mean": 19.934010152284262, "episode_media": {}, "episodes_this_iter": 197, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -3.2, -3.1000000000000005, -3.200000000000001, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.3000000000000003, -3.0000000000000004, -3.3000000000000003, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.4000000000000004, -3.400000000000001, -3.3000000000000003, -3.2000000000000006, -3.4000000000000012, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -10.9, -3.1000000000000005, -3.3000000000000007, -10.5, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.300000000000001, -3.4000000000000004, -10.7, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.4000000000000004, -3.2, -3.3000000000000007, -3.1000000000000005, -11.2, -3.4000000000000004, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.400000000000001, -3.0000000000000004, -3.1000000000000005, -3.500000000000001, -3.3000000000000003, -3.400000000000001, -3.600000000000001, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.200000000000001, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.500000000000001, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -10.8, -3.400000000000001, -3.400000000000001, -11.0, -3.1000000000000005, -3.400000000000001, -3.300000000000001, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.500000000000001, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.4000000000000004, -3.2000000000000006, -3.300000000000001, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -10.7, -3.2000000000000006, -3.2000000000000006, -10.1, -3.5000000000000004, -3.2000000000000006, -3.2000000000000006, -11.0, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -11.2, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.2, -3.3000000000000003, -3.3000000000000007, -3.500000000000001, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.5000000000000004, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -10.5, -3.1000000000000005, -3.1000000000000005, -11.8, -3.0000000000000004, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -10.3, -10.0, -3.2000000000000006, -3.2, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -10.1, -10.4], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 2, 21, 21, 21, 11, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 19, 21, 21, 21, 21, 4, 1, 21, 21, 21, 21, 21, 2, 5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.492368992728256, "mean_inference_ms": 17.467442480044852, "mean_action_processing_ms": 0.9126283543044847, "mean_env_wait_ms": 2.2784612105715856, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08165328030658857, "StateBufferConnector_ms": 0.010986860633501547, "ViewRequirementAgentConnector_ms": 0.1516965440082066}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -11.8, "episode_reward_mean": -3.823857868020305, "episode_len_mean": 19.934010152284262, "episodes_this_iter": 197, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -3.2, -3.1000000000000005, -3.200000000000001, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.3000000000000003, -3.0000000000000004, -3.3000000000000003, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.4000000000000004, -3.400000000000001, -3.3000000000000003, -3.2000000000000006, -3.4000000000000012, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -10.9, -3.1000000000000005, -3.3000000000000007, -10.5, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.300000000000001, -3.4000000000000004, -10.7, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.4000000000000004, -3.2, -3.3000000000000007, -3.1000000000000005, -11.2, -3.4000000000000004, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.400000000000001, -3.0000000000000004, -3.1000000000000005, -3.500000000000001, -3.3000000000000003, -3.400000000000001, -3.600000000000001, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.200000000000001, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.500000000000001, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -10.8, -3.400000000000001, -3.400000000000001, -11.0, -3.1000000000000005, -3.400000000000001, -3.300000000000001, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.500000000000001, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.4000000000000004, -3.2000000000000006, -3.300000000000001, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -10.7, -3.2000000000000006, -3.2000000000000006, -10.1, -3.5000000000000004, -3.2000000000000006, -3.2000000000000006, -11.0, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -11.2, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.2, -3.3000000000000003, -3.3000000000000007, -3.500000000000001, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.5000000000000004, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -10.5, -3.1000000000000005, -3.1000000000000005, -11.8, -3.0000000000000004, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -10.3, -10.0, -3.2000000000000006, -3.2, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -10.1, -10.4], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 2, 21, 21, 21, 11, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 19, 21, 21, 21, 21, 4, 1, 21, 21, 21, 21, 21, 2, 5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.492368992728256, "mean_inference_ms": 17.467442480044852, "mean_action_processing_ms": 0.9126283543044847, "mean_env_wait_ms": 2.2784612105715856, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08165328030658857, "StateBufferConnector_ms": 0.010986860633501547, "ViewRequirementAgentConnector_ms": 0.1516965440082066}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 600000, "timers": {"training_iteration_time_ms": 170735.248, "load_time_ms": 1.14, "load_throughput": 3509437.309, "learn_time_ms": 169778.936, "learn_throughput": 23.56, "synch_weights_time_ms": 181.329}, "counters": {"num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "done": false, "episodes_total": 30081, "training_iteration": 150, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_04-03-17", "timestamp": 1680832997, "time_this_iter_s": 170.3935968875885, "time_total_s": 25644.01070046425, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7eff946f6b20>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff94701820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 25644.01070046425, "timesteps_since_restore": 0, "iterations_since_restore": 150, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.8312757201646095, "ram_util_percent": 23.811522633744868}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7108721007903418, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.08117918703324532, "policy_loss": -0.0763924092167027, "vf_loss": 0.13178310086650233, "vf_explained_var": 0.8335240708884373, "kl": 0.013416358522422392, "entropy": 3.2567727916984146, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 139965.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 604000, "num_env_steps_trained": 604000, "num_agent_steps_sampled": 604000, "num_agent_steps_trained": 604000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.0, "episode_reward_mean": -3.436410256410257, "episode_len_mean": 20.656410256410258, "episode_media": {}, "episodes_this_iter": 195, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.400000000000001, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.200000000000001, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.100000000000001, -3.300000000000001, -3.300000000000001, -3.1000000000000005, -3.1000000000000005, -3.300000000000001, -3.1000000000000005, -3.3000000000000003, -3.5000000000000004, -3.2000000000000006, -3.2, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.200000000000001, -3.2000000000000006, -3.2000000000000006, -3.300000000000001, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -10.3, -3.2000000000000006, -3.3000000000000007, -3.100000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -11.2, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.5000000000000004, -3.200000000000001, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.500000000000001, -3.2, -3.1000000000000005, -3.3000000000000007, -3.100000000000001, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -10.4, -3.2, -3.3000000000000007, -3.2000000000000006, -3.100000000000001, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.3000000000000003, -3.500000000000001, -3.400000000000001, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.5000000000000004, -3.100000000000001, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -12.0, -3.1000000000000005, -3.0000000000000004, -3.5000000000000004, -3.500000000000001, -10.8, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.2, -3.1000000000000005, -3.1000000000000005, -3.100000000000001, -3.1000000000000005, -3.3000000000000003, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.200000000000001, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -10.9, -3.1000000000000005, -3.3000000000000003, -3.4000000000000004, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.6000000000000005, -3.2, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.5, -3.1000000000000005, -3.4000000000000004, -3.2, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.500000000000001, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.527071688319056, "mean_inference_ms": 17.533469021855076, "mean_action_processing_ms": 0.9147275856964852, "mean_env_wait_ms": 2.282429622935425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09802561539870042, "StateBufferConnector_ms": 0.012874236473670373, "ViewRequirementAgentConnector_ms": 0.17334559024908605}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.0, "episode_reward_mean": -3.436410256410257, "episode_len_mean": 20.656410256410258, "episodes_this_iter": 195, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.400000000000001, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.200000000000001, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.100000000000001, -3.300000000000001, -3.300000000000001, -3.1000000000000005, -3.1000000000000005, -3.300000000000001, -3.1000000000000005, -3.3000000000000003, -3.5000000000000004, -3.2000000000000006, -3.2, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.200000000000001, -3.2000000000000006, -3.2000000000000006, -3.300000000000001, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -10.3, -3.2000000000000006, -3.3000000000000007, -3.100000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -11.2, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.5000000000000004, -3.200000000000001, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.500000000000001, -3.2, -3.1000000000000005, -3.3000000000000007, -3.100000000000001, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -10.4, -3.2, -3.3000000000000007, -3.2000000000000006, -3.100000000000001, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.3000000000000003, -3.500000000000001, -3.400000000000001, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.5000000000000004, -3.100000000000001, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -12.0, -3.1000000000000005, -3.0000000000000004, -3.5000000000000004, -3.500000000000001, -10.8, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.2, -3.1000000000000005, -3.1000000000000005, -3.100000000000001, -3.1000000000000005, -3.3000000000000003, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.200000000000001, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -10.9, -3.1000000000000005, -3.3000000000000003, -3.4000000000000004, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.6000000000000005, -3.2, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.5, -3.1000000000000005, -3.4000000000000004, -3.2, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.500000000000001, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.527071688319056, "mean_inference_ms": 17.533469021855076, "mean_action_processing_ms": 0.9147275856964852, "mean_env_wait_ms": 2.282429622935425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09802561539870042, "StateBufferConnector_ms": 0.012874236473670373, "ViewRequirementAgentConnector_ms": 0.17334559024908605}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 604000, "num_agent_steps_trained": 604000, "num_env_steps_sampled": 604000, "num_env_steps_trained": 604000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 604000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 604000, "timers": {"training_iteration_time_ms": 170790.592, "load_time_ms": 1.186, "load_throughput": 3372982.71, "learn_time_ms": 169776.48, "learn_throughput": 23.56, "synch_weights_time_ms": 183.149}, "counters": {"num_env_steps_sampled": 604000, "num_env_steps_trained": 604000, "num_agent_steps_sampled": 604000, "num_agent_steps_trained": 604000}, "done": false, "episodes_total": 30276, "training_iteration": 151, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_04-06-08", "timestamp": 1680833168, "time_this_iter_s": 171.3891863822937, "time_total_s": 25815.399886846542, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0147423a60>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff94727d30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 25815.399886846542, "timesteps_since_restore": 0, "iterations_since_restore": 151, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.709876543209877, "ram_util_percent": 23.817695473251035}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.513746781679251, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.09352551690573173, "policy_loss": -0.07269058234398804, "vf_loss": 0.1407027174398223, "vf_explained_var": 0.7841092232734926, "kl": 0.013273232026177117, "entropy": 3.2296472134128695, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 140895.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.0, "episode_reward_mean": -3.526701570680629, "episode_len_mean": 20.602094240837697, "episode_media": {}, "episodes_this_iter": 191, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.5000000000000004, -3.3000000000000003, -11.9, -3.2000000000000006, -11.6, -3.2000000000000006, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.2, -3.3000000000000007, -3.2000000000000006, -3.5000000000000004, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.0000000000000004, -11.7, -3.3000000000000007, -3.100000000000001, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -12.0, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.2, -3.1000000000000005, -3.0000000000000004, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.100000000000001, -3.300000000000001, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -10.0, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.500000000000001, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.0000000000000004, -3.0000000000000004, -3.3000000000000003, -3.2, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2, -3.0000000000000004, -11.0, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.200000000000001, -3.400000000000001, -3.200000000000001, -10.5, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -10.2, -3.0000000000000004, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.3000000000000003, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.200000000000001, -3.4000000000000004, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.2, -3.2000000000000006, -3.0000000000000004, -3.100000000000001, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.2, -3.3000000000000007, -3.3000000000000007, -3.4000000000000012, -3.1000000000000005, -3.1000000000000005], "episode_lengths": [21, 21, 21, 21, 21, 21, 20, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.524824688382473, "mean_inference_ms": 17.525642641457626, "mean_action_processing_ms": 0.9146128303043152, "mean_env_wait_ms": 2.2825029263131187, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07891617520317357, "StateBufferConnector_ms": 0.00970450995480203, "ViewRequirementAgentConnector_ms": 0.14396762348594466}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.0, "episode_reward_mean": -3.526701570680629, "episode_len_mean": 20.602094240837697, "episodes_this_iter": 191, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.5000000000000004, -3.3000000000000003, -11.9, -3.2000000000000006, -11.6, -3.2000000000000006, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.2, -3.3000000000000007, -3.2000000000000006, -3.5000000000000004, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.0000000000000004, -11.7, -3.3000000000000007, -3.100000000000001, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -12.0, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.2, -3.1000000000000005, -3.0000000000000004, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.100000000000001, -3.300000000000001, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -10.0, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.500000000000001, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.0000000000000004, -3.0000000000000004, -3.3000000000000003, -3.2, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2, -3.0000000000000004, -11.0, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.200000000000001, -3.400000000000001, -3.200000000000001, -10.5, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -10.2, -3.0000000000000004, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.3000000000000003, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.200000000000001, -3.4000000000000004, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.2, -3.2000000000000006, -3.0000000000000004, -3.100000000000001, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.2, -3.3000000000000007, -3.3000000000000007, -3.4000000000000012, -3.1000000000000005, -3.1000000000000005], "episode_lengths": [21, 21, 21, 21, 21, 21, 20, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.524824688382473, "mean_inference_ms": 17.525642641457626, "mean_action_processing_ms": 0.9146128303043152, "mean_env_wait_ms": 2.2825029263131187, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07891617520317357, "StateBufferConnector_ms": 0.00970450995480203, "ViewRequirementAgentConnector_ms": 0.14396762348594466}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000, "num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 608000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 608000, "timers": {"training_iteration_time_ms": 170782.998, "load_time_ms": 1.19, "load_throughput": 3362032.784, "learn_time_ms": 169767.003, "learn_throughput": 23.562, "synch_weights_time_ms": 183.982}, "counters": {"num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "done": false, "episodes_total": 30467, "training_iteration": 152, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_04-08-59", "timestamp": 1680833339, "time_this_iter_s": 170.55105710029602, "time_total_s": 25985.95094394684, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0147659c10>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff946d0dc0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 25985.95094394684, "timesteps_since_restore": 0, "iterations_since_restore": 152, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.253086419753086, "ram_util_percent": 23.802880658436223}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5985428585801074, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.19094397847450548, "policy_loss": -0.08299639400254975, "vf_loss": 0.24773005696003556, "vf_explained_var": 0.6889092840815103, "kl": 0.013635808992592658, "entropy": 3.2459200630905807, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 141825.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -11.9, "episode_reward_mean": -3.719597989949749, "episode_len_mean": 20.236180904522612, "episode_media": {}, "episodes_this_iter": 199, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.400000000000001, -3.4000000000000004, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.0000000000000004, -3.2, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.300000000000001, -3.3000000000000007, -3.2, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -10.9, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.2, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.3000000000000003, -3.3000000000000003, -3.200000000000001, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.100000000000001, -3.1000000000000005, -3.2, -11.0, -3.1000000000000005, -3.400000000000001, -3.5000000000000004, -3.6000000000000005, -3.600000000000001, -3.200000000000001, -3.400000000000001, -11.9, -11.700000000000001, -3.2000000000000006, -3.2, -10.0, -3.2000000000000006, -3.400000000000001, -3.3000000000000003, -3.3000000000000003, -3.2000000000000006, -3.3000000000000003, -10.6, -3.1000000000000005, -3.2, -3.4000000000000004, -3.4000000000000012, -3.2000000000000006, -3.2, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.0000000000000004, -3.3000000000000007, -3.400000000000001, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -10.7, -3.200000000000001, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.2, -3.200000000000001, -3.0000000000000004, -3.0000000000000004, -3.0000000000000004, -3.4000000000000004, -3.2000000000000006, -3.2, -3.1000000000000005, -3.5000000000000004, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.500000000000001, -3.3000000000000003, -3.3000000000000007, -11.7, -3.0000000000000004, -3.2000000000000006, -3.500000000000001, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.0000000000000004, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.2, -3.0000000000000004, -3.300000000000001, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.500000000000001, -3.6000000000000005, -3.2000000000000006, -3.4000000000000004, -3.3000000000000003, -3.3000000000000007, -10.0, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.0000000000000004, -3.3000000000000003, -3.300000000000001, -3.400000000000001, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -11.0, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.2, -3.1000000000000005, -3.200000000000001, -3.200000000000001, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.3000000000000007, -11.2, -3.400000000000001, -3.200000000000001, -3.1000000000000005, -3.400000000000001, -3.2, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.200000000000001, -3.1000000000000005, -3.4000000000000004, -3.4000000000000004, -3.300000000000001, -3.0000000000000004, -10.8, -3.400000000000001, -10.1, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 19, 16, 21, 21, 1, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 2, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.524818969344453, "mean_inference_ms": 17.535215532671526, "mean_action_processing_ms": 0.9155400733362653, "mean_env_wait_ms": 2.285213325123377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07431303436432651, "StateBufferConnector_ms": 0.009477917273439954, "ViewRequirementAgentConnector_ms": 0.13775549941326506}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -11.9, "episode_reward_mean": -3.719597989949749, "episode_len_mean": 20.236180904522612, "episodes_this_iter": 199, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.400000000000001, -3.4000000000000004, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.0000000000000004, -3.2, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.300000000000001, -3.3000000000000007, -3.2, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -10.9, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.2, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.3000000000000003, -3.3000000000000003, -3.200000000000001, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.100000000000001, -3.1000000000000005, -3.2, -11.0, -3.1000000000000005, -3.400000000000001, -3.5000000000000004, -3.6000000000000005, -3.600000000000001, -3.200000000000001, -3.400000000000001, -11.9, -11.700000000000001, -3.2000000000000006, -3.2, -10.0, -3.2000000000000006, -3.400000000000001, -3.3000000000000003, -3.3000000000000003, -3.2000000000000006, -3.3000000000000003, -10.6, -3.1000000000000005, -3.2, -3.4000000000000004, -3.4000000000000012, -3.2000000000000006, -3.2, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.0000000000000004, -3.3000000000000007, -3.400000000000001, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -10.7, -3.200000000000001, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.2, -3.200000000000001, -3.0000000000000004, -3.0000000000000004, -3.0000000000000004, -3.4000000000000004, -3.2000000000000006, -3.2, -3.1000000000000005, -3.5000000000000004, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.500000000000001, -3.3000000000000003, -3.3000000000000007, -11.7, -3.0000000000000004, -3.2000000000000006, -3.500000000000001, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.0000000000000004, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.2, -3.0000000000000004, -3.300000000000001, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.500000000000001, -3.6000000000000005, -3.2000000000000006, -3.4000000000000004, -3.3000000000000003, -3.3000000000000007, -10.0, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.0000000000000004, -3.3000000000000003, -3.300000000000001, -3.400000000000001, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -11.0, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.2, -3.1000000000000005, -3.200000000000001, -3.200000000000001, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.3000000000000007, -11.2, -3.400000000000001, -3.200000000000001, -3.1000000000000005, -3.400000000000001, -3.2, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.200000000000001, -3.1000000000000005, -3.4000000000000004, -3.4000000000000004, -3.300000000000001, -3.0000000000000004, -10.8, -3.400000000000001, -10.1, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 19, 16, 21, 21, 1, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 2, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.524818969344453, "mean_inference_ms": 17.535215532671526, "mean_action_processing_ms": 0.9155400733362653, "mean_env_wait_ms": 2.285213325123377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07431303436432651, "StateBufferConnector_ms": 0.009477917273439954, "ViewRequirementAgentConnector_ms": 0.13775549941326506}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 612000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 612000, "timers": {"training_iteration_time_ms": 170788.261, "load_time_ms": 1.191, "load_throughput": 3359272.771, "learn_time_ms": 169769.471, "learn_throughput": 23.561, "synch_weights_time_ms": 184.61}, "counters": {"num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "done": false, "episodes_total": 30666, "training_iteration": 153, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_04-11-50", "timestamp": 1680833510, "time_this_iter_s": 170.77251291275024, "time_total_s": 26156.72345685959, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f014746ebe0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7effc004fe50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 26156.72345685959, "timesteps_since_restore": 0, "iterations_since_restore": 153, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.3543209876543205, "ram_util_percent": 23.827983539094657}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3349836150164245, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.15121837009185105, "policy_loss": -0.07390426742914383, "vf_loss": 0.19942285386364786, "vf_explained_var": 0.736067977323327, "kl": 0.013370206531935862, "entropy": 3.2172716209965366, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 142755.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_agent_steps_sampled": 616000, "num_agent_steps_trained": 616000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -11.8, "episode_reward_mean": -3.605729166666667, "episode_len_mean": 20.572916666666668, "episode_media": {}, "episodes_this_iter": 192, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.3, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.100000000000001, -3.2, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.100000000000001, -3.1000000000000005, -3.2000000000000006, -11.600000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.300000000000001, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.200000000000001, -3.3000000000000007, -3.2000000000000006, -3.2, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.5000000000000004, -3.1000000000000005, -3.2000000000000006, -3.2, -3.0000000000000004, -3.1000000000000005, -3.2, -3.200000000000001, -3.2, -3.4000000000000004, -3.0000000000000004, -3.100000000000001, -3.4000000000000004, -3.1000000000000005, -3.0000000000000004, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.100000000000001, -3.1000000000000005, -3.0000000000000004, -3.400000000000001, -3.3000000000000003, -3.2000000000000006, -11.8, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.2, -3.100000000000001, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -11.6, -3.2000000000000006, -10.8, -3.3000000000000007, -3.100000000000001, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.200000000000001, -11.2, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.200000000000001, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.300000000000001, -3.3000000000000007, -11.6, -3.1000000000000005, -3.2, -3.2000000000000006, -10.8, -3.2000000000000006, -3.3000000000000007, -3.300000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.5000000000000004, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.0000000000000004, -3.0000000000000004, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.2, -3.1000000000000005, -3.1000000000000005, -3.4000000000000004, -3.3000000000000007, -3.7000000000000006, -3.2000000000000006, -3.500000000000001, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -3.200000000000001, -11.5, -10.0, -3.2000000000000006, -3.100000000000001, -3.200000000000001, -3.3000000000000003, -3.2000000000000006, -3.200000000000001, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006], "episode_lengths": [14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.521698000149128, "mean_inference_ms": 17.549258872123424, "mean_action_processing_ms": 0.9157976802036667, "mean_env_wait_ms": 2.287271178966217, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07455175121625264, "StateBufferConnector_ms": 0.009543200333913168, "ViewRequirementAgentConnector_ms": 0.1375500112771988}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -11.8, "episode_reward_mean": -3.605729166666667, "episode_len_mean": 20.572916666666668, "episodes_this_iter": 192, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11.3, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.100000000000001, -3.2, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.100000000000001, -3.1000000000000005, -3.2000000000000006, -11.600000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.300000000000001, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.200000000000001, -3.3000000000000007, -3.2000000000000006, -3.2, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.5000000000000004, -3.1000000000000005, -3.2000000000000006, -3.2, -3.0000000000000004, -3.1000000000000005, -3.2, -3.200000000000001, -3.2, -3.4000000000000004, -3.0000000000000004, -3.100000000000001, -3.4000000000000004, -3.1000000000000005, -3.0000000000000004, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.100000000000001, -3.1000000000000005, -3.0000000000000004, -3.400000000000001, -3.3000000000000003, -3.2000000000000006, -11.8, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.2, -3.100000000000001, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -11.6, -3.2000000000000006, -10.8, -3.3000000000000007, -3.100000000000001, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.200000000000001, -11.2, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.200000000000001, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.300000000000001, -3.3000000000000007, -11.6, -3.1000000000000005, -3.2, -3.2000000000000006, -10.8, -3.2000000000000006, -3.3000000000000007, -3.300000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.5000000000000004, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.0000000000000004, -3.0000000000000004, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.2, -3.1000000000000005, -3.1000000000000005, -3.4000000000000004, -3.3000000000000007, -3.7000000000000006, -3.2000000000000006, -3.500000000000001, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -3.200000000000001, -11.5, -10.0, -3.2000000000000006, -3.100000000000001, -3.200000000000001, -3.3000000000000003, -3.2000000000000006, -3.200000000000001, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006], "episode_lengths": [14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.521698000149128, "mean_inference_ms": 17.549258872123424, "mean_action_processing_ms": 0.9157976802036667, "mean_env_wait_ms": 2.287271178966217, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07455175121625264, "StateBufferConnector_ms": 0.009543200333913168, "ViewRequirementAgentConnector_ms": 0.1375500112771988}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 616000, "num_agent_steps_trained": 616000, "num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 616000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 616000, "timers": {"training_iteration_time_ms": 170762.516, "load_time_ms": 1.196, "load_throughput": 3343406.935, "learn_time_ms": 169742.568, "learn_throughput": 23.565, "synch_weights_time_ms": 181.123}, "counters": {"num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_agent_steps_sampled": 616000, "num_agent_steps_trained": 616000}, "done": false, "episodes_total": 30858, "training_iteration": 154, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_04-14-41", "timestamp": 1680833681, "time_this_iter_s": 170.81099843978882, "time_total_s": 26327.534455299377, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7eff946e74f0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff946cf820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 26327.534455299377, "timesteps_since_restore": 0, "iterations_since_restore": 154, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.342798353909465, "ram_util_percent": 23.88559670781893}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4048384095872601, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.11965937244115017, "policy_loss": -0.07545029452290906, "vf_loss": 0.16973186413737473, "vf_explained_var": 0.7724755456370692, "kl": 0.013202698652567442, "entropy": 3.2215216523857526, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 143685.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 620000, "num_env_steps_trained": 620000, "num_agent_steps_sampled": 620000, "num_agent_steps_trained": 620000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.100000000000001, "episode_reward_mean": -3.5921875, "episode_len_mean": 20.4375, "episode_media": {}, "episodes_this_iter": 192, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.400000000000001, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.4000000000000004, -3.0000000000000004, -3.300000000000001, -12.0, -3.4000000000000004, -3.2, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.2, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.4000000000000004, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2, -3.2, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -11.700000000000001, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2, -3.2, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2, -3.1000000000000005, -3.100000000000001, -3.3000000000000003, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.100000000000001, -3.2000000000000006, -10.0, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.2, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.3000000000000003, -3.500000000000001, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -11.3, -3.3000000000000003, -3.3000000000000007, -3.100000000000001, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.2, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.200000000000001, -3.0000000000000004, -3.0000000000000004, -3.3000000000000007, -11.0, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.300000000000001, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.2, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -10.5, -10.0, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.400000000000001, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.2, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.4000000000000004, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.2, -3.4000000000000012, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2, -3.500000000000001, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.2, -3.4000000000000004, -3.3000000000000007, -3.2, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.0000000000000004, -3.100000000000001, -3.3000000000000007, -3.6000000000000005, -3.2, -3.2000000000000006, -3.2000000000000006, -10.6, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.100000000000001, -3.2000000000000006, -3.3000000000000007, -10.4, -12.100000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 5, 20]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.520988770903253, "mean_inference_ms": 17.527866168351093, "mean_action_processing_ms": 0.9146013670450485, "mean_env_wait_ms": 2.2846967675449332, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0736631453037262, "StateBufferConnector_ms": 0.00920034945011139, "ViewRequirementAgentConnector_ms": 0.1369199405113856}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.100000000000001, "episode_reward_mean": -3.5921875, "episode_len_mean": 20.4375, "episodes_this_iter": 192, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.400000000000001, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.4000000000000004, -3.0000000000000004, -3.300000000000001, -12.0, -3.4000000000000004, -3.2, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.2, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.4000000000000004, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2, -3.2, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -11.700000000000001, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2, -3.2, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2, -3.1000000000000005, -3.100000000000001, -3.3000000000000003, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.100000000000001, -3.2000000000000006, -10.0, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.2, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.3000000000000003, -3.500000000000001, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -11.3, -3.3000000000000003, -3.3000000000000007, -3.100000000000001, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.2, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.200000000000001, -3.0000000000000004, -3.0000000000000004, -3.3000000000000007, -11.0, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.300000000000001, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.2, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -10.5, -10.0, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.400000000000001, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.2, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.4000000000000004, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.2, -3.4000000000000012, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2, -3.500000000000001, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.2, -3.4000000000000004, -3.3000000000000007, -3.2, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.0000000000000004, -3.100000000000001, -3.3000000000000007, -3.6000000000000005, -3.2, -3.2000000000000006, -3.2000000000000006, -10.6, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.100000000000001, -3.2000000000000006, -3.3000000000000007, -10.4, -12.100000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 5, 20]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.520988770903253, "mean_inference_ms": 17.527866168351093, "mean_action_processing_ms": 0.9146013670450485, "mean_env_wait_ms": 2.2846967675449332, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0736631453037262, "StateBufferConnector_ms": 0.00920034945011139, "ViewRequirementAgentConnector_ms": 0.1369199405113856}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 620000, "num_agent_steps_trained": 620000, "num_env_steps_sampled": 620000, "num_env_steps_trained": 620000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 620000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 620000, "timers": {"training_iteration_time_ms": 170793.936, "load_time_ms": 1.198, "load_throughput": 3339480.483, "learn_time_ms": 169774.451, "learn_throughput": 23.561, "synch_weights_time_ms": 182.641}, "counters": {"num_env_steps_sampled": 620000, "num_env_steps_trained": 620000, "num_agent_steps_sampled": 620000, "num_agent_steps_trained": 620000}, "done": false, "episodes_total": 31050, "training_iteration": 155, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_04-17-32", "timestamp": 1680833852, "time_this_iter_s": 170.99504566192627, "time_total_s": 26498.529500961304, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7eff9479af70>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7effc004fe50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 26498.529500961304, "timesteps_since_restore": 0, "iterations_since_restore": 155, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.617695473251028, "ram_util_percent": 23.896296296296292}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3309074172089177, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": -0.01842628987906601, "policy_loss": -0.10055644529851614, "vf_loss": 0.05806936503648357, "vf_explained_var": 0.8235744928160021, "kl": 0.012517526753682402, "entropy": 3.199067070663616, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 144615.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.0, "episode_reward_mean": -3.4747368421052633, "episode_len_mean": 20.568421052631578, "episode_media": {}, "episodes_this_iter": 190, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.2000000000000006, -3.100000000000001, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.100000000000001, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.5000000000000004, -3.1000000000000005, -3.500000000000001, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.300000000000001, -3.3000000000000003, -3.3000000000000007, -10.2, -3.1000000000000005, -3.100000000000001, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.2, -3.1000000000000005, -3.3000000000000007, -3.2, -3.0000000000000004, -3.2000000000000006, -3.2, -3.1000000000000005, -3.4000000000000004, -3.3000000000000003, -3.200000000000001, -3.5000000000000004, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -11.8, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.500000000000001, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2, -3.2000000000000006, -3.300000000000001, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -11.0, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.2, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.400000000000001, -10.3, -3.1000000000000005, -3.1000000000000005, -3.5000000000000004, -3.0000000000000004, -10.4, -3.0000000000000004, -3.4000000000000004, -3.3000000000000003, -3.3000000000000003, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.200000000000001, -3.2000000000000006, -3.3000000000000007, -3.100000000000001, -3.3000000000000007, -3.3000000000000003, -3.0000000000000004, -3.2, -3.3000000000000007, -3.2000000000000006, -3.2, -3.200000000000001, -3.100000000000001, -3.1000000000000005, -3.200000000000001, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2, -3.0000000000000004, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.100000000000001, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.3000000000000003, -3.4000000000000004, -3.2, -3.400000000000001, -3.4000000000000004, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.2, -3.3000000000000007, -3.5000000000000004, -3.3000000000000003, -3.100000000000001, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.3000000000000003, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.4, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -10.3, -3.2000000000000006, -3.2, -3.0000000000000004, -3.400000000000001, -12.0, -3.0000000000000004, -3.3000000000000007], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 19, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.520255998430589, "mean_inference_ms": 17.54593747259483, "mean_action_processing_ms": 0.9152464413192978, "mean_env_wait_ms": 2.289525270321315, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07283198206048262, "StateBufferConnector_ms": 0.00978457300286544, "ViewRequirementAgentConnector_ms": 0.1347267000298751}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.0, "episode_reward_mean": -3.4747368421052633, "episode_len_mean": 20.568421052631578, "episodes_this_iter": 190, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.2000000000000006, -3.100000000000001, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.100000000000001, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.5000000000000004, -3.1000000000000005, -3.500000000000001, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.300000000000001, -3.3000000000000003, -3.3000000000000007, -10.2, -3.1000000000000005, -3.100000000000001, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.2, -3.1000000000000005, -3.3000000000000007, -3.2, -3.0000000000000004, -3.2000000000000006, -3.2, -3.1000000000000005, -3.4000000000000004, -3.3000000000000003, -3.200000000000001, -3.5000000000000004, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -11.8, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.500000000000001, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2, -3.2000000000000006, -3.300000000000001, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -11.0, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.2, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.400000000000001, -10.3, -3.1000000000000005, -3.1000000000000005, -3.5000000000000004, -3.0000000000000004, -10.4, -3.0000000000000004, -3.4000000000000004, -3.3000000000000003, -3.3000000000000003, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.200000000000001, -3.2000000000000006, -3.3000000000000007, -3.100000000000001, -3.3000000000000007, -3.3000000000000003, -3.0000000000000004, -3.2, -3.3000000000000007, -3.2000000000000006, -3.2, -3.200000000000001, -3.100000000000001, -3.1000000000000005, -3.200000000000001, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2, -3.0000000000000004, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.100000000000001, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.3000000000000003, -3.4000000000000004, -3.2, -3.400000000000001, -3.4000000000000004, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.2, -3.3000000000000007, -3.5000000000000004, -3.3000000000000003, -3.100000000000001, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.3000000000000003, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.4, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -10.3, -3.2000000000000006, -3.2, -3.0000000000000004, -3.400000000000001, -12.0, -3.0000000000000004, -3.3000000000000007], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 19, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.520255998430589, "mean_inference_ms": 17.54593747259483, "mean_action_processing_ms": 0.9152464413192978, "mean_env_wait_ms": 2.289525270321315, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07283198206048262, "StateBufferConnector_ms": 0.00978457300286544, "ViewRequirementAgentConnector_ms": 0.1347267000298751}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 624000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 170831.353, "load_time_ms": 1.207, "load_throughput": 3315196.712, "learn_time_ms": 169819.37, "learn_throughput": 23.554, "synch_weights_time_ms": 176.124}, "counters": {"num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "done": false, "episodes_total": 31240, "training_iteration": 156, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_04-20-23", "timestamp": 1680834023, "time_this_iter_s": 170.92400360107422, "time_total_s": 26669.453504562378, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01473e23d0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff946cf940>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 26669.453504562378, "timesteps_since_restore": 0, "iterations_since_restore": 156, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.3312757201646095, "ram_util_percent": 23.900411522633743}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4420861718795632, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.09342574582545347, "policy_loss": -0.07049471164893319, "vf_loss": 0.13746342595906988, "vf_explained_var": 0.8524119223317792, "kl": 0.013764161614623542, "entropy": 3.17550532843477, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 145545.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 628000, "num_env_steps_trained": 628000, "num_agent_steps_sampled": 628000, "num_agent_steps_trained": 628000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -11.700000000000001, "episode_reward_mean": -3.3439393939393947, "episode_len_mean": 20.818181818181817, "episode_media": {}, "episodes_this_iter": 198, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0000000000000004, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.100000000000001, -3.6000000000000005, -10.8, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2, -3.2000000000000006, -3.200000000000001, -3.4000000000000004, -3.1000000000000005, -3.500000000000001, -3.200000000000001, -3.1000000000000005, -3.100000000000001, -3.100000000000001, -3.1000000000000005, -3.200000000000001, -3.2000000000000006, -3.600000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.100000000000001, -3.2, -3.2, -3.500000000000001, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.5000000000000004, -3.1000000000000005, -3.2, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.100000000000001, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.2, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.100000000000001, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.6000000000000005, -3.3000000000000007, -3.3000000000000007, -3.0000000000000004, -11.1, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.100000000000001, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.100000000000001, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.0000000000000004, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.0000000000000004, -3.4000000000000004, -3.0000000000000004, -3.2, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.2, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -11.700000000000001, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.100000000000001, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.500000000000001, -3.200000000000001, -3.1000000000000005, -3.0000000000000004, -3.2, -3.3000000000000007, -3.3000000000000003, -3.1000000000000005, -3.3000000000000003, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.300000000000001, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -11.0, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006], "episode_lengths": [21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.515224733603809, "mean_inference_ms": 17.53432389484635, "mean_action_processing_ms": 0.9153164224445315, "mean_env_wait_ms": 2.285222695315663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0749402576022678, "StateBufferConnector_ms": 0.010261029908151337, "ViewRequirementAgentConnector_ms": 0.13913518250590623}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -11.700000000000001, "episode_reward_mean": -3.3439393939393947, "episode_len_mean": 20.818181818181817, "episodes_this_iter": 198, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.0000000000000004, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.100000000000001, -3.6000000000000005, -10.8, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2, -3.2000000000000006, -3.200000000000001, -3.4000000000000004, -3.1000000000000005, -3.500000000000001, -3.200000000000001, -3.1000000000000005, -3.100000000000001, -3.100000000000001, -3.1000000000000005, -3.200000000000001, -3.2000000000000006, -3.600000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.100000000000001, -3.2, -3.2, -3.500000000000001, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.5000000000000004, -3.1000000000000005, -3.2, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.100000000000001, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.2, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.100000000000001, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.6000000000000005, -3.3000000000000007, -3.3000000000000007, -3.0000000000000004, -11.1, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.100000000000001, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.100000000000001, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.0000000000000004, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.0000000000000004, -3.4000000000000004, -3.0000000000000004, -3.2, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.2, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -11.700000000000001, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.100000000000001, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.500000000000001, -3.200000000000001, -3.1000000000000005, -3.0000000000000004, -3.2, -3.3000000000000007, -3.3000000000000003, -3.1000000000000005, -3.3000000000000003, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.300000000000001, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -11.0, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006], "episode_lengths": [21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.515224733603809, "mean_inference_ms": 17.53432389484635, "mean_action_processing_ms": 0.9153164224445315, "mean_env_wait_ms": 2.285222695315663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0749402576022678, "StateBufferConnector_ms": 0.010261029908151337, "ViewRequirementAgentConnector_ms": 0.13913518250590623}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 628000, "num_agent_steps_trained": 628000, "num_env_steps_sampled": 628000, "num_env_steps_trained": 628000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 628000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 628000, "timers": {"training_iteration_time_ms": 170841.988, "load_time_ms": 1.19, "load_throughput": 3361830.678, "learn_time_ms": 169816.097, "learn_throughput": 23.555, "synch_weights_time_ms": 177.312}, "counters": {"num_env_steps_sampled": 628000, "num_env_steps_trained": 628000, "num_agent_steps_sampled": 628000, "num_agent_steps_trained": 628000}, "done": false, "episodes_total": 31438, "training_iteration": 157, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_04-23-14", "timestamp": 1680834194, "time_this_iter_s": 171.05591750144958, "time_total_s": 26840.509422063828, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0147569fa0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff946f71f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 26840.509422063828, "timesteps_since_restore": 0, "iterations_since_restore": 157, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.35761316872428, "ram_util_percent": 23.900823045267487}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2971800322974882, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.058177309199887256, "policy_loss": -0.0717481394678915, "vf_loss": 0.10287284533022552, "vf_explained_var": 0.8468503579657565, "kl": 0.01407400530140837, "entropy": 3.206941072146098, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 146475.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_agent_steps_sampled": 632000, "num_agent_steps_trained": 632000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -11.8, "episode_reward_mean": -3.3590673575129544, "episode_len_mean": 20.787564766839377, "episode_media": {}, "episodes_this_iter": 193, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.2000000000000006, -3.300000000000001, -3.2000000000000006, -3.1000000000000005, -3.100000000000001, -3.3000000000000003, -3.3000000000000007, -3.4000000000000004, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.100000000000001, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -11.8, -3.1000000000000005, -3.2000000000000006, -3.2, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.2, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2, -3.1000000000000005, -3.400000000000001, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.2, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2, -3.3000000000000003, -3.400000000000001, -3.3000000000000007, -3.0000000000000004, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.200000000000001, -3.5000000000000004, -3.3000000000000003, -3.5000000000000013, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.5000000000000004, -3.0000000000000004, -3.2, -3.1000000000000005, -11.1, -3.1000000000000005, -3.0000000000000004, -3.3000000000000003, -3.0000000000000004, -3.3000000000000003, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.200000000000001, -3.3000000000000003, -3.3000000000000003, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.200000000000001, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.200000000000001, -3.2, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.4000000000000004, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.2, -3.2, -3.200000000000001, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -10.1, -3.400000000000001, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.5000000000000004, -3.0000000000000004, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.6, -3.3000000000000007, -3.4000000000000004, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.8000000000000007, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.400000000000001, -3.4000000000000004, -3.3000000000000003, -3.2000000000000006, -3.200000000000001, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.100000000000001, -3.2000000000000006, -11.3, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.518740879983904, "mean_inference_ms": 17.51773034701114, "mean_action_processing_ms": 0.9143069586451434, "mean_env_wait_ms": 2.2873523332541192, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07498684324748775, "StateBufferConnector_ms": 0.00995576690515706, "ViewRequirementAgentConnector_ms": 0.13782323333265867}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -11.8, "episode_reward_mean": -3.3590673575129544, "episode_len_mean": 20.787564766839377, "episodes_this_iter": 193, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.2000000000000006, -3.300000000000001, -3.2000000000000006, -3.1000000000000005, -3.100000000000001, -3.3000000000000003, -3.3000000000000007, -3.4000000000000004, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.100000000000001, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -11.8, -3.1000000000000005, -3.2000000000000006, -3.2, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.2, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2, -3.1000000000000005, -3.400000000000001, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.2, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2, -3.3000000000000003, -3.400000000000001, -3.3000000000000007, -3.0000000000000004, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.200000000000001, -3.5000000000000004, -3.3000000000000003, -3.5000000000000013, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.5000000000000004, -3.0000000000000004, -3.2, -3.1000000000000005, -11.1, -3.1000000000000005, -3.0000000000000004, -3.3000000000000003, -3.0000000000000004, -3.3000000000000003, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.200000000000001, -3.3000000000000003, -3.3000000000000003, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.200000000000001, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.200000000000001, -3.2, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.4000000000000004, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.2, -3.2, -3.200000000000001, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -10.1, -3.400000000000001, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.5000000000000004, -3.0000000000000004, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.6, -3.3000000000000007, -3.4000000000000004, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.8000000000000007, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.400000000000001, -3.4000000000000004, -3.3000000000000003, -3.2000000000000006, -3.200000000000001, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.100000000000001, -3.2000000000000006, -11.3, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.518740879983904, "mean_inference_ms": 17.51773034701114, "mean_action_processing_ms": 0.9143069586451434, "mean_env_wait_ms": 2.2873523332541192, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07498684324748775, "StateBufferConnector_ms": 0.00995576690515706, "ViewRequirementAgentConnector_ms": 0.13782323333265867}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 632000, "num_agent_steps_trained": 632000, "num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 632000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 632000, "timers": {"training_iteration_time_ms": 170861.469, "load_time_ms": 1.194, "load_throughput": 3350283.763, "learn_time_ms": 169833.511, "learn_throughput": 23.552, "synch_weights_time_ms": 179.177}, "counters": {"num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_agent_steps_sampled": 632000, "num_agent_steps_trained": 632000}, "done": false, "episodes_total": 31631, "training_iteration": 158, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_04-26-05", "timestamp": 1680834365, "time_this_iter_s": 171.04976344108582, "time_total_s": 27011.559185504913, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0147659520>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff946f73a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 27011.559185504913, "timesteps_since_restore": 0, "iterations_since_restore": 158, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.5736625514403295, "ram_util_percent": 23.89670781893004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5411214039610919, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.29898559207156783, "policy_loss": -0.03101595070373307, "vf_loss": 0.3114424384669751, "vf_explained_var": 0.7371716417933023, "kl": 0.00965529903944742, "entropy": 3.185850372878454, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 147405.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000}, "sampler_results": {"episode_reward_max": 98.8, "episode_reward_min": -12.0, "episode_reward_mean": -2.633838383838385, "episode_len_mean": 20.333333333333332, "episode_media": {}, "episodes_this_iter": 198, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -10.0, -3.5000000000000004, -3.2000000000000006, -11.8, -3.2000000000000006, -3.1000000000000005, -11.6, -10.8, -11.6, -11.0, -3.0000000000000004, -3.0000000000000004, -3.400000000000001, -3.3000000000000003, -3.400000000000001, -3.4000000000000004, -3.3000000000000003, -3.0000000000000004, -3.7000000000000006, -3.100000000000001, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.100000000000001, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.100000000000001, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.4000000000000004, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -10.6, -3.1000000000000005, -3.2000000000000006, -12.0, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.100000000000001, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -10.8, -3.1000000000000005, -3.0000000000000004, -3.4000000000000004, -3.0000000000000004, -3.1000000000000005, -3.400000000000001, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.6000000000000005, -10.4, 98.8, -3.200000000000001, -3.2000000000000006, -3.1000000000000005, -3.2, -3.3000000000000003, -3.1000000000000005, 98.3, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2, -3.2000000000000006, -3.100000000000001, -3.400000000000001, -3.4000000000000004, -3.0000000000000004, -3.100000000000001, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.2, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.100000000000001, -3.2000000000000006, -3.0000000000000004, -10.6, -3.2, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.4000000000000012, -3.2, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.100000000000001, -11.6, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.300000000000001, -3.0000000000000004, -3.1000000000000005, -3.100000000000001, -3.200000000000001, -3.1000000000000005, -3.100000000000001, -3.3000000000000007, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.300000000000001, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.5000000000000004, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.400000000000001, -3.0000000000000004], "episode_lengths": [21, 21, 21, 1, 21, 21, 17, 21, 21, 17, 9, 15, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 12, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.517178137628497, "mean_inference_ms": 17.547858406073725, "mean_action_processing_ms": 0.9164682082887862, "mean_env_wait_ms": 2.2930536015641914, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08110169208411014, "StateBufferConnector_ms": 0.010736422105268999, "ViewRequirementAgentConnector_ms": 0.14704574238170276}}, "episode_reward_max": 98.8, "episode_reward_min": -12.0, "episode_reward_mean": -2.633838383838385, "episode_len_mean": 20.333333333333332, "episodes_this_iter": 198, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -10.0, -3.5000000000000004, -3.2000000000000006, -11.8, -3.2000000000000006, -3.1000000000000005, -11.6, -10.8, -11.6, -11.0, -3.0000000000000004, -3.0000000000000004, -3.400000000000001, -3.3000000000000003, -3.400000000000001, -3.4000000000000004, -3.3000000000000003, -3.0000000000000004, -3.7000000000000006, -3.100000000000001, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.100000000000001, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.100000000000001, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.4000000000000004, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -10.6, -3.1000000000000005, -3.2000000000000006, -12.0, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.100000000000001, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -10.8, -3.1000000000000005, -3.0000000000000004, -3.4000000000000004, -3.0000000000000004, -3.1000000000000005, -3.400000000000001, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.6000000000000005, -10.4, 98.8, -3.200000000000001, -3.2000000000000006, -3.1000000000000005, -3.2, -3.3000000000000003, -3.1000000000000005, 98.3, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2, -3.2000000000000006, -3.100000000000001, -3.400000000000001, -3.4000000000000004, -3.0000000000000004, -3.100000000000001, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.2, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.100000000000001, -3.2000000000000006, -3.0000000000000004, -10.6, -3.2, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.4000000000000012, -3.2, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.100000000000001, -11.6, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.300000000000001, -3.0000000000000004, -3.1000000000000005, -3.100000000000001, -3.200000000000001, -3.1000000000000005, -3.100000000000001, -3.3000000000000007, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.300000000000001, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.5000000000000004, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.400000000000001, -3.0000000000000004], "episode_lengths": [21, 21, 21, 1, 21, 21, 17, 21, 21, 17, 9, 15, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 12, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.517178137628497, "mean_inference_ms": 17.547858406073725, "mean_action_processing_ms": 0.9164682082887862, "mean_env_wait_ms": 2.2930536015641914, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08110169208411014, "StateBufferConnector_ms": 0.010736422105268999, "ViewRequirementAgentConnector_ms": 0.14704574238170276}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 636000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 636000, "timers": {"training_iteration_time_ms": 170919.177, "load_time_ms": 1.187, "load_throughput": 3369595.501, "learn_time_ms": 169895.102, "learn_throughput": 23.544, "synch_weights_time_ms": 179.404}, "counters": {"num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000}, "done": false, "episodes_total": 31829, "training_iteration": 159, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_04-28-56", "timestamp": 1680834536, "time_this_iter_s": 171.3656620979309, "time_total_s": 27182.924847602844, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476d1f10>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff946f71f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 27182.924847602844, "timesteps_since_restore": 0, "iterations_since_restore": 159, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.259426229508198, "ram_util_percent": 23.892622950819668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7977850422423374, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.11620423235399749, "policy_loss": -0.07237638102403732, "vf_loss": 0.16105041836728892, "vf_explained_var": 0.7951414933127742, "kl": 0.014322472167619433, "entropy": 3.167528796965076, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 148335.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -11.700000000000001, "episode_reward_mean": -3.4358974358974366, "episode_len_mean": 20.712820512820514, "episode_media": {}, "episodes_this_iter": 195, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -11.2, -3.0000000000000004, -3.2, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.4000000000000004, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.200000000000001, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.400000000000001, -3.0000000000000004, -3.3000000000000003, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.300000000000001, -3.300000000000001, -3.2000000000000006, -3.500000000000001, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.2, -3.2, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.5000000000000004, -3.300000000000001, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.0000000000000004, -3.500000000000001, -3.200000000000001, -3.3000000000000007, -3.100000000000001, -3.2000000000000006, -3.0000000000000004, -3.3000000000000003, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.7000000000000006, -3.2000000000000006, -3.0000000000000004, -11.2, -3.2, -3.300000000000001, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.0000000000000004, -3.3000000000000003, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.2, -3.4000000000000004, -3.3000000000000007, -3.5000000000000004, -3.3000000000000007, -3.5000000000000004, -3.1000000000000005, -3.0000000000000004, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -11.7, -3.2000000000000006, -3.2, -3.100000000000001, -3.2000000000000006, -3.2, -3.1000000000000005, -10.5, -3.0000000000000004, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.200000000000001, -3.3000000000000007, -3.5000000000000004, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -10.7, -11.700000000000001, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2, -3.2000000000000006, -3.2000000000000006, -3.100000000000001, -3.0000000000000004, -3.1000000000000005, -3.200000000000001, -3.400000000000001, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2, -3.2, -3.2000000000000006, -3.0000000000000004, -3.2, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.7000000000000006, -3.2, -3.3000000000000003, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.3000000000000003, -3.2, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.2, -3.1000000000000005], "episode_lengths": [21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.521844788813212, "mean_inference_ms": 17.52227445312172, "mean_action_processing_ms": 0.9149647237249243, "mean_env_wait_ms": 2.2907943583648973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07691444494785407, "StateBufferConnector_ms": 0.01010735829671224, "ViewRequirementAgentConnector_ms": 0.13956363384540266}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -11.700000000000001, "episode_reward_mean": -3.4358974358974366, "episode_len_mean": 20.712820512820514, "episodes_this_iter": 195, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -11.2, -3.0000000000000004, -3.2, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.4000000000000004, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.200000000000001, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.400000000000001, -3.0000000000000004, -3.3000000000000003, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.300000000000001, -3.300000000000001, -3.2000000000000006, -3.500000000000001, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.2, -3.2, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.5000000000000004, -3.300000000000001, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.0000000000000004, -3.500000000000001, -3.200000000000001, -3.3000000000000007, -3.100000000000001, -3.2000000000000006, -3.0000000000000004, -3.3000000000000003, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.7000000000000006, -3.2000000000000006, -3.0000000000000004, -11.2, -3.2, -3.300000000000001, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.0000000000000004, -3.3000000000000003, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.2, -3.4000000000000004, -3.3000000000000007, -3.5000000000000004, -3.3000000000000007, -3.5000000000000004, -3.1000000000000005, -3.0000000000000004, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -11.7, -3.2000000000000006, -3.2, -3.100000000000001, -3.2000000000000006, -3.2, -3.1000000000000005, -10.5, -3.0000000000000004, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.200000000000001, -3.3000000000000007, -3.5000000000000004, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -10.7, -11.700000000000001, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2, -3.2000000000000006, -3.2000000000000006, -3.100000000000001, -3.0000000000000004, -3.1000000000000005, -3.200000000000001, -3.400000000000001, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2, -3.2, -3.2000000000000006, -3.0000000000000004, -3.2, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.7000000000000006, -3.2, -3.3000000000000003, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.3000000000000003, -3.2, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.2, -3.1000000000000005], "episode_lengths": [21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.521844788813212, "mean_inference_ms": 17.52227445312172, "mean_action_processing_ms": 0.9149647237249243, "mean_env_wait_ms": 2.2907943583648973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07691444494785407, "StateBufferConnector_ms": 0.01010735829671224, "ViewRequirementAgentConnector_ms": 0.13956363384540266}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000, "num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 640000, "timers": {"training_iteration_time_ms": 170921.723, "load_time_ms": 1.18, "load_throughput": 3389747.444, "learn_time_ms": 169909.012, "learn_throughput": 23.542, "synch_weights_time_ms": 178.951}, "counters": {"num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "done": false, "episodes_total": 32024, "training_iteration": 160, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_04-31-47", "timestamp": 1680834707, "time_this_iter_s": 170.41836047172546, "time_total_s": 27353.34320807457, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7eff94651fa0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff94718d30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 27353.34320807457, "timesteps_since_restore": 0, "iterations_since_restore": 160, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.419008264462809, "ram_util_percent": 23.88099173553719}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5480072662074078, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.19842684629062812, "policy_loss": -0.030841462446316595, "vf_loss": 0.2133050131291071, "vf_explained_var": 0.7149004946472824, "kl": 0.008304839803191322, "entropy": 3.1963162983617477, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 149265.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_agent_steps_sampled": 644000, "num_agent_steps_trained": 644000}, "sampler_results": {"episode_reward_max": 98.2, "episode_reward_min": -11.7, "episode_reward_mean": -3.071428571428572, "episode_len_mean": 20.382653061224488, "episode_media": {}, "episodes_this_iter": 196, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.1000000000000005, -3.0000000000000004, -3.500000000000001, -3.500000000000001, -3.400000000000001, -3.3000000000000007, -3.0000000000000004, -3.2, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.500000000000001, -3.2, -3.2000000000000006, -3.2, -3.1000000000000005, -3.0000000000000004, -3.300000000000001, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2, -3.500000000000001, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.100000000000001, -10.8, -3.4000000000000004, -10.6, -3.2, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.200000000000001, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -11.4, -3.2, -3.2, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -11.7, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.3000000000000003, -3.2, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.0000000000000004, -3.2000000000000006, -3.0000000000000004, -3.3000000000000003, 98.2, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -11.1, -3.2, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -3.6000000000000005, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.0000000000000004, -3.2, -3.3000000000000007, -3.0000000000000004, -10.4, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -3.3000000000000003, -10.3, -3.200000000000001, -3.3000000000000003, -11.1, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.5000000000000004, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -10.1, -3.2000000000000006, -3.1000000000000005, -3.500000000000001, -3.1000000000000005, -3.100000000000001, -3.3000000000000003, -3.0000000000000004, -3.1000000000000005, -3.4000000000000004, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.3000000000000007, -11.1, -3.3000000000000003, -3.2000000000000006, -3.0000000000000004, -3.600000000000001, -3.0000000000000004, -3.2, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.6000000000000005, -3.500000000000001, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.500000000000001, -3.3000000000000007, -3.200000000000001, -3.0000000000000004, -3.2000000000000006, -3.2, -3.3000000000000007, -3.300000000000001, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 4, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.520364657497879, "mean_inference_ms": 17.530487450031313, "mean_action_processing_ms": 0.9153423948376002, "mean_env_wait_ms": 2.2951929222211205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08079555569862833, "StateBufferConnector_ms": 0.010996935318927375, "ViewRequirementAgentConnector_ms": 0.1488079830091827}}, "episode_reward_max": 98.2, "episode_reward_min": -11.7, "episode_reward_mean": -3.071428571428572, "episode_len_mean": 20.382653061224488, "episodes_this_iter": 196, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.1000000000000005, -3.0000000000000004, -3.500000000000001, -3.500000000000001, -3.400000000000001, -3.3000000000000007, -3.0000000000000004, -3.2, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.500000000000001, -3.2, -3.2000000000000006, -3.2, -3.1000000000000005, -3.0000000000000004, -3.300000000000001, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2, -3.500000000000001, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.100000000000001, -10.8, -3.4000000000000004, -10.6, -3.2, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.200000000000001, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -11.4, -3.2, -3.2, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -11.7, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.3000000000000003, -3.2, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.0000000000000004, -3.2000000000000006, -3.0000000000000004, -3.3000000000000003, 98.2, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -11.1, -3.2, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -3.6000000000000005, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.0000000000000004, -3.2, -3.3000000000000007, -3.0000000000000004, -10.4, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -3.3000000000000003, -10.3, -3.200000000000001, -3.3000000000000003, -11.1, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.5000000000000004, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -10.1, -3.2000000000000006, -3.1000000000000005, -3.500000000000001, -3.1000000000000005, -3.100000000000001, -3.3000000000000003, -3.0000000000000004, -3.1000000000000005, -3.4000000000000004, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.3000000000000007, -11.1, -3.3000000000000003, -3.2000000000000006, -3.0000000000000004, -3.600000000000001, -3.0000000000000004, -3.2, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.6000000000000005, -3.500000000000001, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.500000000000001, -3.3000000000000007, -3.200000000000001, -3.0000000000000004, -3.2000000000000006, -3.2, -3.3000000000000007, -3.300000000000001, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 4, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.520364657497879, "mean_inference_ms": 17.530487450031313, "mean_action_processing_ms": 0.9153423948376002, "mean_env_wait_ms": 2.2951929222211205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08079555569862833, "StateBufferConnector_ms": 0.010996935318927375, "ViewRequirementAgentConnector_ms": 0.1488079830091827}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 644000, "num_agent_steps_trained": 644000, "num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 644000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 644000, "timers": {"training_iteration_time_ms": 170881.285, "load_time_ms": 1.14, "load_throughput": 3507823.033, "learn_time_ms": 169921.929, "learn_throughput": 23.54, "synch_weights_time_ms": 174.775}, "counters": {"num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_agent_steps_sampled": 644000, "num_agent_steps_trained": 644000}, "done": false, "episodes_total": 32220, "training_iteration": 161, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_04-34-38", "timestamp": 1680834878, "time_this_iter_s": 170.98629212379456, "time_total_s": 27524.329500198364, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7eff946f63d0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff947181f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 27524.329500198364, "timesteps_since_restore": 0, "iterations_since_restore": 161, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.280658436213992, "ram_util_percent": 23.856790123456793}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.647564738748535, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.19911380087736474, "policy_loss": -0.07657110764775225, "vf_loss": 0.24530410930284008, "vf_explained_var": 0.7127221857347796, "kl": 0.015805486466448318, "entropy": 3.1799796519740937, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 150195.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -11.9, "episode_reward_mean": -3.6227272727272735, "episode_len_mean": 20.404040404040405, "episode_media": {}, "episodes_this_iter": 198, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.2, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.4000000000000004, -3.0000000000000004, -3.2, -3.1000000000000005, -11.3, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.2, -3.2, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.6000000000000005, -3.1000000000000005, -3.2000000000000006, -10.7, -3.1000000000000005, -3.2000000000000006, -3.100000000000001, -11.9, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.500000000000001, -3.100000000000001, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.5000000000000004, -3.1000000000000005, -3.2000000000000006, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.2, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.0000000000000004, -3.3000000000000003, -3.1000000000000005, -3.4000000000000004, -3.0000000000000004, -3.4000000000000004, -3.0000000000000004, -3.0000000000000004, -11.9, -3.1000000000000005, -3.300000000000001, -3.2000000000000006, -3.6000000000000005, -3.3000000000000003, -3.2000000000000006, -3.4000000000000004, -10.1, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2, -3.1000000000000005, -3.400000000000001, -3.200000000000001, -3.1000000000000005, -3.500000000000001, -3.0000000000000004, -3.4000000000000004, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.500000000000001, -3.3000000000000003, -3.0000000000000004, -3.1000000000000005, -3.3000000000000003, -10.3, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.5000000000000004, -3.0000000000000004, -3.3000000000000007, -3.4000000000000004, -3.0000000000000004, -3.2000000000000006, -3.200000000000001, -3.3000000000000003, -3.3000000000000003, -10.1, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -10.7, -3.3000000000000003, -11.0, -3.2000000000000006, -3.500000000000001, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.4000000000000004, -3.2, -3.0000000000000004, -3.0000000000000004, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.3000000000000003, -3.2, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.0000000000000004, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.300000000000001, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -11.8, -3.1000000000000005, -3.2, -3.1000000000000005, -11.0, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.2, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.400000000000001, -3.0000000000000004, -3.100000000000001, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.3000000000000003, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.500000000000001, -3.1000000000000005], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 8, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.519917826923164, "mean_inference_ms": 17.521829130344468, "mean_action_processing_ms": 0.9157376700742436, "mean_env_wait_ms": 2.293604636927286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07507319402213049, "StateBufferConnector_ms": 0.009548664093017578, "ViewRequirementAgentConnector_ms": 0.13653160345674764}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -11.9, "episode_reward_mean": -3.6227272727272735, "episode_len_mean": 20.404040404040405, "episodes_this_iter": 198, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.2, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.4000000000000004, -3.0000000000000004, -3.2, -3.1000000000000005, -11.3, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.2, -3.2, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.6000000000000005, -3.1000000000000005, -3.2000000000000006, -10.7, -3.1000000000000005, -3.2000000000000006, -3.100000000000001, -11.9, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.500000000000001, -3.100000000000001, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.5000000000000004, -3.1000000000000005, -3.2000000000000006, -3.500000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.2, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.0000000000000004, -3.3000000000000003, -3.1000000000000005, -3.4000000000000004, -3.0000000000000004, -3.4000000000000004, -3.0000000000000004, -3.0000000000000004, -11.9, -3.1000000000000005, -3.300000000000001, -3.2000000000000006, -3.6000000000000005, -3.3000000000000003, -3.2000000000000006, -3.4000000000000004, -10.1, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2, -3.1000000000000005, -3.400000000000001, -3.200000000000001, -3.1000000000000005, -3.500000000000001, -3.0000000000000004, -3.4000000000000004, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.500000000000001, -3.3000000000000003, -3.0000000000000004, -3.1000000000000005, -3.3000000000000003, -10.3, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.5000000000000004, -3.0000000000000004, -3.3000000000000007, -3.4000000000000004, -3.0000000000000004, -3.2000000000000006, -3.200000000000001, -3.3000000000000003, -3.3000000000000003, -10.1, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -10.7, -3.3000000000000003, -11.0, -3.2000000000000006, -3.500000000000001, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.4000000000000004, -3.2, -3.0000000000000004, -3.0000000000000004, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.3000000000000003, -3.2, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.0000000000000004, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.300000000000001, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -11.8, -3.1000000000000005, -3.2, -3.1000000000000005, -11.0, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.2, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.400000000000001, -3.0000000000000004, -3.100000000000001, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.3000000000000003, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.500000000000001, -3.1000000000000005], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 8, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.519917826923164, "mean_inference_ms": 17.521829130344468, "mean_action_processing_ms": 0.9157376700742436, "mean_env_wait_ms": 2.293604636927286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07507319402213049, "StateBufferConnector_ms": 0.009548664093017578, "ViewRequirementAgentConnector_ms": 0.13653160345674764}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 648000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 648000, "timers": {"training_iteration_time_ms": 170938.119, "load_time_ms": 1.141, "load_throughput": 3506576.654, "learn_time_ms": 169981.521, "learn_throughput": 23.532, "synch_weights_time_ms": 174.985}, "counters": {"num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "done": false, "episodes_total": 32418, "training_iteration": 162, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_04-37-29", "timestamp": 1680835049, "time_this_iter_s": 171.11793279647827, "time_total_s": 27695.447432994843, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01473e2370>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff946ed700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 27695.447432994843, "timesteps_since_restore": 0, "iterations_since_restore": 162, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.511111111111112, "ram_util_percent": 23.894650205761316}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1323092654267306, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.21048744479394568, "policy_loss": -0.028854883886292898, "vf_loss": 0.22611815295062, "vf_explained_var": 0.7343502110691481, "kl": 0.006879822224984446, "entropy": 3.193309349142095, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 151125.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 652000, "num_env_steps_trained": 652000, "num_agent_steps_sampled": 652000, "num_agent_steps_trained": 652000}, "sampler_results": {"episode_reward_max": 99.0, "episode_reward_min": -12.100000000000001, "episode_reward_mean": -2.9454545454545458, "episode_len_mean": 20.67379679144385, "episode_media": {}, "episodes_this_iter": 187, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -11.0, -3.1000000000000005, -3.3000000000000007, -3.2, -3.5000000000000004, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.300000000000001, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.200000000000001, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.0000000000000004, -3.3000000000000007, -3.2, -3.4000000000000012, -3.2000000000000006, -3.2, -3.200000000000001, -3.1000000000000005, -3.2000000000000006, -3.2, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.200000000000001, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.3000000000000003, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -11.9, -3.1000000000000005, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.2, -11.4, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.3000000000000003, -3.1000000000000005, -3.200000000000001, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.500000000000001, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, 99.0, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -12.100000000000001, -3.2, -3.2000000000000006, -11.0, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.2, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -3.200000000000001, -3.4000000000000004, -3.2000000000000006, -3.0000000000000004, -3.4000000000000004, -3.4000000000000004, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.5000000000000004, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.6000000000000005, -3.100000000000001, -3.3000000000000003, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.300000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2, -3.1000000000000005, -3.0000000000000004, -3.3000000000000003, -10.3, -12.0, -3.1000000000000005, -3.2000000000000006, -3.2], "episode_lengths": [21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 19, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.521110797286656, "mean_inference_ms": 17.546795812591853, "mean_action_processing_ms": 0.9164336723083655, "mean_env_wait_ms": 2.2974278482793014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07644949112346465, "StateBufferConnector_ms": 0.009719190750530059, "ViewRequirementAgentConnector_ms": 0.13908919166116154}}, "episode_reward_max": 99.0, "episode_reward_min": -12.100000000000001, "episode_reward_mean": -2.9454545454545458, "episode_len_mean": 20.67379679144385, "episodes_this_iter": 187, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -11.0, -3.1000000000000005, -3.3000000000000007, -3.2, -3.5000000000000004, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.300000000000001, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.200000000000001, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.0000000000000004, -3.3000000000000007, -3.2, -3.4000000000000012, -3.2000000000000006, -3.2, -3.200000000000001, -3.1000000000000005, -3.2000000000000006, -3.2, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.200000000000001, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.3000000000000003, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -11.9, -3.1000000000000005, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.2, -11.4, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.3000000000000003, -3.1000000000000005, -3.200000000000001, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.500000000000001, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, 99.0, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -12.100000000000001, -3.2, -3.2000000000000006, -11.0, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.2, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -3.200000000000001, -3.4000000000000004, -3.2000000000000006, -3.0000000000000004, -3.4000000000000004, -3.4000000000000004, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.5000000000000004, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.6000000000000005, -3.100000000000001, -3.3000000000000003, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.300000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2, -3.1000000000000005, -3.0000000000000004, -3.3000000000000003, -10.3, -12.0, -3.1000000000000005, -3.2000000000000006, -3.2], "episode_lengths": [21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 19, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.521110797286656, "mean_inference_ms": 17.546795812591853, "mean_action_processing_ms": 0.9164336723083655, "mean_env_wait_ms": 2.2974278482793014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07644949112346465, "StateBufferConnector_ms": 0.009719190750530059, "ViewRequirementAgentConnector_ms": 0.13908919166116154}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 652000, "num_agent_steps_trained": 652000, "num_env_steps_sampled": 652000, "num_env_steps_trained": 652000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 652000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 652000, "timers": {"training_iteration_time_ms": 170969.325, "load_time_ms": 1.135, "load_throughput": 3525217.684, "learn_time_ms": 170005.884, "learn_throughput": 23.529, "synch_weights_time_ms": 175.264}, "counters": {"num_env_steps_sampled": 652000, "num_env_steps_trained": 652000, "num_agent_steps_sampled": 652000, "num_agent_steps_trained": 652000}, "done": false, "episodes_total": 32605, "training_iteration": 163, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_04-40-20", "timestamp": 1680835220, "time_this_iter_s": 171.085036277771, "time_total_s": 27866.532469272614, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7eff9472ce80>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff946ed1f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 27866.532469272614, "timesteps_since_restore": 0, "iterations_since_restore": 163, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.359670781893003, "ram_util_percent": 23.89588477366255}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5760131531024493, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.15754776848980817, "policy_loss": -0.07369351181331822, "vf_loss": 0.20010517145336795, "vf_explained_var": 0.7439922492991211, "kl": 0.0161984316749318, "entropy": 3.179950169081329, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 152055.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -11.8, "episode_reward_mean": -3.5088541666666675, "episode_len_mean": 20.619791666666668, "episode_media": {}, "episodes_this_iter": 192, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3000000000000007, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.200000000000001, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.6000000000000005, -3.3000000000000007, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2, -3.2, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.4000000000000004, -3.3000000000000007, -3.2, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.100000000000001, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.200000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.500000000000001, -11.4, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.200000000000001, -3.1000000000000005, -11.0, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.7000000000000006, -3.2, -3.1000000000000005, -3.4000000000000004, -3.3000000000000003, -3.0000000000000004, -3.0000000000000004, -3.100000000000001, -3.4000000000000004, -11.2, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.100000000000001, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -11.1, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.100000000000001, -3.2000000000000006, -3.3000000000000007, -3.2, -3.2000000000000006, -3.0000000000000004, -3.400000000000001, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.3000000000000003, -3.0000000000000004, -3.1000000000000005, -10.6, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.5000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.2, -11.6, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.100000000000001, -3.100000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -10.4, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.6000000000000005, -3.2000000000000006, -3.2, -3.2, -3.500000000000001, -3.3000000000000003, -3.2000000000000006, -3.3000000000000003, -3.4000000000000004, -3.400000000000001, -11.8, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.0000000000000004, -3.3000000000000003, -3.0000000000000004, -3.0000000000000004, -3.4000000000000004, -3.0000000000000004, -3.1000000000000005, -3.2, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.516712701412693, "mean_inference_ms": 17.51474465372104, "mean_action_processing_ms": 0.9149102168446283, "mean_env_wait_ms": 2.2907096846800297, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07914826273918152, "StateBufferConnector_ms": 0.009963661432266235, "ViewRequirementAgentConnector_ms": 0.14475124577681223}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -11.8, "episode_reward_mean": -3.5088541666666675, "episode_len_mean": 20.619791666666668, "episodes_this_iter": 192, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.3000000000000007, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.200000000000001, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.6000000000000005, -3.3000000000000007, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2, -3.2, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.4000000000000004, -3.3000000000000007, -3.2, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.100000000000001, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.200000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.500000000000001, -11.4, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.200000000000001, -3.1000000000000005, -11.0, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.7000000000000006, -3.2, -3.1000000000000005, -3.4000000000000004, -3.3000000000000003, -3.0000000000000004, -3.0000000000000004, -3.100000000000001, -3.4000000000000004, -11.2, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.100000000000001, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -11.1, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.100000000000001, -3.2000000000000006, -3.3000000000000007, -3.2, -3.2000000000000006, -3.0000000000000004, -3.400000000000001, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.3000000000000003, -3.0000000000000004, -3.1000000000000005, -10.6, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.5000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.2, -11.6, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.100000000000001, -3.100000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -10.4, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.6000000000000005, -3.2000000000000006, -3.2, -3.2, -3.500000000000001, -3.3000000000000003, -3.2000000000000006, -3.3000000000000003, -3.4000000000000004, -3.400000000000001, -11.8, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.0000000000000004, -3.3000000000000003, -3.0000000000000004, -3.0000000000000004, -3.4000000000000004, -3.0000000000000004, -3.1000000000000005, -3.2, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.516712701412693, "mean_inference_ms": 17.51474465372104, "mean_action_processing_ms": 0.9149102168446283, "mean_env_wait_ms": 2.2907096846800297, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07914826273918152, "StateBufferConnector_ms": 0.009963661432266235, "ViewRequirementAgentConnector_ms": 0.14475124577681223}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000, "num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 656000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 656000, "timers": {"training_iteration_time_ms": 170945.265, "load_time_ms": 1.14, "load_throughput": 3508850.128, "learn_time_ms": 169980.179, "learn_throughput": 23.532, "synch_weights_time_ms": 179.474}, "counters": {"num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "done": false, "episodes_total": 32797, "training_iteration": 164, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_04-43-11", "timestamp": 1680835391, "time_this_iter_s": 170.57279181480408, "time_total_s": 28037.105261087418, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476d1820>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff9463b1f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 28037.105261087418, "timesteps_since_restore": 0, "iterations_since_restore": 164, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.382304526748972, "ram_util_percent": 23.89835390946502}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5705120519764961, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.08978374242602337, "policy_loss": -0.07240653936926436, "vf_loss": 0.13575530957821155, "vf_explained_var": 0.7915965954462687, "kl": 0.013752685118496658, "entropy": 3.1721846180577433, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 152985.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -11.9, "episode_reward_mean": -3.5409326424870473, "episode_len_mean": 20.316062176165804, "episode_media": {}, "episodes_this_iter": 193, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.200000000000001, -3.2, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -11.9, -3.1000000000000005, -3.3000000000000003, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.4000000000000004, -3.2, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.4000000000000004, -3.400000000000001, -3.1000000000000005, -3.5000000000000004, -3.2, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.200000000000001, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.6000000000000005, -10.5, -3.3000000000000007, -3.0000000000000004, -3.3000000000000007, -3.500000000000001, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.200000000000001, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.300000000000001, -3.4000000000000004, -3.5000000000000004, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.200000000000001, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.3000000000000003, -3.0000000000000004, -3.1000000000000005, -10.4, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -10.9, -10.3, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.200000000000001, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -10.2, -3.1000000000000005, -3.2000000000000006, -10.0, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.2, -3.200000000000001, -3.1000000000000005, -10.2, -3.400000000000001, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -10.5, -3.2000000000000006, -3.500000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2, -3.1000000000000005, -3.2, -3.0000000000000004, -3.2000000000000006, -3.2, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.2, -3.2000000000000006, -3.2, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.4000000000000004, -3.0000000000000004, -3.1000000000000005, -3.4000000000000004, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.400000000000001, -3.2, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.300000000000001, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.100000000000001, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.500000000000001, -3.0000000000000004], "episode_lengths": [21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 10, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.516314036455919, "mean_inference_ms": 17.54364337137328, "mean_action_processing_ms": 0.9159177179526043, "mean_env_wait_ms": 2.2977253438727017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0798688651366555, "StateBufferConnector_ms": 0.009836804681491357, "ViewRequirementAgentConnector_ms": 0.1463258822347216}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -11.9, "episode_reward_mean": -3.5409326424870473, "episode_len_mean": 20.316062176165804, "episodes_this_iter": 193, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.200000000000001, -3.2, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -11.9, -3.1000000000000005, -3.3000000000000003, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.4000000000000004, -3.2, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.4000000000000004, -3.400000000000001, -3.1000000000000005, -3.5000000000000004, -3.2, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.200000000000001, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.6000000000000005, -10.5, -3.3000000000000007, -3.0000000000000004, -3.3000000000000007, -3.500000000000001, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.200000000000001, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.300000000000001, -3.4000000000000004, -3.5000000000000004, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.200000000000001, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.3000000000000003, -3.0000000000000004, -3.1000000000000005, -10.4, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -10.9, -10.3, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.200000000000001, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -10.2, -3.1000000000000005, -3.2000000000000006, -10.0, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.2, -3.200000000000001, -3.1000000000000005, -10.2, -3.400000000000001, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -10.5, -3.2000000000000006, -3.500000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2, -3.1000000000000005, -3.2, -3.0000000000000004, -3.2000000000000006, -3.2, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.2, -3.2000000000000006, -3.2, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.4000000000000004, -3.0000000000000004, -3.1000000000000005, -3.4000000000000004, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.400000000000001, -3.2, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.300000000000001, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.100000000000001, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.500000000000001, -3.0000000000000004], "episode_lengths": [21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 10, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.516314036455919, "mean_inference_ms": 17.54364337137328, "mean_action_processing_ms": 0.9159177179526043, "mean_env_wait_ms": 2.2977253438727017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0798688651366555, "StateBufferConnector_ms": 0.009836804681491357, "ViewRequirementAgentConnector_ms": 0.1463258822347216}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 660000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 660000, "timers": {"training_iteration_time_ms": 170952.391, "load_time_ms": 1.146, "load_throughput": 3490962.359, "learn_time_ms": 169983.463, "learn_throughput": 23.532, "synch_weights_time_ms": 179.232}, "counters": {"num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000}, "done": false, "episodes_total": 32990, "training_iteration": 165, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_04-46-02", "timestamp": 1680835562, "time_this_iter_s": 171.06727695465088, "time_total_s": 28208.17253804207, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01477ae3d0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff94718310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 28208.17253804207, "timesteps_since_restore": 0, "iterations_since_restore": 165, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.563374485596707, "ram_util_percent": 23.899588477366255}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2158509521074192, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.04003449929777973, "policy_loss": -0.07569849481605874, "vf_loss": 0.08861981260450057, "vf_explained_var": 0.8420793138524537, "kl": 0.014105520952681971, "entropy": 3.170436187200649, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 153915.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_agent_steps_sampled": 664000, "num_agent_steps_trained": 664000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.0, "episode_reward_mean": -3.3892307692307697, "episode_len_mean": 20.70769230769231, "episode_media": {}, "episodes_this_iter": 195, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.200000000000001, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.3000000000000003, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.100000000000001, -3.1000000000000005, -3.2, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.5000000000000004, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -12.0, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2, -3.3000000000000007, -3.2, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.5000000000000004, -11.1, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.500000000000001, -3.2000000000000006, -3.4000000000000004, -3.400000000000001, -3.7000000000000006, -3.200000000000001, -3.400000000000001, -3.1000000000000005, -3.100000000000001, -4.000000000000001, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.500000000000001, -3.1000000000000005, -3.600000000000001, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.3000000000000003, -3.200000000000001, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.5000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.500000000000001, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.0000000000000004, -3.4000000000000004, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -10.1, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.0000000000000004, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.4000000000000012, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2, -10.6, -3.3000000000000003, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.600000000000001, -3.3000000000000003, -3.200000000000001, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.500000000000001, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.2, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.100000000000001, -3.2000000000000006, -3.3000000000000003, -3.3000000000000003, -3.0000000000000004, -3.0000000000000004, -3.0000000000000004, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -10.8, -3.4000000000000004], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.519532134364514, "mean_inference_ms": 17.528980371524423, "mean_action_processing_ms": 0.9155591546153206, "mean_env_wait_ms": 2.294861855346858, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07394228226099259, "StateBufferConnector_ms": 0.009331458654159155, "ViewRequirementAgentConnector_ms": 0.13396079723651594}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.0, "episode_reward_mean": -3.3892307692307697, "episode_len_mean": 20.70769230769231, "episodes_this_iter": 195, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.200000000000001, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.3000000000000003, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.100000000000001, -3.1000000000000005, -3.2, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.5000000000000004, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -12.0, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2, -3.3000000000000007, -3.2, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.5000000000000004, -11.1, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.500000000000001, -3.2000000000000006, -3.4000000000000004, -3.400000000000001, -3.7000000000000006, -3.200000000000001, -3.400000000000001, -3.1000000000000005, -3.100000000000001, -4.000000000000001, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.500000000000001, -3.1000000000000005, -3.600000000000001, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.3000000000000003, -3.200000000000001, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.5000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.500000000000001, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.0000000000000004, -3.4000000000000004, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -10.1, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.0000000000000004, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.4000000000000012, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2, -10.6, -3.3000000000000003, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.600000000000001, -3.3000000000000003, -3.200000000000001, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.500000000000001, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.2, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.100000000000001, -3.2000000000000006, -3.3000000000000003, -3.3000000000000003, -3.0000000000000004, -3.0000000000000004, -3.0000000000000004, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -10.8, -3.4000000000000004], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.519532134364514, "mean_inference_ms": 17.528980371524423, "mean_action_processing_ms": 0.9155591546153206, "mean_env_wait_ms": 2.294861855346858, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07394228226099259, "StateBufferConnector_ms": 0.009331458654159155, "ViewRequirementAgentConnector_ms": 0.13396079723651594}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 664000, "num_agent_steps_trained": 664000, "num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 664000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 664000, "timers": {"training_iteration_time_ms": 170899.817, "load_time_ms": 1.166, "load_throughput": 3429310.549, "learn_time_ms": 169928.971, "learn_throughput": 23.539, "synch_weights_time_ms": 177.208}, "counters": {"num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_agent_steps_sampled": 664000, "num_agent_steps_trained": 664000}, "done": false, "episodes_total": 33185, "training_iteration": 166, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_04-48-52", "timestamp": 1680835732, "time_this_iter_s": 170.39716911315918, "time_total_s": 28378.569707155228, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0147659190>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff9463b940>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 28378.569707155228, "timesteps_since_restore": 0, "iterations_since_restore": 166, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.31404958677686, "ram_util_percent": 23.900826446280988}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5641948262850442, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.15312502807186495, "policy_loss": -0.07321464882823088, "vf_loss": 0.20172526514187694, "vf_explained_var": 0.77410476387188, "kl": 0.012805545499882541, "entropy": 3.16432619812668, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 154845.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 668000, "num_env_steps_trained": 668000, "num_agent_steps_sampled": 668000, "num_agent_steps_trained": 668000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.1, "episode_reward_mean": -3.4220000000000006, "episode_len_mean": 20.815, "episode_media": {}, "episodes_this_iter": 200, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.500000000000001, -3.2, -3.2000000000000006, -3.2, -3.0000000000000004, -3.3000000000000003, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.3000000000000003, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.2, -3.1000000000000005, -3.400000000000001, -3.400000000000001, -3.2, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.200000000000001, -3.2000000000000006, -3.0000000000000004, -3.4000000000000004, -3.200000000000001, -3.3000000000000007, -3.2, -3.1000000000000005, -3.0000000000000004, -3.500000000000001, -12.1, -3.0000000000000004, -3.100000000000001, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.3000000000000003, -3.2000000000000006, -11.3, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.0000000000000004, -3.3000000000000003, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.2, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.100000000000001, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.100000000000001, -3.3000000000000003, -3.2, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.200000000000001, -11.9, -3.2000000000000006, -3.4000000000000004, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -10.9, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.200000000000001, -3.3000000000000003, -3.0000000000000004, -3.0000000000000004, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.100000000000001, -3.0000000000000004, -3.2, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2, -3.3000000000000007, -3.2000000000000006, -3.2, -3.2000000000000006, -3.100000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.4000000000000004, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.200000000000001, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.3000000000000003, -3.4000000000000004, -3.4000000000000004, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.2, -3.500000000000001, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.200000000000001, -3.3000000000000007, -10.9, -3.5000000000000004, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -11.8, -3.1000000000000005, -3.1000000000000005], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.522782316824449, "mean_inference_ms": 17.53212313136809, "mean_action_processing_ms": 0.9152905375826896, "mean_env_wait_ms": 2.2974414998134147, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07399964332580566, "StateBufferConnector_ms": 0.009290695190429688, "ViewRequirementAgentConnector_ms": 0.13506758213043213}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.1, "episode_reward_mean": -3.4220000000000006, "episode_len_mean": 20.815, "episodes_this_iter": 200, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.500000000000001, -3.2, -3.2000000000000006, -3.2, -3.0000000000000004, -3.3000000000000003, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.3000000000000003, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.2, -3.1000000000000005, -3.400000000000001, -3.400000000000001, -3.2, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.200000000000001, -3.2000000000000006, -3.0000000000000004, -3.4000000000000004, -3.200000000000001, -3.3000000000000007, -3.2, -3.1000000000000005, -3.0000000000000004, -3.500000000000001, -12.1, -3.0000000000000004, -3.100000000000001, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.3000000000000003, -3.2000000000000006, -11.3, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.0000000000000004, -3.3000000000000003, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.2, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.100000000000001, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.100000000000001, -3.3000000000000003, -3.2, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.200000000000001, -11.9, -3.2000000000000006, -3.4000000000000004, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -10.9, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.200000000000001, -3.3000000000000003, -3.0000000000000004, -3.0000000000000004, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.100000000000001, -3.0000000000000004, -3.2, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2, -3.3000000000000007, -3.2000000000000006, -3.2, -3.2000000000000006, -3.100000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.4000000000000004, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.200000000000001, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.3000000000000003, -3.4000000000000004, -3.4000000000000004, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.2, -3.500000000000001, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.200000000000001, -3.3000000000000007, -10.9, -3.5000000000000004, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -11.8, -3.1000000000000005, -3.1000000000000005], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.522782316824449, "mean_inference_ms": 17.53212313136809, "mean_action_processing_ms": 0.9152905375826896, "mean_env_wait_ms": 2.2974414998134147, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07399964332580566, "StateBufferConnector_ms": 0.009290695190429688, "ViewRequirementAgentConnector_ms": 0.13506758213043213}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 668000, "num_agent_steps_trained": 668000, "num_env_steps_sampled": 668000, "num_env_steps_trained": 668000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 668000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 668000, "timers": {"training_iteration_time_ms": 170858.749, "load_time_ms": 1.171, "load_throughput": 3416043.817, "learn_time_ms": 169898.543, "learn_throughput": 23.543, "synch_weights_time_ms": 177.141}, "counters": {"num_env_steps_sampled": 668000, "num_env_steps_trained": 668000, "num_agent_steps_sampled": 668000, "num_agent_steps_trained": 668000}, "done": false, "episodes_total": 33385, "training_iteration": 167, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_04-51-43", "timestamp": 1680835903, "time_this_iter_s": 170.64472365379333, "time_total_s": 28549.21443080902, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7effc01301c0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff946edb80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 28549.21443080902, "timesteps_since_restore": 0, "iterations_since_restore": 167, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.390534979423869, "ram_util_percent": 23.90205761316872}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4632438627061664, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.1407611616116057, "policy_loss": -0.027066611547163257, "vf_loss": 0.15244867885685576, "vf_explained_var": 0.716450261428792, "kl": 0.008000910698257197, "entropy": 3.1633460301224905, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 155775.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "sampler_results": {"episode_reward_max": 99.4, "episode_reward_min": -11.9, "episode_reward_mean": -2.44517766497462, "episode_len_mean": 20.406091370558375, "episode_media": {}, "episodes_this_iter": 197, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.1000000000000005, 98.9, -3.3000000000000003, -3.2000000000000006, -3.0000000000000004, -3.2, -3.2000000000000006, -3.4000000000000004, 99.4, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.5000000000000004, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.100000000000001, -3.2000000000000006, -3.2000000000000006, -3.200000000000001, -3.2000000000000006, -3.4000000000000004, -3.2, -3.2, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -10.1, -3.2000000000000006, -3.0000000000000004, -3.400000000000001, -3.3000000000000007, -3.2, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -10.5, -10.8, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.100000000000001, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -11.2, -3.3000000000000003, -3.0000000000000004, -3.0000000000000004, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.5000000000000004, -3.1000000000000005, -3.0000000000000004, -10.6, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.6000000000000005, -3.1000000000000005, -3.0000000000000004, -3.500000000000001, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -11.2, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.2, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -10.6, -3.0000000000000004, -3.100000000000001, -3.400000000000001, -3.2, -3.2, -3.400000000000001, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.400000000000001, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.200000000000001, -3.3000000000000003, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.0000000000000004, -3.3000000000000003, -3.5000000000000004, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.500000000000001, -3.0000000000000004, -3.3000000000000007, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -11.9], "episode_lengths": [21, 12, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.521222584930854, "mean_inference_ms": 17.553468483373255, "mean_action_processing_ms": 0.9163748501651426, "mean_env_wait_ms": 2.2991562540970674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07112861284749762, "StateBufferConnector_ms": 0.008943843357454096, "ViewRequirementAgentConnector_ms": 0.13128597724256177}}, "episode_reward_max": 99.4, "episode_reward_min": -11.9, "episode_reward_mean": -2.44517766497462, "episode_len_mean": 20.406091370558375, "episodes_this_iter": 197, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.1000000000000005, 98.9, -3.3000000000000003, -3.2000000000000006, -3.0000000000000004, -3.2, -3.2000000000000006, -3.4000000000000004, 99.4, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.5000000000000004, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.100000000000001, -3.2000000000000006, -3.2000000000000006, -3.200000000000001, -3.2000000000000006, -3.4000000000000004, -3.2, -3.2, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -10.1, -3.2000000000000006, -3.0000000000000004, -3.400000000000001, -3.3000000000000007, -3.2, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -10.5, -10.8, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.100000000000001, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -11.2, -3.3000000000000003, -3.0000000000000004, -3.0000000000000004, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.5000000000000004, -3.1000000000000005, -3.0000000000000004, -10.6, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.6000000000000005, -3.1000000000000005, -3.0000000000000004, -3.500000000000001, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -11.2, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.2, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -10.6, -3.0000000000000004, -3.100000000000001, -3.400000000000001, -3.2, -3.2, -3.400000000000001, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.400000000000001, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.200000000000001, -3.3000000000000003, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.0000000000000004, -3.3000000000000003, -3.5000000000000004, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.500000000000001, -3.0000000000000004, -3.3000000000000007, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -11.9], "episode_lengths": [21, 12, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.521222584930854, "mean_inference_ms": 17.553468483373255, "mean_action_processing_ms": 0.9163748501651426, "mean_env_wait_ms": 2.2991562540970674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07112861284749762, "StateBufferConnector_ms": 0.008943843357454096, "ViewRequirementAgentConnector_ms": 0.13128597724256177}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 672000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 170789.863, "load_time_ms": 1.162, "load_throughput": 3441903.824, "learn_time_ms": 169826.044, "learn_throughput": 23.554, "synch_weights_time_ms": 178.299}, "counters": {"num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "done": false, "episodes_total": 33582, "training_iteration": 168, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_04-54-33", "timestamp": 1680836073, "time_this_iter_s": 170.36146569252014, "time_total_s": 28719.57589650154, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7eff94622790>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff94615040>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 28719.57589650154, "timesteps_since_restore": 0, "iterations_since_restore": 168, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.317355371900827, "ram_util_percent": 23.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5496751007533842, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.01597255615327227, "policy_loss": -0.07675659257157516, "vf_loss": 0.0637476849514911, "vf_explained_var": 0.8636774642493135, "kl": 0.015077487291093485, "entropy": 3.154281367537796, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 156705.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 676000, "num_env_steps_trained": 676000, "num_agent_steps_sampled": 676000, "num_agent_steps_trained": 676000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -11.7, "episode_reward_mean": -3.3279792746114, "episode_len_mean": 20.72538860103627, "episode_media": {}, "episodes_this_iter": 193, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.0, -3.0000000000000004, -3.200000000000001, -3.0000000000000004, -3.2, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.5000000000000004, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.3000000000000003, -3.200000000000001, -3.1000000000000005, -3.0000000000000004, -3.2, -3.400000000000001, -3.1000000000000005, -3.400000000000001, -3.0000000000000004, -3.3000000000000007, -3.2, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.0000000000000004, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.2, -3.3000000000000003, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -10.4, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.3000000000000003, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.5000000000000004, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2, -3.0000000000000004, -3.1000000000000005, -11.7, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.100000000000001, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -10.8, -3.2, -3.1000000000000005, -3.0000000000000004, -3.2, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.4000000000000004, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -3.0000000000000004, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.0000000000000004, -3.2, -3.1000000000000005, -3.1000000000000005, -3.2, -3.1000000000000005, -3.200000000000001, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.5, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.100000000000001, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.4000000000000004, -3.3000000000000003, -3.0000000000000004, -3.200000000000001, -3.2, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.0000000000000004, -3.3000000000000003, -3.200000000000001, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007], "episode_lengths": [1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.5225784724136, "mean_inference_ms": 17.531946700608504, "mean_action_processing_ms": 0.915339640540778, "mean_env_wait_ms": 2.299287865041114, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07006084363077589, "StateBufferConnector_ms": 0.008785415807536228, "ViewRequirementAgentConnector_ms": 0.12908537770800022}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -11.7, "episode_reward_mean": -3.3279792746114, "episode_len_mean": 20.72538860103627, "episodes_this_iter": 193, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10.0, -3.0000000000000004, -3.200000000000001, -3.0000000000000004, -3.2, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.5000000000000004, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.3000000000000003, -3.200000000000001, -3.1000000000000005, -3.0000000000000004, -3.2, -3.400000000000001, -3.1000000000000005, -3.400000000000001, -3.0000000000000004, -3.3000000000000007, -3.2, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.0000000000000004, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.2, -3.3000000000000003, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -10.4, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.3000000000000003, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.5000000000000004, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2, -3.0000000000000004, -3.1000000000000005, -11.7, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.100000000000001, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -10.8, -3.2, -3.1000000000000005, -3.0000000000000004, -3.2, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.4000000000000004, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -3.0000000000000004, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.0000000000000004, -3.2, -3.1000000000000005, -3.1000000000000005, -3.2, -3.1000000000000005, -3.200000000000001, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.5, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.100000000000001, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.4000000000000004, -3.3000000000000003, -3.0000000000000004, -3.200000000000001, -3.2, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.0000000000000004, -3.3000000000000003, -3.200000000000001, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007], "episode_lengths": [1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.5225784724136, "mean_inference_ms": 17.531946700608504, "mean_action_processing_ms": 0.915339640540778, "mean_env_wait_ms": 2.299287865041114, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07006084363077589, "StateBufferConnector_ms": 0.008785415807536228, "ViewRequirementAgentConnector_ms": 0.12908537770800022}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 676000, "num_agent_steps_trained": 676000, "num_env_steps_sampled": 676000, "num_env_steps_trained": 676000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 676000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 676000, "timers": {"training_iteration_time_ms": 170771.545, "load_time_ms": 1.166, "load_throughput": 3431134.016, "learn_time_ms": 169811.644, "learn_throughput": 23.556, "synch_weights_time_ms": 178.336}, "counters": {"num_env_steps_sampled": 676000, "num_env_steps_trained": 676000, "num_agent_steps_sampled": 676000, "num_agent_steps_trained": 676000}, "done": false, "episodes_total": 33775, "training_iteration": 169, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_04-57-25", "timestamp": 1680836245, "time_this_iter_s": 171.1812026500702, "time_total_s": 28890.75709915161, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7effc0123f70>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff9463bee0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 28890.75709915161, "timesteps_since_restore": 0, "iterations_since_restore": 169, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.531967213114754, "ram_util_percent": 23.900819672131146}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2402947250072673, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.16000213921670953, "policy_loss": -0.07372787529202078, "vf_loss": 0.20752781511795138, "vf_explained_var": 0.7619030635203085, "kl": 0.013631585282486394, "entropy": 3.147036829558752, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 157635.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 680000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -11.8, "episode_reward_mean": -3.5585492227979283, "episode_len_mean": 20.699481865284973, "episode_media": {}, "episodes_this_iter": 193, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -11.1, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.3000000000000003, -3.0000000000000004, -3.2000000000000006, -3.100000000000001, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.2, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.0000000000000004, -3.3000000000000003, -3.3000000000000003, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -11.5, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.2, -3.2000000000000006, -11.3, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -10.6, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.2, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.200000000000001, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.100000000000001, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.4000000000000004, -3.1000000000000005, -3.100000000000001, -3.2000000000000006, -3.100000000000001, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -11.8, -3.1000000000000005, -3.2, -3.2000000000000006, -3.400000000000001, -3.2, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.0000000000000004, -3.2000000000000006, -3.100000000000001, -3.2, -3.2, -3.1000000000000005, -3.1000000000000005, -11.3, -3.2000000000000006, -3.3000000000000003, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -11.8, -3.200000000000001, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -11.700000000000001, -3.2000000000000006, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.2, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.200000000000001, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.500000000000001, -3.400000000000001, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.100000000000001, -3.4000000000000004, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.500000000000001, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -11.8, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.200000000000001, -3.1000000000000005], "episode_lengths": [21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.522382906794116, "mean_inference_ms": 17.52456321047218, "mean_action_processing_ms": 0.9149861183599295, "mean_env_wait_ms": 2.295582851139655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07361303339350408, "StateBufferConnector_ms": 0.009306848357996174, "ViewRequirementAgentConnector_ms": 0.13509859075200373}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -11.8, "episode_reward_mean": -3.5585492227979283, "episode_len_mean": 20.699481865284973, "episodes_this_iter": 193, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -11.1, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.3000000000000003, -3.0000000000000004, -3.2000000000000006, -3.100000000000001, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.2, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.0000000000000004, -3.3000000000000003, -3.3000000000000003, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -11.5, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.2, -3.2000000000000006, -11.3, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -10.6, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.2, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.200000000000001, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.100000000000001, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.4000000000000004, -3.1000000000000005, -3.100000000000001, -3.2000000000000006, -3.100000000000001, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -11.8, -3.1000000000000005, -3.2, -3.2000000000000006, -3.400000000000001, -3.2, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.0000000000000004, -3.2000000000000006, -3.100000000000001, -3.2, -3.2, -3.1000000000000005, -3.1000000000000005, -11.3, -3.2000000000000006, -3.3000000000000003, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -11.8, -3.200000000000001, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -11.700000000000001, -3.2000000000000006, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.2, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.200000000000001, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.3000000000000007, -3.500000000000001, -3.400000000000001, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.100000000000001, -3.4000000000000004, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.500000000000001, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -11.8, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.200000000000001, -3.1000000000000005], "episode_lengths": [21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.522382906794116, "mean_inference_ms": 17.52456321047218, "mean_action_processing_ms": 0.9149861183599295, "mean_env_wait_ms": 2.295582851139655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07361303339350408, "StateBufferConnector_ms": 0.009306848357996174, "ViewRequirementAgentConnector_ms": 0.13509859075200373}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 680000, "num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 680000, "timers": {"training_iteration_time_ms": 170788.241, "load_time_ms": 1.163, "load_throughput": 3440280.518, "learn_time_ms": 169825.486, "learn_throughput": 23.554, "synch_weights_time_ms": 180.025}, "counters": {"num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 680000}, "done": false, "episodes_total": 33968, "training_iteration": 170, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_05-00-15", "timestamp": 1680836415, "time_this_iter_s": 170.58401536941528, "time_total_s": 29061.341114521027, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01473e2340>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff94615550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 29061.341114521027, "timesteps_since_restore": 0, "iterations_since_restore": 170, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.5847107438016526, "ram_util_percent": 23.900413223140493}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5716180775915423, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.0002921674731037309, "policy_loss": -0.08258332052838899, "vf_loss": 0.05412591148358119, "vf_explained_var": 0.8884854338502371, "kl": 0.014956848114235727, "entropy": 3.116018230940706, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 158565.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -10.9, "episode_reward_mean": -3.3015706806282727, "episode_len_mean": 20.785340314136125, "episode_media": {}, "episodes_this_iter": 191, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.2, -3.2000000000000006, -3.2000000000000006, -3.5000000000000004, -3.5, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2, -3.200000000000001, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.4000000000000004, -3.2, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.200000000000001, -10.9, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.200000000000001, -3.3000000000000003, -3.4000000000000004, -3.2, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.200000000000001, -3.1000000000000005, -3.1000000000000005, -3.4000000000000004, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2, -3.1000000000000005, -3.200000000000001, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.4000000000000004, -3.1000000000000005, -3.400000000000001, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.0000000000000004, -3.3000000000000003, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.4000000000000012, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.200000000000001, -3.1000000000000005, -10.8, -3.100000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2, -3.0000000000000004, -3.0000000000000004, -3.0000000000000004, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.0000000000000004, -3.500000000000001, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.2, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.100000000000001, -3.0000000000000004, -3.2000000000000006, -3.3000000000000003, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.2, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.2, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.300000000000001, -3.400000000000001, -3.0000000000000004, -3.4000000000000004, -3.3000000000000003, -3.2, -3.100000000000001, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.500000000000001, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006], "episode_lengths": [3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.521884878245062, "mean_inference_ms": 17.534176348645225, "mean_action_processing_ms": 0.9151558563471506, "mean_env_wait_ms": 2.2979425986359137, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07749103126725601, "StateBufferConnector_ms": 0.009989738464355469, "ViewRequirementAgentConnector_ms": 0.14158169012419217}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -10.9, "episode_reward_mean": -3.3015706806282727, "episode_len_mean": 20.785340314136125, "episodes_this_iter": 191, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10.2, -3.2000000000000006, -3.2000000000000006, -3.5000000000000004, -3.5, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2, -3.200000000000001, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.4000000000000004, -3.2, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.200000000000001, -10.9, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.200000000000001, -3.3000000000000003, -3.4000000000000004, -3.2, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.200000000000001, -3.1000000000000005, -3.1000000000000005, -3.4000000000000004, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2, -3.1000000000000005, -3.200000000000001, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.4000000000000004, -3.1000000000000005, -3.400000000000001, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.0000000000000004, -3.3000000000000003, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.4000000000000012, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.200000000000001, -3.1000000000000005, -10.8, -3.100000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2, -3.0000000000000004, -3.0000000000000004, -3.0000000000000004, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.0000000000000004, -3.500000000000001, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.2, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.100000000000001, -3.0000000000000004, -3.2000000000000006, -3.3000000000000003, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.2, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.2, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.300000000000001, -3.400000000000001, -3.0000000000000004, -3.4000000000000004, -3.3000000000000003, -3.2, -3.100000000000001, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.500000000000001, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006], "episode_lengths": [3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.521884878245062, "mean_inference_ms": 17.534176348645225, "mean_action_processing_ms": 0.9151558563471506, "mean_env_wait_ms": 2.2979425986359137, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07749103126725601, "StateBufferConnector_ms": 0.009989738464355469, "ViewRequirementAgentConnector_ms": 0.14158169012419217}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 684000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 684000, "timers": {"training_iteration_time_ms": 170777.11, "load_time_ms": 1.169, "load_throughput": 3422385.052, "learn_time_ms": 169811.409, "learn_throughput": 23.556, "synch_weights_time_ms": 184.187}, "counters": {"num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "done": false, "episodes_total": 34159, "training_iteration": 171, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_05-03-06", "timestamp": 1680836586, "time_this_iter_s": 170.8729965686798, "time_total_s": 29232.214111089706, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7eff946516d0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff94615040>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 29232.214111089706, "timesteps_since_restore": 0, "iterations_since_restore": 171, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 6.158436213991769, "ram_util_percent": 23.900411522633743}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5377755733987977, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.16017358596286466, "policy_loss": -0.031137494470483515, "vf_loss": 0.17510383398051785, "vf_explained_var": 0.763661680939377, "kl": 0.008431752681637043, "entropy": 3.1300913600511446, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 159495.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "sampler_results": {"episode_reward_max": 99.5, "episode_reward_min": -12.100000000000001, "episode_reward_mean": -1.8651041666666675, "episode_len_mean": 20.473958333333332, "episode_media": {}, "episodes_this_iter": 192, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0000000000000004, -10.9, -3.0000000000000004, -3.0000000000000004, -3.4000000000000004, -3.0000000000000004, 99.5, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.2, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.0000000000000004, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.5000000000000004, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.200000000000001, -3.1000000000000005, -3.1000000000000005, -3.300000000000001, -3.4000000000000012, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.100000000000001, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.2, -3.1000000000000005, -10.4, -10.8, -11.2, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2, -3.4000000000000004, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -3.2, -3.400000000000001, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.6000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, 97.9, -12.100000000000001, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.3000000000000003, -3.2000000000000006, -3.2, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -11.5, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.4000000000000004, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -10.0, -3.200000000000001, -3.1000000000000005, -3.200000000000001, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.100000000000001, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.300000000000001, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.5000000000000004, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.500000000000001, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.200000000000001, -3.3000000000000007, -3.2, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, 99.0, -3.3000000000000003, -3.0000000000000004], "episode_lengths": [21, 10, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 9, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.520624979898864, "mean_inference_ms": 17.535551749859096, "mean_action_processing_ms": 0.9152765255802121, "mean_env_wait_ms": 2.300762678303022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07627010345458984, "StateBufferConnector_ms": 0.009450192252794901, "ViewRequirementAgentConnector_ms": 0.1407968501249949}}, "episode_reward_max": 99.5, "episode_reward_min": -12.100000000000001, "episode_reward_mean": -1.8651041666666675, "episode_len_mean": 20.473958333333332, "episodes_this_iter": 192, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.0000000000000004, -10.9, -3.0000000000000004, -3.0000000000000004, -3.4000000000000004, -3.0000000000000004, 99.5, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.2, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.0000000000000004, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.5000000000000004, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.200000000000001, -3.1000000000000005, -3.1000000000000005, -3.300000000000001, -3.4000000000000012, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.100000000000001, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.2, -3.1000000000000005, -10.4, -10.8, -11.2, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2, -3.4000000000000004, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -3.2, -3.400000000000001, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.6000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, 97.9, -12.100000000000001, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.3000000000000003, -3.2000000000000006, -3.2, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -11.5, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.4000000000000004, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -10.0, -3.200000000000001, -3.1000000000000005, -3.200000000000001, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.100000000000001, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.300000000000001, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.5000000000000004, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.500000000000001, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.200000000000001, -3.3000000000000007, -3.2, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, 99.0, -3.3000000000000003, -3.0000000000000004], "episode_lengths": [21, 10, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 9, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.520624979898864, "mean_inference_ms": 17.535551749859096, "mean_action_processing_ms": 0.9152765255802121, "mean_env_wait_ms": 2.300762678303022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07627010345458984, "StateBufferConnector_ms": 0.009450192252794901, "ViewRequirementAgentConnector_ms": 0.1407968501249949}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000, "num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 688000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 688000, "timers": {"training_iteration_time_ms": 170800.029, "load_time_ms": 1.169, "load_throughput": 3421477.72, "learn_time_ms": 169830.281, "learn_throughput": 23.553, "synch_weights_time_ms": 183.556}, "counters": {"num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "done": false, "episodes_total": 34351, "training_iteration": 172, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_05-05-58", "timestamp": 1680836758, "time_this_iter_s": 171.35057997703552, "time_total_s": 29403.564691066742, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01475a5250>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff946151f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 29403.564691066742, "timesteps_since_restore": 0, "iterations_since_restore": 172, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.53811475409836, "ram_util_percent": 23.900819672131146}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4940787123095605, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.09221546172554936, "policy_loss": -0.07072622081895749, "vf_loss": 0.1354637236900187, "vf_explained_var": 0.8243578191726438, "kl": 0.014295293893277024, "entropy": 3.121987473580145, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 160425.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 692000, "num_env_steps_trained": 692000, "num_agent_steps_sampled": 692000, "num_agent_steps_trained": 692000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.0, "episode_reward_mean": -3.4105527638190964, "episode_len_mean": 20.633165829145728, "episode_media": {}, "episodes_this_iter": 199, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2, -10.9, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -12.0, -3.0000000000000004, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.2, -3.400000000000001, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.200000000000001, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.100000000000001, -3.3000000000000007, -3.2, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2, -3.0000000000000004, -3.5000000000000004, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.3000000000000003, -3.0000000000000004, -11.3, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.5, -3.1000000000000005, -3.200000000000001, -3.3000000000000007, -3.100000000000001, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.6000000000000005, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.300000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -10.0, -3.2, -3.500000000000001, -3.2000000000000006, -10.1, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -10.8, -3.2, -3.3000000000000007, -3.0000000000000004, -3.3000000000000003, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.300000000000001, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.3000000000000003, -3.0000000000000004, -3.100000000000001, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.4000000000000004, -3.1000000000000005, -3.3000000000000003, -3.100000000000001, -3.3000000000000003, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.400000000000001, -3.2, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.400000000000001, -3.200000000000001, -3.2, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.500000000000001, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.51974023178082, "mean_inference_ms": 17.527092918255903, "mean_action_processing_ms": 0.9151253506243701, "mean_env_wait_ms": 2.303713102809367, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07358088565232167, "StateBufferConnector_ms": 0.009072366072304884, "ViewRequirementAgentConnector_ms": 0.13459795084430945}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.0, "episode_reward_mean": -3.4105527638190964, "episode_len_mean": 20.633165829145728, "episodes_this_iter": 199, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2, -10.9, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -12.0, -3.0000000000000004, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.2, -3.400000000000001, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.200000000000001, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.100000000000001, -3.3000000000000007, -3.2, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2, -3.0000000000000004, -3.5000000000000004, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.3000000000000003, -3.0000000000000004, -11.3, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.5, -3.1000000000000005, -3.200000000000001, -3.3000000000000007, -3.100000000000001, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.6000000000000005, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.300000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -10.0, -3.2, -3.500000000000001, -3.2000000000000006, -10.1, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -10.8, -3.2, -3.3000000000000007, -3.0000000000000004, -3.3000000000000003, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.300000000000001, -3.2000000000000006, -3.4000000000000004, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.3000000000000003, -3.0000000000000004, -3.100000000000001, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.4000000000000004, -3.1000000000000005, -3.3000000000000003, -3.100000000000001, -3.3000000000000003, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.400000000000001, -3.2, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.400000000000001, -3.200000000000001, -3.2, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.500000000000001, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.51974023178082, "mean_inference_ms": 17.527092918255903, "mean_action_processing_ms": 0.9151253506243701, "mean_env_wait_ms": 2.303713102809367, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07358088565232167, "StateBufferConnector_ms": 0.009072366072304884, "ViewRequirementAgentConnector_ms": 0.13459795084430945}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 692000, "num_agent_steps_trained": 692000, "num_env_steps_sampled": 692000, "num_env_steps_trained": 692000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 692000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 692000, "timers": {"training_iteration_time_ms": 170741.126, "load_time_ms": 1.169, "load_throughput": 3420849.849, "learn_time_ms": 169778.924, "learn_throughput": 23.56, "synch_weights_time_ms": 182.455}, "counters": {"num_env_steps_sampled": 692000, "num_env_steps_trained": 692000, "num_agent_steps_sampled": 692000, "num_agent_steps_trained": 692000}, "done": false, "episodes_total": 34550, "training_iteration": 173, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_05-08-48", "timestamp": 1680836928, "time_this_iter_s": 170.49546480178833, "time_total_s": 29574.06015586853, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7eff946d3850>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff94615040>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 29574.06015586853, "timesteps_since_restore": 0, "iterations_since_restore": 173, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.34586776859504, "ram_util_percent": 23.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7864220755395068, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.13146878514559038, "policy_loss": -0.06900966012429806, "vf_loss": 0.17419301376637994, "vf_explained_var": 0.7632692431249927, "kl": 0.013674887788221641, "entropy": 3.115500437572438, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 161355.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -11.700000000000001, "episode_reward_mean": -3.5214659685863876, "episode_len_mean": 20.602094240837697, "episode_media": {}, "episodes_this_iter": 191, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3000000000000003, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.600000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.4000000000000004, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -11.6, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.0000000000000004, -3.0000000000000004, -3.400000000000001, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.200000000000001, -3.3000000000000003, -3.200000000000001, -3.2000000000000006, -3.0000000000000004, -3.2, -3.100000000000001, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.2, -11.700000000000001, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -11.4, -3.200000000000001, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.500000000000001, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.400000000000001, -3.100000000000001, -10.0, -3.6000000000000005, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.0000000000000004, -3.4000000000000004, -3.2000000000000006, -3.400000000000001, -10.3, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.2, -3.1000000000000005, -3.400000000000001, -10.5, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -11.700000000000001, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.2, -3.3000000000000007, -3.2000000000000006, -11.4, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.200000000000001, -3.0000000000000004, -3.2000000000000006, -3.400000000000001, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.519115574954574, "mean_inference_ms": 17.525741883442002, "mean_action_processing_ms": 0.9154980032515263, "mean_env_wait_ms": 2.3015132960658904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07509748349015001, "StateBufferConnector_ms": 0.00944874049481297, "ViewRequirementAgentConnector_ms": 0.14003034661577635}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -11.700000000000001, "episode_reward_mean": -3.5214659685863876, "episode_len_mean": 20.602094240837697, "episodes_this_iter": 191, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.3000000000000003, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.600000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.400000000000001, -3.4000000000000004, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -11.6, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.0000000000000004, -3.0000000000000004, -3.400000000000001, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.200000000000001, -3.3000000000000003, -3.200000000000001, -3.2000000000000006, -3.0000000000000004, -3.2, -3.100000000000001, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.2, -11.700000000000001, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -11.4, -3.200000000000001, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.500000000000001, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.400000000000001, -3.100000000000001, -10.0, -3.6000000000000005, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.0000000000000004, -3.4000000000000004, -3.2000000000000006, -3.400000000000001, -10.3, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.2, -3.1000000000000005, -3.400000000000001, -10.5, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -11.700000000000001, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.2, -3.3000000000000007, -3.2000000000000006, -11.4, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.400000000000001, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.200000000000001, -3.0000000000000004, -3.2000000000000006, -3.400000000000001, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.519115574954574, "mean_inference_ms": 17.525741883442002, "mean_action_processing_ms": 0.9154980032515263, "mean_env_wait_ms": 2.3015132960658904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07509748349015001, "StateBufferConnector_ms": 0.00944874049481297, "ViewRequirementAgentConnector_ms": 0.14003034661577635}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 696000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 696000, "timers": {"training_iteration_time_ms": 170781.045, "load_time_ms": 1.173, "load_throughput": 3411181.912, "learn_time_ms": 169823.723, "learn_throughput": 23.554, "synch_weights_time_ms": 181.113}, "counters": {"num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000}, "done": false, "episodes_total": 34741, "training_iteration": 174, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_05-11-39", "timestamp": 1680837099, "time_this_iter_s": 170.97223567962646, "time_total_s": 29745.032391548157, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0147659c10>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff945f7820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 29745.032391548157, "timesteps_since_restore": 0, "iterations_since_restore": 174, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.3234567901234575, "ram_util_percent": 23.90164609053498}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.554434408295539, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.2184840084644415, "policy_loss": -0.082208414556038, "vf_loss": 0.27354652681137603, "vf_explained_var": 0.659253102925516, "kl": 0.01412254016156689, "entropy": 3.0968423635728897, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 162285.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_agent_steps_sampled": 700000, "num_agent_steps_trained": 700000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.3, "episode_reward_mean": -3.7380208333333336, "episode_len_mean": 20.447916666666668, "episode_media": {}, "episodes_this_iter": 192, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.5000000000000004, -3.3000000000000007, -3.2, -3.3000000000000003, -3.1000000000000005, -3.5000000000000004, -11.3, -3.2, -3.5000000000000004, -3.200000000000001, -3.2, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -11.0, -3.3000000000000007, -3.3000000000000007, -3.4000000000000012, -3.1000000000000005, -3.1000000000000005, -3.2, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.100000000000001, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.400000000000001, -3.4000000000000004, -3.100000000000001, -3.2000000000000006, -3.1000000000000005, -3.2, -3.0000000000000004, -3.0000000000000004, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2, -3.500000000000001, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.100000000000001, -3.3000000000000003, -3.400000000000001, -3.2000000000000006, -3.5000000000000004, -3.1000000000000005, -3.0000000000000004, -3.3000000000000003, -3.2, -3.3000000000000007, -3.3000000000000007, -3.3000000000000003, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.0000000000000004, -3.2000000000000006, -3.2, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.0000000000000004, -3.0000000000000004, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.2, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -11.1, -3.400000000000001, -3.200000000000001, -11.9, -3.3000000000000003, -3.1000000000000005, -3.2, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -11.5, -3.0000000000000004, -3.0000000000000004, -10.5, -3.0000000000000004, -10.7, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -11.0, -11.2, -3.2000000000000006, -3.4000000000000004, -3.2, -3.2000000000000006, -3.2000000000000006, -3.100000000000001, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.2, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -12.3, -11.4, -3.1000000000000005, -3.400000000000001, -3.3000000000000003, -3.4000000000000004, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.2, -3.2000000000000006, -3.3000000000000003, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -10.9, -3.0000000000000004, -11.8, -3.2000000000000006, -3.5000000000000004, -3.3000000000000007, -3.3000000000000007, -3.300000000000001, -3.2000000000000006, -3.0000000000000004], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 6, 21, 8, 21, 21, 21, 21, 21, 21, 10, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 18, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.520906282290724, "mean_inference_ms": 17.538428277849846, "mean_action_processing_ms": 0.9158169644101171, "mean_env_wait_ms": 2.304973946725552, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0754458208878835, "StateBufferConnector_ms": 0.01003133753935496, "ViewRequirementAgentConnector_ms": 0.14184887210528055}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.3, "episode_reward_mean": -3.7380208333333336, "episode_len_mean": 20.447916666666668, "episodes_this_iter": 192, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.5000000000000004, -3.3000000000000007, -3.2, -3.3000000000000003, -3.1000000000000005, -3.5000000000000004, -11.3, -3.2, -3.5000000000000004, -3.200000000000001, -3.2, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -11.0, -3.3000000000000007, -3.3000000000000007, -3.4000000000000012, -3.1000000000000005, -3.1000000000000005, -3.2, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.100000000000001, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.400000000000001, -3.4000000000000004, -3.100000000000001, -3.2000000000000006, -3.1000000000000005, -3.2, -3.0000000000000004, -3.0000000000000004, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2, -3.500000000000001, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.100000000000001, -3.3000000000000003, -3.400000000000001, -3.2000000000000006, -3.5000000000000004, -3.1000000000000005, -3.0000000000000004, -3.3000000000000003, -3.2, -3.3000000000000007, -3.3000000000000007, -3.3000000000000003, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.0000000000000004, -3.2000000000000006, -3.2, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.0000000000000004, -3.0000000000000004, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.2, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -11.1, -3.400000000000001, -3.200000000000001, -11.9, -3.3000000000000003, -3.1000000000000005, -3.2, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -11.5, -3.0000000000000004, -3.0000000000000004, -10.5, -3.0000000000000004, -10.7, -3.3000000000000007, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -11.0, -11.2, -3.2000000000000006, -3.4000000000000004, -3.2, -3.2000000000000006, -3.2000000000000006, -3.100000000000001, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.2, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -12.3, -11.4, -3.1000000000000005, -3.400000000000001, -3.3000000000000003, -3.4000000000000004, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.2, -3.2000000000000006, -3.3000000000000003, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -10.9, -3.0000000000000004, -11.8, -3.2000000000000006, -3.5000000000000004, -3.3000000000000007, -3.3000000000000007, -3.300000000000001, -3.2000000000000006, -3.0000000000000004], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 6, 21, 8, 21, 21, 21, 21, 21, 21, 10, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 18, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.520906282290724, "mean_inference_ms": 17.538428277849846, "mean_action_processing_ms": 0.9158169644101171, "mean_env_wait_ms": 2.304973946725552, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0754458208878835, "StateBufferConnector_ms": 0.01003133753935496, "ViewRequirementAgentConnector_ms": 0.14184887210528055}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 700000, "num_agent_steps_trained": 700000, "num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 700000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 700000, "timers": {"training_iteration_time_ms": 170780.976, "load_time_ms": 1.164, "load_throughput": 3436686.468, "learn_time_ms": 169798.173, "learn_throughput": 23.557, "synch_weights_time_ms": 181.67}, "counters": {"num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_agent_steps_sampled": 700000, "num_agent_steps_trained": 700000}, "done": false, "episodes_total": 34933, "training_iteration": 175, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_05-14-30", "timestamp": 1680837270, "time_this_iter_s": 171.06468200683594, "time_total_s": 29916.097073554993, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7eff946f6220>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff946151f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 29916.097073554993, "timesteps_since_restore": 0, "iterations_since_restore": 175, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.337448559670782, "ram_util_percent": 23.900411522633743}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7178313787425719, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.07357619795547699, "policy_loss": -0.07972410378116433, "vf_loss": 0.12863467186288807, "vf_explained_var": 0.7817724218932531, "kl": 0.012832191747692113, "entropy": 3.1114889575589086, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 163215.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.0, "episode_reward_mean": -3.5000000000000004, "episode_len_mean": 20.578680203045685, "episode_media": {}, "episodes_this_iter": 197, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.2000000000000006, -3.300000000000001, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -11.8, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.2, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.100000000000001, -3.1000000000000005, -3.400000000000001, -11.0, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.100000000000001, -3.2000000000000006, -3.2, -3.300000000000001, -3.2000000000000006, -3.0000000000000004, -3.2, -3.100000000000001, -3.0000000000000004, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -11.3, -10.1, -3.1000000000000005, -11.0, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.4000000000000004, -3.0000000000000004, -3.2000000000000006, -3.4000000000000004, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.300000000000001, -3.400000000000001, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.100000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.5000000000000004, -3.2, -3.2, -3.2000000000000006, -3.2, -3.2000000000000006, -3.0000000000000004, -10.3, -3.2000000000000006, -3.0000000000000004, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.4000000000000004, -3.1000000000000005, -3.5000000000000004, -3.600000000000001, -3.3000000000000003, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.2, -3.400000000000001, -3.0000000000000004, -3.2000000000000006, -3.200000000000001, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.400000000000001, -3.200000000000001, -3.400000000000001, -3.6000000000000005, -3.2000000000000006, -3.5000000000000004, -12.0, -10.6, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 2, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 7, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.519230680206245, "mean_inference_ms": 17.526107126802522, "mean_action_processing_ms": 0.9151165528522683, "mean_env_wait_ms": 2.302090805864874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07440160373745835, "StateBufferConnector_ms": 0.009013674585952371, "ViewRequirementAgentConnector_ms": 0.13520536083860446}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.0, "episode_reward_mean": -3.5000000000000004, "episode_len_mean": 20.578680203045685, "episodes_this_iter": 197, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.2000000000000006, -3.300000000000001, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -11.8, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.2, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.100000000000001, -3.1000000000000005, -3.400000000000001, -11.0, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.100000000000001, -3.2000000000000006, -3.2, -3.300000000000001, -3.2000000000000006, -3.0000000000000004, -3.2, -3.100000000000001, -3.0000000000000004, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -11.3, -10.1, -3.1000000000000005, -11.0, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.3000000000000007, -3.4000000000000004, -3.0000000000000004, -3.2000000000000006, -3.4000000000000004, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.300000000000001, -3.400000000000001, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.100000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.5000000000000004, -3.2, -3.2, -3.2000000000000006, -3.2, -3.2000000000000006, -3.0000000000000004, -10.3, -3.2000000000000006, -3.0000000000000004, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.4000000000000004, -3.1000000000000005, -3.5000000000000004, -3.600000000000001, -3.3000000000000003, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.2, -3.400000000000001, -3.0000000000000004, -3.2000000000000006, -3.200000000000001, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.400000000000001, -3.200000000000001, -3.400000000000001, -3.6000000000000005, -3.2000000000000006, -3.5000000000000004, -12.0, -10.6, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 2, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 7, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.519230680206245, "mean_inference_ms": 17.526107126802522, "mean_action_processing_ms": 0.9151165528522683, "mean_env_wait_ms": 2.302090805864874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07440160373745835, "StateBufferConnector_ms": 0.009013674585952371, "ViewRequirementAgentConnector_ms": 0.13520536083860446}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000, "num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 704000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 704000, "timers": {"training_iteration_time_ms": 170818.675, "load_time_ms": 1.139, "load_throughput": 3511935.025, "learn_time_ms": 169836.24, "learn_throughput": 23.552, "synch_weights_time_ms": 183.337}, "counters": {"num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "done": false, "episodes_total": 35130, "training_iteration": 176, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_05-17-21", "timestamp": 1680837441, "time_this_iter_s": 170.77504229545593, "time_total_s": 30086.87211585045, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7eff946f6730>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff945f79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 30086.87211585045, "timesteps_since_restore": 0, "iterations_since_restore": 176, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.577777777777778, "ram_util_percent": 23.90164609053498}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1976981417626462, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.28353017479261405, "policy_loss": -0.08880895055199582, "vf_loss": 0.34354707008322843, "vf_explained_var": 0.6619303727021781, "kl": 0.01497894835458713, "entropy": 3.1079560110645907, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 164145.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -11.9, "episode_reward_mean": -3.8180904522613073, "episode_len_mean": 20.276381909547737, "episode_media": {}, "episodes_this_iter": 199, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.0000000000000004, -3.300000000000001, -11.8, -3.1000000000000005, -10.4, -10.8, -10.9, -3.2, -3.500000000000001, -3.3000000000000007, -3.200000000000001, -3.2, -3.3000000000000003, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.100000000000001, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.3000000000000003, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -11.9, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.4000000000000004, -3.100000000000001, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -11.700000000000001, -3.0000000000000004, -3.400000000000001, -3.2, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.600000000000001, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.100000000000001, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -10.3, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.4000000000000004, -3.5000000000000004, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.3000000000000003, -3.0000000000000004, -3.200000000000001, -3.1000000000000005, -3.3000000000000003, -3.0000000000000004, -3.2000000000000006, -3.4000000000000004, -3.100000000000001, -3.1000000000000005, -10.7, -3.100000000000001, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -10.6, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -11.5, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -11.8, -3.2000000000000006, -3.2, -11.9, -3.1000000000000005, -3.0000000000000004, -11.4, -3.2, -10.4, -11.3, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.2, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.2, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.4000000000000004, -11.2, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.2, -3.2, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 17, 21, 5, 9, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 17, 21, 21, 18, 21, 21, 15, 21, 5, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.518212867370613, "mean_inference_ms": 17.540486640608233, "mean_action_processing_ms": 0.9161924566048284, "mean_env_wait_ms": 2.306338508527364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07600868167589657, "StateBufferConnector_ms": 0.00898598426550477, "ViewRequirementAgentConnector_ms": 0.13719827086482217}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -11.9, "episode_reward_mean": -3.8180904522613073, "episode_len_mean": 20.276381909547737, "episodes_this_iter": 199, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.0000000000000004, -3.300000000000001, -11.8, -3.1000000000000005, -10.4, -10.8, -10.9, -3.2, -3.500000000000001, -3.3000000000000007, -3.200000000000001, -3.2, -3.3000000000000003, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.100000000000001, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.3000000000000003, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.4000000000000004, -3.2000000000000006, -11.9, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.4000000000000004, -3.100000000000001, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -11.700000000000001, -3.0000000000000004, -3.400000000000001, -3.2, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.600000000000001, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.100000000000001, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -10.3, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.4000000000000004, -3.5000000000000004, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.3000000000000003, -3.0000000000000004, -3.200000000000001, -3.1000000000000005, -3.3000000000000003, -3.0000000000000004, -3.2000000000000006, -3.4000000000000004, -3.100000000000001, -3.1000000000000005, -10.7, -3.100000000000001, -3.400000000000001, -3.3000000000000007, -3.400000000000001, -3.3000000000000007, -10.6, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -11.5, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -11.8, -3.2000000000000006, -3.2, -11.9, -3.1000000000000005, -3.0000000000000004, -11.4, -3.2, -10.4, -11.3, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.2, -3.3000000000000003, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.1000000000000005, -3.2, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.4000000000000004, -11.2, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.2, -3.2, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 17, 21, 5, 9, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 17, 21, 21, 18, 21, 21, 15, 21, 5, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.518212867370613, "mean_inference_ms": 17.540486640608233, "mean_action_processing_ms": 0.9161924566048284, "mean_env_wait_ms": 2.306338508527364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07600868167589657, "StateBufferConnector_ms": 0.00898598426550477, "ViewRequirementAgentConnector_ms": 0.13719827086482217}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 708000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 708000, "timers": {"training_iteration_time_ms": 170804.174, "load_time_ms": 1.136, "load_throughput": 3521813.678, "learn_time_ms": 169818.747, "learn_throughput": 23.555, "synch_weights_time_ms": 184.815}, "counters": {"num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000}, "done": false, "episodes_total": 35329, "training_iteration": 177, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_05-20-12", "timestamp": 1680837612, "time_this_iter_s": 170.50041508674622, "time_total_s": 30257.372530937195, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01475e26d0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff945f0e50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 30257.372530937195, "timesteps_since_restore": 0, "iterations_since_restore": 177, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.365843621399177, "ram_util_percent": 23.901234567901234}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1163192986320425, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.10901580714590607, "policy_loss": -0.02097136148690341, "vf_loss": 0.11744482636787197, "vf_explained_var": 0.7966697631343719, "kl": 0.006525102583879244, "entropy": 3.089044806521426, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 165075.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_agent_steps_sampled": 712000, "num_agent_steps_trained": 712000}, "sampler_results": {"episode_reward_max": 98.7, "episode_reward_min": -11.5, "episode_reward_mean": -2.3494791666666672, "episode_len_mean": 20.526041666666668, "episode_media": {}, "episodes_this_iter": 192, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.6, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.200000000000001, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.400000000000001, -3.100000000000001, -3.3000000000000007, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -10.9, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.200000000000001, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.3000000000000007, -3.200000000000001, -3.300000000000001, -3.2000000000000006, -3.1000000000000005, -3.200000000000001, -3.0000000000000004, -3.200000000000001, -3.0000000000000004, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2, -3.3000000000000007, -3.0000000000000004, -3.5000000000000004, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2, -3.5000000000000004, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.100000000000001, -3.4000000000000004, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.2, -3.1000000000000005, -3.2000000000000006, -3.100000000000001, -3.1000000000000005, -3.0000000000000004, -3.3000000000000003, -3.200000000000001, -3.200000000000001, 98.7, -3.1000000000000005, -3.5000000000000004, 98.7, -11.3, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.2, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -10.2, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -10.2, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -3.100000000000001, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.100000000000001, -3.100000000000001, -3.1000000000000005, -3.2000000000000006, -3.2, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.100000000000001, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -11.5, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.500000000000001, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.0000000000000004, -3.3000000000000003, -3.0000000000000004, -3.100000000000001, -3.2000000000000006, -3.100000000000001, -3.3000000000000003, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005], "episode_lengths": [7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 13, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.51920947744964, "mean_inference_ms": 17.531122830625353, "mean_action_processing_ms": 0.9149474873029928, "mean_env_wait_ms": 2.3007402947129107, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0704812506834666, "StateBufferConnector_ms": 0.008704637487729391, "ViewRequirementAgentConnector_ms": 0.12982375919818878}}, "episode_reward_max": 98.7, "episode_reward_min": -11.5, "episode_reward_mean": -2.3494791666666672, "episode_len_mean": 20.526041666666668, "episodes_this_iter": 192, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10.6, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.200000000000001, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.400000000000001, -3.100000000000001, -3.3000000000000007, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -10.9, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.200000000000001, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.3000000000000007, -3.200000000000001, -3.300000000000001, -3.2000000000000006, -3.1000000000000005, -3.200000000000001, -3.0000000000000004, -3.200000000000001, -3.0000000000000004, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2, -3.3000000000000007, -3.0000000000000004, -3.5000000000000004, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2, -3.5000000000000004, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.100000000000001, -3.4000000000000004, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.2, -3.1000000000000005, -3.2000000000000006, -3.100000000000001, -3.1000000000000005, -3.0000000000000004, -3.3000000000000003, -3.200000000000001, -3.200000000000001, 98.7, -3.1000000000000005, -3.5000000000000004, 98.7, -11.3, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.2, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -10.2, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -10.2, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -3.100000000000001, -3.3000000000000007, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.100000000000001, -3.100000000000001, -3.1000000000000005, -3.2000000000000006, -3.2, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.100000000000001, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -11.5, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.500000000000001, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.0000000000000004, -3.3000000000000003, -3.0000000000000004, -3.100000000000001, -3.2000000000000006, -3.100000000000001, -3.3000000000000003, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005], "episode_lengths": [7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 13, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.51920947744964, "mean_inference_ms": 17.531122830625353, "mean_action_processing_ms": 0.9149474873029928, "mean_env_wait_ms": 2.3007402947129107, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0704812506834666, "StateBufferConnector_ms": 0.008704637487729391, "ViewRequirementAgentConnector_ms": 0.12982375919818878}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 712000, "num_agent_steps_trained": 712000, "num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 712000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 712000, "timers": {"training_iteration_time_ms": 170797.516, "load_time_ms": 1.145, "load_throughput": 3492488.447, "learn_time_ms": 169816.273, "learn_throughput": 23.555, "synch_weights_time_ms": 183.002}, "counters": {"num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_agent_steps_sampled": 712000, "num_agent_steps_trained": 712000}, "done": false, "episodes_total": 35521, "training_iteration": 178, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_05-23-02", "timestamp": 1680837782, "time_this_iter_s": 170.2938792705536, "time_total_s": 30427.66641020775, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01475e2d30>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff945ba040>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 30427.66641020775, "timesteps_since_restore": 0, "iterations_since_restore": 178, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.313223140495868, "ram_util_percent": 23.900413223140493}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4243441891926591, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.1020139649530412, "policy_loss": -0.06922301377673003, "vf_loss": 0.1425043223278036, "vf_explained_var": 0.8626447490466538, "kl": 0.014948046774717965, "entropy": 3.1037565690214914, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 166005.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 716000, "num_env_steps_trained": 716000, "num_agent_steps_sampled": 716000, "num_agent_steps_trained": 716000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -11.8, "episode_reward_mean": -3.3893401015228433, "episode_len_mean": 20.619289340101524, "episode_media": {}, "episodes_this_iter": 197, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.1000000000000005, -10.0, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.4000000000000004, -3.3000000000000007, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.300000000000001, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.100000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.3000000000000003, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.100000000000001, -3.2, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.0000000000000004, -3.0000000000000004, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.0000000000000004, -3.1000000000000005, -3.3000000000000003, -10.6, -3.1000000000000005, -3.1000000000000005, -3.2, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.2, -10.5, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.0000000000000004, -10.9, -3.200000000000001, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.5000000000000004, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.2, -3.200000000000001, -3.3000000000000007, -3.1000000000000005, -3.2, -3.4000000000000004, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.300000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.200000000000001, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -11.0, -3.1000000000000005, -3.3000000000000007, -11.8], "episode_lengths": [21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.517488305309007, "mean_inference_ms": 17.52657924805599, "mean_action_processing_ms": 0.9149657747977651, "mean_env_wait_ms": 2.304306534947281, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07696514807376764, "StateBufferConnector_ms": 0.009160114423877697, "ViewRequirementAgentConnector_ms": 0.1386846987729145}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -11.8, "episode_reward_mean": -3.3893401015228433, "episode_len_mean": 20.619289340101524, "episodes_this_iter": 197, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.1000000000000005, -10.0, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.4000000000000004, -3.3000000000000007, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.300000000000001, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.100000000000001, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.3000000000000003, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.100000000000001, -3.2, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.0000000000000004, -3.0000000000000004, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.0000000000000004, -3.1000000000000005, -3.3000000000000003, -10.6, -3.1000000000000005, -3.1000000000000005, -3.2, -3.3000000000000007, -3.4000000000000004, -3.2000000000000006, -3.2, -10.5, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.0000000000000004, -10.9, -3.200000000000001, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.5000000000000004, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.2, -3.200000000000001, -3.3000000000000007, -3.1000000000000005, -3.2, -3.4000000000000004, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.4000000000000004, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.300000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.200000000000001, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -11.0, -3.1000000000000005, -3.3000000000000007, -11.8], "episode_lengths": [21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.517488305309007, "mean_inference_ms": 17.52657924805599, "mean_action_processing_ms": 0.9149657747977651, "mean_env_wait_ms": 2.304306534947281, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07696514807376764, "StateBufferConnector_ms": 0.009160114423877697, "ViewRequirementAgentConnector_ms": 0.1386846987729145}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 716000, "num_agent_steps_trained": 716000, "num_env_steps_sampled": 716000, "num_env_steps_trained": 716000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 716000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 716000, "timers": {"training_iteration_time_ms": 170787.313, "load_time_ms": 1.143, "load_throughput": 3501015.421, "learn_time_ms": 169802.517, "learn_throughput": 23.557, "synch_weights_time_ms": 183.428}, "counters": {"num_env_steps_sampled": 716000, "num_env_steps_trained": 716000, "num_agent_steps_sampled": 716000, "num_agent_steps_trained": 716000}, "done": false, "episodes_total": 35718, "training_iteration": 179, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_05-25-53", "timestamp": 1680837953, "time_this_iter_s": 171.08101892471313, "time_total_s": 30598.74742913246, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7eff94651040>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff94615a60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 30598.74742913246, "timesteps_since_restore": 0, "iterations_since_restore": 179, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.518518518518518, "ram_util_percent": 23.900411522633743}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4269277477136222, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.16078054801791267, "policy_loss": -0.09271211409440605, "vf_loss": 0.22602177085254782, "vf_explained_var": 0.6882568411288723, "kl": 0.014291618877216944, "entropy": 3.0725955404261107, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 166935.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -11.8, "episode_reward_mean": -3.6822335025380717, "episode_len_mean": 20.294416243654823, "episode_media": {}, "episodes_this_iter": 197, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.100000000000001, -3.2, -3.3000000000000003, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.100000000000001, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.400000000000001, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.400000000000001, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.0000000000000004, -3.5000000000000004, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.100000000000001, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.100000000000001, -3.100000000000001, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.100000000000001, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -3.2, -3.4000000000000004, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.3000000000000007, -10.9, -3.0000000000000004, -3.400000000000001, -3.2, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -10.7, -3.0000000000000004, -3.2, -3.1000000000000005, -3.0000000000000004, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.100000000000001, -3.2000000000000006, -11.1, -3.2000000000000006, -3.1000000000000005, -3.5, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -11.5, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.200000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -11.1, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.100000000000001, -3.100000000000001, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.3000000000000003, -3.0000000000000004, -3.100000000000001, -3.3000000000000007, -11.8, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -10.9, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -10.3, -3.0000000000000004, -10.2, -3.1000000000000005, -3.2, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.100000000000001, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.0000000000000004, -3.2000000000000006, -11.2, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -11.4, -3.200000000000001, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.2, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.2, -3.0000000000000004, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -11.1, -3.3000000000000003, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -10.0], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 1]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.519578311120073, "mean_inference_ms": 17.538857334964284, "mean_action_processing_ms": 0.9152180912962838, "mean_env_wait_ms": 2.309176557920206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06965537966810507, "StateBufferConnector_ms": 0.008310884388570253, "ViewRequirementAgentConnector_ms": 0.12815034934106817}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -11.8, "episode_reward_mean": -3.6822335025380717, "episode_len_mean": 20.294416243654823, "episodes_this_iter": 197, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.100000000000001, -3.2, -3.3000000000000003, -3.2000000000000006, -3.3000000000000003, -3.2000000000000006, -3.100000000000001, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.400000000000001, -3.3000000000000003, -3.3000000000000007, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.400000000000001, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.4000000000000004, -3.0000000000000004, -3.5000000000000004, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.100000000000001, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.100000000000001, -3.100000000000001, -3.1000000000000005, -3.3000000000000007, -3.3000000000000003, -3.100000000000001, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -3.2, -3.4000000000000004, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.3000000000000007, -10.9, -3.0000000000000004, -3.400000000000001, -3.2, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -10.7, -3.0000000000000004, -3.2, -3.1000000000000005, -3.0000000000000004, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.100000000000001, -3.2000000000000006, -11.1, -3.2000000000000006, -3.1000000000000005, -3.5, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -11.5, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.200000000000001, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -11.1, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.100000000000001, -3.100000000000001, -3.3000000000000007, -3.400000000000001, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.3000000000000003, -3.0000000000000004, -3.100000000000001, -3.3000000000000007, -11.8, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -10.9, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -10.3, -3.0000000000000004, -10.2, -3.1000000000000005, -3.2, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.3000000000000007, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.100000000000001, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -3.0000000000000004, -3.2000000000000006, -11.2, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -11.4, -3.200000000000001, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.2, -3.1000000000000005, -3.3000000000000003, -3.1000000000000005, -3.2, -3.0000000000000004, -3.2000000000000006, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -11.1, -3.3000000000000003, -3.400000000000001, -3.2000000000000006, -3.1000000000000005, -3.400000000000001, -10.0], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 1]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.519578311120073, "mean_inference_ms": 17.538857334964284, "mean_action_processing_ms": 0.9152180912962838, "mean_env_wait_ms": 2.309176557920206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06965537966810507, "StateBufferConnector_ms": 0.008310884388570253, "ViewRequirementAgentConnector_ms": 0.12815034934106817}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 170774.744, "load_time_ms": 1.149, "load_throughput": 3480244.778, "learn_time_ms": 169789.232, "learn_throughput": 23.559, "synch_weights_time_ms": 183.058}, "counters": {"num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "episodes_total": 35915, "training_iteration": 180, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_05-28-44", "timestamp": 1680838124, "time_this_iter_s": 170.4590802192688, "time_total_s": 30769.20650935173, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01477ae670>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff945f0e50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 30769.20650935173, "timesteps_since_restore": 0, "iterations_since_restore": 180, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.363636363636363, "ram_util_percent": 23.901239669421486}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1211607920306343, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.13871752362077436, "policy_loss": -0.021819507355441248, "vf_loss": 0.1502749433946265, "vf_explained_var": 0.778872097756273, "kl": 0.005338808584217263, "entropy": 3.081696189859862, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 167865.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 724000, "num_env_steps_trained": 724000, "num_agent_steps_sampled": 724000, "num_agent_steps_trained": 724000}, "sampler_results": {"episode_reward_max": 98.7, "episode_reward_min": -11.8, "episode_reward_mean": -2.9969543147208126, "episode_len_mean": 20.502538071065988, "episode_media": {}, "episodes_this_iter": 197, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.1000000000000005, -3.100000000000001, -10.3, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.4, -3.4000000000000004, -3.3000000000000003, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.100000000000001, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -11.6, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2, -3.1000000000000005, -3.200000000000001, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.2, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.4000000000000004, -3.2000000000000006, -3.0000000000000004, -3.3000000000000003, 98.7, -3.1000000000000005, -3.3000000000000007, -3.200000000000001, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.500000000000001, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.500000000000001, -3.0000000000000004, -10.7, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.400000000000001, -11.8, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.0000000000000004, -3.2, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -11.1, -3.3000000000000003, -3.2000000000000006, -11.0, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -10.5, -3.2, -3.0000000000000004, -3.100000000000001, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.5000000000000004, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.200000000000001, -3.0000000000000004, -3.100000000000001, -3.2000000000000006, -3.1000000000000005, -3.2, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.2, -3.400000000000001, -3.3000000000000003, -3.1000000000000005, -3.2, -3.400000000000001, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -10.9, -3.2, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -11.2, -3.0000000000000004, -3.0000000000000004], "episode_lengths": [21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 10, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.517540605302065, "mean_inference_ms": 17.521364343810966, "mean_action_processing_ms": 0.9150961346598253, "mean_env_wait_ms": 2.3070781034335806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07827983894929062, "StateBufferConnector_ms": 0.009533959596895325, "ViewRequirementAgentConnector_ms": 0.1447113637391686}}, "episode_reward_max": 98.7, "episode_reward_min": -11.8, "episode_reward_mean": -2.9969543147208126, "episode_len_mean": 20.502538071065988, "episodes_this_iter": 197, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.1000000000000005, -3.100000000000001, -10.3, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.4, -3.4000000000000004, -3.3000000000000003, -3.3000000000000003, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.100000000000001, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.3000000000000007, -11.6, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2, -3.1000000000000005, -3.200000000000001, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.2, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.4000000000000004, -3.2000000000000006, -3.0000000000000004, -3.3000000000000003, 98.7, -3.1000000000000005, -3.3000000000000007, -3.200000000000001, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.400000000000001, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.500000000000001, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.500000000000001, -3.0000000000000004, -10.7, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.400000000000001, -11.8, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.0000000000000004, -3.2, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.3000000000000007, -3.2000000000000006, -11.1, -3.3000000000000003, -3.2000000000000006, -11.0, -3.3000000000000003, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -10.5, -3.2, -3.0000000000000004, -3.100000000000001, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.3000000000000007, -3.5000000000000004, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.200000000000001, -3.0000000000000004, -3.100000000000001, -3.2000000000000006, -3.1000000000000005, -3.2, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.3000000000000003, -3.2, -3.400000000000001, -3.3000000000000003, -3.1000000000000005, -3.2, -3.400000000000001, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.3000000000000007, -10.9, -3.2, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -11.2, -3.0000000000000004, -3.0000000000000004], "episode_lengths": [21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 10, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.517540605302065, "mean_inference_ms": 17.521364343810966, "mean_action_processing_ms": 0.9150961346598253, "mean_env_wait_ms": 2.3070781034335806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07827983894929062, "StateBufferConnector_ms": 0.009533959596895325, "ViewRequirementAgentConnector_ms": 0.1447113637391686}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 724000, "num_agent_steps_trained": 724000, "num_env_steps_sampled": 724000, "num_env_steps_trained": 724000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 724000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 724000, "timers": {"training_iteration_time_ms": 170765.703, "load_time_ms": 1.154, "load_throughput": 3465149.844, "learn_time_ms": 169778.026, "learn_throughput": 23.56, "synch_weights_time_ms": 183.689}, "counters": {"num_env_steps_sampled": 724000, "num_env_steps_trained": 724000, "num_agent_steps_sampled": 724000, "num_agent_steps_trained": 724000}, "done": false, "episodes_total": 36112, "training_iteration": 181, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_05-31-34", "timestamp": 1680838294, "time_this_iter_s": 170.7826063632965, "time_total_s": 30939.989115715027, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476596a0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff94615040>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 30939.989115715027, "timesteps_since_restore": 0, "iterations_since_restore": 181, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.661316872427983, "ram_util_percent": 23.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4219962463263542, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.10510274274975702, "policy_loss": -0.06775508348539631, "vf_loss": 0.1435366558847368, "vf_explained_var": 0.8131124720137607, "kl": 0.015254218684010563, "entropy": 3.0560596040500108, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 168795.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_agent_steps_sampled": 728000, "num_agent_steps_trained": 728000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -11.6, "episode_reward_mean": -3.3820512820512825, "episode_len_mean": 20.656410256410258, "episode_media": {}, "episodes_this_iter": 195, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0000000000000004, -3.500000000000001, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -3.2, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.5000000000000004, -3.2000000000000006, -3.1000000000000005, -3.2, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.2, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.100000000000001, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.5000000000000004, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -10.8, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2, -3.2000000000000006, -3.2, -10.3, -3.1000000000000005, -11.3, -3.1000000000000005, -3.3000000000000003, -3.4000000000000004, -3.1000000000000005, -3.100000000000001, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.4000000000000004, -3.0000000000000004, -3.0000000000000004, -3.3000000000000007, -3.100000000000001, -3.0000000000000004, -3.1000000000000005, -10.3, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.4000000000000004, -3.0000000000000004, -3.2, -3.2000000000000006, -3.0000000000000004, -11.0, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -11.6, -3.1000000000000005, -3.100000000000001, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.2, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.4000000000000012, -3.2000000000000006, -3.0000000000000004, -3.100000000000001, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.100000000000001, -3.0000000000000004, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.200000000000001, -3.400000000000001, -3.3000000000000003, -3.100000000000001, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.4000000000000004, -3.0000000000000004], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.518655204822647, "mean_inference_ms": 17.527662736506407, "mean_action_processing_ms": 0.9142492352056237, "mean_env_wait_ms": 2.307367892336476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06756379054142879, "StateBufferConnector_ms": 0.00819866473858173, "ViewRequirementAgentConnector_ms": 0.12464841206868489}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -11.6, "episode_reward_mean": -3.3820512820512825, "episode_len_mean": 20.656410256410258, "episodes_this_iter": 195, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.0000000000000004, -3.500000000000001, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -3.2, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.1000000000000005, -3.5000000000000004, -3.2000000000000006, -3.1000000000000005, -3.2, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.2, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.100000000000001, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.5000000000000004, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -10.8, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.400000000000001, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.2, -3.2000000000000006, -3.2, -10.3, -3.1000000000000005, -11.3, -3.1000000000000005, -3.3000000000000003, -3.4000000000000004, -3.1000000000000005, -3.100000000000001, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.0000000000000004, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.4000000000000004, -3.0000000000000004, -3.0000000000000004, -3.3000000000000007, -3.100000000000001, -3.0000000000000004, -3.1000000000000005, -10.3, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.3000000000000003, -3.4000000000000004, -3.0000000000000004, -3.2, -3.2000000000000006, -3.0000000000000004, -11.0, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -11.6, -3.1000000000000005, -3.100000000000001, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.3000000000000007, -3.1000000000000005, -3.2, -3.1000000000000005, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.4000000000000012, -3.2000000000000006, -3.0000000000000004, -3.100000000000001, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.2, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.100000000000001, -3.0000000000000004, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.200000000000001, -3.400000000000001, -3.3000000000000003, -3.100000000000001, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.4000000000000004, -3.0000000000000004], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.518655204822647, "mean_inference_ms": 17.527662736506407, "mean_action_processing_ms": 0.9142492352056237, "mean_env_wait_ms": 2.307367892336476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06756379054142879, "StateBufferConnector_ms": 0.00819866473858173, "ViewRequirementAgentConnector_ms": 0.12464841206868489}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 728000, "num_agent_steps_trained": 728000, "num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 728000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 728000, "timers": {"training_iteration_time_ms": 170674.642, "load_time_ms": 1.169, "load_throughput": 3421756.848, "learn_time_ms": 169693.104, "learn_throughput": 23.572, "synch_weights_time_ms": 183.908}, "counters": {"num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_agent_steps_sampled": 728000, "num_agent_steps_trained": 728000}, "done": false, "episodes_total": 36307, "training_iteration": 182, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_05-34-25", "timestamp": 1680838465, "time_this_iter_s": 170.43775463104248, "time_total_s": 31110.42687034607, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01474235e0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff94564ee0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 31110.42687034607, "timesteps_since_restore": 0, "iterations_since_restore": 182, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 5.501234567901235, "ram_util_percent": 23.900411522633743}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.409911243265034, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 0.0010000000000000005, "total_loss": 0.10742135024879888, "policy_loss": -0.06622155425489269, "vf_loss": 0.14739590577821257, "vf_explained_var": 0.780655449692921, "kl": 0.013654892836191682, "entropy": 3.069772276314356, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 169725.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 732000}, "sampler_results": {"episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.1, "episode_reward_mean": -3.466836734693878, "episode_len_mean": 20.668367346938776, "episode_media": {}, "episodes_this_iter": 196, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.2000000000000006, -3.3000000000000003, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.500000000000001, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.0000000000000004, -3.3000000000000007, -3.200000000000001, -3.4000000000000004, -3.2000000000000006, -3.0000000000000004, -3.0000000000000004, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.300000000000001, -3.1000000000000005, -3.100000000000001, -3.3000000000000003, -3.2000000000000006, -3.200000000000001, -3.300000000000001, -3.5, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.100000000000001, -3.1000000000000005, -10.4, -3.4000000000000004, -3.1000000000000005, -3.400000000000001, -3.500000000000001, -3.400000000000001, -3.1000000000000005, -3.3000000000000003, -3.100000000000001, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.0000000000000004, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -12.1, -3.2000000000000006, -3.2, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.5000000000000004, -3.2000000000000006, -10.4, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.300000000000001, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.100000000000001, -3.4000000000000004, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.3000000000000003, -11.5, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.200000000000001, -3.1000000000000005, -3.2, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2, -3.2000000000000006, -10.9, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.0000000000000004, -3.0000000000000004, -3.3000000000000007, -3.2, -3.200000000000001, -3.3000000000000003, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2, -3.100000000000001, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -11.4, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.0000000000000004, -3.3000000000000003, -3.200000000000001, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.2, -3.2, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.100000000000001, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.600000000000001, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -11.3, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.518604063756612, "mean_inference_ms": 17.522950254998754, "mean_action_processing_ms": 0.9148940946127748, "mean_env_wait_ms": 2.3072810583288628, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0748889786856515, "StateBufferConnector_ms": 0.00923616545540946, "ViewRequirementAgentConnector_ms": 0.13645473791628468}}, "episode_reward_max": -3.0000000000000004, "episode_reward_min": -12.1, "episode_reward_mean": -3.466836734693878, "episode_len_mean": 20.668367346938776, "episodes_this_iter": 196, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.2000000000000006, -3.3000000000000003, -3.0000000000000004, -3.0000000000000004, -3.1000000000000005, -3.0000000000000004, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.500000000000001, -3.1000000000000005, -3.1000000000000005, -3.400000000000001, -3.0000000000000004, -3.3000000000000007, -3.200000000000001, -3.4000000000000004, -3.2000000000000006, -3.0000000000000004, -3.0000000000000004, -3.400000000000001, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.2000000000000006, -3.300000000000001, -3.1000000000000005, -3.100000000000001, -3.3000000000000003, -3.2000000000000006, -3.200000000000001, -3.300000000000001, -3.5, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.100000000000001, -3.1000000000000005, -10.4, -3.4000000000000004, -3.1000000000000005, -3.400000000000001, -3.500000000000001, -3.400000000000001, -3.1000000000000005, -3.3000000000000003, -3.100000000000001, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.0000000000000004, -3.3000000000000003, -3.2000000000000006, -3.2000000000000006, -3.2000000000000006, -12.1, -3.2000000000000006, -3.2, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.2000000000000006, -3.4000000000000004, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.5000000000000004, -3.2000000000000006, -10.4, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.300000000000001, -3.2000000000000006, -3.2000000000000006, -3.1000000000000005, -3.100000000000001, -3.4000000000000004, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.0000000000000004, -3.1000000000000005, -3.3000000000000003, -11.5, -3.0000000000000004, -3.1000000000000005, -3.2000000000000006, -3.3000000000000003, -3.3000000000000007, -3.200000000000001, -3.1000000000000005, -3.2, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2, -3.2000000000000006, -10.9, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.0000000000000004, -3.0000000000000004, -3.3000000000000007, -3.2, -3.200000000000001, -3.3000000000000003, -3.1000000000000005, -3.4000000000000004, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005, -3.2, -3.100000000000001, -3.3000000000000007, -3.0000000000000004, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.1000000000000005, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -3.3000000000000007, -3.3000000000000003, -11.4, -3.1000000000000005, -3.3000000000000007, -3.0000000000000004, -3.0000000000000004, -3.3000000000000003, -3.200000000000001, -3.3000000000000007, -3.400000000000001, -3.1000000000000005, -3.2, -3.2, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.100000000000001, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -3.1000000000000005, -3.1000000000000005, -3.600000000000001, -3.3000000000000003, -3.1000000000000005, -3.2000000000000006, -3.2000000000000006, -3.0000000000000004, -3.2000000000000006, -11.3, -3.3000000000000007, -3.2000000000000006, -3.1000000000000005, -3.1000000000000005], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.518604063756612, "mean_inference_ms": 17.522950254998754, "mean_action_processing_ms": 0.9148940946127748, "mean_env_wait_ms": 2.3072810583288628, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0748889786856515, "StateBufferConnector_ms": 0.00923616545540946, "ViewRequirementAgentConnector_ms": 0.13645473791628468}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 732000, "num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 732000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 732000, "timers": {"training_iteration_time_ms": 170774.442, "load_time_ms": 1.171, "load_throughput": 3415696.079, "learn_time_ms": 169791.719, "learn_throughput": 23.558, "synch_weights_time_ms": 184.14}, "counters": {"num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 732000}, "done": false, "episodes_total": 36503, "training_iteration": 183, "trial_id": "9336a_00001", "experiment_id": "7a6fa43cbf8249348bc4ddba6e0bbbc6", "date": "2023-04-07_05-37-16", "timestamp": 1680838636, "time_this_iter_s": 171.49374675750732, "time_total_s": 31281.920617103577, "pid": 260811, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.001, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01473e2b50>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff94568940>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 31281.920617103577, "timesteps_since_restore": 0, "iterations_since_restore": 183, "warmup_time": 7.656609773635864, "perf": {"cpu_util_percent": 6.003688524590164, "ram_util_percent": 23.965573770491805}}
