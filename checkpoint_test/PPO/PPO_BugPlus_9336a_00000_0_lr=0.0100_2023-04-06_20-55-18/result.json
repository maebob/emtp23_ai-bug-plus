{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.4717220480724045, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.01, "total_loss": 4.253613907867862, "policy_loss": 0.3491376774435643, "vf_loss": 3.292127737547121, "vf_explained_var": 0.054888473210796235, "kl": 3.0617424204120955, "entropy": 2.951270186832996, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 465.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "sampler_results": {"episode_reward_max": -10.0, "episode_reward_min": -12.600000000000001, "episode_reward_mean": -11.068292682926828, "episode_len_mean": 9.910569105691057, "episode_media": {}, "episodes_this_iter": 123, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.1, -11.6, -11.7, -11.700000000000001, -10.5, -11.0, -11.7, -12.2, -11.1, -11.3, -11.4, -10.6, -10.6, -11.4, -11.8, -11.0, -12.1, -10.2, -10.4, -10.8, -11.7, -10.2, -11.3, -11.0, -11.2, -11.5, -11.4, -11.4, -10.5, -10.2, -10.3, -10.6, -11.5, -11.0, -12.100000000000001, -10.6, -10.8, -10.1, -11.3, -11.2, -10.0, -11.8, -10.3, -12.4, -10.0, -10.3, -10.6, -10.3, -10.8, -10.8, -10.4, -10.0, -10.2, -10.3, -10.5, -11.1, -11.4, -12.0, -11.9, -11.8, -12.3, -10.3, -10.3, -10.2, -11.7, -11.1, -12.0, -12.200000000000001, -10.1, -10.3, -10.5, -10.0, -10.7, -10.0, -10.1, -10.4, -10.7, -10.7, -11.0, -11.2, -10.7, -12.600000000000001, -10.1, -11.7, -11.4, -12.2, -10.0, -10.7, -11.5, -11.3, -11.7, -12.0, -12.4, -10.8, -12.200000000000001, -10.6, -10.6, -11.2, -11.8, -12.5, -10.1, -10.4, -10.5, -10.5, -10.7, -11.9, -11.8, -12.0, -10.4, -10.8, -10.8, -11.1, -11.600000000000001, -12.3, -12.2, -12.600000000000001, -10.5, -10.8, -11.5, -11.600000000000001, -11.0, -10.4, -12.1], "episode_lengths": [2, 15, 16, 17, 6, 9, 13, 19, 9, 11, 13, 6, 7, 14, 15, 10, 18, 3, 5, 7, 14, 3, 10, 10, 10, 13, 13, 14, 5, 3, 4, 4, 14, 11, 19, 7, 9, 2, 11, 11, 1, 15, 4, 20, 1, 3, 6, 4, 8, 8, 4, 1, 2, 4, 6, 11, 12, 19, 15, 17, 19, 3, 4, 3, 14, 10, 18, 20, 2, 4, 6, 1, 7, 1, 2, 4, 7, 8, 9, 11, 7, 19, 2, 14, 14, 19, 1, 7, 12, 12, 17, 18, 19, 8, 19, 6, 7, 13, 17, 20, 2, 4, 6, 6, 8, 15, 15, 17, 4, 8, 9, 11, 15, 18, 19, 20, 6, 7, 14, 15, 10, 4, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.953545730242286, "mean_inference_ms": 21.94229494080819, "mean_action_processing_ms": 1.640369390915218, "mean_env_wait_ms": 3.7842212238378234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08779832018100149, "StateBufferConnector_ms": 0.009586559078557705, "ViewRequirementAgentConnector_ms": 0.14382707394235503}}, "episode_reward_max": -10.0, "episode_reward_min": -12.600000000000001, "episode_reward_mean": -11.068292682926828, "episode_len_mean": 9.910569105691057, "episodes_this_iter": 123, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10.1, -11.6, -11.7, -11.700000000000001, -10.5, -11.0, -11.7, -12.2, -11.1, -11.3, -11.4, -10.6, -10.6, -11.4, -11.8, -11.0, -12.1, -10.2, -10.4, -10.8, -11.7, -10.2, -11.3, -11.0, -11.2, -11.5, -11.4, -11.4, -10.5, -10.2, -10.3, -10.6, -11.5, -11.0, -12.100000000000001, -10.6, -10.8, -10.1, -11.3, -11.2, -10.0, -11.8, -10.3, -12.4, -10.0, -10.3, -10.6, -10.3, -10.8, -10.8, -10.4, -10.0, -10.2, -10.3, -10.5, -11.1, -11.4, -12.0, -11.9, -11.8, -12.3, -10.3, -10.3, -10.2, -11.7, -11.1, -12.0, -12.200000000000001, -10.1, -10.3, -10.5, -10.0, -10.7, -10.0, -10.1, -10.4, -10.7, -10.7, -11.0, -11.2, -10.7, -12.600000000000001, -10.1, -11.7, -11.4, -12.2, -10.0, -10.7, -11.5, -11.3, -11.7, -12.0, -12.4, -10.8, -12.200000000000001, -10.6, -10.6, -11.2, -11.8, -12.5, -10.1, -10.4, -10.5, -10.5, -10.7, -11.9, -11.8, -12.0, -10.4, -10.8, -10.8, -11.1, -11.600000000000001, -12.3, -12.2, -12.600000000000001, -10.5, -10.8, -11.5, -11.600000000000001, -11.0, -10.4, -12.1], "episode_lengths": [2, 15, 16, 17, 6, 9, 13, 19, 9, 11, 13, 6, 7, 14, 15, 10, 18, 3, 5, 7, 14, 3, 10, 10, 10, 13, 13, 14, 5, 3, 4, 4, 14, 11, 19, 7, 9, 2, 11, 11, 1, 15, 4, 20, 1, 3, 6, 4, 8, 8, 4, 1, 2, 4, 6, 11, 12, 19, 15, 17, 19, 3, 4, 3, 14, 10, 18, 20, 2, 4, 6, 1, 7, 1, 2, 4, 7, 8, 9, 11, 7, 19, 2, 14, 14, 19, 1, 7, 12, 12, 17, 18, 19, 8, 19, 6, 7, 13, 17, 20, 2, 4, 6, 6, 8, 15, 15, 17, 4, 8, 9, 11, 15, 18, 19, 20, 6, 7, 14, 15, 10, 4, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.953545730242286, "mean_inference_ms": 21.94229494080819, "mean_action_processing_ms": 1.640369390915218, "mean_env_wait_ms": 3.7842212238378234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08779832018100149, "StateBufferConnector_ms": 0.009586559078557705, "ViewRequirementAgentConnector_ms": 0.14382707394235503}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 172175.814, "load_time_ms": 0.305, "load_throughput": 13096967.994, "learn_time_ms": 170938.692, "learn_throughput": 23.4, "synch_weights_time_ms": 178.396}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 123, "training_iteration": 1, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-06_20-58-21", "timestamp": 1680807501, "time_this_iter_s": 172.18541073799133, "time_total_s": 172.18541073799133, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476cbd60>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0147753f70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 172.18541073799133, "timesteps_since_restore": 0, "iterations_since_restore": 1, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 7.911428571428571, "ram_util_percent": 22.46244897959184}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.748918618950793, "cur_kl_coeff": 0.3, "cur_lr": 0.01, "total_loss": 1.310744924218424, "policy_loss": 0.018308556316200122, "vf_loss": 1.130731739348141, "vf_explained_var": 0.23328952673942813, "kl": 0.5390153849237068, "entropy": 3.3262447787869363, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1395.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": 97.4, "episode_reward_min": -12.5, "episode_reward_mean": -4.213392857142858, "episode_len_mean": 18.709821428571427, "episode_media": {}, "episodes_this_iter": 224, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.500000000000001, -3.500000000000001, -3.500000000000001, -3.500000000000001, -3.500000000000001, -3.6000000000000005, -10.0, -3.7000000000000006, -3.600000000000001, -3.7000000000000006, -3.7000000000000006, -3.400000000000001, -3.5000000000000004, -3.3000000000000007, -3.4000000000000004, -3.600000000000001, -3.700000000000001, -3.400000000000001, -3.6000000000000005, -3.900000000000001, -3.8000000000000007, -3.7000000000000006, -3.400000000000001, -3.5000000000000004, -3.7, -3.3000000000000007, -3.500000000000001, -3.5000000000000004, -10.9, -3.8000000000000007, -3.6000000000000005, -3.7000000000000006, -12.2, -3.500000000000001, -3.2000000000000006, -3.5000000000000004, -3.400000000000001, -3.3000000000000007, -10.9, -3.500000000000001, -3.6000000000000005, -3.700000000000001, -3.6000000000000005, -3.3000000000000007, -3.600000000000001, -3.600000000000001, -3.400000000000001, -3.2000000000000006, -3.500000000000001, -10.2, -11.6, -3.600000000000001, -3.5000000000000013, -11.3, -11.1, -3.5000000000000004, -12.0, -3.900000000000001, -3.4000000000000004, -11.0, -3.500000000000001, -3.3000000000000007, -3.400000000000001, -3.5000000000000004, -3.7000000000000006, -3.500000000000001, -3.400000000000001, -11.1, -3.5000000000000004, -3.3000000000000007, -3.6000000000000005, -3.4000000000000004, -3.5000000000000004, -3.3000000000000007, -3.5000000000000004, -11.6, -3.500000000000001, -3.500000000000001, -12.5, -3.700000000000001, -10.6, -3.6000000000000005, -3.600000000000001, -3.500000000000001, -3.3000000000000007, -3.8000000000000007, -3.700000000000001, -3.700000000000001, -11.5, -3.7, -3.3000000000000007, -3.700000000000001, -3.7000000000000015, -3.5000000000000004, -3.3000000000000003, -3.2000000000000006, -10.4, -3.3000000000000007, -3.5000000000000004, -3.2000000000000006, -3.6000000000000005, -11.2, 97.4, -3.600000000000001, -3.4000000000000004, -10.9, -3.5000000000000004, -3.2, -3.600000000000001, -3.6000000000000005, -3.3000000000000007, -3.6000000000000005, -12.2, -3.7000000000000006, -3.6000000000000005, -3.700000000000001, -3.400000000000001, -3.3000000000000007, -3.8000000000000007, -3.3000000000000007, -3.500000000000001, -10.3, -10.9, -10.7, -3.6000000000000005, -10.2, -3.400000000000001, -3.4000000000000004, -3.7000000000000006, -3.5000000000000004, -3.500000000000001, -3.7000000000000006, -3.3000000000000007, -3.400000000000001, -3.5000000000000004, -3.5000000000000004, -12.3, -3.600000000000001, -3.300000000000001, -11.3, -3.500000000000001, -3.6000000000000005, -3.3000000000000003, -3.400000000000001, -11.8, -10.2, -3.2, -11.2, 97.4, -11.4, -3.6000000000000014, -3.4000000000000004, -3.4000000000000004, -10.9, -12.100000000000001, -3.600000000000001, -10.2, -10.6, -3.9000000000000012, -10.9, -3.8000000000000003, -3.4000000000000012, -3.2, -3.5000000000000004, -3.5000000000000004, -3.8000000000000003, -3.600000000000001, -3.600000000000001, -11.3, -3.5000000000000004, -3.9000000000000012, -3.7000000000000006, -11.1, -3.500000000000001, -3.6000000000000005, -3.2000000000000006, -3.600000000000001, -3.500000000000001, -12.1, -3.600000000000001, -3.400000000000001, -3.400000000000001, -3.400000000000001, -3.3000000000000003, -3.400000000000001, -3.500000000000001, -11.3, -3.7000000000000006, -3.3000000000000007, -11.1, -3.600000000000001, -3.400000000000001, -3.7000000000000006, -3.5000000000000004, -12.100000000000001, -3.4000000000000004, -3.500000000000001, -10.1, -10.6, -3.0000000000000004, -12.4, -10.0, -3.6000000000000005, -3.900000000000001, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -11.8, -3.400000000000001, -3.500000000000001, -3.600000000000001, -3.5000000000000004, -3.900000000000001, -3.5000000000000004, -3.2, -3.3000000000000007, -3.700000000000001, -3.500000000000001, -11.4, -3.4000000000000004, -11.0, -3.5000000000000004, -3.6000000000000014, -3.700000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 16, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 16, 21, 21, 12, 11, 21, 16, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 16, 21, 6, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 9, 19, 21, 21, 10, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 4, 9, 5, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 14, 21, 21, 21, 21, 16, 3, 21, 10, 19, 13, 21, 21, 21, 10, 17, 21, 3, 6, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 8, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 9, 21, 21, 21, 21, 17, 21, 21, 2, 7, 21, 20, 1, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 10, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.387043840170735, "mean_inference_ms": 20.0056719499598, "mean_action_processing_ms": 1.2488767037408277, "mean_env_wait_ms": 2.832571570258523, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0906681375844138, "StateBufferConnector_ms": 0.015074866158621652, "ViewRequirementAgentConnector_ms": 0.17154387065342494}}, "episode_reward_max": 97.4, "episode_reward_min": -12.5, "episode_reward_mean": -4.213392857142858, "episode_len_mean": 18.709821428571427, "episodes_this_iter": 224, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.500000000000001, -3.500000000000001, -3.500000000000001, -3.500000000000001, -3.500000000000001, -3.6000000000000005, -10.0, -3.7000000000000006, -3.600000000000001, -3.7000000000000006, -3.7000000000000006, -3.400000000000001, -3.5000000000000004, -3.3000000000000007, -3.4000000000000004, -3.600000000000001, -3.700000000000001, -3.400000000000001, -3.6000000000000005, -3.900000000000001, -3.8000000000000007, -3.7000000000000006, -3.400000000000001, -3.5000000000000004, -3.7, -3.3000000000000007, -3.500000000000001, -3.5000000000000004, -10.9, -3.8000000000000007, -3.6000000000000005, -3.7000000000000006, -12.2, -3.500000000000001, -3.2000000000000006, -3.5000000000000004, -3.400000000000001, -3.3000000000000007, -10.9, -3.500000000000001, -3.6000000000000005, -3.700000000000001, -3.6000000000000005, -3.3000000000000007, -3.600000000000001, -3.600000000000001, -3.400000000000001, -3.2000000000000006, -3.500000000000001, -10.2, -11.6, -3.600000000000001, -3.5000000000000013, -11.3, -11.1, -3.5000000000000004, -12.0, -3.900000000000001, -3.4000000000000004, -11.0, -3.500000000000001, -3.3000000000000007, -3.400000000000001, -3.5000000000000004, -3.7000000000000006, -3.500000000000001, -3.400000000000001, -11.1, -3.5000000000000004, -3.3000000000000007, -3.6000000000000005, -3.4000000000000004, -3.5000000000000004, -3.3000000000000007, -3.5000000000000004, -11.6, -3.500000000000001, -3.500000000000001, -12.5, -3.700000000000001, -10.6, -3.6000000000000005, -3.600000000000001, -3.500000000000001, -3.3000000000000007, -3.8000000000000007, -3.700000000000001, -3.700000000000001, -11.5, -3.7, -3.3000000000000007, -3.700000000000001, -3.7000000000000015, -3.5000000000000004, -3.3000000000000003, -3.2000000000000006, -10.4, -3.3000000000000007, -3.5000000000000004, -3.2000000000000006, -3.6000000000000005, -11.2, 97.4, -3.600000000000001, -3.4000000000000004, -10.9, -3.5000000000000004, -3.2, -3.600000000000001, -3.6000000000000005, -3.3000000000000007, -3.6000000000000005, -12.2, -3.7000000000000006, -3.6000000000000005, -3.700000000000001, -3.400000000000001, -3.3000000000000007, -3.8000000000000007, -3.3000000000000007, -3.500000000000001, -10.3, -10.9, -10.7, -3.6000000000000005, -10.2, -3.400000000000001, -3.4000000000000004, -3.7000000000000006, -3.5000000000000004, -3.500000000000001, -3.7000000000000006, -3.3000000000000007, -3.400000000000001, -3.5000000000000004, -3.5000000000000004, -12.3, -3.600000000000001, -3.300000000000001, -11.3, -3.500000000000001, -3.6000000000000005, -3.3000000000000003, -3.400000000000001, -11.8, -10.2, -3.2, -11.2, 97.4, -11.4, -3.6000000000000014, -3.4000000000000004, -3.4000000000000004, -10.9, -12.100000000000001, -3.600000000000001, -10.2, -10.6, -3.9000000000000012, -10.9, -3.8000000000000003, -3.4000000000000012, -3.2, -3.5000000000000004, -3.5000000000000004, -3.8000000000000003, -3.600000000000001, -3.600000000000001, -11.3, -3.5000000000000004, -3.9000000000000012, -3.7000000000000006, -11.1, -3.500000000000001, -3.6000000000000005, -3.2000000000000006, -3.600000000000001, -3.500000000000001, -12.1, -3.600000000000001, -3.400000000000001, -3.400000000000001, -3.400000000000001, -3.3000000000000003, -3.400000000000001, -3.500000000000001, -11.3, -3.7000000000000006, -3.3000000000000007, -11.1, -3.600000000000001, -3.400000000000001, -3.7000000000000006, -3.5000000000000004, -12.100000000000001, -3.4000000000000004, -3.500000000000001, -10.1, -10.6, -3.0000000000000004, -12.4, -10.0, -3.6000000000000005, -3.900000000000001, -3.3000000000000007, -3.3000000000000007, -3.1000000000000005, -11.8, -3.400000000000001, -3.500000000000001, -3.600000000000001, -3.5000000000000004, -3.900000000000001, -3.5000000000000004, -3.2, -3.3000000000000007, -3.700000000000001, -3.500000000000001, -11.4, -3.4000000000000004, -11.0, -3.5000000000000004, -3.6000000000000014, -3.700000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 16, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 16, 21, 21, 12, 11, 21, 16, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 16, 21, 6, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 9, 19, 21, 21, 10, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 4, 9, 5, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 14, 21, 21, 21, 21, 16, 3, 21, 10, 19, 13, 21, 21, 21, 10, 17, 21, 3, 6, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 8, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 9, 21, 21, 21, 21, 17, 21, 21, 2, 7, 21, 20, 1, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 10, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.387043840170735, "mean_inference_ms": 20.0056719499598, "mean_action_processing_ms": 1.2488767037408277, "mean_env_wait_ms": 2.832571570258523, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0906681375844138, "StateBufferConnector_ms": 0.015074866158621652, "ViewRequirementAgentConnector_ms": 0.17154387065342494}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 171294.468, "load_time_ms": 0.609, "load_throughput": 6568996.085, "learn_time_ms": 170206.696, "learn_throughput": 23.501, "synch_weights_time_ms": 179.651}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 347, "training_iteration": 2, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-06_21-01-15", "timestamp": 1680807675, "time_this_iter_s": 170.42339706420898, "time_total_s": 342.6088078022003, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476f26a0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014776bca0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 342.6088078022003, "timesteps_since_restore": 0, "iterations_since_restore": 2, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 6.36923076923077, "ram_util_percent": 23.459109311740892}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.666961450538327, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.01, "total_loss": 1.1106295318252617, "policy_loss": 0.047540168859745546, "vf_loss": 0.6878438429766766, "vf_explained_var": 0.41308881319979185, "kl": 0.8338789501648036, "entropy": 3.355219320584369, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2325.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": -3.2, "episode_reward_min": -12.8, "episode_reward_mean": -4.581280788177341, "episode_len_mean": 19.842364532019705, "episode_media": {}, "episodes_this_iter": 203, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.900000000000001, -4.000000000000001, -3.3000000000000007, -3.400000000000001, -3.5000000000000004, -3.500000000000001, -3.900000000000001, -3.7000000000000006, -3.700000000000001, -3.500000000000001, -3.7000000000000006, -3.8000000000000007, -4.000000000000002, -3.7000000000000006, -3.500000000000001, -3.700000000000001, -3.4000000000000004, -3.7000000000000006, -3.400000000000001, -3.500000000000001, -3.7000000000000006, -3.700000000000001, -4.100000000000001, -3.900000000000001, -4.300000000000001, -3.5000000000000004, -3.7000000000000006, -3.9000000000000012, -3.500000000000001, -10.2, -4.000000000000001, -3.600000000000001, -3.700000000000001, -3.8000000000000007, -3.8000000000000003, -3.500000000000001, -4.000000000000001, -10.9, -3.5000000000000004, -3.5000000000000004, -12.100000000000001, -12.4, -3.5000000000000004, -4.100000000000001, -3.500000000000001, -3.600000000000001, -10.8, -3.500000000000001, -3.500000000000001, -3.700000000000001, -3.5000000000000004, -3.8000000000000007, -3.500000000000001, -3.8000000000000007, -3.600000000000001, -3.700000000000001, -10.1, -12.100000000000001, -3.4000000000000004, -3.4000000000000004, -3.5000000000000004, -3.4000000000000004, -4.100000000000001, -3.8000000000000007, -3.600000000000001, -4.000000000000001, -3.6000000000000005, -4.000000000000001, -3.6000000000000005, -3.500000000000001, -3.600000000000001, -4.000000000000002, -3.7000000000000006, -3.7000000000000006, -3.900000000000001, -3.5000000000000004, -3.700000000000001, -3.700000000000001, -3.8000000000000007, -3.700000000000001, -3.700000000000001, -3.6000000000000005, -3.7000000000000006, -3.500000000000001, -3.900000000000001, -3.600000000000001, -3.500000000000001, -3.500000000000001, -3.900000000000001, -12.8, -3.800000000000001, -3.6000000000000005, -3.7, -3.4000000000000004, -3.800000000000001, -3.900000000000001, -10.6, -3.7000000000000006, -11.5, -3.500000000000001, -3.5000000000000004, -3.700000000000001, -3.900000000000001, -3.700000000000001, -3.7000000000000006, -3.6000000000000005, -3.7000000000000006, -11.700000000000001, -11.3, -3.800000000000001, -3.9000000000000012, -3.800000000000001, -3.8000000000000003, -3.7000000000000006, -3.500000000000001, -3.400000000000001, -3.9000000000000012, -4.0, -10.3, -3.8000000000000007, -3.800000000000001, -3.400000000000001, -3.8000000000000007, -3.500000000000001, -3.8000000000000007, -3.700000000000001, -3.7000000000000006, -3.8000000000000007, -3.700000000000001, -3.8000000000000007, -3.9000000000000012, -3.800000000000001, -3.400000000000001, -3.5000000000000004, -3.6, -3.300000000000001, -3.7000000000000015, -3.900000000000001, -3.6000000000000005, -3.5000000000000004, -12.2, -3.4000000000000004, -3.800000000000001, -3.900000000000001, -4.0, -3.600000000000001, -3.600000000000001, -3.7000000000000006, -3.700000000000001, -12.0, -3.700000000000001, -3.900000000000001, -3.600000000000001, -11.0, -3.7000000000000006, -3.8000000000000007, -4.0, -10.8, -12.200000000000001, -3.6000000000000005, -3.7000000000000006, -3.5000000000000004, -3.7000000000000006, -3.700000000000001, -3.700000000000001, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.800000000000001, -3.4000000000000004, -11.4, -3.7000000000000006, -4.000000000000001, -3.700000000000001, -3.500000000000001, -10.4, -3.400000000000001, -3.6000000000000005, -4.100000000000001, -3.400000000000001, -10.5, -11.3, -3.7000000000000006, -3.700000000000001, -11.5, -3.500000000000001, -3.8000000000000007, -3.600000000000001, -4.100000000000001, -3.2, -3.600000000000001, -3.800000000000001, -4.200000000000001, -3.600000000000001, -3.700000000000001, -4.000000000000001, -3.7000000000000006, -3.9000000000000004, -10.1, -3.5000000000000004, -3.900000000000001, -3.800000000000001, -3.7000000000000006], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 18, 18, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 7, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 14, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 9, 21, 21, 21, 8, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 5, 21, 21, 21, 21, 6, 11, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.11206509044037, "mean_inference_ms": 19.472778300750733, "mean_action_processing_ms": 1.1588414458747942, "mean_env_wait_ms": 2.520110643151637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08275591093918373, "StateBufferConnector_ms": 0.011536875381845559, "ViewRequirementAgentConnector_ms": 0.1522852282218745}}, "episode_reward_max": -3.2, "episode_reward_min": -12.8, "episode_reward_mean": -4.581280788177341, "episode_len_mean": 19.842364532019705, "episodes_this_iter": 203, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.900000000000001, -4.000000000000001, -3.3000000000000007, -3.400000000000001, -3.5000000000000004, -3.500000000000001, -3.900000000000001, -3.7000000000000006, -3.700000000000001, -3.500000000000001, -3.7000000000000006, -3.8000000000000007, -4.000000000000002, -3.7000000000000006, -3.500000000000001, -3.700000000000001, -3.4000000000000004, -3.7000000000000006, -3.400000000000001, -3.500000000000001, -3.7000000000000006, -3.700000000000001, -4.100000000000001, -3.900000000000001, -4.300000000000001, -3.5000000000000004, -3.7000000000000006, -3.9000000000000012, -3.500000000000001, -10.2, -4.000000000000001, -3.600000000000001, -3.700000000000001, -3.8000000000000007, -3.8000000000000003, -3.500000000000001, -4.000000000000001, -10.9, -3.5000000000000004, -3.5000000000000004, -12.100000000000001, -12.4, -3.5000000000000004, -4.100000000000001, -3.500000000000001, -3.600000000000001, -10.8, -3.500000000000001, -3.500000000000001, -3.700000000000001, -3.5000000000000004, -3.8000000000000007, -3.500000000000001, -3.8000000000000007, -3.600000000000001, -3.700000000000001, -10.1, -12.100000000000001, -3.4000000000000004, -3.4000000000000004, -3.5000000000000004, -3.4000000000000004, -4.100000000000001, -3.8000000000000007, -3.600000000000001, -4.000000000000001, -3.6000000000000005, -4.000000000000001, -3.6000000000000005, -3.500000000000001, -3.600000000000001, -4.000000000000002, -3.7000000000000006, -3.7000000000000006, -3.900000000000001, -3.5000000000000004, -3.700000000000001, -3.700000000000001, -3.8000000000000007, -3.700000000000001, -3.700000000000001, -3.6000000000000005, -3.7000000000000006, -3.500000000000001, -3.900000000000001, -3.600000000000001, -3.500000000000001, -3.500000000000001, -3.900000000000001, -12.8, -3.800000000000001, -3.6000000000000005, -3.7, -3.4000000000000004, -3.800000000000001, -3.900000000000001, -10.6, -3.7000000000000006, -11.5, -3.500000000000001, -3.5000000000000004, -3.700000000000001, -3.900000000000001, -3.700000000000001, -3.7000000000000006, -3.6000000000000005, -3.7000000000000006, -11.700000000000001, -11.3, -3.800000000000001, -3.9000000000000012, -3.800000000000001, -3.8000000000000003, -3.7000000000000006, -3.500000000000001, -3.400000000000001, -3.9000000000000012, -4.0, -10.3, -3.8000000000000007, -3.800000000000001, -3.400000000000001, -3.8000000000000007, -3.500000000000001, -3.8000000000000007, -3.700000000000001, -3.7000000000000006, -3.8000000000000007, -3.700000000000001, -3.8000000000000007, -3.9000000000000012, -3.800000000000001, -3.400000000000001, -3.5000000000000004, -3.6, -3.300000000000001, -3.7000000000000015, -3.900000000000001, -3.6000000000000005, -3.5000000000000004, -12.2, -3.4000000000000004, -3.800000000000001, -3.900000000000001, -4.0, -3.600000000000001, -3.600000000000001, -3.7000000000000006, -3.700000000000001, -12.0, -3.700000000000001, -3.900000000000001, -3.600000000000001, -11.0, -3.7000000000000006, -3.8000000000000007, -4.0, -10.8, -12.200000000000001, -3.6000000000000005, -3.7000000000000006, -3.5000000000000004, -3.7000000000000006, -3.700000000000001, -3.700000000000001, -3.3000000000000007, -3.3000000000000007, -3.400000000000001, -3.800000000000001, -3.4000000000000004, -11.4, -3.7000000000000006, -4.000000000000001, -3.700000000000001, -3.500000000000001, -10.4, -3.400000000000001, -3.6000000000000005, -4.100000000000001, -3.400000000000001, -10.5, -11.3, -3.7000000000000006, -3.700000000000001, -11.5, -3.500000000000001, -3.8000000000000007, -3.600000000000001, -4.100000000000001, -3.2, -3.600000000000001, -3.800000000000001, -4.200000000000001, -3.600000000000001, -3.700000000000001, -4.000000000000001, -3.7000000000000006, -3.9000000000000004, -10.1, -3.5000000000000004, -3.900000000000001, -3.800000000000001, -3.7000000000000006], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 18, 18, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 7, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 14, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 9, 21, 21, 21, 8, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 5, 21, 21, 21, 21, 6, 11, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.11206509044037, "mean_inference_ms": 19.472778300750733, "mean_action_processing_ms": 1.1588414458747942, "mean_env_wait_ms": 2.520110643151637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08275591093918373, "StateBufferConnector_ms": 0.011536875381845559, "ViewRequirementAgentConnector_ms": 0.1522852282218745}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 170979.209, "load_time_ms": 0.745, "load_throughput": 5369854.689, "learn_time_ms": 169905.018, "learn_throughput": 23.543, "synch_weights_time_ms": 179.912}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 550, "training_iteration": 3, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-06_21-04-06", "timestamp": 1680807846, "time_this_iter_s": 170.36099481582642, "time_total_s": 512.9698026180267, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f014770bc70>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7effc2556ca0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 512.9698026180267, "timesteps_since_restore": 0, "iterations_since_restore": 3, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.448559670781893, "ram_util_percent": 23.455555555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.951481678024415, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.01, "total_loss": 1.3820040611089557, "policy_loss": 0.04595546084305933, "vf_loss": 0.9855709260149348, "vf_explained_var": 0.35358202239518527, "kl": 0.5192261852083667, "entropy": 3.360525825972198, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3255.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "sampler_results": {"episode_reward_max": -3.2000000000000006, "episode_reward_min": -12.5, "episode_reward_mean": -5.116517857142858, "episode_len_mean": 18.977678571428573, "episode_media": {}, "episodes_this_iter": 224, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.200000000000001, -3.7000000000000006, -3.8000000000000007, -3.600000000000001, -3.9000000000000012, -3.5000000000000004, -3.6000000000000005, -10.8, -11.2, -3.900000000000001, -4.000000000000001, -3.6000000000000005, -3.900000000000001, -3.700000000000001, -3.7000000000000006, -3.600000000000001, -4.000000000000001, -4.000000000000002, -3.600000000000001, -10.5, -3.8000000000000007, -3.7000000000000006, -12.3, -3.5000000000000004, -3.6000000000000005, -3.900000000000001, -3.800000000000001, -4.000000000000001, -3.3000000000000007, -3.600000000000001, -3.6000000000000005, -3.700000000000001, -3.8000000000000007, -3.8000000000000007, -11.7, -4.000000000000001, -3.8000000000000007, -3.6000000000000005, -3.6000000000000005, -10.5, -3.500000000000001, -11.5, -3.3000000000000003, -3.7, -3.400000000000001, -3.400000000000001, -3.600000000000001, -3.900000000000001, -12.0, -3.400000000000001, -3.9000000000000012, -3.8000000000000007, -11.3, -11.1, -3.8000000000000007, -3.7000000000000006, -3.500000000000001, -12.3, -3.4000000000000004, -3.7, -3.500000000000001, -12.5, -10.3, -11.7, -3.6000000000000005, -11.4, -12.3, -10.2, -3.7, -3.7000000000000006, -3.400000000000001, -3.400000000000001, -10.0, -3.6000000000000005, -3.6000000000000005, -12.0, -11.8, -11.8, -10.3, -4.000000000000002, -3.500000000000001, -3.700000000000001, -3.500000000000001, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -3.7, -3.7000000000000015, -3.600000000000001, -3.8000000000000007, -3.8000000000000007, -3.5000000000000004, -3.6000000000000005, -3.400000000000001, -3.600000000000001, -3.4000000000000012, -3.7000000000000006, -10.9, -3.500000000000001, -3.700000000000001, -3.8000000000000007, -3.6000000000000005, -3.500000000000001, -3.600000000000001, -3.6000000000000005, -4.000000000000002, -10.2, -3.5000000000000004, -3.7, -11.0, -3.800000000000001, -11.7, -3.5000000000000004, -10.2, -12.0, -3.900000000000001, -3.500000000000001, -3.500000000000001, -3.900000000000001, -3.7000000000000006, -3.5000000000000004, -10.4, -3.4000000000000004, -3.4000000000000004, -3.7000000000000006, -3.700000000000001, -3.3000000000000007, -3.5000000000000004, -3.7000000000000006, -3.8000000000000007, -3.500000000000001, -10.3, -3.700000000000001, -3.7000000000000006, -4.1000000000000005, -11.3, -11.8, -10.0, -3.600000000000001, -3.900000000000001, -3.6000000000000005, -3.900000000000001, -3.900000000000001, -3.5000000000000004, -3.700000000000001, -3.600000000000001, -3.700000000000001, -3.900000000000001, -3.9000000000000012, -3.7000000000000006, -3.400000000000001, -3.7000000000000006, -3.700000000000001, -3.800000000000001, -4.100000000000001, -3.3000000000000003, -12.0, -3.500000000000001, -3.7000000000000006, -3.500000000000001, -3.500000000000001, -3.5000000000000004, -3.500000000000001, -4.1000000000000005, -3.9000000000000004, -3.7000000000000006, -10.8, -3.400000000000001, -3.8000000000000007, -3.600000000000001, -4.000000000000001, -3.4000000000000004, -3.3000000000000007, -3.600000000000001, -3.500000000000001, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -11.8, -3.8000000000000007, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -3.5000000000000004, -3.900000000000001, -3.6000000000000005, -3.3000000000000007, -3.900000000000001, -11.3, -3.6000000000000005, -10.4, -3.6000000000000005, -3.600000000000001, -11.4, -3.7000000000000006, -3.5000000000000004, -3.3000000000000007, -3.7000000000000006, -11.8, -11.1, -4.000000000000001, -3.6000000000000005, -11.4, -3.7000000000000006, -3.9000000000000012, -4.000000000000001, -3.7000000000000006, -3.8000000000000007, -3.700000000000001, -3.400000000000001, -3.600000000000001, -3.9000000000000012, -3.900000000000001, -10.7, -4.100000000000001, -3.400000000000001, -3.9000000000000012, -4.000000000000001, -3.800000000000001, -3.400000000000001, -3.600000000000001, -3.5000000000000004, -3.7000000000000006, -3.5000000000000004], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 7, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 6, 21, 13, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 11, 11, 21, 21, 21, 19, 21, 21, 21, 19, 4, 13, 21, 11, 18, 3, 21, 21, 21, 21, 1, 21, 21, 16, 14, 14, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 10, 21, 13, 21, 3, 14, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 11, 15, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 5, 21, 21, 13, 21, 21, 21, 21, 16, 10, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.883145961391442, "mean_inference_ms": 19.306834898823364, "mean_action_processing_ms": 1.1116794755639643, "mean_env_wait_ms": 2.3759586155099206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08064487150737218, "StateBufferConnector_ms": 0.011871329375675746, "ViewRequirementAgentConnector_ms": 0.14695599675178528}}, "episode_reward_max": -3.2000000000000006, "episode_reward_min": -12.5, "episode_reward_mean": -5.116517857142858, "episode_len_mean": 18.977678571428573, "episodes_this_iter": 224, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.200000000000001, -3.7000000000000006, -3.8000000000000007, -3.600000000000001, -3.9000000000000012, -3.5000000000000004, -3.6000000000000005, -10.8, -11.2, -3.900000000000001, -4.000000000000001, -3.6000000000000005, -3.900000000000001, -3.700000000000001, -3.7000000000000006, -3.600000000000001, -4.000000000000001, -4.000000000000002, -3.600000000000001, -10.5, -3.8000000000000007, -3.7000000000000006, -12.3, -3.5000000000000004, -3.6000000000000005, -3.900000000000001, -3.800000000000001, -4.000000000000001, -3.3000000000000007, -3.600000000000001, -3.6000000000000005, -3.700000000000001, -3.8000000000000007, -3.8000000000000007, -11.7, -4.000000000000001, -3.8000000000000007, -3.6000000000000005, -3.6000000000000005, -10.5, -3.500000000000001, -11.5, -3.3000000000000003, -3.7, -3.400000000000001, -3.400000000000001, -3.600000000000001, -3.900000000000001, -12.0, -3.400000000000001, -3.9000000000000012, -3.8000000000000007, -11.3, -11.1, -3.8000000000000007, -3.7000000000000006, -3.500000000000001, -12.3, -3.4000000000000004, -3.7, -3.500000000000001, -12.5, -10.3, -11.7, -3.6000000000000005, -11.4, -12.3, -10.2, -3.7, -3.7000000000000006, -3.400000000000001, -3.400000000000001, -10.0, -3.6000000000000005, -3.6000000000000005, -12.0, -11.8, -11.8, -10.3, -4.000000000000002, -3.500000000000001, -3.700000000000001, -3.500000000000001, -3.3000000000000007, -3.2000000000000006, -3.4000000000000004, -3.7, -3.7000000000000015, -3.600000000000001, -3.8000000000000007, -3.8000000000000007, -3.5000000000000004, -3.6000000000000005, -3.400000000000001, -3.600000000000001, -3.4000000000000012, -3.7000000000000006, -10.9, -3.500000000000001, -3.700000000000001, -3.8000000000000007, -3.6000000000000005, -3.500000000000001, -3.600000000000001, -3.6000000000000005, -4.000000000000002, -10.2, -3.5000000000000004, -3.7, -11.0, -3.800000000000001, -11.7, -3.5000000000000004, -10.2, -12.0, -3.900000000000001, -3.500000000000001, -3.500000000000001, -3.900000000000001, -3.7000000000000006, -3.5000000000000004, -10.4, -3.4000000000000004, -3.4000000000000004, -3.7000000000000006, -3.700000000000001, -3.3000000000000007, -3.5000000000000004, -3.7000000000000006, -3.8000000000000007, -3.500000000000001, -10.3, -3.700000000000001, -3.7000000000000006, -4.1000000000000005, -11.3, -11.8, -10.0, -3.600000000000001, -3.900000000000001, -3.6000000000000005, -3.900000000000001, -3.900000000000001, -3.5000000000000004, -3.700000000000001, -3.600000000000001, -3.700000000000001, -3.900000000000001, -3.9000000000000012, -3.7000000000000006, -3.400000000000001, -3.7000000000000006, -3.700000000000001, -3.800000000000001, -4.100000000000001, -3.3000000000000003, -12.0, -3.500000000000001, -3.7000000000000006, -3.500000000000001, -3.500000000000001, -3.5000000000000004, -3.500000000000001, -4.1000000000000005, -3.9000000000000004, -3.7000000000000006, -10.8, -3.400000000000001, -3.8000000000000007, -3.600000000000001, -4.000000000000001, -3.4000000000000004, -3.3000000000000007, -3.600000000000001, -3.500000000000001, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -11.8, -3.8000000000000007, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -3.5000000000000004, -3.900000000000001, -3.6000000000000005, -3.3000000000000007, -3.900000000000001, -11.3, -3.6000000000000005, -10.4, -3.6000000000000005, -3.600000000000001, -11.4, -3.7000000000000006, -3.5000000000000004, -3.3000000000000007, -3.7000000000000006, -11.8, -11.1, -4.000000000000001, -3.6000000000000005, -11.4, -3.7000000000000006, -3.9000000000000012, -4.000000000000001, -3.7000000000000006, -3.8000000000000007, -3.700000000000001, -3.400000000000001, -3.600000000000001, -3.9000000000000012, -3.900000000000001, -10.7, -4.100000000000001, -3.400000000000001, -3.9000000000000012, -4.000000000000001, -3.800000000000001, -3.400000000000001, -3.600000000000001, -3.5000000000000004, -3.7000000000000006, -3.5000000000000004], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 7, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 6, 21, 13, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 11, 11, 21, 21, 21, 19, 21, 21, 21, 19, 4, 13, 21, 11, 18, 3, 21, 21, 21, 21, 1, 21, 21, 16, 14, 14, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 10, 21, 13, 21, 3, 14, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 11, 15, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 5, 21, 21, 13, 21, 21, 21, 21, 16, 10, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.883145961391442, "mean_inference_ms": 19.306834898823364, "mean_action_processing_ms": 1.1116794755639643, "mean_env_wait_ms": 2.3759586155099206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08064487150737218, "StateBufferConnector_ms": 0.011871329375675746, "ViewRequirementAgentConnector_ms": 0.14695599675178528}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 171074.307, "load_time_ms": 0.807, "load_throughput": 4954146.169, "learn_time_ms": 170009.194, "learn_throughput": 23.528, "synch_weights_time_ms": 180.232}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "episodes_total": 774, "training_iteration": 4, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-06_21-06-57", "timestamp": 1680808017, "time_this_iter_s": 171.3729908466339, "time_total_s": 684.3427934646606, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476bcd90>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014785edc0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 684.3427934646606, "timesteps_since_restore": 0, "iterations_since_restore": 4, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.493827160493828, "ram_util_percent": 23.409465020576132}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.865846714024903, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.01, "total_loss": 1.037869602065253, "policy_loss": 0.028129583798969786, "vf_loss": 0.7196064886346619, "vf_explained_var": 0.3683620886777037, "kl": 0.28655161676347574, "entropy": 3.219505140858312, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4185.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "sampler_results": {"episode_reward_max": -3.2, "episode_reward_min": -12.3, "episode_reward_mean": -4.937914691943129, "episode_len_mean": 18.900473933649288, "episode_media": {}, "episodes_this_iter": 211, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.7000000000000006, -3.6000000000000005, -3.6000000000000005, -3.500000000000001, -3.500000000000001, -10.8, -10.7, -3.6000000000000005, -12.0, -3.7000000000000006, -12.3, -3.700000000000001, -3.500000000000001, -3.8000000000000007, -3.7000000000000006, -3.500000000000001, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -3.700000000000001, -11.2, -11.6, -10.2, -3.6000000000000005, -4.000000000000001, -3.7000000000000006, -3.600000000000001, -3.8000000000000007, -11.8, -3.7000000000000006, -4.000000000000001, -3.2, -3.600000000000001, -3.3000000000000003, -3.500000000000001, -10.9, -3.600000000000001, -11.700000000000001, -3.6000000000000005, -3.8000000000000007, -3.6000000000000005, -3.6000000000000005, -3.700000000000001, -4.000000000000001, -3.700000000000001, -3.6000000000000005, -3.8000000000000007, -3.6000000000000005, -10.2, -3.500000000000001, -4.000000000000001, -4.000000000000001, -3.800000000000001, -3.900000000000001, -3.7000000000000006, -3.700000000000001, -3.7000000000000006, -3.5000000000000004, -3.500000000000001, -3.6000000000000005, -3.7000000000000006, -4.100000000000001, -3.600000000000001, -3.8000000000000007, -3.8000000000000007, -3.4000000000000004, -3.7000000000000006, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.9000000000000017, -3.900000000000001, -3.8000000000000007, -3.9000000000000012, -3.5000000000000004, -3.7000000000000006, -3.7000000000000006, -3.600000000000001, -3.9000000000000012, -4.300000000000001, -11.0, -3.800000000000001, -4.100000000000001, -3.400000000000001, -4.000000000000001, -3.600000000000001, -3.7, -3.6000000000000005, -3.7000000000000015, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -3.5000000000000004, -3.6000000000000005, -10.6, -3.8000000000000007, -12.1, -3.8000000000000007, -3.500000000000001, -3.600000000000001, -10.4, -10.7, -3.400000000000001, -3.7000000000000006, -3.4000000000000004, -3.6, -3.700000000000001, -3.900000000000001, -11.3, -3.8000000000000007, -11.7, -3.8000000000000007, -3.600000000000001, -10.5, -3.400000000000001, -3.7000000000000006, -3.8000000000000007, -10.7, -10.0, -10.3, -3.8000000000000007, -3.400000000000001, -11.0, -10.1, -4.000000000000001, -10.8, -3.600000000000001, -3.7000000000000006, -10.9, -3.900000000000001, -4.000000000000001, -3.7, -4.000000000000001, -3.6, -3.7000000000000006, -3.600000000000001, -3.800000000000001, -3.700000000000001, -3.600000000000001, -3.700000000000001, -4.000000000000002, -3.8000000000000007, -3.300000000000001, -3.9000000000000012, -3.6000000000000005, -3.8000000000000007, -11.1, -11.1, -3.8000000000000007, -3.7000000000000006, -3.700000000000001, -3.600000000000001, -3.500000000000001, -4.100000000000001, -3.3000000000000007, -3.800000000000001, -3.400000000000001, -3.8000000000000003, -3.3000000000000003, -3.8000000000000007, -3.600000000000001, -3.700000000000001, -3.5000000000000004, -10.0, -10.4, -11.9, -3.900000000000001, -3.8000000000000007, -10.8, -3.8000000000000007, -3.7000000000000006, -3.9000000000000012, -3.5000000000000004, -3.8000000000000007, -3.400000000000001, -10.9, -3.400000000000001, -3.700000000000001, -3.900000000000001, -3.8000000000000007, -3.5000000000000004, -3.900000000000001, -3.600000000000001, -3.6000000000000005, -3.600000000000001, -4.200000000000001, -3.6, -10.4, -3.500000000000001, -3.7000000000000006, -3.700000000000001, -3.6000000000000005, -3.600000000000001, -3.7000000000000006, -10.6, -11.9, -3.7000000000000006, -3.8000000000000007, -3.8000000000000007, -3.5000000000000004, -3.500000000000001, -3.600000000000001, -3.6, -3.8000000000000007, -3.3000000000000003, -3.4000000000000004, -3.900000000000001, -3.700000000000001, -3.7000000000000006], "episode_lengths": [21, 21, 21, 21, 21, 8, 7, 21, 16, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 13, 3, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 8, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 17, 21, 21, 21, 4, 7, 21, 21, 21, 21, 21, 21, 10, 21, 13, 21, 21, 4, 21, 21, 21, 6, 1, 4, 21, 21, 8, 2, 21, 9, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 4, 16, 21, 21, 8, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 7, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.773555626286775, "mean_inference_ms": 19.261508851433717, "mean_action_processing_ms": 1.0850427633023016, "mean_env_wait_ms": 2.260624554093376, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0826379134191721, "StateBufferConnector_ms": 0.012290873233740928, "ViewRequirementAgentConnector_ms": 0.15066065494483116}}, "episode_reward_max": -3.2, "episode_reward_min": -12.3, "episode_reward_mean": -4.937914691943129, "episode_len_mean": 18.900473933649288, "episodes_this_iter": 211, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.7000000000000006, -3.6000000000000005, -3.6000000000000005, -3.500000000000001, -3.500000000000001, -10.8, -10.7, -3.6000000000000005, -12.0, -3.7000000000000006, -12.3, -3.700000000000001, -3.500000000000001, -3.8000000000000007, -3.7000000000000006, -3.500000000000001, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -3.700000000000001, -11.2, -11.6, -10.2, -3.6000000000000005, -4.000000000000001, -3.7000000000000006, -3.600000000000001, -3.8000000000000007, -11.8, -3.7000000000000006, -4.000000000000001, -3.2, -3.600000000000001, -3.3000000000000003, -3.500000000000001, -10.9, -3.600000000000001, -11.700000000000001, -3.6000000000000005, -3.8000000000000007, -3.6000000000000005, -3.6000000000000005, -3.700000000000001, -4.000000000000001, -3.700000000000001, -3.6000000000000005, -3.8000000000000007, -3.6000000000000005, -10.2, -3.500000000000001, -4.000000000000001, -4.000000000000001, -3.800000000000001, -3.900000000000001, -3.7000000000000006, -3.700000000000001, -3.7000000000000006, -3.5000000000000004, -3.500000000000001, -3.6000000000000005, -3.7000000000000006, -4.100000000000001, -3.600000000000001, -3.8000000000000007, -3.8000000000000007, -3.4000000000000004, -3.7000000000000006, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.9000000000000017, -3.900000000000001, -3.8000000000000007, -3.9000000000000012, -3.5000000000000004, -3.7000000000000006, -3.7000000000000006, -3.600000000000001, -3.9000000000000012, -4.300000000000001, -11.0, -3.800000000000001, -4.100000000000001, -3.400000000000001, -4.000000000000001, -3.600000000000001, -3.7, -3.6000000000000005, -3.7000000000000015, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -3.5000000000000004, -3.6000000000000005, -10.6, -3.8000000000000007, -12.1, -3.8000000000000007, -3.500000000000001, -3.600000000000001, -10.4, -10.7, -3.400000000000001, -3.7000000000000006, -3.4000000000000004, -3.6, -3.700000000000001, -3.900000000000001, -11.3, -3.8000000000000007, -11.7, -3.8000000000000007, -3.600000000000001, -10.5, -3.400000000000001, -3.7000000000000006, -3.8000000000000007, -10.7, -10.0, -10.3, -3.8000000000000007, -3.400000000000001, -11.0, -10.1, -4.000000000000001, -10.8, -3.600000000000001, -3.7000000000000006, -10.9, -3.900000000000001, -4.000000000000001, -3.7, -4.000000000000001, -3.6, -3.7000000000000006, -3.600000000000001, -3.800000000000001, -3.700000000000001, -3.600000000000001, -3.700000000000001, -4.000000000000002, -3.8000000000000007, -3.300000000000001, -3.9000000000000012, -3.6000000000000005, -3.8000000000000007, -11.1, -11.1, -3.8000000000000007, -3.7000000000000006, -3.700000000000001, -3.600000000000001, -3.500000000000001, -4.100000000000001, -3.3000000000000007, -3.800000000000001, -3.400000000000001, -3.8000000000000003, -3.3000000000000003, -3.8000000000000007, -3.600000000000001, -3.700000000000001, -3.5000000000000004, -10.0, -10.4, -11.9, -3.900000000000001, -3.8000000000000007, -10.8, -3.8000000000000007, -3.7000000000000006, -3.9000000000000012, -3.5000000000000004, -3.8000000000000007, -3.400000000000001, -10.9, -3.400000000000001, -3.700000000000001, -3.900000000000001, -3.8000000000000007, -3.5000000000000004, -3.900000000000001, -3.600000000000001, -3.6000000000000005, -3.600000000000001, -4.200000000000001, -3.6, -10.4, -3.500000000000001, -3.7000000000000006, -3.700000000000001, -3.6000000000000005, -3.600000000000001, -3.7000000000000006, -10.6, -11.9, -3.7000000000000006, -3.8000000000000007, -3.8000000000000007, -3.5000000000000004, -3.500000000000001, -3.600000000000001, -3.6, -3.8000000000000007, -3.3000000000000003, -3.4000000000000004, -3.900000000000001, -3.700000000000001, -3.7000000000000006], "episode_lengths": [21, 21, 21, 21, 21, 8, 7, 21, 16, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 13, 3, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 8, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 17, 21, 21, 21, 4, 7, 21, 21, 21, 21, 21, 21, 10, 21, 13, 21, 21, 4, 21, 21, 21, 6, 1, 4, 21, 21, 8, 2, 21, 9, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 4, 16, 21, 21, 8, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 7, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.773555626286775, "mean_inference_ms": 19.261508851433717, "mean_action_processing_ms": 1.0850427633023016, "mean_env_wait_ms": 2.260624554093376, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0826379134191721, "StateBufferConnector_ms": 0.012290873233740928, "ViewRequirementAgentConnector_ms": 0.15066065494483116}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 170972.63, "load_time_ms": 0.862, "load_throughput": 4640486.806, "learn_time_ms": 169916.581, "learn_throughput": 23.541, "synch_weights_time_ms": 182.731}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "episodes_total": 985, "training_iteration": 5, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-06_21-09-48", "timestamp": 1680808188, "time_this_iter_s": 170.57790398597717, "time_total_s": 854.9206974506378, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476d1c40>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7effc2556ca0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 854.9206974506378, "timesteps_since_restore": 0, "iterations_since_restore": 5, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.3557851239669425, "ram_util_percent": 23.49793388429752}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.63562536111442, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.01, "total_loss": 1.048551579384554, "policy_loss": 0.0024065451070626256, "vf_loss": 0.8855435178284684, "vf_explained_var": 0.38328677601711725, "kl": 0.10574585892740757, "entropy": 3.277311658859253, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5115.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": 99.2, "episode_reward_min": -12.8, "episode_reward_mean": -4.677727272727274, "episode_len_mean": 18.8, "episode_media": {}, "episodes_this_iter": 220, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.7, -11.8, -11.4, -3.6000000000000005, -3.9000000000000012, -3.600000000000001, -3.7000000000000006, -3.7000000000000006, -4.000000000000001, -3.7000000000000006, -12.0, -10.3, -3.6000000000000005, -3.8000000000000007, -3.600000000000001, -3.8000000000000007, -10.2, -12.1, -11.1, -12.0, -3.7000000000000006, -11.4, -4.000000000000001, -10.0, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000003, -12.0, -10.7, -3.900000000000001, -11.4, -12.2, -11.3, -4.000000000000001, -10.7, -3.500000000000001, -4.200000000000001, -3.8000000000000003, -3.7000000000000006, -3.500000000000001, -3.900000000000001, -3.500000000000001, -3.7000000000000006, -3.600000000000001, -3.500000000000001, -3.400000000000001, -3.700000000000001, -4.100000000000001, -3.700000000000001, -10.1, -3.7000000000000006, -3.800000000000001, -4.100000000000001, -3.800000000000001, -3.900000000000001, -12.0, -3.7000000000000006, -3.600000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -4.100000000000001, -12.3, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -3.7000000000000006, -3.700000000000001, -3.900000000000001, -3.900000000000001, -3.800000000000001, -3.6000000000000005, -3.800000000000001, -4.000000000000001, -3.7000000000000006, -12.4, -3.6000000000000005, -3.7000000000000006, -3.7000000000000006, -12.0, -4.000000000000002, -3.9000000000000012, -3.600000000000001, -4.000000000000001, -3.6000000000000005, -3.900000000000001, -3.6000000000000005, -3.800000000000001, -3.6000000000000005, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.700000000000001, -3.6000000000000005, -3.7000000000000006, -3.6000000000000005, -4.000000000000001, -3.7000000000000006, -3.800000000000001, -3.500000000000001, -3.900000000000001, -3.700000000000001, -3.8000000000000007, -3.7000000000000006, -3.900000000000001, -12.8, -3.900000000000001, -3.700000000000001, -3.800000000000001, -4.000000000000001, -10.9, -3.700000000000001, -3.5000000000000004, -11.6, -10.1, -3.9000000000000012, -3.900000000000001, -3.8000000000000007, -3.7000000000000006, -3.800000000000001, -3.8000000000000007, -4.100000000000001, -3.7000000000000006, -4.0, -10.6, -3.600000000000001, -3.800000000000001, -3.6000000000000005, -4.000000000000002, -3.8000000000000007, -3.800000000000001, -4.000000000000002, -3.7000000000000006, -3.5000000000000004, -4.000000000000001, -3.600000000000001, -4.100000000000001, -10.6, -3.600000000000001, -3.700000000000001, -3.900000000000001, -4.000000000000001, -3.6000000000000005, -3.400000000000001, -3.700000000000001, -3.600000000000001, -3.8000000000000007, -11.5, -11.8, -3.8000000000000007, -3.700000000000001, -3.800000000000001, -3.500000000000001, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -11.7, -3.600000000000001, -3.900000000000001, -4.000000000000001, -10.1, -4.000000000000001, -10.1, -4.000000000000002, -4.000000000000001, -3.600000000000001, -4.000000000000001, -3.9000000000000004, -10.2, -4.100000000000001, -3.9000000000000012, -3.700000000000001, -3.5000000000000004, -3.6000000000000005, -3.6000000000000005, -3.6000000000000005, -3.800000000000001, -3.8000000000000007, 99.2, -3.7000000000000006, -3.500000000000001, -3.7000000000000006, -3.5000000000000004, -3.8000000000000007, -10.8, -3.7000000000000006, -10.7, -10.1, -10.4, -3.9000000000000004, -3.600000000000001, -11.7, -3.7000000000000006, -3.6000000000000005, -10.8, -3.4000000000000004, -3.8000000000000007, -3.900000000000001, -3.5000000000000004, -3.7000000000000006, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.800000000000001, -3.800000000000001, -3.4000000000000004, -3.800000000000001, -3.700000000000001, -3.600000000000001, -4.000000000000001, -3.700000000000001, -10.3, -3.8000000000000007, -3.800000000000001, -3.700000000000001, -3.600000000000001, -10.9], "episode_lengths": [21, 15, 12, 21, 21, 21, 21, 21, 21, 21, 15, 4, 21, 21, 21, 21, 3, 16, 10, 14, 21, 11, 21, 1, 21, 21, 21, 21, 21, 21, 14, 7, 21, 11, 17, 12, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 9, 21, 21, 13, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 14, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 2, 21, 2, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 8, 21, 6, 2, 5, 21, 21, 13, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 7]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.834769410535323, "mean_inference_ms": 19.053226239156395, "mean_action_processing_ms": 1.0558937385868612, "mean_env_wait_ms": 2.171116480694777, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08317763155156915, "StateBufferConnector_ms": 0.011175329034978693, "ViewRequirementAgentConnector_ms": 0.14802650971846146}}, "episode_reward_max": 99.2, "episode_reward_min": -12.8, "episode_reward_mean": -4.677727272727274, "episode_len_mean": 18.8, "episodes_this_iter": 220, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.7, -11.8, -11.4, -3.6000000000000005, -3.9000000000000012, -3.600000000000001, -3.7000000000000006, -3.7000000000000006, -4.000000000000001, -3.7000000000000006, -12.0, -10.3, -3.6000000000000005, -3.8000000000000007, -3.600000000000001, -3.8000000000000007, -10.2, -12.1, -11.1, -12.0, -3.7000000000000006, -11.4, -4.000000000000001, -10.0, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000003, -12.0, -10.7, -3.900000000000001, -11.4, -12.2, -11.3, -4.000000000000001, -10.7, -3.500000000000001, -4.200000000000001, -3.8000000000000003, -3.7000000000000006, -3.500000000000001, -3.900000000000001, -3.500000000000001, -3.7000000000000006, -3.600000000000001, -3.500000000000001, -3.400000000000001, -3.700000000000001, -4.100000000000001, -3.700000000000001, -10.1, -3.7000000000000006, -3.800000000000001, -4.100000000000001, -3.800000000000001, -3.900000000000001, -12.0, -3.7000000000000006, -3.600000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -4.100000000000001, -12.3, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -3.7000000000000006, -3.700000000000001, -3.900000000000001, -3.900000000000001, -3.800000000000001, -3.6000000000000005, -3.800000000000001, -4.000000000000001, -3.7000000000000006, -12.4, -3.6000000000000005, -3.7000000000000006, -3.7000000000000006, -12.0, -4.000000000000002, -3.9000000000000012, -3.600000000000001, -4.000000000000001, -3.6000000000000005, -3.900000000000001, -3.6000000000000005, -3.800000000000001, -3.6000000000000005, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.700000000000001, -3.6000000000000005, -3.7000000000000006, -3.6000000000000005, -4.000000000000001, -3.7000000000000006, -3.800000000000001, -3.500000000000001, -3.900000000000001, -3.700000000000001, -3.8000000000000007, -3.7000000000000006, -3.900000000000001, -12.8, -3.900000000000001, -3.700000000000001, -3.800000000000001, -4.000000000000001, -10.9, -3.700000000000001, -3.5000000000000004, -11.6, -10.1, -3.9000000000000012, -3.900000000000001, -3.8000000000000007, -3.7000000000000006, -3.800000000000001, -3.8000000000000007, -4.100000000000001, -3.7000000000000006, -4.0, -10.6, -3.600000000000001, -3.800000000000001, -3.6000000000000005, -4.000000000000002, -3.8000000000000007, -3.800000000000001, -4.000000000000002, -3.7000000000000006, -3.5000000000000004, -4.000000000000001, -3.600000000000001, -4.100000000000001, -10.6, -3.600000000000001, -3.700000000000001, -3.900000000000001, -4.000000000000001, -3.6000000000000005, -3.400000000000001, -3.700000000000001, -3.600000000000001, -3.8000000000000007, -11.5, -11.8, -3.8000000000000007, -3.700000000000001, -3.800000000000001, -3.500000000000001, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -11.7, -3.600000000000001, -3.900000000000001, -4.000000000000001, -10.1, -4.000000000000001, -10.1, -4.000000000000002, -4.000000000000001, -3.600000000000001, -4.000000000000001, -3.9000000000000004, -10.2, -4.100000000000001, -3.9000000000000012, -3.700000000000001, -3.5000000000000004, -3.6000000000000005, -3.6000000000000005, -3.6000000000000005, -3.800000000000001, -3.8000000000000007, 99.2, -3.7000000000000006, -3.500000000000001, -3.7000000000000006, -3.5000000000000004, -3.8000000000000007, -10.8, -3.7000000000000006, -10.7, -10.1, -10.4, -3.9000000000000004, -3.600000000000001, -11.7, -3.7000000000000006, -3.6000000000000005, -10.8, -3.4000000000000004, -3.8000000000000007, -3.900000000000001, -3.5000000000000004, -3.7000000000000006, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.800000000000001, -3.800000000000001, -3.4000000000000004, -3.800000000000001, -3.700000000000001, -3.600000000000001, -4.000000000000001, -3.700000000000001, -10.3, -3.8000000000000007, -3.800000000000001, -3.700000000000001, -3.600000000000001, -10.9], "episode_lengths": [21, 15, 12, 21, 21, 21, 21, 21, 21, 21, 15, 4, 21, 21, 21, 21, 3, 16, 10, 14, 21, 11, 21, 1, 21, 21, 21, 21, 21, 21, 14, 7, 21, 11, 17, 12, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 9, 21, 21, 13, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 14, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 2, 21, 2, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 8, 21, 6, 2, 5, 21, 21, 13, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 7]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.834769410535323, "mean_inference_ms": 19.053226239156395, "mean_action_processing_ms": 1.0558937385868612, "mean_env_wait_ms": 2.171116480694777, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08317763155156915, "StateBufferConnector_ms": 0.011175329034978693, "ViewRequirementAgentConnector_ms": 0.14802650971846146}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 170887.682, "load_time_ms": 0.902, "load_throughput": 4437047.472, "learn_time_ms": 169845.984, "learn_throughput": 23.551, "synch_weights_time_ms": 183.039}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 1205, "training_iteration": 6, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-06_21-12-38", "timestamp": 1680808358, "time_this_iter_s": 170.47465753555298, "time_total_s": 1025.3953549861908, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476d74f0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01475fc820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 1025.3953549861908, "timesteps_since_restore": 0, "iterations_since_restore": 6, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.3999999999999995, "ram_util_percent": 23.500413223140498}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.799719139196539, "cur_kl_coeff": 2.2781249999999993, "cur_lr": 0.01, "total_loss": 0.6488245960284946, "policy_loss": -0.007552446739282459, "vf_loss": 0.40893307608221807, "vf_explained_var": 0.5563493515855522, "kl": 0.10861737670937693, "entropy": 3.3551705386049004, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6045.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "sampler_results": {"episode_reward_max": -3.3000000000000007, "episode_reward_min": -12.9, "episode_reward_mean": -4.6806763285024156, "episode_len_mean": 19.545893719806763, "episode_media": {}, "episodes_this_iter": 207, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.000000000000001, -3.9000000000000004, -3.700000000000001, -4.200000000000001, -3.700000000000001, -3.800000000000001, -3.8000000000000007, -11.3, -3.8000000000000007, -3.6000000000000005, -11.8, -3.800000000000001, -10.2, -3.6000000000000005, -3.900000000000001, -3.400000000000001, -10.4, -3.900000000000001, -3.6000000000000005, -3.700000000000001, -3.700000000000001, -3.900000000000001, -3.800000000000001, -3.600000000000001, -3.400000000000001, -4.000000000000002, -11.6, -3.500000000000001, -4.200000000000001, -3.5000000000000004, -3.6000000000000005, -4.200000000000001, -4.200000000000001, -3.6, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.800000000000001, -10.4, -3.7000000000000006, -10.3, -3.9000000000000012, -3.7000000000000006, -3.700000000000001, -3.800000000000001, -3.700000000000001, -3.800000000000001, -3.7000000000000006, -3.900000000000001, -3.900000000000001, -3.700000000000001, -3.900000000000001, -3.700000000000001, -3.6000000000000005, -4.200000000000001, -3.500000000000001, -3.8000000000000007, -4.000000000000002, -3.700000000000001, -3.600000000000001, -3.400000000000001, -4.100000000000001, -3.600000000000001, -10.4, -11.7, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -3.5000000000000013, -3.7000000000000006, -3.7000000000000006, -3.3000000000000007, -3.600000000000001, -3.700000000000001, -12.9, -3.800000000000001, -3.900000000000001, -3.400000000000001, -10.2, -4.000000000000001, -3.400000000000001, -3.500000000000001, -3.7000000000000006, -3.8000000000000007, -3.600000000000001, -3.8000000000000007, -3.900000000000001, -3.7000000000000006, -4.100000000000001, -10.0, -4.000000000000001, -3.800000000000001, -3.800000000000001, -3.9000000000000012, -3.500000000000001, -3.800000000000001, -4.0, -3.8000000000000007, -3.6000000000000005, -3.700000000000001, -3.700000000000001, -3.7000000000000006, -3.6000000000000005, -3.700000000000001, -3.500000000000001, -3.500000000000001, -3.600000000000001, -3.400000000000001, -3.8000000000000007, -3.7000000000000006, -3.900000000000001, -3.7000000000000006, -3.7000000000000006, -3.900000000000001, -3.600000000000001, -11.7, -4.000000000000001, -3.400000000000001, -3.8000000000000007, -3.600000000000001, -3.600000000000001, -3.7000000000000006, -3.700000000000001, -12.100000000000001, -4.000000000000001, -4.200000000000001, -3.600000000000001, -3.8000000000000007, -3.600000000000001, -4.000000000000002, -10.3, -3.6000000000000005, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.800000000000001, -3.600000000000001, -4.000000000000001, -3.900000000000001, -3.500000000000001, -4.100000000000001, -3.8000000000000007, -3.9000000000000012, -12.100000000000001, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -3.600000000000001, -3.7000000000000006, -10.2, -3.8000000000000007, -3.700000000000001, -4.000000000000002, -3.3000000000000007, -3.8000000000000007, -3.7000000000000006, -10.2, -3.900000000000001, -4.1000000000000005, -10.1, -4.000000000000001, -3.800000000000001, -3.900000000000001, -3.700000000000001, -10.9, -3.800000000000001, -3.9000000000000012, -12.0, -3.6000000000000005, -3.7000000000000006, -11.2, -3.6000000000000005, -3.5000000000000004, -3.8000000000000007, -3.8000000000000003, -3.6000000000000005, -3.800000000000001, -11.7, -3.7000000000000006, -3.9000000000000012, -11.9, -11.2, -3.500000000000001, -3.800000000000001, -3.700000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.600000000000001, -3.800000000000001, -4.0, -3.8000000000000007, -3.600000000000001, -3.900000000000001, -3.4000000000000004, -4.000000000000001, -3.700000000000001, -4.100000000000001, -3.8000000000000007, -3.6000000000000005, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -11.0, -3.6000000000000005, -3.800000000000001, -3.8000000000000007], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 15, 21, 2, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 3, 21, 21, 2, 21, 21, 21, 21, 8, 21, 21, 17, 21, 21, 9, 21, 21, 21, 21, 21, 21, 15, 21, 21, 17, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.868745727112987, "mean_inference_ms": 19.06213108680556, "mean_action_processing_ms": 1.0476491718133438, "mean_env_wait_ms": 2.1368025442750698, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07818989131761633, "StateBufferConnector_ms": 0.010094320140599052, "ViewRequirementAgentConnector_ms": 0.14310309276488667}}, "episode_reward_max": -3.3000000000000007, "episode_reward_min": -12.9, "episode_reward_mean": -4.6806763285024156, "episode_len_mean": 19.545893719806763, "episodes_this_iter": 207, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.000000000000001, -3.9000000000000004, -3.700000000000001, -4.200000000000001, -3.700000000000001, -3.800000000000001, -3.8000000000000007, -11.3, -3.8000000000000007, -3.6000000000000005, -11.8, -3.800000000000001, -10.2, -3.6000000000000005, -3.900000000000001, -3.400000000000001, -10.4, -3.900000000000001, -3.6000000000000005, -3.700000000000001, -3.700000000000001, -3.900000000000001, -3.800000000000001, -3.600000000000001, -3.400000000000001, -4.000000000000002, -11.6, -3.500000000000001, -4.200000000000001, -3.5000000000000004, -3.6000000000000005, -4.200000000000001, -4.200000000000001, -3.6, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.800000000000001, -10.4, -3.7000000000000006, -10.3, -3.9000000000000012, -3.7000000000000006, -3.700000000000001, -3.800000000000001, -3.700000000000001, -3.800000000000001, -3.7000000000000006, -3.900000000000001, -3.900000000000001, -3.700000000000001, -3.900000000000001, -3.700000000000001, -3.6000000000000005, -4.200000000000001, -3.500000000000001, -3.8000000000000007, -4.000000000000002, -3.700000000000001, -3.600000000000001, -3.400000000000001, -4.100000000000001, -3.600000000000001, -10.4, -11.7, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -3.5000000000000013, -3.7000000000000006, -3.7000000000000006, -3.3000000000000007, -3.600000000000001, -3.700000000000001, -12.9, -3.800000000000001, -3.900000000000001, -3.400000000000001, -10.2, -4.000000000000001, -3.400000000000001, -3.500000000000001, -3.7000000000000006, -3.8000000000000007, -3.600000000000001, -3.8000000000000007, -3.900000000000001, -3.7000000000000006, -4.100000000000001, -10.0, -4.000000000000001, -3.800000000000001, -3.800000000000001, -3.9000000000000012, -3.500000000000001, -3.800000000000001, -4.0, -3.8000000000000007, -3.6000000000000005, -3.700000000000001, -3.700000000000001, -3.7000000000000006, -3.6000000000000005, -3.700000000000001, -3.500000000000001, -3.500000000000001, -3.600000000000001, -3.400000000000001, -3.8000000000000007, -3.7000000000000006, -3.900000000000001, -3.7000000000000006, -3.7000000000000006, -3.900000000000001, -3.600000000000001, -11.7, -4.000000000000001, -3.400000000000001, -3.8000000000000007, -3.600000000000001, -3.600000000000001, -3.7000000000000006, -3.700000000000001, -12.100000000000001, -4.000000000000001, -4.200000000000001, -3.600000000000001, -3.8000000000000007, -3.600000000000001, -4.000000000000002, -10.3, -3.6000000000000005, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.800000000000001, -3.600000000000001, -4.000000000000001, -3.900000000000001, -3.500000000000001, -4.100000000000001, -3.8000000000000007, -3.9000000000000012, -12.100000000000001, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -3.600000000000001, -3.7000000000000006, -10.2, -3.8000000000000007, -3.700000000000001, -4.000000000000002, -3.3000000000000007, -3.8000000000000007, -3.7000000000000006, -10.2, -3.900000000000001, -4.1000000000000005, -10.1, -4.000000000000001, -3.800000000000001, -3.900000000000001, -3.700000000000001, -10.9, -3.800000000000001, -3.9000000000000012, -12.0, -3.6000000000000005, -3.7000000000000006, -11.2, -3.6000000000000005, -3.5000000000000004, -3.8000000000000007, -3.8000000000000003, -3.6000000000000005, -3.800000000000001, -11.7, -3.7000000000000006, -3.9000000000000012, -11.9, -11.2, -3.500000000000001, -3.800000000000001, -3.700000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.600000000000001, -3.800000000000001, -4.0, -3.8000000000000007, -3.600000000000001, -3.900000000000001, -3.4000000000000004, -4.000000000000001, -3.700000000000001, -4.100000000000001, -3.8000000000000007, -3.6000000000000005, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -11.0, -3.6000000000000005, -3.800000000000001, -3.8000000000000007], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 15, 21, 2, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 3, 21, 21, 2, 21, 21, 21, 21, 8, 21, 21, 17, 21, 21, 9, 21, 21, 21, 21, 21, 21, 15, 21, 21, 17, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.868745727112987, "mean_inference_ms": 19.06213108680556, "mean_action_processing_ms": 1.0476491718133438, "mean_env_wait_ms": 2.1368025442750698, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07818989131761633, "StateBufferConnector_ms": 0.010094320140599052, "ViewRequirementAgentConnector_ms": 0.14310309276488667}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 170987.957, "load_time_ms": 0.935, "load_throughput": 4278498.743, "learn_time_ms": 169953.488, "learn_throughput": 23.536, "synch_weights_time_ms": 183.443}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "episodes_total": 1412, "training_iteration": 7, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-06_21-15-30", "timestamp": 1680808530, "time_this_iter_s": 171.60186004638672, "time_total_s": 1196.9972150325775, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476cbbb0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0147604dc0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 1196.9972150325775, "timesteps_since_restore": 0, "iterations_since_restore": 7, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.511885245901638, "ram_util_percent": 23.50409836065574}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.847085622049147, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.01, "total_loss": 0.8030629045980913, "policy_loss": 0.0011540314715896402, "vf_loss": 0.6475607442038674, "vf_explained_var": 0.37640858427170787, "kl": 0.04516817719615515, "entropy": 3.3018881669608495, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6975.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "sampler_results": {"episode_reward_max": 97.4, "episode_reward_min": -12.700000000000001, "episode_reward_mean": -4.428365384615386, "episode_len_mean": 19.14423076923077, "episode_media": {}, "episodes_this_iter": 208, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.6000000000000005, -10.8, -11.8, -3.400000000000001, -4.100000000000001, -3.9000000000000012, -3.800000000000001, -10.6, -4.0, -11.5, -3.7000000000000006, -4.100000000000001, -3.400000000000001, -12.1, -3.700000000000001, -3.500000000000001, -3.700000000000001, -3.7000000000000006, -3.900000000000001, -4.000000000000001, -11.0, -4.000000000000001, -3.700000000000001, -11.5, -3.5000000000000004, -3.900000000000001, -3.8000000000000007, -3.800000000000001, -3.700000000000001, -3.9000000000000012, -4.000000000000001, -3.700000000000001, -4.000000000000001, -3.500000000000001, -3.6000000000000005, -11.0, -3.6000000000000005, 97.4, -3.6000000000000005, -3.7000000000000006, -3.800000000000001, -11.0, -3.600000000000001, -11.6, -3.8000000000000007, -3.9000000000000012, -4.000000000000002, -3.700000000000001, -3.900000000000001, -3.700000000000001, -3.5000000000000004, -12.600000000000001, -3.8000000000000007, -3.800000000000001, -3.6000000000000005, -4.000000000000002, -3.9000000000000004, -4.000000000000001, -3.6000000000000005, -3.800000000000001, -3.500000000000001, -3.6000000000000005, -4.000000000000002, -4.100000000000001, -3.8000000000000003, -3.8000000000000007, -11.2, -3.4000000000000004, -3.8000000000000007, -3.8000000000000007, -3.7000000000000006, -3.900000000000001, -3.600000000000001, -3.5000000000000004, -3.900000000000001, -3.8000000000000007, -3.800000000000001, -3.7000000000000006, -4.000000000000002, -3.7000000000000006, -3.800000000000001, -4.000000000000001, -3.500000000000001, -3.9000000000000012, -3.7000000000000006, -3.7000000000000006, -3.700000000000001, -3.8000000000000007, -10.3, -4.000000000000001, -3.600000000000001, -3.500000000000001, -3.500000000000001, -3.600000000000001, -3.8000000000000007, -3.7000000000000006, -3.700000000000001, -3.8000000000000007, -3.6000000000000005, -3.800000000000001, -3.600000000000001, -3.700000000000001, -3.500000000000001, -3.600000000000001, -10.1, -3.700000000000001, -10.8, -3.900000000000001, -3.700000000000001, -4.100000000000001, -3.600000000000001, -3.7000000000000006, -4.000000000000001, -3.7000000000000006, -3.700000000000001, -3.500000000000001, -3.400000000000001, -12.700000000000001, -10.1, -4.000000000000001, -3.9000000000000012, -4.100000000000001, -3.600000000000001, -4.200000000000001, -3.8000000000000007, -3.600000000000001, -3.8000000000000007, -12.5, -3.800000000000001, -3.9000000000000012, -3.7000000000000006, -4.100000000000001, -3.600000000000001, -10.5, -10.1, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -3.500000000000001, -3.700000000000001, -3.5000000000000004, -4.000000000000002, -3.7000000000000006, -4.100000000000001, -3.4000000000000004, -3.900000000000001, -3.7000000000000006, -3.400000000000001, -10.5, -11.3, -3.8000000000000007, -3.8000000000000007, -3.7000000000000006, -3.7000000000000006, -11.1, -3.7000000000000006, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.6000000000000005, -3.7000000000000006, -3.7000000000000015, -3.900000000000001, -3.400000000000001, -3.7000000000000006, -11.0, -3.600000000000001, -3.8000000000000007, -3.3000000000000007, -3.6000000000000005, -3.7000000000000006, -4.000000000000002, -3.4000000000000004, -3.6000000000000005, -3.5000000000000004, -3.5000000000000013, -3.700000000000001, -11.5, -3.5000000000000004, -11.1, -3.7000000000000006, -3.7000000000000006, -3.900000000000001, -3.900000000000001, -3.700000000000001, -3.900000000000001, -3.500000000000001, -3.8000000000000007, -12.200000000000001, -3.800000000000001, -3.600000000000001, -10.6, -10.2, -3.7000000000000006, -10.5, -4.100000000000001, -3.9000000000000012, -11.9, -10.1, -3.900000000000001, -3.9000000000000012, -3.500000000000001, -3.8000000000000007, -3.5000000000000004, -10.3], "episode_lengths": [21, 8, 15, 21, 21, 21, 21, 7, 21, 12, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 9, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 20, 21, 21, 21, 8, 21, 13, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 2, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 5, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 12, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 5, 3, 21, 5, 21, 21, 17, 2, 21, 21, 21, 21, 21, 4]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.798907447305526, "mean_inference_ms": 18.77853895167785, "mean_action_processing_ms": 1.0325117112345177, "mean_env_wait_ms": 2.083339904178231, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07581664965702938, "StateBufferConnector_ms": 0.009721402938549336, "ViewRequirementAgentConnector_ms": 0.1376340022453895}}, "episode_reward_max": 97.4, "episode_reward_min": -12.700000000000001, "episode_reward_mean": -4.428365384615386, "episode_len_mean": 19.14423076923077, "episodes_this_iter": 208, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.6000000000000005, -10.8, -11.8, -3.400000000000001, -4.100000000000001, -3.9000000000000012, -3.800000000000001, -10.6, -4.0, -11.5, -3.7000000000000006, -4.100000000000001, -3.400000000000001, -12.1, -3.700000000000001, -3.500000000000001, -3.700000000000001, -3.7000000000000006, -3.900000000000001, -4.000000000000001, -11.0, -4.000000000000001, -3.700000000000001, -11.5, -3.5000000000000004, -3.900000000000001, -3.8000000000000007, -3.800000000000001, -3.700000000000001, -3.9000000000000012, -4.000000000000001, -3.700000000000001, -4.000000000000001, -3.500000000000001, -3.6000000000000005, -11.0, -3.6000000000000005, 97.4, -3.6000000000000005, -3.7000000000000006, -3.800000000000001, -11.0, -3.600000000000001, -11.6, -3.8000000000000007, -3.9000000000000012, -4.000000000000002, -3.700000000000001, -3.900000000000001, -3.700000000000001, -3.5000000000000004, -12.600000000000001, -3.8000000000000007, -3.800000000000001, -3.6000000000000005, -4.000000000000002, -3.9000000000000004, -4.000000000000001, -3.6000000000000005, -3.800000000000001, -3.500000000000001, -3.6000000000000005, -4.000000000000002, -4.100000000000001, -3.8000000000000003, -3.8000000000000007, -11.2, -3.4000000000000004, -3.8000000000000007, -3.8000000000000007, -3.7000000000000006, -3.900000000000001, -3.600000000000001, -3.5000000000000004, -3.900000000000001, -3.8000000000000007, -3.800000000000001, -3.7000000000000006, -4.000000000000002, -3.7000000000000006, -3.800000000000001, -4.000000000000001, -3.500000000000001, -3.9000000000000012, -3.7000000000000006, -3.7000000000000006, -3.700000000000001, -3.8000000000000007, -10.3, -4.000000000000001, -3.600000000000001, -3.500000000000001, -3.500000000000001, -3.600000000000001, -3.8000000000000007, -3.7000000000000006, -3.700000000000001, -3.8000000000000007, -3.6000000000000005, -3.800000000000001, -3.600000000000001, -3.700000000000001, -3.500000000000001, -3.600000000000001, -10.1, -3.700000000000001, -10.8, -3.900000000000001, -3.700000000000001, -4.100000000000001, -3.600000000000001, -3.7000000000000006, -4.000000000000001, -3.7000000000000006, -3.700000000000001, -3.500000000000001, -3.400000000000001, -12.700000000000001, -10.1, -4.000000000000001, -3.9000000000000012, -4.100000000000001, -3.600000000000001, -4.200000000000001, -3.8000000000000007, -3.600000000000001, -3.8000000000000007, -12.5, -3.800000000000001, -3.9000000000000012, -3.7000000000000006, -4.100000000000001, -3.600000000000001, -10.5, -10.1, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -3.500000000000001, -3.700000000000001, -3.5000000000000004, -4.000000000000002, -3.7000000000000006, -4.100000000000001, -3.4000000000000004, -3.900000000000001, -3.7000000000000006, -3.400000000000001, -10.5, -11.3, -3.8000000000000007, -3.8000000000000007, -3.7000000000000006, -3.7000000000000006, -11.1, -3.7000000000000006, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.6000000000000005, -3.7000000000000006, -3.7000000000000015, -3.900000000000001, -3.400000000000001, -3.7000000000000006, -11.0, -3.600000000000001, -3.8000000000000007, -3.3000000000000007, -3.6000000000000005, -3.7000000000000006, -4.000000000000002, -3.4000000000000004, -3.6000000000000005, -3.5000000000000004, -3.5000000000000013, -3.700000000000001, -11.5, -3.5000000000000004, -11.1, -3.7000000000000006, -3.7000000000000006, -3.900000000000001, -3.900000000000001, -3.700000000000001, -3.900000000000001, -3.500000000000001, -3.8000000000000007, -12.200000000000001, -3.800000000000001, -3.600000000000001, -10.6, -10.2, -3.7000000000000006, -10.5, -4.100000000000001, -3.9000000000000012, -11.9, -10.1, -3.900000000000001, -3.9000000000000012, -3.500000000000001, -3.8000000000000007, -3.5000000000000004, -10.3], "episode_lengths": [21, 8, 15, 21, 21, 21, 21, 7, 21, 12, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 9, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 20, 21, 21, 21, 8, 21, 13, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 2, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 5, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 12, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 5, 3, 21, 5, 21, 21, 17, 2, 21, 21, 21, 21, 21, 4]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.798907447305526, "mean_inference_ms": 18.77853895167785, "mean_action_processing_ms": 1.0325117112345177, "mean_env_wait_ms": 2.083339904178231, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07581664965702938, "StateBufferConnector_ms": 0.009721402938549336, "ViewRequirementAgentConnector_ms": 0.1376340022453895}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 170933.133, "load_time_ms": 0.955, "load_throughput": 4189198.414, "learn_time_ms": 169913.225, "learn_throughput": 23.541, "synch_weights_time_ms": 180.944}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "episodes_total": 1620, "training_iteration": 8, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-06_21-18-20", "timestamp": 1680808700, "time_this_iter_s": 170.5610954761505, "time_total_s": 1367.558310508728, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0147740e50>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014785edc0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 1367.558310508728, "timesteps_since_restore": 0, "iterations_since_restore": 8, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.350826446280992, "ram_util_percent": 23.500826446280993}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.424205319343075, "cur_kl_coeff": 5.12578125, "cur_lr": 0.01, "total_loss": 0.9787285852015659, "policy_loss": 0.00354207819778352, "vf_loss": 0.6548928422232468, "vf_explained_var": 0.30462545521797674, "kl": 0.062486801411636095, "entropy": 3.2476705487056443, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7905.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": -3.3000000000000003, "episode_reward_min": -12.700000000000001, "episode_reward_mean": -4.617142857142857, "episode_len_mean": 19.795238095238094, "episode_media": {}, "episodes_this_iter": 210, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.0, -3.800000000000001, -4.100000000000001, -12.1, -3.8000000000000003, -3.600000000000001, -4.100000000000001, -3.700000000000001, -3.900000000000001, -3.900000000000001, -10.5, -4.000000000000001, -3.8000000000000007, -3.500000000000001, -3.800000000000001, -4.000000000000001, -4.000000000000001, -3.600000000000001, -3.600000000000001, -11.3, -3.500000000000001, -3.500000000000001, -12.4, -10.1, -3.9000000000000012, -10.0, -3.700000000000001, -3.8000000000000007, -3.8000000000000007, -3.3000000000000007, -3.6000000000000005, -3.700000000000001, -4.000000000000001, -3.800000000000001, -3.700000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -3.500000000000001, -4.1000000000000005, -3.600000000000001, -3.900000000000001, -3.900000000000001, -4.0, -4.100000000000001, -4.1000000000000005, -4.200000000000001, -3.7000000000000006, -3.7000000000000006, -10.6, -3.700000000000001, -3.7000000000000006, -3.8000000000000007, -10.7, -3.6000000000000005, -3.700000000000001, -3.7000000000000006, -3.9000000000000012, -3.500000000000001, -3.800000000000001, -3.8000000000000007, -3.8000000000000007, -3.700000000000001, -3.600000000000001, -3.8000000000000007, -3.900000000000001, -10.6, -3.9000000000000012, -3.700000000000001, -3.6000000000000005, -3.8000000000000007, -3.8000000000000007, -3.700000000000001, -4.000000000000001, -12.700000000000001, -3.6000000000000005, -3.800000000000001, -3.800000000000001, -11.2, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -3.5000000000000004, -3.700000000000001, -3.700000000000001, -3.9000000000000012, -4.100000000000001, -3.900000000000001, -3.500000000000001, -11.600000000000001, -3.7000000000000006, -4.0, -3.8000000000000007, -3.8000000000000003, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.3000000000000003, -3.900000000000001, -3.700000000000001, -4.000000000000002, -3.9000000000000012, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -3.7, -3.9000000000000004, -3.5000000000000004, -3.8000000000000003, -4.000000000000001, -3.400000000000001, -3.700000000000001, -3.8000000000000007, -3.8000000000000007, -3.9000000000000004, -3.7000000000000006, -3.900000000000001, -3.800000000000001, -3.700000000000001, -3.900000000000001, -12.3, -11.3, -4.100000000000001, -4.300000000000001, -3.900000000000001, -3.900000000000001, -3.9000000000000004, -3.900000000000001, -3.800000000000001, -3.800000000000001, -3.800000000000001, -3.8000000000000007, -3.800000000000001, -3.8000000000000007, -3.8000000000000007, -3.700000000000001, -3.7000000000000006, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -3.700000000000001, -11.1, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -3.600000000000001, -3.9000000000000012, -4.000000000000001, -3.7000000000000006, -3.600000000000001, -11.2, -3.9000000000000012, -4.400000000000001, -3.700000000000001, -3.6000000000000005, -3.900000000000001, -3.700000000000001, -3.900000000000001, -3.7, -3.9000000000000012, -3.8000000000000007, -3.8000000000000007, -11.0, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -11.7, -3.6000000000000005, -3.8000000000000007, -3.7000000000000006, -4.100000000000001, -3.6000000000000005, -3.8000000000000007, -3.900000000000001, -10.3, -3.7000000000000006, -4.100000000000001, -4.100000000000001, -4.300000000000001, -3.7000000000000006, -3.9000000000000004, -10.9, -3.5000000000000004, -3.5000000000000004, -3.6000000000000005, -3.8000000000000007, -10.8, -3.900000000000001, -3.700000000000001, -3.7000000000000006, -3.6000000000000005, -4.100000000000001, -3.800000000000001, -4.000000000000001, -11.6, -4.000000000000001, -3.7000000000000006, -11.3, -3.7000000000000006, -3.7000000000000006, -3.500000000000001, -4.000000000000001, -4.000000000000001, -3.700000000000001, -3.700000000000001], "episode_lengths": [21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 20, 2, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.798790003117434, "mean_inference_ms": 18.74216074568446, "mean_action_processing_ms": 1.0273201030920884, "mean_env_wait_ms": 2.028526189734327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08180584226335798, "StateBufferConnector_ms": 0.01032477333432152, "ViewRequirementAgentConnector_ms": 0.14662515549432664}}, "episode_reward_max": -3.3000000000000003, "episode_reward_min": -12.700000000000001, "episode_reward_mean": -4.617142857142857, "episode_len_mean": 19.795238095238094, "episodes_this_iter": 210, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.0, -3.800000000000001, -4.100000000000001, -12.1, -3.8000000000000003, -3.600000000000001, -4.100000000000001, -3.700000000000001, -3.900000000000001, -3.900000000000001, -10.5, -4.000000000000001, -3.8000000000000007, -3.500000000000001, -3.800000000000001, -4.000000000000001, -4.000000000000001, -3.600000000000001, -3.600000000000001, -11.3, -3.500000000000001, -3.500000000000001, -12.4, -10.1, -3.9000000000000012, -10.0, -3.700000000000001, -3.8000000000000007, -3.8000000000000007, -3.3000000000000007, -3.6000000000000005, -3.700000000000001, -4.000000000000001, -3.800000000000001, -3.700000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -3.500000000000001, -4.1000000000000005, -3.600000000000001, -3.900000000000001, -3.900000000000001, -4.0, -4.100000000000001, -4.1000000000000005, -4.200000000000001, -3.7000000000000006, -3.7000000000000006, -10.6, -3.700000000000001, -3.7000000000000006, -3.8000000000000007, -10.7, -3.6000000000000005, -3.700000000000001, -3.7000000000000006, -3.9000000000000012, -3.500000000000001, -3.800000000000001, -3.8000000000000007, -3.8000000000000007, -3.700000000000001, -3.600000000000001, -3.8000000000000007, -3.900000000000001, -10.6, -3.9000000000000012, -3.700000000000001, -3.6000000000000005, -3.8000000000000007, -3.8000000000000007, -3.700000000000001, -4.000000000000001, -12.700000000000001, -3.6000000000000005, -3.800000000000001, -3.800000000000001, -11.2, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -3.5000000000000004, -3.700000000000001, -3.700000000000001, -3.9000000000000012, -4.100000000000001, -3.900000000000001, -3.500000000000001, -11.600000000000001, -3.7000000000000006, -4.0, -3.8000000000000007, -3.8000000000000003, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.3000000000000003, -3.900000000000001, -3.700000000000001, -4.000000000000002, -3.9000000000000012, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -3.7, -3.9000000000000004, -3.5000000000000004, -3.8000000000000003, -4.000000000000001, -3.400000000000001, -3.700000000000001, -3.8000000000000007, -3.8000000000000007, -3.9000000000000004, -3.7000000000000006, -3.900000000000001, -3.800000000000001, -3.700000000000001, -3.900000000000001, -12.3, -11.3, -4.100000000000001, -4.300000000000001, -3.900000000000001, -3.900000000000001, -3.9000000000000004, -3.900000000000001, -3.800000000000001, -3.800000000000001, -3.800000000000001, -3.8000000000000007, -3.800000000000001, -3.8000000000000007, -3.8000000000000007, -3.700000000000001, -3.7000000000000006, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -3.700000000000001, -11.1, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -3.600000000000001, -3.9000000000000012, -4.000000000000001, -3.7000000000000006, -3.600000000000001, -11.2, -3.9000000000000012, -4.400000000000001, -3.700000000000001, -3.6000000000000005, -3.900000000000001, -3.700000000000001, -3.900000000000001, -3.7, -3.9000000000000012, -3.8000000000000007, -3.8000000000000007, -11.0, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -11.7, -3.6000000000000005, -3.8000000000000007, -3.7000000000000006, -4.100000000000001, -3.6000000000000005, -3.8000000000000007, -3.900000000000001, -10.3, -3.7000000000000006, -4.100000000000001, -4.100000000000001, -4.300000000000001, -3.7000000000000006, -3.9000000000000004, -10.9, -3.5000000000000004, -3.5000000000000004, -3.6000000000000005, -3.8000000000000007, -10.8, -3.900000000000001, -3.700000000000001, -3.7000000000000006, -3.6000000000000005, -4.100000000000001, -3.800000000000001, -4.000000000000001, -11.6, -4.000000000000001, -3.7000000000000006, -11.3, -3.7000000000000006, -3.7000000000000006, -3.500000000000001, -4.000000000000001, -4.000000000000001, -3.700000000000001, -3.700000000000001], "episode_lengths": [21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 20, 2, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.798790003117434, "mean_inference_ms": 18.74216074568446, "mean_action_processing_ms": 1.0273201030920884, "mean_env_wait_ms": 2.028526189734327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08180584226335798, "StateBufferConnector_ms": 0.01032477333432152, "ViewRequirementAgentConnector_ms": 0.14662515549432664}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 170894.909, "load_time_ms": 0.976, "load_throughput": 4098779.663, "learn_time_ms": 169880.397, "learn_throughput": 23.546, "synch_weights_time_ms": 181.432}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 1830, "training_iteration": 9, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-06_21-21-11", "timestamp": 1680808871, "time_this_iter_s": 170.60034322738647, "time_total_s": 1538.1586537361145, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01477a3dc0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0147604dc0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 1538.1586537361145, "timesteps_since_restore": 0, "iterations_since_restore": 9, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.481069958847737, "ram_util_percent": 23.49053497942387}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.722308160412696, "cur_kl_coeff": 7.688671874999998, "cur_lr": 0.01, "total_loss": 1.0868023522558712, "policy_loss": 0.0019819875242769397, "vf_loss": 0.8305035619285478, "vf_explained_var": 0.2992703670455563, "kl": 0.0330768170329662, "entropy": 3.3041837012895976, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8835.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "sampler_results": {"episode_reward_max": 98.0, "episode_reward_min": -12.700000000000001, "episode_reward_mean": -4.872350230414748, "episode_len_mean": 18.410138248847925, "episode_media": {}, "episodes_this_iter": 217, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.2, -3.700000000000001, -3.9000000000000004, -3.600000000000001, -3.7000000000000006, -3.9000000000000012, -3.7000000000000006, -3.700000000000001, -3.6000000000000005, -3.500000000000001, -3.8000000000000007, -10.1, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -4.1000000000000005, -3.6000000000000005, -3.6000000000000005, -3.900000000000001, -10.1, -3.8000000000000007, -4.300000000000001, -3.8000000000000007, -3.8000000000000007, -11.5, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -11.3, -11.4, -3.900000000000001, -3.700000000000001, -11.3, -3.800000000000001, -4.000000000000001, -3.7000000000000006, -3.8000000000000007, -12.0, -3.800000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.6000000000000005, -4.000000000000001, -3.9000000000000012, -4.000000000000002, -3.6000000000000005, -10.4, -3.8000000000000007, -10.8, -4.000000000000001, -3.800000000000001, -3.900000000000001, -3.600000000000001, -10.6, -3.8000000000000007, -3.6000000000000005, -10.9, -3.900000000000001, -3.5000000000000004, -11.6, -3.600000000000001, -4.100000000000001, -4.200000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.800000000000001, -3.6000000000000005, -4.100000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.800000000000001, -3.8000000000000007, -3.4000000000000012, -4.200000000000001, -3.900000000000001, -3.500000000000001, -3.800000000000001, -3.900000000000001, -4.100000000000001, -4.200000000000001, -3.9000000000000012, -3.9000000000000012, -10.3, -3.600000000000001, -3.700000000000001, -3.8000000000000007, -11.9, -3.900000000000001, -3.7000000000000006, -4.100000000000001, -4.000000000000001, -10.0, -3.9000000000000004, -10.0, -11.0, -3.900000000000001, -3.400000000000001, -3.7000000000000006, -3.7000000000000006, -3.600000000000001, -4.000000000000001, -3.400000000000001, -11.9, -3.6000000000000005, -3.800000000000001, -3.9000000000000012, -3.8000000000000007, -4.100000000000001, -12.200000000000001, -11.3, -10.4, -3.9000000000000012, -3.600000000000001, -3.7000000000000006, -3.6000000000000005, -10.3, -3.600000000000001, -10.6, -3.900000000000001, -11.8, -3.9000000000000012, -3.8000000000000007, -4.000000000000001, -3.600000000000001, -3.9000000000000012, -3.600000000000001, -3.600000000000001, -10.8, -3.7000000000000006, -3.8000000000000007, -3.6000000000000005, -4.000000000000001, -3.900000000000001, -12.700000000000001, -4.1000000000000005, -3.800000000000001, -3.7000000000000006, -3.600000000000001, -3.8000000000000007, -3.5000000000000004, -3.9000000000000012, -3.8000000000000007, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -3.700000000000001, -12.4, -10.6, -3.900000000000001, -4.000000000000002, -10.6, -12.4, -3.6000000000000005, -3.500000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -10.6, -3.5000000000000004, -4.300000000000001, -3.8000000000000007, -3.8000000000000007, -3.600000000000001, -10.4, -3.9000000000000012, -3.900000000000001, -3.500000000000001, -4.000000000000001, -10.5, -3.900000000000001, -3.8000000000000007, -10.9, -10.5, -3.7000000000000006, -12.0, -3.7000000000000006, -3.6, -3.900000000000001, -10.1, -4.000000000000001, -10.3, -4.000000000000002, -3.7, -10.1, -4.100000000000001, -11.1, -11.7, -11.3, -4.000000000000001, 98.0, -3.6000000000000005, -3.900000000000001, -3.9000000000000012, -3.8000000000000007, -10.2, -3.800000000000001, -3.700000000000001, -3.400000000000001, -10.9, -3.9000000000000012, -3.8000000000000007, -4.100000000000001, -3.800000000000001, -12.600000000000001, -3.900000000000001, -3.8000000000000007, -4.1000000000000005, -3.700000000000001, -3.700000000000001, -3.6000000000000005], "episode_lengths": [3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 12, 21, 21, 21, 11, 11, 21, 21, 13, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 8, 21, 21, 21, 21, 6, 21, 21, 9, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 16, 21, 21, 21, 21, 1, 21, 1, 8, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 17, 11, 5, 21, 21, 21, 21, 4, 21, 6, 21, 14, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 6, 21, 21, 6, 18, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 5, 21, 21, 8, 6, 21, 17, 21, 21, 21, 2, 21, 3, 21, 21, 2, 21, 10, 14, 11, 21, 16, 21, 21, 21, 21, 3, 21, 21, 21, 8, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.80199015259423, "mean_inference_ms": 18.687314452808394, "mean_action_processing_ms": 1.0184599859808472, "mean_env_wait_ms": 1.9929881196136057, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08474022562053346, "StateBufferConnector_ms": 0.011038230860837593, "ViewRequirementAgentConnector_ms": 0.1530337443549512}}, "episode_reward_max": 98.0, "episode_reward_min": -12.700000000000001, "episode_reward_mean": -4.872350230414748, "episode_len_mean": 18.410138248847925, "episodes_this_iter": 217, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10.2, -3.700000000000001, -3.9000000000000004, -3.600000000000001, -3.7000000000000006, -3.9000000000000012, -3.7000000000000006, -3.700000000000001, -3.6000000000000005, -3.500000000000001, -3.8000000000000007, -10.1, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -4.1000000000000005, -3.6000000000000005, -3.6000000000000005, -3.900000000000001, -10.1, -3.8000000000000007, -4.300000000000001, -3.8000000000000007, -3.8000000000000007, -11.5, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -11.3, -11.4, -3.900000000000001, -3.700000000000001, -11.3, -3.800000000000001, -4.000000000000001, -3.7000000000000006, -3.8000000000000007, -12.0, -3.800000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.6000000000000005, -4.000000000000001, -3.9000000000000012, -4.000000000000002, -3.6000000000000005, -10.4, -3.8000000000000007, -10.8, -4.000000000000001, -3.800000000000001, -3.900000000000001, -3.600000000000001, -10.6, -3.8000000000000007, -3.6000000000000005, -10.9, -3.900000000000001, -3.5000000000000004, -11.6, -3.600000000000001, -4.100000000000001, -4.200000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.800000000000001, -3.6000000000000005, -4.100000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.800000000000001, -3.8000000000000007, -3.4000000000000012, -4.200000000000001, -3.900000000000001, -3.500000000000001, -3.800000000000001, -3.900000000000001, -4.100000000000001, -4.200000000000001, -3.9000000000000012, -3.9000000000000012, -10.3, -3.600000000000001, -3.700000000000001, -3.8000000000000007, -11.9, -3.900000000000001, -3.7000000000000006, -4.100000000000001, -4.000000000000001, -10.0, -3.9000000000000004, -10.0, -11.0, -3.900000000000001, -3.400000000000001, -3.7000000000000006, -3.7000000000000006, -3.600000000000001, -4.000000000000001, -3.400000000000001, -11.9, -3.6000000000000005, -3.800000000000001, -3.9000000000000012, -3.8000000000000007, -4.100000000000001, -12.200000000000001, -11.3, -10.4, -3.9000000000000012, -3.600000000000001, -3.7000000000000006, -3.6000000000000005, -10.3, -3.600000000000001, -10.6, -3.900000000000001, -11.8, -3.9000000000000012, -3.8000000000000007, -4.000000000000001, -3.600000000000001, -3.9000000000000012, -3.600000000000001, -3.600000000000001, -10.8, -3.7000000000000006, -3.8000000000000007, -3.6000000000000005, -4.000000000000001, -3.900000000000001, -12.700000000000001, -4.1000000000000005, -3.800000000000001, -3.7000000000000006, -3.600000000000001, -3.8000000000000007, -3.5000000000000004, -3.9000000000000012, -3.8000000000000007, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -3.700000000000001, -12.4, -10.6, -3.900000000000001, -4.000000000000002, -10.6, -12.4, -3.6000000000000005, -3.500000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -10.6, -3.5000000000000004, -4.300000000000001, -3.8000000000000007, -3.8000000000000007, -3.600000000000001, -10.4, -3.9000000000000012, -3.900000000000001, -3.500000000000001, -4.000000000000001, -10.5, -3.900000000000001, -3.8000000000000007, -10.9, -10.5, -3.7000000000000006, -12.0, -3.7000000000000006, -3.6, -3.900000000000001, -10.1, -4.000000000000001, -10.3, -4.000000000000002, -3.7, -10.1, -4.100000000000001, -11.1, -11.7, -11.3, -4.000000000000001, 98.0, -3.6000000000000005, -3.900000000000001, -3.9000000000000012, -3.8000000000000007, -10.2, -3.800000000000001, -3.700000000000001, -3.400000000000001, -10.9, -3.9000000000000012, -3.8000000000000007, -4.100000000000001, -3.800000000000001, -12.600000000000001, -3.900000000000001, -3.8000000000000007, -4.1000000000000005, -3.700000000000001, -3.700000000000001, -3.6000000000000005], "episode_lengths": [3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 12, 21, 21, 21, 11, 11, 21, 21, 13, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 8, 21, 21, 21, 21, 6, 21, 21, 9, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 16, 21, 21, 21, 21, 1, 21, 1, 8, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 17, 11, 5, 21, 21, 21, 21, 4, 21, 6, 21, 14, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 6, 21, 21, 6, 18, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 5, 21, 21, 8, 6, 21, 17, 21, 21, 21, 2, 21, 3, 21, 21, 2, 21, 10, 14, 11, 21, 16, 21, 21, 21, 21, 3, 21, 21, 21, 8, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.80199015259423, "mean_inference_ms": 18.687314452808394, "mean_action_processing_ms": 1.0184599859808472, "mean_env_wait_ms": 1.9929881196136057, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08474022562053346, "StateBufferConnector_ms": 0.011038230860837593, "ViewRequirementAgentConnector_ms": 0.1530337443549512}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 170909.567, "load_time_ms": 0.991, "load_throughput": 4036380.609, "learn_time_ms": 169889.804, "learn_throughput": 23.545, "synch_weights_time_ms": 182.284}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "episodes_total": 2047, "training_iteration": 10, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-06_21-24-02", "timestamp": 1680809042, "time_this_iter_s": 171.05289602279663, "time_total_s": 1709.2115497589111, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476f2d60>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01475fc820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 1709.2115497589111, "timesteps_since_restore": 0, "iterations_since_restore": 10, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.513991769547325, "ram_util_percent": 23.511934156378604}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.115326095140109, "cur_kl_coeff": 11.533007812499998, "cur_lr": 0.01, "total_loss": 1.8459834738804768, "policy_loss": 0.008961914278446666, "vf_loss": 0.7234194259009054, "vf_explained_var": 0.4256964013140689, "kl": 0.09655782515270715, "entropy": 3.297641183740349, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 9765.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "sampler_results": {"episode_reward_max": -3.4000000000000004, "episode_reward_min": -12.8, "episode_reward_mean": -5.05601851851852, "episode_len_mean": 18.90277777777778, "episode_media": {}, "episodes_this_iter": 216, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.800000000000001, -3.700000000000001, -3.7000000000000006, -3.8000000000000007, -3.700000000000001, -3.7, -4.0, -3.900000000000001, -3.600000000000001, -4.000000000000001, -3.400000000000001, -3.800000000000001, -3.900000000000001, -3.700000000000001, -3.900000000000001, -3.600000000000001, -3.900000000000001, -3.9000000000000012, -4.000000000000002, -3.700000000000001, -3.6000000000000005, -12.4, -10.0, -4.000000000000001, -3.7000000000000006, -3.9000000000000012, -3.8000000000000003, -10.0, -11.3, -3.7000000000000006, -3.400000000000001, -3.5000000000000004, -12.8, -3.8000000000000007, -3.800000000000001, -3.400000000000001, -3.7000000000000006, -3.8000000000000007, -3.500000000000001, -10.2, -10.3, -3.7000000000000006, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -3.7000000000000006, -3.600000000000001, -3.600000000000001, -3.5000000000000004, -3.700000000000001, -4.200000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.7000000000000006, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -3.4000000000000004, -3.9000000000000012, -3.600000000000001, -3.8000000000000007, -3.900000000000001, -3.600000000000001, -3.900000000000001, -4.000000000000001, -3.600000000000001, -3.700000000000001, -4.100000000000001, -3.7000000000000006, -3.800000000000001, -10.3, -3.9000000000000004, -3.8000000000000007, -3.5000000000000004, -3.900000000000001, -3.600000000000001, -4.100000000000001, -3.600000000000001, -3.500000000000001, -4.100000000000001, -3.9000000000000004, -3.9000000000000012, -3.6000000000000005, -3.8000000000000007, -3.700000000000001, -3.8000000000000007, -3.900000000000001, -3.6000000000000005, -3.4000000000000012, -10.7, -10.2, -3.7000000000000006, -12.600000000000001, -10.1, -10.3, -4.000000000000001, -3.7000000000000006, -3.900000000000001, -3.8000000000000007, -10.5, -10.0, -10.1, -3.800000000000001, -3.8000000000000003, -10.9, -10.7, -10.3, -3.7000000000000006, -3.5000000000000013, -3.8000000000000003, -3.800000000000001, -3.600000000000001, -3.400000000000001, -3.600000000000001, -3.6000000000000005, -3.7000000000000006, -3.9000000000000012, -3.700000000000001, -3.7000000000000006, -4.000000000000002, -3.500000000000001, -3.8000000000000007, -3.5000000000000004, -3.7000000000000006, -3.5000000000000004, -12.7, -11.1, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -3.9000000000000004, -3.6000000000000005, -3.9000000000000012, -3.900000000000001, -3.8000000000000007, -11.2, -3.900000000000001, -3.600000000000001, -3.900000000000001, -3.600000000000001, -3.600000000000001, -3.600000000000001, -11.3, -11.8, -3.8000000000000007, -3.7000000000000006, -3.900000000000001, -3.6000000000000005, -3.6000000000000005, -11.8, -12.3, -4.100000000000001, -3.9000000000000004, -3.700000000000001, -10.4, -4.1000000000000005, -3.9000000000000012, -3.800000000000001, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -3.5000000000000004, -3.700000000000001, -12.3, -3.6000000000000005, -3.9000000000000012, -3.8000000000000007, -4.000000000000001, -10.9, -3.8000000000000007, -3.700000000000001, -4.000000000000001, -12.700000000000001, -3.8000000000000007, -3.8000000000000007, -4.100000000000001, -3.6000000000000005, -4.000000000000001, -3.7000000000000006, -3.600000000000001, -3.7000000000000006, -4.100000000000001, -11.3, -4.000000000000002, -3.8000000000000007, -3.800000000000001, -4.000000000000001, -10.9, -3.7000000000000006, -3.6000000000000005, -4.000000000000001, -3.800000000000001, -3.8000000000000007, -10.9, -3.6000000000000005, -3.9000000000000012, -3.7000000000000006, -10.7, -3.800000000000001, -3.8000000000000007, -11.0, -3.8000000000000007, -3.4000000000000004, -3.900000000000001, -3.9000000000000012, -10.2, -4.000000000000001, -11.9, -3.7000000000000006, -3.8000000000000007, -3.800000000000001, -12.1, -3.800000000000001, -3.600000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 1, 21, 21, 21, 21, 1, 10, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 3, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 3, 21, 18, 2, 3, 21, 21, 21, 21, 5, 1, 2, 21, 21, 8, 7, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 10, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 11, 14, 21, 21, 21, 21, 21, 14, 17, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 9, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 8, 21, 21, 21, 7, 21, 21, 9, 21, 21, 21, 21, 3, 21, 16, 21, 21, 21, 16, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.819057291349573, "mean_inference_ms": 18.712117336534348, "mean_action_processing_ms": 1.0120891008381872, "mean_env_wait_ms": 1.9812341988616116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07940839838098597, "StateBufferConnector_ms": 0.01031568756809941, "ViewRequirementAgentConnector_ms": 0.1452203150148745}}, "episode_reward_max": -3.4000000000000004, "episode_reward_min": -12.8, "episode_reward_mean": -5.05601851851852, "episode_len_mean": 18.90277777777778, "episodes_this_iter": 216, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.800000000000001, -3.700000000000001, -3.7000000000000006, -3.8000000000000007, -3.700000000000001, -3.7, -4.0, -3.900000000000001, -3.600000000000001, -4.000000000000001, -3.400000000000001, -3.800000000000001, -3.900000000000001, -3.700000000000001, -3.900000000000001, -3.600000000000001, -3.900000000000001, -3.9000000000000012, -4.000000000000002, -3.700000000000001, -3.6000000000000005, -12.4, -10.0, -4.000000000000001, -3.7000000000000006, -3.9000000000000012, -3.8000000000000003, -10.0, -11.3, -3.7000000000000006, -3.400000000000001, -3.5000000000000004, -12.8, -3.8000000000000007, -3.800000000000001, -3.400000000000001, -3.7000000000000006, -3.8000000000000007, -3.500000000000001, -10.2, -10.3, -3.7000000000000006, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -3.7000000000000006, -3.600000000000001, -3.600000000000001, -3.5000000000000004, -3.700000000000001, -4.200000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.7000000000000006, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -3.4000000000000004, -3.9000000000000012, -3.600000000000001, -3.8000000000000007, -3.900000000000001, -3.600000000000001, -3.900000000000001, -4.000000000000001, -3.600000000000001, -3.700000000000001, -4.100000000000001, -3.7000000000000006, -3.800000000000001, -10.3, -3.9000000000000004, -3.8000000000000007, -3.5000000000000004, -3.900000000000001, -3.600000000000001, -4.100000000000001, -3.600000000000001, -3.500000000000001, -4.100000000000001, -3.9000000000000004, -3.9000000000000012, -3.6000000000000005, -3.8000000000000007, -3.700000000000001, -3.8000000000000007, -3.900000000000001, -3.6000000000000005, -3.4000000000000012, -10.7, -10.2, -3.7000000000000006, -12.600000000000001, -10.1, -10.3, -4.000000000000001, -3.7000000000000006, -3.900000000000001, -3.8000000000000007, -10.5, -10.0, -10.1, -3.800000000000001, -3.8000000000000003, -10.9, -10.7, -10.3, -3.7000000000000006, -3.5000000000000013, -3.8000000000000003, -3.800000000000001, -3.600000000000001, -3.400000000000001, -3.600000000000001, -3.6000000000000005, -3.7000000000000006, -3.9000000000000012, -3.700000000000001, -3.7000000000000006, -4.000000000000002, -3.500000000000001, -3.8000000000000007, -3.5000000000000004, -3.7000000000000006, -3.5000000000000004, -12.7, -11.1, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -3.9000000000000004, -3.6000000000000005, -3.9000000000000012, -3.900000000000001, -3.8000000000000007, -11.2, -3.900000000000001, -3.600000000000001, -3.900000000000001, -3.600000000000001, -3.600000000000001, -3.600000000000001, -11.3, -11.8, -3.8000000000000007, -3.7000000000000006, -3.900000000000001, -3.6000000000000005, -3.6000000000000005, -11.8, -12.3, -4.100000000000001, -3.9000000000000004, -3.700000000000001, -10.4, -4.1000000000000005, -3.9000000000000012, -3.800000000000001, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -3.5000000000000004, -3.700000000000001, -12.3, -3.6000000000000005, -3.9000000000000012, -3.8000000000000007, -4.000000000000001, -10.9, -3.8000000000000007, -3.700000000000001, -4.000000000000001, -12.700000000000001, -3.8000000000000007, -3.8000000000000007, -4.100000000000001, -3.6000000000000005, -4.000000000000001, -3.7000000000000006, -3.600000000000001, -3.7000000000000006, -4.100000000000001, -11.3, -4.000000000000002, -3.8000000000000007, -3.800000000000001, -4.000000000000001, -10.9, -3.7000000000000006, -3.6000000000000005, -4.000000000000001, -3.800000000000001, -3.8000000000000007, -10.9, -3.6000000000000005, -3.9000000000000012, -3.7000000000000006, -10.7, -3.800000000000001, -3.8000000000000007, -11.0, -3.8000000000000007, -3.4000000000000004, -3.900000000000001, -3.9000000000000012, -10.2, -4.000000000000001, -11.9, -3.7000000000000006, -3.8000000000000007, -3.800000000000001, -12.1, -3.800000000000001, -3.600000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 1, 21, 21, 21, 21, 1, 10, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 3, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 3, 21, 18, 2, 3, 21, 21, 21, 21, 5, 1, 2, 21, 21, 8, 7, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 10, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 11, 14, 21, 21, 21, 21, 21, 14, 17, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 9, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 8, 21, 21, 21, 7, 21, 21, 9, 21, 21, 21, 21, 3, 21, 16, 21, 21, 21, 16, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.819057291349573, "mean_inference_ms": 18.712117336534348, "mean_action_processing_ms": 1.0120891008381872, "mean_env_wait_ms": 1.9812341988616116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07940839838098597, "StateBufferConnector_ms": 0.01031568756809941, "ViewRequirementAgentConnector_ms": 0.1452203150148745}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 170843.761, "load_time_ms": 1.07, "load_throughput": 3738738.691, "learn_time_ms": 169847.961, "learn_throughput": 23.55, "synch_weights_time_ms": 182.474}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "episodes_total": 2263, "training_iteration": 11, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-06_21-26-54", "timestamp": 1680809214, "time_this_iter_s": 171.52890038490295, "time_total_s": 1880.740450143814, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476d7b80>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01476f4040>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 1880.740450143814, "timesteps_since_restore": 0, "iterations_since_restore": 11, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.661885245901639, "ram_util_percent": 23.537295081967216}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.238534332090808, "cur_kl_coeff": 17.299511718750004, "cur_lr": 0.01, "total_loss": 1.4309034205532523, "policy_loss": 0.0016952260963178129, "vf_loss": 0.7755038451243151, "vf_explained_var": 0.3027645600098436, "kl": 0.03778744677347081, "entropy": 3.283296901436262, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 10695.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": -3.3000000000000007, "episode_reward_min": -12.8, "episode_reward_mean": -5.205687203791471, "episode_len_mean": 18.94312796208531, "episode_media": {}, "episodes_this_iter": 211, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.000000000000001, -3.600000000000001, -3.500000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000002, -3.800000000000001, -3.9000000000000012, -3.7000000000000006, -3.500000000000001, -3.7000000000000006, -3.800000000000001, -3.400000000000001, -4.1000000000000005, -3.800000000000001, -3.800000000000001, -4.200000000000001, -3.7000000000000006, -3.800000000000001, -3.8000000000000007, -10.2, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.600000000000001, -11.4, -3.3000000000000007, -3.7000000000000006, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -10.8, -3.600000000000001, -11.8, -3.600000000000001, -3.8000000000000007, -11.8, -3.8000000000000007, -3.8000000000000003, -10.4, -4.000000000000001, -10.6, -3.400000000000001, -3.6000000000000005, -3.600000000000001, -3.8000000000000007, -10.1, -3.6000000000000005, -3.8000000000000007, -3.7000000000000006, -10.6, -3.7000000000000006, -3.8000000000000007, -3.5000000000000004, -4.000000000000001, -3.8000000000000007, -12.0, -11.2, -3.700000000000001, -10.5, -3.6000000000000005, -11.4, -4.000000000000001, -3.800000000000001, -3.600000000000001, -4.000000000000001, -3.900000000000001, -3.5000000000000004, -11.6, -3.900000000000001, -3.700000000000001, -4.300000000000001, -3.800000000000001, -3.8000000000000007, -3.7000000000000006, -3.8000000000000007, -11.2, -3.900000000000001, -3.500000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -11.5, -3.800000000000001, -3.6000000000000005, -3.600000000000001, -3.900000000000001, -11.7, -3.7000000000000006, -3.8000000000000007, -4.0, -3.8000000000000007, -3.8000000000000007, -3.7000000000000006, -12.1, -11.6, -3.900000000000001, -3.6000000000000005, -3.500000000000001, -3.600000000000001, -3.8000000000000003, -3.8000000000000007, -3.500000000000001, -3.7000000000000006, -3.900000000000001, -3.600000000000001, -3.8000000000000007, -3.9000000000000012, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -3.700000000000001, -4.000000000000002, -10.7, -4.100000000000001, -3.600000000000001, -3.900000000000001, -4.100000000000001, -3.7000000000000006, -3.7000000000000006, -4.1000000000000005, -11.3, -3.900000000000001, -10.9, -11.8, -3.7000000000000006, -10.1, -3.500000000000001, -3.800000000000001, -3.900000000000001, -3.900000000000001, -10.6, -3.900000000000001, -3.700000000000001, -3.9000000000000012, -3.700000000000001, -3.500000000000001, -4.000000000000002, -3.8000000000000007, -3.9000000000000012, -12.8, -3.600000000000001, -3.700000000000001, -10.4, -3.8000000000000007, -3.700000000000001, -4.0, -4.100000000000001, -12.2, -3.900000000000001, -3.6000000000000005, -3.7000000000000006, -3.600000000000001, -3.8000000000000007, -3.900000000000001, -10.8, -4.000000000000001, -4.1000000000000005, -3.6000000000000005, -4.200000000000001, -3.900000000000001, -3.9000000000000012, -3.600000000000001, -3.900000000000001, -12.4, -10.6, -3.400000000000001, -4.200000000000001, -4.000000000000001, -3.7000000000000006, -10.0, -11.7, -4.100000000000001, -10.2, -3.7000000000000006, -3.900000000000001, -3.800000000000001, -3.8000000000000007, -4.0, -3.7000000000000006, -12.2, -3.600000000000001, -3.800000000000001, -3.7000000000000006, -3.8000000000000003, -10.6, -10.7, -3.800000000000001, -3.900000000000001, -3.900000000000001, -4.200000000000001, -12.4, -4.200000000000001, -3.8000000000000007, -3.600000000000001, -3.900000000000001, -3.7000000000000006, -3.6000000000000005, -3.9000000000000012, -10.7, -3.9000000000000012, -3.7000000000000006, -3.9000000000000004, -4.000000000000002, -3.7000000000000006, -4.000000000000001, -12.700000000000001, -3.7000000000000006, -3.9000000000000004, -3.700000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 7, 21, 15, 21, 21, 15, 21, 21, 4, 21, 6, 21, 21, 21, 21, 2, 21, 21, 21, 5, 21, 21, 21, 21, 21, 14, 10, 21, 6, 21, 13, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 17, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 11, 21, 8, 16, 21, 2, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 5, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 17, 6, 21, 21, 21, 21, 1, 14, 21, 3, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 7, 6, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.805355573998765, "mean_inference_ms": 18.757969530744028, "mean_action_processing_ms": 1.0122142567896861, "mean_env_wait_ms": 1.947573454025439, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07911587213452959, "StateBufferConnector_ms": 0.009739681442766959, "ViewRequirementAgentConnector_ms": 0.14304628869368566}}, "episode_reward_max": -3.3000000000000007, "episode_reward_min": -12.8, "episode_reward_mean": -5.205687203791471, "episode_len_mean": 18.94312796208531, "episodes_this_iter": 211, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.000000000000001, -3.600000000000001, -3.500000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000002, -3.800000000000001, -3.9000000000000012, -3.7000000000000006, -3.500000000000001, -3.7000000000000006, -3.800000000000001, -3.400000000000001, -4.1000000000000005, -3.800000000000001, -3.800000000000001, -4.200000000000001, -3.7000000000000006, -3.800000000000001, -3.8000000000000007, -10.2, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.600000000000001, -11.4, -3.3000000000000007, -3.7000000000000006, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -10.8, -3.600000000000001, -11.8, -3.600000000000001, -3.8000000000000007, -11.8, -3.8000000000000007, -3.8000000000000003, -10.4, -4.000000000000001, -10.6, -3.400000000000001, -3.6000000000000005, -3.600000000000001, -3.8000000000000007, -10.1, -3.6000000000000005, -3.8000000000000007, -3.7000000000000006, -10.6, -3.7000000000000006, -3.8000000000000007, -3.5000000000000004, -4.000000000000001, -3.8000000000000007, -12.0, -11.2, -3.700000000000001, -10.5, -3.6000000000000005, -11.4, -4.000000000000001, -3.800000000000001, -3.600000000000001, -4.000000000000001, -3.900000000000001, -3.5000000000000004, -11.6, -3.900000000000001, -3.700000000000001, -4.300000000000001, -3.800000000000001, -3.8000000000000007, -3.7000000000000006, -3.8000000000000007, -11.2, -3.900000000000001, -3.500000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -11.5, -3.800000000000001, -3.6000000000000005, -3.600000000000001, -3.900000000000001, -11.7, -3.7000000000000006, -3.8000000000000007, -4.0, -3.8000000000000007, -3.8000000000000007, -3.7000000000000006, -12.1, -11.6, -3.900000000000001, -3.6000000000000005, -3.500000000000001, -3.600000000000001, -3.8000000000000003, -3.8000000000000007, -3.500000000000001, -3.7000000000000006, -3.900000000000001, -3.600000000000001, -3.8000000000000007, -3.9000000000000012, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -3.700000000000001, -4.000000000000002, -10.7, -4.100000000000001, -3.600000000000001, -3.900000000000001, -4.100000000000001, -3.7000000000000006, -3.7000000000000006, -4.1000000000000005, -11.3, -3.900000000000001, -10.9, -11.8, -3.7000000000000006, -10.1, -3.500000000000001, -3.800000000000001, -3.900000000000001, -3.900000000000001, -10.6, -3.900000000000001, -3.700000000000001, -3.9000000000000012, -3.700000000000001, -3.500000000000001, -4.000000000000002, -3.8000000000000007, -3.9000000000000012, -12.8, -3.600000000000001, -3.700000000000001, -10.4, -3.8000000000000007, -3.700000000000001, -4.0, -4.100000000000001, -12.2, -3.900000000000001, -3.6000000000000005, -3.7000000000000006, -3.600000000000001, -3.8000000000000007, -3.900000000000001, -10.8, -4.000000000000001, -4.1000000000000005, -3.6000000000000005, -4.200000000000001, -3.900000000000001, -3.9000000000000012, -3.600000000000001, -3.900000000000001, -12.4, -10.6, -3.400000000000001, -4.200000000000001, -4.000000000000001, -3.7000000000000006, -10.0, -11.7, -4.100000000000001, -10.2, -3.7000000000000006, -3.900000000000001, -3.800000000000001, -3.8000000000000007, -4.0, -3.7000000000000006, -12.2, -3.600000000000001, -3.800000000000001, -3.7000000000000006, -3.8000000000000003, -10.6, -10.7, -3.800000000000001, -3.900000000000001, -3.900000000000001, -4.200000000000001, -12.4, -4.200000000000001, -3.8000000000000007, -3.600000000000001, -3.900000000000001, -3.7000000000000006, -3.6000000000000005, -3.9000000000000012, -10.7, -3.9000000000000012, -3.7000000000000006, -3.9000000000000004, -4.000000000000002, -3.7000000000000006, -4.000000000000001, -12.700000000000001, -3.7000000000000006, -3.9000000000000004, -3.700000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 7, 21, 15, 21, 21, 15, 21, 21, 4, 21, 6, 21, 21, 21, 21, 2, 21, 21, 21, 5, 21, 21, 21, 21, 21, 14, 10, 21, 6, 21, 13, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 17, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 11, 21, 8, 16, 21, 2, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 5, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 17, 6, 21, 21, 21, 21, 1, 14, 21, 3, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 7, 6, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.805355573998765, "mean_inference_ms": 18.757969530744028, "mean_action_processing_ms": 1.0122142567896861, "mean_env_wait_ms": 1.947573454025439, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07911587213452959, "StateBufferConnector_ms": 0.009739681442766959, "ViewRequirementAgentConnector_ms": 0.14304628869368566}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 170886.217, "load_time_ms": 1.09, "load_throughput": 3669717.835, "learn_time_ms": 169885.233, "learn_throughput": 23.545, "synch_weights_time_ms": 182.802}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 2474, "training_iteration": 12, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-06_21-29-45", "timestamp": 1680809385, "time_this_iter_s": 170.84973216056824, "time_total_s": 2051.5901823043823, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7effc272fe80>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014772e820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 2051.5901823043823, "timesteps_since_restore": 0, "iterations_since_restore": 12, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.462139917695472, "ram_util_percent": 23.51440329218107}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.36176090573752, "cur_kl_coeff": 25.949267578124992, "cur_lr": 0.01, "total_loss": 5.997377655919521, "policy_loss": 0.019890845039238533, "vf_loss": 1.2039627911382786, "vf_explained_var": 0.31781501302155113, "kl": 0.18395601524821212, "entropy": 3.2531972322412717, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 11625.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "sampler_results": {"episode_reward_max": -3.400000000000001, "episode_reward_min": -13.100000000000001, "episode_reward_mean": -5.7629629629629635, "episode_len_mean": 18.21759259259259, "episode_media": {}, "episodes_this_iter": 216, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.900000000000001, -12.3, -3.900000000000001, -3.500000000000001, -3.7000000000000006, -3.900000000000001, -3.800000000000001, -4.1000000000000005, -3.900000000000001, -3.7000000000000006, -3.6000000000000005, -4.000000000000001, -3.800000000000001, -11.5, -3.800000000000001, -4.000000000000001, -3.7000000000000006, -3.800000000000001, -3.600000000000001, -3.8000000000000003, -3.8000000000000007, -3.800000000000001, -10.1, -3.9000000000000012, -11.0, -11.0, -3.8000000000000007, -3.8000000000000007, -11.5, -4.000000000000001, -3.8000000000000007, -3.7000000000000006, -12.200000000000001, -3.800000000000001, -4.0, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -4.0, -4.000000000000001, -4.0, -10.3, -10.3, -3.7000000000000006, -3.600000000000001, -3.7000000000000006, -3.8000000000000007, -10.8, -3.800000000000001, -3.7000000000000006, -4.100000000000001, -12.4, -11.2, -3.900000000000001, -10.3, -12.0, -4.000000000000001, -4.1000000000000005, -3.600000000000001, -3.8000000000000007, -3.700000000000001, -4.100000000000001, -3.700000000000001, -3.9000000000000012, -3.8000000000000007, -10.6, -3.500000000000001, -10.3, -10.2, -3.700000000000001, -3.800000000000001, -3.900000000000001, -3.8000000000000007, -10.5, -3.8000000000000007, -3.5000000000000013, -3.900000000000001, -3.500000000000001, -4.100000000000001, -4.0, -3.700000000000001, -3.7000000000000006, -11.1, -3.8000000000000007, -3.9000000000000012, -3.8000000000000007, -3.600000000000001, -10.2, -11.7, -10.9, -3.600000000000001, -3.7000000000000006, -10.4, -12.2, -3.800000000000001, -3.7000000000000006, -3.7000000000000006, -11.1, -3.6000000000000005, -10.6, -3.6000000000000005, -11.3, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.800000000000001, -3.900000000000001, -3.9000000000000012, -3.700000000000001, -3.900000000000001, -3.700000000000001, -4.100000000000001, -3.600000000000001, -11.6, -3.7000000000000006, -3.800000000000001, -3.7000000000000006, -4.100000000000001, -3.900000000000001, -3.9000000000000012, -3.9000000000000004, -3.8000000000000007, -3.6000000000000005, -3.8000000000000007, -3.600000000000001, -3.9000000000000012, -3.900000000000001, -3.700000000000001, -3.7000000000000006, -3.900000000000001, -3.8000000000000007, -12.0, -4.0, -3.7000000000000006, -4.200000000000001, -3.7000000000000006, -3.6000000000000005, -3.700000000000001, -3.7000000000000006, -3.5000000000000013, -3.8000000000000003, -3.5000000000000004, -3.8000000000000003, -3.8000000000000007, -3.500000000000001, -3.7000000000000006, -3.8000000000000007, -3.900000000000001, -10.9, -3.800000000000001, -12.0, -3.800000000000001, -3.600000000000001, -4.1000000000000005, -3.8000000000000007, -10.9, -11.8, -3.900000000000001, -3.9000000000000012, -4.000000000000001, -3.700000000000001, -11.9, -11.5, -11.4, -3.5000000000000004, -3.8000000000000003, -3.700000000000001, -12.4, -3.8000000000000007, -10.2, -3.900000000000001, -3.600000000000001, -13.100000000000001, -3.900000000000001, -11.1, -11.4, -3.7000000000000006, -4.000000000000001, -11.4, -3.6000000000000005, -10.5, -10.2, -4.200000000000001, -10.3, -11.4, -3.9000000000000012, -11.7, -11.3, -3.8000000000000016, -4.000000000000002, -12.2, -12.5, -10.5, -3.7000000000000006, -10.8, -3.900000000000001, -11.0, -4.100000000000001, -3.7000000000000006, -3.9000000000000012, -3.8000000000000007, -10.9, -3.900000000000001, -12.0, -4.100000000000001, -3.8000000000000007, -4.200000000000001, -3.400000000000001, -3.7000000000000006, -3.8000000000000007, -3.7000000000000006, -4.100000000000001, -3.800000000000001, -11.0, -11.3], "episode_lengths": [21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 10, 9, 21, 21, 13, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 4, 21, 21, 21, 21, 8, 21, 21, 21, 20, 11, 21, 4, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 3, 2, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 3, 12, 9, 21, 21, 4, 17, 21, 21, 21, 11, 21, 7, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 17, 21, 21, 21, 21, 8, 16, 21, 21, 21, 21, 14, 13, 11, 21, 21, 21, 19, 21, 3, 21, 21, 20, 21, 10, 11, 21, 21, 11, 21, 5, 2, 21, 4, 13, 21, 15, 12, 21, 21, 17, 19, 5, 21, 9, 21, 9, 21, 21, 21, 21, 9, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.838379418611426, "mean_inference_ms": 18.737100038322737, "mean_action_processing_ms": 1.0095791426282814, "mean_env_wait_ms": 1.9352921775440566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07666691585823342, "StateBufferConnector_ms": 0.009280663949471933, "ViewRequirementAgentConnector_ms": 0.13933722619657163}}, "episode_reward_max": -3.400000000000001, "episode_reward_min": -13.100000000000001, "episode_reward_mean": -5.7629629629629635, "episode_len_mean": 18.21759259259259, "episodes_this_iter": 216, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.900000000000001, -12.3, -3.900000000000001, -3.500000000000001, -3.7000000000000006, -3.900000000000001, -3.800000000000001, -4.1000000000000005, -3.900000000000001, -3.7000000000000006, -3.6000000000000005, -4.000000000000001, -3.800000000000001, -11.5, -3.800000000000001, -4.000000000000001, -3.7000000000000006, -3.800000000000001, -3.600000000000001, -3.8000000000000003, -3.8000000000000007, -3.800000000000001, -10.1, -3.9000000000000012, -11.0, -11.0, -3.8000000000000007, -3.8000000000000007, -11.5, -4.000000000000001, -3.8000000000000007, -3.7000000000000006, -12.200000000000001, -3.800000000000001, -4.0, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -4.0, -4.000000000000001, -4.0, -10.3, -10.3, -3.7000000000000006, -3.600000000000001, -3.7000000000000006, -3.8000000000000007, -10.8, -3.800000000000001, -3.7000000000000006, -4.100000000000001, -12.4, -11.2, -3.900000000000001, -10.3, -12.0, -4.000000000000001, -4.1000000000000005, -3.600000000000001, -3.8000000000000007, -3.700000000000001, -4.100000000000001, -3.700000000000001, -3.9000000000000012, -3.8000000000000007, -10.6, -3.500000000000001, -10.3, -10.2, -3.700000000000001, -3.800000000000001, -3.900000000000001, -3.8000000000000007, -10.5, -3.8000000000000007, -3.5000000000000013, -3.900000000000001, -3.500000000000001, -4.100000000000001, -4.0, -3.700000000000001, -3.7000000000000006, -11.1, -3.8000000000000007, -3.9000000000000012, -3.8000000000000007, -3.600000000000001, -10.2, -11.7, -10.9, -3.600000000000001, -3.7000000000000006, -10.4, -12.2, -3.800000000000001, -3.7000000000000006, -3.7000000000000006, -11.1, -3.6000000000000005, -10.6, -3.6000000000000005, -11.3, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.800000000000001, -3.900000000000001, -3.9000000000000012, -3.700000000000001, -3.900000000000001, -3.700000000000001, -4.100000000000001, -3.600000000000001, -11.6, -3.7000000000000006, -3.800000000000001, -3.7000000000000006, -4.100000000000001, -3.900000000000001, -3.9000000000000012, -3.9000000000000004, -3.8000000000000007, -3.6000000000000005, -3.8000000000000007, -3.600000000000001, -3.9000000000000012, -3.900000000000001, -3.700000000000001, -3.7000000000000006, -3.900000000000001, -3.8000000000000007, -12.0, -4.0, -3.7000000000000006, -4.200000000000001, -3.7000000000000006, -3.6000000000000005, -3.700000000000001, -3.7000000000000006, -3.5000000000000013, -3.8000000000000003, -3.5000000000000004, -3.8000000000000003, -3.8000000000000007, -3.500000000000001, -3.7000000000000006, -3.8000000000000007, -3.900000000000001, -10.9, -3.800000000000001, -12.0, -3.800000000000001, -3.600000000000001, -4.1000000000000005, -3.8000000000000007, -10.9, -11.8, -3.900000000000001, -3.9000000000000012, -4.000000000000001, -3.700000000000001, -11.9, -11.5, -11.4, -3.5000000000000004, -3.8000000000000003, -3.700000000000001, -12.4, -3.8000000000000007, -10.2, -3.900000000000001, -3.600000000000001, -13.100000000000001, -3.900000000000001, -11.1, -11.4, -3.7000000000000006, -4.000000000000001, -11.4, -3.6000000000000005, -10.5, -10.2, -4.200000000000001, -10.3, -11.4, -3.9000000000000012, -11.7, -11.3, -3.8000000000000016, -4.000000000000002, -12.2, -12.5, -10.5, -3.7000000000000006, -10.8, -3.900000000000001, -11.0, -4.100000000000001, -3.7000000000000006, -3.9000000000000012, -3.8000000000000007, -10.9, -3.900000000000001, -12.0, -4.100000000000001, -3.8000000000000007, -4.200000000000001, -3.400000000000001, -3.7000000000000006, -3.8000000000000007, -3.7000000000000006, -4.100000000000001, -3.800000000000001, -11.0, -11.3], "episode_lengths": [21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 10, 9, 21, 21, 13, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 4, 21, 21, 21, 21, 8, 21, 21, 21, 20, 11, 21, 4, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 3, 2, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 3, 12, 9, 21, 21, 4, 17, 21, 21, 21, 11, 21, 7, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 17, 21, 21, 21, 21, 8, 16, 21, 21, 21, 21, 14, 13, 11, 21, 21, 21, 19, 21, 3, 21, 21, 20, 21, 10, 11, 21, 21, 11, 21, 5, 2, 21, 4, 13, 21, 15, 12, 21, 21, 17, 19, 5, 21, 9, 21, 9, 21, 21, 21, 21, 9, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.838379418611426, "mean_inference_ms": 18.737100038322737, "mean_action_processing_ms": 1.0095791426282814, "mean_env_wait_ms": 1.9352921775440566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07666691585823342, "StateBufferConnector_ms": 0.009280663949471933, "ViewRequirementAgentConnector_ms": 0.13933722619657163}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 170918.168, "load_time_ms": 1.105, "load_throughput": 3620226.571, "learn_time_ms": 169926.261, "learn_throughput": 23.54, "synch_weights_time_ms": 183.573}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "episodes_total": 2690, "training_iteration": 13, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-06_21-32-35", "timestamp": 1680809555, "time_this_iter_s": 170.68091654777527, "time_total_s": 2222.2710988521576, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0147659c40>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0147604d30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 2222.2710988521576, "timesteps_since_restore": 0, "iterations_since_restore": 13, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.531275720164609, "ram_util_percent": 23.50493827160494}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.821243384063886, "cur_kl_coeff": 38.9239013671875, "cur_lr": 0.01, "total_loss": 1.2560210367364268, "policy_loss": 0.0025937923039960607, "vf_loss": 1.06717657020656, "vf_explained_var": 0.3279401770202062, "kl": 0.004784995030551668, "entropy": 3.331489497102717, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 12555.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "sampler_results": {"episode_reward_max": -3.3000000000000007, "episode_reward_min": -12.9, "episode_reward_mean": -5.430088495575221, "episode_len_mean": 18.331858407079647, "episode_media": {}, "episodes_this_iter": 226, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.800000000000001, -3.5000000000000004, -3.500000000000001, -11.4, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -11.8, -3.400000000000001, -11.1, -12.8, -3.6000000000000005, -3.7000000000000006, -3.3000000000000007, -3.8000000000000007, -3.7000000000000006, -4.200000000000001, -3.900000000000001, -3.9000000000000012, -3.500000000000001, -3.9000000000000004, -4.1000000000000005, -4.200000000000001, -4.000000000000001, -4.0, -10.0, -3.9000000000000012, -3.7000000000000006, -3.9000000000000012, -3.800000000000001, -3.5000000000000004, -10.0, -10.2, -3.900000000000001, -3.8000000000000007, -3.7000000000000006, -10.3, -10.0, -4.1000000000000005, -3.7000000000000006, -10.0, -10.1, -3.700000000000001, -3.8000000000000003, -3.5000000000000004, -10.4, -10.4, -3.5000000000000004, -3.8000000000000007, -3.900000000000001, -3.5000000000000004, -3.900000000000001, -10.0, -3.9000000000000012, -4.000000000000001, -4.000000000000001, -3.800000000000001, -11.8, -3.8000000000000007, -12.5, -12.0, -3.800000000000001, -3.700000000000001, -3.8000000000000007, -10.9, -3.7, -3.900000000000001, -4.1000000000000005, -3.8000000000000007, -3.9000000000000012, -3.7000000000000006, -3.9000000000000004, -4.100000000000001, -3.8000000000000007, -11.0, -3.900000000000001, -3.700000000000001, -3.700000000000001, -4.100000000000001, -4.000000000000001, -3.800000000000001, -11.0, -3.700000000000001, -4.000000000000001, -4.000000000000002, -4.200000000000001, -10.8, -4.000000000000001, -3.6000000000000005, -11.1, -11.1, -3.700000000000001, -3.400000000000001, -3.900000000000001, -3.500000000000001, -10.1, -10.5, -10.2, -3.8000000000000007, -3.700000000000001, -12.4, -3.800000000000001, -3.5000000000000013, -3.7000000000000006, -3.900000000000001, -3.6000000000000005, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -3.400000000000001, -3.700000000000001, -3.7000000000000006, -3.900000000000001, -4.000000000000001, -3.500000000000001, -3.6000000000000005, -3.7000000000000006, -3.8000000000000007, -3.500000000000001, -3.800000000000001, -3.600000000000001, -3.8000000000000007, -3.900000000000001, -3.600000000000001, -3.800000000000001, -3.700000000000001, -3.6000000000000005, -3.700000000000001, -3.5000000000000004, -11.5, -11.5, -3.800000000000001, -11.2, -3.8000000000000007, -3.700000000000001, -3.4000000000000004, -11.0, -3.5000000000000004, -4.0, -3.6000000000000005, -11.5, -3.9000000000000012, -10.0, -12.9, -3.6000000000000005, -4.000000000000001, -3.800000000000001, -3.7000000000000006, -4.000000000000001, -10.8, -3.7000000000000006, -3.6000000000000005, -3.600000000000001, -3.6000000000000005, -3.600000000000001, -10.9, -3.900000000000001, -3.6000000000000005, -3.7000000000000006, -3.7000000000000006, -3.600000000000001, -4.0, -3.900000000000001, -3.7000000000000006, -3.800000000000001, -3.9000000000000012, -12.8, -4.000000000000001, -12.200000000000001, -4.000000000000001, -3.9000000000000012, -3.800000000000001, -3.7000000000000006, -3.8000000000000007, -3.5000000000000004, -3.900000000000001, -3.6000000000000005, -4.0, -10.1, -4.100000000000001, -3.7000000000000006, -3.8000000000000007, -4.100000000000001, -10.1, -3.7000000000000006, -3.900000000000001, -3.900000000000001, -10.8, -10.8, -11.6, -3.8000000000000007, -3.9000000000000012, -3.700000000000001, -3.900000000000001, -3.800000000000001, -3.900000000000001, -11.1, -3.5000000000000004, -12.8, -3.8000000000000007, -3.900000000000001, -11.0, -10.6, -3.600000000000001, -11.5, -3.8000000000000007, -11.8, -3.8000000000000007, -12.4, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -3.700000000000001, -10.5, -3.8000000000000007, -3.8000000000000007, -3.9000000000000012, -3.600000000000001, -3.700000000000001, -3.9000000000000012, -3.600000000000001, -3.8000000000000007, -3.9000000000000012, -3.8000000000000007], "episode_lengths": [21, 21, 21, 12, 21, 21, 21, 16, 21, 10, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 1, 3, 21, 21, 21, 4, 1, 21, 21, 1, 2, 21, 21, 21, 5, 5, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 15, 21, 18, 16, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 8, 21, 21, 10, 9, 21, 21, 21, 21, 2, 6, 3, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 12, 21, 10, 21, 21, 21, 8, 21, 21, 21, 10, 21, 1, 19, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 2, 21, 21, 21, 8, 7, 12, 21, 21, 21, 21, 21, 21, 10, 21, 17, 21, 21, 9, 7, 21, 13, 21, 14, 21, 20, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.832961916867209, "mean_inference_ms": 18.71253363793994, "mean_action_processing_ms": 1.0060739716939002, "mean_env_wait_ms": 1.9194655195692785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0792302916535234, "StateBufferConnector_ms": 0.010112956561873445, "ViewRequirementAgentConnector_ms": 0.14516157386577236}}, "episode_reward_max": -3.3000000000000007, "episode_reward_min": -12.9, "episode_reward_mean": -5.430088495575221, "episode_len_mean": 18.331858407079647, "episodes_this_iter": 226, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.800000000000001, -3.5000000000000004, -3.500000000000001, -11.4, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -11.8, -3.400000000000001, -11.1, -12.8, -3.6000000000000005, -3.7000000000000006, -3.3000000000000007, -3.8000000000000007, -3.7000000000000006, -4.200000000000001, -3.900000000000001, -3.9000000000000012, -3.500000000000001, -3.9000000000000004, -4.1000000000000005, -4.200000000000001, -4.000000000000001, -4.0, -10.0, -3.9000000000000012, -3.7000000000000006, -3.9000000000000012, -3.800000000000001, -3.5000000000000004, -10.0, -10.2, -3.900000000000001, -3.8000000000000007, -3.7000000000000006, -10.3, -10.0, -4.1000000000000005, -3.7000000000000006, -10.0, -10.1, -3.700000000000001, -3.8000000000000003, -3.5000000000000004, -10.4, -10.4, -3.5000000000000004, -3.8000000000000007, -3.900000000000001, -3.5000000000000004, -3.900000000000001, -10.0, -3.9000000000000012, -4.000000000000001, -4.000000000000001, -3.800000000000001, -11.8, -3.8000000000000007, -12.5, -12.0, -3.800000000000001, -3.700000000000001, -3.8000000000000007, -10.9, -3.7, -3.900000000000001, -4.1000000000000005, -3.8000000000000007, -3.9000000000000012, -3.7000000000000006, -3.9000000000000004, -4.100000000000001, -3.8000000000000007, -11.0, -3.900000000000001, -3.700000000000001, -3.700000000000001, -4.100000000000001, -4.000000000000001, -3.800000000000001, -11.0, -3.700000000000001, -4.000000000000001, -4.000000000000002, -4.200000000000001, -10.8, -4.000000000000001, -3.6000000000000005, -11.1, -11.1, -3.700000000000001, -3.400000000000001, -3.900000000000001, -3.500000000000001, -10.1, -10.5, -10.2, -3.8000000000000007, -3.700000000000001, -12.4, -3.800000000000001, -3.5000000000000013, -3.7000000000000006, -3.900000000000001, -3.6000000000000005, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -3.400000000000001, -3.700000000000001, -3.7000000000000006, -3.900000000000001, -4.000000000000001, -3.500000000000001, -3.6000000000000005, -3.7000000000000006, -3.8000000000000007, -3.500000000000001, -3.800000000000001, -3.600000000000001, -3.8000000000000007, -3.900000000000001, -3.600000000000001, -3.800000000000001, -3.700000000000001, -3.6000000000000005, -3.700000000000001, -3.5000000000000004, -11.5, -11.5, -3.800000000000001, -11.2, -3.8000000000000007, -3.700000000000001, -3.4000000000000004, -11.0, -3.5000000000000004, -4.0, -3.6000000000000005, -11.5, -3.9000000000000012, -10.0, -12.9, -3.6000000000000005, -4.000000000000001, -3.800000000000001, -3.7000000000000006, -4.000000000000001, -10.8, -3.7000000000000006, -3.6000000000000005, -3.600000000000001, -3.6000000000000005, -3.600000000000001, -10.9, -3.900000000000001, -3.6000000000000005, -3.7000000000000006, -3.7000000000000006, -3.600000000000001, -4.0, -3.900000000000001, -3.7000000000000006, -3.800000000000001, -3.9000000000000012, -12.8, -4.000000000000001, -12.200000000000001, -4.000000000000001, -3.9000000000000012, -3.800000000000001, -3.7000000000000006, -3.8000000000000007, -3.5000000000000004, -3.900000000000001, -3.6000000000000005, -4.0, -10.1, -4.100000000000001, -3.7000000000000006, -3.8000000000000007, -4.100000000000001, -10.1, -3.7000000000000006, -3.900000000000001, -3.900000000000001, -10.8, -10.8, -11.6, -3.8000000000000007, -3.9000000000000012, -3.700000000000001, -3.900000000000001, -3.800000000000001, -3.900000000000001, -11.1, -3.5000000000000004, -12.8, -3.8000000000000007, -3.900000000000001, -11.0, -10.6, -3.600000000000001, -11.5, -3.8000000000000007, -11.8, -3.8000000000000007, -12.4, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -3.700000000000001, -10.5, -3.8000000000000007, -3.8000000000000007, -3.9000000000000012, -3.600000000000001, -3.700000000000001, -3.9000000000000012, -3.600000000000001, -3.8000000000000007, -3.9000000000000012, -3.8000000000000007], "episode_lengths": [21, 21, 21, 12, 21, 21, 21, 16, 21, 10, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 1, 3, 21, 21, 21, 4, 1, 21, 21, 1, 2, 21, 21, 21, 5, 5, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 15, 21, 18, 16, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 8, 21, 21, 10, 9, 21, 21, 21, 21, 2, 6, 3, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 12, 21, 10, 21, 21, 21, 8, 21, 21, 21, 10, 21, 1, 19, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 2, 21, 21, 21, 8, 7, 12, 21, 21, 21, 21, 21, 21, 10, 21, 17, 21, 21, 9, 7, 21, 13, 21, 14, 21, 20, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.832961916867209, "mean_inference_ms": 18.71253363793994, "mean_action_processing_ms": 1.0060739716939002, "mean_env_wait_ms": 1.9194655195692785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0792302916535234, "StateBufferConnector_ms": 0.010112956561873445, "ViewRequirementAgentConnector_ms": 0.14516157386577236}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 170946.212, "load_time_ms": 1.117, "load_throughput": 3580285.105, "learn_time_ms": 169953.361, "learn_throughput": 23.536, "synch_weights_time_ms": 184.798}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "episodes_total": 2916, "training_iteration": 14, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-06_21-35-27", "timestamp": 1680809727, "time_this_iter_s": 171.65333676338196, "time_total_s": 2393.9244356155396, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0147740130>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01476f4b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 2393.9244356155396, "timesteps_since_restore": 0, "iterations_since_restore": 14, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.53811475409836, "ram_util_percent": 23.50204918032787}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.54777420823292, "cur_kl_coeff": 19.46195068359375, "cur_lr": 0.01, "total_loss": 1.0422405653082396, "policy_loss": 0.000901565006783893, "vf_loss": 0.9378516372653746, "vf_explained_var": 0.3522052519423987, "kl": 0.005317419996478542, "entropy": 3.3225657798910655, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 13485.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": 97.8, "episode_reward_min": -12.9, "episode_reward_mean": -4.873394495412844, "episode_len_mean": 18.376146788990827, "episode_media": {}, "episodes_this_iter": 218, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.6, -3.6000000000000005, -11.2, -3.5000000000000004, -3.900000000000001, -3.6000000000000005, -3.600000000000001, -3.8000000000000007, -3.3000000000000007, -4.000000000000001, -3.5000000000000004, -3.9000000000000012, -3.8000000000000007, -4.100000000000001, -3.5, -3.5000000000000004, -3.700000000000001, -3.400000000000001, -3.600000000000001, -11.0, -3.900000000000001, -10.2, -3.500000000000001, -4.000000000000001, -4.300000000000001, -3.900000000000001, -3.600000000000001, -3.7000000000000006, -4.000000000000001, -10.1, -3.800000000000001, -3.6000000000000005, -3.6000000000000005, -3.8000000000000007, -3.8000000000000007, -10.3, -11.8, -3.800000000000001, -3.900000000000001, -10.5, -4.100000000000001, -10.0, -3.8000000000000007, -10.6, -10.1, -3.800000000000001, -3.7000000000000006, -3.5000000000000004, -11.4, -4.100000000000001, -4.000000000000001, -3.8000000000000016, -12.4, -12.3, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.600000000000001, -4.000000000000001, -3.7000000000000006, -4.000000000000002, -3.6000000000000005, -4.200000000000001, -3.500000000000001, -3.7000000000000006, -4.000000000000001, -3.800000000000001, -10.3, -4.100000000000001, -3.6000000000000005, -3.900000000000001, -3.700000000000001, -4.000000000000001, -3.7000000000000006, -3.600000000000001, -3.7000000000000006, -3.6000000000000005, -3.9000000000000012, -3.600000000000001, -3.9000000000000012, -3.8000000000000007, -11.3, -3.800000000000001, -12.0, -3.8000000000000007, -3.5000000000000004, -10.2, -10.8, -10.8, -3.600000000000001, -3.600000000000001, -10.9, -3.4000000000000004, -3.9000000000000004, -4.000000000000001, -3.700000000000001, -3.8000000000000007, -10.8, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -3.500000000000001, -3.800000000000001, -3.8000000000000007, -3.800000000000001, -12.4, -3.7000000000000006, -3.800000000000001, -10.8, -3.700000000000001, -4.0, -3.5000000000000004, -3.600000000000001, -3.7000000000000006, -3.9000000000000012, -3.900000000000001, -3.700000000000001, 97.8, -3.700000000000001, -11.6, -3.700000000000001, -3.5000000000000004, -3.600000000000001, -10.4, -3.7000000000000006, -3.600000000000001, -3.500000000000001, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -10.6, -10.6, -4.100000000000001, -3.6000000000000005, -10.8, -10.0, -3.800000000000001, -10.2, -3.7000000000000006, -4.000000000000001, -10.1, -4.000000000000001, -10.6, -3.8000000000000007, -3.8000000000000007, -3.600000000000001, -3.8000000000000007, -3.700000000000001, -3.400000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -3.700000000000001, -3.800000000000001, -4.000000000000002, -11.1, -3.9000000000000012, -10.9, -3.500000000000001, -11.4, -3.8000000000000007, -11.6, -10.3, -3.6000000000000005, -3.8000000000000007, -3.2000000000000006, -11.3, -3.7000000000000006, -3.900000000000001, -3.600000000000001, -3.5000000000000004, -3.8000000000000007, -11.4, -12.3, -3.7000000000000006, -4.000000000000001, -3.9000000000000012, -4.000000000000001, -3.600000000000001, -3.7000000000000006, -10.0, -11.8, -4.000000000000001, -3.700000000000001, -3.9000000000000004, -3.900000000000001, -4.100000000000001, -3.600000000000001, -3.800000000000001, -4.1000000000000005, -3.400000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -3.700000000000001, -4.000000000000002, -11.1, -3.7000000000000006, -11.2, -3.500000000000001, -3.900000000000001, -3.500000000000001, -3.900000000000001, -4.000000000000001, -12.9, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.9000000000000012, -4.100000000000001, -3.900000000000001, -3.900000000000001, -12.1, -3.6000000000000005, -3.600000000000001], "episode_lengths": [14, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 3, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 3, 14, 21, 21, 5, 21, 1, 21, 6, 2, 21, 21, 21, 11, 21, 21, 21, 18, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 16, 21, 21, 3, 8, 9, 21, 21, 9, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 15, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 6, 6, 21, 21, 8, 1, 21, 2, 21, 21, 2, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 8, 21, 12, 21, 13, 4, 21, 21, 21, 13, 21, 21, 21, 21, 21, 12, 17, 21, 21, 21, 21, 21, 21, 1, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 11, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.830316587994181, "mean_inference_ms": 18.67206730537818, "mean_action_processing_ms": 0.9971189645692042, "mean_env_wait_ms": 1.905356250956994, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0712567513142157, "StateBufferConnector_ms": 0.009616143112882562, "ViewRequirementAgentConnector_ms": 0.13247367438920046}}, "episode_reward_max": 97.8, "episode_reward_min": -12.9, "episode_reward_mean": -4.873394495412844, "episode_len_mean": 18.376146788990827, "episodes_this_iter": 218, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11.6, -3.6000000000000005, -11.2, -3.5000000000000004, -3.900000000000001, -3.6000000000000005, -3.600000000000001, -3.8000000000000007, -3.3000000000000007, -4.000000000000001, -3.5000000000000004, -3.9000000000000012, -3.8000000000000007, -4.100000000000001, -3.5, -3.5000000000000004, -3.700000000000001, -3.400000000000001, -3.600000000000001, -11.0, -3.900000000000001, -10.2, -3.500000000000001, -4.000000000000001, -4.300000000000001, -3.900000000000001, -3.600000000000001, -3.7000000000000006, -4.000000000000001, -10.1, -3.800000000000001, -3.6000000000000005, -3.6000000000000005, -3.8000000000000007, -3.8000000000000007, -10.3, -11.8, -3.800000000000001, -3.900000000000001, -10.5, -4.100000000000001, -10.0, -3.8000000000000007, -10.6, -10.1, -3.800000000000001, -3.7000000000000006, -3.5000000000000004, -11.4, -4.100000000000001, -4.000000000000001, -3.8000000000000016, -12.4, -12.3, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.600000000000001, -4.000000000000001, -3.7000000000000006, -4.000000000000002, -3.6000000000000005, -4.200000000000001, -3.500000000000001, -3.7000000000000006, -4.000000000000001, -3.800000000000001, -10.3, -4.100000000000001, -3.6000000000000005, -3.900000000000001, -3.700000000000001, -4.000000000000001, -3.7000000000000006, -3.600000000000001, -3.7000000000000006, -3.6000000000000005, -3.9000000000000012, -3.600000000000001, -3.9000000000000012, -3.8000000000000007, -11.3, -3.800000000000001, -12.0, -3.8000000000000007, -3.5000000000000004, -10.2, -10.8, -10.8, -3.600000000000001, -3.600000000000001, -10.9, -3.4000000000000004, -3.9000000000000004, -4.000000000000001, -3.700000000000001, -3.8000000000000007, -10.8, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -3.500000000000001, -3.800000000000001, -3.8000000000000007, -3.800000000000001, -12.4, -3.7000000000000006, -3.800000000000001, -10.8, -3.700000000000001, -4.0, -3.5000000000000004, -3.600000000000001, -3.7000000000000006, -3.9000000000000012, -3.900000000000001, -3.700000000000001, 97.8, -3.700000000000001, -11.6, -3.700000000000001, -3.5000000000000004, -3.600000000000001, -10.4, -3.7000000000000006, -3.600000000000001, -3.500000000000001, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -10.6, -10.6, -4.100000000000001, -3.6000000000000005, -10.8, -10.0, -3.800000000000001, -10.2, -3.7000000000000006, -4.000000000000001, -10.1, -4.000000000000001, -10.6, -3.8000000000000007, -3.8000000000000007, -3.600000000000001, -3.8000000000000007, -3.700000000000001, -3.400000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -3.700000000000001, -3.800000000000001, -4.000000000000002, -11.1, -3.9000000000000012, -10.9, -3.500000000000001, -11.4, -3.8000000000000007, -11.6, -10.3, -3.6000000000000005, -3.8000000000000007, -3.2000000000000006, -11.3, -3.7000000000000006, -3.900000000000001, -3.600000000000001, -3.5000000000000004, -3.8000000000000007, -11.4, -12.3, -3.7000000000000006, -4.000000000000001, -3.9000000000000012, -4.000000000000001, -3.600000000000001, -3.7000000000000006, -10.0, -11.8, -4.000000000000001, -3.700000000000001, -3.9000000000000004, -3.900000000000001, -4.100000000000001, -3.600000000000001, -3.800000000000001, -4.1000000000000005, -3.400000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -3.700000000000001, -4.000000000000002, -11.1, -3.7000000000000006, -11.2, -3.500000000000001, -3.900000000000001, -3.500000000000001, -3.900000000000001, -4.000000000000001, -12.9, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.9000000000000012, -4.100000000000001, -3.900000000000001, -3.900000000000001, -12.1, -3.6000000000000005, -3.600000000000001], "episode_lengths": [14, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 3, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 3, 14, 21, 21, 5, 21, 1, 21, 6, 2, 21, 21, 21, 11, 21, 21, 21, 18, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 16, 21, 21, 3, 8, 9, 21, 21, 9, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 15, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 6, 6, 21, 21, 8, 1, 21, 2, 21, 21, 2, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 8, 21, 12, 21, 13, 4, 21, 21, 21, 13, 21, 21, 21, 21, 21, 12, 17, 21, 21, 21, 21, 21, 21, 1, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 11, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.830316587994181, "mean_inference_ms": 18.67206730537818, "mean_action_processing_ms": 0.9971189645692042, "mean_env_wait_ms": 1.905356250956994, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0712567513142157, "StateBufferConnector_ms": 0.009616143112882562, "ViewRequirementAgentConnector_ms": 0.13247367438920046}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 171004.489, "load_time_ms": 1.124, "load_throughput": 3558868.101, "learn_time_ms": 170018.909, "learn_throughput": 23.527, "synch_weights_time_ms": 184.035}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 3134, "training_iteration": 15, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-06_21-38-18", "timestamp": 1680809898, "time_this_iter_s": 171.16093850135803, "time_total_s": 2565.0853741168976, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476b9160>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014764b430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 2565.0853741168976, "timesteps_since_restore": 0, "iterations_since_restore": 15, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.4452674897119335, "ram_util_percent": 23.512345679012345}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.982000302242977, "cur_kl_coeff": 19.46195068359375, "cur_lr": 0.01, "total_loss": 1.4667592638122138, "policy_loss": 0.0013515230448495957, "vf_loss": 1.2911094252781201, "vf_explained_var": 0.3098976803723202, "kl": 0.008955850558523189, "entropy": 3.3117070639005273, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 14415.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "sampler_results": {"episode_reward_max": -3.3000000000000003, "episode_reward_min": -12.8, "episode_reward_mean": -5.833333333333333, "episode_len_mean": 17.90222222222222, "episode_media": {}, "episodes_this_iter": 225, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.600000000000001, -3.600000000000001, -3.700000000000001, -3.4000000000000004, -3.600000000000001, -3.9000000000000012, -3.7000000000000006, -3.700000000000001, -11.4, -3.8000000000000007, -3.600000000000001, -3.600000000000001, -11.4, -3.8000000000000007, -3.8000000000000007, -12.3, -4.000000000000001, -3.700000000000001, -3.6000000000000005, -11.1, -3.9000000000000012, -3.8000000000000007, -3.900000000000001, -3.700000000000001, -3.700000000000001, -3.7000000000000006, -3.700000000000001, -3.600000000000001, -4.100000000000001, -3.8000000000000007, -3.9000000000000012, -11.6, -10.2, -3.500000000000001, -10.4, -3.7000000000000006, -4.100000000000001, -3.7000000000000006, -4.000000000000001, -3.500000000000001, -3.7000000000000006, -3.8000000000000007, -3.900000000000001, -11.4, -4.000000000000001, -11.1, -3.900000000000001, -4.200000000000001, -10.8, -3.700000000000001, -3.500000000000001, -3.8000000000000007, -3.7000000000000006, -3.400000000000001, -10.5, -11.6, -3.700000000000001, -3.9000000000000012, -4.000000000000001, -4.000000000000001, -3.500000000000001, -11.6, -3.900000000000001, -12.7, -11.2, -11.2, -3.7000000000000006, -10.5, -3.500000000000001, -3.6000000000000005, -3.400000000000001, -3.6000000000000005, -3.7000000000000006, -3.7000000000000006, -3.6000000000000005, -3.7000000000000006, -11.0, -12.0, -10.6, -3.6000000000000005, -12.8, -3.8000000000000007, -3.9000000000000012, -10.5, -3.9000000000000004, -3.700000000000001, -3.900000000000001, -11.0, -3.9000000000000012, -11.0, -3.700000000000001, -3.700000000000001, -4.0, -3.8000000000000007, -3.5000000000000004, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -4.000000000000001, -3.800000000000001, -3.600000000000001, -3.700000000000001, -3.600000000000001, -3.500000000000001, -3.600000000000001, -3.6000000000000005, -3.9000000000000004, -3.900000000000001, -4.000000000000001, -4.100000000000001, -10.4, -3.6000000000000005, -4.000000000000001, -11.8, -3.9000000000000004, -10.1, -3.8000000000000007, -10.9, -3.800000000000001, -3.900000000000001, -10.8, -3.700000000000001, -3.8000000000000007, -11.1, -11.0, -3.8000000000000007, -11.1, -3.8000000000000007, -12.4, -3.8000000000000003, -10.8, -11.0, -10.2, -4.000000000000001, -11.0, -10.6, -10.0, -3.6000000000000005, -10.9, -3.800000000000001, -3.900000000000001, -12.2, -10.7, -10.7, -3.700000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.6000000000000005, -3.6000000000000005, -3.800000000000001, -3.7000000000000006, -3.6000000000000005, -3.900000000000001, -11.0, -4.100000000000001, -4.200000000000001, -3.800000000000001, -4.100000000000001, -3.800000000000001, -3.7000000000000006, -11.8, -3.7000000000000006, -11.5, -4.000000000000001, -11.0, -3.8000000000000007, -3.3000000000000003, -3.6000000000000005, -3.7000000000000006, -3.700000000000001, -3.600000000000001, -3.5000000000000004, -10.1, -3.7000000000000006, -11.5, -12.8, -3.8000000000000007, -3.8000000000000003, -3.4000000000000004, -3.700000000000001, -11.5, -3.7000000000000006, -3.900000000000001, -3.7000000000000006, -3.4000000000000004, -3.900000000000001, -3.7000000000000006, -3.800000000000001, -3.7000000000000006, -12.8, -10.4, -11.1, -10.4, -4.000000000000001, -3.8000000000000003, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -11.1, -11.3, -3.8000000000000007, -3.5000000000000004, -12.600000000000001, -3.900000000000001, -10.6, -3.800000000000001, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -12.200000000000001, -3.700000000000001, -10.4, -10.5, -3.800000000000001, -3.800000000000001, -3.8000000000000007, -3.700000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -3.3000000000000007, -3.6000000000000005, -11.0, -3.7000000000000006], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 11, 21, 21, 18, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 3, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 9, 21, 21, 7, 21, 21, 21, 21, 21, 6, 14, 21, 21, 21, 21, 21, 14, 21, 18, 10, 9, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 9, 15, 7, 21, 19, 21, 21, 4, 21, 21, 21, 10, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 14, 21, 2, 21, 9, 21, 21, 8, 21, 21, 11, 9, 21, 10, 21, 18, 21, 8, 9, 3, 21, 11, 7, 1, 21, 10, 21, 21, 15, 6, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 15, 21, 11, 21, 8, 21, 21, 21, 21, 21, 21, 21, 2, 21, 13, 20, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 20, 5, 10, 4, 21, 21, 21, 21, 21, 9, 11, 21, 21, 18, 21, 6, 21, 21, 21, 21, 18, 21, 5, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.793003911499994, "mean_inference_ms": 18.538649315733362, "mean_action_processing_ms": 0.9899568310160254, "mean_env_wait_ms": 1.8822691967925547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07097106509738499, "StateBufferConnector_ms": 0.009121153089735243, "ViewRequirementAgentConnector_ms": 0.13114314609103733}}, "episode_reward_max": -3.3000000000000003, "episode_reward_min": -12.8, "episode_reward_mean": -5.833333333333333, "episode_len_mean": 17.90222222222222, "episodes_this_iter": 225, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.600000000000001, -3.600000000000001, -3.700000000000001, -3.4000000000000004, -3.600000000000001, -3.9000000000000012, -3.7000000000000006, -3.700000000000001, -11.4, -3.8000000000000007, -3.600000000000001, -3.600000000000001, -11.4, -3.8000000000000007, -3.8000000000000007, -12.3, -4.000000000000001, -3.700000000000001, -3.6000000000000005, -11.1, -3.9000000000000012, -3.8000000000000007, -3.900000000000001, -3.700000000000001, -3.700000000000001, -3.7000000000000006, -3.700000000000001, -3.600000000000001, -4.100000000000001, -3.8000000000000007, -3.9000000000000012, -11.6, -10.2, -3.500000000000001, -10.4, -3.7000000000000006, -4.100000000000001, -3.7000000000000006, -4.000000000000001, -3.500000000000001, -3.7000000000000006, -3.8000000000000007, -3.900000000000001, -11.4, -4.000000000000001, -11.1, -3.900000000000001, -4.200000000000001, -10.8, -3.700000000000001, -3.500000000000001, -3.8000000000000007, -3.7000000000000006, -3.400000000000001, -10.5, -11.6, -3.700000000000001, -3.9000000000000012, -4.000000000000001, -4.000000000000001, -3.500000000000001, -11.6, -3.900000000000001, -12.7, -11.2, -11.2, -3.7000000000000006, -10.5, -3.500000000000001, -3.6000000000000005, -3.400000000000001, -3.6000000000000005, -3.7000000000000006, -3.7000000000000006, -3.6000000000000005, -3.7000000000000006, -11.0, -12.0, -10.6, -3.6000000000000005, -12.8, -3.8000000000000007, -3.9000000000000012, -10.5, -3.9000000000000004, -3.700000000000001, -3.900000000000001, -11.0, -3.9000000000000012, -11.0, -3.700000000000001, -3.700000000000001, -4.0, -3.8000000000000007, -3.5000000000000004, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -4.000000000000001, -3.800000000000001, -3.600000000000001, -3.700000000000001, -3.600000000000001, -3.500000000000001, -3.600000000000001, -3.6000000000000005, -3.9000000000000004, -3.900000000000001, -4.000000000000001, -4.100000000000001, -10.4, -3.6000000000000005, -4.000000000000001, -11.8, -3.9000000000000004, -10.1, -3.8000000000000007, -10.9, -3.800000000000001, -3.900000000000001, -10.8, -3.700000000000001, -3.8000000000000007, -11.1, -11.0, -3.8000000000000007, -11.1, -3.8000000000000007, -12.4, -3.8000000000000003, -10.8, -11.0, -10.2, -4.000000000000001, -11.0, -10.6, -10.0, -3.6000000000000005, -10.9, -3.800000000000001, -3.900000000000001, -12.2, -10.7, -10.7, -3.700000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.6000000000000005, -3.6000000000000005, -3.800000000000001, -3.7000000000000006, -3.6000000000000005, -3.900000000000001, -11.0, -4.100000000000001, -4.200000000000001, -3.800000000000001, -4.100000000000001, -3.800000000000001, -3.7000000000000006, -11.8, -3.7000000000000006, -11.5, -4.000000000000001, -11.0, -3.8000000000000007, -3.3000000000000003, -3.6000000000000005, -3.7000000000000006, -3.700000000000001, -3.600000000000001, -3.5000000000000004, -10.1, -3.7000000000000006, -11.5, -12.8, -3.8000000000000007, -3.8000000000000003, -3.4000000000000004, -3.700000000000001, -11.5, -3.7000000000000006, -3.900000000000001, -3.7000000000000006, -3.4000000000000004, -3.900000000000001, -3.7000000000000006, -3.800000000000001, -3.7000000000000006, -12.8, -10.4, -11.1, -10.4, -4.000000000000001, -3.8000000000000003, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -11.1, -11.3, -3.8000000000000007, -3.5000000000000004, -12.600000000000001, -3.900000000000001, -10.6, -3.800000000000001, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -12.200000000000001, -3.700000000000001, -10.4, -10.5, -3.800000000000001, -3.800000000000001, -3.8000000000000007, -3.700000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -3.3000000000000007, -3.6000000000000005, -11.0, -3.7000000000000006], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 11, 21, 21, 18, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 3, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 9, 21, 21, 7, 21, 21, 21, 21, 21, 6, 14, 21, 21, 21, 21, 21, 14, 21, 18, 10, 9, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 9, 15, 7, 21, 19, 21, 21, 4, 21, 21, 21, 10, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 14, 21, 2, 21, 9, 21, 21, 8, 21, 21, 11, 9, 21, 10, 21, 18, 21, 8, 9, 3, 21, 11, 7, 1, 21, 10, 21, 21, 15, 6, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 15, 21, 11, 21, 8, 21, 21, 21, 21, 21, 21, 21, 2, 21, 13, 20, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 20, 5, 10, 4, 21, 21, 21, 21, 21, 9, 11, 21, 21, 18, 21, 6, 21, 21, 21, 21, 18, 21, 5, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.793003911499994, "mean_inference_ms": 18.538649315733362, "mean_action_processing_ms": 0.9899568310160254, "mean_env_wait_ms": 1.8822691967925547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07097106509738499, "StateBufferConnector_ms": 0.009121153089735243, "ViewRequirementAgentConnector_ms": 0.13114314609103733}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 171032.184, "load_time_ms": 1.129, "load_throughput": 3544507.215, "learn_time_ms": 170045.501, "learn_throughput": 23.523, "synch_weights_time_ms": 183.568}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "episodes_total": 3359, "training_iteration": 16, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-06_21-41-09", "timestamp": 1680810069, "time_this_iter_s": 170.75311636924744, "time_total_s": 2735.838490486145, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0147791280>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014784a5e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 2735.838490486145, "timesteps_since_restore": 0, "iterations_since_restore": 16, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.480246913580246, "ram_util_percent": 23.589300411522636}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.33195832390939, "cur_kl_coeff": 19.46195068359375, "cur_lr": 0.01, "total_loss": 1.1185769864468165, "policy_loss": 0.0022937136131428904, "vf_loss": 0.8841524468154036, "vf_explained_var": 0.36753880420038776, "kl": 0.011927418481628661, "entropy": 3.2877285683026876, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 15345.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "sampler_results": {"episode_reward_max": -3.2, "episode_reward_min": -12.700000000000001, "episode_reward_mean": -5.345539906103287, "episode_len_mean": 18.591549295774648, "episode_media": {}, "episodes_this_iter": 213, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.000000000000001, -11.3, -3.7000000000000006, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000002, -3.600000000000001, -4.000000000000001, -4.000000000000001, -3.6000000000000005, -3.900000000000001, -3.5000000000000004, -3.400000000000001, -3.600000000000001, -3.800000000000001, -3.8000000000000007, -10.4, -3.6000000000000005, -3.8000000000000007, -3.6000000000000005, -4.200000000000001, -10.1, -11.4, -4.300000000000001, -3.9000000000000004, -3.900000000000001, -12.700000000000001, -3.8000000000000007, -3.2, -3.600000000000001, -3.9000000000000004, -3.8000000000000007, -3.4000000000000004, -3.8000000000000007, -3.8000000000000007, -3.6000000000000005, -3.600000000000001, -3.8000000000000007, -3.700000000000001, -3.7000000000000006, -3.7000000000000006, -3.900000000000001, -3.6000000000000005, -3.5000000000000004, -3.6, -4.200000000000001, -3.900000000000001, -3.7000000000000006, -3.6000000000000005, -10.4, -3.700000000000001, -4.000000000000001, -3.6000000000000005, -10.3, -3.9000000000000012, -11.7, -3.4000000000000004, -3.4000000000000004, -3.700000000000001, -3.700000000000001, -11.9, -3.700000000000001, -4.000000000000001, -3.900000000000001, -3.600000000000001, -3.800000000000001, -3.400000000000001, -3.8000000000000007, -4.300000000000001, -3.500000000000001, -3.800000000000001, -12.4, -3.900000000000001, -3.8000000000000003, -12.5, -4.300000000000001, -11.4, -12.4, -3.8000000000000007, -11.4, -4.300000000000001, -10.4, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.9000000000000012, -3.800000000000001, -3.8000000000000007, -3.8000000000000007, -3.6000000000000005, -3.8000000000000007, -3.7000000000000006, -4.100000000000001, -11.9, -4.000000000000001, -3.7000000000000006, -3.800000000000001, -3.7000000000000006, -3.7000000000000006, -3.400000000000001, -3.800000000000001, -11.1, -3.800000000000001, -11.9, -3.8000000000000007, -4.000000000000001, -3.6000000000000005, -3.600000000000001, -10.2, -3.8000000000000007, -3.700000000000001, -4.000000000000001, -4.000000000000002, -3.6, -3.6000000000000005, -3.500000000000001, -3.800000000000001, -3.7000000000000006, -3.900000000000001, -10.3, -4.000000000000001, -3.700000000000001, -11.1, -10.5, -10.0, -3.6000000000000005, -3.8000000000000007, -11.7, -3.900000000000001, -3.900000000000001, -3.6000000000000005, -4.100000000000001, -10.4, -3.700000000000001, -11.6, -3.8000000000000003, -3.9000000000000004, -3.8000000000000007, -3.7000000000000006, -3.9000000000000004, -3.8000000000000007, -11.8, -3.8000000000000007, -4.000000000000001, -3.6000000000000005, -3.900000000000001, -4.0, -4.000000000000002, -10.4, -3.7000000000000006, -3.6000000000000005, -3.8000000000000007, -3.6000000000000005, -3.900000000000001, -3.7000000000000006, -11.6, -11.7, -3.600000000000001, -3.700000000000001, -4.100000000000001, -3.500000000000001, -3.7000000000000006, -3.5000000000000004, -3.900000000000001, -10.5, -10.8, -10.0, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -4.200000000000001, -3.700000000000001, -10.3, -11.4, -3.800000000000001, -3.900000000000001, -10.7, -11.4, -4.100000000000001, -3.9000000000000004, -3.6000000000000005, -12.1, -3.6000000000000005, -3.500000000000001, -3.700000000000001, -10.5, -3.4000000000000004, -11.2, -11.3, -4.1000000000000005, -3.8000000000000007, -11.0, -11.6, -3.8000000000000007, -3.700000000000001, -3.800000000000001, -10.7, -3.900000000000001, -4.300000000000001, -3.7000000000000006, -4.000000000000002, -3.8000000000000007, -4.100000000000001, -11.2, -3.5000000000000004, -4.000000000000001, -4.000000000000001, -3.6000000000000005, -4.100000000000001, -3.800000000000001], "episode_lengths": [21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 2, 10, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 4, 21, 13, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 17, 21, 10, 18, 21, 11, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 10, 21, 14, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 10, 4, 1, 21, 21, 14, 21, 21, 21, 21, 4, 21, 14, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 13, 13, 21, 21, 21, 21, 21, 21, 21, 6, 8, 1, 21, 21, 21, 21, 21, 4, 12, 21, 21, 8, 12, 21, 21, 21, 15, 21, 21, 21, 5, 21, 11, 11, 21, 21, 9, 12, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.755973491842282, "mean_inference_ms": 18.515851475887104, "mean_action_processing_ms": 0.9891045160335465, "mean_env_wait_ms": 1.8646832944150922, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07100026932120883, "StateBufferConnector_ms": 0.0095815166061473, "ViewRequirementAgentConnector_ms": 0.131190214918253}}, "episode_reward_max": -3.2, "episode_reward_min": -12.700000000000001, "episode_reward_mean": -5.345539906103287, "episode_len_mean": 18.591549295774648, "episodes_this_iter": 213, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.000000000000001, -11.3, -3.7000000000000006, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000002, -3.600000000000001, -4.000000000000001, -4.000000000000001, -3.6000000000000005, -3.900000000000001, -3.5000000000000004, -3.400000000000001, -3.600000000000001, -3.800000000000001, -3.8000000000000007, -10.4, -3.6000000000000005, -3.8000000000000007, -3.6000000000000005, -4.200000000000001, -10.1, -11.4, -4.300000000000001, -3.9000000000000004, -3.900000000000001, -12.700000000000001, -3.8000000000000007, -3.2, -3.600000000000001, -3.9000000000000004, -3.8000000000000007, -3.4000000000000004, -3.8000000000000007, -3.8000000000000007, -3.6000000000000005, -3.600000000000001, -3.8000000000000007, -3.700000000000001, -3.7000000000000006, -3.7000000000000006, -3.900000000000001, -3.6000000000000005, -3.5000000000000004, -3.6, -4.200000000000001, -3.900000000000001, -3.7000000000000006, -3.6000000000000005, -10.4, -3.700000000000001, -4.000000000000001, -3.6000000000000005, -10.3, -3.9000000000000012, -11.7, -3.4000000000000004, -3.4000000000000004, -3.700000000000001, -3.700000000000001, -11.9, -3.700000000000001, -4.000000000000001, -3.900000000000001, -3.600000000000001, -3.800000000000001, -3.400000000000001, -3.8000000000000007, -4.300000000000001, -3.500000000000001, -3.800000000000001, -12.4, -3.900000000000001, -3.8000000000000003, -12.5, -4.300000000000001, -11.4, -12.4, -3.8000000000000007, -11.4, -4.300000000000001, -10.4, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.9000000000000012, -3.800000000000001, -3.8000000000000007, -3.8000000000000007, -3.6000000000000005, -3.8000000000000007, -3.7000000000000006, -4.100000000000001, -11.9, -4.000000000000001, -3.7000000000000006, -3.800000000000001, -3.7000000000000006, -3.7000000000000006, -3.400000000000001, -3.800000000000001, -11.1, -3.800000000000001, -11.9, -3.8000000000000007, -4.000000000000001, -3.6000000000000005, -3.600000000000001, -10.2, -3.8000000000000007, -3.700000000000001, -4.000000000000001, -4.000000000000002, -3.6, -3.6000000000000005, -3.500000000000001, -3.800000000000001, -3.7000000000000006, -3.900000000000001, -10.3, -4.000000000000001, -3.700000000000001, -11.1, -10.5, -10.0, -3.6000000000000005, -3.8000000000000007, -11.7, -3.900000000000001, -3.900000000000001, -3.6000000000000005, -4.100000000000001, -10.4, -3.700000000000001, -11.6, -3.8000000000000003, -3.9000000000000004, -3.8000000000000007, -3.7000000000000006, -3.9000000000000004, -3.8000000000000007, -11.8, -3.8000000000000007, -4.000000000000001, -3.6000000000000005, -3.900000000000001, -4.0, -4.000000000000002, -10.4, -3.7000000000000006, -3.6000000000000005, -3.8000000000000007, -3.6000000000000005, -3.900000000000001, -3.7000000000000006, -11.6, -11.7, -3.600000000000001, -3.700000000000001, -4.100000000000001, -3.500000000000001, -3.7000000000000006, -3.5000000000000004, -3.900000000000001, -10.5, -10.8, -10.0, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -4.200000000000001, -3.700000000000001, -10.3, -11.4, -3.800000000000001, -3.900000000000001, -10.7, -11.4, -4.100000000000001, -3.9000000000000004, -3.6000000000000005, -12.1, -3.6000000000000005, -3.500000000000001, -3.700000000000001, -10.5, -3.4000000000000004, -11.2, -11.3, -4.1000000000000005, -3.8000000000000007, -11.0, -11.6, -3.8000000000000007, -3.700000000000001, -3.800000000000001, -10.7, -3.900000000000001, -4.300000000000001, -3.7000000000000006, -4.000000000000002, -3.8000000000000007, -4.100000000000001, -11.2, -3.5000000000000004, -4.000000000000001, -4.000000000000001, -3.6000000000000005, -4.100000000000001, -3.800000000000001], "episode_lengths": [21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 2, 10, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 4, 21, 13, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 17, 21, 10, 18, 21, 11, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 10, 21, 14, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 10, 4, 1, 21, 21, 14, 21, 21, 21, 21, 4, 21, 14, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 13, 13, 21, 21, 21, 21, 21, 21, 21, 6, 8, 1, 21, 21, 21, 21, 21, 4, 12, 21, 21, 8, 12, 21, 21, 21, 15, 21, 21, 21, 5, 21, 11, 11, 21, 21, 9, 12, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.755973491842282, "mean_inference_ms": 18.515851475887104, "mean_action_processing_ms": 0.9891045160335465, "mean_env_wait_ms": 1.8646832944150922, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07100026932120883, "StateBufferConnector_ms": 0.0095815166061473, "ViewRequirementAgentConnector_ms": 0.131190214918253}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 170926.793, "load_time_ms": 1.12, "load_throughput": 3570000.213, "learn_time_ms": 169937.764, "learn_throughput": 23.538, "synch_weights_time_ms": 184.437}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "episodes_total": 3572, "training_iteration": 17, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-06_21-44-00", "timestamp": 1680810240, "time_this_iter_s": 170.54734230041504, "time_total_s": 2906.38583278656, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0147607c40>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0147643820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 2906.38583278656, "timesteps_since_restore": 0, "iterations_since_restore": 17, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.350205761316873, "ram_util_percent": 23.58518518518519}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.064465848348474, "cur_kl_coeff": 19.46195068359375, "cur_lr": 0.01, "total_loss": 1.0990053292203654, "policy_loss": 0.001909631672966224, "vf_loss": 0.8732629133408428, "vf_explained_var": 0.3618042624765827, "kl": 0.011501045995898875, "entropy": 3.3159207344055175, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 16275.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": -3.4000000000000004, "episode_reward_min": -12.600000000000001, "episode_reward_mean": -5.211981566820277, "episode_len_mean": 18.622119815668203, "episode_media": {}, "episodes_this_iter": 217, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.8, -3.8000000000000007, -10.8, -3.4000000000000004, -3.9000000000000004, -4.000000000000001, -3.6000000000000005, -3.700000000000001, -3.900000000000001, -3.700000000000001, -10.3, -3.8000000000000007, -3.400000000000001, -3.700000000000001, -3.7000000000000006, -3.8000000000000007, -11.6, -3.800000000000001, -3.900000000000001, -3.700000000000001, -3.600000000000001, -10.0, -3.7000000000000006, -3.900000000000001, -3.500000000000001, -10.1, -3.4000000000000004, -3.6, -3.800000000000001, -10.0, -11.2, -12.0, -3.6000000000000005, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -4.200000000000001, -4.000000000000001, -3.8000000000000007, -3.7000000000000006, -3.800000000000001, -3.700000000000001, -3.700000000000001, -3.8000000000000007, -11.7, -3.7000000000000006, -4.000000000000001, -11.5, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -3.6000000000000005, -3.9000000000000012, -4.000000000000001, -3.600000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -4.200000000000001, -3.8000000000000007, -3.7000000000000006, -3.500000000000001, -10.6, -3.7000000000000006, -3.900000000000001, -3.5000000000000004, -10.5, -3.7000000000000006, -3.900000000000001, -3.500000000000001, -3.7000000000000006, -11.0, -3.900000000000001, -3.600000000000001, -3.900000000000001, -3.8000000000000003, -10.5, -3.700000000000001, -3.6000000000000005, -3.8000000000000003, -10.9, -11.5, -3.7000000000000006, -12.3, -12.600000000000001, -3.900000000000001, -3.900000000000001, -3.800000000000001, -3.900000000000001, -4.0, -3.900000000000001, -4.200000000000001, -3.6000000000000005, -3.8000000000000007, -11.0, -3.6000000000000005, -3.800000000000001, -3.800000000000001, -4.200000000000001, -3.800000000000001, -11.4, -10.0, -3.9000000000000012, -3.7000000000000006, -3.900000000000001, -4.0, -4.100000000000001, -3.9000000000000012, -3.700000000000001, -3.6000000000000005, -3.9000000000000017, -12.1, -3.8000000000000007, -3.700000000000001, -12.1, -10.4, -3.400000000000001, -4.000000000000002, -10.5, -3.8000000000000007, -3.6000000000000005, -3.600000000000001, -3.7000000000000006, -3.700000000000001, -3.8000000000000007, -4.000000000000001, -3.9000000000000012, -3.6, -10.3, -3.6000000000000005, -3.600000000000001, -3.900000000000001, -3.600000000000001, -3.600000000000001, -10.5, -3.7000000000000006, -3.600000000000001, -3.7000000000000006, -11.0, -3.8000000000000007, -4.000000000000001, -3.7000000000000015, -4.000000000000001, -3.600000000000001, -4.100000000000001, -3.7000000000000006, -3.600000000000001, -3.7000000000000006, -3.7000000000000006, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -3.700000000000001, -3.5000000000000004, -3.800000000000001, -4.000000000000001, -10.8, -3.800000000000001, -10.6, -4.000000000000001, -3.8000000000000003, -10.4, -3.7000000000000006, -11.8, -3.600000000000001, -3.7000000000000006, -10.8, -3.800000000000001, -3.400000000000001, -10.7, -3.800000000000001, -3.400000000000001, -4.200000000000001, -11.2, -3.500000000000001, -3.900000000000001, -3.700000000000001, -3.600000000000001, -3.800000000000001, -3.6000000000000005, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -11.0, -3.800000000000001, -10.9, -3.600000000000001, -3.900000000000001, -3.8000000000000003, -3.8000000000000007, -3.600000000000001, -3.700000000000001, -10.2, -11.0, -3.9000000000000012, -11.9, -3.8000000000000007, -3.6000000000000005, -3.700000000000001, -3.8000000000000003, -3.9000000000000004, -3.7000000000000006, -3.9000000000000012, -10.3, -4.100000000000001, -3.800000000000001, -3.8000000000000007, -4.300000000000002, -3.7000000000000006, -3.8000000000000007, -4.000000000000002, -4.000000000000001, -3.8000000000000007, -10.4], "episode_lengths": [16, 21, 8, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 1, 21, 21, 21, 2, 21, 21, 21, 1, 12, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 5, 21, 21, 21, 21, 10, 21, 21, 21, 21, 5, 21, 21, 21, 9, 14, 21, 20, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 12, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 15, 5, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 6, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 7, 21, 21, 5, 21, 16, 21, 21, 8, 21, 21, 8, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 9, 21, 21, 21, 21, 21, 21, 3, 9, 21, 16, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.744128092455577, "mean_inference_ms": 18.571114082662206, "mean_action_processing_ms": 0.9873899241218248, "mean_env_wait_ms": 1.8683381677579332, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08449993924611175, "StateBufferConnector_ms": 0.011246435103877898, "ViewRequirementAgentConnector_ms": 0.1541704626127322}}, "episode_reward_max": -3.4000000000000004, "episode_reward_min": -12.600000000000001, "episode_reward_mean": -5.211981566820277, "episode_len_mean": 18.622119815668203, "episodes_this_iter": 217, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11.8, -3.8000000000000007, -10.8, -3.4000000000000004, -3.9000000000000004, -4.000000000000001, -3.6000000000000005, -3.700000000000001, -3.900000000000001, -3.700000000000001, -10.3, -3.8000000000000007, -3.400000000000001, -3.700000000000001, -3.7000000000000006, -3.8000000000000007, -11.6, -3.800000000000001, -3.900000000000001, -3.700000000000001, -3.600000000000001, -10.0, -3.7000000000000006, -3.900000000000001, -3.500000000000001, -10.1, -3.4000000000000004, -3.6, -3.800000000000001, -10.0, -11.2, -12.0, -3.6000000000000005, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -4.200000000000001, -4.000000000000001, -3.8000000000000007, -3.7000000000000006, -3.800000000000001, -3.700000000000001, -3.700000000000001, -3.8000000000000007, -11.7, -3.7000000000000006, -4.000000000000001, -11.5, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -3.6000000000000005, -3.9000000000000012, -4.000000000000001, -3.600000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -4.200000000000001, -3.8000000000000007, -3.7000000000000006, -3.500000000000001, -10.6, -3.7000000000000006, -3.900000000000001, -3.5000000000000004, -10.5, -3.7000000000000006, -3.900000000000001, -3.500000000000001, -3.7000000000000006, -11.0, -3.900000000000001, -3.600000000000001, -3.900000000000001, -3.8000000000000003, -10.5, -3.700000000000001, -3.6000000000000005, -3.8000000000000003, -10.9, -11.5, -3.7000000000000006, -12.3, -12.600000000000001, -3.900000000000001, -3.900000000000001, -3.800000000000001, -3.900000000000001, -4.0, -3.900000000000001, -4.200000000000001, -3.6000000000000005, -3.8000000000000007, -11.0, -3.6000000000000005, -3.800000000000001, -3.800000000000001, -4.200000000000001, -3.800000000000001, -11.4, -10.0, -3.9000000000000012, -3.7000000000000006, -3.900000000000001, -4.0, -4.100000000000001, -3.9000000000000012, -3.700000000000001, -3.6000000000000005, -3.9000000000000017, -12.1, -3.8000000000000007, -3.700000000000001, -12.1, -10.4, -3.400000000000001, -4.000000000000002, -10.5, -3.8000000000000007, -3.6000000000000005, -3.600000000000001, -3.7000000000000006, -3.700000000000001, -3.8000000000000007, -4.000000000000001, -3.9000000000000012, -3.6, -10.3, -3.6000000000000005, -3.600000000000001, -3.900000000000001, -3.600000000000001, -3.600000000000001, -10.5, -3.7000000000000006, -3.600000000000001, -3.7000000000000006, -11.0, -3.8000000000000007, -4.000000000000001, -3.7000000000000015, -4.000000000000001, -3.600000000000001, -4.100000000000001, -3.7000000000000006, -3.600000000000001, -3.7000000000000006, -3.7000000000000006, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -3.700000000000001, -3.5000000000000004, -3.800000000000001, -4.000000000000001, -10.8, -3.800000000000001, -10.6, -4.000000000000001, -3.8000000000000003, -10.4, -3.7000000000000006, -11.8, -3.600000000000001, -3.7000000000000006, -10.8, -3.800000000000001, -3.400000000000001, -10.7, -3.800000000000001, -3.400000000000001, -4.200000000000001, -11.2, -3.500000000000001, -3.900000000000001, -3.700000000000001, -3.600000000000001, -3.800000000000001, -3.6000000000000005, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -11.0, -3.800000000000001, -10.9, -3.600000000000001, -3.900000000000001, -3.8000000000000003, -3.8000000000000007, -3.600000000000001, -3.700000000000001, -10.2, -11.0, -3.9000000000000012, -11.9, -3.8000000000000007, -3.6000000000000005, -3.700000000000001, -3.8000000000000003, -3.9000000000000004, -3.7000000000000006, -3.9000000000000012, -10.3, -4.100000000000001, -3.800000000000001, -3.8000000000000007, -4.300000000000002, -3.7000000000000006, -3.8000000000000007, -4.000000000000002, -4.000000000000001, -3.8000000000000007, -10.4], "episode_lengths": [16, 21, 8, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 1, 21, 21, 21, 2, 21, 21, 21, 1, 12, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 5, 21, 21, 21, 21, 10, 21, 21, 21, 21, 5, 21, 21, 21, 9, 14, 21, 20, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 12, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 15, 5, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 6, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 7, 21, 21, 5, 21, 16, 21, 21, 8, 21, 21, 8, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 9, 21, 21, 21, 21, 21, 21, 3, 9, 21, 16, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.744128092455577, "mean_inference_ms": 18.571114082662206, "mean_action_processing_ms": 0.9873899241218248, "mean_env_wait_ms": 1.8683381677579332, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08449993924611175, "StateBufferConnector_ms": 0.011246435103877898, "ViewRequirementAgentConnector_ms": 0.1541704626127322}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 170965.584, "load_time_ms": 1.134, "load_throughput": 3528405.645, "learn_time_ms": 169965.383, "learn_throughput": 23.534, "synch_weights_time_ms": 186.198}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 3789, "training_iteration": 18, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-06_21-46-51", "timestamp": 1680810411, "time_this_iter_s": 170.94701480865479, "time_total_s": 3077.332847595215, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476b93d0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014772e310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 3077.332847595215, "timesteps_since_restore": 0, "iterations_since_restore": 18, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.709876543209877, "ram_util_percent": 23.544855967078192}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.251050750158166, "cur_kl_coeff": 19.46195068359375, "cur_lr": 0.01, "total_loss": 1.2589756254787727, "policy_loss": 0.003049383973402362, "vf_loss": 0.9808427282759259, "vf_explained_var": 0.3006299896265871, "kl": 0.014134426615376186, "entropy": 3.333900334245415, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 17205.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "sampler_results": {"episode_reward_max": -3.3000000000000003, "episode_reward_min": -12.8, "episode_reward_mean": -5.650442477876106, "episode_len_mean": 17.557522123893804, "episode_media": {}, "episodes_this_iter": 226, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.8000000000000007, -3.8000000000000007, -3.5000000000000004, -3.600000000000001, -4.100000000000001, -3.7000000000000006, -3.5000000000000004, -3.5000000000000004, -3.8000000000000007, -3.8000000000000007, -10.6, -3.500000000000001, -3.3000000000000003, -10.3, -3.800000000000001, -3.9000000000000012, -3.8000000000000007, -3.800000000000001, -3.7000000000000006, -10.9, -10.1, -10.1, -4.100000000000001, -10.2, -10.0, -10.1, -3.500000000000001, -11.0, -3.600000000000001, -10.5, -10.2, -3.8000000000000007, -3.800000000000001, -3.5000000000000004, -3.8000000000000007, -3.600000000000001, -3.9000000000000012, -11.2, -3.900000000000001, -3.8000000000000007, -3.600000000000001, -3.8000000000000007, -10.9, -10.6, -4.000000000000001, -10.4, -3.500000000000001, -3.700000000000001, -3.8000000000000007, -3.6000000000000005, -3.700000000000001, -3.900000000000001, -3.700000000000001, -3.900000000000001, -12.600000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.9000000000000012, -3.8000000000000007, -3.9000000000000012, -3.9000000000000012, -3.8000000000000007, -3.5000000000000004, -3.900000000000001, -3.7000000000000006, -3.8000000000000003, -10.3, -4.0, -3.6000000000000005, -3.600000000000001, -10.2, -3.700000000000001, -3.8000000000000007, -4.000000000000001, -4.1000000000000005, -11.5, -3.800000000000001, -3.900000000000001, -3.5000000000000004, -3.6000000000000005, -3.7000000000000006, -11.0, -3.700000000000001, -12.100000000000001, -10.7, -12.700000000000001, -3.9000000000000012, -3.600000000000001, -4.000000000000001, -4.000000000000002, -11.200000000000001, -3.8000000000000007, -3.5000000000000004, -3.400000000000001, -10.3, -3.7000000000000015, -3.800000000000001, -11.6, -3.600000000000001, -10.9, -3.5000000000000004, -3.700000000000001, -3.8000000000000003, -3.7000000000000006, -11.5, -11.4, -3.600000000000001, -3.800000000000001, -3.600000000000001, -3.6000000000000005, -3.700000000000001, -3.7000000000000006, -4.000000000000001, -10.1, -10.3, -3.900000000000001, -4.000000000000001, -11.1, -3.600000000000001, -11.2, -3.900000000000001, -3.900000000000001, -4.100000000000001, -10.3, -10.0, -3.700000000000001, -10.1, -11.4, -3.4000000000000004, -3.700000000000001, -3.7000000000000006, -11.8, -3.7000000000000006, -3.900000000000001, -3.7000000000000006, -3.7000000000000006, -3.900000000000001, -3.500000000000001, -3.7000000000000006, -3.8000000000000007, -10.3, -3.700000000000001, -12.8, -3.6000000000000005, -3.7000000000000006, -11.5, -3.7, -10.9, -3.800000000000001, -3.8000000000000007, -3.6000000000000005, -3.600000000000001, -3.700000000000001, -3.6000000000000005, -3.9000000000000012, -3.900000000000001, -3.700000000000001, -3.5000000000000004, -3.800000000000001, -3.800000000000001, -3.8000000000000007, -3.8000000000000007, -12.700000000000001, -3.9000000000000012, -3.8000000000000007, -3.600000000000001, -4.100000000000001, -3.7000000000000006, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -3.5000000000000004, -4.100000000000001, -3.500000000000001, -10.0, -3.900000000000001, -10.6, -3.9000000000000004, -3.8000000000000007, -3.9000000000000012, -10.4, -10.6, -3.6000000000000005, -3.4000000000000004, -4.100000000000001, -3.5000000000000004, -12.0, -3.700000000000001, -4.1000000000000005, -11.2, -11.0, -3.7000000000000006, -10.7, -3.900000000000001, -3.700000000000001, -11.2, -10.3, -10.4, -10.2, -10.5, -3.6000000000000005, -10.2, -3.7000000000000006, -3.9000000000000004, -4.1000000000000005, -3.500000000000001, -11.3, -4.100000000000001, -3.800000000000001, -3.800000000000001, -3.6000000000000005, -3.800000000000001, -11.7, -3.700000000000001, -3.500000000000001, -11.0, -3.6000000000000005, -4.100000000000001, -3.800000000000001, -3.900000000000001, -4.100000000000001, -3.800000000000001, -3.800000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 3, 21, 21, 21, 21, 21, 8, 2, 2, 21, 3, 1, 2, 21, 8, 21, 5, 3, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 9, 5, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 3, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 9, 21, 16, 7, 20, 21, 21, 21, 21, 11, 21, 21, 21, 4, 21, 21, 13, 21, 10, 21, 21, 21, 21, 13, 12, 21, 21, 21, 21, 21, 21, 21, 2, 4, 21, 21, 10, 21, 12, 21, 21, 21, 3, 1, 21, 2, 13, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 20, 21, 21, 12, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21, 7, 21, 21, 21, 5, 7, 21, 21, 21, 21, 18, 21, 21, 11, 8, 21, 7, 21, 21, 11, 4, 4, 3, 6, 21, 3, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 15, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.732126805379886, "mean_inference_ms": 18.556550075580716, "mean_action_processing_ms": 0.981507322263422, "mean_env_wait_ms": 1.858460386214798, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07146734051999792, "StateBufferConnector_ms": 0.009649833746715984, "ViewRequirementAgentConnector_ms": 0.13015027594777334}}, "episode_reward_max": -3.3000000000000003, "episode_reward_min": -12.8, "episode_reward_mean": -5.650442477876106, "episode_len_mean": 17.557522123893804, "episodes_this_iter": 226, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.8000000000000007, -3.8000000000000007, -3.5000000000000004, -3.600000000000001, -4.100000000000001, -3.7000000000000006, -3.5000000000000004, -3.5000000000000004, -3.8000000000000007, -3.8000000000000007, -10.6, -3.500000000000001, -3.3000000000000003, -10.3, -3.800000000000001, -3.9000000000000012, -3.8000000000000007, -3.800000000000001, -3.7000000000000006, -10.9, -10.1, -10.1, -4.100000000000001, -10.2, -10.0, -10.1, -3.500000000000001, -11.0, -3.600000000000001, -10.5, -10.2, -3.8000000000000007, -3.800000000000001, -3.5000000000000004, -3.8000000000000007, -3.600000000000001, -3.9000000000000012, -11.2, -3.900000000000001, -3.8000000000000007, -3.600000000000001, -3.8000000000000007, -10.9, -10.6, -4.000000000000001, -10.4, -3.500000000000001, -3.700000000000001, -3.8000000000000007, -3.6000000000000005, -3.700000000000001, -3.900000000000001, -3.700000000000001, -3.900000000000001, -12.600000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.9000000000000012, -3.8000000000000007, -3.9000000000000012, -3.9000000000000012, -3.8000000000000007, -3.5000000000000004, -3.900000000000001, -3.7000000000000006, -3.8000000000000003, -10.3, -4.0, -3.6000000000000005, -3.600000000000001, -10.2, -3.700000000000001, -3.8000000000000007, -4.000000000000001, -4.1000000000000005, -11.5, -3.800000000000001, -3.900000000000001, -3.5000000000000004, -3.6000000000000005, -3.7000000000000006, -11.0, -3.700000000000001, -12.100000000000001, -10.7, -12.700000000000001, -3.9000000000000012, -3.600000000000001, -4.000000000000001, -4.000000000000002, -11.200000000000001, -3.8000000000000007, -3.5000000000000004, -3.400000000000001, -10.3, -3.7000000000000015, -3.800000000000001, -11.6, -3.600000000000001, -10.9, -3.5000000000000004, -3.700000000000001, -3.8000000000000003, -3.7000000000000006, -11.5, -11.4, -3.600000000000001, -3.800000000000001, -3.600000000000001, -3.6000000000000005, -3.700000000000001, -3.7000000000000006, -4.000000000000001, -10.1, -10.3, -3.900000000000001, -4.000000000000001, -11.1, -3.600000000000001, -11.2, -3.900000000000001, -3.900000000000001, -4.100000000000001, -10.3, -10.0, -3.700000000000001, -10.1, -11.4, -3.4000000000000004, -3.700000000000001, -3.7000000000000006, -11.8, -3.7000000000000006, -3.900000000000001, -3.7000000000000006, -3.7000000000000006, -3.900000000000001, -3.500000000000001, -3.7000000000000006, -3.8000000000000007, -10.3, -3.700000000000001, -12.8, -3.6000000000000005, -3.7000000000000006, -11.5, -3.7, -10.9, -3.800000000000001, -3.8000000000000007, -3.6000000000000005, -3.600000000000001, -3.700000000000001, -3.6000000000000005, -3.9000000000000012, -3.900000000000001, -3.700000000000001, -3.5000000000000004, -3.800000000000001, -3.800000000000001, -3.8000000000000007, -3.8000000000000007, -12.700000000000001, -3.9000000000000012, -3.8000000000000007, -3.600000000000001, -4.100000000000001, -3.7000000000000006, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -3.5000000000000004, -4.100000000000001, -3.500000000000001, -10.0, -3.900000000000001, -10.6, -3.9000000000000004, -3.8000000000000007, -3.9000000000000012, -10.4, -10.6, -3.6000000000000005, -3.4000000000000004, -4.100000000000001, -3.5000000000000004, -12.0, -3.700000000000001, -4.1000000000000005, -11.2, -11.0, -3.7000000000000006, -10.7, -3.900000000000001, -3.700000000000001, -11.2, -10.3, -10.4, -10.2, -10.5, -3.6000000000000005, -10.2, -3.7000000000000006, -3.9000000000000004, -4.1000000000000005, -3.500000000000001, -11.3, -4.100000000000001, -3.800000000000001, -3.800000000000001, -3.6000000000000005, -3.800000000000001, -11.7, -3.700000000000001, -3.500000000000001, -11.0, -3.6000000000000005, -4.100000000000001, -3.800000000000001, -3.900000000000001, -4.100000000000001, -3.800000000000001, -3.800000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 3, 21, 21, 21, 21, 21, 8, 2, 2, 21, 3, 1, 2, 21, 8, 21, 5, 3, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 9, 5, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 3, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 9, 21, 16, 7, 20, 21, 21, 21, 21, 11, 21, 21, 21, 4, 21, 21, 13, 21, 10, 21, 21, 21, 21, 13, 12, 21, 21, 21, 21, 21, 21, 21, 2, 4, 21, 21, 10, 21, 12, 21, 21, 21, 3, 1, 21, 2, 13, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 20, 21, 21, 12, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21, 7, 21, 21, 21, 5, 7, 21, 21, 21, 21, 18, 21, 21, 11, 8, 21, 7, 21, 21, 11, 4, 4, 3, 6, 21, 3, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 15, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.732126805379886, "mean_inference_ms": 18.556550075580716, "mean_action_processing_ms": 0.981507322263422, "mean_env_wait_ms": 1.858460386214798, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07146734051999792, "StateBufferConnector_ms": 0.009649833746715984, "ViewRequirementAgentConnector_ms": 0.13015027594777334}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 170996.821, "load_time_ms": 1.127, "load_throughput": 3548405.491, "learn_time_ms": 169997.347, "learn_throughput": 23.53, "synch_weights_time_ms": 186.501}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "episodes_total": 4015, "training_iteration": 19, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-06_21-49-42", "timestamp": 1680810582, "time_this_iter_s": 170.91390371322632, "time_total_s": 3248.246751308441, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476f2a60>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014764b670>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 3248.246751308441, "timesteps_since_restore": 0, "iterations_since_restore": 19, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.477777777777779, "ram_util_percent": 23.52716049382716}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.930805292308971, "cur_kl_coeff": 19.46195068359375, "cur_lr": 0.01, "total_loss": 1.1717176598967403, "policy_loss": -0.0002557397707395496, "vf_loss": 0.7241212648249442, "vf_explained_var": 0.4453835439938371, "kl": 0.0230116779411835, "entropy": 3.315853242720327, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 18135.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "sampler_results": {"episode_reward_max": 99.0, "episode_reward_min": -12.8, "episode_reward_mean": -4.00952380952381, "episode_len_mean": 19.10952380952381, "episode_media": {}, "episodes_this_iter": 210, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.500000000000001, -3.900000000000001, -3.7000000000000006, -12.600000000000001, -3.500000000000001, -10.8, -3.700000000000001, -3.8000000000000007, -3.400000000000001, -3.800000000000001, -10.8, -11.7, -3.6000000000000005, -3.8000000000000007, -10.9, -10.1, -3.700000000000001, -3.700000000000001, -3.600000000000001, -10.7, -10.3, -10.3, -3.8000000000000003, -4.000000000000001, -3.7000000000000006, 98.2, -12.600000000000001, -3.800000000000001, -3.7000000000000006, -4.000000000000001, -3.7000000000000006, -11.2, -3.9000000000000012, -10.6, -3.8000000000000007, -4.000000000000001, -11.0, -3.600000000000001, -10.3, -10.4, -3.600000000000001, -3.600000000000001, -3.9000000000000012, -3.6000000000000005, -3.800000000000001, -3.6000000000000005, -4.000000000000002, -4.200000000000001, -3.7000000000000006, -3.600000000000001, -3.700000000000001, -3.8000000000000007, -3.7000000000000006, -3.6000000000000005, -11.0, -4.000000000000001, -3.7000000000000006, -3.700000000000001, -3.900000000000001, -3.8000000000000007, -11.0, -11.4, -3.7000000000000006, -3.8000000000000007, -3.6000000000000005, -4.000000000000001, -4.000000000000001, -3.500000000000001, -3.900000000000001, -3.8000000000000007, -3.600000000000001, -3.6000000000000005, -3.8000000000000007, -3.400000000000001, -4.100000000000001, -11.2, -3.8000000000000007, -4.000000000000001, -3.700000000000001, -4.100000000000001, -4.0, -3.900000000000001, -3.6000000000000005, -4.000000000000001, -3.8000000000000003, -12.8, -3.700000000000001, -3.9000000000000012, -3.7000000000000006, -3.9000000000000012, -3.400000000000001, -3.8000000000000007, -3.6000000000000005, -3.600000000000001, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -3.800000000000001, -3.6000000000000005, -3.7000000000000006, -3.700000000000001, -4.000000000000002, -3.900000000000001, -4.100000000000001, -4.000000000000002, -3.4000000000000012, -4.000000000000001, -12.200000000000001, -3.7000000000000006, -3.7000000000000006, -12.4, -10.1, -3.7000000000000006, -3.500000000000001, -10.2, -10.7, -3.600000000000001, -3.6000000000000005, -11.0, -3.900000000000001, -11.6, -3.900000000000001, -3.900000000000001, -3.700000000000001, -3.900000000000001, -3.7000000000000006, -3.600000000000001, -3.8000000000000007, -3.5000000000000004, -3.600000000000001, -3.8000000000000003, -11.9, -3.9000000000000012, -3.6000000000000005, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -3.6000000000000005, -3.900000000000001, -3.9000000000000012, -4.000000000000001, -3.9000000000000012, -3.9000000000000004, -3.900000000000001, -3.800000000000001, -3.7000000000000006, -3.500000000000001, -10.7, -3.7000000000000006, -3.7000000000000006, -3.900000000000001, -3.9000000000000004, -3.4000000000000004, -3.8000000000000007, -3.9000000000000012, -4.000000000000001, -3.900000000000001, -3.600000000000001, -10.6, -3.800000000000001, -3.800000000000001, -11.9, -3.800000000000001, -4.000000000000002, -4.100000000000001, -4.000000000000001, -4.000000000000001, -3.600000000000001, -3.800000000000001, -3.9000000000000012, -3.900000000000001, -4.100000000000001, -4.000000000000002, -10.0, -3.8000000000000007, -3.7000000000000006, -12.1, -3.9000000000000012, -4.200000000000001, -3.9000000000000004, -3.600000000000001, -3.9000000000000012, -3.700000000000001, -3.8000000000000007, -3.700000000000001, -3.900000000000001, -4.200000000000001, -3.9000000000000012, -3.600000000000001, -3.700000000000001, -3.800000000000001, -3.600000000000001, -4.000000000000001, -3.8000000000000007, -3.800000000000001, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, 99.0, -3.6000000000000005, -3.9000000000000012, -4.000000000000001, -4.200000000000001, -3.700000000000001, -3.9000000000000004, -3.8000000000000007, -12.2], "episode_lengths": [21, 21, 21, 20, 21, 9, 21, 21, 21, 21, 7, 13, 21, 21, 8, 2, 21, 21, 21, 7, 4, 4, 21, 21, 21, 15, 20, 21, 21, 21, 21, 9, 21, 7, 21, 21, 10, 21, 4, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 8, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 17, 2, 21, 21, 2, 7, 21, 21, 8, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 18]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.709306423036407, "mean_inference_ms": 18.595130156768555, "mean_action_processing_ms": 0.9847667491601633, "mean_env_wait_ms": 1.8579430399506158, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07870265415736608, "StateBufferConnector_ms": 0.010217825571695963, "ViewRequirementAgentConnector_ms": 0.14306431724911645}}, "episode_reward_max": 99.0, "episode_reward_min": -12.8, "episode_reward_mean": -4.00952380952381, "episode_len_mean": 19.10952380952381, "episodes_this_iter": 210, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.500000000000001, -3.900000000000001, -3.7000000000000006, -12.600000000000001, -3.500000000000001, -10.8, -3.700000000000001, -3.8000000000000007, -3.400000000000001, -3.800000000000001, -10.8, -11.7, -3.6000000000000005, -3.8000000000000007, -10.9, -10.1, -3.700000000000001, -3.700000000000001, -3.600000000000001, -10.7, -10.3, -10.3, -3.8000000000000003, -4.000000000000001, -3.7000000000000006, 98.2, -12.600000000000001, -3.800000000000001, -3.7000000000000006, -4.000000000000001, -3.7000000000000006, -11.2, -3.9000000000000012, -10.6, -3.8000000000000007, -4.000000000000001, -11.0, -3.600000000000001, -10.3, -10.4, -3.600000000000001, -3.600000000000001, -3.9000000000000012, -3.6000000000000005, -3.800000000000001, -3.6000000000000005, -4.000000000000002, -4.200000000000001, -3.7000000000000006, -3.600000000000001, -3.700000000000001, -3.8000000000000007, -3.7000000000000006, -3.6000000000000005, -11.0, -4.000000000000001, -3.7000000000000006, -3.700000000000001, -3.900000000000001, -3.8000000000000007, -11.0, -11.4, -3.7000000000000006, -3.8000000000000007, -3.6000000000000005, -4.000000000000001, -4.000000000000001, -3.500000000000001, -3.900000000000001, -3.8000000000000007, -3.600000000000001, -3.6000000000000005, -3.8000000000000007, -3.400000000000001, -4.100000000000001, -11.2, -3.8000000000000007, -4.000000000000001, -3.700000000000001, -4.100000000000001, -4.0, -3.900000000000001, -3.6000000000000005, -4.000000000000001, -3.8000000000000003, -12.8, -3.700000000000001, -3.9000000000000012, -3.7000000000000006, -3.9000000000000012, -3.400000000000001, -3.8000000000000007, -3.6000000000000005, -3.600000000000001, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -3.800000000000001, -3.6000000000000005, -3.7000000000000006, -3.700000000000001, -4.000000000000002, -3.900000000000001, -4.100000000000001, -4.000000000000002, -3.4000000000000012, -4.000000000000001, -12.200000000000001, -3.7000000000000006, -3.7000000000000006, -12.4, -10.1, -3.7000000000000006, -3.500000000000001, -10.2, -10.7, -3.600000000000001, -3.6000000000000005, -11.0, -3.900000000000001, -11.6, -3.900000000000001, -3.900000000000001, -3.700000000000001, -3.900000000000001, -3.7000000000000006, -3.600000000000001, -3.8000000000000007, -3.5000000000000004, -3.600000000000001, -3.8000000000000003, -11.9, -3.9000000000000012, -3.6000000000000005, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -3.6000000000000005, -3.900000000000001, -3.9000000000000012, -4.000000000000001, -3.9000000000000012, -3.9000000000000004, -3.900000000000001, -3.800000000000001, -3.7000000000000006, -3.500000000000001, -10.7, -3.7000000000000006, -3.7000000000000006, -3.900000000000001, -3.9000000000000004, -3.4000000000000004, -3.8000000000000007, -3.9000000000000012, -4.000000000000001, -3.900000000000001, -3.600000000000001, -10.6, -3.800000000000001, -3.800000000000001, -11.9, -3.800000000000001, -4.000000000000002, -4.100000000000001, -4.000000000000001, -4.000000000000001, -3.600000000000001, -3.800000000000001, -3.9000000000000012, -3.900000000000001, -4.100000000000001, -4.000000000000002, -10.0, -3.8000000000000007, -3.7000000000000006, -12.1, -3.9000000000000012, -4.200000000000001, -3.9000000000000004, -3.600000000000001, -3.9000000000000012, -3.700000000000001, -3.8000000000000007, -3.700000000000001, -3.900000000000001, -4.200000000000001, -3.9000000000000012, -3.600000000000001, -3.700000000000001, -3.800000000000001, -3.600000000000001, -4.000000000000001, -3.8000000000000007, -3.800000000000001, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, 99.0, -3.6000000000000005, -3.9000000000000012, -4.000000000000001, -4.200000000000001, -3.700000000000001, -3.9000000000000004, -3.8000000000000007, -12.2], "episode_lengths": [21, 21, 21, 20, 21, 9, 21, 21, 21, 21, 7, 13, 21, 21, 8, 2, 21, 21, 21, 7, 4, 4, 21, 21, 21, 15, 20, 21, 21, 21, 21, 9, 21, 7, 21, 21, 10, 21, 4, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 8, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 17, 2, 21, 21, 2, 7, 21, 21, 8, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 18]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.709306423036407, "mean_inference_ms": 18.595130156768555, "mean_action_processing_ms": 0.9847667491601633, "mean_env_wait_ms": 1.8579430399506158, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07870265415736608, "StateBufferConnector_ms": 0.010217825571695963, "ViewRequirementAgentConnector_ms": 0.14306431724911645}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 171016.673, "load_time_ms": 1.166, "load_throughput": 3431976.271, "learn_time_ms": 170025.55, "learn_throughput": 23.526, "synch_weights_time_ms": 184.759}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "episodes_total": 4225, "training_iteration": 20, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-06_21-52-33", "timestamp": 1680810753, "time_this_iter_s": 171.25270867347717, "time_total_s": 3419.4994599819183, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01477917f0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014784a5e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 3419.4994599819183, "timesteps_since_restore": 0, "iterations_since_restore": 20, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.445679012345678, "ram_util_percent": 23.53292181069959}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.04568491443511, "cur_kl_coeff": 29.192926025390634, "cur_lr": 0.01, "total_loss": 10.751181783465048, "policy_loss": 0.018252283069355193, "vf_loss": 0.924202995835453, "vf_explained_var": 0.40842151449572656, "kl": 0.3359966853451233, "entropy": 3.24030455171421, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 19065.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "sampler_results": {"episode_reward_max": -3.2000000000000006, "episode_reward_min": -12.600000000000001, "episode_reward_mean": -5.48169014084507, "episode_len_mean": 18.225352112676056, "episode_media": {}, "episodes_this_iter": 213, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.4, -11.4, -3.2000000000000006, -3.7000000000000006, -3.500000000000001, -3.8000000000000007, -3.7000000000000006, -3.900000000000001, -4.000000000000002, -3.7, -3.7000000000000006, -3.900000000000001, -11.1, -10.3, -12.600000000000001, -10.1, -3.8000000000000007, -10.3, -10.6, -10.3, -11.3, -3.8000000000000007, -3.7000000000000006, -4.000000000000001, -3.600000000000001, -3.400000000000001, -3.9000000000000012, -3.5000000000000004, -3.8000000000000007, -3.8000000000000007, -3.700000000000001, -3.7000000000000006, -3.6000000000000005, -3.5000000000000004, -3.8000000000000007, -4.400000000000001, -4.000000000000001, -11.3, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.700000000000001, -3.800000000000001, -12.0, -11.1, -3.8000000000000007, -3.600000000000001, -3.6000000000000005, -3.8000000000000007, -3.6000000000000005, -4.000000000000001, -3.6000000000000005, -10.4, -11.1, -11.5, -11.9, -10.0, -10.2, -4.000000000000002, -3.8000000000000007, -10.3, -3.8000000000000007, -4.000000000000001, -4.0, -11.1, -3.700000000000001, -10.4, -3.6000000000000005, -4.000000000000001, -10.3, -10.8, -3.800000000000001, -3.6000000000000005, -3.8000000000000003, -4.000000000000001, -12.3, -10.5, -4.000000000000001, -3.5000000000000004, -3.700000000000001, -3.600000000000001, -11.4, -10.7, -11.1, -10.9, -12.2, -3.700000000000001, -3.6000000000000005, -3.500000000000001, -3.800000000000001, -3.700000000000001, -3.700000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -3.8000000000000007, -3.600000000000001, -3.700000000000001, -11.2, -3.900000000000001, -3.7000000000000006, -3.600000000000001, -3.8000000000000007, -3.5000000000000004, -3.4000000000000004, -4.000000000000001, -4.0, -10.3, -10.9, -3.900000000000001, -3.900000000000001, -3.500000000000001, -3.900000000000001, -10.7, -10.5, -3.6000000000000005, -4.000000000000001, -3.700000000000001, -3.800000000000001, -11.7, -3.700000000000001, -3.9000000000000012, -3.8000000000000007, -3.8000000000000007, -4.0, -3.5000000000000004, -4.000000000000001, -3.800000000000001, -3.8000000000000007, -3.9000000000000004, -3.700000000000001, -12.2, -3.7000000000000006, -3.7000000000000006, -4.100000000000001, -11.9, -3.800000000000001, -3.700000000000001, -12.2, -3.900000000000001, -4.000000000000002, -3.8000000000000007, -3.4000000000000004, -11.5, -3.8000000000000007, -3.7000000000000006, -4.000000000000001, -11.3, -3.900000000000001, -4.100000000000001, -11.5, -3.600000000000001, -3.7000000000000006, -3.500000000000001, -3.700000000000001, -3.8000000000000007, -3.700000000000001, -3.800000000000001, -3.7000000000000006, -3.600000000000001, -3.800000000000001, -3.7000000000000006, -3.900000000000001, -10.1, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.7000000000000006, -11.3, -3.6000000000000005, -3.900000000000001, -4.000000000000001, -3.600000000000001, -3.8000000000000007, -3.9000000000000012, -3.8000000000000007, -3.500000000000001, -3.8000000000000007, -3.800000000000001, -3.9000000000000012, -3.500000000000001, -3.600000000000001, -3.7000000000000006, -3.8000000000000007, -10.5, -11.9, -3.600000000000001, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -3.6000000000000005, -4.200000000000001, -10.4, -3.8000000000000007, -10.5, -11.6, -3.600000000000001, -3.6000000000000005, -3.900000000000001, -4.000000000000001, -3.5000000000000004, -3.8000000000000007, -3.8000000000000007, -3.700000000000001, -3.5000000000000004, -3.6000000000000005, -3.8000000000000007, -3.8000000000000003, -3.6000000000000005], "episode_lengths": [12, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 3, 19, 2, 21, 4, 6, 4, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 16, 11, 21, 21, 21, 21, 21, 21, 21, 5, 10, 13, 13, 1, 3, 21, 21, 4, 21, 21, 21, 9, 21, 4, 21, 21, 4, 8, 21, 21, 21, 21, 17, 6, 21, 21, 21, 21, 11, 8, 10, 9, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 4, 8, 21, 21, 21, 21, 7, 6, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 15, 21, 21, 17, 21, 21, 21, 21, 13, 21, 21, 21, 10, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 14, 21, 21, 21, 21, 21, 21, 21, 5, 21, 5, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.693540193194593, "mean_inference_ms": 18.559253952398, "mean_action_processing_ms": 0.9864100463607864, "mean_env_wait_ms": 1.8550988634075103, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0805470865097404, "StateBufferConnector_ms": 0.010168048697458187, "ViewRequirementAgentConnector_ms": 0.14618159459790153}}, "episode_reward_max": -3.2000000000000006, "episode_reward_min": -12.600000000000001, "episode_reward_mean": -5.48169014084507, "episode_len_mean": 18.225352112676056, "episodes_this_iter": 213, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11.4, -11.4, -3.2000000000000006, -3.7000000000000006, -3.500000000000001, -3.8000000000000007, -3.7000000000000006, -3.900000000000001, -4.000000000000002, -3.7, -3.7000000000000006, -3.900000000000001, -11.1, -10.3, -12.600000000000001, -10.1, -3.8000000000000007, -10.3, -10.6, -10.3, -11.3, -3.8000000000000007, -3.7000000000000006, -4.000000000000001, -3.600000000000001, -3.400000000000001, -3.9000000000000012, -3.5000000000000004, -3.8000000000000007, -3.8000000000000007, -3.700000000000001, -3.7000000000000006, -3.6000000000000005, -3.5000000000000004, -3.8000000000000007, -4.400000000000001, -4.000000000000001, -11.3, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.700000000000001, -3.800000000000001, -12.0, -11.1, -3.8000000000000007, -3.600000000000001, -3.6000000000000005, -3.8000000000000007, -3.6000000000000005, -4.000000000000001, -3.6000000000000005, -10.4, -11.1, -11.5, -11.9, -10.0, -10.2, -4.000000000000002, -3.8000000000000007, -10.3, -3.8000000000000007, -4.000000000000001, -4.0, -11.1, -3.700000000000001, -10.4, -3.6000000000000005, -4.000000000000001, -10.3, -10.8, -3.800000000000001, -3.6000000000000005, -3.8000000000000003, -4.000000000000001, -12.3, -10.5, -4.000000000000001, -3.5000000000000004, -3.700000000000001, -3.600000000000001, -11.4, -10.7, -11.1, -10.9, -12.2, -3.700000000000001, -3.6000000000000005, -3.500000000000001, -3.800000000000001, -3.700000000000001, -3.700000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -3.8000000000000007, -3.600000000000001, -3.700000000000001, -11.2, -3.900000000000001, -3.7000000000000006, -3.600000000000001, -3.8000000000000007, -3.5000000000000004, -3.4000000000000004, -4.000000000000001, -4.0, -10.3, -10.9, -3.900000000000001, -3.900000000000001, -3.500000000000001, -3.900000000000001, -10.7, -10.5, -3.6000000000000005, -4.000000000000001, -3.700000000000001, -3.800000000000001, -11.7, -3.700000000000001, -3.9000000000000012, -3.8000000000000007, -3.8000000000000007, -4.0, -3.5000000000000004, -4.000000000000001, -3.800000000000001, -3.8000000000000007, -3.9000000000000004, -3.700000000000001, -12.2, -3.7000000000000006, -3.7000000000000006, -4.100000000000001, -11.9, -3.800000000000001, -3.700000000000001, -12.2, -3.900000000000001, -4.000000000000002, -3.8000000000000007, -3.4000000000000004, -11.5, -3.8000000000000007, -3.7000000000000006, -4.000000000000001, -11.3, -3.900000000000001, -4.100000000000001, -11.5, -3.600000000000001, -3.7000000000000006, -3.500000000000001, -3.700000000000001, -3.8000000000000007, -3.700000000000001, -3.800000000000001, -3.7000000000000006, -3.600000000000001, -3.800000000000001, -3.7000000000000006, -3.900000000000001, -10.1, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.7000000000000006, -11.3, -3.6000000000000005, -3.900000000000001, -4.000000000000001, -3.600000000000001, -3.8000000000000007, -3.9000000000000012, -3.8000000000000007, -3.500000000000001, -3.8000000000000007, -3.800000000000001, -3.9000000000000012, -3.500000000000001, -3.600000000000001, -3.7000000000000006, -3.8000000000000007, -10.5, -11.9, -3.600000000000001, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -3.6000000000000005, -4.200000000000001, -10.4, -3.8000000000000007, -10.5, -11.6, -3.600000000000001, -3.6000000000000005, -3.900000000000001, -4.000000000000001, -3.5000000000000004, -3.8000000000000007, -3.8000000000000007, -3.700000000000001, -3.5000000000000004, -3.6000000000000005, -3.8000000000000007, -3.8000000000000003, -3.6000000000000005], "episode_lengths": [12, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 3, 19, 2, 21, 4, 6, 4, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 16, 11, 21, 21, 21, 21, 21, 21, 21, 5, 10, 13, 13, 1, 3, 21, 21, 4, 21, 21, 21, 9, 21, 4, 21, 21, 4, 8, 21, 21, 21, 21, 17, 6, 21, 21, 21, 21, 11, 8, 10, 9, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 4, 8, 21, 21, 21, 21, 7, 6, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 15, 21, 21, 17, 21, 21, 21, 21, 13, 21, 21, 21, 10, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 14, 21, 21, 21, 21, 21, 21, 21, 5, 21, 5, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.693540193194593, "mean_inference_ms": 18.559253952398, "mean_action_processing_ms": 0.9864100463607864, "mean_env_wait_ms": 1.8550988634075103, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0805470865097404, "StateBufferConnector_ms": 0.010168048697458187, "ViewRequirementAgentConnector_ms": 0.14618159459790153}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 170981.715, "load_time_ms": 1.169, "load_throughput": 3423153.17, "learn_time_ms": 169989.08, "learn_throughput": 23.531, "synch_weights_time_ms": 185.152}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "episodes_total": 4438, "training_iteration": 21, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-06_21-55-24", "timestamp": 1680810924, "time_this_iter_s": 171.18130683898926, "time_total_s": 3590.6807668209076, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01477ae370>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0147643af0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 3590.6807668209076, "timesteps_since_restore": 0, "iterations_since_restore": 21, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.604526748971193, "ram_util_percent": 23.58518518518519}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.979934495238847, "cur_kl_coeff": 43.789389038085936, "cur_lr": 0.01, "total_loss": 1.1993250425930024, "policy_loss": 0.0029522301779398995, "vf_loss": 1.1161136324367216, "vf_explained_var": 0.36690137270958195, "kl": 0.0018328454067491832, "entropy": 3.3058830038193734, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 19995.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "sampler_results": {"episode_reward_max": -3.3000000000000007, "episode_reward_min": -13.0, "episode_reward_mean": -5.593362831858409, "episode_len_mean": 17.858407079646017, "episode_media": {}, "episodes_this_iter": 226, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.800000000000001, -3.7000000000000006, -3.7000000000000006, -3.6000000000000005, -3.6000000000000005, -3.700000000000001, -3.800000000000001, -3.6, -3.6000000000000014, -3.6000000000000005, -3.8000000000000007, -10.5, -3.600000000000001, -10.5, -10.0, -10.9, -10.2, -10.3, -3.6000000000000005, -10.3, -3.900000000000001, -10.3, -3.8000000000000003, -3.7000000000000006, -11.8, -10.1, -10.1, -10.6, -10.1, -11.3, -3.600000000000001, -3.8000000000000007, -3.9000000000000012, -4.000000000000002, -3.900000000000001, -3.900000000000001, -3.400000000000001, -3.7000000000000006, -3.900000000000001, -3.8000000000000007, -3.7000000000000006, -3.8000000000000007, -3.600000000000001, -3.700000000000001, -3.800000000000001, -11.1, -11.4, -10.2, -3.9000000000000012, -3.600000000000001, -3.8000000000000007, -3.6000000000000005, -3.6000000000000005, -3.700000000000001, -3.700000000000001, -3.3000000000000007, -3.600000000000001, -11.7, -3.8000000000000007, -11.4, -3.8000000000000007, -4.200000000000001, -3.8000000000000007, -11.2, -3.8000000000000007, -3.7000000000000006, -4.100000000000001, -10.4, -11.1, -10.0, -3.900000000000001, -3.6000000000000005, -3.700000000000001, -3.8000000000000007, -3.600000000000001, -3.700000000000001, -3.8000000000000007, -3.8000000000000007, -3.9000000000000012, -4.000000000000001, -11.7, -3.7000000000000006, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.800000000000001, -4.000000000000001, -11.2, -4.000000000000001, -3.900000000000001, -3.7000000000000006, -12.3, -3.900000000000001, -3.900000000000001, -3.500000000000001, -3.6000000000000005, -3.9000000000000012, -3.8000000000000007, -3.6000000000000005, -3.6000000000000005, -3.700000000000001, -3.7000000000000006, -3.7000000000000006, -3.7000000000000006, -11.0, -11.1, -3.7000000000000006, -10.3, -3.7000000000000006, -3.900000000000001, -3.9000000000000012, -3.600000000000001, -10.7, -11.0, -4.000000000000001, -3.800000000000001, -3.7000000000000006, -3.800000000000001, -3.900000000000001, -11.5, -3.900000000000001, -11.1, -11.3, -10.0, -3.900000000000001, -10.8, -4.000000000000002, -10.0, -3.800000000000001, -10.0, -11.0, -3.500000000000001, -3.8000000000000003, -11.8, -3.6000000000000005, -3.8000000000000007, -12.4, -4.000000000000001, -12.0, -3.6000000000000005, -3.800000000000001, -3.700000000000001, -3.700000000000001, -12.2, -3.900000000000001, -3.800000000000001, -3.700000000000001, -3.600000000000001, -3.6000000000000005, -10.2, -3.9000000000000012, -3.7000000000000006, -3.900000000000001, -3.600000000000001, -3.5000000000000004, -3.500000000000001, -3.9000000000000012, -3.500000000000001, -3.700000000000001, -3.400000000000001, -3.7, -11.0, -3.500000000000001, -3.9000000000000012, -4.000000000000002, -3.700000000000001, -3.700000000000001, -3.5000000000000004, -3.900000000000001, -4.000000000000002, -3.9000000000000004, -3.700000000000001, -4.000000000000001, -3.4000000000000004, -3.700000000000001, -12.700000000000001, -10.1, -4.000000000000001, -10.4, -3.6000000000000005, -10.9, -3.9000000000000012, -3.6000000000000005, -3.900000000000001, -3.8000000000000007, -3.800000000000001, -3.6000000000000005, -3.8000000000000007, -3.8000000000000003, -4.000000000000001, -4.1000000000000005, -3.9000000000000012, -3.8000000000000007, -3.9000000000000012, -3.7000000000000006, -10.5, -4.100000000000001, -3.9000000000000012, -13.0, -4.000000000000001, -3.5000000000000004, -3.600000000000001, -11.2, -4.100000000000001, -3.800000000000001, -3.9000000000000012, -3.800000000000001, -4.000000000000001, -4.100000000000001, -3.800000000000001, -3.700000000000001, -11.1, -10.9, -3.900000000000001, -4.000000000000001, -4.000000000000001, -12.8, -10.2, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.6000000000000005, -3.6000000000000005, -11.7], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 5, 1, 7, 3, 4, 21, 4, 21, 4, 21, 21, 13, 2, 2, 5, 2, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 11, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 13, 21, 21, 21, 11, 21, 21, 21, 4, 11, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 10, 21, 4, 21, 21, 21, 21, 7, 10, 21, 21, 21, 21, 21, 14, 21, 11, 12, 1, 21, 9, 21, 1, 21, 1, 8, 21, 21, 15, 21, 21, 20, 21, 15, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 2, 21, 4, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 20, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 9, 9, 21, 21, 21, 20, 3, 21, 21, 21, 21, 21, 21, 14]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.694981915332685, "mean_inference_ms": 18.590488188496355, "mean_action_processing_ms": 0.9851052606878239, "mean_env_wait_ms": 1.8523100963829298, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0810594685309756, "StateBufferConnector_ms": 0.010687376545593801, "ViewRequirementAgentConnector_ms": 0.15011719897785017}}, "episode_reward_max": -3.3000000000000007, "episode_reward_min": -13.0, "episode_reward_mean": -5.593362831858409, "episode_len_mean": 17.858407079646017, "episodes_this_iter": 226, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.800000000000001, -3.7000000000000006, -3.7000000000000006, -3.6000000000000005, -3.6000000000000005, -3.700000000000001, -3.800000000000001, -3.6, -3.6000000000000014, -3.6000000000000005, -3.8000000000000007, -10.5, -3.600000000000001, -10.5, -10.0, -10.9, -10.2, -10.3, -3.6000000000000005, -10.3, -3.900000000000001, -10.3, -3.8000000000000003, -3.7000000000000006, -11.8, -10.1, -10.1, -10.6, -10.1, -11.3, -3.600000000000001, -3.8000000000000007, -3.9000000000000012, -4.000000000000002, -3.900000000000001, -3.900000000000001, -3.400000000000001, -3.7000000000000006, -3.900000000000001, -3.8000000000000007, -3.7000000000000006, -3.8000000000000007, -3.600000000000001, -3.700000000000001, -3.800000000000001, -11.1, -11.4, -10.2, -3.9000000000000012, -3.600000000000001, -3.8000000000000007, -3.6000000000000005, -3.6000000000000005, -3.700000000000001, -3.700000000000001, -3.3000000000000007, -3.600000000000001, -11.7, -3.8000000000000007, -11.4, -3.8000000000000007, -4.200000000000001, -3.8000000000000007, -11.2, -3.8000000000000007, -3.7000000000000006, -4.100000000000001, -10.4, -11.1, -10.0, -3.900000000000001, -3.6000000000000005, -3.700000000000001, -3.8000000000000007, -3.600000000000001, -3.700000000000001, -3.8000000000000007, -3.8000000000000007, -3.9000000000000012, -4.000000000000001, -11.7, -3.7000000000000006, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.800000000000001, -4.000000000000001, -11.2, -4.000000000000001, -3.900000000000001, -3.7000000000000006, -12.3, -3.900000000000001, -3.900000000000001, -3.500000000000001, -3.6000000000000005, -3.9000000000000012, -3.8000000000000007, -3.6000000000000005, -3.6000000000000005, -3.700000000000001, -3.7000000000000006, -3.7000000000000006, -3.7000000000000006, -11.0, -11.1, -3.7000000000000006, -10.3, -3.7000000000000006, -3.900000000000001, -3.9000000000000012, -3.600000000000001, -10.7, -11.0, -4.000000000000001, -3.800000000000001, -3.7000000000000006, -3.800000000000001, -3.900000000000001, -11.5, -3.900000000000001, -11.1, -11.3, -10.0, -3.900000000000001, -10.8, -4.000000000000002, -10.0, -3.800000000000001, -10.0, -11.0, -3.500000000000001, -3.8000000000000003, -11.8, -3.6000000000000005, -3.8000000000000007, -12.4, -4.000000000000001, -12.0, -3.6000000000000005, -3.800000000000001, -3.700000000000001, -3.700000000000001, -12.2, -3.900000000000001, -3.800000000000001, -3.700000000000001, -3.600000000000001, -3.6000000000000005, -10.2, -3.9000000000000012, -3.7000000000000006, -3.900000000000001, -3.600000000000001, -3.5000000000000004, -3.500000000000001, -3.9000000000000012, -3.500000000000001, -3.700000000000001, -3.400000000000001, -3.7, -11.0, -3.500000000000001, -3.9000000000000012, -4.000000000000002, -3.700000000000001, -3.700000000000001, -3.5000000000000004, -3.900000000000001, -4.000000000000002, -3.9000000000000004, -3.700000000000001, -4.000000000000001, -3.4000000000000004, -3.700000000000001, -12.700000000000001, -10.1, -4.000000000000001, -10.4, -3.6000000000000005, -10.9, -3.9000000000000012, -3.6000000000000005, -3.900000000000001, -3.8000000000000007, -3.800000000000001, -3.6000000000000005, -3.8000000000000007, -3.8000000000000003, -4.000000000000001, -4.1000000000000005, -3.9000000000000012, -3.8000000000000007, -3.9000000000000012, -3.7000000000000006, -10.5, -4.100000000000001, -3.9000000000000012, -13.0, -4.000000000000001, -3.5000000000000004, -3.600000000000001, -11.2, -4.100000000000001, -3.800000000000001, -3.9000000000000012, -3.800000000000001, -4.000000000000001, -4.100000000000001, -3.800000000000001, -3.700000000000001, -11.1, -10.9, -3.900000000000001, -4.000000000000001, -4.000000000000001, -12.8, -10.2, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.6000000000000005, -3.6000000000000005, -11.7], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 5, 1, 7, 3, 4, 21, 4, 21, 4, 21, 21, 13, 2, 2, 5, 2, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 11, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 13, 21, 21, 21, 11, 21, 21, 21, 4, 11, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 10, 21, 4, 21, 21, 21, 21, 7, 10, 21, 21, 21, 21, 21, 14, 21, 11, 12, 1, 21, 9, 21, 1, 21, 1, 8, 21, 21, 15, 21, 21, 20, 21, 15, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 2, 21, 4, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 20, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 9, 9, 21, 21, 21, 20, 3, 21, 21, 21, 21, 21, 21, 14]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.694981915332685, "mean_inference_ms": 18.590488188496355, "mean_action_processing_ms": 0.9851052606878239, "mean_env_wait_ms": 1.8523100963829298, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0810594685309756, "StateBufferConnector_ms": 0.010687376545593801, "ViewRequirementAgentConnector_ms": 0.15011719897785017}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 170968.836, "load_time_ms": 1.17, "load_throughput": 3417783.572, "learn_time_ms": 169974.193, "learn_throughput": 23.533, "synch_weights_time_ms": 185.228}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "episodes_total": 4664, "training_iteration": 22, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-06_21-58-15", "timestamp": 1680811095, "time_this_iter_s": 170.71978902816772, "time_total_s": 3761.4005558490753, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01477a3f40>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0147643550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 3761.4005558490753, "timesteps_since_restore": 0, "iterations_since_restore": 22, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.406584362139918, "ram_util_percent": 23.56502057613169}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.361470424231663, "cur_kl_coeff": 21.894694519042968, "cur_lr": 0.01, "total_loss": 1.067202327592719, "policy_loss": 0.0012055514785911767, "vf_loss": 1.00307420394834, "vf_explained_var": 0.3220160306781851, "kl": 0.002873872838190241, "entropy": 3.2906432492758637, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 20925.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "sampler_results": {"episode_reward_max": -3.3000000000000007, "episode_reward_min": -12.8, "episode_reward_mean": -5.594859813084113, "episode_len_mean": 18.257009345794394, "episode_media": {}, "episodes_this_iter": 214, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.8000000000000007, -3.6, -4.000000000000001, -3.800000000000001, -3.8000000000000007, -3.6000000000000005, -3.7000000000000006, -3.8000000000000007, -10.7, -3.600000000000001, -3.7000000000000006, -10.6, -10.2, -3.8000000000000007, -3.9000000000000012, -12.5, -10.1, -10.5, -10.6, -10.9, -3.900000000000001, -3.7000000000000006, -10.4, -3.800000000000001, -3.600000000000001, -12.4, -4.000000000000001, -3.7000000000000006, -3.900000000000001, -3.700000000000001, -12.5, -3.7000000000000006, -3.7000000000000006, -3.6000000000000005, -3.500000000000001, -3.900000000000001, -3.8000000000000007, -3.800000000000001, -10.3, -3.6, -11.2, -3.600000000000001, -3.900000000000001, -10.9, -3.600000000000001, -3.900000000000001, -4.100000000000001, -3.700000000000001, -4.100000000000001, -3.8000000000000003, -3.5000000000000004, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -3.700000000000001, -4.1000000000000005, -11.2, -3.600000000000001, -11.1, -11.2, -4.000000000000002, -4.000000000000001, -3.600000000000001, -3.6000000000000005, -3.900000000000001, -3.9000000000000012, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -10.8, -3.8000000000000007, -3.5000000000000004, -3.9000000000000012, -3.500000000000001, -11.4, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -12.2, -4.1000000000000005, -11.0, -12.8, -10.7, -3.800000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -3.800000000000001, -4.000000000000001, -3.9000000000000004, -3.6000000000000005, -3.7000000000000006, -4.200000000000001, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -10.9, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -3.7000000000000006, -12.5, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -10.6, -11.2, -10.4, -3.9000000000000012, -3.900000000000001, -12.3, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -10.8, -10.0, -10.1, -3.6000000000000005, -3.5000000000000004, -4.000000000000001, -3.7000000000000006, -3.700000000000001, -3.800000000000001, -3.600000000000001, -3.900000000000001, -4.000000000000001, -11.2, -3.500000000000001, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -3.800000000000001, -11.0, -4.200000000000001, -3.500000000000001, -3.9000000000000012, -3.800000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -3.7000000000000006, -3.800000000000001, -3.9000000000000012, -4.000000000000001, -11.7, -4.100000000000001, -3.7000000000000006, -10.2, -3.700000000000001, -12.600000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.700000000000001, -3.700000000000001, -12.2, -11.1, -11.5, -4.000000000000001, -3.800000000000001, -3.8000000000000007, -3.8000000000000007, -10.3, -3.600000000000001, -3.6000000000000005, -4.100000000000001, -3.6000000000000005, -3.8000000000000007, -11.4, -3.8000000000000007, -4.000000000000001, -3.400000000000001, -3.8000000000000007, -3.6000000000000005, -11.9, -10.0, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -3.900000000000001, -3.700000000000001, -10.7, -4.200000000000001, -10.4, -3.6000000000000005, -4.1000000000000005, -4.100000000000001, -3.700000000000001, -3.6000000000000005, -3.700000000000001, -3.900000000000001, -3.900000000000001, -3.800000000000001, -10.4, -11.9, -3.9000000000000004, -3.900000000000001, -3.6000000000000005, -10.5, -3.8000000000000007, -10.1, -3.900000000000001, -3.3000000000000007, -4.000000000000001, -12.5, -12.5, -3.7000000000000006, -4.200000000000001, -4.000000000000002, -3.6000000000000005], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 6, 3, 21, 21, 19, 2, 6, 6, 9, 21, 21, 5, 21, 21, 18, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 4, 21, 10, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 9, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 12, 21, 21, 21, 16, 21, 10, 20, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 20, 21, 21, 21, 21, 7, 12, 5, 21, 21, 18, 21, 21, 21, 8, 1, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 3, 21, 18, 21, 21, 21, 21, 21, 16, 9, 13, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 16, 1, 21, 21, 21, 21, 21, 7, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 15, 21, 21, 21, 5, 21, 2, 21, 21, 21, 18, 20, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.716255920020854, "mean_inference_ms": 18.53591462398892, "mean_action_processing_ms": 0.9823743413525, "mean_env_wait_ms": 1.8459470494353636, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07622531641309506, "StateBufferConnector_ms": 0.010343801195376387, "ViewRequirementAgentConnector_ms": 0.13805672387096368}}, "episode_reward_max": -3.3000000000000007, "episode_reward_min": -12.8, "episode_reward_mean": -5.594859813084113, "episode_len_mean": 18.257009345794394, "episodes_this_iter": 214, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.8000000000000007, -3.6, -4.000000000000001, -3.800000000000001, -3.8000000000000007, -3.6000000000000005, -3.7000000000000006, -3.8000000000000007, -10.7, -3.600000000000001, -3.7000000000000006, -10.6, -10.2, -3.8000000000000007, -3.9000000000000012, -12.5, -10.1, -10.5, -10.6, -10.9, -3.900000000000001, -3.7000000000000006, -10.4, -3.800000000000001, -3.600000000000001, -12.4, -4.000000000000001, -3.7000000000000006, -3.900000000000001, -3.700000000000001, -12.5, -3.7000000000000006, -3.7000000000000006, -3.6000000000000005, -3.500000000000001, -3.900000000000001, -3.8000000000000007, -3.800000000000001, -10.3, -3.6, -11.2, -3.600000000000001, -3.900000000000001, -10.9, -3.600000000000001, -3.900000000000001, -4.100000000000001, -3.700000000000001, -4.100000000000001, -3.8000000000000003, -3.5000000000000004, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -3.700000000000001, -4.1000000000000005, -11.2, -3.600000000000001, -11.1, -11.2, -4.000000000000002, -4.000000000000001, -3.600000000000001, -3.6000000000000005, -3.900000000000001, -3.9000000000000012, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -10.8, -3.8000000000000007, -3.5000000000000004, -3.9000000000000012, -3.500000000000001, -11.4, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -12.2, -4.1000000000000005, -11.0, -12.8, -10.7, -3.800000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -3.800000000000001, -4.000000000000001, -3.9000000000000004, -3.6000000000000005, -3.7000000000000006, -4.200000000000001, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -10.9, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -3.7000000000000006, -12.5, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -10.6, -11.2, -10.4, -3.9000000000000012, -3.900000000000001, -12.3, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -10.8, -10.0, -10.1, -3.6000000000000005, -3.5000000000000004, -4.000000000000001, -3.7000000000000006, -3.700000000000001, -3.800000000000001, -3.600000000000001, -3.900000000000001, -4.000000000000001, -11.2, -3.500000000000001, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -3.800000000000001, -11.0, -4.200000000000001, -3.500000000000001, -3.9000000000000012, -3.800000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -3.7000000000000006, -3.800000000000001, -3.9000000000000012, -4.000000000000001, -11.7, -4.100000000000001, -3.7000000000000006, -10.2, -3.700000000000001, -12.600000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.700000000000001, -3.700000000000001, -12.2, -11.1, -11.5, -4.000000000000001, -3.800000000000001, -3.8000000000000007, -3.8000000000000007, -10.3, -3.600000000000001, -3.6000000000000005, -4.100000000000001, -3.6000000000000005, -3.8000000000000007, -11.4, -3.8000000000000007, -4.000000000000001, -3.400000000000001, -3.8000000000000007, -3.6000000000000005, -11.9, -10.0, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -3.900000000000001, -3.700000000000001, -10.7, -4.200000000000001, -10.4, -3.6000000000000005, -4.1000000000000005, -4.100000000000001, -3.700000000000001, -3.6000000000000005, -3.700000000000001, -3.900000000000001, -3.900000000000001, -3.800000000000001, -10.4, -11.9, -3.9000000000000004, -3.900000000000001, -3.6000000000000005, -10.5, -3.8000000000000007, -10.1, -3.900000000000001, -3.3000000000000007, -4.000000000000001, -12.5, -12.5, -3.7000000000000006, -4.200000000000001, -4.000000000000002, -3.6000000000000005], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 6, 3, 21, 21, 19, 2, 6, 6, 9, 21, 21, 5, 21, 21, 18, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 4, 21, 10, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 9, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 12, 21, 21, 21, 16, 21, 10, 20, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 20, 21, 21, 21, 21, 7, 12, 5, 21, 21, 18, 21, 21, 21, 8, 1, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 3, 21, 18, 21, 21, 21, 21, 21, 16, 9, 13, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 16, 1, 21, 21, 21, 21, 21, 7, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 15, 21, 21, 21, 5, 21, 2, 21, 21, 21, 18, 20, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.716255920020854, "mean_inference_ms": 18.53591462398892, "mean_action_processing_ms": 0.9823743413525, "mean_env_wait_ms": 1.8459470494353636, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07622531641309506, "StateBufferConnector_ms": 0.010343801195376387, "ViewRequirementAgentConnector_ms": 0.13805672387096368}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 170943.852, "load_time_ms": 1.164, "load_throughput": 3435630.823, "learn_time_ms": 169951.12, "learn_throughput": 23.536, "synch_weights_time_ms": 180.823}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "episodes_total": 4878, "training_iteration": 23, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-06_22-01-06", "timestamp": 1680811266, "time_this_iter_s": 170.42950773239136, "time_total_s": 3931.8300635814667, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0147791790>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0147651dc0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 3931.8300635814667, "timesteps_since_restore": 0, "iterations_since_restore": 23, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 6.231404958677686, "ram_util_percent": 23.59917355371901}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.451631350671091, "cur_kl_coeff": 10.947347259521484, "cur_lr": 0.01, "total_loss": 1.1019654237454937, "policy_loss": -0.0016256194301350142, "vf_loss": 1.0262865827689247, "vf_explained_var": 0.3520460266579864, "kl": 0.0070614790464738906, "entropy": 3.3052566536011234, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 21855.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "sampler_results": {"episode_reward_max": -3.4000000000000004, "episode_reward_min": -12.8, "episode_reward_mean": -5.646120689655173, "episode_len_mean": 17.599137931034484, "episode_media": {}, "episodes_this_iter": 232, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.5000000000000004, -3.700000000000001, -3.800000000000001, -3.600000000000001, -3.600000000000001, -3.5000000000000004, -3.7000000000000006, -3.500000000000001, -3.500000000000001, -10.2, -3.7000000000000006, -12.600000000000001, -12.6, -10.2, -3.600000000000001, -3.7000000000000006, -3.5000000000000004, -11.8, -10.7, -10.3, -10.4, -10.5, -10.6, -10.2, -10.1, -3.7000000000000006, -10.6, -10.1, -10.4, -10.3, -10.6, -10.7, -10.3, -3.6000000000000005, -3.500000000000001, -3.7000000000000006, -3.6000000000000005, -4.000000000000001, -3.7000000000000006, -3.900000000000001, -3.700000000000001, -3.9000000000000004, -3.800000000000001, -3.7000000000000006, -3.800000000000001, -3.7000000000000006, -11.0, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -3.9000000000000012, -3.6000000000000005, -3.600000000000001, -10.5, -3.6000000000000005, -10.3, -3.9000000000000012, -4.000000000000002, -4.000000000000001, -3.800000000000001, -3.8000000000000007, -3.7000000000000006, -3.7000000000000006, -3.800000000000001, -4.200000000000001, -4.000000000000002, -11.2, -11.6, -3.800000000000001, -4.100000000000001, -12.8, -12.1, -3.500000000000001, -3.600000000000001, -11.3, -3.500000000000001, -10.2, -10.1, -11.9, -3.900000000000001, -11.4, -10.5, -4.000000000000001, -3.900000000000001, -4.000000000000002, -3.600000000000001, -4.200000000000001, -3.6000000000000005, -11.1, -3.8000000000000007, -3.600000000000001, -10.5, -10.9, -3.8000000000000003, -3.500000000000001, -3.7000000000000006, -10.1, -3.700000000000001, -3.600000000000001, -3.6000000000000005, -3.8000000000000007, -3.8000000000000016, -10.7, -4.100000000000001, -10.4, -3.600000000000001, -11.9, -3.8000000000000007, -3.6000000000000005, -4.1000000000000005, -3.800000000000001, -12.4, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.7000000000000006, -3.7000000000000006, -3.7000000000000006, -3.700000000000001, -3.6000000000000005, -10.1, -3.600000000000001, -3.7000000000000006, -3.8000000000000007, -10.6, -10.5, -3.900000000000001, -10.3, -3.700000000000001, -10.8, -10.7, -3.8000000000000007, -4.000000000000001, -10.4, -11.4, -3.8000000000000007, -3.700000000000001, -3.4000000000000004, -11.5, -4.1000000000000005, -3.8000000000000007, -3.900000000000001, -11.9, -3.5000000000000004, -3.6000000000000005, -3.6000000000000005, -3.500000000000001, -11.1, -3.8000000000000007, -3.8000000000000003, -3.900000000000001, -3.8000000000000007, -3.6000000000000005, -4.100000000000001, -4.000000000000001, -3.400000000000001, -3.900000000000001, -10.5, -4.100000000000001, -3.700000000000001, -3.600000000000001, -3.8000000000000007, -3.7, -3.7000000000000006, -3.8000000000000007, -3.800000000000001, -4.0, -4.000000000000001, -3.900000000000001, -4.1000000000000005, -4.000000000000001, -3.600000000000001, -3.8000000000000007, -3.7000000000000006, -3.6000000000000005, -11.3, -3.800000000000001, -3.900000000000001, -3.7000000000000006, -4.100000000000001, -3.9000000000000012, -4.000000000000001, -4.000000000000002, -3.6000000000000005, -3.5000000000000004, -3.800000000000001, -3.600000000000001, -3.900000000000001, -11.4, -3.700000000000001, -3.5000000000000004, -3.900000000000001, -10.3, -3.5000000000000004, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -3.7000000000000006, -4.000000000000001, -3.600000000000001, -4.000000000000001, -11.4, -3.6000000000000005, -3.700000000000001, -3.5000000000000004, -3.7000000000000006, -4.000000000000001, -3.500000000000001, -3.9000000000000012, -3.900000000000001, -11.8, -3.9000000000000012, -4.0, -12.2, -4.100000000000001, -10.3, -3.9000000000000012, -3.700000000000001, -10.9, -3.800000000000001, -3.6000000000000005, -3.7000000000000006, -10.3, -3.700000000000001, -3.6000000000000005, -3.700000000000001, -3.9000000000000012, -3.6000000000000005, -4.100000000000001, -3.400000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 19, 19, 3, 21, 21, 21, 15, 7, 4, 5, 5, 6, 3, 2, 21, 5, 2, 4, 3, 6, 7, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 5, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 13, 21, 21, 20, 15, 21, 21, 11, 21, 3, 2, 15, 21, 11, 6, 21, 21, 21, 21, 21, 21, 10, 21, 21, 6, 9, 21, 21, 21, 2, 21, 21, 21, 21, 21, 7, 21, 4, 21, 14, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 6, 5, 21, 4, 21, 6, 7, 21, 21, 5, 11, 21, 21, 21, 12, 21, 21, 21, 16, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 16, 21, 4, 21, 21, 8, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.724680542304906, "mean_inference_ms": 18.590381176841415, "mean_action_processing_ms": 0.9842587377069776, "mean_env_wait_ms": 1.8451497502477037, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08138808710821743, "StateBufferConnector_ms": 0.011022234785145727, "ViewRequirementAgentConnector_ms": 0.1468947221492899}}, "episode_reward_max": -3.4000000000000004, "episode_reward_min": -12.8, "episode_reward_mean": -5.646120689655173, "episode_len_mean": 17.599137931034484, "episodes_this_iter": 232, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.5000000000000004, -3.700000000000001, -3.800000000000001, -3.600000000000001, -3.600000000000001, -3.5000000000000004, -3.7000000000000006, -3.500000000000001, -3.500000000000001, -10.2, -3.7000000000000006, -12.600000000000001, -12.6, -10.2, -3.600000000000001, -3.7000000000000006, -3.5000000000000004, -11.8, -10.7, -10.3, -10.4, -10.5, -10.6, -10.2, -10.1, -3.7000000000000006, -10.6, -10.1, -10.4, -10.3, -10.6, -10.7, -10.3, -3.6000000000000005, -3.500000000000001, -3.7000000000000006, -3.6000000000000005, -4.000000000000001, -3.7000000000000006, -3.900000000000001, -3.700000000000001, -3.9000000000000004, -3.800000000000001, -3.7000000000000006, -3.800000000000001, -3.7000000000000006, -11.0, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -3.9000000000000012, -3.6000000000000005, -3.600000000000001, -10.5, -3.6000000000000005, -10.3, -3.9000000000000012, -4.000000000000002, -4.000000000000001, -3.800000000000001, -3.8000000000000007, -3.7000000000000006, -3.7000000000000006, -3.800000000000001, -4.200000000000001, -4.000000000000002, -11.2, -11.6, -3.800000000000001, -4.100000000000001, -12.8, -12.1, -3.500000000000001, -3.600000000000001, -11.3, -3.500000000000001, -10.2, -10.1, -11.9, -3.900000000000001, -11.4, -10.5, -4.000000000000001, -3.900000000000001, -4.000000000000002, -3.600000000000001, -4.200000000000001, -3.6000000000000005, -11.1, -3.8000000000000007, -3.600000000000001, -10.5, -10.9, -3.8000000000000003, -3.500000000000001, -3.7000000000000006, -10.1, -3.700000000000001, -3.600000000000001, -3.6000000000000005, -3.8000000000000007, -3.8000000000000016, -10.7, -4.100000000000001, -10.4, -3.600000000000001, -11.9, -3.8000000000000007, -3.6000000000000005, -4.1000000000000005, -3.800000000000001, -12.4, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.7000000000000006, -3.7000000000000006, -3.7000000000000006, -3.700000000000001, -3.6000000000000005, -10.1, -3.600000000000001, -3.7000000000000006, -3.8000000000000007, -10.6, -10.5, -3.900000000000001, -10.3, -3.700000000000001, -10.8, -10.7, -3.8000000000000007, -4.000000000000001, -10.4, -11.4, -3.8000000000000007, -3.700000000000001, -3.4000000000000004, -11.5, -4.1000000000000005, -3.8000000000000007, -3.900000000000001, -11.9, -3.5000000000000004, -3.6000000000000005, -3.6000000000000005, -3.500000000000001, -11.1, -3.8000000000000007, -3.8000000000000003, -3.900000000000001, -3.8000000000000007, -3.6000000000000005, -4.100000000000001, -4.000000000000001, -3.400000000000001, -3.900000000000001, -10.5, -4.100000000000001, -3.700000000000001, -3.600000000000001, -3.8000000000000007, -3.7, -3.7000000000000006, -3.8000000000000007, -3.800000000000001, -4.0, -4.000000000000001, -3.900000000000001, -4.1000000000000005, -4.000000000000001, -3.600000000000001, -3.8000000000000007, -3.7000000000000006, -3.6000000000000005, -11.3, -3.800000000000001, -3.900000000000001, -3.7000000000000006, -4.100000000000001, -3.9000000000000012, -4.000000000000001, -4.000000000000002, -3.6000000000000005, -3.5000000000000004, -3.800000000000001, -3.600000000000001, -3.900000000000001, -11.4, -3.700000000000001, -3.5000000000000004, -3.900000000000001, -10.3, -3.5000000000000004, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -3.7000000000000006, -4.000000000000001, -3.600000000000001, -4.000000000000001, -11.4, -3.6000000000000005, -3.700000000000001, -3.5000000000000004, -3.7000000000000006, -4.000000000000001, -3.500000000000001, -3.9000000000000012, -3.900000000000001, -11.8, -3.9000000000000012, -4.0, -12.2, -4.100000000000001, -10.3, -3.9000000000000012, -3.700000000000001, -10.9, -3.800000000000001, -3.6000000000000005, -3.7000000000000006, -10.3, -3.700000000000001, -3.6000000000000005, -3.700000000000001, -3.9000000000000012, -3.6000000000000005, -4.100000000000001, -3.400000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 19, 19, 3, 21, 21, 21, 15, 7, 4, 5, 5, 6, 3, 2, 21, 5, 2, 4, 3, 6, 7, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 5, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 13, 21, 21, 20, 15, 21, 21, 11, 21, 3, 2, 15, 21, 11, 6, 21, 21, 21, 21, 21, 21, 10, 21, 21, 6, 9, 21, 21, 21, 2, 21, 21, 21, 21, 21, 7, 21, 4, 21, 14, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 6, 5, 21, 4, 21, 6, 7, 21, 21, 5, 11, 21, 21, 21, 12, 21, 21, 21, 16, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 16, 21, 4, 21, 21, 8, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.724680542304906, "mean_inference_ms": 18.590381176841415, "mean_action_processing_ms": 0.9842587377069776, "mean_env_wait_ms": 1.8451497502477037, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08138808710821743, "StateBufferConnector_ms": 0.011022234785145727, "ViewRequirementAgentConnector_ms": 0.1468947221492899}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 170861.307, "load_time_ms": 1.177, "load_throughput": 3399156.351, "learn_time_ms": 169875.107, "learn_throughput": 23.547, "synch_weights_time_ms": 180.723}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "episodes_total": 5110, "training_iteration": 24, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-06_22-03-56", "timestamp": 1680811436, "time_this_iter_s": 170.8252866268158, "time_total_s": 4102.6553502082825, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0147625ac0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01476431f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 4102.6553502082825, "timesteps_since_restore": 0, "iterations_since_restore": 24, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.499588477366255, "ram_util_percent": 23.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.42028845433266, "cur_kl_coeff": 10.947347259521484, "cur_lr": 0.01, "total_loss": 1.0683766191624986, "policy_loss": -0.0006715817757511652, "vf_loss": 0.9448615168451622, "vf_explained_var": 0.3303053117567493, "kl": 0.011343997649338987, "entropy": 3.2965905909897177, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 22785.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "sampler_results": {"episode_reward_max": -3.4000000000000004, "episode_reward_min": -12.600000000000001, "episode_reward_mean": -5.441284403669726, "episode_len_mean": 18.426605504587155, "episode_media": {}, "episodes_this_iter": 218, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.800000000000001, -3.700000000000001, -3.900000000000001, -4.000000000000001, -3.600000000000001, -3.8000000000000007, -3.7000000000000006, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -3.600000000000001, -4.000000000000001, -10.6, -10.1, -4.100000000000001, -10.4, -10.4, -3.800000000000001, -10.8, -3.6000000000000005, -12.1, -4.000000000000001, -3.600000000000001, -3.6000000000000005, -11.1, -4.0, -3.800000000000001, -3.8000000000000007, -3.5, -4.000000000000001, -4.000000000000001, -3.700000000000001, -3.5000000000000004, -3.9000000000000012, -11.5, -3.900000000000001, -3.700000000000001, -3.600000000000001, -3.9000000000000004, -12.600000000000001, -3.800000000000001, -4.0, -3.900000000000001, -11.5, -3.900000000000001, -4.100000000000001, -4.200000000000001, -3.700000000000001, -3.8000000000000003, -4.000000000000001, -3.600000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -10.3, -11.1, -3.700000000000001, -3.600000000000001, -11.2, -3.900000000000001, -3.6000000000000005, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.700000000000001, -3.700000000000001, -3.700000000000001, -11.1, -11.1, -4.100000000000001, -11.2, -4.000000000000001, -3.700000000000001, -10.8, -3.9000000000000004, -11.8, -3.500000000000001, -10.5, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -3.700000000000001, -3.8000000000000007, -4.200000000000001, -10.5, -4.000000000000002, -3.6000000000000005, -4.000000000000001, -12.2, -3.7000000000000006, -10.6, -3.8000000000000007, -3.400000000000001, -3.700000000000001, -3.8000000000000007, -3.8000000000000007, -10.7, -4.000000000000002, -3.800000000000001, -4.000000000000001, -3.8000000000000003, -4.000000000000001, -4.000000000000001, -3.500000000000001, -10.6, -4.0, -10.7, -3.4000000000000004, -11.4, -10.8, -3.9000000000000012, -3.7000000000000006, -3.900000000000001, -3.600000000000001, -12.3, -4.0, -10.9, -10.1, -3.7000000000000006, -10.6, -3.700000000000001, -11.700000000000001, -3.8000000000000007, -3.400000000000001, -11.2, -3.6000000000000005, -3.500000000000001, -3.700000000000001, -3.7000000000000006, -10.8, -3.8000000000000007, -10.3, -10.3, -4.000000000000001, -3.800000000000001, -3.7000000000000006, -3.7000000000000006, -3.9000000000000012, -4.100000000000001, -3.9000000000000012, -3.7000000000000006, -4.0, -3.6000000000000005, -4.000000000000002, -4.000000000000001, -3.4000000000000004, -11.2, -3.900000000000001, -3.6000000000000005, -3.7000000000000006, -3.6000000000000005, -3.700000000000001, -11.2, -3.400000000000001, -3.9000000000000004, -12.5, -4.200000000000001, -3.6000000000000005, -3.900000000000001, -3.900000000000001, -3.900000000000001, -10.5, -3.600000000000001, -3.6000000000000005, -3.7000000000000006, -3.6000000000000005, -3.8000000000000007, -3.900000000000001, -3.4000000000000004, -3.5000000000000004, -10.1, -4.0, -3.8000000000000007, -3.7000000000000006, -3.900000000000001, -3.8000000000000007, -3.600000000000001, -3.900000000000001, -4.100000000000001, -3.7000000000000006, -4.300000000000002, -3.6000000000000005, -3.6000000000000005, -3.7000000000000006, -3.800000000000001, -12.0, -3.9000000000000004, -3.7000000000000006, -3.7000000000000006, -3.700000000000001, -11.700000000000001, -11.6, -4.200000000000001, -11.8, -3.8000000000000007, -3.600000000000001, -4.100000000000001, -3.8000000000000007, -3.7000000000000006, -11.1, -3.800000000000001, -4.000000000000001, -10.7, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -3.7000000000000006, -12.4, -3.9000000000000012, -10.2, -4.1000000000000005, -3.8000000000000007, -3.9000000000000012, -3.7000000000000006, -3.7000000000000006, -3.500000000000001, -4.1000000000000005, -3.900000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 2, 21, 4, 4, 21, 7, 21, 16, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 19, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 9, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 9, 10, 21, 10, 21, 21, 8, 21, 17, 21, 5, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 17, 21, 7, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 5, 21, 7, 21, 12, 7, 21, 21, 21, 21, 17, 21, 9, 2, 21, 6, 21, 15, 21, 21, 11, 21, 21, 21, 21, 8, 21, 4, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 12, 21, 21, 20, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 15, 14, 21, 15, 21, 21, 21, 21, 21, 9, 21, 21, 7, 21, 21, 21, 21, 18, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.701697463167068, "mean_inference_ms": 18.465878371495236, "mean_action_processing_ms": 0.9804315595307769, "mean_env_wait_ms": 1.8250247153774102, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07349329257230146, "StateBufferConnector_ms": 0.00968318466746479, "ViewRequirementAgentConnector_ms": 0.13515697706729993}}, "episode_reward_max": -3.4000000000000004, "episode_reward_min": -12.600000000000001, "episode_reward_mean": -5.441284403669726, "episode_len_mean": 18.426605504587155, "episodes_this_iter": 218, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.800000000000001, -3.700000000000001, -3.900000000000001, -4.000000000000001, -3.600000000000001, -3.8000000000000007, -3.7000000000000006, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -3.600000000000001, -4.000000000000001, -10.6, -10.1, -4.100000000000001, -10.4, -10.4, -3.800000000000001, -10.8, -3.6000000000000005, -12.1, -4.000000000000001, -3.600000000000001, -3.6000000000000005, -11.1, -4.0, -3.800000000000001, -3.8000000000000007, -3.5, -4.000000000000001, -4.000000000000001, -3.700000000000001, -3.5000000000000004, -3.9000000000000012, -11.5, -3.900000000000001, -3.700000000000001, -3.600000000000001, -3.9000000000000004, -12.600000000000001, -3.800000000000001, -4.0, -3.900000000000001, -11.5, -3.900000000000001, -4.100000000000001, -4.200000000000001, -3.700000000000001, -3.8000000000000003, -4.000000000000001, -3.600000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -10.3, -11.1, -3.700000000000001, -3.600000000000001, -11.2, -3.900000000000001, -3.6000000000000005, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.700000000000001, -3.700000000000001, -3.700000000000001, -11.1, -11.1, -4.100000000000001, -11.2, -4.000000000000001, -3.700000000000001, -10.8, -3.9000000000000004, -11.8, -3.500000000000001, -10.5, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -3.700000000000001, -3.8000000000000007, -4.200000000000001, -10.5, -4.000000000000002, -3.6000000000000005, -4.000000000000001, -12.2, -3.7000000000000006, -10.6, -3.8000000000000007, -3.400000000000001, -3.700000000000001, -3.8000000000000007, -3.8000000000000007, -10.7, -4.000000000000002, -3.800000000000001, -4.000000000000001, -3.8000000000000003, -4.000000000000001, -4.000000000000001, -3.500000000000001, -10.6, -4.0, -10.7, -3.4000000000000004, -11.4, -10.8, -3.9000000000000012, -3.7000000000000006, -3.900000000000001, -3.600000000000001, -12.3, -4.0, -10.9, -10.1, -3.7000000000000006, -10.6, -3.700000000000001, -11.700000000000001, -3.8000000000000007, -3.400000000000001, -11.2, -3.6000000000000005, -3.500000000000001, -3.700000000000001, -3.7000000000000006, -10.8, -3.8000000000000007, -10.3, -10.3, -4.000000000000001, -3.800000000000001, -3.7000000000000006, -3.7000000000000006, -3.9000000000000012, -4.100000000000001, -3.9000000000000012, -3.7000000000000006, -4.0, -3.6000000000000005, -4.000000000000002, -4.000000000000001, -3.4000000000000004, -11.2, -3.900000000000001, -3.6000000000000005, -3.7000000000000006, -3.6000000000000005, -3.700000000000001, -11.2, -3.400000000000001, -3.9000000000000004, -12.5, -4.200000000000001, -3.6000000000000005, -3.900000000000001, -3.900000000000001, -3.900000000000001, -10.5, -3.600000000000001, -3.6000000000000005, -3.7000000000000006, -3.6000000000000005, -3.8000000000000007, -3.900000000000001, -3.4000000000000004, -3.5000000000000004, -10.1, -4.0, -3.8000000000000007, -3.7000000000000006, -3.900000000000001, -3.8000000000000007, -3.600000000000001, -3.900000000000001, -4.100000000000001, -3.7000000000000006, -4.300000000000002, -3.6000000000000005, -3.6000000000000005, -3.7000000000000006, -3.800000000000001, -12.0, -3.9000000000000004, -3.7000000000000006, -3.7000000000000006, -3.700000000000001, -11.700000000000001, -11.6, -4.200000000000001, -11.8, -3.8000000000000007, -3.600000000000001, -4.100000000000001, -3.8000000000000007, -3.7000000000000006, -11.1, -3.800000000000001, -4.000000000000001, -10.7, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -3.7000000000000006, -12.4, -3.9000000000000012, -10.2, -4.1000000000000005, -3.8000000000000007, -3.9000000000000012, -3.7000000000000006, -3.7000000000000006, -3.500000000000001, -4.1000000000000005, -3.900000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 2, 21, 4, 4, 21, 7, 21, 16, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 19, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 9, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 9, 10, 21, 10, 21, 21, 8, 21, 17, 21, 5, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 17, 21, 7, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 5, 21, 7, 21, 12, 7, 21, 21, 21, 21, 17, 21, 9, 2, 21, 6, 21, 15, 21, 21, 11, 21, 21, 21, 21, 8, 21, 4, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 12, 21, 21, 20, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 15, 14, 21, 15, 21, 21, 21, 21, 21, 9, 21, 21, 7, 21, 21, 21, 21, 18, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.701697463167068, "mean_inference_ms": 18.465878371495236, "mean_action_processing_ms": 0.9804315595307769, "mean_env_wait_ms": 1.8250247153774102, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07349329257230146, "StateBufferConnector_ms": 0.00968318466746479, "ViewRequirementAgentConnector_ms": 0.13515697706729993}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 170876.402, "load_time_ms": 1.175, "load_throughput": 3402948.359, "learn_time_ms": 169887.676, "learn_throughput": 23.545, "synch_weights_time_ms": 180.921}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": false, "episodes_total": 5328, "training_iteration": 25, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-06_22-06-48", "timestamp": 1680811608, "time_this_iter_s": 171.31171345710754, "time_total_s": 4273.96706366539, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476d1670>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01475b0dc0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 4273.96706366539, "timesteps_since_restore": 0, "iterations_since_restore": 25, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.622950819672131, "ram_util_percent": 23.600819672131152}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.356962770928619, "cur_kl_coeff": 10.947347259521484, "cur_lr": 0.01, "total_loss": 1.2244526169132641, "policy_loss": -0.0004619734031298468, "vf_loss": 1.094776398788697, "vf_explained_var": 0.30336388048305307, "kl": 0.011887646235102507, "entropy": 3.259967195090427, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 23715.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "sampler_results": {"episode_reward_max": 99.6, "episode_reward_min": -12.700000000000001, "episode_reward_mean": -5.007623318385649, "episode_len_mean": 18.112107623318387, "episode_media": {}, "episodes_this_iter": 223, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.500000000000001, -11.6, -3.8000000000000007, -3.800000000000001, -3.500000000000001, -3.500000000000001, -3.600000000000001, -3.700000000000001, -12.5, -3.8000000000000007, 99.6, -10.3, -10.6, -11.4, -10.7, -3.9000000000000012, -10.1, -3.6000000000000005, -11.3, -3.9000000000000004, -3.600000000000001, -3.600000000000001, -10.6, -10.5, -3.600000000000001, -3.800000000000001, -3.5000000000000004, -3.8000000000000007, -3.500000000000001, -3.500000000000001, -11.9, -3.900000000000001, -11.3, -3.900000000000001, -3.6000000000000005, -3.8000000000000007, -3.8000000000000007, -3.500000000000001, -3.600000000000001, -3.700000000000001, -3.900000000000001, -3.700000000000001, -3.500000000000001, -3.6000000000000005, -3.900000000000001, -4.000000000000001, -3.900000000000001, -11.7, -3.600000000000001, -4.000000000000001, -3.5000000000000004, -4.100000000000001, -3.700000000000001, -3.700000000000001, -4.100000000000001, -3.7000000000000006, -4.100000000000001, -4.000000000000001, -11.2, -3.9000000000000012, -3.800000000000001, -3.900000000000001, -4.000000000000001, -12.4, -10.1, -3.9000000000000012, -10.2, -4.000000000000001, -3.900000000000001, -3.8000000000000003, -4.000000000000002, -11.6, -3.900000000000001, -3.7000000000000006, -3.7000000000000006, -3.800000000000001, -10.7, -3.700000000000001, -3.500000000000001, -3.7000000000000006, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -3.700000000000001, -12.700000000000001, -11.0, -4.100000000000001, -10.7, -11.4, -11.5, -3.6000000000000005, -11.5, -3.800000000000001, -4.000000000000002, -3.6000000000000005, -3.9000000000000004, -3.400000000000001, -3.600000000000001, -3.6000000000000005, -3.7000000000000006, -3.700000000000001, -10.9, -11.6, -3.7000000000000006, -3.9000000000000012, -10.7, -3.9000000000000012, -3.7000000000000006, -10.4, -4.000000000000001, -10.5, -4.000000000000001, -3.8000000000000007, -3.800000000000001, -10.0, -3.400000000000001, -12.1, -4.200000000000001, -4.100000000000001, -10.1, -10.9, -3.600000000000001, -11.1, -10.2, -11.3, -10.0, -10.8, -3.8000000000000003, -3.7000000000000006, -3.6000000000000005, -3.5000000000000004, -3.900000000000001, -3.800000000000001, -4.0, -4.100000000000001, -3.900000000000001, -11.2, -4.000000000000001, -3.700000000000001, -3.7000000000000006, -3.9000000000000012, -3.6000000000000005, -3.8000000000000007, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -3.9000000000000012, -4.000000000000001, -3.6000000000000005, -4.000000000000001, -3.800000000000001, -3.9000000000000004, -3.900000000000001, -3.800000000000001, -3.800000000000001, -3.6000000000000014, -3.9000000000000012, -10.5, -4.0, -4.000000000000001, -10.4, -3.600000000000001, -4.000000000000001, -4.0, -3.700000000000001, -3.500000000000001, -11.6, -10.6, -11.1, -3.900000000000001, -3.900000000000001, -4.100000000000001, -11.8, -3.5000000000000004, -3.7000000000000006, -3.6000000000000005, -3.7000000000000006, -3.700000000000001, -10.9, -3.8000000000000007, -4.000000000000001, -3.4000000000000004, -4.100000000000001, -10.0, -3.8000000000000007, -3.5000000000000004, -3.8000000000000007, -3.7000000000000006, -3.900000000000001, -3.8000000000000007, -3.600000000000001, -3.4000000000000004, -3.8000000000000003, -3.500000000000001, -3.600000000000001, -3.8000000000000007, -3.8000000000000007, -11.4, -3.7000000000000006, -3.6000000000000005, -3.7000000000000006, -3.900000000000001, -4.000000000000001, -10.5, -3.600000000000001, -3.700000000000001, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -11.1, -3.800000000000001, -12.5, -3.7000000000000006, -3.500000000000001, -3.900000000000001, -3.700000000000001, -3.500000000000001, -3.9000000000000012, -3.900000000000001, -3.8000000000000007, -3.900000000000001], "episode_lengths": [21, 14, 21, 21, 21, 21, 21, 21, 20, 21, 5, 4, 7, 13, 7, 21, 2, 21, 10, 21, 21, 21, 6, 6, 21, 21, 21, 21, 21, 21, 16, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 18, 2, 21, 3, 21, 21, 21, 21, 13, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 19, 8, 21, 6, 10, 12, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 12, 21, 21, 7, 21, 21, 5, 21, 5, 21, 21, 21, 1, 21, 15, 21, 21, 2, 8, 21, 9, 3, 11, 1, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 5, 21, 21, 21, 21, 21, 13, 7, 11, 21, 21, 21, 13, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 9, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.700208863896588, "mean_inference_ms": 18.454584556978123, "mean_action_processing_ms": 0.9776237800335278, "mean_env_wait_ms": 1.8237359432475475, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07636001826401784, "StateBufferConnector_ms": 0.010200252447427656, "ViewRequirementAgentConnector_ms": 0.14117726296052804}}, "episode_reward_max": 99.6, "episode_reward_min": -12.700000000000001, "episode_reward_mean": -5.007623318385649, "episode_len_mean": 18.112107623318387, "episodes_this_iter": 223, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.500000000000001, -11.6, -3.8000000000000007, -3.800000000000001, -3.500000000000001, -3.500000000000001, -3.600000000000001, -3.700000000000001, -12.5, -3.8000000000000007, 99.6, -10.3, -10.6, -11.4, -10.7, -3.9000000000000012, -10.1, -3.6000000000000005, -11.3, -3.9000000000000004, -3.600000000000001, -3.600000000000001, -10.6, -10.5, -3.600000000000001, -3.800000000000001, -3.5000000000000004, -3.8000000000000007, -3.500000000000001, -3.500000000000001, -11.9, -3.900000000000001, -11.3, -3.900000000000001, -3.6000000000000005, -3.8000000000000007, -3.8000000000000007, -3.500000000000001, -3.600000000000001, -3.700000000000001, -3.900000000000001, -3.700000000000001, -3.500000000000001, -3.6000000000000005, -3.900000000000001, -4.000000000000001, -3.900000000000001, -11.7, -3.600000000000001, -4.000000000000001, -3.5000000000000004, -4.100000000000001, -3.700000000000001, -3.700000000000001, -4.100000000000001, -3.7000000000000006, -4.100000000000001, -4.000000000000001, -11.2, -3.9000000000000012, -3.800000000000001, -3.900000000000001, -4.000000000000001, -12.4, -10.1, -3.9000000000000012, -10.2, -4.000000000000001, -3.900000000000001, -3.8000000000000003, -4.000000000000002, -11.6, -3.900000000000001, -3.7000000000000006, -3.7000000000000006, -3.800000000000001, -10.7, -3.700000000000001, -3.500000000000001, -3.7000000000000006, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -3.700000000000001, -12.700000000000001, -11.0, -4.100000000000001, -10.7, -11.4, -11.5, -3.6000000000000005, -11.5, -3.800000000000001, -4.000000000000002, -3.6000000000000005, -3.9000000000000004, -3.400000000000001, -3.600000000000001, -3.6000000000000005, -3.7000000000000006, -3.700000000000001, -10.9, -11.6, -3.7000000000000006, -3.9000000000000012, -10.7, -3.9000000000000012, -3.7000000000000006, -10.4, -4.000000000000001, -10.5, -4.000000000000001, -3.8000000000000007, -3.800000000000001, -10.0, -3.400000000000001, -12.1, -4.200000000000001, -4.100000000000001, -10.1, -10.9, -3.600000000000001, -11.1, -10.2, -11.3, -10.0, -10.8, -3.8000000000000003, -3.7000000000000006, -3.6000000000000005, -3.5000000000000004, -3.900000000000001, -3.800000000000001, -4.0, -4.100000000000001, -3.900000000000001, -11.2, -4.000000000000001, -3.700000000000001, -3.7000000000000006, -3.9000000000000012, -3.6000000000000005, -3.8000000000000007, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -3.9000000000000012, -4.000000000000001, -3.6000000000000005, -4.000000000000001, -3.800000000000001, -3.9000000000000004, -3.900000000000001, -3.800000000000001, -3.800000000000001, -3.6000000000000014, -3.9000000000000012, -10.5, -4.0, -4.000000000000001, -10.4, -3.600000000000001, -4.000000000000001, -4.0, -3.700000000000001, -3.500000000000001, -11.6, -10.6, -11.1, -3.900000000000001, -3.900000000000001, -4.100000000000001, -11.8, -3.5000000000000004, -3.7000000000000006, -3.6000000000000005, -3.7000000000000006, -3.700000000000001, -10.9, -3.8000000000000007, -4.000000000000001, -3.4000000000000004, -4.100000000000001, -10.0, -3.8000000000000007, -3.5000000000000004, -3.8000000000000007, -3.7000000000000006, -3.900000000000001, -3.8000000000000007, -3.600000000000001, -3.4000000000000004, -3.8000000000000003, -3.500000000000001, -3.600000000000001, -3.8000000000000007, -3.8000000000000007, -11.4, -3.7000000000000006, -3.6000000000000005, -3.7000000000000006, -3.900000000000001, -4.000000000000001, -10.5, -3.600000000000001, -3.700000000000001, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -11.1, -3.800000000000001, -12.5, -3.7000000000000006, -3.500000000000001, -3.900000000000001, -3.700000000000001, -3.500000000000001, -3.9000000000000012, -3.900000000000001, -3.8000000000000007, -3.900000000000001], "episode_lengths": [21, 14, 21, 21, 21, 21, 21, 21, 20, 21, 5, 4, 7, 13, 7, 21, 2, 21, 10, 21, 21, 21, 6, 6, 21, 21, 21, 21, 21, 21, 16, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 18, 2, 21, 3, 21, 21, 21, 21, 13, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 19, 8, 21, 6, 10, 12, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 12, 21, 21, 7, 21, 21, 5, 21, 5, 21, 21, 21, 1, 21, 15, 21, 21, 2, 8, 21, 9, 3, 11, 1, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 5, 21, 21, 21, 21, 21, 13, 7, 11, 21, 21, 21, 13, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 9, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.700208863896588, "mean_inference_ms": 18.454584556978123, "mean_action_processing_ms": 0.9776237800335278, "mean_env_wait_ms": 1.8237359432475475, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07636001826401784, "StateBufferConnector_ms": 0.010200252447427656, "ViewRequirementAgentConnector_ms": 0.14117726296052804}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 170877.579, "load_time_ms": 1.18, "load_throughput": 3389541.992, "learn_time_ms": 169889.263, "learn_throughput": 23.545, "synch_weights_time_ms": 182.175}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "done": false, "episodes_total": 5551, "training_iteration": 26, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-06_22-09-39", "timestamp": 1680811779, "time_this_iter_s": 170.76552963256836, "time_total_s": 4444.732593297958, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476d70d0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01475b0ee0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 4444.732593297958, "timesteps_since_restore": 0, "iterations_since_restore": 26, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.403292181069959, "ram_util_percent": 23.575308641975308}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.4684896456298, "cur_kl_coeff": 10.947347259521484, "cur_lr": 0.01, "total_loss": 1.0611864657892336, "policy_loss": -0.003595251945017647, "vf_loss": 0.872908480918055, "vf_explained_var": 0.38353042781993907, "kl": 0.01752691569428901, "entropy": 3.2464724822710918, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 24645.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "sampler_results": {"episode_reward_max": -3.3000000000000007, "episode_reward_min": -12.3, "episode_reward_mean": -5.283928571428572, "episode_len_mean": 18.455357142857142, "episode_media": {}, "episodes_this_iter": 224, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.900000000000001, -3.7000000000000006, -3.4000000000000004, -3.500000000000001, -3.7000000000000006, -3.6000000000000005, -4.000000000000002, -3.600000000000001, -3.6000000000000005, -4.1000000000000005, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.800000000000001, -3.6000000000000005, -10.2, -3.7000000000000015, -3.900000000000001, -3.500000000000001, -10.1, -4.000000000000002, -10.4, -11.5, -10.5, -3.7000000000000006, -4.200000000000001, -3.7000000000000006, -12.3, -4.000000000000001, -3.8000000000000007, -3.9000000000000012, -3.7000000000000006, -4.200000000000001, -3.9000000000000004, -3.8000000000000007, -3.9000000000000012, -3.700000000000001, -3.500000000000001, -3.700000000000001, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -3.8000000000000003, -10.4, -4.0, -3.8000000000000007, -3.7000000000000006, -4.100000000000001, -3.800000000000001, -3.9000000000000012, -3.800000000000001, -4.0, -3.900000000000001, -3.900000000000001, -10.0, -11.6, -3.8000000000000007, -4.200000000000001, -4.000000000000001, -3.9000000000000012, -10.9, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.800000000000001, -10.1, -11.4, -4.000000000000002, -11.7, -3.500000000000001, -10.3, -3.800000000000001, -3.700000000000001, -3.9000000000000004, -3.8000000000000007, -10.2, -11.6, -10.6, -4.000000000000001, -4.000000000000002, -3.500000000000001, -10.5, -3.6000000000000005, -3.800000000000001, -11.6, -3.500000000000001, -3.3000000000000007, -4.300000000000001, -3.8000000000000007, -11.2, -3.9000000000000004, -4.000000000000001, -3.900000000000001, -3.4000000000000004, -4.1000000000000005, -3.7000000000000006, -3.8000000000000007, -3.500000000000001, -3.900000000000001, -4.0, -4.100000000000001, -10.1, -12.0, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -3.600000000000001, -3.700000000000001, -10.6, -10.9, -3.8000000000000016, -3.6000000000000005, -10.6, -11.2, -3.7000000000000006, -4.000000000000001, -3.700000000000001, -3.6000000000000005, -10.6, -3.8000000000000007, -3.7000000000000006, -4.000000000000001, -3.600000000000001, -3.5000000000000004, -3.8000000000000007, -4.300000000000001, -3.400000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.7000000000000006, -4.0, -3.900000000000001, -11.200000000000001, -3.900000000000001, -3.700000000000001, -3.600000000000001, -3.8000000000000007, -10.6, -3.7000000000000006, -11.8, -11.9, -3.700000000000001, -10.7, -12.2, -3.600000000000001, -3.500000000000001, -10.9, -3.6000000000000005, -3.6000000000000005, -3.7000000000000006, -4.000000000000001, -3.8000000000000007, -3.7000000000000006, -4.1000000000000005, -3.500000000000001, -11.4, -3.8000000000000007, -3.900000000000001, -3.7000000000000006, -3.7000000000000006, -3.5000000000000004, -10.6, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.9000000000000012, -10.6, -3.900000000000001, -3.8000000000000007, -10.2, -3.8000000000000007, -3.9000000000000004, -3.700000000000001, -4.1000000000000005, -3.900000000000001, -11.2, -4.000000000000001, -11.8, -3.400000000000001, -3.800000000000001, -3.9000000000000004, -3.7000000000000006, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -10.5, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.700000000000001, -11.9, -3.7000000000000006, -4.000000000000002, -3.8000000000000007, -3.900000000000001, -3.9000000000000004, -3.900000000000001, -10.6, -11.6, -3.700000000000001, -3.7000000000000006, -3.9000000000000012, -10.7, -3.500000000000001, -3.900000000000001, -3.6000000000000005, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.600000000000001, -4.1000000000000005, -3.7000000000000006, -3.900000000000001, -4.100000000000001, -3.6000000000000005, -10.7], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 2, 21, 5, 13, 6, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 12, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 2, 12, 21, 14, 21, 4, 21, 21, 21, 21, 3, 13, 7, 21, 21, 21, 5, 21, 21, 12, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 14, 21, 21, 21, 21, 21, 5, 8, 21, 21, 6, 11, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 7, 21, 14, 15, 21, 8, 16, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 6, 21, 21, 3, 21, 21, 21, 21, 21, 11, 21, 14, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 6, 12, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.686978048279759, "mean_inference_ms": 18.433119174056607, "mean_action_processing_ms": 0.9783867157352358, "mean_env_wait_ms": 1.8146963721691605, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07540913564818245, "StateBufferConnector_ms": 0.009744401488985335, "ViewRequirementAgentConnector_ms": 0.13822253261293685}}, "episode_reward_max": -3.3000000000000007, "episode_reward_min": -12.3, "episode_reward_mean": -5.283928571428572, "episode_len_mean": 18.455357142857142, "episodes_this_iter": 224, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.900000000000001, -3.7000000000000006, -3.4000000000000004, -3.500000000000001, -3.7000000000000006, -3.6000000000000005, -4.000000000000002, -3.600000000000001, -3.6000000000000005, -4.1000000000000005, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.800000000000001, -3.6000000000000005, -10.2, -3.7000000000000015, -3.900000000000001, -3.500000000000001, -10.1, -4.000000000000002, -10.4, -11.5, -10.5, -3.7000000000000006, -4.200000000000001, -3.7000000000000006, -12.3, -4.000000000000001, -3.8000000000000007, -3.9000000000000012, -3.7000000000000006, -4.200000000000001, -3.9000000000000004, -3.8000000000000007, -3.9000000000000012, -3.700000000000001, -3.500000000000001, -3.700000000000001, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -3.8000000000000003, -10.4, -4.0, -3.8000000000000007, -3.7000000000000006, -4.100000000000001, -3.800000000000001, -3.9000000000000012, -3.800000000000001, -4.0, -3.900000000000001, -3.900000000000001, -10.0, -11.6, -3.8000000000000007, -4.200000000000001, -4.000000000000001, -3.9000000000000012, -10.9, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.800000000000001, -10.1, -11.4, -4.000000000000002, -11.7, -3.500000000000001, -10.3, -3.800000000000001, -3.700000000000001, -3.9000000000000004, -3.8000000000000007, -10.2, -11.6, -10.6, -4.000000000000001, -4.000000000000002, -3.500000000000001, -10.5, -3.6000000000000005, -3.800000000000001, -11.6, -3.500000000000001, -3.3000000000000007, -4.300000000000001, -3.8000000000000007, -11.2, -3.9000000000000004, -4.000000000000001, -3.900000000000001, -3.4000000000000004, -4.1000000000000005, -3.7000000000000006, -3.8000000000000007, -3.500000000000001, -3.900000000000001, -4.0, -4.100000000000001, -10.1, -12.0, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -3.600000000000001, -3.700000000000001, -10.6, -10.9, -3.8000000000000016, -3.6000000000000005, -10.6, -11.2, -3.7000000000000006, -4.000000000000001, -3.700000000000001, -3.6000000000000005, -10.6, -3.8000000000000007, -3.7000000000000006, -4.000000000000001, -3.600000000000001, -3.5000000000000004, -3.8000000000000007, -4.300000000000001, -3.400000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.7000000000000006, -4.0, -3.900000000000001, -11.200000000000001, -3.900000000000001, -3.700000000000001, -3.600000000000001, -3.8000000000000007, -10.6, -3.7000000000000006, -11.8, -11.9, -3.700000000000001, -10.7, -12.2, -3.600000000000001, -3.500000000000001, -10.9, -3.6000000000000005, -3.6000000000000005, -3.7000000000000006, -4.000000000000001, -3.8000000000000007, -3.7000000000000006, -4.1000000000000005, -3.500000000000001, -11.4, -3.8000000000000007, -3.900000000000001, -3.7000000000000006, -3.7000000000000006, -3.5000000000000004, -10.6, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.9000000000000012, -10.6, -3.900000000000001, -3.8000000000000007, -10.2, -3.8000000000000007, -3.9000000000000004, -3.700000000000001, -4.1000000000000005, -3.900000000000001, -11.2, -4.000000000000001, -11.8, -3.400000000000001, -3.800000000000001, -3.9000000000000004, -3.7000000000000006, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -10.5, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.700000000000001, -11.9, -3.7000000000000006, -4.000000000000002, -3.8000000000000007, -3.900000000000001, -3.9000000000000004, -3.900000000000001, -10.6, -11.6, -3.700000000000001, -3.7000000000000006, -3.9000000000000012, -10.7, -3.500000000000001, -3.900000000000001, -3.6000000000000005, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.600000000000001, -4.1000000000000005, -3.7000000000000006, -3.900000000000001, -4.100000000000001, -3.6000000000000005, -10.7], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 2, 21, 5, 13, 6, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 12, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 2, 12, 21, 14, 21, 4, 21, 21, 21, 21, 3, 13, 7, 21, 21, 21, 5, 21, 21, 12, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 14, 21, 21, 21, 21, 21, 5, 8, 21, 21, 6, 11, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 7, 21, 14, 15, 21, 8, 16, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 6, 21, 21, 3, 21, 21, 21, 21, 21, 11, 21, 14, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 6, 12, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.686978048279759, "mean_inference_ms": 18.433119174056607, "mean_action_processing_ms": 0.9783867157352358, "mean_env_wait_ms": 1.8146963721691605, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07540913564818245, "StateBufferConnector_ms": 0.009744401488985335, "ViewRequirementAgentConnector_ms": 0.13822253261293685}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 108000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 170880.875, "load_time_ms": 1.191, "load_throughput": 3359743.672, "learn_time_ms": 169899.678, "learn_throughput": 23.543, "synch_weights_time_ms": 181.803}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "episodes_total": 5775, "training_iteration": 27, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-06_22-12-29", "timestamp": 1680811949, "time_this_iter_s": 170.58080768585205, "time_total_s": 4615.31340098381, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01477aeaf0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01475d8ee0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 4615.31340098381, "timesteps_since_restore": 0, "iterations_since_restore": 27, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.461157024793389, "ram_util_percent": 23.60206611570248}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.786187431632832, "cur_kl_coeff": 10.947347259521484, "cur_lr": 0.01, "total_loss": 1.2910403675169393, "policy_loss": 0.004554829532681133, "vf_loss": 1.114199898043467, "vf_explained_var": 0.32925416090155163, "kl": 0.01573766061037238, "entropy": 3.2092853858906736, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 25575.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "sampler_results": {"episode_reward_max": -3.4000000000000004, "episode_reward_min": -12.5, "episode_reward_mean": -5.592760180995475, "episode_len_mean": 18.1131221719457, "episode_media": {}, "episodes_this_iter": 221, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.7000000000000006, -12.4, -3.900000000000001, -10.6, -3.800000000000001, -3.800000000000001, -3.7000000000000006, -3.7000000000000006, -4.000000000000001, -4.000000000000001, -11.5, -3.600000000000001, -3.8000000000000007, -10.6, -11.1, -10.8, -11.8, -3.8000000000000007, -3.500000000000001, -10.2, -3.900000000000001, -10.6, -10.4, -10.3, -3.5000000000000004, -4.000000000000001, -10.2, -3.7000000000000006, -10.1, -3.9000000000000012, -3.700000000000001, -3.6000000000000005, -3.8000000000000007, -3.7000000000000006, -3.6000000000000005, -3.600000000000001, -3.8000000000000007, -3.8000000000000007, -3.6000000000000005, -3.5000000000000004, -3.7000000000000006, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -12.3, -3.8000000000000007, -3.500000000000001, -3.900000000000001, -4.0, -12.3, -4.100000000000001, -4.200000000000001, -3.900000000000001, -3.700000000000001, -11.1, -12.4, -4.000000000000001, -3.7000000000000006, -10.2, -12.2, -4.100000000000001, -4.1000000000000005, -10.1, -4.000000000000001, -3.8000000000000003, -3.900000000000001, -11.8, -3.700000000000001, -3.7000000000000006, -4.000000000000001, -3.6000000000000005, -4.000000000000001, -11.4, -11.4, -3.8000000000000007, -4.000000000000001, -3.9000000000000012, -3.8000000000000007, -3.400000000000001, -4.000000000000002, -3.6000000000000005, -10.7, -4.000000000000002, -4.0, -10.8, -3.800000000000001, -3.8000000000000007, -11.3, -4.100000000000001, -3.7000000000000006, -3.700000000000001, -3.700000000000001, -4.100000000000001, -3.8000000000000007, -3.6000000000000005, -4.1000000000000005, -4.1000000000000005, -3.8000000000000007, -3.6000000000000005, -3.9000000000000004, -3.600000000000001, -3.700000000000001, -3.7000000000000006, -3.7000000000000006, -3.8000000000000007, -4.100000000000001, -3.7000000000000006, -11.1, -3.900000000000001, -3.700000000000001, -3.500000000000001, -10.6, -10.3, -3.8000000000000007, -3.700000000000001, -3.9000000000000012, -11.0, -3.800000000000001, -10.2, -3.8000000000000007, -3.6000000000000005, -3.6000000000000005, -11.6, -3.800000000000001, -3.900000000000001, -3.7000000000000006, -4.000000000000002, -3.8000000000000003, -11.3, -3.7000000000000006, -3.700000000000001, -3.8000000000000007, -3.8000000000000007, -3.700000000000001, -4.0, -3.8000000000000007, -3.700000000000001, -3.8000000000000007, -10.5, -12.0, -4.100000000000001, -3.9000000000000012, -3.9000000000000004, -11.4, -4.000000000000001, -11.7, -3.8000000000000007, -3.900000000000001, -3.7000000000000006, -3.700000000000001, -3.800000000000001, -3.8000000000000007, -11.4, -3.800000000000001, -3.9000000000000012, -3.700000000000001, -11.2, -4.500000000000002, -3.6000000000000005, -3.9000000000000012, -10.9, -4.300000000000001, -10.5, -4.000000000000002, -11.8, -4.000000000000001, -12.0, -3.800000000000001, -3.600000000000001, -3.6000000000000005, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -11.4, -12.5, -3.700000000000001, -10.0, -3.8000000000000007, -3.8000000000000007, -3.9000000000000004, -4.200000000000001, -3.9000000000000012, -4.000000000000001, -3.6000000000000005, -4.000000000000002, -4.000000000000001, -3.8000000000000003, -4.200000000000001, -10.4, -3.8000000000000007, -10.3, -3.800000000000001, -11.7, -3.700000000000001, -11.2, -4.100000000000001, -4.000000000000001, -10.8, -10.1, -3.600000000000001, -4.300000000000001, -3.900000000000001, -10.6, -3.8000000000000007, -4.1000000000000005, -3.600000000000001, -3.7000000000000006, -4.000000000000001, -10.8, -4.100000000000001, -3.7000000000000006, -3.8000000000000007, -3.7000000000000015, -3.700000000000001, -3.600000000000001, -3.4000000000000004, -3.900000000000001, -3.600000000000001, -3.6000000000000005, -3.700000000000001], "episode_lengths": [21, 18, 21, 6, 21, 21, 21, 21, 21, 21, 14, 21, 21, 5, 11, 8, 14, 21, 21, 3, 21, 6, 5, 3, 21, 21, 3, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 18, 21, 21, 21, 21, 9, 19, 21, 21, 3, 15, 21, 21, 2, 21, 21, 21, 13, 21, 21, 21, 21, 21, 11, 12, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 6, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 6, 4, 21, 21, 21, 9, 21, 3, 21, 21, 21, 13, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 17, 21, 21, 21, 12, 21, 14, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 12, 21, 21, 21, 7, 21, 5, 21, 14, 21, 16, 21, 21, 21, 21, 21, 21, 21, 12, 18, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 4, 21, 13, 21, 10, 21, 21, 8, 2, 21, 21, 21, 6, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.705916564219827, "mean_inference_ms": 18.37148370505189, "mean_action_processing_ms": 0.9709311843503957, "mean_env_wait_ms": 1.809649638963643, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07394773388340463, "StateBufferConnector_ms": 0.00944828016186192, "ViewRequirementAgentConnector_ms": 0.1343956899858708}}, "episode_reward_max": -3.4000000000000004, "episode_reward_min": -12.5, "episode_reward_mean": -5.592760180995475, "episode_len_mean": 18.1131221719457, "episodes_this_iter": 221, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.7000000000000006, -12.4, -3.900000000000001, -10.6, -3.800000000000001, -3.800000000000001, -3.7000000000000006, -3.7000000000000006, -4.000000000000001, -4.000000000000001, -11.5, -3.600000000000001, -3.8000000000000007, -10.6, -11.1, -10.8, -11.8, -3.8000000000000007, -3.500000000000001, -10.2, -3.900000000000001, -10.6, -10.4, -10.3, -3.5000000000000004, -4.000000000000001, -10.2, -3.7000000000000006, -10.1, -3.9000000000000012, -3.700000000000001, -3.6000000000000005, -3.8000000000000007, -3.7000000000000006, -3.6000000000000005, -3.600000000000001, -3.8000000000000007, -3.8000000000000007, -3.6000000000000005, -3.5000000000000004, -3.7000000000000006, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -12.3, -3.8000000000000007, -3.500000000000001, -3.900000000000001, -4.0, -12.3, -4.100000000000001, -4.200000000000001, -3.900000000000001, -3.700000000000001, -11.1, -12.4, -4.000000000000001, -3.7000000000000006, -10.2, -12.2, -4.100000000000001, -4.1000000000000005, -10.1, -4.000000000000001, -3.8000000000000003, -3.900000000000001, -11.8, -3.700000000000001, -3.7000000000000006, -4.000000000000001, -3.6000000000000005, -4.000000000000001, -11.4, -11.4, -3.8000000000000007, -4.000000000000001, -3.9000000000000012, -3.8000000000000007, -3.400000000000001, -4.000000000000002, -3.6000000000000005, -10.7, -4.000000000000002, -4.0, -10.8, -3.800000000000001, -3.8000000000000007, -11.3, -4.100000000000001, -3.7000000000000006, -3.700000000000001, -3.700000000000001, -4.100000000000001, -3.8000000000000007, -3.6000000000000005, -4.1000000000000005, -4.1000000000000005, -3.8000000000000007, -3.6000000000000005, -3.9000000000000004, -3.600000000000001, -3.700000000000001, -3.7000000000000006, -3.7000000000000006, -3.8000000000000007, -4.100000000000001, -3.7000000000000006, -11.1, -3.900000000000001, -3.700000000000001, -3.500000000000001, -10.6, -10.3, -3.8000000000000007, -3.700000000000001, -3.9000000000000012, -11.0, -3.800000000000001, -10.2, -3.8000000000000007, -3.6000000000000005, -3.6000000000000005, -11.6, -3.800000000000001, -3.900000000000001, -3.7000000000000006, -4.000000000000002, -3.8000000000000003, -11.3, -3.7000000000000006, -3.700000000000001, -3.8000000000000007, -3.8000000000000007, -3.700000000000001, -4.0, -3.8000000000000007, -3.700000000000001, -3.8000000000000007, -10.5, -12.0, -4.100000000000001, -3.9000000000000012, -3.9000000000000004, -11.4, -4.000000000000001, -11.7, -3.8000000000000007, -3.900000000000001, -3.7000000000000006, -3.700000000000001, -3.800000000000001, -3.8000000000000007, -11.4, -3.800000000000001, -3.9000000000000012, -3.700000000000001, -11.2, -4.500000000000002, -3.6000000000000005, -3.9000000000000012, -10.9, -4.300000000000001, -10.5, -4.000000000000002, -11.8, -4.000000000000001, -12.0, -3.800000000000001, -3.600000000000001, -3.6000000000000005, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -11.4, -12.5, -3.700000000000001, -10.0, -3.8000000000000007, -3.8000000000000007, -3.9000000000000004, -4.200000000000001, -3.9000000000000012, -4.000000000000001, -3.6000000000000005, -4.000000000000002, -4.000000000000001, -3.8000000000000003, -4.200000000000001, -10.4, -3.8000000000000007, -10.3, -3.800000000000001, -11.7, -3.700000000000001, -11.2, -4.100000000000001, -4.000000000000001, -10.8, -10.1, -3.600000000000001, -4.300000000000001, -3.900000000000001, -10.6, -3.8000000000000007, -4.1000000000000005, -3.600000000000001, -3.7000000000000006, -4.000000000000001, -10.8, -4.100000000000001, -3.7000000000000006, -3.8000000000000007, -3.7000000000000015, -3.700000000000001, -3.600000000000001, -3.4000000000000004, -3.900000000000001, -3.600000000000001, -3.6000000000000005, -3.700000000000001], "episode_lengths": [21, 18, 21, 6, 21, 21, 21, 21, 21, 21, 14, 21, 21, 5, 11, 8, 14, 21, 21, 3, 21, 6, 5, 3, 21, 21, 3, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 18, 21, 21, 21, 21, 9, 19, 21, 21, 3, 15, 21, 21, 2, 21, 21, 21, 13, 21, 21, 21, 21, 21, 11, 12, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 6, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 6, 4, 21, 21, 21, 9, 21, 3, 21, 21, 21, 13, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 17, 21, 21, 21, 12, 21, 14, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 12, 21, 21, 21, 7, 21, 5, 21, 14, 21, 16, 21, 21, 21, 21, 21, 21, 21, 12, 18, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 4, 21, 13, 21, 10, 21, 21, 8, 2, 21, 21, 21, 6, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.705916564219827, "mean_inference_ms": 18.37148370505189, "mean_action_processing_ms": 0.9709311843503957, "mean_env_wait_ms": 1.809649638963643, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07394773388340463, "StateBufferConnector_ms": 0.00944828016186192, "ViewRequirementAgentConnector_ms": 0.1343956899858708}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 170943.016, "load_time_ms": 1.198, "load_throughput": 3339879.362, "learn_time_ms": 169972.683, "learn_throughput": 23.533, "synch_weights_time_ms": 181.211}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "episodes_total": 5996, "training_iteration": 28, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-06_22-15-21", "timestamp": 1680812121, "time_this_iter_s": 171.57135152816772, "time_total_s": 4786.884752511978, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0147740a60>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01475d85e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 4786.884752511978, "timesteps_since_restore": 0, "iterations_since_restore": 28, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.656147540983606, "ram_util_percent": 23.600409836065577}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.752837998379944, "cur_kl_coeff": 10.947347259521484, "cur_lr": 0.01, "total_loss": 1.0874775248229183, "policy_loss": 0.0012530741001409228, "vf_loss": 0.9141339695301428, "vf_explained_var": 0.390728134429583, "kl": 0.01571983330988235, "entropy": 3.200719952070585, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 26505.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "sampler_results": {"episode_reward_max": -3.400000000000001, "episode_reward_min": -12.600000000000001, "episode_reward_mean": -5.2452830188679265, "episode_len_mean": 18.599056603773583, "episode_media": {}, "episodes_this_iter": 212, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.0, -3.7000000000000006, -3.9000000000000012, -3.8000000000000007, -3.7000000000000006, -3.8000000000000007, -3.8000000000000007, -3.6000000000000005, -3.900000000000001, -11.0, -11.7, -3.500000000000001, -10.4, -11.8, -11.1, -10.5, -10.2, -10.7, -10.4, -3.9000000000000012, -10.3, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -10.1, -4.000000000000001, -3.700000000000001, -3.6000000000000005, -3.8000000000000007, -3.8000000000000003, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -3.8000000000000007, -3.8000000000000003, -10.3, -3.8000000000000007, -3.7000000000000006, -3.600000000000001, -3.7000000000000006, -3.900000000000001, -3.8000000000000003, -11.3, -3.8000000000000007, -10.4, -3.9000000000000012, -3.9000000000000012, -3.7000000000000006, -3.700000000000001, -3.7000000000000006, -3.900000000000001, -3.8000000000000003, -4.000000000000001, -11.4, -4.000000000000001, -11.2, -4.300000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.7, -4.000000000000001, -3.8000000000000007, -3.700000000000001, -12.5, -4.100000000000001, -4.200000000000001, -3.600000000000001, -11.1, -4.0, -3.700000000000001, -3.9000000000000012, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -3.600000000000001, -3.7000000000000006, -3.8000000000000007, -3.5000000000000004, -3.600000000000001, -3.8000000000000007, -3.8000000000000007, -3.9000000000000004, -3.8000000000000007, -3.800000000000001, -11.0, -4.0, -12.4, -3.600000000000001, -10.7, -3.6000000000000005, -10.1, -3.800000000000001, -4.200000000000001, -3.9000000000000012, -3.8000000000000007, -3.900000000000001, -11.0, -3.6000000000000005, -4.0, -3.8000000000000003, -3.400000000000001, -11.0, -10.2, -3.6000000000000005, -4.000000000000001, -3.7000000000000006, -3.6000000000000005, -4.000000000000001, -11.0, -3.800000000000001, -3.5000000000000004, -10.5, -3.900000000000001, -3.9000000000000012, -10.4, -3.7000000000000006, -10.9, -3.700000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.7, -3.800000000000001, -4.0, -3.900000000000001, -3.700000000000001, -3.7000000000000006, -12.2, -4.100000000000001, -3.7000000000000006, -10.8, -4.1000000000000005, -3.9000000000000012, -3.900000000000001, -10.4, -3.7000000000000006, -4.000000000000001, -3.800000000000001, -3.8000000000000007, -3.700000000000001, -3.800000000000001, -4.000000000000001, -3.700000000000001, -3.700000000000001, -3.6000000000000005, -3.6000000000000005, -3.7000000000000006, -3.900000000000001, -3.8000000000000007, -3.800000000000001, -3.8000000000000007, -4.000000000000002, -4.100000000000001, -11.9, -3.900000000000001, -3.400000000000001, -3.600000000000001, -4.000000000000001, -3.800000000000001, -4.000000000000001, -3.8000000000000007, -10.6, -3.8000000000000007, -12.4, -3.600000000000001, -4.000000000000002, -3.6000000000000005, -4.100000000000001, -3.600000000000001, -3.700000000000001, -3.700000000000001, -3.6000000000000005, -4.1000000000000005, -3.800000000000001, -3.7000000000000006, -3.8000000000000007, -3.9000000000000012, -3.700000000000001, -4.300000000000001, -10.5, -10.7, -4.000000000000001, -3.5000000000000004, -3.900000000000001, -12.600000000000001, -4.100000000000001, -3.500000000000001, -11.0, -4.000000000000001, -3.600000000000001, -3.8000000000000007, -3.700000000000001, -3.8000000000000007, -3.800000000000001, -3.800000000000001, -3.800000000000001, -4.100000000000001, -11.6, -3.7000000000000006, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -11.8, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.6000000000000005, -3.700000000000001], "episode_lengths": [8, 21, 21, 21, 21, 21, 21, 21, 21, 10, 14, 21, 5, 14, 8, 5, 3, 6, 5, 21, 4, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 11, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 17, 21, 8, 21, 2, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 10, 3, 21, 21, 21, 21, 21, 8, 21, 21, 5, 21, 21, 5, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 6, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 7, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 7, 21, 21, 21, 19, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.69404963402077, "mean_inference_ms": 18.373526159276032, "mean_action_processing_ms": 0.9722781565369534, "mean_env_wait_ms": 1.8007598588215241, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07581328446010374, "StateBufferConnector_ms": 0.009746484036715526, "ViewRequirementAgentConnector_ms": 0.1370122972524391}}, "episode_reward_max": -3.400000000000001, "episode_reward_min": -12.600000000000001, "episode_reward_mean": -5.2452830188679265, "episode_len_mean": 18.599056603773583, "episodes_this_iter": 212, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11.0, -3.7000000000000006, -3.9000000000000012, -3.8000000000000007, -3.7000000000000006, -3.8000000000000007, -3.8000000000000007, -3.6000000000000005, -3.900000000000001, -11.0, -11.7, -3.500000000000001, -10.4, -11.8, -11.1, -10.5, -10.2, -10.7, -10.4, -3.9000000000000012, -10.3, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -10.1, -4.000000000000001, -3.700000000000001, -3.6000000000000005, -3.8000000000000007, -3.8000000000000003, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -3.8000000000000007, -3.8000000000000003, -10.3, -3.8000000000000007, -3.7000000000000006, -3.600000000000001, -3.7000000000000006, -3.900000000000001, -3.8000000000000003, -11.3, -3.8000000000000007, -10.4, -3.9000000000000012, -3.9000000000000012, -3.7000000000000006, -3.700000000000001, -3.7000000000000006, -3.900000000000001, -3.8000000000000003, -4.000000000000001, -11.4, -4.000000000000001, -11.2, -4.300000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.7, -4.000000000000001, -3.8000000000000007, -3.700000000000001, -12.5, -4.100000000000001, -4.200000000000001, -3.600000000000001, -11.1, -4.0, -3.700000000000001, -3.9000000000000012, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -3.600000000000001, -3.7000000000000006, -3.8000000000000007, -3.5000000000000004, -3.600000000000001, -3.8000000000000007, -3.8000000000000007, -3.9000000000000004, -3.8000000000000007, -3.800000000000001, -11.0, -4.0, -12.4, -3.600000000000001, -10.7, -3.6000000000000005, -10.1, -3.800000000000001, -4.200000000000001, -3.9000000000000012, -3.8000000000000007, -3.900000000000001, -11.0, -3.6000000000000005, -4.0, -3.8000000000000003, -3.400000000000001, -11.0, -10.2, -3.6000000000000005, -4.000000000000001, -3.7000000000000006, -3.6000000000000005, -4.000000000000001, -11.0, -3.800000000000001, -3.5000000000000004, -10.5, -3.900000000000001, -3.9000000000000012, -10.4, -3.7000000000000006, -10.9, -3.700000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.7, -3.800000000000001, -4.0, -3.900000000000001, -3.700000000000001, -3.7000000000000006, -12.2, -4.100000000000001, -3.7000000000000006, -10.8, -4.1000000000000005, -3.9000000000000012, -3.900000000000001, -10.4, -3.7000000000000006, -4.000000000000001, -3.800000000000001, -3.8000000000000007, -3.700000000000001, -3.800000000000001, -4.000000000000001, -3.700000000000001, -3.700000000000001, -3.6000000000000005, -3.6000000000000005, -3.7000000000000006, -3.900000000000001, -3.8000000000000007, -3.800000000000001, -3.8000000000000007, -4.000000000000002, -4.100000000000001, -11.9, -3.900000000000001, -3.400000000000001, -3.600000000000001, -4.000000000000001, -3.800000000000001, -4.000000000000001, -3.8000000000000007, -10.6, -3.8000000000000007, -12.4, -3.600000000000001, -4.000000000000002, -3.6000000000000005, -4.100000000000001, -3.600000000000001, -3.700000000000001, -3.700000000000001, -3.6000000000000005, -4.1000000000000005, -3.800000000000001, -3.7000000000000006, -3.8000000000000007, -3.9000000000000012, -3.700000000000001, -4.300000000000001, -10.5, -10.7, -4.000000000000001, -3.5000000000000004, -3.900000000000001, -12.600000000000001, -4.100000000000001, -3.500000000000001, -11.0, -4.000000000000001, -3.600000000000001, -3.8000000000000007, -3.700000000000001, -3.8000000000000007, -3.800000000000001, -3.800000000000001, -3.800000000000001, -4.100000000000001, -11.6, -3.7000000000000006, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -11.8, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.6000000000000005, -3.700000000000001], "episode_lengths": [8, 21, 21, 21, 21, 21, 21, 21, 21, 10, 14, 21, 5, 14, 8, 5, 3, 6, 5, 21, 4, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 11, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 17, 21, 8, 21, 2, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 10, 3, 21, 21, 21, 21, 21, 8, 21, 21, 5, 21, 21, 5, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 6, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 7, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 7, 21, 21, 21, 19, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.69404963402077, "mean_inference_ms": 18.373526159276032, "mean_action_processing_ms": 0.9722781565369534, "mean_env_wait_ms": 1.8007598588215241, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07581328446010374, "StateBufferConnector_ms": 0.009746484036715526, "ViewRequirementAgentConnector_ms": 0.1370122972524391}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 116000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 116000, "timers": {"training_iteration_time_ms": 170936.606, "load_time_ms": 1.202, "load_throughput": 3328218.374, "learn_time_ms": 169970.004, "learn_throughput": 23.534, "synch_weights_time_ms": 181.377}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "done": false, "episodes_total": 6208, "training_iteration": 29, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-06_22-18-12", "timestamp": 1680812292, "time_this_iter_s": 170.84884119033813, "time_total_s": 4957.733593702316, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476d1d90>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01475d8ee0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 4957.733593702316, "timesteps_since_restore": 0, "iterations_since_restore": 29, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.35761316872428, "ram_util_percent": 23.60164609053498}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.767756360576998, "cur_kl_coeff": 10.947347259521484, "cur_lr": 0.01, "total_loss": 1.0431062105041677, "policy_loss": -0.002383190157112255, "vf_loss": 0.8603215176051342, "vf_explained_var": 0.4191172948447607, "kl": 0.01691440652056988, "entropy": 3.151955408947442, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 27435.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "sampler_results": {"episode_reward_max": -3.3000000000000007, "episode_reward_min": -12.700000000000001, "episode_reward_mean": -5.168932038834952, "episode_len_mean": 18.796116504854368, "episode_media": {}, "episodes_this_iter": 206, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.6000000000000005, -3.9000000000000012, -3.7000000000000006, -4.100000000000001, -11.5, -3.9000000000000012, -3.800000000000001, -3.900000000000001, -3.700000000000001, -10.2, -3.5000000000000004, -10.8, -3.900000000000001, -10.2, -11.4, -10.9, -4.000000000000002, -10.1, -10.3, -4.0, -10.7, -10.1, -10.6, -3.9000000000000012, -3.900000000000001, -3.8000000000000007, -10.6, -3.700000000000001, -3.900000000000001, -10.5, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.800000000000001, -3.8000000000000007, -3.800000000000001, -3.7000000000000006, -10.2, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -10.9, -3.7000000000000006, -3.700000000000001, -12.200000000000001, -11.5, -3.900000000000001, -3.6000000000000005, -3.900000000000001, -3.7000000000000006, -4.200000000000001, -4.100000000000001, -12.3, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -11.3, -3.3000000000000007, -3.500000000000001, -12.600000000000001, -4.200000000000001, -12.700000000000001, -4.000000000000001, -3.600000000000001, -3.9000000000000012, -3.9000000000000012, -3.7000000000000006, -4.000000000000001, -4.000000000000001, -3.500000000000001, -3.700000000000001, -3.5000000000000004, -3.700000000000001, -10.5, -4.100000000000001, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -10.7, -3.8000000000000007, -3.700000000000001, -3.500000000000001, -3.600000000000001, -3.8000000000000007, -4.100000000000001, -3.700000000000001, -3.7000000000000006, -3.600000000000001, -3.900000000000001, -3.9000000000000012, -3.7000000000000006, -3.700000000000001, -3.900000000000001, -4.200000000000001, -3.5000000000000004, -3.8000000000000007, -4.200000000000001, -3.6000000000000005, -4.100000000000001, -3.700000000000001, -10.7, -3.8000000000000007, -3.700000000000001, -3.8000000000000003, -3.900000000000001, -3.6000000000000005, -12.600000000000001, -10.4, -11.0, -3.800000000000001, -4.000000000000002, -3.8000000000000007, -4.200000000000001, -4.100000000000001, -4.200000000000001, -10.5, -3.7000000000000006, -3.900000000000001, -3.6000000000000005, -12.200000000000001, -3.900000000000001, -3.600000000000001, -3.4000000000000004, -3.8000000000000007, -3.900000000000001, -3.9000000000000012, -3.8000000000000007, -3.800000000000001, -4.000000000000001, -3.7000000000000006, -3.900000000000001, -3.5000000000000004, -3.8000000000000007, -3.800000000000001, -3.700000000000001, -3.8000000000000007, -3.9000000000000004, -4.000000000000001, -3.7000000000000006, -3.8000000000000007, -11.0, -3.7000000000000006, -4.200000000000001, -4.000000000000002, -3.900000000000001, -3.9000000000000012, -3.8000000000000007, -3.600000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.9000000000000012, -11.6, -3.900000000000001, -4.0, -11.5, -3.600000000000001, -3.6000000000000005, -3.500000000000001, -4.000000000000001, -3.800000000000001, -3.600000000000001, -3.7000000000000006, -3.700000000000001, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -3.9000000000000012, -3.7000000000000006, -4.100000000000001, -3.8000000000000007, -3.9000000000000004, -3.800000000000001, -3.500000000000001, -3.7000000000000015, -3.9000000000000012, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000002, -3.700000000000001, -10.8, -4.000000000000002, -11.6, -4.200000000000001, -3.8000000000000007, -10.4, -11.2, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -11.4, -11.1, -4.100000000000001, -3.8000000000000007, -3.700000000000001, -3.7000000000000006, -3.500000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000002, -4.100000000000001, -3.600000000000001, -3.9000000000000012], "episode_lengths": [21, 21, 21, 21, 14, 21, 21, 21, 21, 3, 21, 6, 21, 3, 11, 9, 21, 2, 3, 21, 6, 2, 6, 21, 21, 21, 6, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 9, 21, 21, 16, 12, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 10, 21, 21, 20, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 18, 5, 10, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 13, 21, 21, 5, 11, 21, 21, 21, 21, 11, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.69541187239235, "mean_inference_ms": 18.335107749624196, "mean_action_processing_ms": 0.970600446784211, "mean_env_wait_ms": 1.7968496363426785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07733581135573897, "StateBufferConnector_ms": 0.010157904578644095, "ViewRequirementAgentConnector_ms": 0.14292626704984498}}, "episode_reward_max": -3.3000000000000007, "episode_reward_min": -12.700000000000001, "episode_reward_mean": -5.168932038834952, "episode_len_mean": 18.796116504854368, "episodes_this_iter": 206, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.6000000000000005, -3.9000000000000012, -3.7000000000000006, -4.100000000000001, -11.5, -3.9000000000000012, -3.800000000000001, -3.900000000000001, -3.700000000000001, -10.2, -3.5000000000000004, -10.8, -3.900000000000001, -10.2, -11.4, -10.9, -4.000000000000002, -10.1, -10.3, -4.0, -10.7, -10.1, -10.6, -3.9000000000000012, -3.900000000000001, -3.8000000000000007, -10.6, -3.700000000000001, -3.900000000000001, -10.5, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.800000000000001, -3.8000000000000007, -3.800000000000001, -3.7000000000000006, -10.2, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -10.9, -3.7000000000000006, -3.700000000000001, -12.200000000000001, -11.5, -3.900000000000001, -3.6000000000000005, -3.900000000000001, -3.7000000000000006, -4.200000000000001, -4.100000000000001, -12.3, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -11.3, -3.3000000000000007, -3.500000000000001, -12.600000000000001, -4.200000000000001, -12.700000000000001, -4.000000000000001, -3.600000000000001, -3.9000000000000012, -3.9000000000000012, -3.7000000000000006, -4.000000000000001, -4.000000000000001, -3.500000000000001, -3.700000000000001, -3.5000000000000004, -3.700000000000001, -10.5, -4.100000000000001, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -10.7, -3.8000000000000007, -3.700000000000001, -3.500000000000001, -3.600000000000001, -3.8000000000000007, -4.100000000000001, -3.700000000000001, -3.7000000000000006, -3.600000000000001, -3.900000000000001, -3.9000000000000012, -3.7000000000000006, -3.700000000000001, -3.900000000000001, -4.200000000000001, -3.5000000000000004, -3.8000000000000007, -4.200000000000001, -3.6000000000000005, -4.100000000000001, -3.700000000000001, -10.7, -3.8000000000000007, -3.700000000000001, -3.8000000000000003, -3.900000000000001, -3.6000000000000005, -12.600000000000001, -10.4, -11.0, -3.800000000000001, -4.000000000000002, -3.8000000000000007, -4.200000000000001, -4.100000000000001, -4.200000000000001, -10.5, -3.7000000000000006, -3.900000000000001, -3.6000000000000005, -12.200000000000001, -3.900000000000001, -3.600000000000001, -3.4000000000000004, -3.8000000000000007, -3.900000000000001, -3.9000000000000012, -3.8000000000000007, -3.800000000000001, -4.000000000000001, -3.7000000000000006, -3.900000000000001, -3.5000000000000004, -3.8000000000000007, -3.800000000000001, -3.700000000000001, -3.8000000000000007, -3.9000000000000004, -4.000000000000001, -3.7000000000000006, -3.8000000000000007, -11.0, -3.7000000000000006, -4.200000000000001, -4.000000000000002, -3.900000000000001, -3.9000000000000012, -3.8000000000000007, -3.600000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.9000000000000012, -11.6, -3.900000000000001, -4.0, -11.5, -3.600000000000001, -3.6000000000000005, -3.500000000000001, -4.000000000000001, -3.800000000000001, -3.600000000000001, -3.7000000000000006, -3.700000000000001, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -3.9000000000000012, -3.7000000000000006, -4.100000000000001, -3.8000000000000007, -3.9000000000000004, -3.800000000000001, -3.500000000000001, -3.7000000000000015, -3.9000000000000012, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000002, -3.700000000000001, -10.8, -4.000000000000002, -11.6, -4.200000000000001, -3.8000000000000007, -10.4, -11.2, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -11.4, -11.1, -4.100000000000001, -3.8000000000000007, -3.700000000000001, -3.7000000000000006, -3.500000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000002, -4.100000000000001, -3.600000000000001, -3.9000000000000012], "episode_lengths": [21, 21, 21, 21, 14, 21, 21, 21, 21, 3, 21, 6, 21, 3, 11, 9, 21, 2, 3, 21, 6, 2, 6, 21, 21, 21, 6, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 9, 21, 21, 16, 12, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 10, 21, 21, 20, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 18, 5, 10, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 13, 21, 21, 5, 11, 21, 21, 21, 21, 11, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.69541187239235, "mean_inference_ms": 18.335107749624196, "mean_action_processing_ms": 0.970600446784211, "mean_env_wait_ms": 1.7968496363426785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07733581135573897, "StateBufferConnector_ms": 0.010157904578644095, "ViewRequirementAgentConnector_ms": 0.14292626704984498}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 170907.839, "load_time_ms": 1.164, "load_throughput": 3435490.12, "learn_time_ms": 169945.862, "learn_throughput": 23.537, "synch_weights_time_ms": 181.79}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "episodes_total": 6414, "training_iteration": 30, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-06_22-21-03", "timestamp": 1680812463, "time_this_iter_s": 170.96265530586243, "time_total_s": 5128.696249008179, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0147659250>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01475ec820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 5128.696249008179, "timesteps_since_restore": 0, "iterations_since_restore": 30, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.381893004115226, "ram_util_percent": 23.600411522633745}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.954481286900018, "cur_kl_coeff": 10.947347259521484, "cur_lr": 0.01, "total_loss": 1.1004557696561659, "policy_loss": 0.002044485060758488, "vf_loss": 0.8942418036121194, "vf_explained_var": 0.4750018643435612, "kl": 0.01865013255456072, "entropy": 3.1645043875581473, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 28365.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "sampler_results": {"episode_reward_max": -3.400000000000001, "episode_reward_min": -12.7, "episode_reward_mean": -5.3582222222222216, "episode_len_mean": 17.90222222222222, "episode_media": {}, "episodes_this_iter": 225, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.8000000000000007, -3.9000000000000012, -3.8000000000000007, -3.800000000000001, -3.8000000000000007, -3.8000000000000007, -3.700000000000001, -3.900000000000001, -10.4, -3.6000000000000005, -10.2, -10.2, -10.1, -10.6, -3.800000000000001, -10.3, -10.2, -10.7, -3.5000000000000004, -10.6, -12.2, -10.2, -10.7, -11.4, -3.900000000000001, -10.4, -10.2, -10.3, -10.7, -10.3, -4.000000000000001, -3.600000000000001, -3.7000000000000006, -4.000000000000001, -3.6000000000000005, -3.7000000000000006, -4.000000000000002, -3.900000000000001, -3.6000000000000005, -4.0, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -3.9000000000000004, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -3.800000000000001, -3.7000000000000006, -3.5000000000000004, -4.100000000000001, -3.800000000000001, -10.7, -12.7, -4.000000000000001, -4.0, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000002, -3.9000000000000012, -3.700000000000001, -3.9000000000000012, -3.8000000000000007, -11.1, -10.5, -3.8000000000000007, -10.7, -4.000000000000001, -10.6, -11.6, -10.8, -4.000000000000001, -3.9000000000000012, -3.6, -3.6000000000000005, -3.600000000000001, -3.700000000000001, -3.7000000000000006, -3.6000000000000005, -3.7, -10.6, -3.7000000000000006, -3.7, -3.900000000000001, -3.8000000000000007, -4.0, -3.8000000000000007, -4.0, -3.900000000000001, -3.900000000000001, -4.000000000000002, -3.600000000000001, -3.8000000000000007, -3.700000000000001, -3.8000000000000007, -3.9000000000000012, -3.9000000000000012, -3.800000000000001, -3.600000000000001, -3.9000000000000004, -4.200000000000001, -3.8000000000000007, -3.800000000000001, -10.0, -3.7000000000000006, -10.2, -10.0, -3.5000000000000004, -3.7000000000000006, -11.3, -3.900000000000001, -11.3, -3.800000000000001, -3.8000000000000007, -4.000000000000001, -11.3, -3.900000000000001, -10.1, -3.7000000000000006, -10.1, -3.700000000000001, -4.000000000000001, -3.8000000000000003, -10.5, -10.4, -10.8, -11.8, -3.7000000000000006, -10.2, -10.6, -10.3, -3.7000000000000006, -3.8000000000000007, -12.4, -3.600000000000001, -3.600000000000001, -3.6000000000000005, -3.700000000000001, -3.8000000000000003, -3.8000000000000007, -3.8000000000000007, -3.600000000000001, -3.8000000000000007, -3.800000000000001, -4.0, -4.000000000000002, -3.600000000000001, -4.000000000000001, -4.300000000000001, -3.6000000000000005, -3.8000000000000007, -4.100000000000001, -3.7000000000000006, -3.400000000000001, -3.8000000000000007, -4.000000000000001, -3.700000000000001, -3.700000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -4.200000000000001, -3.8000000000000007, -3.600000000000001, -3.8000000000000003, -3.7000000000000006, -11.2, -3.900000000000001, -3.7000000000000006, -3.9000000000000012, -11.0, -11.1, -4.200000000000001, -3.8000000000000007, -3.7000000000000006, -4.000000000000001, -3.5000000000000004, -3.8000000000000007, -10.9, -3.7000000000000006, -4.000000000000001, -3.6000000000000005, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.6000000000000005, -4.100000000000001, -3.8000000000000007, -10.4, -3.500000000000001, -3.500000000000001, -3.900000000000001, -10.4, -3.800000000000001, -4.000000000000002, -3.7000000000000006, -3.6000000000000005, -3.8000000000000007, -3.7000000000000006, -4.100000000000001, -3.6, -3.900000000000001, -12.5, -3.800000000000001, -3.7000000000000006, -3.7000000000000006, -3.7000000000000006, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -3.9000000000000012, -3.800000000000001, -3.900000000000001, -4.000000000000001, -3.9000000000000012, -3.9000000000000012, -3.800000000000001, -3.8000000000000007], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 3, 3, 2, 5, 21, 4, 3, 6, 21, 7, 16, 3, 8, 11, 21, 5, 3, 4, 6, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 6, 21, 7, 21, 5, 13, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21, 3, 1, 21, 21, 11, 21, 12, 21, 21, 21, 10, 21, 2, 21, 2, 21, 21, 21, 6, 5, 8, 15, 21, 3, 6, 4, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 9, 10, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.71178363384384, "mean_inference_ms": 18.328977862290014, "mean_action_processing_ms": 0.966982125681401, "mean_env_wait_ms": 1.7928116734071804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07475641038682726, "StateBufferConnector_ms": 0.00946097903781467, "ViewRequirementAgentConnector_ms": 0.13779926300048828}}, "episode_reward_max": -3.400000000000001, "episode_reward_min": -12.7, "episode_reward_mean": -5.3582222222222216, "episode_len_mean": 17.90222222222222, "episodes_this_iter": 225, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.8000000000000007, -3.9000000000000012, -3.8000000000000007, -3.800000000000001, -3.8000000000000007, -3.8000000000000007, -3.700000000000001, -3.900000000000001, -10.4, -3.6000000000000005, -10.2, -10.2, -10.1, -10.6, -3.800000000000001, -10.3, -10.2, -10.7, -3.5000000000000004, -10.6, -12.2, -10.2, -10.7, -11.4, -3.900000000000001, -10.4, -10.2, -10.3, -10.7, -10.3, -4.000000000000001, -3.600000000000001, -3.7000000000000006, -4.000000000000001, -3.6000000000000005, -3.7000000000000006, -4.000000000000002, -3.900000000000001, -3.6000000000000005, -4.0, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -3.9000000000000004, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -3.800000000000001, -3.7000000000000006, -3.5000000000000004, -4.100000000000001, -3.800000000000001, -10.7, -12.7, -4.000000000000001, -4.0, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000002, -3.9000000000000012, -3.700000000000001, -3.9000000000000012, -3.8000000000000007, -11.1, -10.5, -3.8000000000000007, -10.7, -4.000000000000001, -10.6, -11.6, -10.8, -4.000000000000001, -3.9000000000000012, -3.6, -3.6000000000000005, -3.600000000000001, -3.700000000000001, -3.7000000000000006, -3.6000000000000005, -3.7, -10.6, -3.7000000000000006, -3.7, -3.900000000000001, -3.8000000000000007, -4.0, -3.8000000000000007, -4.0, -3.900000000000001, -3.900000000000001, -4.000000000000002, -3.600000000000001, -3.8000000000000007, -3.700000000000001, -3.8000000000000007, -3.9000000000000012, -3.9000000000000012, -3.800000000000001, -3.600000000000001, -3.9000000000000004, -4.200000000000001, -3.8000000000000007, -3.800000000000001, -10.0, -3.7000000000000006, -10.2, -10.0, -3.5000000000000004, -3.7000000000000006, -11.3, -3.900000000000001, -11.3, -3.800000000000001, -3.8000000000000007, -4.000000000000001, -11.3, -3.900000000000001, -10.1, -3.7000000000000006, -10.1, -3.700000000000001, -4.000000000000001, -3.8000000000000003, -10.5, -10.4, -10.8, -11.8, -3.7000000000000006, -10.2, -10.6, -10.3, -3.7000000000000006, -3.8000000000000007, -12.4, -3.600000000000001, -3.600000000000001, -3.6000000000000005, -3.700000000000001, -3.8000000000000003, -3.8000000000000007, -3.8000000000000007, -3.600000000000001, -3.8000000000000007, -3.800000000000001, -4.0, -4.000000000000002, -3.600000000000001, -4.000000000000001, -4.300000000000001, -3.6000000000000005, -3.8000000000000007, -4.100000000000001, -3.7000000000000006, -3.400000000000001, -3.8000000000000007, -4.000000000000001, -3.700000000000001, -3.700000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -4.200000000000001, -3.8000000000000007, -3.600000000000001, -3.8000000000000003, -3.7000000000000006, -11.2, -3.900000000000001, -3.7000000000000006, -3.9000000000000012, -11.0, -11.1, -4.200000000000001, -3.8000000000000007, -3.7000000000000006, -4.000000000000001, -3.5000000000000004, -3.8000000000000007, -10.9, -3.7000000000000006, -4.000000000000001, -3.6000000000000005, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.6000000000000005, -4.100000000000001, -3.8000000000000007, -10.4, -3.500000000000001, -3.500000000000001, -3.900000000000001, -10.4, -3.800000000000001, -4.000000000000002, -3.7000000000000006, -3.6000000000000005, -3.8000000000000007, -3.7000000000000006, -4.100000000000001, -3.6, -3.900000000000001, -12.5, -3.800000000000001, -3.7000000000000006, -3.7000000000000006, -3.7000000000000006, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -3.9000000000000012, -3.800000000000001, -3.900000000000001, -4.000000000000001, -3.9000000000000012, -3.9000000000000012, -3.800000000000001, -3.8000000000000007], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 3, 3, 2, 5, 21, 4, 3, 6, 21, 7, 16, 3, 8, 11, 21, 5, 3, 4, 6, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 6, 21, 7, 21, 5, 13, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21, 3, 1, 21, 21, 11, 21, 12, 21, 21, 21, 10, 21, 2, 21, 2, 21, 21, 21, 6, 5, 8, 15, 21, 3, 6, 4, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 9, 10, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.71178363384384, "mean_inference_ms": 18.328977862290014, "mean_action_processing_ms": 0.966982125681401, "mean_env_wait_ms": 1.7928116734071804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07475641038682726, "StateBufferConnector_ms": 0.00946097903781467, "ViewRequirementAgentConnector_ms": 0.13779926300048828}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 124000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 124000, "timers": {"training_iteration_time_ms": 170859.868, "load_time_ms": 1.163, "load_throughput": 3440139.433, "learn_time_ms": 169901.481, "learn_throughput": 23.543, "synch_weights_time_ms": 183.615}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "done": false, "episodes_total": 6639, "training_iteration": 31, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-06_22-23-54", "timestamp": 1680812634, "time_this_iter_s": 170.7005491256714, "time_total_s": 5299.39679813385, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01475a2b50>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01475d81f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 5299.39679813385, "timesteps_since_restore": 0, "iterations_since_restore": 31, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.326748971193415, "ram_util_percent": 23.60082304526749}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.755197559377198, "cur_kl_coeff": 10.947347259521484, "cur_lr": 0.01, "total_loss": 0.9867716470913541, "policy_loss": 0.0014803784148346992, "vf_loss": 0.8034583828261783, "vf_explained_var": 0.4257139430251173, "kl": 0.01660976648845169, "entropy": 3.165285381450448, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "sampler_results": {"episode_reward_max": -3.4000000000000004, "episode_reward_min": -12.700000000000001, "episode_reward_mean": -5.0200000000000005, "episode_len_mean": 19.11627906976744, "episode_media": {}, "episodes_this_iter": 215, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.9000000000000012, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -11.5, -3.8000000000000007, -4.0, -3.700000000000001, -3.800000000000001, -4.200000000000001, -10.8, -3.900000000000001, -10.0, -3.7000000000000006, -4.200000000000001, -3.8000000000000007, -10.3, -10.4, -3.900000000000001, -10.0, -3.7000000000000006, -10.3, -3.8000000000000003, -10.5, -3.6000000000000005, -3.800000000000001, -12.3, -3.600000000000001, -4.000000000000001, -3.9000000000000012, -3.8000000000000007, -3.7000000000000006, -3.900000000000001, -3.8000000000000007, -3.9000000000000004, -3.900000000000001, -4.0, -4.000000000000001, -3.7000000000000006, -3.5000000000000004, -3.8000000000000007, -3.7000000000000006, -3.800000000000001, -4.000000000000001, -3.800000000000001, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -3.8000000000000007, -11.3, -3.8000000000000007, -12.4, -10.2, -3.900000000000001, -3.500000000000001, -3.6000000000000005, -3.900000000000001, -3.9000000000000012, -3.6000000000000005, -3.8000000000000007, -3.5000000000000004, -3.8000000000000007, -10.4, -3.4000000000000004, -3.900000000000001, -3.900000000000001, -10.4, -4.000000000000001, -4.100000000000001, -11.1, -3.600000000000001, -3.900000000000001, -3.900000000000001, -10.4, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -3.8000000000000003, -3.9000000000000012, -3.800000000000001, -4.000000000000002, -3.800000000000001, -4.000000000000001, -12.3, -4.100000000000001, -3.700000000000001, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -3.6000000000000005, -3.8000000000000007, -4.000000000000001, -3.500000000000001, -4.100000000000001, -3.8000000000000007, -3.9000000000000012, -3.8000000000000007, -10.2, -11.4, -4.100000000000001, -10.6, -3.6000000000000005, -3.8000000000000003, -3.7000000000000006, -3.900000000000001, -3.600000000000001, -3.7000000000000006, -3.6000000000000005, -4.000000000000002, -3.7000000000000006, -10.2, -11.2, -3.900000000000001, -3.9000000000000012, -11.0, -3.700000000000001, -3.8000000000000007, -10.1, -3.5000000000000004, -3.600000000000001, -3.800000000000001, -3.900000000000001, -4.000000000000002, -3.500000000000001, -4.100000000000001, -3.700000000000001, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -3.6000000000000005, -3.7000000000000006, -3.700000000000001, -10.5, -3.9000000000000012, -11.8, -12.5, -3.700000000000001, -4.200000000000001, -3.900000000000001, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -3.900000000000001, -3.9000000000000004, -3.600000000000001, -3.8000000000000007, -3.800000000000001, -3.8000000000000003, -12.5, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.800000000000001, -4.000000000000001, -3.900000000000001, -11.7, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -4.200000000000001, -3.500000000000001, -11.9, -3.600000000000001, -4.200000000000001, -3.6000000000000005, -4.000000000000001, -3.7000000000000006, -4.000000000000002, -3.8000000000000007, -3.7000000000000006, -3.8000000000000007, -3.800000000000001, -3.800000000000001, -3.8000000000000007, -3.700000000000001, -3.800000000000001, -11.2, -3.600000000000001, -4.000000000000001, -3.700000000000001, -4.000000000000001, -3.800000000000001, -3.8000000000000007, -4.000000000000001, -12.600000000000001, -3.8000000000000007, -4.0, -3.9000000000000004, -4.000000000000001, -3.900000000000001, -11.6, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -3.9000000000000012, -12.700000000000001, -3.700000000000001, -4.100000000000001, -3.800000000000001, -10.7, -3.700000000000001, -3.7000000000000006, -3.8000000000000007, -4.200000000000001, -4.000000000000001, -3.4000000000000004, -3.900000000000001, -3.700000000000001, -3.800000000000001, -4.000000000000002], "episode_lengths": [21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 9, 21, 1, 21, 21, 21, 4, 4, 21, 1, 21, 4, 21, 5, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 19, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 5, 21, 21, 10, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 12, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 10, 21, 21, 10, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 12, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 19, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.691867973965103, "mean_inference_ms": 18.278368617143844, "mean_action_processing_ms": 0.9661891613263323, "mean_env_wait_ms": 1.7825730154979074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07012577944023665, "StateBufferConnector_ms": 0.008844663930493732, "ViewRequirementAgentConnector_ms": 0.12875379518020985}}, "episode_reward_max": -3.4000000000000004, "episode_reward_min": -12.700000000000001, "episode_reward_mean": -5.0200000000000005, "episode_len_mean": 19.11627906976744, "episodes_this_iter": 215, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.9000000000000012, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -11.5, -3.8000000000000007, -4.0, -3.700000000000001, -3.800000000000001, -4.200000000000001, -10.8, -3.900000000000001, -10.0, -3.7000000000000006, -4.200000000000001, -3.8000000000000007, -10.3, -10.4, -3.900000000000001, -10.0, -3.7000000000000006, -10.3, -3.8000000000000003, -10.5, -3.6000000000000005, -3.800000000000001, -12.3, -3.600000000000001, -4.000000000000001, -3.9000000000000012, -3.8000000000000007, -3.7000000000000006, -3.900000000000001, -3.8000000000000007, -3.9000000000000004, -3.900000000000001, -4.0, -4.000000000000001, -3.7000000000000006, -3.5000000000000004, -3.8000000000000007, -3.7000000000000006, -3.800000000000001, -4.000000000000001, -3.800000000000001, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -3.8000000000000007, -11.3, -3.8000000000000007, -12.4, -10.2, -3.900000000000001, -3.500000000000001, -3.6000000000000005, -3.900000000000001, -3.9000000000000012, -3.6000000000000005, -3.8000000000000007, -3.5000000000000004, -3.8000000000000007, -10.4, -3.4000000000000004, -3.900000000000001, -3.900000000000001, -10.4, -4.000000000000001, -4.100000000000001, -11.1, -3.600000000000001, -3.900000000000001, -3.900000000000001, -10.4, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -3.8000000000000003, -3.9000000000000012, -3.800000000000001, -4.000000000000002, -3.800000000000001, -4.000000000000001, -12.3, -4.100000000000001, -3.700000000000001, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -3.6000000000000005, -3.8000000000000007, -4.000000000000001, -3.500000000000001, -4.100000000000001, -3.8000000000000007, -3.9000000000000012, -3.8000000000000007, -10.2, -11.4, -4.100000000000001, -10.6, -3.6000000000000005, -3.8000000000000003, -3.7000000000000006, -3.900000000000001, -3.600000000000001, -3.7000000000000006, -3.6000000000000005, -4.000000000000002, -3.7000000000000006, -10.2, -11.2, -3.900000000000001, -3.9000000000000012, -11.0, -3.700000000000001, -3.8000000000000007, -10.1, -3.5000000000000004, -3.600000000000001, -3.800000000000001, -3.900000000000001, -4.000000000000002, -3.500000000000001, -4.100000000000001, -3.700000000000001, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -3.6000000000000005, -3.7000000000000006, -3.700000000000001, -10.5, -3.9000000000000012, -11.8, -12.5, -3.700000000000001, -4.200000000000001, -3.900000000000001, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -3.900000000000001, -3.9000000000000004, -3.600000000000001, -3.8000000000000007, -3.800000000000001, -3.8000000000000003, -12.5, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.800000000000001, -4.000000000000001, -3.900000000000001, -11.7, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -4.200000000000001, -3.500000000000001, -11.9, -3.600000000000001, -4.200000000000001, -3.6000000000000005, -4.000000000000001, -3.7000000000000006, -4.000000000000002, -3.8000000000000007, -3.7000000000000006, -3.8000000000000007, -3.800000000000001, -3.800000000000001, -3.8000000000000007, -3.700000000000001, -3.800000000000001, -11.2, -3.600000000000001, -4.000000000000001, -3.700000000000001, -4.000000000000001, -3.800000000000001, -3.8000000000000007, -4.000000000000001, -12.600000000000001, -3.8000000000000007, -4.0, -3.9000000000000004, -4.000000000000001, -3.900000000000001, -11.6, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -3.9000000000000012, -12.700000000000001, -3.700000000000001, -4.100000000000001, -3.800000000000001, -10.7, -3.700000000000001, -3.7000000000000006, -3.8000000000000007, -4.200000000000001, -4.000000000000001, -3.4000000000000004, -3.900000000000001, -3.700000000000001, -3.800000000000001, -4.000000000000002], "episode_lengths": [21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 9, 21, 1, 21, 21, 21, 4, 4, 21, 1, 21, 4, 21, 5, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 19, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 5, 21, 21, 10, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 12, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 10, 21, 21, 10, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 12, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 19, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.691867973965103, "mean_inference_ms": 18.278368617143844, "mean_action_processing_ms": 0.9661891613263323, "mean_env_wait_ms": 1.7825730154979074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07012577944023665, "StateBufferConnector_ms": 0.008844663930493732, "ViewRequirementAgentConnector_ms": 0.12875379518020985}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 170948.857, "load_time_ms": 1.167, "load_throughput": 3428609.732, "learn_time_ms": 169987.817, "learn_throughput": 23.531, "synch_weights_time_ms": 180.337}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "episodes_total": 6854, "training_iteration": 32, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-06_22-26-45", "timestamp": 1680812805, "time_this_iter_s": 171.60938787460327, "time_total_s": 5471.006186008453, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0147740460>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0147716f70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 5471.006186008453, "timesteps_since_restore": 0, "iterations_since_restore": 32, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.613934426229507, "ram_util_percent": 23.59754098360656}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.798808137575785, "cur_kl_coeff": 10.947347259521484, "cur_lr": 0.01, "total_loss": 0.9545991665368239, "policy_loss": -0.0008417110722411864, "vf_loss": 0.7903320121709058, "vf_explained_var": 0.4925451219722789, "kl": 0.015082088413601992, "entropy": 3.131951343372304, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 30225.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "sampler_results": {"episode_reward_max": -3.400000000000001, "episode_reward_min": -13.0, "episode_reward_mean": -5.155238095238096, "episode_len_mean": 18.728571428571428, "episode_media": {}, "episodes_this_iter": 210, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.500000000000001, -3.7, -4.100000000000001, -4.000000000000001, -4.000000000000002, -3.9000000000000012, -3.8000000000000007, -3.400000000000001, -4.000000000000001, -10.4, -10.7, -12.1, -4.0, -10.5, -10.4, -3.900000000000001, -10.1, -10.3, -10.4, -10.7, -10.2, -3.8000000000000007, -3.800000000000001, -10.6, -11.3, -3.8000000000000007, -3.7000000000000006, -4.100000000000001, -3.800000000000001, -3.600000000000001, -3.800000000000001, -11.3, -3.900000000000001, -3.900000000000001, -3.700000000000001, -3.8000000000000007, -3.800000000000001, -3.8000000000000007, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -3.800000000000001, -3.6000000000000005, -3.7000000000000006, -3.8000000000000007, -3.800000000000001, -13.0, -3.8000000000000007, -12.1, -11.7, -3.900000000000001, -3.9000000000000004, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -4.1000000000000005, -3.8000000000000007, -3.6000000000000005, -3.900000000000001, -3.700000000000001, -4.100000000000001, -3.7000000000000006, -3.5000000000000004, -4.300000000000001, -4.200000000000001, -3.9000000000000012, -3.600000000000001, -3.9000000000000012, -3.8000000000000007, -3.900000000000001, -3.9000000000000012, -4.000000000000002, -3.6000000000000005, -3.8000000000000007, -4.000000000000002, -3.8000000000000007, -3.800000000000001, -4.000000000000001, -3.8000000000000007, -3.7000000000000006, -3.8000000000000007, -3.9000000000000012, -3.900000000000001, -3.500000000000001, -3.600000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.600000000000001, -10.8, -3.600000000000001, -4.100000000000001, -12.5, -3.700000000000001, -3.6000000000000005, -3.7000000000000006, -3.8000000000000003, -11.4, -3.8000000000000007, -10.3, -12.4, -10.4, -10.0, -11.1, -3.8000000000000007, -3.6000000000000005, -3.7000000000000006, -10.0, -11.7, -3.6000000000000005, -10.2, -11.5, -3.5000000000000004, -10.5, -3.7000000000000006, -4.000000000000002, -12.2, -3.600000000000001, -3.900000000000001, -4.300000000000001, -3.7000000000000006, -3.700000000000001, -3.700000000000001, -3.8000000000000007, -3.600000000000001, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -4.100000000000001, -11.0, -3.900000000000001, -4.1000000000000005, -3.8000000000000003, -3.800000000000001, -3.6000000000000005, -3.5000000000000004, -4.100000000000001, -4.0, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -3.6, -11.7, -3.9000000000000012, -3.900000000000001, -10.3, -3.700000000000001, -3.900000000000001, -3.600000000000001, -3.9000000000000012, -3.6000000000000005, -4.100000000000001, -3.6000000000000005, -3.8000000000000007, -3.7000000000000006, -3.8000000000000003, -10.1, -3.8000000000000007, -3.700000000000001, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.800000000000001, -3.900000000000001, -3.700000000000001, -11.9, -3.7000000000000006, -10.2, -3.800000000000001, -3.7000000000000006, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.800000000000001, -4.200000000000001, -3.600000000000001, -3.900000000000001, -3.800000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.700000000000001, -3.800000000000001, -3.8000000000000007, -3.900000000000001, -10.4, -3.8000000000000003, -4.100000000000001, -3.7000000000000006, -4.000000000000001, -11.2, -4.000000000000001, -4.100000000000001, -3.7000000000000006, -3.800000000000001, -3.800000000000001, -3.800000000000001, -3.8000000000000007, -4.100000000000001, -11.3, -3.7000000000000006, -3.800000000000001, -3.900000000000001, -4.000000000000002], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 8, 16, 21, 6, 5, 21, 2, 3, 5, 6, 3, 21, 21, 7, 10, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 17, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 19, 21, 21, 21, 21, 12, 21, 3, 20, 4, 1, 10, 21, 21, 21, 1, 13, 21, 3, 13, 21, 5, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.685278846142177, "mean_inference_ms": 18.240994181089203, "mean_action_processing_ms": 0.9635642131186812, "mean_env_wait_ms": 1.7771288775099205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07090455009823754, "StateBufferConnector_ms": 0.00887087413242885, "ViewRequirementAgentConnector_ms": 0.13155301411946616}}, "episode_reward_max": -3.400000000000001, "episode_reward_min": -13.0, "episode_reward_mean": -5.155238095238096, "episode_len_mean": 18.728571428571428, "episodes_this_iter": 210, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.500000000000001, -3.7, -4.100000000000001, -4.000000000000001, -4.000000000000002, -3.9000000000000012, -3.8000000000000007, -3.400000000000001, -4.000000000000001, -10.4, -10.7, -12.1, -4.0, -10.5, -10.4, -3.900000000000001, -10.1, -10.3, -10.4, -10.7, -10.2, -3.8000000000000007, -3.800000000000001, -10.6, -11.3, -3.8000000000000007, -3.7000000000000006, -4.100000000000001, -3.800000000000001, -3.600000000000001, -3.800000000000001, -11.3, -3.900000000000001, -3.900000000000001, -3.700000000000001, -3.8000000000000007, -3.800000000000001, -3.8000000000000007, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -3.800000000000001, -3.6000000000000005, -3.7000000000000006, -3.8000000000000007, -3.800000000000001, -13.0, -3.8000000000000007, -12.1, -11.7, -3.900000000000001, -3.9000000000000004, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -4.1000000000000005, -3.8000000000000007, -3.6000000000000005, -3.900000000000001, -3.700000000000001, -4.100000000000001, -3.7000000000000006, -3.5000000000000004, -4.300000000000001, -4.200000000000001, -3.9000000000000012, -3.600000000000001, -3.9000000000000012, -3.8000000000000007, -3.900000000000001, -3.9000000000000012, -4.000000000000002, -3.6000000000000005, -3.8000000000000007, -4.000000000000002, -3.8000000000000007, -3.800000000000001, -4.000000000000001, -3.8000000000000007, -3.7000000000000006, -3.8000000000000007, -3.9000000000000012, -3.900000000000001, -3.500000000000001, -3.600000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.600000000000001, -10.8, -3.600000000000001, -4.100000000000001, -12.5, -3.700000000000001, -3.6000000000000005, -3.7000000000000006, -3.8000000000000003, -11.4, -3.8000000000000007, -10.3, -12.4, -10.4, -10.0, -11.1, -3.8000000000000007, -3.6000000000000005, -3.7000000000000006, -10.0, -11.7, -3.6000000000000005, -10.2, -11.5, -3.5000000000000004, -10.5, -3.7000000000000006, -4.000000000000002, -12.2, -3.600000000000001, -3.900000000000001, -4.300000000000001, -3.7000000000000006, -3.700000000000001, -3.700000000000001, -3.8000000000000007, -3.600000000000001, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -4.100000000000001, -11.0, -3.900000000000001, -4.1000000000000005, -3.8000000000000003, -3.800000000000001, -3.6000000000000005, -3.5000000000000004, -4.100000000000001, -4.0, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -3.6, -11.7, -3.9000000000000012, -3.900000000000001, -10.3, -3.700000000000001, -3.900000000000001, -3.600000000000001, -3.9000000000000012, -3.6000000000000005, -4.100000000000001, -3.6000000000000005, -3.8000000000000007, -3.7000000000000006, -3.8000000000000003, -10.1, -3.8000000000000007, -3.700000000000001, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.800000000000001, -3.900000000000001, -3.700000000000001, -11.9, -3.7000000000000006, -10.2, -3.800000000000001, -3.7000000000000006, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.800000000000001, -4.200000000000001, -3.600000000000001, -3.900000000000001, -3.800000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.700000000000001, -3.800000000000001, -3.8000000000000007, -3.900000000000001, -10.4, -3.8000000000000003, -4.100000000000001, -3.7000000000000006, -4.000000000000001, -11.2, -4.000000000000001, -4.100000000000001, -3.7000000000000006, -3.800000000000001, -3.800000000000001, -3.800000000000001, -3.8000000000000007, -4.100000000000001, -11.3, -3.7000000000000006, -3.800000000000001, -3.900000000000001, -4.000000000000002], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 8, 16, 21, 6, 5, 21, 2, 3, 5, 6, 3, 21, 21, 7, 10, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 17, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 19, 21, 21, 21, 21, 12, 21, 3, 20, 4, 1, 10, 21, 21, 21, 1, 13, 21, 3, 13, 21, 5, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.685278846142177, "mean_inference_ms": 18.240994181089203, "mean_action_processing_ms": 0.9635642131186812, "mean_env_wait_ms": 1.7771288775099205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07090455009823754, "StateBufferConnector_ms": 0.00887087413242885, "ViewRequirementAgentConnector_ms": 0.13155301411946616}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 132000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 170978.859, "load_time_ms": 1.174, "load_throughput": 3406679.662, "learn_time_ms": 170016.32, "learn_throughput": 23.527, "synch_weights_time_ms": 184.208}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "episodes_total": 7064, "training_iteration": 33, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-06_22-29-36", "timestamp": 1680812976, "time_this_iter_s": 170.7295365333557, "time_total_s": 5641.735722541809, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476d1400>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01475d81f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 5641.735722541809, "timesteps_since_restore": 0, "iterations_since_restore": 33, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.393004115226337, "ram_util_percent": 23.55637860082305}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.494651819813637, "cur_kl_coeff": 10.947347259521484, "cur_lr": 0.01, "total_loss": 0.8441980677947242, "policy_loss": -0.0012217668936617913, "vf_loss": 0.6673398695525623, "vf_explained_var": 0.5270971801973159, "kl": 0.0162669511494397, "entropy": 3.1376796830085016, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 31155.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "sampler_results": {"episode_reward_max": -3.3000000000000007, "episode_reward_min": -12.5, "episode_reward_mean": -4.742647058823531, "episode_len_mean": 19.642156862745097, "episode_media": {}, "episodes_this_iter": 204, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.100000000000001, -3.8000000000000007, -4.000000000000001, -3.6000000000000005, -3.500000000000001, -4.000000000000001, -3.9000000000000004, -3.900000000000001, -4.000000000000001, -3.400000000000001, -10.3, -11.0, -10.2, -3.9000000000000004, -3.900000000000001, -10.2, -3.7000000000000006, -10.8, -10.4, -3.9000000000000012, -3.7000000000000006, -11.4, -3.900000000000001, -3.7000000000000006, -3.800000000000001, -3.7000000000000006, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.400000000000001, -10.6, -3.7000000000000006, -4.100000000000001, -3.800000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.600000000000001, -3.600000000000001, -3.800000000000001, -3.6000000000000005, -3.600000000000001, -4.200000000000001, -4.000000000000001, -3.900000000000001, -12.1, -4.200000000000001, -4.000000000000001, -3.800000000000001, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -11.8, -10.9, -4.000000000000002, -3.9000000000000012, -4.000000000000002, -11.9, -3.8000000000000007, -4.200000000000001, -11.2, -10.7, -4.100000000000001, -3.9000000000000012, -11.5, -4.000000000000002, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -10.9, -3.6000000000000005, -11.4, -3.400000000000001, -3.800000000000001, -4.000000000000001, -4.000000000000001, -11.1, -3.700000000000001, -3.9000000000000004, -3.900000000000001, -3.800000000000001, -3.900000000000001, -4.200000000000001, -3.600000000000001, -4.000000000000002, -4.000000000000001, -3.700000000000001, -3.4000000000000004, -3.9000000000000012, -3.6000000000000005, -3.8000000000000003, -3.900000000000001, -3.800000000000001, -3.9000000000000012, -3.8000000000000007, -3.8000000000000007, -3.7000000000000006, -3.9000000000000004, -3.900000000000001, -3.800000000000001, -3.8000000000000007, -3.6000000000000005, -3.600000000000001, -3.8000000000000007, -11.8, -10.1, -4.000000000000001, -3.7000000000000006, -3.7000000000000006, -3.700000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.9000000000000012, -12.5, -4.000000000000001, -4.200000000000001, -3.6000000000000005, -4.000000000000001, -3.700000000000001, -3.6000000000000005, -3.700000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000002, -3.900000000000001, -3.900000000000001, -3.700000000000001, -10.6, -3.6000000000000005, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -4.0, -3.4000000000000004, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.800000000000001, -3.8000000000000007, -3.900000000000001, -3.700000000000001, -4.000000000000001, -3.800000000000001, -3.8000000000000007, -4.200000000000001, -4.100000000000001, -3.800000000000001, -4.000000000000001, -3.900000000000001, -4.200000000000001, -3.900000000000001, -3.900000000000001, -12.4, -3.7000000000000006, -3.500000000000001, -3.900000000000001, -3.8000000000000007, -3.3000000000000007, -3.9000000000000012, -4.000000000000002, -3.6000000000000005, -3.900000000000001, -3.900000000000001, -3.600000000000001, -3.6000000000000005, -3.6000000000000005, -4.200000000000001, -4.300000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000002, -3.8000000000000007, -4.0, -3.8000000000000007, -3.600000000000001, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -3.800000000000001, -3.6000000000000005, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -10.8, -4.000000000000001, -12.2, -3.8000000000000007, -3.7000000000000006, -3.800000000000001, -4.000000000000001, -4.0, -3.900000000000001, -3.800000000000001, -4.000000000000001, -3.500000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 10, 3, 21, 21, 3, 21, 8, 4, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 15, 8, 21, 21, 21, 14, 21, 21, 11, 8, 21, 21, 13, 21, 21, 21, 21, 9, 21, 12, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 2, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.664012972955922, "mean_inference_ms": 18.274599339650276, "mean_action_processing_ms": 0.9661186785205188, "mean_env_wait_ms": 1.7721977960448654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07681075264425839, "StateBufferConnector_ms": 0.008920711629530963, "ViewRequirementAgentConnector_ms": 0.13949941186343923}}, "episode_reward_max": -3.3000000000000007, "episode_reward_min": -12.5, "episode_reward_mean": -4.742647058823531, "episode_len_mean": 19.642156862745097, "episodes_this_iter": 204, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.100000000000001, -3.8000000000000007, -4.000000000000001, -3.6000000000000005, -3.500000000000001, -4.000000000000001, -3.9000000000000004, -3.900000000000001, -4.000000000000001, -3.400000000000001, -10.3, -11.0, -10.2, -3.9000000000000004, -3.900000000000001, -10.2, -3.7000000000000006, -10.8, -10.4, -3.9000000000000012, -3.7000000000000006, -11.4, -3.900000000000001, -3.7000000000000006, -3.800000000000001, -3.7000000000000006, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.400000000000001, -10.6, -3.7000000000000006, -4.100000000000001, -3.800000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.600000000000001, -3.600000000000001, -3.800000000000001, -3.6000000000000005, -3.600000000000001, -4.200000000000001, -4.000000000000001, -3.900000000000001, -12.1, -4.200000000000001, -4.000000000000001, -3.800000000000001, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -11.8, -10.9, -4.000000000000002, -3.9000000000000012, -4.000000000000002, -11.9, -3.8000000000000007, -4.200000000000001, -11.2, -10.7, -4.100000000000001, -3.9000000000000012, -11.5, -4.000000000000002, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -10.9, -3.6000000000000005, -11.4, -3.400000000000001, -3.800000000000001, -4.000000000000001, -4.000000000000001, -11.1, -3.700000000000001, -3.9000000000000004, -3.900000000000001, -3.800000000000001, -3.900000000000001, -4.200000000000001, -3.600000000000001, -4.000000000000002, -4.000000000000001, -3.700000000000001, -3.4000000000000004, -3.9000000000000012, -3.6000000000000005, -3.8000000000000003, -3.900000000000001, -3.800000000000001, -3.9000000000000012, -3.8000000000000007, -3.8000000000000007, -3.7000000000000006, -3.9000000000000004, -3.900000000000001, -3.800000000000001, -3.8000000000000007, -3.6000000000000005, -3.600000000000001, -3.8000000000000007, -11.8, -10.1, -4.000000000000001, -3.7000000000000006, -3.7000000000000006, -3.700000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.9000000000000012, -12.5, -4.000000000000001, -4.200000000000001, -3.6000000000000005, -4.000000000000001, -3.700000000000001, -3.6000000000000005, -3.700000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000002, -3.900000000000001, -3.900000000000001, -3.700000000000001, -10.6, -3.6000000000000005, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -4.0, -3.4000000000000004, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.800000000000001, -3.8000000000000007, -3.900000000000001, -3.700000000000001, -4.000000000000001, -3.800000000000001, -3.8000000000000007, -4.200000000000001, -4.100000000000001, -3.800000000000001, -4.000000000000001, -3.900000000000001, -4.200000000000001, -3.900000000000001, -3.900000000000001, -12.4, -3.7000000000000006, -3.500000000000001, -3.900000000000001, -3.8000000000000007, -3.3000000000000007, -3.9000000000000012, -4.000000000000002, -3.6000000000000005, -3.900000000000001, -3.900000000000001, -3.600000000000001, -3.6000000000000005, -3.6000000000000005, -4.200000000000001, -4.300000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000002, -3.8000000000000007, -4.0, -3.8000000000000007, -3.600000000000001, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -3.800000000000001, -3.6000000000000005, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -10.8, -4.000000000000001, -12.2, -3.8000000000000007, -3.7000000000000006, -3.800000000000001, -4.000000000000001, -4.0, -3.900000000000001, -3.800000000000001, -4.000000000000001, -3.500000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 10, 3, 21, 21, 3, 21, 8, 4, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 15, 8, 21, 21, 21, 14, 21, 21, 11, 8, 21, 21, 13, 21, 21, 21, 21, 9, 21, 12, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 2, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.664012972955922, "mean_inference_ms": 18.274599339650276, "mean_action_processing_ms": 0.9661186785205188, "mean_env_wait_ms": 1.7721977960448654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07681075264425839, "StateBufferConnector_ms": 0.008920711629530963, "ViewRequirementAgentConnector_ms": 0.13949941186343923}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 136000, "timers": {"training_iteration_time_ms": 170980.181, "load_time_ms": 1.169, "load_throughput": 3421198.638, "learn_time_ms": 170018.224, "learn_throughput": 23.527, "synch_weights_time_ms": 184.426}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "done": false, "episodes_total": 7268, "training_iteration": 34, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-06_22-32-27", "timestamp": 1680813147, "time_this_iter_s": 170.83802938461304, "time_total_s": 5812.573751926422, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01475a5940>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014757d8b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 5812.573751926422, "timesteps_since_restore": 0, "iterations_since_restore": 34, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.395454545454545, "ram_util_percent": 23.6004132231405}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.859402691164324, "cur_kl_coeff": 10.947347259521484, "cur_lr": 0.01, "total_loss": 0.6146331507191863, "policy_loss": -0.0021196188252439263, "vf_loss": 0.43758272377233354, "vf_explained_var": 0.5365920696207273, "kl": 0.01636652545377572, "entropy": 3.1070774673133768, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 32085.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "sampler_results": {"episode_reward_max": -3.400000000000001, "episode_reward_min": -12.6, "episode_reward_mean": -4.743, "episode_len_mean": 19.27, "episode_media": {}, "episodes_this_iter": 200, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.5000000000000004, -3.8000000000000007, -3.900000000000001, -3.800000000000001, -3.8000000000000007, -3.6000000000000005, -3.7000000000000006, -3.700000000000001, -4.1000000000000005, -10.2, -3.900000000000001, -3.900000000000001, -10.1, -3.400000000000001, -10.4, -3.7000000000000006, -3.700000000000001, -4.100000000000001, -3.7000000000000006, -10.3, -11.6, -3.600000000000001, -10.2, -3.7000000000000006, -3.700000000000001, -3.600000000000001, -3.800000000000001, -3.7000000000000006, -4.400000000000001, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -3.500000000000001, -3.8000000000000003, -3.8000000000000007, -3.6000000000000005, -3.9000000000000012, -3.6000000000000005, -3.600000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.600000000000001, -4.000000000000001, -4.000000000000001, -10.0, -3.400000000000001, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -10.4, -3.900000000000001, -3.9000000000000004, -3.8000000000000007, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -3.8000000000000007, -10.9, -3.6000000000000005, -10.4, -3.900000000000001, -10.6, -3.9000000000000012, -3.600000000000001, -3.600000000000001, -4.300000000000001, -4.000000000000002, -3.900000000000001, -4.100000000000001, -3.9000000000000004, -3.700000000000001, -4.100000000000001, -4.000000000000001, -3.7000000000000006, -3.9000000000000012, -4.000000000000002, -3.7000000000000006, -3.8000000000000007, -3.7000000000000006, -4.100000000000001, -4.100000000000001, -4.000000000000001, -12.4, -3.8000000000000007, -3.600000000000001, -4.000000000000001, -3.900000000000001, -3.7000000000000006, -3.9000000000000004, -3.700000000000001, -12.4, -10.9, -4.000000000000001, -3.8000000000000007, -3.7000000000000006, -12.2, -3.7000000000000006, -3.7, -11.8, -4.000000000000001, -3.6000000000000005, -10.0, -10.6, -4.200000000000001, -4.100000000000001, -3.9000000000000012, -4.100000000000001, -4.100000000000001, -4.000000000000002, -4.100000000000001, -11.5, -3.900000000000001, -3.8000000000000007, -3.600000000000001, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -4.000000000000002, -3.8000000000000007, -3.7000000000000006, -3.8000000000000007, -4.000000000000001, -3.800000000000001, -3.6000000000000005, -4.000000000000001, -3.900000000000001, -4.000000000000002, -3.600000000000001, -3.800000000000001, -3.8000000000000007, -3.900000000000001, -3.5000000000000004, -3.5000000000000004, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -3.5000000000000004, -3.7000000000000006, -3.700000000000001, -3.8000000000000007, -11.1, -4.000000000000001, -3.700000000000001, -3.800000000000001, -3.700000000000001, -4.100000000000001, -3.9000000000000012, -3.600000000000001, -3.8000000000000007, -3.500000000000001, -4.0, -4.200000000000001, -10.1, -10.5, -12.6, -3.7000000000000006, -3.900000000000001, -3.500000000000001, -3.8000000000000007, -3.800000000000001, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -4.000000000000002, -4.000000000000001, -4.000000000000001, -3.600000000000001, -3.900000000000001, -3.7000000000000006, -3.700000000000001, -10.4, -3.800000000000001, -3.9000000000000004, -3.900000000000001, -3.8000000000000007, -10.3, -3.9000000000000012, -3.900000000000001, -3.600000000000001, -3.600000000000001, -4.0, -10.0, -3.9000000000000012, -3.800000000000001, -3.8000000000000007, -3.6000000000000005, -3.8000000000000007, -3.700000000000001, -3.9000000000000004, -4.200000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 2, 21, 4, 21, 21, 21, 21, 4, 14, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 9, 21, 5, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 19, 9, 21, 21, 21, 15, 21, 21, 15, 21, 21, 1, 6, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 6, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.655360661627732, "mean_inference_ms": 18.285448187258037, "mean_action_processing_ms": 0.9665609579453625, "mean_env_wait_ms": 1.7700211875959064, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07967495918273926, "StateBufferConnector_ms": 0.009928584098815918, "ViewRequirementAgentConnector_ms": 0.14663183689117432}}, "episode_reward_max": -3.400000000000001, "episode_reward_min": -12.6, "episode_reward_mean": -4.743, "episode_len_mean": 19.27, "episodes_this_iter": 200, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.5000000000000004, -3.8000000000000007, -3.900000000000001, -3.800000000000001, -3.8000000000000007, -3.6000000000000005, -3.7000000000000006, -3.700000000000001, -4.1000000000000005, -10.2, -3.900000000000001, -3.900000000000001, -10.1, -3.400000000000001, -10.4, -3.7000000000000006, -3.700000000000001, -4.100000000000001, -3.7000000000000006, -10.3, -11.6, -3.600000000000001, -10.2, -3.7000000000000006, -3.700000000000001, -3.600000000000001, -3.800000000000001, -3.7000000000000006, -4.400000000000001, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -3.500000000000001, -3.8000000000000003, -3.8000000000000007, -3.6000000000000005, -3.9000000000000012, -3.6000000000000005, -3.600000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.600000000000001, -4.000000000000001, -4.000000000000001, -10.0, -3.400000000000001, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -10.4, -3.900000000000001, -3.9000000000000004, -3.8000000000000007, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -3.8000000000000007, -10.9, -3.6000000000000005, -10.4, -3.900000000000001, -10.6, -3.9000000000000012, -3.600000000000001, -3.600000000000001, -4.300000000000001, -4.000000000000002, -3.900000000000001, -4.100000000000001, -3.9000000000000004, -3.700000000000001, -4.100000000000001, -4.000000000000001, -3.7000000000000006, -3.9000000000000012, -4.000000000000002, -3.7000000000000006, -3.8000000000000007, -3.7000000000000006, -4.100000000000001, -4.100000000000001, -4.000000000000001, -12.4, -3.8000000000000007, -3.600000000000001, -4.000000000000001, -3.900000000000001, -3.7000000000000006, -3.9000000000000004, -3.700000000000001, -12.4, -10.9, -4.000000000000001, -3.8000000000000007, -3.7000000000000006, -12.2, -3.7000000000000006, -3.7, -11.8, -4.000000000000001, -3.6000000000000005, -10.0, -10.6, -4.200000000000001, -4.100000000000001, -3.9000000000000012, -4.100000000000001, -4.100000000000001, -4.000000000000002, -4.100000000000001, -11.5, -3.900000000000001, -3.8000000000000007, -3.600000000000001, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -4.000000000000002, -3.8000000000000007, -3.7000000000000006, -3.8000000000000007, -4.000000000000001, -3.800000000000001, -3.6000000000000005, -4.000000000000001, -3.900000000000001, -4.000000000000002, -3.600000000000001, -3.800000000000001, -3.8000000000000007, -3.900000000000001, -3.5000000000000004, -3.5000000000000004, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -3.5000000000000004, -3.7000000000000006, -3.700000000000001, -3.8000000000000007, -11.1, -4.000000000000001, -3.700000000000001, -3.800000000000001, -3.700000000000001, -4.100000000000001, -3.9000000000000012, -3.600000000000001, -3.8000000000000007, -3.500000000000001, -4.0, -4.200000000000001, -10.1, -10.5, -12.6, -3.7000000000000006, -3.900000000000001, -3.500000000000001, -3.8000000000000007, -3.800000000000001, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -4.000000000000002, -4.000000000000001, -4.000000000000001, -3.600000000000001, -3.900000000000001, -3.7000000000000006, -3.700000000000001, -10.4, -3.800000000000001, -3.9000000000000004, -3.900000000000001, -3.8000000000000007, -10.3, -3.9000000000000012, -3.900000000000001, -3.600000000000001, -3.600000000000001, -4.0, -10.0, -3.9000000000000012, -3.800000000000001, -3.8000000000000007, -3.6000000000000005, -3.8000000000000007, -3.700000000000001, -3.9000000000000004, -4.200000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 2, 21, 4, 21, 21, 21, 21, 4, 14, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 9, 21, 5, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 19, 9, 21, 21, 21, 15, 21, 21, 15, 21, 21, 1, 6, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 6, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.655360661627732, "mean_inference_ms": 18.285448187258037, "mean_action_processing_ms": 0.9665609579453625, "mean_env_wait_ms": 1.7700211875959064, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07967495918273926, "StateBufferConnector_ms": 0.009928584098815918, "ViewRequirementAgentConnector_ms": 0.14663183689117432}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 140000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 140000, "timers": {"training_iteration_time_ms": 170982.143, "load_time_ms": 1.167, "load_throughput": 3426159.124, "learn_time_ms": 170019.762, "learn_throughput": 23.527, "synch_weights_time_ms": 184.661}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "done": false, "episodes_total": 7468, "training_iteration": 35, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-06_22-35-18", "timestamp": 1680813318, "time_this_iter_s": 171.3332598209381, "time_total_s": 5983.90701174736, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476b9400>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01475b01f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 5983.90701174736, "timesteps_since_restore": 0, "iterations_since_restore": 35, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.661475409836066, "ram_util_percent": 23.604918032786887}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.888077895487509, "cur_kl_coeff": 10.947347259521484, "cur_lr": 0.01, "total_loss": 0.5948397431001868, "policy_loss": -0.0036844194118153826, "vf_loss": 0.44368818342605587, "vf_explained_var": 0.5877906676261656, "kl": 0.014143697900531103, "entropy": 3.1135004676798337, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 33015.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "sampler_results": {"episode_reward_max": -3.3000000000000007, "episode_reward_min": -12.600000000000001, "episode_reward_mean": -4.602898550724639, "episode_len_mean": 19.342995169082126, "episode_media": {}, "episodes_this_iter": 207, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.0, -4.100000000000001, -3.9000000000000012, -4.000000000000001, -3.900000000000001, -4.200000000000001, -3.7000000000000006, -3.6000000000000005, -4.000000000000001, -4.100000000000001, -3.600000000000001, -4.000000000000001, -3.9000000000000004, -3.9000000000000004, -10.3, -3.8000000000000007, -10.3, -3.8000000000000003, -3.900000000000001, -3.700000000000001, -10.1, -10.8, -10.3, -4.000000000000001, -10.4, -3.7000000000000006, -3.8000000000000007, -3.8000000000000003, -3.900000000000001, -3.600000000000001, -3.8000000000000007, -3.7000000000000006, -3.6, -3.7000000000000006, -3.7000000000000006, -3.7000000000000006, -12.600000000000001, -4.000000000000001, -3.6000000000000005, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.1000000000000005, -3.8000000000000007, -4.000000000000001, -3.7000000000000006, -3.9000000000000012, -3.900000000000001, -3.8000000000000007, -3.7000000000000006, -3.500000000000001, -4.100000000000001, -3.9000000000000004, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -10.0, -10.3, -3.8000000000000007, -3.7000000000000006, -3.800000000000001, -4.000000000000001, -3.7000000000000006, -3.8000000000000007, -10.1, -3.8000000000000007, -3.9000000000000012, -4.000000000000002, -3.9000000000000012, -4.100000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -3.7000000000000006, -4.000000000000002, -4.000000000000001, -4.000000000000001, -4.200000000000001, -3.8000000000000007, -3.8000000000000003, -3.7000000000000006, -10.7, -3.900000000000001, -3.600000000000001, -4.000000000000001, -3.600000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000002, -3.9000000000000012, -3.8000000000000003, -4.300000000000001, -3.8000000000000007, -11.8, -3.900000000000001, -4.100000000000001, -3.6000000000000005, -3.900000000000001, -3.600000000000001, -10.1, -11.1, -10.6, -3.8000000000000007, -3.700000000000001, -3.600000000000001, -3.7000000000000006, -3.8000000000000007, -3.7000000000000006, -10.3, -3.7000000000000006, -10.0, -3.8000000000000007, -4.0, -4.100000000000001, -10.5, -3.8000000000000007, -3.5000000000000004, -4.000000000000002, -10.4, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -3.700000000000001, -4.0, -3.800000000000001, -10.5, -4.200000000000001, -3.900000000000001, -3.800000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.9000000000000004, -3.8000000000000007, -3.900000000000001, -4.0, -3.800000000000001, -4.0, -3.8000000000000007, -3.700000000000001, -4.000000000000001, -3.700000000000001, -3.900000000000001, -4.000000000000002, -3.900000000000001, -3.800000000000001, -3.7000000000000006, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -11.1, -3.9000000000000012, -3.6000000000000005, -12.0, -3.8000000000000007, -3.3000000000000007, -3.6000000000000005, -3.6000000000000005, -3.8000000000000007, -3.7000000000000006, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -3.800000000000001, -3.8000000000000007, -4.0, -4.200000000000001, -3.700000000000001, -3.600000000000001, -3.600000000000001, -3.7000000000000006, -10.3, -3.700000000000001, -3.8000000000000007, -3.9000000000000012, -4.000000000000001, -4.000000000000001, -3.700000000000001, -3.800000000000001, -3.600000000000001, -3.9000000000000012, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.200000000000001, -3.7000000000000006, -3.7000000000000006, -3.7000000000000015, -4.000000000000001, -4.200000000000001, -3.900000000000001, -3.600000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.5000000000000004, -3.700000000000001, -3.8000000000000007], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 4, 21, 21, 21, 2, 8, 3, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 3, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 2, 9, 6, 21, 21, 21, 21, 21, 21, 4, 21, 1, 21, 21, 21, 6, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.648769577873821, "mean_inference_ms": 18.25709903894451, "mean_action_processing_ms": 0.9636730977059771, "mean_env_wait_ms": 1.7634770054329554, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07529811582703522, "StateBufferConnector_ms": 0.008923189651562972, "ViewRequirementAgentConnector_ms": 0.13741594581788288}}, "episode_reward_max": -3.3000000000000007, "episode_reward_min": -12.600000000000001, "episode_reward_mean": -4.602898550724639, "episode_len_mean": 19.342995169082126, "episodes_this_iter": 207, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.0, -4.100000000000001, -3.9000000000000012, -4.000000000000001, -3.900000000000001, -4.200000000000001, -3.7000000000000006, -3.6000000000000005, -4.000000000000001, -4.100000000000001, -3.600000000000001, -4.000000000000001, -3.9000000000000004, -3.9000000000000004, -10.3, -3.8000000000000007, -10.3, -3.8000000000000003, -3.900000000000001, -3.700000000000001, -10.1, -10.8, -10.3, -4.000000000000001, -10.4, -3.7000000000000006, -3.8000000000000007, -3.8000000000000003, -3.900000000000001, -3.600000000000001, -3.8000000000000007, -3.7000000000000006, -3.6, -3.7000000000000006, -3.7000000000000006, -3.7000000000000006, -12.600000000000001, -4.000000000000001, -3.6000000000000005, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.1000000000000005, -3.8000000000000007, -4.000000000000001, -3.7000000000000006, -3.9000000000000012, -3.900000000000001, -3.8000000000000007, -3.7000000000000006, -3.500000000000001, -4.100000000000001, -3.9000000000000004, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -10.0, -10.3, -3.8000000000000007, -3.7000000000000006, -3.800000000000001, -4.000000000000001, -3.7000000000000006, -3.8000000000000007, -10.1, -3.8000000000000007, -3.9000000000000012, -4.000000000000002, -3.9000000000000012, -4.100000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -3.7000000000000006, -4.000000000000002, -4.000000000000001, -4.000000000000001, -4.200000000000001, -3.8000000000000007, -3.8000000000000003, -3.7000000000000006, -10.7, -3.900000000000001, -3.600000000000001, -4.000000000000001, -3.600000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000002, -3.9000000000000012, -3.8000000000000003, -4.300000000000001, -3.8000000000000007, -11.8, -3.900000000000001, -4.100000000000001, -3.6000000000000005, -3.900000000000001, -3.600000000000001, -10.1, -11.1, -10.6, -3.8000000000000007, -3.700000000000001, -3.600000000000001, -3.7000000000000006, -3.8000000000000007, -3.7000000000000006, -10.3, -3.7000000000000006, -10.0, -3.8000000000000007, -4.0, -4.100000000000001, -10.5, -3.8000000000000007, -3.5000000000000004, -4.000000000000002, -10.4, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -3.700000000000001, -4.0, -3.800000000000001, -10.5, -4.200000000000001, -3.900000000000001, -3.800000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.9000000000000004, -3.8000000000000007, -3.900000000000001, -4.0, -3.800000000000001, -4.0, -3.8000000000000007, -3.700000000000001, -4.000000000000001, -3.700000000000001, -3.900000000000001, -4.000000000000002, -3.900000000000001, -3.800000000000001, -3.7000000000000006, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -11.1, -3.9000000000000012, -3.6000000000000005, -12.0, -3.8000000000000007, -3.3000000000000007, -3.6000000000000005, -3.6000000000000005, -3.8000000000000007, -3.7000000000000006, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -3.800000000000001, -3.8000000000000007, -4.0, -4.200000000000001, -3.700000000000001, -3.600000000000001, -3.600000000000001, -3.7000000000000006, -10.3, -3.700000000000001, -3.8000000000000007, -3.9000000000000012, -4.000000000000001, -4.000000000000001, -3.700000000000001, -3.800000000000001, -3.600000000000001, -3.9000000000000012, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.200000000000001, -3.7000000000000006, -3.7000000000000006, -3.7000000000000015, -4.000000000000001, -4.200000000000001, -3.900000000000001, -3.600000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.5000000000000004, -3.700000000000001, -3.8000000000000007], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 4, 21, 21, 21, 2, 8, 3, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 3, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 2, 9, 6, 21, 21, 21, 21, 21, 21, 4, 21, 1, 21, 21, 21, 6, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.648769577873821, "mean_inference_ms": 18.25709903894451, "mean_action_processing_ms": 0.9636730977059771, "mean_env_wait_ms": 1.7634770054329554, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07529811582703522, "StateBufferConnector_ms": 0.008923189651562972, "ViewRequirementAgentConnector_ms": 0.13741594581788288}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 170990.41, "load_time_ms": 1.161, "load_throughput": 3444235.594, "learn_time_ms": 170025.375, "learn_throughput": 23.526, "synch_weights_time_ms": 183.748}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "episodes_total": 7675, "training_iteration": 36, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-06_22-38-09", "timestamp": 1680813489, "time_this_iter_s": 170.84675335884094, "time_total_s": 6154.753765106201, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0147659a60>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014757dd30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 6154.753765106201, "timesteps_since_restore": 0, "iterations_since_restore": 36, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.334567901234569, "ram_util_percent": 23.625925925925927}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.107515436859542, "cur_kl_coeff": 10.947347259521484, "cur_lr": 0.01, "total_loss": 0.7323857128259635, "policy_loss": 0.0006019965615323794, "vf_loss": 0.5122260337795621, "vf_explained_var": 0.6261088853882205, "kl": 0.02005578825232743, "entropy": 3.128260886284613, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 33945.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "sampler_results": {"episode_reward_max": -3.400000000000001, "episode_reward_min": -12.0, "episode_reward_mean": -4.54607843137255, "episode_len_mean": 19.833333333333332, "episode_media": {}, "episodes_this_iter": 204, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.8000000000000007, -3.700000000000001, -3.7000000000000006, -4.000000000000001, -3.9000000000000004, -3.8000000000000007, -3.9000000000000012, -4.0, -3.900000000000001, -3.8000000000000007, -11.0, -3.6000000000000005, -11.3, -3.8000000000000007, -10.6, -3.9000000000000012, -3.8000000000000007, -10.2, -10.5, -3.600000000000001, -11.3, -3.600000000000001, -3.800000000000001, -3.800000000000001, -3.600000000000001, -3.7000000000000006, -3.7000000000000006, -3.700000000000001, -3.800000000000001, -4.100000000000001, -3.7000000000000006, -3.7000000000000006, -3.9000000000000004, -3.8000000000000007, -3.8000000000000016, -3.600000000000001, -3.8000000000000007, -4.200000000000001, -4.200000000000001, -3.8000000000000007, -3.700000000000001, -4.1000000000000005, -3.700000000000001, -4.000000000000001, -4.200000000000001, -11.7, -11.6, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.700000000000001, -3.600000000000001, -3.8000000000000007, -3.800000000000001, -3.800000000000001, -3.8000000000000007, -4.000000000000001, -3.600000000000001, -4.000000000000002, -3.8000000000000007, -4.0, -3.8000000000000007, -4.1000000000000005, -3.7, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -4.100000000000001, -3.700000000000001, -3.9000000000000012, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.7000000000000006, -3.9000000000000004, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.1000000000000005, -3.8000000000000007, -4.000000000000002, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -3.7000000000000006, -3.900000000000001, -3.9000000000000004, -10.9, -3.800000000000001, -3.8000000000000007, -3.500000000000001, -3.6000000000000005, -3.700000000000001, -11.2, -3.600000000000001, -11.2, -3.8000000000000007, -4.200000000000001, -11.5, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -4.1000000000000005, -10.6, -3.7000000000000006, -11.6, -3.7000000000000006, -3.700000000000001, -3.7000000000000006, -4.100000000000001, -4.0, -3.8000000000000003, -4.000000000000001, -3.600000000000001, -3.7000000000000006, -3.600000000000001, -3.5000000000000004, -3.700000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.600000000000001, -3.8000000000000003, -3.7000000000000006, -11.7, -10.4, -4.000000000000001, -3.7000000000000006, -10.4, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -4.200000000000001, -3.400000000000001, -3.800000000000001, -4.100000000000001, -3.6000000000000005, -3.9000000000000012, -3.700000000000001, -3.800000000000001, -4.000000000000001, -3.800000000000001, -3.7000000000000006, -3.700000000000001, -3.700000000000001, -3.700000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.6000000000000005, -3.900000000000001, -3.9000000000000012, -12.0, -3.900000000000001, -4.0, -3.700000000000001, -3.7000000000000006, -4.0, -3.800000000000001, -4.100000000000001, -4.0, -3.7000000000000006, -3.700000000000001, -3.900000000000001, -4.0, -3.800000000000001, -3.700000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000002, -10.2, -3.800000000000001, -3.700000000000001, -3.800000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -10.5, -3.7000000000000006, -3.700000000000001, -3.9000000000000012, -4.300000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.6000000000000005, -4.000000000000001, -3.700000000000001, -3.800000000000001, -4.200000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.7000000000000006, -3.8000000000000007, -4.1000000000000005, -3.900000000000001, -3.9000000000000012, -3.900000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 11, 21, 6, 21, 21, 3, 6, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 11, 21, 10, 21, 21, 13, 21, 21, 21, 21, 5, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 5, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.649672356221169, "mean_inference_ms": 18.214665424864453, "mean_action_processing_ms": 0.9620831547150372, "mean_env_wait_ms": 1.7550161663308887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07557343034183278, "StateBufferConnector_ms": 0.008887052536010742, "ViewRequirementAgentConnector_ms": 0.1386104845533184}}, "episode_reward_max": -3.400000000000001, "episode_reward_min": -12.0, "episode_reward_mean": -4.54607843137255, "episode_len_mean": 19.833333333333332, "episodes_this_iter": 204, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.8000000000000007, -3.700000000000001, -3.7000000000000006, -4.000000000000001, -3.9000000000000004, -3.8000000000000007, -3.9000000000000012, -4.0, -3.900000000000001, -3.8000000000000007, -11.0, -3.6000000000000005, -11.3, -3.8000000000000007, -10.6, -3.9000000000000012, -3.8000000000000007, -10.2, -10.5, -3.600000000000001, -11.3, -3.600000000000001, -3.800000000000001, -3.800000000000001, -3.600000000000001, -3.7000000000000006, -3.7000000000000006, -3.700000000000001, -3.800000000000001, -4.100000000000001, -3.7000000000000006, -3.7000000000000006, -3.9000000000000004, -3.8000000000000007, -3.8000000000000016, -3.600000000000001, -3.8000000000000007, -4.200000000000001, -4.200000000000001, -3.8000000000000007, -3.700000000000001, -4.1000000000000005, -3.700000000000001, -4.000000000000001, -4.200000000000001, -11.7, -11.6, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.700000000000001, -3.600000000000001, -3.8000000000000007, -3.800000000000001, -3.800000000000001, -3.8000000000000007, -4.000000000000001, -3.600000000000001, -4.000000000000002, -3.8000000000000007, -4.0, -3.8000000000000007, -4.1000000000000005, -3.7, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -4.100000000000001, -3.700000000000001, -3.9000000000000012, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.7000000000000006, -3.9000000000000004, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.1000000000000005, -3.8000000000000007, -4.000000000000002, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -3.7000000000000006, -3.900000000000001, -3.9000000000000004, -10.9, -3.800000000000001, -3.8000000000000007, -3.500000000000001, -3.6000000000000005, -3.700000000000001, -11.2, -3.600000000000001, -11.2, -3.8000000000000007, -4.200000000000001, -11.5, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -4.1000000000000005, -10.6, -3.7000000000000006, -11.6, -3.7000000000000006, -3.700000000000001, -3.7000000000000006, -4.100000000000001, -4.0, -3.8000000000000003, -4.000000000000001, -3.600000000000001, -3.7000000000000006, -3.600000000000001, -3.5000000000000004, -3.700000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.600000000000001, -3.8000000000000003, -3.7000000000000006, -11.7, -10.4, -4.000000000000001, -3.7000000000000006, -10.4, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -4.200000000000001, -3.400000000000001, -3.800000000000001, -4.100000000000001, -3.6000000000000005, -3.9000000000000012, -3.700000000000001, -3.800000000000001, -4.000000000000001, -3.800000000000001, -3.7000000000000006, -3.700000000000001, -3.700000000000001, -3.700000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.6000000000000005, -3.900000000000001, -3.9000000000000012, -12.0, -3.900000000000001, -4.0, -3.700000000000001, -3.7000000000000006, -4.0, -3.800000000000001, -4.100000000000001, -4.0, -3.7000000000000006, -3.700000000000001, -3.900000000000001, -4.0, -3.800000000000001, -3.700000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000002, -10.2, -3.800000000000001, -3.700000000000001, -3.800000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -10.5, -3.7000000000000006, -3.700000000000001, -3.9000000000000012, -4.300000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.6000000000000005, -4.000000000000001, -3.700000000000001, -3.800000000000001, -4.200000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.7000000000000006, -3.8000000000000007, -4.1000000000000005, -3.900000000000001, -3.9000000000000012, -3.900000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 11, 21, 6, 21, 21, 3, 6, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 11, 21, 10, 21, 21, 13, 21, 21, 21, 21, 5, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 5, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.649672356221169, "mean_inference_ms": 18.214665424864453, "mean_action_processing_ms": 0.9620831547150372, "mean_env_wait_ms": 1.7550161663308887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07557343034183278, "StateBufferConnector_ms": 0.008887052536010742, "ViewRequirementAgentConnector_ms": 0.1386104845533184}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 148000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 148000, "timers": {"training_iteration_time_ms": 170985.286, "load_time_ms": 1.152, "load_throughput": 3473184.142, "learn_time_ms": 170020.57, "learn_throughput": 23.527, "synch_weights_time_ms": 182.502}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "done": false, "episodes_total": 7879, "training_iteration": 37, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-06_22-41-00", "timestamp": 1680813660, "time_this_iter_s": 170.52823972702026, "time_total_s": 6325.282004833221, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476d7a90>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01475d8ee0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 6325.282004833221, "timesteps_since_restore": 0, "iterations_since_restore": 37, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.420164609053497, "ram_util_percent": 23.647325102880654}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.739935861608034, "cur_kl_coeff": 16.421020889282232, "cur_lr": 0.01, "total_loss": 1.767627442065346, "policy_loss": 0.007257526185643929, "vf_loss": 0.44915077818096966, "vf_explained_var": 0.5658013671316127, "kl": 0.07985004012739556, "entropy": 3.0782797040477874, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 34875.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "sampler_results": {"episode_reward_max": -3.400000000000001, "episode_reward_min": -13.0, "episode_reward_mean": -4.561463414634147, "episode_len_mean": 19.692682926829267, "episode_media": {}, "episodes_this_iter": 205, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.000000000000001, -3.900000000000001, -12.100000000000001, -3.9000000000000012, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.800000000000001, -3.500000000000001, -3.7000000000000006, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -10.2, -11.2, -3.800000000000001, -10.3, -4.000000000000001, -3.600000000000001, -3.500000000000001, -3.900000000000001, -3.600000000000001, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -3.6000000000000005, -3.8000000000000007, -3.7000000000000006, -3.900000000000001, -3.7, -3.900000000000001, -4.0, -3.9000000000000004, -4.200000000000001, -4.100000000000001, -3.5000000000000004, -3.900000000000001, -3.800000000000001, -4.100000000000001, -4.000000000000002, -3.700000000000001, -3.9000000000000012, -3.600000000000001, -3.6000000000000005, -3.900000000000001, -10.3, -3.8000000000000007, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -10.5, -13.0, -3.8000000000000007, -4.100000000000001, -10.8, -3.600000000000001, -3.800000000000001, -4.1000000000000005, -3.500000000000001, -3.700000000000001, -11.0, -3.700000000000001, -4.000000000000001, -3.9000000000000004, -3.800000000000001, -3.900000000000001, -3.8000000000000007, -3.600000000000001, -3.9000000000000012, -3.800000000000001, -4.100000000000001, -3.800000000000001, -3.400000000000001, -3.500000000000001, -4.100000000000001, -3.500000000000001, -4.300000000000001, -4.200000000000001, -3.500000000000001, -3.7000000000000006, -3.9000000000000012, -3.800000000000001, -4.100000000000001, -3.800000000000001, -3.9000000000000012, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.800000000000001, -3.900000000000001, -3.8000000000000016, -10.6, -3.6000000000000005, -10.5, -10.0, -4.100000000000001, -4.100000000000001, -4.0, -3.8000000000000003, -3.8000000000000007, -3.7000000000000006, -4.000000000000001, -3.6000000000000005, -3.900000000000001, -3.900000000000001, -11.1, -3.7000000000000006, -11.1, -3.900000000000001, -11.0, -10.1, -3.800000000000001, -3.900000000000001, -3.800000000000001, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -3.5000000000000004, -4.200000000000001, -3.8000000000000007, -4.000000000000001, -3.6000000000000005, -3.8000000000000007, -3.900000000000001, -3.7000000000000006, -3.700000000000001, -4.000000000000001, -3.8000000000000007, -10.6, -4.000000000000001, -4.100000000000001, -3.500000000000001, -3.7, -3.7000000000000006, -3.900000000000001, -3.9000000000000004, -3.8000000000000007, -3.9000000000000004, -3.700000000000001, -3.8000000000000007, -4.000000000000001, -3.5000000000000004, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -3.700000000000001, -3.900000000000001, -4.1000000000000005, -3.7000000000000006, -3.8000000000000007, -3.700000000000001, -3.8000000000000007, -3.8000000000000007, -3.700000000000001, -3.800000000000001, -4.200000000000001, -4.100000000000001, -3.700000000000001, -4.000000000000001, -3.7000000000000006, -3.8000000000000007, -4.000000000000002, -11.6, -4.100000000000001, -3.8000000000000003, -4.0, -3.7000000000000006, -3.8000000000000007, -3.6000000000000005, -3.900000000000001, -10.9, -3.800000000000001, -3.900000000000001, -3.800000000000001, -3.7000000000000006, -11.5, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -3.9000000000000012, -3.6000000000000005, -3.7000000000000006, -4.000000000000001, -3.7000000000000006, -3.7, -3.900000000000001, -3.700000000000001, -3.800000000000001, -4.000000000000001, -3.900000000000001, -3.7000000000000006, -10.8, -3.700000000000001, -4.000000000000001, -3.8000000000000007, -3.700000000000001, -3.8000000000000007, -3.900000000000001, -3.700000000000001], "episode_lengths": [21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 11, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 5, 20, 21, 21, 8, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 4, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 9, 21, 10, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.652021334662711, "mean_inference_ms": 18.24104567605071, "mean_action_processing_ms": 0.9605774959384362, "mean_env_wait_ms": 1.7491995365603383, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07365168594732517, "StateBufferConnector_ms": 0.008566670301483899, "ViewRequirementAgentConnector_ms": 0.13422023959276153}}, "episode_reward_max": -3.400000000000001, "episode_reward_min": -13.0, "episode_reward_mean": -4.561463414634147, "episode_len_mean": 19.692682926829267, "episodes_this_iter": 205, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.000000000000001, -3.900000000000001, -12.100000000000001, -3.9000000000000012, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.800000000000001, -3.500000000000001, -3.7000000000000006, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -10.2, -11.2, -3.800000000000001, -10.3, -4.000000000000001, -3.600000000000001, -3.500000000000001, -3.900000000000001, -3.600000000000001, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -3.6000000000000005, -3.8000000000000007, -3.7000000000000006, -3.900000000000001, -3.7, -3.900000000000001, -4.0, -3.9000000000000004, -4.200000000000001, -4.100000000000001, -3.5000000000000004, -3.900000000000001, -3.800000000000001, -4.100000000000001, -4.000000000000002, -3.700000000000001, -3.9000000000000012, -3.600000000000001, -3.6000000000000005, -3.900000000000001, -10.3, -3.8000000000000007, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -10.5, -13.0, -3.8000000000000007, -4.100000000000001, -10.8, -3.600000000000001, -3.800000000000001, -4.1000000000000005, -3.500000000000001, -3.700000000000001, -11.0, -3.700000000000001, -4.000000000000001, -3.9000000000000004, -3.800000000000001, -3.900000000000001, -3.8000000000000007, -3.600000000000001, -3.9000000000000012, -3.800000000000001, -4.100000000000001, -3.800000000000001, -3.400000000000001, -3.500000000000001, -4.100000000000001, -3.500000000000001, -4.300000000000001, -4.200000000000001, -3.500000000000001, -3.7000000000000006, -3.9000000000000012, -3.800000000000001, -4.100000000000001, -3.800000000000001, -3.9000000000000012, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.800000000000001, -3.900000000000001, -3.8000000000000016, -10.6, -3.6000000000000005, -10.5, -10.0, -4.100000000000001, -4.100000000000001, -4.0, -3.8000000000000003, -3.8000000000000007, -3.7000000000000006, -4.000000000000001, -3.6000000000000005, -3.900000000000001, -3.900000000000001, -11.1, -3.7000000000000006, -11.1, -3.900000000000001, -11.0, -10.1, -3.800000000000001, -3.900000000000001, -3.800000000000001, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -3.5000000000000004, -4.200000000000001, -3.8000000000000007, -4.000000000000001, -3.6000000000000005, -3.8000000000000007, -3.900000000000001, -3.7000000000000006, -3.700000000000001, -4.000000000000001, -3.8000000000000007, -10.6, -4.000000000000001, -4.100000000000001, -3.500000000000001, -3.7, -3.7000000000000006, -3.900000000000001, -3.9000000000000004, -3.8000000000000007, -3.9000000000000004, -3.700000000000001, -3.8000000000000007, -4.000000000000001, -3.5000000000000004, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -3.700000000000001, -3.900000000000001, -4.1000000000000005, -3.7000000000000006, -3.8000000000000007, -3.700000000000001, -3.8000000000000007, -3.8000000000000007, -3.700000000000001, -3.800000000000001, -4.200000000000001, -4.100000000000001, -3.700000000000001, -4.000000000000001, -3.7000000000000006, -3.8000000000000007, -4.000000000000002, -11.6, -4.100000000000001, -3.8000000000000003, -4.0, -3.7000000000000006, -3.8000000000000007, -3.6000000000000005, -3.900000000000001, -10.9, -3.800000000000001, -3.900000000000001, -3.800000000000001, -3.7000000000000006, -11.5, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -3.9000000000000012, -3.6000000000000005, -3.7000000000000006, -4.000000000000001, -3.7000000000000006, -3.7, -3.900000000000001, -3.700000000000001, -3.800000000000001, -4.000000000000001, -3.900000000000001, -3.7000000000000006, -10.8, -3.700000000000001, -4.000000000000001, -3.8000000000000007, -3.700000000000001, -3.8000000000000007, -3.900000000000001, -3.700000000000001], "episode_lengths": [21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 11, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 5, 20, 21, 21, 8, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 4, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 9, 21, 10, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.652021334662711, "mean_inference_ms": 18.24104567605071, "mean_action_processing_ms": 0.9605774959384362, "mean_env_wait_ms": 1.7491995365603383, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07365168594732517, "StateBufferConnector_ms": 0.008566670301483899, "ViewRequirementAgentConnector_ms": 0.13422023959276153}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 152000, "timers": {"training_iteration_time_ms": 170900.537, "load_time_ms": 1.137, "load_throughput": 3516719.978, "learn_time_ms": 169932.9, "learn_throughput": 23.539, "synch_weights_time_ms": 183.01}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "done": false, "episodes_total": 8084, "training_iteration": 38, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-06_22-43-50", "timestamp": 1680813830, "time_this_iter_s": 170.72259283065796, "time_total_s": 6496.004597663879, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0147565550>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014759c430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 6496.004597663879, "timesteps_since_restore": 0, "iterations_since_restore": 38, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.3756198347107444, "ram_util_percent": 23.68223140495867}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.224537371563654, "cur_kl_coeff": 24.631531333923345, "cur_lr": 0.01, "total_loss": 0.766458495433933, "policy_loss": -0.0011729675481566579, "vf_loss": 0.38169011411968096, "vf_explained_var": 0.6472603267879896, "kl": 0.015668589649196235, "entropy": 3.0827300140934604, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 35805.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "sampler_results": {"episode_reward_max": -3.5000000000000004, "episode_reward_min": -11.4, "episode_reward_mean": -4.4348484848484855, "episode_len_mean": 19.696969696969695, "episode_media": {}, "episodes_this_iter": 198, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.000000000000001, -4.0, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.800000000000001, -3.900000000000001, -4.000000000000001, -3.5000000000000004, -3.700000000000001, -10.6, -10.1, -10.5, -10.2, -10.6, -4.0, -11.4, -3.900000000000001, -10.6, -10.8, -3.8000000000000007, -3.9000000000000012, -3.7000000000000006, -3.800000000000001, -4.200000000000001, -3.800000000000001, -3.900000000000001, -3.700000000000001, -3.600000000000001, -3.8000000000000007, -3.900000000000001, -3.6000000000000005, -3.8000000000000003, -3.7000000000000006, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -3.7000000000000006, -3.8000000000000007, -3.700000000000001, -4.000000000000001, -10.3, -4.000000000000002, -3.700000000000001, -10.7, -3.8000000000000007, -4.000000000000002, -3.500000000000001, -3.800000000000001, -3.800000000000001, -3.900000000000001, -10.4, -4.200000000000001, -4.100000000000001, -3.8000000000000007, -3.600000000000001, -4.100000000000001, -3.600000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -3.600000000000001, -3.700000000000001, -4.200000000000001, -3.800000000000001, -3.9000000000000012, -3.8000000000000007, -3.5000000000000004, -4.000000000000001, -3.700000000000001, -3.9000000000000012, -4.000000000000001, -3.800000000000001, -3.600000000000001, -4.000000000000001, -4.000000000000002, -3.800000000000001, -3.900000000000001, -3.8000000000000007, -3.9000000000000012, -3.900000000000001, -4.0, -4.000000000000001, -3.700000000000001, -3.7, -3.900000000000001, -3.8000000000000007, -3.9000000000000012, -10.0, -3.8000000000000007, -4.200000000000001, -3.7000000000000006, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -4.000000000000001, -3.800000000000001, -10.5, -3.8000000000000007, -4.0, -3.6000000000000005, -3.7000000000000006, -10.3, -3.900000000000001, -4.0, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -3.5000000000000004, -3.6000000000000005, -3.6000000000000005, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -3.9000000000000012, -3.7000000000000006, -3.900000000000001, -3.900000000000001, -3.700000000000001, -10.6, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.9000000000000012, -3.9000000000000012, -3.700000000000001, -3.8000000000000007, -3.7000000000000006, -4.000000000000001, -3.700000000000001, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -3.7, -4.100000000000001, -3.500000000000001, -3.7000000000000006, -3.7, -4.1000000000000005, -3.900000000000001, -4.000000000000002, -4.100000000000001, -4.100000000000001, -4.300000000000001, -4.100000000000001, -3.500000000000001, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -11.2, -3.900000000000001, -3.800000000000001, -4.0, -3.8000000000000007, -3.8000000000000003, -3.900000000000001, -3.7000000000000006, -3.500000000000001, -4.100000000000001, -3.500000000000001, -4.0, -3.900000000000001, -3.9000000000000012, -3.8000000000000007, -4.300000000000001, -3.6000000000000005, -3.7, -4.000000000000002, -3.800000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.700000000000001, -4.100000000000001, -4.000000000000001, -3.700000000000001, -3.900000000000001, -3.800000000000001, -3.900000000000001, -3.7000000000000006, -4.100000000000001, -3.800000000000001, -4.100000000000001, -11.0, -3.8000000000000007, -3.7000000000000006, -3.800000000000001, -4.200000000000001, -3.9000000000000004], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 2, 5, 3, 6, 21, 11, 21, 6, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 7, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.654044922975809, "mean_inference_ms": 18.266996236630018, "mean_action_processing_ms": 0.9613261855402983, "mean_env_wait_ms": 1.748069645748899, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07686711320973406, "StateBufferConnector_ms": 0.009286042415734493, "ViewRequirementAgentConnector_ms": 0.14038471260456123}}, "episode_reward_max": -3.5000000000000004, "episode_reward_min": -11.4, "episode_reward_mean": -4.4348484848484855, "episode_len_mean": 19.696969696969695, "episodes_this_iter": 198, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.000000000000001, -4.0, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.800000000000001, -3.900000000000001, -4.000000000000001, -3.5000000000000004, -3.700000000000001, -10.6, -10.1, -10.5, -10.2, -10.6, -4.0, -11.4, -3.900000000000001, -10.6, -10.8, -3.8000000000000007, -3.9000000000000012, -3.7000000000000006, -3.800000000000001, -4.200000000000001, -3.800000000000001, -3.900000000000001, -3.700000000000001, -3.600000000000001, -3.8000000000000007, -3.900000000000001, -3.6000000000000005, -3.8000000000000003, -3.7000000000000006, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -3.7000000000000006, -3.8000000000000007, -3.700000000000001, -4.000000000000001, -10.3, -4.000000000000002, -3.700000000000001, -10.7, -3.8000000000000007, -4.000000000000002, -3.500000000000001, -3.800000000000001, -3.800000000000001, -3.900000000000001, -10.4, -4.200000000000001, -4.100000000000001, -3.8000000000000007, -3.600000000000001, -4.100000000000001, -3.600000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -3.600000000000001, -3.700000000000001, -4.200000000000001, -3.800000000000001, -3.9000000000000012, -3.8000000000000007, -3.5000000000000004, -4.000000000000001, -3.700000000000001, -3.9000000000000012, -4.000000000000001, -3.800000000000001, -3.600000000000001, -4.000000000000001, -4.000000000000002, -3.800000000000001, -3.900000000000001, -3.8000000000000007, -3.9000000000000012, -3.900000000000001, -4.0, -4.000000000000001, -3.700000000000001, -3.7, -3.900000000000001, -3.8000000000000007, -3.9000000000000012, -10.0, -3.8000000000000007, -4.200000000000001, -3.7000000000000006, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -4.000000000000001, -3.800000000000001, -10.5, -3.8000000000000007, -4.0, -3.6000000000000005, -3.7000000000000006, -10.3, -3.900000000000001, -4.0, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -3.5000000000000004, -3.6000000000000005, -3.6000000000000005, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -3.9000000000000012, -3.7000000000000006, -3.900000000000001, -3.900000000000001, -3.700000000000001, -10.6, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.9000000000000012, -3.9000000000000012, -3.700000000000001, -3.8000000000000007, -3.7000000000000006, -4.000000000000001, -3.700000000000001, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -3.7, -4.100000000000001, -3.500000000000001, -3.7000000000000006, -3.7, -4.1000000000000005, -3.900000000000001, -4.000000000000002, -4.100000000000001, -4.100000000000001, -4.300000000000001, -4.100000000000001, -3.500000000000001, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -11.2, -3.900000000000001, -3.800000000000001, -4.0, -3.8000000000000007, -3.8000000000000003, -3.900000000000001, -3.7000000000000006, -3.500000000000001, -4.100000000000001, -3.500000000000001, -4.0, -3.900000000000001, -3.9000000000000012, -3.8000000000000007, -4.300000000000001, -3.6000000000000005, -3.7, -4.000000000000002, -3.800000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.700000000000001, -4.100000000000001, -4.000000000000001, -3.700000000000001, -3.900000000000001, -3.800000000000001, -3.900000000000001, -3.7000000000000006, -4.100000000000001, -3.800000000000001, -4.100000000000001, -11.0, -3.8000000000000007, -3.7000000000000006, -3.800000000000001, -4.200000000000001, -3.9000000000000004], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 2, 5, 3, 6, 21, 11, 21, 6, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 7, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.654044922975809, "mean_inference_ms": 18.266996236630018, "mean_action_processing_ms": 0.9613261855402983, "mean_env_wait_ms": 1.748069645748899, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07686711320973406, "StateBufferConnector_ms": 0.009286042415734493, "ViewRequirementAgentConnector_ms": 0.14038471260456123}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 156000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 170958.378, "load_time_ms": 1.137, "load_throughput": 3518932.819, "learn_time_ms": 169987.155, "learn_throughput": 23.531, "synch_weights_time_ms": 183.282}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "episodes_total": 8282, "training_iteration": 39, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-06_22-46-42", "timestamp": 1680814002, "time_this_iter_s": 171.42857766151428, "time_total_s": 6667.433175325394, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0147569fd0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7effc2556f70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 6667.433175325394, "timesteps_since_restore": 0, "iterations_since_restore": 39, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.6086065573770485, "ram_util_percent": 23.67991803278688}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.531352979137052, "cur_kl_coeff": 24.631531333923345, "cur_lr": 0.01, "total_loss": 0.8013302422018461, "policy_loss": -0.00012128354420745244, "vf_loss": 0.6448770285533961, "vf_explained_var": 0.524901613561056, "kl": 0.0063566692332378515, "entropy": 3.0917291123379944, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 36735.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "sampler_results": {"episode_reward_max": -3.5000000000000004, "episode_reward_min": -12.600000000000001, "episode_reward_mean": -4.899519230769231, "episode_len_mean": 18.985576923076923, "episode_media": {}, "episodes_this_iter": 208, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.100000000000001, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -3.7000000000000006, -3.7000000000000006, -4.200000000000001, -3.600000000000001, -4.100000000000001, -10.5, -4.000000000000002, -3.600000000000001, -3.8000000000000007, -10.2, -10.4, -11.4, -12.3, -3.6000000000000005, -10.2, -3.700000000000001, -10.2, -11.0, -10.4, -4.000000000000001, -10.1, -3.8000000000000007, -10.2, -10.5, -10.1, -10.1, -10.4, -4.000000000000001, -3.8000000000000007, -3.800000000000001, -3.700000000000001, -3.8000000000000007, -3.6000000000000005, -4.100000000000001, -3.5000000000000004, -4.000000000000001, -11.5, -4.000000000000001, -3.700000000000001, -10.3, -3.9000000000000012, -3.600000000000001, -3.900000000000001, -3.900000000000001, -3.800000000000001, -4.000000000000001, -4.0, -3.9000000000000012, -3.9000000000000012, -3.8000000000000007, -3.9000000000000004, -3.900000000000001, -11.5, -10.1, -3.8000000000000007, -3.700000000000001, -3.700000000000001, -4.100000000000001, -3.700000000000001, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -3.800000000000001, -4.100000000000001, -3.800000000000001, -4.000000000000001, -11.0, -3.9000000000000012, -12.600000000000001, -3.8000000000000007, -3.500000000000001, -3.7000000000000006, -3.800000000000001, -4.0, -3.8000000000000007, -3.9000000000000012, -3.8000000000000007, -3.500000000000001, -3.7000000000000006, -3.900000000000001, -3.900000000000001, -4.200000000000001, -3.9000000000000012, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.9000000000000012, -3.7000000000000006, -3.8000000000000007, -3.7000000000000006, -3.8000000000000007, -3.8000000000000007, -3.7000000000000006, -3.9000000000000012, -3.7000000000000006, -3.8000000000000007, -3.6000000000000005, -3.6000000000000005, -3.7000000000000006, -4.100000000000001, -12.1, -4.000000000000002, -4.1000000000000005, -10.1, -4.100000000000001, -3.900000000000001, -4.0, -10.8, -3.7000000000000006, -4.000000000000001, -4.000000000000002, -3.900000000000001, -3.900000000000001, -4.000000000000002, -3.8000000000000007, -3.800000000000001, -4.100000000000001, -10.6, -3.500000000000001, -3.700000000000001, -3.7000000000000006, -4.000000000000001, -3.700000000000001, -3.8000000000000007, -3.8000000000000007, -3.700000000000001, -3.5000000000000004, -10.6, -3.8000000000000007, -3.9000000000000004, -4.1000000000000005, -4.200000000000001, -4.000000000000001, -4.1000000000000005, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -3.8000000000000007, -3.7000000000000006, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -3.9000000000000012, -4.000000000000002, -3.600000000000001, -3.800000000000001, -3.5000000000000004, -12.1, -3.6000000000000005, -3.8000000000000007, -3.8000000000000007, -3.7000000000000006, -3.7000000000000006, -3.7000000000000006, -4.1000000000000005, -4.000000000000001, -11.5, -3.9000000000000012, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -4.1000000000000005, -3.500000000000001, -4.000000000000001, -4.100000000000001, -3.7000000000000006, -3.800000000000001, -3.9000000000000012, -3.8000000000000007, -3.6000000000000014, -4.000000000000001, -3.8000000000000007, -12.0, -3.8000000000000007, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -3.9000000000000012, -3.8000000000000003, -3.600000000000001, -3.8000000000000007, -3.5000000000000004, -4.000000000000001, -3.900000000000001, -3.900000000000001, -10.2, -4.0, -3.7000000000000006, -3.7, -4.200000000000001, -3.9000000000000012, -4.0, -3.5000000000000004, -3.7000000000000006, -3.800000000000001, -3.900000000000001, -11.9, -4.000000000000001, -3.700000000000001, -3.900000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 3, 4, 11, 16, 21, 3, 21, 3, 9, 5, 21, 2, 21, 3, 5, 2, 2, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 2, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.667852571074011, "mean_inference_ms": 18.30178792866119, "mean_action_processing_ms": 0.9604542989569647, "mean_env_wait_ms": 1.7518138397235663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07668676284643319, "StateBufferConnector_ms": 0.00925751832815317, "ViewRequirementAgentConnector_ms": 0.13804217943778405}}, "episode_reward_max": -3.5000000000000004, "episode_reward_min": -12.600000000000001, "episode_reward_mean": -4.899519230769231, "episode_len_mean": 18.985576923076923, "episodes_this_iter": 208, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.100000000000001, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -3.7000000000000006, -3.7000000000000006, -4.200000000000001, -3.600000000000001, -4.100000000000001, -10.5, -4.000000000000002, -3.600000000000001, -3.8000000000000007, -10.2, -10.4, -11.4, -12.3, -3.6000000000000005, -10.2, -3.700000000000001, -10.2, -11.0, -10.4, -4.000000000000001, -10.1, -3.8000000000000007, -10.2, -10.5, -10.1, -10.1, -10.4, -4.000000000000001, -3.8000000000000007, -3.800000000000001, -3.700000000000001, -3.8000000000000007, -3.6000000000000005, -4.100000000000001, -3.5000000000000004, -4.000000000000001, -11.5, -4.000000000000001, -3.700000000000001, -10.3, -3.9000000000000012, -3.600000000000001, -3.900000000000001, -3.900000000000001, -3.800000000000001, -4.000000000000001, -4.0, -3.9000000000000012, -3.9000000000000012, -3.8000000000000007, -3.9000000000000004, -3.900000000000001, -11.5, -10.1, -3.8000000000000007, -3.700000000000001, -3.700000000000001, -4.100000000000001, -3.700000000000001, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -3.800000000000001, -4.100000000000001, -3.800000000000001, -4.000000000000001, -11.0, -3.9000000000000012, -12.600000000000001, -3.8000000000000007, -3.500000000000001, -3.7000000000000006, -3.800000000000001, -4.0, -3.8000000000000007, -3.9000000000000012, -3.8000000000000007, -3.500000000000001, -3.7000000000000006, -3.900000000000001, -3.900000000000001, -4.200000000000001, -3.9000000000000012, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.9000000000000012, -3.7000000000000006, -3.8000000000000007, -3.7000000000000006, -3.8000000000000007, -3.8000000000000007, -3.7000000000000006, -3.9000000000000012, -3.7000000000000006, -3.8000000000000007, -3.6000000000000005, -3.6000000000000005, -3.7000000000000006, -4.100000000000001, -12.1, -4.000000000000002, -4.1000000000000005, -10.1, -4.100000000000001, -3.900000000000001, -4.0, -10.8, -3.7000000000000006, -4.000000000000001, -4.000000000000002, -3.900000000000001, -3.900000000000001, -4.000000000000002, -3.8000000000000007, -3.800000000000001, -4.100000000000001, -10.6, -3.500000000000001, -3.700000000000001, -3.7000000000000006, -4.000000000000001, -3.700000000000001, -3.8000000000000007, -3.8000000000000007, -3.700000000000001, -3.5000000000000004, -10.6, -3.8000000000000007, -3.9000000000000004, -4.1000000000000005, -4.200000000000001, -4.000000000000001, -4.1000000000000005, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -3.8000000000000007, -3.7000000000000006, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -3.9000000000000012, -4.000000000000002, -3.600000000000001, -3.800000000000001, -3.5000000000000004, -12.1, -3.6000000000000005, -3.8000000000000007, -3.8000000000000007, -3.7000000000000006, -3.7000000000000006, -3.7000000000000006, -4.1000000000000005, -4.000000000000001, -11.5, -3.9000000000000012, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -4.1000000000000005, -3.500000000000001, -4.000000000000001, -4.100000000000001, -3.7000000000000006, -3.800000000000001, -3.9000000000000012, -3.8000000000000007, -3.6000000000000014, -4.000000000000001, -3.8000000000000007, -12.0, -3.8000000000000007, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -3.9000000000000012, -3.8000000000000003, -3.600000000000001, -3.8000000000000007, -3.5000000000000004, -4.000000000000001, -3.900000000000001, -3.900000000000001, -10.2, -4.0, -3.7000000000000006, -3.7, -4.200000000000001, -3.9000000000000012, -4.0, -3.5000000000000004, -3.7000000000000006, -3.800000000000001, -3.900000000000001, -11.9, -4.000000000000001, -3.700000000000001, -3.900000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 3, 4, 11, 16, 21, 3, 21, 3, 9, 5, 21, 2, 21, 3, 5, 2, 2, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 2, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.667852571074011, "mean_inference_ms": 18.30178792866119, "mean_action_processing_ms": 0.9604542989569647, "mean_env_wait_ms": 1.7518138397235663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07668676284643319, "StateBufferConnector_ms": 0.00925751832815317, "ViewRequirementAgentConnector_ms": 0.13804217943778405}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 170955.918, "load_time_ms": 1.138, "load_throughput": 3515246.297, "learn_time_ms": 169981.033, "learn_throughput": 23.532, "synch_weights_time_ms": 184.518}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "episodes_total": 8490, "training_iteration": 40, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-06_22-49-33", "timestamp": 1680814173, "time_this_iter_s": 170.9398272037506, "time_total_s": 6838.373002529144, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0147659c70>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0147716f70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 6838.373002529144, "timesteps_since_restore": 0, "iterations_since_restore": 40, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.3465020576131685, "ram_util_percent": 23.65308641975308}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.655328147642074, "cur_kl_coeff": 24.631531333923345, "cur_lr": 0.01, "total_loss": 0.6278212271630764, "policy_loss": 5.538471053124115e-05, "vf_loss": 0.43166154554133773, "vf_explained_var": 0.6622310842878075, "kl": 0.007961514956938724, "entropy": 3.100546065197196, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 37665.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "sampler_results": {"episode_reward_max": -3.4000000000000004, "episode_reward_min": -12.700000000000001, "episode_reward_mean": -4.331658291457287, "episode_len_mean": 20.28643216080402, "episode_media": {}, "episodes_this_iter": 199, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.9000000000000012, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -4.200000000000001, -3.8000000000000003, -3.700000000000001, -3.700000000000001, -3.8000000000000007, -3.500000000000001, -4.100000000000001, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -3.6000000000000005, -3.7000000000000006, -10.7, -4.000000000000002, -3.600000000000001, -3.800000000000001, -3.8000000000000003, -3.8000000000000007, -3.7000000000000006, -3.700000000000001, -3.9000000000000012, -3.800000000000001, -4.100000000000001, -3.6000000000000005, -3.9000000000000004, -3.7000000000000006, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -3.7000000000000006, -3.900000000000001, -4.100000000000001, -12.5, -3.500000000000001, -4.000000000000001, -3.800000000000001, -3.900000000000001, -11.4, -3.900000000000001, -3.6000000000000005, -3.900000000000001, -3.900000000000001, -3.900000000000001, -10.5, -3.8000000000000007, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -3.900000000000001, -3.700000000000001, -3.7000000000000006, -3.6000000000000005, -4.100000000000001, -3.8000000000000007, -3.9000000000000012, -3.900000000000001, -3.700000000000001, -3.6000000000000005, -4.000000000000001, -4.100000000000001, -3.5000000000000004, -3.5000000000000004, -3.6000000000000005, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -3.8000000000000007, -3.700000000000001, -4.100000000000001, -3.9000000000000012, -4.100000000000001, -3.800000000000001, -3.7000000000000006, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -3.700000000000001, -3.6000000000000005, -3.9000000000000012, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -3.7000000000000006, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.9000000000000012, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -3.800000000000001, -10.0, -3.9000000000000004, -12.1, -10.1, -3.8000000000000007, -3.6000000000000005, -4.000000000000002, -12.700000000000001, -11.1, -10.9, -4.1000000000000005, -3.8000000000000007, -3.800000000000001, -3.9000000000000012, -3.700000000000001, -4.000000000000002, -4.000000000000001, -4.000000000000002, -4.200000000000001, -4.0, -4.100000000000001, -4.200000000000001, -3.6000000000000005, -4.000000000000001, -3.5000000000000004, -3.600000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.200000000000001, -3.900000000000001, -3.8000000000000007, -3.5000000000000004, -3.7000000000000006, -3.7000000000000006, -3.6000000000000005, -3.600000000000001, -4.100000000000001, -3.8000000000000007, -3.600000000000001, -3.8000000000000007, -4.000000000000001, -3.8000000000000003, -3.900000000000001, -3.900000000000001, -3.700000000000001, -4.000000000000001, -3.7, -3.900000000000001, -3.900000000000001, -3.9000000000000004, -3.6000000000000005, -3.9000000000000012, -4.200000000000001, -3.900000000000001, -4.000000000000001, -11.600000000000001, -4.200000000000001, -4.100000000000001, -10.0, -3.7000000000000006, -4.100000000000001, -4.000000000000001, -3.500000000000001, -3.600000000000001, -4.200000000000001, -4.1000000000000005, -4.100000000000001, -3.8000000000000007, -3.8000000000000003, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.4000000000000004, -3.400000000000001, -3.700000000000001, -4.000000000000001, -3.9000000000000012, -3.9000000000000004, -3.900000000000001, -4.000000000000002, -3.800000000000001, -4.000000000000001, -3.9000000000000004, -3.800000000000001, -11.8, -4.0, -3.900000000000001, -3.8000000000000007, -4.200000000000001, -3.8000000000000007, -3.7000000000000006, -3.7000000000000006, -3.900000000000001, -4.0, -3.8000000000000007, -3.900000000000001, -3.800000000000001, -3.900000000000001, -3.9000000000000012, -3.7000000000000006, -3.9000000000000012], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21, 16, 2, 21, 21, 21, 20, 10, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.639473544701186, "mean_inference_ms": 18.234377441334804, "mean_action_processing_ms": 0.957927487356033, "mean_env_wait_ms": 1.733121477996268, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0729625548549633, "StateBufferConnector_ms": 0.00864405128824052, "ViewRequirementAgentConnector_ms": 0.13290374123271387}}, "episode_reward_max": -3.4000000000000004, "episode_reward_min": -12.700000000000001, "episode_reward_mean": -4.331658291457287, "episode_len_mean": 20.28643216080402, "episodes_this_iter": 199, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.9000000000000012, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -4.200000000000001, -3.8000000000000003, -3.700000000000001, -3.700000000000001, -3.8000000000000007, -3.500000000000001, -4.100000000000001, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -3.6000000000000005, -3.7000000000000006, -10.7, -4.000000000000002, -3.600000000000001, -3.800000000000001, -3.8000000000000003, -3.8000000000000007, -3.7000000000000006, -3.700000000000001, -3.9000000000000012, -3.800000000000001, -4.100000000000001, -3.6000000000000005, -3.9000000000000004, -3.7000000000000006, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -3.7000000000000006, -3.900000000000001, -4.100000000000001, -12.5, -3.500000000000001, -4.000000000000001, -3.800000000000001, -3.900000000000001, -11.4, -3.900000000000001, -3.6000000000000005, -3.900000000000001, -3.900000000000001, -3.900000000000001, -10.5, -3.8000000000000007, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -3.900000000000001, -3.700000000000001, -3.7000000000000006, -3.6000000000000005, -4.100000000000001, -3.8000000000000007, -3.9000000000000012, -3.900000000000001, -3.700000000000001, -3.6000000000000005, -4.000000000000001, -4.100000000000001, -3.5000000000000004, -3.5000000000000004, -3.6000000000000005, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -3.8000000000000007, -3.700000000000001, -4.100000000000001, -3.9000000000000012, -4.100000000000001, -3.800000000000001, -3.7000000000000006, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -3.700000000000001, -3.6000000000000005, -3.9000000000000012, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -3.7000000000000006, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.9000000000000012, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -3.800000000000001, -10.0, -3.9000000000000004, -12.1, -10.1, -3.8000000000000007, -3.6000000000000005, -4.000000000000002, -12.700000000000001, -11.1, -10.9, -4.1000000000000005, -3.8000000000000007, -3.800000000000001, -3.9000000000000012, -3.700000000000001, -4.000000000000002, -4.000000000000001, -4.000000000000002, -4.200000000000001, -4.0, -4.100000000000001, -4.200000000000001, -3.6000000000000005, -4.000000000000001, -3.5000000000000004, -3.600000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.200000000000001, -3.900000000000001, -3.8000000000000007, -3.5000000000000004, -3.7000000000000006, -3.7000000000000006, -3.6000000000000005, -3.600000000000001, -4.100000000000001, -3.8000000000000007, -3.600000000000001, -3.8000000000000007, -4.000000000000001, -3.8000000000000003, -3.900000000000001, -3.900000000000001, -3.700000000000001, -4.000000000000001, -3.7, -3.900000000000001, -3.900000000000001, -3.9000000000000004, -3.6000000000000005, -3.9000000000000012, -4.200000000000001, -3.900000000000001, -4.000000000000001, -11.600000000000001, -4.200000000000001, -4.100000000000001, -10.0, -3.7000000000000006, -4.100000000000001, -4.000000000000001, -3.500000000000001, -3.600000000000001, -4.200000000000001, -4.1000000000000005, -4.100000000000001, -3.8000000000000007, -3.8000000000000003, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.4000000000000004, -3.400000000000001, -3.700000000000001, -4.000000000000001, -3.9000000000000012, -3.9000000000000004, -3.900000000000001, -4.000000000000002, -3.800000000000001, -4.000000000000001, -3.9000000000000004, -3.800000000000001, -11.8, -4.0, -3.900000000000001, -3.8000000000000007, -4.200000000000001, -3.8000000000000007, -3.7000000000000006, -3.7000000000000006, -3.900000000000001, -4.0, -3.8000000000000007, -3.900000000000001, -3.800000000000001, -3.900000000000001, -3.9000000000000012, -3.7000000000000006, -3.9000000000000012], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21, 16, 2, 21, 21, 21, 20, 10, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.639473544701186, "mean_inference_ms": 18.234377441334804, "mean_action_processing_ms": 0.957927487356033, "mean_env_wait_ms": 1.733121477996268, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0729625548549633, "StateBufferConnector_ms": 0.00864405128824052, "ViewRequirementAgentConnector_ms": 0.13290374123271387}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 164000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 164000, "timers": {"training_iteration_time_ms": 170940.15, "load_time_ms": 1.142, "load_throughput": 3502989.101, "learn_time_ms": 169969.869, "learn_throughput": 23.534, "synch_weights_time_ms": 182.02}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "done": false, "episodes_total": 8689, "training_iteration": 41, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-06_22-52-24", "timestamp": 1680814344, "time_this_iter_s": 170.54235434532166, "time_total_s": 7008.915356874466, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476cb670>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7effc2556f70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 7008.915356874466, "timesteps_since_restore": 0, "iterations_since_restore": 41, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.402880658436214, "ram_util_percent": 23.683950617283948}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.894507793713641, "cur_kl_coeff": 24.631531333923345, "cur_lr": 0.01, "total_loss": 0.799086742820118, "policy_loss": 0.0004335331239847727, "vf_loss": 0.5806112692280803, "vf_explained_var": 0.6051837075782078, "kl": 0.00885214734899496, "entropy": 3.0804421845302787, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 38595.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "sampler_results": {"episode_reward_max": -3.4000000000000004, "episode_reward_min": -12.5, "episode_reward_mean": -4.617874396135266, "episode_len_mean": 19.56038647342995, "episode_media": {}, "episodes_this_iter": 207, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.9000000000000012, -3.7000000000000015, -4.000000000000002, -3.6000000000000005, -3.5000000000000004, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -3.5000000000000004, -10.4, -10.1, -10.7, -3.800000000000001, -3.900000000000001, -4.000000000000001, -10.8, -10.1, -3.7000000000000006, -4.000000000000001, -3.7000000000000006, -3.800000000000001, -3.5000000000000004, -3.900000000000001, -4.100000000000001, -3.800000000000001, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -4.100000000000001, -3.700000000000001, -3.7000000000000006, -3.800000000000001, -3.900000000000001, -3.4000000000000004, -4.0, -3.800000000000001, -3.8000000000000007, -3.7000000000000006, -3.7000000000000006, -3.800000000000001, -4.0, -4.000000000000001, -3.800000000000001, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -4.000000000000002, -3.7000000000000006, -3.8000000000000003, -3.8000000000000007, -3.900000000000001, -10.3, -3.5000000000000004, -3.7000000000000006, -10.0, -3.9000000000000012, -3.9000000000000004, -3.600000000000001, -3.9000000000000004, -3.7000000000000006, -4.000000000000002, -3.700000000000001, -3.8000000000000007, -12.4, -3.400000000000001, -4.000000000000001, -3.6, -3.7000000000000006, -3.6000000000000005, -3.9000000000000004, -4.300000000000001, -3.900000000000001, -3.8000000000000007, -3.800000000000001, -3.9000000000000012, -4.200000000000001, -3.700000000000001, -3.900000000000001, -4.100000000000001, -3.600000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.9000000000000012, -3.8000000000000007, -3.9000000000000012, -3.9000000000000012, -10.9, -4.100000000000001, -3.900000000000001, -3.600000000000001, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -4.0, -3.8000000000000007, -4.000000000000001, -10.1, -4.100000000000001, -11.4, -10.7, -11.5, -3.8000000000000007, -4.000000000000001, -11.2, -4.100000000000001, -10.7, -3.800000000000001, -3.4000000000000004, -3.6000000000000005, -12.200000000000001, -10.8, -3.8000000000000007, -3.700000000000001, -10.4, -3.600000000000001, -10.5, -12.5, -10.7, -3.8000000000000007, -3.9000000000000012, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -4.200000000000001, -3.6000000000000005, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.6000000000000005, -3.5000000000000004, -4.0, -3.9000000000000012, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.9000000000000012, -4.200000000000001, -4.000000000000001, -3.700000000000001, -3.6000000000000005, -3.6000000000000005, -3.900000000000001, -3.800000000000001, -3.400000000000001, -3.900000000000001, -3.800000000000001, -4.100000000000001, -3.9000000000000012, -3.900000000000001, -4.1000000000000005, -3.700000000000001, -3.6000000000000005, -3.8000000000000007, -3.900000000000001, -10.4, -3.700000000000001, -3.6000000000000005, -3.600000000000001, -3.8000000000000007, -3.8000000000000007, -4.200000000000001, -3.800000000000001, -3.800000000000001, -3.700000000000001, -3.900000000000001, -3.8000000000000007, -3.600000000000001, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -3.700000000000001, -3.8000000000000003, -3.7000000000000006, -3.600000000000001, -3.700000000000001, -3.9000000000000012, -3.6000000000000005, -3.900000000000001, -3.6000000000000005, -3.800000000000001, -3.700000000000001, -12.0, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.300000000000001, -3.8000000000000007, -3.700000000000001, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -3.700000000000001, -3.9000000000000012, -3.600000000000001, -4.000000000000001, -3.900000000000001, -3.500000000000001, -3.6000000000000005, -4.000000000000002, -3.8000000000000007, -3.9000000000000012, -3.9000000000000012], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 2, 6, 21, 21, 21, 9, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 12, 6, 12, 21, 21, 10, 21, 7, 21, 21, 21, 17, 8, 21, 21, 5, 21, 5, 18, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.639241897106714, "mean_inference_ms": 18.216086787610283, "mean_action_processing_ms": 0.9552333959011613, "mean_env_wait_ms": 1.7320131853869016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07784977051370962, "StateBufferConnector_ms": 0.009355337723441746, "ViewRequirementAgentConnector_ms": 0.14161787171294724}}, "episode_reward_max": -3.4000000000000004, "episode_reward_min": -12.5, "episode_reward_mean": -4.617874396135266, "episode_len_mean": 19.56038647342995, "episodes_this_iter": 207, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.9000000000000012, -3.7000000000000015, -4.000000000000002, -3.6000000000000005, -3.5000000000000004, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -3.5000000000000004, -10.4, -10.1, -10.7, -3.800000000000001, -3.900000000000001, -4.000000000000001, -10.8, -10.1, -3.7000000000000006, -4.000000000000001, -3.7000000000000006, -3.800000000000001, -3.5000000000000004, -3.900000000000001, -4.100000000000001, -3.800000000000001, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -4.100000000000001, -3.700000000000001, -3.7000000000000006, -3.800000000000001, -3.900000000000001, -3.4000000000000004, -4.0, -3.800000000000001, -3.8000000000000007, -3.7000000000000006, -3.7000000000000006, -3.800000000000001, -4.0, -4.000000000000001, -3.800000000000001, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -4.000000000000002, -3.7000000000000006, -3.8000000000000003, -3.8000000000000007, -3.900000000000001, -10.3, -3.5000000000000004, -3.7000000000000006, -10.0, -3.9000000000000012, -3.9000000000000004, -3.600000000000001, -3.9000000000000004, -3.7000000000000006, -4.000000000000002, -3.700000000000001, -3.8000000000000007, -12.4, -3.400000000000001, -4.000000000000001, -3.6, -3.7000000000000006, -3.6000000000000005, -3.9000000000000004, -4.300000000000001, -3.900000000000001, -3.8000000000000007, -3.800000000000001, -3.9000000000000012, -4.200000000000001, -3.700000000000001, -3.900000000000001, -4.100000000000001, -3.600000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.9000000000000012, -3.8000000000000007, -3.9000000000000012, -3.9000000000000012, -10.9, -4.100000000000001, -3.900000000000001, -3.600000000000001, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -4.0, -3.8000000000000007, -4.000000000000001, -10.1, -4.100000000000001, -11.4, -10.7, -11.5, -3.8000000000000007, -4.000000000000001, -11.2, -4.100000000000001, -10.7, -3.800000000000001, -3.4000000000000004, -3.6000000000000005, -12.200000000000001, -10.8, -3.8000000000000007, -3.700000000000001, -10.4, -3.600000000000001, -10.5, -12.5, -10.7, -3.8000000000000007, -3.9000000000000012, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -4.200000000000001, -3.6000000000000005, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.6000000000000005, -3.5000000000000004, -4.0, -3.9000000000000012, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.9000000000000012, -4.200000000000001, -4.000000000000001, -3.700000000000001, -3.6000000000000005, -3.6000000000000005, -3.900000000000001, -3.800000000000001, -3.400000000000001, -3.900000000000001, -3.800000000000001, -4.100000000000001, -3.9000000000000012, -3.900000000000001, -4.1000000000000005, -3.700000000000001, -3.6000000000000005, -3.8000000000000007, -3.900000000000001, -10.4, -3.700000000000001, -3.6000000000000005, -3.600000000000001, -3.8000000000000007, -3.8000000000000007, -4.200000000000001, -3.800000000000001, -3.800000000000001, -3.700000000000001, -3.900000000000001, -3.8000000000000007, -3.600000000000001, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -3.700000000000001, -3.8000000000000003, -3.7000000000000006, -3.600000000000001, -3.700000000000001, -3.9000000000000012, -3.6000000000000005, -3.900000000000001, -3.6000000000000005, -3.800000000000001, -3.700000000000001, -12.0, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.300000000000001, -3.8000000000000007, -3.700000000000001, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -3.700000000000001, -3.9000000000000012, -3.600000000000001, -4.000000000000001, -3.900000000000001, -3.500000000000001, -3.6000000000000005, -4.000000000000002, -3.8000000000000007, -3.9000000000000012, -3.9000000000000012], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 2, 6, 21, 21, 21, 9, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 12, 6, 12, 21, 21, 10, 21, 7, 21, 21, 21, 17, 8, 21, 21, 5, 21, 5, 18, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.639241897106714, "mean_inference_ms": 18.216086787610283, "mean_action_processing_ms": 0.9552333959011613, "mean_env_wait_ms": 1.7320131853869016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07784977051370962, "StateBufferConnector_ms": 0.009355337723441746, "ViewRequirementAgentConnector_ms": 0.14161787171294724}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 170861.47, "load_time_ms": 1.132, "load_throughput": 3534277.649, "learn_time_ms": 169899.018, "learn_throughput": 23.543, "synch_weights_time_ms": 184.553}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "episodes_total": 8896, "training_iteration": 42, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-06_22-55-14", "timestamp": 1680814514, "time_this_iter_s": 170.82236051559448, "time_total_s": 7179.73771739006, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f014750bf70>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01477160d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 7179.73771739006, "timesteps_since_restore": 0, "iterations_since_restore": 42, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.41358024691358, "ram_util_percent": 23.643621399176954}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.697465572818633, "cur_kl_coeff": 24.631531333923345, "cur_lr": 0.01, "total_loss": 0.8194868293580829, "policy_loss": 0.0016056036115974508, "vf_loss": 0.5000112793858974, "vf_explained_var": 0.5643741249397237, "kl": 0.01290500183828846, "entropy": 3.101810448144072, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 39525.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "sampler_results": {"episode_reward_max": -3.400000000000001, "episode_reward_min": -12.9, "episode_reward_mean": -4.78495145631068, "episode_len_mean": 19.08252427184466, "episode_media": {}, "episodes_this_iter": 206, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.900000000000001, -10.7, -3.6, -4.000000000000001, -10.1, -3.7000000000000006, -3.8000000000000007, -10.5, -3.9000000000000012, -10.6, -10.2, -4.000000000000001, -10.4, -10.4, -10.3, -10.2, -3.700000000000001, -3.8000000000000007, -10.6, -3.6000000000000005, -3.700000000000001, -10.2, -3.8000000000000007, -3.8000000000000007, -3.7000000000000006, -3.700000000000001, -10.1, -3.900000000000001, -10.2, -3.7000000000000006, -10.9, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -3.700000000000001, -3.8000000000000007, -3.400000000000001, -4.000000000000001, -3.9000000000000012, -3.7000000000000006, -4.000000000000002, -3.900000000000001, -3.9000000000000012, -4.000000000000001, -3.700000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.9000000000000012, -3.800000000000001, -3.800000000000001, -4.000000000000002, -3.8000000000000003, -3.900000000000001, -4.000000000000002, -3.8000000000000007, -3.9000000000000004, -3.900000000000001, -3.8000000000000007, -3.800000000000001, -3.7000000000000006, -4.000000000000001, -3.6000000000000005, -3.8000000000000007, -3.7000000000000006, -3.9000000000000012, -4.000000000000002, -4.000000000000001, -3.800000000000001, -3.5000000000000004, -4.000000000000001, -3.9000000000000012, -3.800000000000001, -3.8000000000000007, -3.900000000000001, -3.800000000000001, -12.0, -3.900000000000001, -4.000000000000001, -4.000000000000002, -3.900000000000001, -4.100000000000001, -10.5, -3.7000000000000006, -3.900000000000001, -3.900000000000001, -4.0, -10.7, -3.9000000000000012, -4.300000000000001, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000002, -10.0, -3.8000000000000007, -11.7, -3.9000000000000012, -10.0, -4.000000000000001, -3.800000000000001, -4.100000000000001, -3.8000000000000007, -10.0, -3.800000000000001, -11.1, -4.000000000000001, -10.1, -3.6000000000000005, -3.700000000000001, -11.4, -3.6000000000000005, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.9000000000000012, -4.0, -3.8000000000000007, -3.600000000000001, -3.600000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.9000000000000012, -3.600000000000001, -4.000000000000001, -3.8000000000000007, -3.500000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.1000000000000005, -3.9000000000000012, -3.6, -3.700000000000001, -4.000000000000001, -3.500000000000001, -4.300000000000001, -3.8000000000000007, -3.9000000000000012, -3.900000000000001, -3.600000000000001, -3.7000000000000006, -3.8000000000000007, -12.9, -3.900000000000001, -3.8000000000000007, -3.700000000000001, -3.8000000000000003, -3.800000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000002, -3.8000000000000007, -4.000000000000002, -4.000000000000002, -3.900000000000001, -3.800000000000001, -3.900000000000001, -3.9000000000000012, -3.800000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -3.7000000000000006, -3.900000000000001, -3.800000000000001, -11.9, -3.600000000000001, -3.8000000000000007, -12.5, -3.400000000000001, -3.9000000000000012, -3.6000000000000005, -3.7000000000000006, -3.8000000000000007, -3.700000000000001, -3.900000000000001, -3.8000000000000007, -11.0, -4.000000000000001, -4.000000000000001, -3.5000000000000004, -3.7000000000000006, -4.100000000000001, -3.700000000000001, -3.8000000000000007, -3.800000000000001, -4.100000000000001, -3.9000000000000012, -3.700000000000001, -3.700000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -4.0, -3.700000000000001], "episode_lengths": [21, 7, 21, 21, 2, 21, 21, 5, 21, 7, 3, 21, 5, 4, 4, 3, 21, 21, 5, 21, 21, 3, 21, 21, 21, 21, 2, 21, 3, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21, 15, 21, 1, 21, 21, 21, 21, 1, 21, 9, 21, 2, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.647315062580562, "mean_inference_ms": 18.247345956294552, "mean_action_processing_ms": 0.9561528138800478, "mean_env_wait_ms": 1.7371435091096896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0795115544958022, "StateBufferConnector_ms": 0.009473897878406117, "ViewRequirementAgentConnector_ms": 0.1395845876156705}}, "episode_reward_max": -3.400000000000001, "episode_reward_min": -12.9, "episode_reward_mean": -4.78495145631068, "episode_len_mean": 19.08252427184466, "episodes_this_iter": 206, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.900000000000001, -10.7, -3.6, -4.000000000000001, -10.1, -3.7000000000000006, -3.8000000000000007, -10.5, -3.9000000000000012, -10.6, -10.2, -4.000000000000001, -10.4, -10.4, -10.3, -10.2, -3.700000000000001, -3.8000000000000007, -10.6, -3.6000000000000005, -3.700000000000001, -10.2, -3.8000000000000007, -3.8000000000000007, -3.7000000000000006, -3.700000000000001, -10.1, -3.900000000000001, -10.2, -3.7000000000000006, -10.9, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -3.700000000000001, -3.8000000000000007, -3.400000000000001, -4.000000000000001, -3.9000000000000012, -3.7000000000000006, -4.000000000000002, -3.900000000000001, -3.9000000000000012, -4.000000000000001, -3.700000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.9000000000000012, -3.800000000000001, -3.800000000000001, -4.000000000000002, -3.8000000000000003, -3.900000000000001, -4.000000000000002, -3.8000000000000007, -3.9000000000000004, -3.900000000000001, -3.8000000000000007, -3.800000000000001, -3.7000000000000006, -4.000000000000001, -3.6000000000000005, -3.8000000000000007, -3.7000000000000006, -3.9000000000000012, -4.000000000000002, -4.000000000000001, -3.800000000000001, -3.5000000000000004, -4.000000000000001, -3.9000000000000012, -3.800000000000001, -3.8000000000000007, -3.900000000000001, -3.800000000000001, -12.0, -3.900000000000001, -4.000000000000001, -4.000000000000002, -3.900000000000001, -4.100000000000001, -10.5, -3.7000000000000006, -3.900000000000001, -3.900000000000001, -4.0, -10.7, -3.9000000000000012, -4.300000000000001, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000002, -10.0, -3.8000000000000007, -11.7, -3.9000000000000012, -10.0, -4.000000000000001, -3.800000000000001, -4.100000000000001, -3.8000000000000007, -10.0, -3.800000000000001, -11.1, -4.000000000000001, -10.1, -3.6000000000000005, -3.700000000000001, -11.4, -3.6000000000000005, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.9000000000000012, -4.0, -3.8000000000000007, -3.600000000000001, -3.600000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.9000000000000012, -3.600000000000001, -4.000000000000001, -3.8000000000000007, -3.500000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.1000000000000005, -3.9000000000000012, -3.6, -3.700000000000001, -4.000000000000001, -3.500000000000001, -4.300000000000001, -3.8000000000000007, -3.9000000000000012, -3.900000000000001, -3.600000000000001, -3.7000000000000006, -3.8000000000000007, -12.9, -3.900000000000001, -3.8000000000000007, -3.700000000000001, -3.8000000000000003, -3.800000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000002, -3.8000000000000007, -4.000000000000002, -4.000000000000002, -3.900000000000001, -3.800000000000001, -3.900000000000001, -3.9000000000000012, -3.800000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -3.7000000000000006, -3.900000000000001, -3.800000000000001, -11.9, -3.600000000000001, -3.8000000000000007, -12.5, -3.400000000000001, -3.9000000000000012, -3.6000000000000005, -3.7000000000000006, -3.8000000000000007, -3.700000000000001, -3.900000000000001, -3.8000000000000007, -11.0, -4.000000000000001, -4.000000000000001, -3.5000000000000004, -3.7000000000000006, -4.100000000000001, -3.700000000000001, -3.8000000000000007, -3.800000000000001, -4.100000000000001, -3.9000000000000012, -3.700000000000001, -3.700000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -4.0, -3.700000000000001], "episode_lengths": [21, 7, 21, 21, 2, 21, 21, 5, 21, 7, 3, 21, 5, 4, 4, 3, 21, 21, 5, 21, 21, 3, 21, 21, 21, 21, 2, 21, 3, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21, 15, 21, 1, 21, 21, 21, 21, 1, 21, 9, 21, 2, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.647315062580562, "mean_inference_ms": 18.247345956294552, "mean_action_processing_ms": 0.9561528138800478, "mean_env_wait_ms": 1.7371435091096896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0795115544958022, "StateBufferConnector_ms": 0.009473897878406117, "ViewRequirementAgentConnector_ms": 0.1395845876156705}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 172000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 172000, "timers": {"training_iteration_time_ms": 170936.118, "load_time_ms": 1.128, "load_throughput": 3547355.112, "learn_time_ms": 169969.892, "learn_throughput": 23.534, "synch_weights_time_ms": 185.793}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "done": false, "episodes_total": 9102, "training_iteration": 43, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-06_22-58-06", "timestamp": 1680814686, "time_this_iter_s": 171.47571110725403, "time_total_s": 7351.213428497314, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01475e24c0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01475ecc10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 7351.213428497314, "timesteps_since_restore": 0, "iterations_since_restore": 43, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 6.072839506172841, "ram_util_percent": 23.900411522633743}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.077264952915971, "cur_kl_coeff": 24.631531333923345, "cur_lr": 0.01, "total_loss": 0.9678980573370892, "policy_loss": -0.002032455913121662, "vf_loss": 0.7169543587833002, "vf_explained_var": 0.4400091432755993, "kl": 0.010270419495802383, "entropy": 3.104205524024143, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 40455.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "sampler_results": {"episode_reward_max": -3.4000000000000004, "episode_reward_min": -12.5, "episode_reward_mean": -5.16986301369863, "episode_len_mean": 18.38812785388128, "episode_media": {}, "episodes_this_iter": 219, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.8, -3.8000000000000007, -10.6, -3.800000000000001, -10.6, -3.500000000000001, -10.3, -10.2, -10.3, -3.8000000000000007, -10.4, -3.8000000000000007, -3.9000000000000012, -3.9000000000000012, -11.4, -10.9, -4.0, -3.7000000000000006, -10.6, -10.7, -3.6000000000000014, -10.5, -3.600000000000001, -3.6000000000000005, -10.9, -12.1, -10.4, -10.1, -10.2, -3.900000000000001, -10.2, -10.5, -4.000000000000001, -10.1, -10.1, -3.6000000000000014, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -3.6000000000000005, -3.7000000000000006, -3.7000000000000006, -4.0, -3.9000000000000012, -4.200000000000001, -4.000000000000002, -3.900000000000001, -4.000000000000001, -3.4000000000000004, -3.6000000000000005, -3.9000000000000012, -3.800000000000001, -4.000000000000001, -3.8000000000000007, -3.7000000000000006, -3.9000000000000012, -4.100000000000001, -12.100000000000001, -3.900000000000001, -3.6000000000000005, -10.7, -12.200000000000001, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -3.700000000000001, -3.5000000000000004, -3.8000000000000007, -3.8000000000000007, -3.800000000000001, -4.000000000000001, -10.3, -3.6000000000000005, -3.800000000000001, -3.800000000000001, -4.100000000000001, -4.000000000000001, -3.700000000000001, -4.000000000000001, -4.000000000000001, -3.800000000000001, -3.500000000000001, -3.8000000000000007, -11.7, -3.8000000000000007, -3.9000000000000012, -3.800000000000001, -3.8000000000000007, -3.700000000000001, -4.100000000000001, -3.900000000000001, -4.200000000000001, -10.3, -4.200000000000001, -3.500000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000002, -3.600000000000001, -3.5000000000000004, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -10.8, -3.900000000000001, -10.2, -4.000000000000001, -4.100000000000001, -3.900000000000001, -11.6, -4.100000000000001, -3.600000000000001, -3.8000000000000007, -3.8000000000000007, -10.3, -3.700000000000001, -3.800000000000001, -10.5, -4.000000000000002, -4.000000000000001, -10.0, -4.000000000000001, -3.7000000000000006, -10.5, -12.5, -10.1, -3.800000000000001, -3.6000000000000005, -3.700000000000001, -4.000000000000001, -3.5000000000000004, -4.100000000000001, -3.8000000000000007, -3.7000000000000006, -3.900000000000001, -3.7000000000000006, -4.100000000000001, -3.8000000000000007, -3.600000000000001, -3.7000000000000006, -4.000000000000001, -4.100000000000001, -3.6000000000000005, -4.100000000000001, -3.900000000000001, -4.000000000000002, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.600000000000001, -3.600000000000001, -3.8000000000000007, -3.9000000000000012, -3.8000000000000007, -3.7000000000000006, -3.900000000000001, -4.000000000000001, -3.7, -11.3, -4.000000000000002, -3.8000000000000007, -3.800000000000001, -4.100000000000001, -3.8000000000000007, -11.4, -3.6000000000000005, -11.4, -3.800000000000001, -4.000000000000002, -4.100000000000001, -3.8000000000000007, -3.700000000000001, -3.800000000000001, -3.700000000000001, -3.7000000000000006, -3.900000000000001, -3.6000000000000005, -3.6000000000000005, -3.600000000000001, -3.8000000000000007, -3.600000000000001, -3.800000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -3.8000000000000007, -3.800000000000001, -3.8000000000000007, -3.7000000000000006, -12.5, -3.8000000000000007, -3.800000000000001, -3.500000000000001, -11.700000000000001, -3.8000000000000007, -3.9000000000000012, -3.8000000000000007, -4.300000000000001, -3.900000000000001, -3.900000000000001, -3.9000000000000012, -3.800000000000001, -4.000000000000002, -4.200000000000001, -3.7000000000000006, -3.9000000000000004, -10.1, -3.6000000000000005, -3.6000000000000005, -3.8000000000000007, -3.8000000000000007, -3.700000000000001], "episode_lengths": [7, 21, 7, 21, 6, 21, 4, 3, 4, 21, 5, 21, 21, 21, 11, 9, 21, 21, 6, 7, 21, 6, 21, 21, 8, 15, 5, 2, 3, 21, 3, 6, 21, 2, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 7, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 3, 21, 21, 21, 14, 21, 21, 21, 21, 3, 21, 21, 5, 21, 21, 1, 21, 21, 5, 18, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 11, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.678046807541948, "mean_inference_ms": 18.30436330251403, "mean_action_processing_ms": 0.9573021369735457, "mean_env_wait_ms": 1.7379035802112635, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0782591022857248, "StateBufferConnector_ms": 0.010549967691778593, "ViewRequirementAgentConnector_ms": 0.14235058875933085}}, "episode_reward_max": -3.4000000000000004, "episode_reward_min": -12.5, "episode_reward_mean": -5.16986301369863, "episode_len_mean": 18.38812785388128, "episodes_this_iter": 219, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10.8, -3.8000000000000007, -10.6, -3.800000000000001, -10.6, -3.500000000000001, -10.3, -10.2, -10.3, -3.8000000000000007, -10.4, -3.8000000000000007, -3.9000000000000012, -3.9000000000000012, -11.4, -10.9, -4.0, -3.7000000000000006, -10.6, -10.7, -3.6000000000000014, -10.5, -3.600000000000001, -3.6000000000000005, -10.9, -12.1, -10.4, -10.1, -10.2, -3.900000000000001, -10.2, -10.5, -4.000000000000001, -10.1, -10.1, -3.6000000000000014, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -3.6000000000000005, -3.7000000000000006, -3.7000000000000006, -4.0, -3.9000000000000012, -4.200000000000001, -4.000000000000002, -3.900000000000001, -4.000000000000001, -3.4000000000000004, -3.6000000000000005, -3.9000000000000012, -3.800000000000001, -4.000000000000001, -3.8000000000000007, -3.7000000000000006, -3.9000000000000012, -4.100000000000001, -12.100000000000001, -3.900000000000001, -3.6000000000000005, -10.7, -12.200000000000001, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -3.700000000000001, -3.5000000000000004, -3.8000000000000007, -3.8000000000000007, -3.800000000000001, -4.000000000000001, -10.3, -3.6000000000000005, -3.800000000000001, -3.800000000000001, -4.100000000000001, -4.000000000000001, -3.700000000000001, -4.000000000000001, -4.000000000000001, -3.800000000000001, -3.500000000000001, -3.8000000000000007, -11.7, -3.8000000000000007, -3.9000000000000012, -3.800000000000001, -3.8000000000000007, -3.700000000000001, -4.100000000000001, -3.900000000000001, -4.200000000000001, -10.3, -4.200000000000001, -3.500000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000002, -3.600000000000001, -3.5000000000000004, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -10.8, -3.900000000000001, -10.2, -4.000000000000001, -4.100000000000001, -3.900000000000001, -11.6, -4.100000000000001, -3.600000000000001, -3.8000000000000007, -3.8000000000000007, -10.3, -3.700000000000001, -3.800000000000001, -10.5, -4.000000000000002, -4.000000000000001, -10.0, -4.000000000000001, -3.7000000000000006, -10.5, -12.5, -10.1, -3.800000000000001, -3.6000000000000005, -3.700000000000001, -4.000000000000001, -3.5000000000000004, -4.100000000000001, -3.8000000000000007, -3.7000000000000006, -3.900000000000001, -3.7000000000000006, -4.100000000000001, -3.8000000000000007, -3.600000000000001, -3.7000000000000006, -4.000000000000001, -4.100000000000001, -3.6000000000000005, -4.100000000000001, -3.900000000000001, -4.000000000000002, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.600000000000001, -3.600000000000001, -3.8000000000000007, -3.9000000000000012, -3.8000000000000007, -3.7000000000000006, -3.900000000000001, -4.000000000000001, -3.7, -11.3, -4.000000000000002, -3.8000000000000007, -3.800000000000001, -4.100000000000001, -3.8000000000000007, -11.4, -3.6000000000000005, -11.4, -3.800000000000001, -4.000000000000002, -4.100000000000001, -3.8000000000000007, -3.700000000000001, -3.800000000000001, -3.700000000000001, -3.7000000000000006, -3.900000000000001, -3.6000000000000005, -3.6000000000000005, -3.600000000000001, -3.8000000000000007, -3.600000000000001, -3.800000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -3.8000000000000007, -3.800000000000001, -3.8000000000000007, -3.7000000000000006, -12.5, -3.8000000000000007, -3.800000000000001, -3.500000000000001, -11.700000000000001, -3.8000000000000007, -3.9000000000000012, -3.8000000000000007, -4.300000000000001, -3.900000000000001, -3.900000000000001, -3.9000000000000012, -3.800000000000001, -4.000000000000002, -4.200000000000001, -3.7000000000000006, -3.9000000000000004, -10.1, -3.6000000000000005, -3.6000000000000005, -3.8000000000000007, -3.8000000000000007, -3.700000000000001], "episode_lengths": [7, 21, 7, 21, 6, 21, 4, 3, 4, 21, 5, 21, 21, 21, 11, 9, 21, 21, 6, 7, 21, 6, 21, 21, 8, 15, 5, 2, 3, 21, 3, 6, 21, 2, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 7, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 3, 21, 21, 21, 14, 21, 21, 21, 21, 3, 21, 21, 5, 21, 21, 1, 21, 21, 5, 18, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 11, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.678046807541948, "mean_inference_ms": 18.30436330251403, "mean_action_processing_ms": 0.9573021369735457, "mean_env_wait_ms": 1.7379035802112635, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0782591022857248, "StateBufferConnector_ms": 0.010549967691778593, "ViewRequirementAgentConnector_ms": 0.14235058875933085}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 170946.926, "load_time_ms": 1.136, "load_throughput": 3522479.162, "learn_time_ms": 169975.099, "learn_throughput": 23.533, "synch_weights_time_ms": 184.874}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "episodes_total": 9321, "training_iteration": 44, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-06_23-00-57", "timestamp": 1680814857, "time_this_iter_s": 170.9473671913147, "time_total_s": 7522.160795688629, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01475699a0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0147520700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 7522.160795688629, "timesteps_since_restore": 0, "iterations_since_restore": 44, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 6.368724279835391, "ram_util_percent": 24.120164609053493}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.564640913983826, "cur_kl_coeff": 24.631531333923345, "cur_lr": 0.01, "total_loss": 0.7713572361336279, "policy_loss": 0.0018216764769687127, "vf_loss": 0.5885717431183464, "vf_explained_var": 0.543244158773012, "kl": 0.007346835894377461, "entropy": 3.0988276061191353, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 41385.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "sampler_results": {"episode_reward_max": -3.400000000000001, "episode_reward_min": -12.7, "episode_reward_mean": -4.873459715639811, "episode_len_mean": 19.0, "episode_media": {}, "episodes_this_iter": 211, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.8, -10.5, -11.2, -11.6, -10.4, -10.7, -3.7000000000000006, -3.7000000000000006, -10.0, -3.8000000000000007, -3.700000000000001, -4.200000000000001, -10.3, -10.7, -4.000000000000002, -3.7000000000000006, -10.4, -3.700000000000001, -10.1, -10.3, -3.900000000000001, -3.900000000000001, -10.5, -10.7, -10.3, -11.9, -10.8, -10.8, -4.000000000000002, -3.900000000000001, -10.4, -3.600000000000001, -3.6000000000000005, -3.7000000000000006, -3.7000000000000006, -3.900000000000001, -3.9000000000000012, -3.800000000000001, -4.0, -3.800000000000001, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -3.700000000000001, -10.9, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -4.100000000000001, -3.8000000000000007, -3.500000000000001, -3.9000000000000012, -3.6000000000000005, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -11.7, -3.8000000000000007, -3.7, -3.500000000000001, -4.000000000000002, -3.8000000000000003, -4.000000000000001, -4.100000000000001, -3.800000000000001, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -3.6000000000000005, -3.600000000000001, -4.000000000000001, -3.9000000000000012, -4.200000000000001, -4.1000000000000005, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.9000000000000012, -3.900000000000001, -3.700000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -3.800000000000001, -3.8000000000000003, -3.600000000000001, -4.0, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.6000000000000005, -3.600000000000001, -4.000000000000001, -3.7000000000000006, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -10.9, -3.8000000000000007, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -12.0, -3.900000000000001, -3.9000000000000012, -3.900000000000001, -10.3, -10.3, -10.5, -3.9000000000000012, -3.7000000000000006, -4.000000000000002, -10.5, -3.7000000000000006, -4.000000000000001, -3.400000000000001, -3.700000000000001, -4.000000000000002, -4.200000000000001, -3.900000000000001, -3.900000000000001, -3.5000000000000004, -3.800000000000001, -3.5000000000000004, -11.2, -3.900000000000001, -4.100000000000001, -12.1, -3.500000000000001, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -3.9000000000000012, -3.8000000000000007, -4.000000000000001, -3.700000000000001, -3.800000000000001, -3.700000000000001, -3.500000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -10.9, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -3.700000000000001, -3.900000000000001, -4.1000000000000005, -4.000000000000002, -3.800000000000001, -4.000000000000001, -3.8000000000000007, -3.8000000000000003, -4.000000000000001, -3.900000000000001, -4.0, -3.9000000000000012, -3.900000000000001, -3.9000000000000012, -3.9000000000000004, -4.0, -3.700000000000001, -3.9000000000000012, -4.100000000000001, -3.7000000000000006, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -3.6000000000000005, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -3.7000000000000006, -3.6000000000000005, -3.700000000000001, -3.7000000000000006, -4.100000000000001, -3.900000000000001, -3.700000000000001, -3.900000000000001, -3.9000000000000012, -3.7000000000000006, -12.7, -3.8000000000000007, -4.1000000000000005, -4.300000000000001, -4.000000000000001, -3.6000000000000005, -3.800000000000001, -3.7000000000000006, -3.7000000000000006, -3.6000000000000005, -3.700000000000001, -3.700000000000001, -4.000000000000001, -3.800000000000001, -3.800000000000001], "episode_lengths": [7, 5, 10, 12, 5, 7, 21, 21, 1, 21, 21, 21, 4, 6, 21, 21, 4, 21, 2, 4, 21, 21, 5, 6, 4, 14, 7, 7, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 14, 21, 21, 21, 4, 3, 5, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.664923759502306, "mean_inference_ms": 18.26950164385302, "mean_action_processing_ms": 0.9557730259500457, "mean_env_wait_ms": 1.7305704019472878, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0761968829620506, "StateBufferConnector_ms": 0.009501601847427151, "ViewRequirementAgentConnector_ms": 0.13863814385581355}}, "episode_reward_max": -3.400000000000001, "episode_reward_min": -12.7, "episode_reward_mean": -4.873459715639811, "episode_len_mean": 19.0, "episodes_this_iter": 211, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10.8, -10.5, -11.2, -11.6, -10.4, -10.7, -3.7000000000000006, -3.7000000000000006, -10.0, -3.8000000000000007, -3.700000000000001, -4.200000000000001, -10.3, -10.7, -4.000000000000002, -3.7000000000000006, -10.4, -3.700000000000001, -10.1, -10.3, -3.900000000000001, -3.900000000000001, -10.5, -10.7, -10.3, -11.9, -10.8, -10.8, -4.000000000000002, -3.900000000000001, -10.4, -3.600000000000001, -3.6000000000000005, -3.7000000000000006, -3.7000000000000006, -3.900000000000001, -3.9000000000000012, -3.800000000000001, -4.0, -3.800000000000001, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -3.700000000000001, -10.9, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -4.100000000000001, -3.8000000000000007, -3.500000000000001, -3.9000000000000012, -3.6000000000000005, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -11.7, -3.8000000000000007, -3.7, -3.500000000000001, -4.000000000000002, -3.8000000000000003, -4.000000000000001, -4.100000000000001, -3.800000000000001, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -3.6000000000000005, -3.600000000000001, -4.000000000000001, -3.9000000000000012, -4.200000000000001, -4.1000000000000005, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.9000000000000012, -3.900000000000001, -3.700000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -3.800000000000001, -3.8000000000000003, -3.600000000000001, -4.0, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.6000000000000005, -3.600000000000001, -4.000000000000001, -3.7000000000000006, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -10.9, -3.8000000000000007, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -12.0, -3.900000000000001, -3.9000000000000012, -3.900000000000001, -10.3, -10.3, -10.5, -3.9000000000000012, -3.7000000000000006, -4.000000000000002, -10.5, -3.7000000000000006, -4.000000000000001, -3.400000000000001, -3.700000000000001, -4.000000000000002, -4.200000000000001, -3.900000000000001, -3.900000000000001, -3.5000000000000004, -3.800000000000001, -3.5000000000000004, -11.2, -3.900000000000001, -4.100000000000001, -12.1, -3.500000000000001, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -3.9000000000000012, -3.8000000000000007, -4.000000000000001, -3.700000000000001, -3.800000000000001, -3.700000000000001, -3.500000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -10.9, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -3.700000000000001, -3.900000000000001, -4.1000000000000005, -4.000000000000002, -3.800000000000001, -4.000000000000001, -3.8000000000000007, -3.8000000000000003, -4.000000000000001, -3.900000000000001, -4.0, -3.9000000000000012, -3.900000000000001, -3.9000000000000012, -3.9000000000000004, -4.0, -3.700000000000001, -3.9000000000000012, -4.100000000000001, -3.7000000000000006, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -3.6000000000000005, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -3.7000000000000006, -3.6000000000000005, -3.700000000000001, -3.7000000000000006, -4.100000000000001, -3.900000000000001, -3.700000000000001, -3.900000000000001, -3.9000000000000012, -3.7000000000000006, -12.7, -3.8000000000000007, -4.1000000000000005, -4.300000000000001, -4.000000000000001, -3.6000000000000005, -3.800000000000001, -3.7000000000000006, -3.7000000000000006, -3.6000000000000005, -3.700000000000001, -3.700000000000001, -4.000000000000001, -3.800000000000001, -3.800000000000001], "episode_lengths": [7, 5, 10, 12, 5, 7, 21, 21, 1, 21, 21, 21, 4, 6, 21, 21, 4, 21, 2, 4, 21, 21, 5, 6, 4, 14, 7, 7, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 14, 21, 21, 21, 4, 3, 5, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.664923759502306, "mean_inference_ms": 18.26950164385302, "mean_action_processing_ms": 0.9557730259500457, "mean_env_wait_ms": 1.7305704019472878, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0761968829620506, "StateBufferConnector_ms": 0.009501601847427151, "ViewRequirementAgentConnector_ms": 0.13863814385581355}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 180000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 170895.706, "load_time_ms": 1.142, "load_throughput": 3502404.075, "learn_time_ms": 169928.428, "learn_throughput": 23.539, "synch_weights_time_ms": 182.232}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "episodes_total": 9532, "training_iteration": 45, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-06_23-03-48", "timestamp": 1680815028, "time_this_iter_s": 170.81676363945007, "time_total_s": 7692.977559328079, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01477a3070>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01475ecc10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 7692.977559328079, "timesteps_since_restore": 0, "iterations_since_restore": 45, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.747325102880658, "ram_util_percent": 24.19794238683127}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.06024504297523, "cur_kl_coeff": 24.631531333923345, "cur_lr": 0.01, "total_loss": 0.7586943290326544, "policy_loss": -0.009654405300996156, "vf_loss": 0.5810811743701016, "vf_explained_var": 0.5218542712990956, "kl": 0.007602757477966357, "entropy": 3.0977747273701493, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 42315.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "sampler_results": {"episode_reward_max": -3.2000000000000006, "episode_reward_min": -12.5, "episode_reward_mean": -4.855121951219513, "episode_len_mean": 18.897560975609757, "episode_media": {}, "episodes_this_iter": 205, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.0, -4.400000000000001, -10.3, -3.8000000000000003, -3.900000000000001, -11.4, -3.800000000000001, -11.3, -3.900000000000001, -10.1, -10.2, -3.8000000000000007, -11.3, -4.000000000000001, -10.4, -10.9, -3.900000000000001, -3.800000000000001, -10.5, -10.3, -10.8, -3.900000000000001, -10.1, -10.7, -3.500000000000001, -3.900000000000001, -3.700000000000001, -10.6, -10.2, -3.7000000000000006, -3.8000000000000003, -3.700000000000001, -3.6000000000000005, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -3.800000000000001, -3.8000000000000007, -3.9000000000000012, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -3.800000000000001, -4.000000000000001, -3.6000000000000005, -4.000000000000001, -3.400000000000001, -3.700000000000001, -4.100000000000001, -3.600000000000001, -10.0, -3.8000000000000007, -3.700000000000001, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -4.100000000000001, -4.100000000000001, -3.800000000000001, -3.9000000000000012, -3.800000000000001, -4.000000000000001, -3.900000000000001, -3.600000000000001, -4.000000000000001, -10.4, -3.700000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.9000000000000012, -3.8000000000000007, -11.7, -3.700000000000001, -3.7000000000000006, -3.6000000000000005, -3.700000000000001, -3.700000000000001, -3.900000000000001, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -4.000000000000002, -3.7000000000000006, -3.8000000000000003, -4.000000000000001, -3.9000000000000004, -4.100000000000001, -4.000000000000001, -3.800000000000001, -4.000000000000001, -3.700000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.6000000000000014, -4.000000000000001, -3.7000000000000006, -3.7000000000000006, -3.400000000000001, -3.800000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.900000000000001, -10.4, -4.000000000000001, -10.0, -3.700000000000001, -10.2, -3.700000000000001, -4.000000000000002, -3.900000000000001, -4.100000000000001, -3.600000000000001, -10.0, -3.600000000000001, -3.8000000000000007, -3.700000000000001, -4.000000000000002, -3.7000000000000006, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.5000000000000004, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -4.100000000000001, -3.6000000000000005, -4.000000000000001, -11.2, -4.200000000000001, -3.7000000000000006, -3.700000000000001, -4.000000000000001, -3.800000000000001, -3.8000000000000007, -4.000000000000002, -3.9000000000000004, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -3.7000000000000006, -3.8000000000000007, -3.8000000000000007, -4.200000000000001, -3.7000000000000006, -11.2, -3.9000000000000012, -3.7, -3.700000000000001, -4.200000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -10.8, -3.7000000000000006, -3.9000000000000012, -3.5000000000000004, -3.9000000000000012, -3.700000000000001, -3.9000000000000012, -3.900000000000001, -4.100000000000001, -3.700000000000001, -3.700000000000001, -3.700000000000001, -4.000000000000001, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -4.000000000000002, -4.0, -3.8000000000000007, -3.900000000000001, -3.700000000000001, -11.1, -3.7000000000000006, -4.000000000000001, -11.2, -4.000000000000002, -3.600000000000001, -3.700000000000001, -4.100000000000001, -3.2000000000000006, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -11.3, -4.0, -10.1, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000002, -3.8000000000000007, -3.7000000000000006, -4.100000000000001, -12.5, -4.100000000000001], "episode_lengths": [21, 21, 4, 21, 21, 12, 21, 9, 21, 2, 3, 21, 10, 21, 5, 7, 21, 21, 5, 4, 8, 21, 2, 7, 21, 21, 21, 6, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 1, 21, 3, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.650640718910592, "mean_inference_ms": 18.242160227303728, "mean_action_processing_ms": 0.9540642896719758, "mean_env_wait_ms": 1.7245731996260614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07137891722888481, "StateBufferConnector_ms": 0.00885044656148771, "ViewRequirementAgentConnector_ms": 0.13156030236220942}}, "episode_reward_max": -3.2000000000000006, "episode_reward_min": -12.5, "episode_reward_mean": -4.855121951219513, "episode_len_mean": 18.897560975609757, "episodes_this_iter": 205, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.0, -4.400000000000001, -10.3, -3.8000000000000003, -3.900000000000001, -11.4, -3.800000000000001, -11.3, -3.900000000000001, -10.1, -10.2, -3.8000000000000007, -11.3, -4.000000000000001, -10.4, -10.9, -3.900000000000001, -3.800000000000001, -10.5, -10.3, -10.8, -3.900000000000001, -10.1, -10.7, -3.500000000000001, -3.900000000000001, -3.700000000000001, -10.6, -10.2, -3.7000000000000006, -3.8000000000000003, -3.700000000000001, -3.6000000000000005, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -3.800000000000001, -3.8000000000000007, -3.9000000000000012, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -3.800000000000001, -4.000000000000001, -3.6000000000000005, -4.000000000000001, -3.400000000000001, -3.700000000000001, -4.100000000000001, -3.600000000000001, -10.0, -3.8000000000000007, -3.700000000000001, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -4.100000000000001, -4.100000000000001, -3.800000000000001, -3.9000000000000012, -3.800000000000001, -4.000000000000001, -3.900000000000001, -3.600000000000001, -4.000000000000001, -10.4, -3.700000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.9000000000000012, -3.8000000000000007, -11.7, -3.700000000000001, -3.7000000000000006, -3.6000000000000005, -3.700000000000001, -3.700000000000001, -3.900000000000001, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -4.000000000000002, -3.7000000000000006, -3.8000000000000003, -4.000000000000001, -3.9000000000000004, -4.100000000000001, -4.000000000000001, -3.800000000000001, -4.000000000000001, -3.700000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.6000000000000014, -4.000000000000001, -3.7000000000000006, -3.7000000000000006, -3.400000000000001, -3.800000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.900000000000001, -10.4, -4.000000000000001, -10.0, -3.700000000000001, -10.2, -3.700000000000001, -4.000000000000002, -3.900000000000001, -4.100000000000001, -3.600000000000001, -10.0, -3.600000000000001, -3.8000000000000007, -3.700000000000001, -4.000000000000002, -3.7000000000000006, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.5000000000000004, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -4.100000000000001, -3.6000000000000005, -4.000000000000001, -11.2, -4.200000000000001, -3.7000000000000006, -3.700000000000001, -4.000000000000001, -3.800000000000001, -3.8000000000000007, -4.000000000000002, -3.9000000000000004, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -3.7000000000000006, -3.8000000000000007, -3.8000000000000007, -4.200000000000001, -3.7000000000000006, -11.2, -3.9000000000000012, -3.7, -3.700000000000001, -4.200000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -10.8, -3.7000000000000006, -3.9000000000000012, -3.5000000000000004, -3.9000000000000012, -3.700000000000001, -3.9000000000000012, -3.900000000000001, -4.100000000000001, -3.700000000000001, -3.700000000000001, -3.700000000000001, -4.000000000000001, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -4.000000000000002, -4.0, -3.8000000000000007, -3.900000000000001, -3.700000000000001, -11.1, -3.7000000000000006, -4.000000000000001, -11.2, -4.000000000000002, -3.600000000000001, -3.700000000000001, -4.100000000000001, -3.2000000000000006, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -11.3, -4.0, -10.1, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000002, -3.8000000000000007, -3.7000000000000006, -4.100000000000001, -12.5, -4.100000000000001], "episode_lengths": [21, 21, 4, 21, 21, 12, 21, 9, 21, 2, 3, 21, 10, 21, 5, 7, 21, 21, 5, 4, 8, 21, 2, 7, 21, 21, 21, 6, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 1, 21, 3, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.650640718910592, "mean_inference_ms": 18.242160227303728, "mean_action_processing_ms": 0.9540642896719758, "mean_env_wait_ms": 1.7245731996260614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07137891722888481, "StateBufferConnector_ms": 0.00885044656148771, "ViewRequirementAgentConnector_ms": 0.13156030236220942}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 184000, "timers": {"training_iteration_time_ms": 170941.608, "load_time_ms": 1.141, "load_throughput": 3506136.967, "learn_time_ms": 169983.524, "learn_throughput": 23.532, "synch_weights_time_ms": 181.049}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "done": false, "episodes_total": 9737, "training_iteration": 46, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-06_23-06-39", "timestamp": 1680815199, "time_this_iter_s": 171.304603099823, "time_total_s": 7864.282162427902, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476596d0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0147540310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 7864.282162427902, "timesteps_since_restore": 0, "iterations_since_restore": 46, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.725925925925926, "ram_util_percent": 24.19999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.489289376043505, "cur_kl_coeff": 24.631531333923345, "cur_lr": 0.01, "total_loss": 0.8051858132805234, "policy_loss": 0.0018811163757877646, "vf_loss": 0.5838786377581537, "vf_explained_var": 0.5426100616173077, "kl": 0.008908340151757203, "entropy": 3.059354091203341, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 43245.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "sampler_results": {"episode_reward_max": -3.4000000000000004, "episode_reward_min": -12.700000000000001, "episode_reward_mean": -4.842788461538462, "episode_len_mean": 19.076923076923077, "episode_media": {}, "episodes_this_iter": 208, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.8000000000000007, -10.3, -10.2, -10.5, -3.8000000000000007, -10.2, -3.7000000000000006, -11.0, -11.1, -10.7, -10.2, -3.8000000000000003, -10.6, -3.900000000000001, -3.900000000000001, -10.3, -10.6, -3.6000000000000005, -10.4, -11.3, -3.900000000000001, -4.0, -3.700000000000001, -3.6000000000000005, -11.1, -3.700000000000001, -3.8000000000000007, -4.200000000000001, -3.400000000000001, -3.9000000000000004, -3.500000000000001, -3.700000000000001, -4.000000000000001, -3.8000000000000003, -3.8000000000000007, -4.000000000000002, -3.8000000000000007, -3.600000000000001, -3.900000000000001, -3.800000000000001, -4.200000000000001, -3.700000000000001, -3.7000000000000006, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.600000000000001, -3.7000000000000006, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -3.7000000000000006, -10.7, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -3.800000000000001, -4.000000000000001, -3.7000000000000006, -3.700000000000001, -3.6000000000000005, -3.9000000000000012, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -3.700000000000001, -10.2, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.600000000000001, -3.600000000000001, -3.9000000000000012, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -3.9000000000000004, -3.700000000000001, -3.900000000000001, -3.7000000000000006, -3.800000000000001, -3.7000000000000006, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.600000000000001, -3.500000000000001, -4.200000000000001, -3.900000000000001, -3.900000000000001, -3.800000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -10.8, -3.800000000000001, -4.100000000000001, -3.7000000000000006, -4.000000000000001, -3.900000000000001, -3.6000000000000005, -4.100000000000001, -3.6000000000000005, -10.8, -3.700000000000001, -3.8000000000000007, -10.1, -3.7, -3.6000000000000005, -11.5, -4.100000000000001, -3.900000000000001, -11.3, -3.800000000000001, -3.9000000000000012, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -3.7000000000000006, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.700000000000001, -4.300000000000001, -3.800000000000001, -4.100000000000001, -3.700000000000001, -3.7000000000000006, -3.800000000000001, -4.000000000000001, -3.9000000000000004, -3.900000000000001, -4.0, -10.9, -3.9000000000000004, -3.700000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000002, -3.8000000000000007, -3.900000000000001, -3.700000000000001, -3.7000000000000006, -3.800000000000001, -3.900000000000001, -3.5000000000000004, -12.700000000000001, -4.000000000000002, -3.900000000000001, -4.000000000000002, -3.8000000000000007, -4.000000000000001, -11.1, -3.700000000000001, -3.900000000000001, -11.3, -3.600000000000001, -3.700000000000001, -3.7000000000000006, -11.0, -3.700000000000001, -3.8000000000000007, -4.000000000000001, -3.800000000000001, -3.8000000000000007, -3.800000000000001, -4.100000000000001, -3.9000000000000012, -4.000000000000001, -3.7000000000000006, -11.0, -3.4000000000000004, -3.7000000000000006, -3.900000000000001, -4.0, -11.9, -3.900000000000001, -3.700000000000001, -3.7000000000000006, -3.9000000000000012, -3.7000000000000006, -3.700000000000001, -3.600000000000001, -3.8000000000000007, -10.5, -3.700000000000001, -3.8000000000000007, -3.9000000000000004, -4.000000000000002, -3.700000000000001, -10.3, -3.800000000000001, -3.7000000000000006, -4.000000000000001, -4.200000000000001, -4.100000000000001, -3.800000000000001, -3.8000000000000007, -3.900000000000001, -3.800000000000001, -3.600000000000001, -3.800000000000001, -4.100000000000001], "episode_lengths": [21, 4, 3, 6, 21, 3, 21, 9, 10, 7, 3, 21, 6, 21, 21, 3, 6, 21, 5, 12, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 2, 21, 21, 14, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 10, 21, 21, 12, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.661280984014363, "mean_inference_ms": 18.235155864776537, "mean_action_processing_ms": 0.9536135509009648, "mean_env_wait_ms": 1.716988420511787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07343601721983689, "StateBufferConnector_ms": 0.009380166347210225, "ViewRequirementAgentConnector_ms": 0.13354879159193772}}, "episode_reward_max": -3.4000000000000004, "episode_reward_min": -12.700000000000001, "episode_reward_mean": -4.842788461538462, "episode_len_mean": 19.076923076923077, "episodes_this_iter": 208, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.8000000000000007, -10.3, -10.2, -10.5, -3.8000000000000007, -10.2, -3.7000000000000006, -11.0, -11.1, -10.7, -10.2, -3.8000000000000003, -10.6, -3.900000000000001, -3.900000000000001, -10.3, -10.6, -3.6000000000000005, -10.4, -11.3, -3.900000000000001, -4.0, -3.700000000000001, -3.6000000000000005, -11.1, -3.700000000000001, -3.8000000000000007, -4.200000000000001, -3.400000000000001, -3.9000000000000004, -3.500000000000001, -3.700000000000001, -4.000000000000001, -3.8000000000000003, -3.8000000000000007, -4.000000000000002, -3.8000000000000007, -3.600000000000001, -3.900000000000001, -3.800000000000001, -4.200000000000001, -3.700000000000001, -3.7000000000000006, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.600000000000001, -3.7000000000000006, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -3.7000000000000006, -10.7, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -3.800000000000001, -4.000000000000001, -3.7000000000000006, -3.700000000000001, -3.6000000000000005, -3.9000000000000012, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -3.700000000000001, -10.2, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.600000000000001, -3.600000000000001, -3.9000000000000012, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -3.9000000000000004, -3.700000000000001, -3.900000000000001, -3.7000000000000006, -3.800000000000001, -3.7000000000000006, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.600000000000001, -3.500000000000001, -4.200000000000001, -3.900000000000001, -3.900000000000001, -3.800000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -10.8, -3.800000000000001, -4.100000000000001, -3.7000000000000006, -4.000000000000001, -3.900000000000001, -3.6000000000000005, -4.100000000000001, -3.6000000000000005, -10.8, -3.700000000000001, -3.8000000000000007, -10.1, -3.7, -3.6000000000000005, -11.5, -4.100000000000001, -3.900000000000001, -11.3, -3.800000000000001, -3.9000000000000012, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -3.7000000000000006, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.700000000000001, -4.300000000000001, -3.800000000000001, -4.100000000000001, -3.700000000000001, -3.7000000000000006, -3.800000000000001, -4.000000000000001, -3.9000000000000004, -3.900000000000001, -4.0, -10.9, -3.9000000000000004, -3.700000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000002, -3.8000000000000007, -3.900000000000001, -3.700000000000001, -3.7000000000000006, -3.800000000000001, -3.900000000000001, -3.5000000000000004, -12.700000000000001, -4.000000000000002, -3.900000000000001, -4.000000000000002, -3.8000000000000007, -4.000000000000001, -11.1, -3.700000000000001, -3.900000000000001, -11.3, -3.600000000000001, -3.700000000000001, -3.7000000000000006, -11.0, -3.700000000000001, -3.8000000000000007, -4.000000000000001, -3.800000000000001, -3.8000000000000007, -3.800000000000001, -4.100000000000001, -3.9000000000000012, -4.000000000000001, -3.7000000000000006, -11.0, -3.4000000000000004, -3.7000000000000006, -3.900000000000001, -4.0, -11.9, -3.900000000000001, -3.700000000000001, -3.7000000000000006, -3.9000000000000012, -3.7000000000000006, -3.700000000000001, -3.600000000000001, -3.8000000000000007, -10.5, -3.700000000000001, -3.8000000000000007, -3.9000000000000004, -4.000000000000002, -3.700000000000001, -10.3, -3.800000000000001, -3.7000000000000006, -4.000000000000001, -4.200000000000001, -4.100000000000001, -3.800000000000001, -3.8000000000000007, -3.900000000000001, -3.800000000000001, -3.600000000000001, -3.800000000000001, -4.100000000000001], "episode_lengths": [21, 4, 3, 6, 21, 3, 21, 9, 10, 7, 3, 21, 6, 21, 21, 3, 6, 21, 5, 12, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 2, 21, 21, 14, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 10, 21, 21, 12, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.661280984014363, "mean_inference_ms": 18.235155864776537, "mean_action_processing_ms": 0.9536135509009648, "mean_env_wait_ms": 1.716988420511787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07343601721983689, "StateBufferConnector_ms": 0.009380166347210225, "ViewRequirementAgentConnector_ms": 0.13354879159193772}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 188000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 188000, "timers": {"training_iteration_time_ms": 170975.535, "load_time_ms": 1.146, "load_throughput": 3491398.248, "learn_time_ms": 170018.375, "learn_throughput": 23.527, "synch_weights_time_ms": 180.946}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "done": false, "episodes_total": 9945, "training_iteration": 47, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-06_23-09-30", "timestamp": 1680815370, "time_this_iter_s": 170.86797642707825, "time_total_s": 8035.1501388549805, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f014750b1c0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01477160d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 8035.1501388549805, "timesteps_since_restore": 0, "iterations_since_restore": 47, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.460493827160494, "ram_util_percent": 24.198765432098757}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.052175046551612, "cur_kl_coeff": 24.631531333923345, "cur_lr": 0.01, "total_loss": 0.625337157943236, "policy_loss": 0.0006384722738256378, "vf_loss": 0.4259806915156303, "vf_explained_var": 0.640862561169491, "kl": 0.008067626604573771, "entropy": 3.0492646837747226, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 44175.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "sampler_results": {"episode_reward_max": -3.500000000000001, "episode_reward_min": -12.6, "episode_reward_mean": -4.503846153846155, "episode_len_mean": 19.89423076923077, "episode_media": {}, "episodes_this_iter": 208, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.900000000000001, -3.7000000000000006, -3.800000000000001, -3.8000000000000007, -4.100000000000001, -3.800000000000001, -3.7000000000000006, -11.2, -10.4, -3.900000000000001, -10.5, -3.7000000000000006, -10.1, -3.7000000000000006, -10.8, -3.7000000000000006, -4.100000000000001, -3.7000000000000006, -3.800000000000001, -10.4, -3.8000000000000007, -4.000000000000001, -3.7000000000000006, -10.1, -11.5, -10.4, -4.100000000000001, -3.900000000000001, -4.300000000000001, -3.600000000000001, -3.9000000000000012, -3.800000000000001, -4.200000000000001, -3.9000000000000012, -3.8000000000000007, -3.8000000000000003, -4.100000000000001, -3.9000000000000004, -11.7, -4.0, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -4.0, -3.800000000000001, -4.0, -4.100000000000001, -4.100000000000001, -4.0, -4.000000000000002, -3.9000000000000012, -4.200000000000001, -3.700000000000001, -3.900000000000001, -4.0, -3.8000000000000007, -3.7000000000000006, -3.6000000000000005, -3.7000000000000006, -3.7000000000000006, -4.200000000000001, -3.8000000000000007, -3.700000000000001, -10.5, -3.8000000000000003, -3.800000000000001, -3.7000000000000006, -4.000000000000002, -3.600000000000001, -3.9000000000000012, -3.8000000000000007, -4.000000000000001, -10.4, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -3.6000000000000005, -3.9000000000000012, -3.900000000000001, -4.200000000000001, -3.8000000000000003, -3.9000000000000012, -12.6, -4.100000000000001, -4.1000000000000005, -3.900000000000001, -4.000000000000001, -3.600000000000001, -4.000000000000001, -3.700000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.700000000000001, -12.5, -4.100000000000001, -4.100000000000001, -3.8000000000000003, -4.000000000000001, -3.500000000000001, -4.1000000000000005, -3.700000000000001, -3.7000000000000006, -12.2, -10.4, -3.8000000000000007, -11.6, -3.7000000000000006, -10.1, -3.7000000000000006, -4.100000000000001, -3.7000000000000006, -3.900000000000001, -3.9000000000000004, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -4.200000000000001, -4.200000000000001, -3.700000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000002, -4.200000000000001, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000002, -3.9000000000000012, -3.700000000000001, -3.9000000000000012, -3.900000000000001, -3.9000000000000012, -3.8000000000000007, -3.9000000000000012, -3.9000000000000004, -3.900000000000001, -4.000000000000001, -3.600000000000001, -3.8000000000000007, -3.800000000000001, -3.9000000000000012, -4.000000000000001, -4.000000000000001, -4.300000000000002, -3.800000000000001, -3.700000000000001, -4.100000000000001, -3.600000000000001, -4.200000000000001, -4.000000000000002, -3.7000000000000006, -3.9000000000000004, -4.100000000000001, -4.000000000000001, -3.600000000000001, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.7, -3.700000000000001, -4.000000000000001, -3.7000000000000006, -3.800000000000001, -4.100000000000001, -3.9000000000000004, -4.000000000000001, -4.000000000000001, -3.800000000000001, -3.8000000000000007, -3.8000000000000007, -4.200000000000001, -3.700000000000001, -3.900000000000001, -4.0, -3.900000000000001, -3.8000000000000007, -3.800000000000001, -4.0, -3.9000000000000012, -4.200000000000001, -4.200000000000001, -4.000000000000001, -3.900000000000001, -3.7000000000000006, -3.700000000000001, -4.0, -3.7000000000000006, -3.900000000000001, -3.800000000000001, -4.000000000000002, -3.7000000000000006, -3.800000000000001, -3.7000000000000006, -3.8000000000000007, -3.900000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 11, 5, 21, 5, 21, 2, 21, 7, 21, 21, 21, 21, 4, 21, 21, 21, 2, 11, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 17, 5, 21, 12, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.669372620865406, "mean_inference_ms": 18.242337202649857, "mean_action_processing_ms": 0.9535862512950335, "mean_env_wait_ms": 1.7123330415206464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07368165713090163, "StateBufferConnector_ms": 0.009301534065833459, "ViewRequirementAgentConnector_ms": 0.13440434749309832}}, "episode_reward_max": -3.500000000000001, "episode_reward_min": -12.6, "episode_reward_mean": -4.503846153846155, "episode_len_mean": 19.89423076923077, "episodes_this_iter": 208, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.900000000000001, -3.7000000000000006, -3.800000000000001, -3.8000000000000007, -4.100000000000001, -3.800000000000001, -3.7000000000000006, -11.2, -10.4, -3.900000000000001, -10.5, -3.7000000000000006, -10.1, -3.7000000000000006, -10.8, -3.7000000000000006, -4.100000000000001, -3.7000000000000006, -3.800000000000001, -10.4, -3.8000000000000007, -4.000000000000001, -3.7000000000000006, -10.1, -11.5, -10.4, -4.100000000000001, -3.900000000000001, -4.300000000000001, -3.600000000000001, -3.9000000000000012, -3.800000000000001, -4.200000000000001, -3.9000000000000012, -3.8000000000000007, -3.8000000000000003, -4.100000000000001, -3.9000000000000004, -11.7, -4.0, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -4.0, -3.800000000000001, -4.0, -4.100000000000001, -4.100000000000001, -4.0, -4.000000000000002, -3.9000000000000012, -4.200000000000001, -3.700000000000001, -3.900000000000001, -4.0, -3.8000000000000007, -3.7000000000000006, -3.6000000000000005, -3.7000000000000006, -3.7000000000000006, -4.200000000000001, -3.8000000000000007, -3.700000000000001, -10.5, -3.8000000000000003, -3.800000000000001, -3.7000000000000006, -4.000000000000002, -3.600000000000001, -3.9000000000000012, -3.8000000000000007, -4.000000000000001, -10.4, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -3.6000000000000005, -3.9000000000000012, -3.900000000000001, -4.200000000000001, -3.8000000000000003, -3.9000000000000012, -12.6, -4.100000000000001, -4.1000000000000005, -3.900000000000001, -4.000000000000001, -3.600000000000001, -4.000000000000001, -3.700000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.700000000000001, -12.5, -4.100000000000001, -4.100000000000001, -3.8000000000000003, -4.000000000000001, -3.500000000000001, -4.1000000000000005, -3.700000000000001, -3.7000000000000006, -12.2, -10.4, -3.8000000000000007, -11.6, -3.7000000000000006, -10.1, -3.7000000000000006, -4.100000000000001, -3.7000000000000006, -3.900000000000001, -3.9000000000000004, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -4.200000000000001, -4.200000000000001, -3.700000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000002, -4.200000000000001, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000002, -3.9000000000000012, -3.700000000000001, -3.9000000000000012, -3.900000000000001, -3.9000000000000012, -3.8000000000000007, -3.9000000000000012, -3.9000000000000004, -3.900000000000001, -4.000000000000001, -3.600000000000001, -3.8000000000000007, -3.800000000000001, -3.9000000000000012, -4.000000000000001, -4.000000000000001, -4.300000000000002, -3.800000000000001, -3.700000000000001, -4.100000000000001, -3.600000000000001, -4.200000000000001, -4.000000000000002, -3.7000000000000006, -3.9000000000000004, -4.100000000000001, -4.000000000000001, -3.600000000000001, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.7, -3.700000000000001, -4.000000000000001, -3.7000000000000006, -3.800000000000001, -4.100000000000001, -3.9000000000000004, -4.000000000000001, -4.000000000000001, -3.800000000000001, -3.8000000000000007, -3.8000000000000007, -4.200000000000001, -3.700000000000001, -3.900000000000001, -4.0, -3.900000000000001, -3.8000000000000007, -3.800000000000001, -4.0, -3.9000000000000012, -4.200000000000001, -4.200000000000001, -4.000000000000001, -3.900000000000001, -3.7000000000000006, -3.700000000000001, -4.0, -3.7000000000000006, -3.900000000000001, -3.800000000000001, -4.000000000000002, -3.7000000000000006, -3.800000000000001, -3.7000000000000006, -3.8000000000000007, -3.900000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 11, 5, 21, 5, 21, 2, 21, 7, 21, 21, 21, 21, 4, 21, 21, 21, 2, 11, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 17, 5, 21, 12, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.669372620865406, "mean_inference_ms": 18.242337202649857, "mean_action_processing_ms": 0.9535862512950335, "mean_env_wait_ms": 1.7123330415206464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07368165713090163, "StateBufferConnector_ms": 0.009301534065833459, "ViewRequirementAgentConnector_ms": 0.13440434749309832}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 170979.982, "load_time_ms": 1.151, "load_throughput": 3476062.571, "learn_time_ms": 170023.651, "learn_throughput": 23.526, "synch_weights_time_ms": 181.962}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "episodes_total": 10153, "training_iteration": 48, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-06_23-12-21", "timestamp": 1680815541, "time_this_iter_s": 170.76694416999817, "time_total_s": 8205.917083024979, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01475a5b20>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01475264c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 8205.917083024979, "timesteps_since_restore": 0, "iterations_since_restore": 48, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.48724279835391, "ram_util_percent": 24.15473251028806}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.864706234778128, "cur_kl_coeff": 24.631531333923345, "cur_lr": 0.01, "total_loss": 0.841038471324149, "policy_loss": -6.78057321697794e-05, "vf_loss": 0.3948299912795905, "vf_explained_var": 0.6249747569843005, "kl": 0.018118089800860146, "entropy": 3.0383756212008897, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 45105.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "sampler_results": {"episode_reward_max": -3.4000000000000004, "episode_reward_min": -12.1, "episode_reward_mean": -4.417788461538462, "episode_len_mean": 19.985576923076923, "episode_media": {}, "episodes_this_iter": 208, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.200000000000001, -3.7000000000000006, -3.8000000000000007, -4.0, -3.9000000000000012, -4.100000000000001, -3.6000000000000005, -10.2, -11.1, -3.900000000000001, -3.800000000000001, -3.9000000000000012, -11.6, -4.000000000000001, -11.1, -3.8000000000000003, -10.2, -10.4, -10.1, -3.8000000000000007, -3.6000000000000005, -3.700000000000001, -10.2, -4.000000000000001, -10.1, -4.000000000000001, -4.100000000000001, -3.700000000000001, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -3.7000000000000006, -3.800000000000001, -4.200000000000001, -4.000000000000002, -4.0, -3.800000000000001, -3.7000000000000006, -3.900000000000001, -3.9000000000000004, -3.7000000000000006, -3.5000000000000004, -3.7000000000000006, -3.5000000000000004, -12.0, -3.900000000000001, -3.8000000000000007, -3.800000000000001, -4.200000000000001, -3.7000000000000006, -3.700000000000001, -4.000000000000001, -4.000000000000002, -11.8, -3.8000000000000007, -3.600000000000001, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -4.0, -4.100000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.800000000000001, -3.500000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -11.2, -3.7000000000000006, -3.8000000000000007, -3.900000000000001, -4.200000000000001, -4.000000000000002, -3.8000000000000007, -4.100000000000001, -3.9000000000000012, -4.200000000000001, -3.600000000000001, -4.000000000000002, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.800000000000001, -3.7000000000000006, -3.9000000000000017, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.200000000000001, -3.900000000000001, -4.200000000000001, -3.4000000000000004, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -10.8, -3.900000000000001, -4.100000000000001, -3.7000000000000006, -3.600000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.9000000000000004, -3.7000000000000006, -3.700000000000001, -12.1, -3.600000000000001, -3.500000000000001, -3.8000000000000007, -3.8000000000000007, -3.700000000000001, -4.000000000000002, -4.100000000000001, -10.7, -4.200000000000001, -3.900000000000001, -4.100000000000001, -3.7000000000000006, -4.200000000000001, -3.8000000000000007, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -3.9000000000000012, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -3.7000000000000006, -4.000000000000001, -3.9000000000000012, -3.8000000000000007, -3.8000000000000003, -4.000000000000002, -3.900000000000001, -3.8000000000000007, -3.9000000000000004, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -10.5, -4.000000000000001, -3.800000000000001, -4.1000000000000005, -3.9000000000000004, -3.600000000000001, -3.7000000000000006, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -3.600000000000001, -3.9000000000000012, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -3.800000000000001, -3.8000000000000007, -3.900000000000001, -3.700000000000001, -3.5000000000000004, -3.8000000000000007, -4.000000000000001, -3.9000000000000012, -3.7000000000000006, -3.900000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000001, -3.8000000000000007, -3.9000000000000012, -3.600000000000001, -3.600000000000001, -4.000000000000001, -3.8000000000000007, -3.7000000000000006, -3.900000000000001, -3.7000000000000006, -3.700000000000001, -4.000000000000001, -4.000000000000002, -3.9000000000000012, -3.7000000000000006, -4.0, -3.800000000000001, -4.000000000000001, -4.300000000000001, -3.9000000000000012, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.200000000000001, -3.900000000000001, -4.1000000000000005, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -3.900000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 3, 9, 21, 21, 21, 13, 21, 9, 21, 3, 5, 2, 21, 21, 21, 3, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.6526101377537, "mean_inference_ms": 18.220351012110346, "mean_action_processing_ms": 0.9516684773257504, "mean_env_wait_ms": 1.709863497941137, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07052822754933284, "StateBufferConnector_ms": 0.008919032720419077, "ViewRequirementAgentConnector_ms": 0.1304143896469703}}, "episode_reward_max": -3.4000000000000004, "episode_reward_min": -12.1, "episode_reward_mean": -4.417788461538462, "episode_len_mean": 19.985576923076923, "episodes_this_iter": 208, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.200000000000001, -3.7000000000000006, -3.8000000000000007, -4.0, -3.9000000000000012, -4.100000000000001, -3.6000000000000005, -10.2, -11.1, -3.900000000000001, -3.800000000000001, -3.9000000000000012, -11.6, -4.000000000000001, -11.1, -3.8000000000000003, -10.2, -10.4, -10.1, -3.8000000000000007, -3.6000000000000005, -3.700000000000001, -10.2, -4.000000000000001, -10.1, -4.000000000000001, -4.100000000000001, -3.700000000000001, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -3.7000000000000006, -3.800000000000001, -4.200000000000001, -4.000000000000002, -4.0, -3.800000000000001, -3.7000000000000006, -3.900000000000001, -3.9000000000000004, -3.7000000000000006, -3.5000000000000004, -3.7000000000000006, -3.5000000000000004, -12.0, -3.900000000000001, -3.8000000000000007, -3.800000000000001, -4.200000000000001, -3.7000000000000006, -3.700000000000001, -4.000000000000001, -4.000000000000002, -11.8, -3.8000000000000007, -3.600000000000001, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -4.0, -4.100000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.800000000000001, -3.500000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -11.2, -3.7000000000000006, -3.8000000000000007, -3.900000000000001, -4.200000000000001, -4.000000000000002, -3.8000000000000007, -4.100000000000001, -3.9000000000000012, -4.200000000000001, -3.600000000000001, -4.000000000000002, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.800000000000001, -3.7000000000000006, -3.9000000000000017, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.200000000000001, -3.900000000000001, -4.200000000000001, -3.4000000000000004, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -10.8, -3.900000000000001, -4.100000000000001, -3.7000000000000006, -3.600000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.9000000000000004, -3.7000000000000006, -3.700000000000001, -12.1, -3.600000000000001, -3.500000000000001, -3.8000000000000007, -3.8000000000000007, -3.700000000000001, -4.000000000000002, -4.100000000000001, -10.7, -4.200000000000001, -3.900000000000001, -4.100000000000001, -3.7000000000000006, -4.200000000000001, -3.8000000000000007, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -3.9000000000000012, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -3.7000000000000006, -4.000000000000001, -3.9000000000000012, -3.8000000000000007, -3.8000000000000003, -4.000000000000002, -3.900000000000001, -3.8000000000000007, -3.9000000000000004, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -10.5, -4.000000000000001, -3.800000000000001, -4.1000000000000005, -3.9000000000000004, -3.600000000000001, -3.7000000000000006, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -3.600000000000001, -3.9000000000000012, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -3.800000000000001, -3.8000000000000007, -3.900000000000001, -3.700000000000001, -3.5000000000000004, -3.8000000000000007, -4.000000000000001, -3.9000000000000012, -3.7000000000000006, -3.900000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000001, -3.8000000000000007, -3.9000000000000012, -3.600000000000001, -3.600000000000001, -4.000000000000001, -3.8000000000000007, -3.7000000000000006, -3.900000000000001, -3.7000000000000006, -3.700000000000001, -4.000000000000001, -4.000000000000002, -3.9000000000000012, -3.7000000000000006, -4.0, -3.800000000000001, -4.000000000000001, -4.300000000000001, -3.9000000000000012, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.200000000000001, -3.900000000000001, -4.1000000000000005, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -3.900000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 3, 9, 21, 21, 21, 13, 21, 9, 21, 3, 5, 2, 21, 21, 21, 3, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.6526101377537, "mean_inference_ms": 18.220351012110346, "mean_action_processing_ms": 0.9516684773257504, "mean_env_wait_ms": 1.709863497941137, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07052822754933284, "StateBufferConnector_ms": 0.008919032720419077, "ViewRequirementAgentConnector_ms": 0.1304143896469703}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 196000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 196000, "timers": {"training_iteration_time_ms": 170970.796, "load_time_ms": 1.153, "load_throughput": 3469664.557, "learn_time_ms": 170016.068, "learn_throughput": 23.527, "synch_weights_time_ms": 177.491}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "done": false, "episodes_total": 10361, "training_iteration": 49, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-06_23-15-12", "timestamp": 1680815712, "time_this_iter_s": 171.3363642692566, "time_total_s": 8377.253447294235, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01474d0550>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01477160d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 8377.253447294235, "timesteps_since_restore": 0, "iterations_since_restore": 49, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.410655737704917, "ram_util_percent": 24.1717213114754}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.772498221807583, "cur_kl_coeff": 24.631531333923345, "cur_lr": 0.01, "total_loss": 0.8754294075632608, "policy_loss": -0.00039861812306347716, "vf_loss": 0.6520095970521691, "vf_explained_var": 0.5809088754397567, "kl": 0.009086663259590115, "entropy": 3.0153123314662644, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 46035.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "sampler_results": {"episode_reward_max": -3.3000000000000007, "episode_reward_min": -12.8, "episode_reward_mean": -4.85343137254902, "episode_len_mean": 19.274509803921568, "episode_media": {}, "episodes_this_iter": 204, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.3, -11.3, -3.800000000000001, -10.7, -12.5, -10.3, -4.1000000000000005, -3.700000000000001, -10.6, -10.2, -10.7, -4.100000000000001, -10.5, -3.9000000000000012, -3.700000000000001, -11.4, -11.4, -10.7, -3.700000000000001, -3.800000000000001, -3.9000000000000012, -3.9000000000000012, -11.2, -3.600000000000001, -3.500000000000001, -10.9, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -3.7000000000000006, -4.100000000000001, -4.000000000000002, -4.000000000000001, -3.9000000000000004, -3.9000000000000012, -3.8000000000000007, -3.800000000000001, -4.200000000000001, -3.8000000000000007, -10.2, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -3.600000000000001, -4.200000000000001, -3.7000000000000006, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -3.7000000000000006, -4.0, -3.7000000000000006, -4.100000000000001, -3.8000000000000007, -4.000000000000002, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -3.7, -3.6000000000000005, -3.900000000000001, -3.700000000000001, -4.000000000000001, -3.9000000000000012, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -4.000000000000002, -3.900000000000001, -4.0, -3.900000000000001, -4.0, -3.8000000000000007, -10.2, -3.8000000000000007, -4.0, -3.800000000000001, -11.4, -3.600000000000001, -3.8000000000000007, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -4.000000000000001, -11.9, -3.900000000000001, -3.700000000000001, -4.100000000000001, -3.9000000000000004, -3.900000000000001, -4.100000000000001, -3.9000000000000012, -3.9000000000000012, -11.3, -3.9000000000000012, -3.8000000000000007, -12.8, -3.6000000000000005, -3.5000000000000004, -4.000000000000002, -10.3, -10.4, -11.5, -4.000000000000001, -4.000000000000001, -3.6000000000000005, -3.900000000000001, -3.600000000000001, -3.7000000000000006, -3.8000000000000003, -3.900000000000001, -4.000000000000002, -10.5, -3.3000000000000007, -10.2, -4.000000000000002, -3.800000000000001, -4.000000000000001, -3.800000000000001, -3.9000000000000012, -3.6000000000000005, -3.7000000000000006, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -11.6, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -10.9, -3.900000000000001, -4.000000000000001, -3.800000000000001, -3.900000000000001, -3.5000000000000004, -3.900000000000001, -3.7000000000000006, -3.800000000000001, -4.000000000000001, -3.9000000000000012, -3.6000000000000005, -3.8000000000000007, -3.6000000000000005, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -3.7000000000000006, -4.000000000000001, -3.9000000000000012, -3.600000000000001, -4.000000000000001, -4.000000000000002, -3.800000000000001, -4.100000000000001, -3.800000000000001, -3.700000000000001, -3.600000000000001, -3.600000000000001, -3.600000000000001, -4.100000000000001, -3.900000000000001, -3.8000000000000003, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.1000000000000005, -4.000000000000002, -4.000000000000001, -3.900000000000001, -4.000000000000002, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.9000000000000012, -3.900000000000001, -3.9000000000000012, -4.000000000000001, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.700000000000001, -4.000000000000001, -10.6, -3.900000000000001, -3.6000000000000005, -4.200000000000001, -4.0, -3.700000000000001, -3.6000000000000005, -3.8000000000000007], "episode_lengths": [11, 10, 21, 7, 18, 4, 21, 21, 6, 3, 7, 21, 5, 21, 21, 11, 11, 6, 21, 21, 21, 21, 11, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 20, 21, 21, 21, 4, 5, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.644162884669422, "mean_inference_ms": 18.201827841807653, "mean_action_processing_ms": 0.9497390695025558, "mean_env_wait_ms": 1.709873015559602, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07343888282775879, "StateBufferConnector_ms": 0.009831493976069432, "ViewRequirementAgentConnector_ms": 0.13614554031222476}}, "episode_reward_max": -3.3000000000000007, "episode_reward_min": -12.8, "episode_reward_mean": -4.85343137254902, "episode_len_mean": 19.274509803921568, "episodes_this_iter": 204, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11.3, -11.3, -3.800000000000001, -10.7, -12.5, -10.3, -4.1000000000000005, -3.700000000000001, -10.6, -10.2, -10.7, -4.100000000000001, -10.5, -3.9000000000000012, -3.700000000000001, -11.4, -11.4, -10.7, -3.700000000000001, -3.800000000000001, -3.9000000000000012, -3.9000000000000012, -11.2, -3.600000000000001, -3.500000000000001, -10.9, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -3.7000000000000006, -4.100000000000001, -4.000000000000002, -4.000000000000001, -3.9000000000000004, -3.9000000000000012, -3.8000000000000007, -3.800000000000001, -4.200000000000001, -3.8000000000000007, -10.2, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -3.600000000000001, -4.200000000000001, -3.7000000000000006, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -3.7000000000000006, -4.0, -3.7000000000000006, -4.100000000000001, -3.8000000000000007, -4.000000000000002, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -3.7, -3.6000000000000005, -3.900000000000001, -3.700000000000001, -4.000000000000001, -3.9000000000000012, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -4.000000000000002, -3.900000000000001, -4.0, -3.900000000000001, -4.0, -3.8000000000000007, -10.2, -3.8000000000000007, -4.0, -3.800000000000001, -11.4, -3.600000000000001, -3.8000000000000007, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -4.000000000000001, -11.9, -3.900000000000001, -3.700000000000001, -4.100000000000001, -3.9000000000000004, -3.900000000000001, -4.100000000000001, -3.9000000000000012, -3.9000000000000012, -11.3, -3.9000000000000012, -3.8000000000000007, -12.8, -3.6000000000000005, -3.5000000000000004, -4.000000000000002, -10.3, -10.4, -11.5, -4.000000000000001, -4.000000000000001, -3.6000000000000005, -3.900000000000001, -3.600000000000001, -3.7000000000000006, -3.8000000000000003, -3.900000000000001, -4.000000000000002, -10.5, -3.3000000000000007, -10.2, -4.000000000000002, -3.800000000000001, -4.000000000000001, -3.800000000000001, -3.9000000000000012, -3.6000000000000005, -3.7000000000000006, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -11.6, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -10.9, -3.900000000000001, -4.000000000000001, -3.800000000000001, -3.900000000000001, -3.5000000000000004, -3.900000000000001, -3.7000000000000006, -3.800000000000001, -4.000000000000001, -3.9000000000000012, -3.6000000000000005, -3.8000000000000007, -3.6000000000000005, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -3.7000000000000006, -4.000000000000001, -3.9000000000000012, -3.600000000000001, -4.000000000000001, -4.000000000000002, -3.800000000000001, -4.100000000000001, -3.800000000000001, -3.700000000000001, -3.600000000000001, -3.600000000000001, -3.600000000000001, -4.100000000000001, -3.900000000000001, -3.8000000000000003, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.1000000000000005, -4.000000000000002, -4.000000000000001, -3.900000000000001, -4.000000000000002, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.9000000000000012, -3.900000000000001, -3.9000000000000012, -4.000000000000001, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.700000000000001, -4.000000000000001, -10.6, -3.900000000000001, -3.6000000000000005, -4.200000000000001, -4.0, -3.700000000000001, -3.6000000000000005, -3.8000000000000007], "episode_lengths": [11, 10, 21, 7, 18, 4, 21, 21, 6, 3, 7, 21, 5, 21, 21, 11, 11, 6, 21, 21, 21, 21, 11, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 20, 21, 21, 21, 4, 5, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.644162884669422, "mean_inference_ms": 18.201827841807653, "mean_action_processing_ms": 0.9497390695025558, "mean_env_wait_ms": 1.709873015559602, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07343888282775879, "StateBufferConnector_ms": 0.009831493976069432, "ViewRequirementAgentConnector_ms": 0.13614554031222476}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 170963.979, "load_time_ms": 1.153, "load_throughput": 3468086.655, "learn_time_ms": 170014.183, "learn_throughput": 23.527, "synch_weights_time_ms": 177.168}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": false, "episodes_total": 10565, "training_iteration": 50, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-06_23-18-03", "timestamp": 1680815883, "time_this_iter_s": 170.87091732025146, "time_total_s": 8548.124364614487, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01477a3f70>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0147526670>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 8548.124364614487, "timesteps_since_restore": 0, "iterations_since_restore": 50, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.574074074074074, "ram_util_percent": 24.19999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.514727272782274, "cur_kl_coeff": 24.631531333923345, "cur_lr": 0.01, "total_loss": 0.60932440673632, "policy_loss": -0.0015297474569931466, "vf_loss": 0.41129335924101773, "vf_explained_var": 0.6659353290834734, "kl": 0.008101842994300988, "entropy": 2.9907923549734137, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 46965.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "sampler_results": {"episode_reward_max": -3.5000000000000004, "episode_reward_min": -12.0, "episode_reward_mean": -4.613366336633664, "episode_len_mean": 19.366336633663366, "episode_media": {}, "episodes_this_iter": 202, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.7000000000000006, -4.000000000000001, -10.3, -11.5, -4.000000000000001, -3.9000000000000012, -11.0, -4.000000000000001, -11.2, -10.2, -10.3, -10.8, -10.6, -10.2, -4.000000000000001, -3.5000000000000004, -10.4, -3.7000000000000006, -10.1, -3.800000000000001, -10.2, -3.8000000000000007, -3.8000000000000007, -10.1, -10.4, -4.100000000000001, -4.000000000000001, -10.4, -3.8000000000000007, -4.000000000000001, -3.7000000000000006, -3.6000000000000005, -4.000000000000001, -3.800000000000001, -3.600000000000001, -3.8000000000000007, -3.600000000000001, -4.200000000000001, -4.0, -3.9000000000000012, -3.9000000000000004, -3.8000000000000007, -3.800000000000001, -3.8000000000000007, -4.000000000000002, -4.100000000000001, -4.1000000000000005, -4.000000000000002, -3.8000000000000007, -4.300000000000001, -4.000000000000002, -3.700000000000001, -3.700000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -10.1, -3.9000000000000004, -4.100000000000001, -3.8000000000000007, -3.8000000000000003, -3.8000000000000007, -4.000000000000002, -3.800000000000001, -4.0, -4.000000000000001, -3.9000000000000012, -4.000000000000002, -3.900000000000001, -3.900000000000001, -4.1000000000000005, -3.9000000000000012, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -3.500000000000001, -3.800000000000001, -3.7000000000000006, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -4.0, -4.1000000000000005, -4.1000000000000005, -3.8000000000000007, -4.200000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -4.000000000000002, -4.000000000000001, -3.900000000000001, -3.8000000000000003, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -10.0, -12.0, -3.900000000000001, -4.200000000000001, -3.900000000000001, -10.2, -3.7000000000000006, -3.7000000000000006, -10.8, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.800000000000001, -3.700000000000001, -3.500000000000001, -3.8000000000000007, -3.8000000000000007, -3.6000000000000005, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -3.8000000000000003, -3.7000000000000006, -3.800000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -3.500000000000001, -4.0, -3.900000000000001, -4.000000000000002, -3.9000000000000012, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.5000000000000004, -3.9000000000000004, -4.100000000000001, -3.9000000000000012, -4.1000000000000005, -3.8000000000000007, -3.800000000000001, -4.300000000000001, -4.100000000000001, -3.700000000000001, -3.8000000000000007, -3.9000000000000012, -10.2, -3.7000000000000006, -4.000000000000002, -3.700000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.700000000000001, -3.9000000000000004, -3.700000000000001, -4.000000000000001, -3.900000000000001, -3.700000000000001, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -4.200000000000001, -3.700000000000001, -3.9000000000000012, -4.000000000000002, -3.8000000000000007, -3.5000000000000004, -12.0, -3.8000000000000007, -4.200000000000001, -3.700000000000001, -3.8000000000000007, -3.8000000000000007, -4.100000000000001, -3.700000000000001, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -3.8000000000000007, -3.6000000000000005, -4.000000000000001, -3.9000000000000004, -3.7000000000000006, -3.8000000000000007, -3.900000000000001, -3.9000000000000012, -4.300000000000001, -4.100000000000001, -3.6, -4.0, -4.000000000000002, -4.000000000000002, -3.700000000000001, -3.900000000000001], "episode_lengths": [21, 21, 4, 12, 21, 21, 10, 21, 12, 3, 4, 8, 6, 3, 21, 21, 5, 21, 2, 21, 3, 21, 21, 2, 4, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 16, 21, 21, 21, 3, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.658460205210114, "mean_inference_ms": 18.20007919348479, "mean_action_processing_ms": 0.9499920069864434, "mean_env_wait_ms": 1.7065053024478434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07491064543771271, "StateBufferConnector_ms": 0.010046038297143314, "ViewRequirementAgentConnector_ms": 0.13830095234483775}}, "episode_reward_max": -3.5000000000000004, "episode_reward_min": -12.0, "episode_reward_mean": -4.613366336633664, "episode_len_mean": 19.366336633663366, "episodes_this_iter": 202, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.7000000000000006, -4.000000000000001, -10.3, -11.5, -4.000000000000001, -3.9000000000000012, -11.0, -4.000000000000001, -11.2, -10.2, -10.3, -10.8, -10.6, -10.2, -4.000000000000001, -3.5000000000000004, -10.4, -3.7000000000000006, -10.1, -3.800000000000001, -10.2, -3.8000000000000007, -3.8000000000000007, -10.1, -10.4, -4.100000000000001, -4.000000000000001, -10.4, -3.8000000000000007, -4.000000000000001, -3.7000000000000006, -3.6000000000000005, -4.000000000000001, -3.800000000000001, -3.600000000000001, -3.8000000000000007, -3.600000000000001, -4.200000000000001, -4.0, -3.9000000000000012, -3.9000000000000004, -3.8000000000000007, -3.800000000000001, -3.8000000000000007, -4.000000000000002, -4.100000000000001, -4.1000000000000005, -4.000000000000002, -3.8000000000000007, -4.300000000000001, -4.000000000000002, -3.700000000000001, -3.700000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -10.1, -3.9000000000000004, -4.100000000000001, -3.8000000000000007, -3.8000000000000003, -3.8000000000000007, -4.000000000000002, -3.800000000000001, -4.0, -4.000000000000001, -3.9000000000000012, -4.000000000000002, -3.900000000000001, -3.900000000000001, -4.1000000000000005, -3.9000000000000012, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -3.500000000000001, -3.800000000000001, -3.7000000000000006, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -4.0, -4.1000000000000005, -4.1000000000000005, -3.8000000000000007, -4.200000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -4.000000000000002, -4.000000000000001, -3.900000000000001, -3.8000000000000003, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -10.0, -12.0, -3.900000000000001, -4.200000000000001, -3.900000000000001, -10.2, -3.7000000000000006, -3.7000000000000006, -10.8, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.800000000000001, -3.700000000000001, -3.500000000000001, -3.8000000000000007, -3.8000000000000007, -3.6000000000000005, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -3.8000000000000003, -3.7000000000000006, -3.800000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -3.500000000000001, -4.0, -3.900000000000001, -4.000000000000002, -3.9000000000000012, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.5000000000000004, -3.9000000000000004, -4.100000000000001, -3.9000000000000012, -4.1000000000000005, -3.8000000000000007, -3.800000000000001, -4.300000000000001, -4.100000000000001, -3.700000000000001, -3.8000000000000007, -3.9000000000000012, -10.2, -3.7000000000000006, -4.000000000000002, -3.700000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.700000000000001, -3.9000000000000004, -3.700000000000001, -4.000000000000001, -3.900000000000001, -3.700000000000001, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -4.200000000000001, -3.700000000000001, -3.9000000000000012, -4.000000000000002, -3.8000000000000007, -3.5000000000000004, -12.0, -3.8000000000000007, -4.200000000000001, -3.700000000000001, -3.8000000000000007, -3.8000000000000007, -4.100000000000001, -3.700000000000001, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -3.8000000000000007, -3.6000000000000005, -4.000000000000001, -3.9000000000000004, -3.7000000000000006, -3.8000000000000007, -3.900000000000001, -3.9000000000000012, -4.300000000000001, -4.100000000000001, -3.6, -4.0, -4.000000000000002, -4.000000000000002, -3.700000000000001, -3.900000000000001], "episode_lengths": [21, 21, 4, 12, 21, 21, 10, 21, 12, 3, 4, 8, 6, 3, 21, 21, 5, 21, 2, 21, 3, 21, 21, 2, 4, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 16, 21, 21, 21, 3, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.658460205210114, "mean_inference_ms": 18.20007919348479, "mean_action_processing_ms": 0.9499920069864434, "mean_env_wait_ms": 1.7065053024478434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07491064543771271, "StateBufferConnector_ms": 0.010046038297143314, "ViewRequirementAgentConnector_ms": 0.13830095234483775}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 204000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 204000, "timers": {"training_iteration_time_ms": 170960.73, "load_time_ms": 1.155, "load_throughput": 3463433.042, "learn_time_ms": 170010.924, "learn_throughput": 23.528, "synch_weights_time_ms": 176.576}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "done": false, "episodes_total": 10767, "training_iteration": 51, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-06_23-20-54", "timestamp": 1680816054, "time_this_iter_s": 170.50892233848572, "time_total_s": 8718.633286952972, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01477ae460>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01477160d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 8718.633286952972, "timesteps_since_restore": 0, "iterations_since_restore": 51, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.419421487603306, "ram_util_percent": 24.14338842975207}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.76959976303962, "cur_kl_coeff": 24.631531333923345, "cur_lr": 0.01, "total_loss": 0.7023397779592904, "policy_loss": -0.000529437077542146, "vf_loss": 0.49783831617684776, "vf_explained_var": 0.6383288285424632, "kl": 0.00832392033202053, "entropy": 2.9683263014721613, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 47895.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "sampler_results": {"episode_reward_max": -3.5000000000000004, "episode_reward_min": -12.700000000000001, "episode_reward_mean": -4.632701421800949, "episode_len_mean": 19.407582938388625, "episode_media": {}, "episodes_this_iter": 211, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.8000000000000007, -10.6, -3.900000000000001, -11.9, -3.9000000000000004, -10.4, -10.2, -10.7, -10.6, -4.000000000000001, -3.8000000000000007, -10.1, -10.2, -10.5, -4.100000000000001, -4.000000000000002, -10.3, -3.7000000000000006, -11.0, -3.8000000000000007, -10.4, -4.300000000000001, -10.1, -3.7000000000000006, -3.900000000000001, -4.200000000000001, -3.8000000000000007, -3.900000000000001, -3.800000000000001, -3.700000000000001, -10.1, -4.100000000000001, -3.6, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -3.800000000000001, -3.9000000000000004, -3.7000000000000006, -3.9000000000000012, -4.000000000000001, -3.7, -4.100000000000001, -3.8000000000000003, -4.0, -10.2, -3.800000000000001, -3.900000000000001, -3.9000000000000012, -3.700000000000001, -4.200000000000001, -3.9000000000000012, -3.8000000000000007, -4.300000000000002, -3.800000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -3.9000000000000004, -4.100000000000001, -3.9000000000000004, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -4.300000000000001, -3.700000000000001, -3.8000000000000003, -4.000000000000001, -3.800000000000001, -3.8000000000000007, -3.9000000000000004, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.6000000000000005, -3.7000000000000006, -3.800000000000001, -3.600000000000001, -4.000000000000002, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -3.8000000000000007, -4.1000000000000005, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.700000000000001, -4.100000000000001, -4.200000000000001, -3.5000000000000004, -4.100000000000001, -3.8000000000000007, -4.000000000000002, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.600000000000001, -3.7000000000000006, -4.1000000000000005, -3.9000000000000012, -10.7, -3.8000000000000007, -4.000000000000002, -11.2, -10.2, -10.5, -3.8000000000000007, -10.4, -4.300000000000001, -3.7000000000000006, -4.1000000000000005, -11.9, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -4.200000000000001, -3.7000000000000006, -3.6000000000000005, -3.900000000000001, -3.700000000000001, -3.8000000000000007, -3.900000000000001, -3.6000000000000005, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -12.700000000000001, -4.000000000000001, -3.800000000000001, -4.000000000000002, -3.900000000000001, -3.900000000000001, -4.300000000000001, -4.100000000000001, -3.700000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.700000000000001, -3.7000000000000006, -3.8000000000000007, -3.700000000000001, -4.000000000000001, -4.300000000000001, -3.8000000000000007, -3.8000000000000003, -3.700000000000001, -3.7000000000000006, -3.600000000000001, -3.900000000000001, -3.8000000000000016, -3.900000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000002, -3.6, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.800000000000001, -3.900000000000001, -3.7000000000000006, -4.1000000000000005, -4.100000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000002, -3.6000000000000005, -3.8000000000000007, -3.9000000000000012, -3.800000000000001, -3.9000000000000004, -4.200000000000001, -4.200000000000001, -3.9000000000000004, -4.000000000000001, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -3.800000000000001, -4.000000000000001, -3.8000000000000007, -4.0, -4.000000000000001, -3.800000000000001, -3.800000000000001, -3.9000000000000012, -3.600000000000001, -4.100000000000001, -3.8000000000000007, -3.700000000000001, -3.9000000000000012, -11.0], "episode_lengths": [21, 5, 21, 14, 21, 4, 3, 7, 6, 21, 21, 2, 3, 6, 21, 21, 3, 21, 10, 21, 4, 21, 2, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 11, 3, 5, 21, 5, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.654068310556198, "mean_inference_ms": 18.21696340103455, "mean_action_processing_ms": 0.9506876556329658, "mean_env_wait_ms": 1.7047982164409654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08494605385296718, "StateBufferConnector_ms": 0.011909177518003924, "ViewRequirementAgentConnector_ms": 0.158589146148537}}, "episode_reward_max": -3.5000000000000004, "episode_reward_min": -12.700000000000001, "episode_reward_mean": -4.632701421800949, "episode_len_mean": 19.407582938388625, "episodes_this_iter": 211, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.8000000000000007, -10.6, -3.900000000000001, -11.9, -3.9000000000000004, -10.4, -10.2, -10.7, -10.6, -4.000000000000001, -3.8000000000000007, -10.1, -10.2, -10.5, -4.100000000000001, -4.000000000000002, -10.3, -3.7000000000000006, -11.0, -3.8000000000000007, -10.4, -4.300000000000001, -10.1, -3.7000000000000006, -3.900000000000001, -4.200000000000001, -3.8000000000000007, -3.900000000000001, -3.800000000000001, -3.700000000000001, -10.1, -4.100000000000001, -3.6, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -3.800000000000001, -3.9000000000000004, -3.7000000000000006, -3.9000000000000012, -4.000000000000001, -3.7, -4.100000000000001, -3.8000000000000003, -4.0, -10.2, -3.800000000000001, -3.900000000000001, -3.9000000000000012, -3.700000000000001, -4.200000000000001, -3.9000000000000012, -3.8000000000000007, -4.300000000000002, -3.800000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -3.9000000000000004, -4.100000000000001, -3.9000000000000004, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -4.300000000000001, -3.700000000000001, -3.8000000000000003, -4.000000000000001, -3.800000000000001, -3.8000000000000007, -3.9000000000000004, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.6000000000000005, -3.7000000000000006, -3.800000000000001, -3.600000000000001, -4.000000000000002, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -3.8000000000000007, -4.1000000000000005, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.700000000000001, -4.100000000000001, -4.200000000000001, -3.5000000000000004, -4.100000000000001, -3.8000000000000007, -4.000000000000002, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.600000000000001, -3.7000000000000006, -4.1000000000000005, -3.9000000000000012, -10.7, -3.8000000000000007, -4.000000000000002, -11.2, -10.2, -10.5, -3.8000000000000007, -10.4, -4.300000000000001, -3.7000000000000006, -4.1000000000000005, -11.9, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -4.200000000000001, -3.7000000000000006, -3.6000000000000005, -3.900000000000001, -3.700000000000001, -3.8000000000000007, -3.900000000000001, -3.6000000000000005, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -12.700000000000001, -4.000000000000001, -3.800000000000001, -4.000000000000002, -3.900000000000001, -3.900000000000001, -4.300000000000001, -4.100000000000001, -3.700000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.700000000000001, -3.7000000000000006, -3.8000000000000007, -3.700000000000001, -4.000000000000001, -4.300000000000001, -3.8000000000000007, -3.8000000000000003, -3.700000000000001, -3.7000000000000006, -3.600000000000001, -3.900000000000001, -3.8000000000000016, -3.900000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000002, -3.6, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.800000000000001, -3.900000000000001, -3.7000000000000006, -4.1000000000000005, -4.100000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000002, -3.6000000000000005, -3.8000000000000007, -3.9000000000000012, -3.800000000000001, -3.9000000000000004, -4.200000000000001, -4.200000000000001, -3.9000000000000004, -4.000000000000001, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -3.800000000000001, -4.000000000000001, -3.8000000000000007, -4.0, -4.000000000000001, -3.800000000000001, -3.800000000000001, -3.9000000000000012, -3.600000000000001, -4.100000000000001, -3.8000000000000007, -3.700000000000001, -3.9000000000000012, -11.0], "episode_lengths": [21, 5, 21, 14, 21, 4, 3, 7, 6, 21, 21, 2, 3, 6, 21, 21, 3, 21, 10, 21, 4, 21, 2, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 11, 3, 5, 21, 5, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.654068310556198, "mean_inference_ms": 18.21696340103455, "mean_action_processing_ms": 0.9506876556329658, "mean_env_wait_ms": 1.7047982164409654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08494605385296718, "StateBufferConnector_ms": 0.011909177518003924, "ViewRequirementAgentConnector_ms": 0.158589146148537}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 170975.674, "load_time_ms": 1.158, "load_throughput": 3455230.25, "learn_time_ms": 170020.319, "learn_throughput": 23.527, "synch_weights_time_ms": 176.167}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "episodes_total": 10978, "training_iteration": 52, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-06_23-23-45", "timestamp": 1680816225, "time_this_iter_s": 170.97522616386414, "time_total_s": 8889.608513116837, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476d1970>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014754d820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 8889.608513116837, "timesteps_since_restore": 0, "iterations_since_restore": 52, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.439506172839505, "ram_util_percent": 24.136213991769548}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.477614258950757, "cur_kl_coeff": 24.631531333923345, "cur_lr": 0.01, "total_loss": 0.6943503304594948, "policy_loss": -0.0015359571784414271, "vf_loss": 0.4807794361865969, "vf_explained_var": 0.6621648530165355, "kl": 0.008732987665295882, "entropy": 2.968136667179805, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 48825.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000}, "sampler_results": {"episode_reward_max": -3.6000000000000005, "episode_reward_min": -12.100000000000001, "episode_reward_mean": -4.524019607843138, "episode_len_mean": 19.573529411764707, "episode_media": {}, "episodes_this_iter": 204, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.800000000000001, -11.0, -4.200000000000001, -10.5, -4.000000000000002, -3.900000000000001, -4.000000000000001, -3.800000000000001, -3.900000000000001, -4.000000000000001, -10.3, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -10.4, -10.1, -10.4, -10.1, -3.8000000000000007, -3.7000000000000006, -3.900000000000001, -10.1, -3.6000000000000005, -4.000000000000002, -10.5, -4.000000000000001, -10.1, -10.1, -10.6, -10.5, -3.600000000000001, -10.1, -3.8000000000000007, -3.9000000000000012, -3.6000000000000005, -3.8000000000000007, -3.8000000000000007, -3.600000000000001, -3.900000000000001, -3.7, -4.100000000000001, -3.800000000000001, -4.200000000000001, -3.9000000000000012, -4.200000000000001, -4.0, -4.000000000000002, -3.7000000000000006, -3.7000000000000006, -3.6000000000000005, -4.000000000000001, -4.100000000000001, -3.900000000000001, -10.7, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.9000000000000004, -4.200000000000001, -3.700000000000001, -3.900000000000001, -3.9000000000000012, -3.9000000000000012, -10.8, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000002, -4.100000000000001, -4.0, -3.900000000000001, -12.100000000000001, -3.8000000000000007, -3.9000000000000012, -4.000000000000002, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000002, -4.100000000000001, -3.7000000000000006, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.600000000000001, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -3.9000000000000004, -3.8000000000000007, -3.700000000000001, -3.9000000000000004, -3.7, -3.700000000000001, -3.900000000000001, -4.1000000000000005, -3.8000000000000007, -3.8000000000000003, -3.900000000000001, -3.8000000000000007, -3.9000000000000004, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.700000000000001, -3.7000000000000006, -3.900000000000001, -10.8, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -3.9000000000000004, -4.100000000000001, -4.000000000000001, -12.1, -3.8000000000000003, -3.7000000000000006, -3.9000000000000012, -3.900000000000001, -3.600000000000001, -3.7000000000000006, -4.000000000000002, -3.6000000000000005, -3.900000000000001, -4.100000000000001, -4.200000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000002, -3.8000000000000007, -4.0, -4.200000000000001, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -3.7000000000000006, -3.700000000000001, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -4.200000000000001, -4.100000000000001, -3.900000000000001, -3.6000000000000005, -3.900000000000001, -4.000000000000001, -3.800000000000001, -4.000000000000001, -4.0, -4.000000000000002, -3.8000000000000007, -4.100000000000001, -3.8000000000000007, -3.9000000000000012, -3.800000000000001, -4.200000000000001, -4.000000000000001, -3.800000000000001, -3.8000000000000007, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000002, -3.800000000000001, -3.8000000000000007, -4.000000000000002, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -4.200000000000001, -3.700000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -3.7000000000000006, -3.800000000000001, -4.000000000000001, -3.800000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000003, -3.9000000000000012, -4.100000000000001, -3.9000000000000012, -4.000000000000001, -3.7000000000000006, -3.900000000000001, -4.0, -4.000000000000001, -3.9000000000000012, -3.600000000000001, -3.800000000000001, -4.0, -3.7000000000000006, -4.200000000000001, -3.7000000000000006, -3.800000000000001, -4.200000000000001, -3.900000000000001], "episode_lengths": [21, 9, 21, 6, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 4, 2, 5, 2, 21, 21, 21, 2, 21, 21, 5, 21, 2, 2, 7, 5, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.675120104921406, "mean_inference_ms": 18.245014477748995, "mean_action_processing_ms": 0.9511878903255684, "mean_env_wait_ms": 1.7027849455867254, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07696806215772442, "StateBufferConnector_ms": 0.01021576862709195, "ViewRequirementAgentConnector_ms": 0.14400131562176874}}, "episode_reward_max": -3.6000000000000005, "episode_reward_min": -12.100000000000001, "episode_reward_mean": -4.524019607843138, "episode_len_mean": 19.573529411764707, "episodes_this_iter": 204, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.800000000000001, -11.0, -4.200000000000001, -10.5, -4.000000000000002, -3.900000000000001, -4.000000000000001, -3.800000000000001, -3.900000000000001, -4.000000000000001, -10.3, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -10.4, -10.1, -10.4, -10.1, -3.8000000000000007, -3.7000000000000006, -3.900000000000001, -10.1, -3.6000000000000005, -4.000000000000002, -10.5, -4.000000000000001, -10.1, -10.1, -10.6, -10.5, -3.600000000000001, -10.1, -3.8000000000000007, -3.9000000000000012, -3.6000000000000005, -3.8000000000000007, -3.8000000000000007, -3.600000000000001, -3.900000000000001, -3.7, -4.100000000000001, -3.800000000000001, -4.200000000000001, -3.9000000000000012, -4.200000000000001, -4.0, -4.000000000000002, -3.7000000000000006, -3.7000000000000006, -3.6000000000000005, -4.000000000000001, -4.100000000000001, -3.900000000000001, -10.7, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.9000000000000004, -4.200000000000001, -3.700000000000001, -3.900000000000001, -3.9000000000000012, -3.9000000000000012, -10.8, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000002, -4.100000000000001, -4.0, -3.900000000000001, -12.100000000000001, -3.8000000000000007, -3.9000000000000012, -4.000000000000002, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000002, -4.100000000000001, -3.7000000000000006, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.600000000000001, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -3.9000000000000004, -3.8000000000000007, -3.700000000000001, -3.9000000000000004, -3.7, -3.700000000000001, -3.900000000000001, -4.1000000000000005, -3.8000000000000007, -3.8000000000000003, -3.900000000000001, -3.8000000000000007, -3.9000000000000004, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.700000000000001, -3.7000000000000006, -3.900000000000001, -10.8, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -3.9000000000000004, -4.100000000000001, -4.000000000000001, -12.1, -3.8000000000000003, -3.7000000000000006, -3.9000000000000012, -3.900000000000001, -3.600000000000001, -3.7000000000000006, -4.000000000000002, -3.6000000000000005, -3.900000000000001, -4.100000000000001, -4.200000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000002, -3.8000000000000007, -4.0, -4.200000000000001, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -3.7000000000000006, -3.700000000000001, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -4.200000000000001, -4.100000000000001, -3.900000000000001, -3.6000000000000005, -3.900000000000001, -4.000000000000001, -3.800000000000001, -4.000000000000001, -4.0, -4.000000000000002, -3.8000000000000007, -4.100000000000001, -3.8000000000000007, -3.9000000000000012, -3.800000000000001, -4.200000000000001, -4.000000000000001, -3.800000000000001, -3.8000000000000007, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000002, -3.800000000000001, -3.8000000000000007, -4.000000000000002, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -4.200000000000001, -3.700000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -3.7000000000000006, -3.800000000000001, -4.000000000000001, -3.800000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000003, -3.9000000000000012, -4.100000000000001, -3.9000000000000012, -4.000000000000001, -3.7000000000000006, -3.900000000000001, -4.0, -4.000000000000001, -3.9000000000000012, -3.600000000000001, -3.800000000000001, -4.0, -3.7000000000000006, -4.200000000000001, -3.7000000000000006, -3.800000000000001, -4.200000000000001, -3.900000000000001], "episode_lengths": [21, 9, 21, 6, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 4, 2, 5, 2, 21, 21, 21, 2, 21, 21, 5, 21, 2, 2, 7, 5, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.675120104921406, "mean_inference_ms": 18.245014477748995, "mean_action_processing_ms": 0.9511878903255684, "mean_env_wait_ms": 1.7027849455867254, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07696806215772442, "StateBufferConnector_ms": 0.01021576862709195, "ViewRequirementAgentConnector_ms": 0.14400131562176874}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 212000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 212000, "timers": {"training_iteration_time_ms": 170975.642, "load_time_ms": 1.156, "load_throughput": 3461289.431, "learn_time_ms": 170027.474, "learn_throughput": 23.526, "synch_weights_time_ms": 172.121}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000}, "done": false, "episodes_total": 11182, "training_iteration": 53, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-06_23-26-36", "timestamp": 1680816396, "time_this_iter_s": 171.4771373271942, "time_total_s": 9061.08565044403, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01477a3fa0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01474de1f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 9061.08565044403, "timesteps_since_restore": 0, "iterations_since_restore": 53, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.686885245901639, "ram_util_percent": 24.105737704918038}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.782577593352205, "cur_kl_coeff": 24.631531333923345, "cur_lr": 0.01, "total_loss": 0.5497645220448893, "policy_loss": -0.002634922205720858, "vf_loss": 0.35913487460504295, "vf_explained_var": 0.6758520619843595, "kl": 0.007846226434721562, "entropy": 2.9408851631226076, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 49755.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "sampler_results": {"episode_reward_max": -3.5000000000000004, "episode_reward_min": -12.1, "episode_reward_mean": -4.4365000000000006, "episode_len_mean": 19.81, "episode_media": {}, "episodes_this_iter": 200, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.900000000000001, -3.8000000000000007, -11.1, -3.800000000000001, -3.700000000000001, -3.8000000000000007, -10.1, -4.100000000000001, -3.7000000000000006, -10.2, -10.2, -3.7000000000000006, -10.4, -10.4, -10.9, -4.000000000000001, -10.2, -12.1, -10.2, -10.3, -3.9000000000000004, -3.500000000000001, -3.7, -3.800000000000001, -4.100000000000001, -3.6000000000000005, -3.900000000000001, -3.7000000000000006, -4.000000000000002, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.600000000000001, -4.100000000000001, -3.600000000000001, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -4.100000000000001, -4.200000000000001, -3.9000000000000012, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -4.200000000000001, -3.7000000000000006, -3.7000000000000006, -4.100000000000001, -3.9000000000000012, -3.7, -3.8000000000000007, -4.100000000000001, -3.9000000000000012, -3.700000000000001, -3.7000000000000006, -4.200000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -4.000000000000002, -3.6000000000000005, -4.100000000000001, -3.6000000000000005, -3.7000000000000006, -4.1000000000000005, -3.8000000000000007, -3.700000000000001, -4.000000000000001, -4.200000000000001, -3.700000000000001, -3.8000000000000007, -3.700000000000001, -3.900000000000001, -3.600000000000001, -4.000000000000001, -3.8000000000000007, -3.700000000000001, -3.9000000000000004, -3.8000000000000007, -3.700000000000001, -4.000000000000001, -4.1000000000000005, -4.000000000000002, -3.6000000000000005, -4.100000000000001, -4.100000000000001, -10.7, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -4.100000000000001, -10.5, -4.0, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.6000000000000005, -3.8000000000000007, -10.4, -3.9000000000000012, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.6, -4.100000000000001, -3.900000000000001, -3.7000000000000006, -3.600000000000001, -4.100000000000001, -4.200000000000001, -3.9000000000000004, -3.6000000000000005, -3.800000000000001, -4.200000000000001, -3.8000000000000007, -4.000000000000002, -3.900000000000001, -12.1, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.5000000000000004, -3.9000000000000012, -3.9000000000000012, -4.200000000000001, -3.9000000000000012, -3.700000000000001, -4.100000000000001, -4.200000000000001, -3.7000000000000006, -3.700000000000001, -4.100000000000001, -3.7000000000000006, -4.100000000000001, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -3.7000000000000006, -3.700000000000001, -4.200000000000001, -4.200000000000001, -4.200000000000001, -10.4, -3.900000000000001, -3.800000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000002, -4.200000000000001, -4.0, -3.800000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.7000000000000006, -4.200000000000001, -3.7000000000000006, -4.000000000000001, -3.9000000000000012, -4.100000000000001, -3.900000000000001, -3.700000000000001, -3.7000000000000006, -4.000000000000001, -3.9000000000000012, -4.1000000000000005, -3.900000000000001, -4.0, -3.900000000000001, -4.000000000000001, -3.800000000000001, -3.900000000000001, -3.900000000000001, -3.6000000000000005, -3.8000000000000003, -3.9000000000000012, -3.8000000000000007, -3.8000000000000003, -3.8000000000000007, -3.800000000000001, -3.5000000000000004, -3.6000000000000005, -4.000000000000001, -4.0, -4.000000000000001], "episode_lengths": [21, 21, 10, 21, 21, 21, 2, 21, 21, 3, 3, 21, 5, 4, 8, 21, 3, 17, 3, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.656945712692092, "mean_inference_ms": 18.187510006743153, "mean_action_processing_ms": 0.9491151411372352, "mean_env_wait_ms": 1.6931785652749962, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07380449771881104, "StateBufferConnector_ms": 0.009702563285827637, "ViewRequirementAgentConnector_ms": 0.13697803020477295}}, "episode_reward_max": -3.5000000000000004, "episode_reward_min": -12.1, "episode_reward_mean": -4.4365000000000006, "episode_len_mean": 19.81, "episodes_this_iter": 200, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.900000000000001, -3.8000000000000007, -11.1, -3.800000000000001, -3.700000000000001, -3.8000000000000007, -10.1, -4.100000000000001, -3.7000000000000006, -10.2, -10.2, -3.7000000000000006, -10.4, -10.4, -10.9, -4.000000000000001, -10.2, -12.1, -10.2, -10.3, -3.9000000000000004, -3.500000000000001, -3.7, -3.800000000000001, -4.100000000000001, -3.6000000000000005, -3.900000000000001, -3.7000000000000006, -4.000000000000002, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.600000000000001, -4.100000000000001, -3.600000000000001, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -4.100000000000001, -4.200000000000001, -3.9000000000000012, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -4.200000000000001, -3.7000000000000006, -3.7000000000000006, -4.100000000000001, -3.9000000000000012, -3.7, -3.8000000000000007, -4.100000000000001, -3.9000000000000012, -3.700000000000001, -3.7000000000000006, -4.200000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -4.000000000000002, -3.6000000000000005, -4.100000000000001, -3.6000000000000005, -3.7000000000000006, -4.1000000000000005, -3.8000000000000007, -3.700000000000001, -4.000000000000001, -4.200000000000001, -3.700000000000001, -3.8000000000000007, -3.700000000000001, -3.900000000000001, -3.600000000000001, -4.000000000000001, -3.8000000000000007, -3.700000000000001, -3.9000000000000004, -3.8000000000000007, -3.700000000000001, -4.000000000000001, -4.1000000000000005, -4.000000000000002, -3.6000000000000005, -4.100000000000001, -4.100000000000001, -10.7, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -4.100000000000001, -10.5, -4.0, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.6000000000000005, -3.8000000000000007, -10.4, -3.9000000000000012, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.6, -4.100000000000001, -3.900000000000001, -3.7000000000000006, -3.600000000000001, -4.100000000000001, -4.200000000000001, -3.9000000000000004, -3.6000000000000005, -3.800000000000001, -4.200000000000001, -3.8000000000000007, -4.000000000000002, -3.900000000000001, -12.1, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.5000000000000004, -3.9000000000000012, -3.9000000000000012, -4.200000000000001, -3.9000000000000012, -3.700000000000001, -4.100000000000001, -4.200000000000001, -3.7000000000000006, -3.700000000000001, -4.100000000000001, -3.7000000000000006, -4.100000000000001, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -3.7000000000000006, -3.700000000000001, -4.200000000000001, -4.200000000000001, -4.200000000000001, -10.4, -3.900000000000001, -3.800000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000002, -4.200000000000001, -4.0, -3.800000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.7000000000000006, -4.200000000000001, -3.7000000000000006, -4.000000000000001, -3.9000000000000012, -4.100000000000001, -3.900000000000001, -3.700000000000001, -3.7000000000000006, -4.000000000000001, -3.9000000000000012, -4.1000000000000005, -3.900000000000001, -4.0, -3.900000000000001, -4.000000000000001, -3.800000000000001, -3.900000000000001, -3.900000000000001, -3.6000000000000005, -3.8000000000000003, -3.9000000000000012, -3.8000000000000007, -3.8000000000000003, -3.8000000000000007, -3.800000000000001, -3.5000000000000004, -3.6000000000000005, -4.000000000000001, -4.0, -4.000000000000001], "episode_lengths": [21, 21, 10, 21, 21, 21, 2, 21, 21, 3, 3, 21, 5, 4, 8, 21, 3, 17, 3, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.656945712692092, "mean_inference_ms": 18.187510006743153, "mean_action_processing_ms": 0.9491151411372352, "mean_env_wait_ms": 1.6931785652749962, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07380449771881104, "StateBufferConnector_ms": 0.009702563285827637, "ViewRequirementAgentConnector_ms": 0.13697803020477295}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 170972.055, "load_time_ms": 1.19, "load_throughput": 3360012.817, "learn_time_ms": 170031.646, "learn_throughput": 23.525, "synch_weights_time_ms": 172.778}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "done": false, "episodes_total": 11382, "training_iteration": 54, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-06_23-29-27", "timestamp": 1680816567, "time_this_iter_s": 170.91199135780334, "time_total_s": 9231.997641801834, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01475695b0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014754d9d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 9231.997641801834, "timesteps_since_restore": 0, "iterations_since_restore": 54, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.458847736625515, "ram_util_percent": 24.176543209876534}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.370220058451416, "cur_kl_coeff": 24.631531333923345, "cur_lr": 0.01, "total_loss": 0.7706028290573628, "policy_loss": -0.0020554227057233533, "vf_loss": 0.5511666052764462, "vf_explained_var": 0.6305352934586105, "kl": 0.0089921997049548, "entropy": 2.933010203094893, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 50685.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000}, "sampler_results": {"episode_reward_max": -3.3000000000000003, "episode_reward_min": -11.8, "episode_reward_mean": -4.691943127962086, "episode_len_mean": 19.156398104265403, "episode_media": {}, "episodes_this_iter": 211, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.1, -3.8000000000000007, -11.1, -3.900000000000001, -3.700000000000001, -10.3, -10.2, -10.5, -3.900000000000001, -11.0, -4.200000000000001, -3.9000000000000004, -4.000000000000001, -3.800000000000001, -10.1, -10.2, -4.000000000000001, -3.700000000000001, -3.8000000000000007, -3.7, -10.6, -11.8, -10.1, -10.3, -3.900000000000001, -3.8000000000000007, -10.4, -10.3, -3.7000000000000006, -3.8000000000000007, -4.000000000000001, -4.1000000000000005, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.700000000000001, -4.0, -3.8000000000000007, -3.900000000000001, -3.800000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.9000000000000004, -3.8000000000000007, -3.9000000000000012, -3.700000000000001, -4.100000000000001, -3.900000000000001, -10.0, -3.800000000000001, -3.8000000000000007, -4.200000000000001, -4.200000000000001, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -4.000000000000002, -3.7000000000000006, -4.000000000000001, -3.900000000000001, -3.6, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -10.6, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.0, -3.6000000000000005, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -4.000000000000002, -3.6000000000000005, -3.900000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.700000000000001, -4.000000000000001, -4.0, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.6000000000000005, -4.200000000000001, -3.7, -3.900000000000001, -3.700000000000001, -3.7000000000000006, -3.900000000000001, -3.9000000000000004, -10.5, -3.9000000000000012, -3.900000000000001, -3.7000000000000006, -4.100000000000001, -10.3, -4.000000000000001, -3.6000000000000005, -4.000000000000001, -10.5, -4.0, -3.900000000000001, -3.3000000000000003, -3.7000000000000006, -4.100000000000001, -10.5, -3.6, -10.4, -3.8000000000000003, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -4.1000000000000005, -3.8000000000000007, -4.000000000000001, -10.7, -4.0, -3.7000000000000006, -3.8000000000000007, -3.8000000000000007, -3.700000000000001, -3.900000000000001, -4.000000000000001, -4.200000000000001, -4.4, -3.700000000000001, -4.200000000000001, -3.7000000000000006, -3.7000000000000006, -4.000000000000001, -4.200000000000001, -4.000000000000001, -3.900000000000001, -3.800000000000001, -3.8000000000000007, -3.800000000000001, -3.600000000000001, -4.200000000000001, -4.000000000000001, -3.7000000000000006, -4.200000000000001, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -4.300000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -3.800000000000001, -3.7000000000000006, -4.000000000000001, -4.1000000000000005, -3.800000000000001, -4.200000000000001, -3.7000000000000006, -3.8000000000000007, -4.1000000000000005, -3.8000000000000007, -4.000000000000001, -3.6000000000000005, -3.600000000000001, -4.200000000000001, -11.1, -11.5, -3.6000000000000005, -4.000000000000001, -4.0, -3.6000000000000005, -4.200000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.9000000000000012, -3.8000000000000007, -3.6000000000000005, -3.9000000000000012, -3.900000000000001, -4.200000000000001, -4.100000000000001, -3.900000000000001, -10.3, -3.900000000000001, -3.8000000000000003, -3.8000000000000007, -3.9000000000000012], "episode_lengths": [2, 21, 8, 21, 21, 4, 3, 5, 21, 8, 21, 21, 21, 21, 2, 3, 21, 21, 21, 21, 6, 16, 2, 4, 21, 21, 4, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 4, 21, 21, 21, 6, 21, 21, 21, 21, 21, 5, 21, 5, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.658881283109768, "mean_inference_ms": 18.193937069546294, "mean_action_processing_ms": 0.9495064705169869, "mean_env_wait_ms": 1.690689437798689, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07709428597400539, "StateBufferConnector_ms": 0.010575276415494946, "ViewRequirementAgentConnector_ms": 0.14415826842683185}}, "episode_reward_max": -3.3000000000000003, "episode_reward_min": -11.8, "episode_reward_mean": -4.691943127962086, "episode_len_mean": 19.156398104265403, "episodes_this_iter": 211, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10.1, -3.8000000000000007, -11.1, -3.900000000000001, -3.700000000000001, -10.3, -10.2, -10.5, -3.900000000000001, -11.0, -4.200000000000001, -3.9000000000000004, -4.000000000000001, -3.800000000000001, -10.1, -10.2, -4.000000000000001, -3.700000000000001, -3.8000000000000007, -3.7, -10.6, -11.8, -10.1, -10.3, -3.900000000000001, -3.8000000000000007, -10.4, -10.3, -3.7000000000000006, -3.8000000000000007, -4.000000000000001, -4.1000000000000005, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.700000000000001, -4.0, -3.8000000000000007, -3.900000000000001, -3.800000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.9000000000000004, -3.8000000000000007, -3.9000000000000012, -3.700000000000001, -4.100000000000001, -3.900000000000001, -10.0, -3.800000000000001, -3.8000000000000007, -4.200000000000001, -4.200000000000001, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -4.000000000000002, -3.7000000000000006, -4.000000000000001, -3.900000000000001, -3.6, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -10.6, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.0, -3.6000000000000005, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -4.000000000000002, -3.6000000000000005, -3.900000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.700000000000001, -4.000000000000001, -4.0, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.6000000000000005, -4.200000000000001, -3.7, -3.900000000000001, -3.700000000000001, -3.7000000000000006, -3.900000000000001, -3.9000000000000004, -10.5, -3.9000000000000012, -3.900000000000001, -3.7000000000000006, -4.100000000000001, -10.3, -4.000000000000001, -3.6000000000000005, -4.000000000000001, -10.5, -4.0, -3.900000000000001, -3.3000000000000003, -3.7000000000000006, -4.100000000000001, -10.5, -3.6, -10.4, -3.8000000000000003, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -4.1000000000000005, -3.8000000000000007, -4.000000000000001, -10.7, -4.0, -3.7000000000000006, -3.8000000000000007, -3.8000000000000007, -3.700000000000001, -3.900000000000001, -4.000000000000001, -4.200000000000001, -4.4, -3.700000000000001, -4.200000000000001, -3.7000000000000006, -3.7000000000000006, -4.000000000000001, -4.200000000000001, -4.000000000000001, -3.900000000000001, -3.800000000000001, -3.8000000000000007, -3.800000000000001, -3.600000000000001, -4.200000000000001, -4.000000000000001, -3.7000000000000006, -4.200000000000001, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -4.300000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -3.800000000000001, -3.7000000000000006, -4.000000000000001, -4.1000000000000005, -3.800000000000001, -4.200000000000001, -3.7000000000000006, -3.8000000000000007, -4.1000000000000005, -3.8000000000000007, -4.000000000000001, -3.6000000000000005, -3.600000000000001, -4.200000000000001, -11.1, -11.5, -3.6000000000000005, -4.000000000000001, -4.0, -3.6000000000000005, -4.200000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.9000000000000012, -3.8000000000000007, -3.6000000000000005, -3.9000000000000012, -3.900000000000001, -4.200000000000001, -4.100000000000001, -3.900000000000001, -10.3, -3.900000000000001, -3.8000000000000003, -3.8000000000000007, -3.9000000000000012], "episode_lengths": [2, 21, 8, 21, 21, 4, 3, 5, 21, 8, 21, 21, 21, 21, 2, 3, 21, 21, 21, 21, 6, 16, 2, 4, 21, 21, 4, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 4, 21, 21, 21, 6, 21, 21, 21, 21, 21, 5, 21, 5, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.658881283109768, "mean_inference_ms": 18.193937069546294, "mean_action_processing_ms": 0.9495064705169869, "mean_env_wait_ms": 1.690689437798689, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07709428597400539, "StateBufferConnector_ms": 0.010575276415494946, "ViewRequirementAgentConnector_ms": 0.14415826842683185}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 220000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 220000, "timers": {"training_iteration_time_ms": 170974.51, "load_time_ms": 1.184, "load_throughput": 3378620.537, "learn_time_ms": 170032.112, "learn_throughput": 23.525, "synch_weights_time_ms": 175.273}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000}, "done": false, "episodes_total": 11593, "training_iteration": 55, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-06_23-32-18", "timestamp": 1680816738, "time_this_iter_s": 170.84533190727234, "time_total_s": 9402.842973709106, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476f25b0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01474de1f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 9402.842973709106, "timesteps_since_restore": 0, "iterations_since_restore": 55, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.413168724279836, "ram_util_percent": 24.19999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.2757224159856, "cur_kl_coeff": 24.631531333923345, "cur_lr": 0.01, "total_loss": 0.6917784009128809, "policy_loss": 0.004401148774570996, "vf_loss": 0.4697648247163142, "vf_explained_var": 0.5976085713473699, "kl": 0.008834709944604065, "entropy": 2.9427880220515754, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 51615.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "sampler_results": {"episode_reward_max": -3.4000000000000004, "episode_reward_min": -12.2, "episode_reward_mean": -4.659798994974875, "episode_len_mean": 19.44221105527638, "episode_media": {}, "episodes_this_iter": 199, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.2, -10.7, -3.9000000000000012, -4.000000000000001, -3.900000000000001, -10.4, -4.000000000000002, -10.4, -10.2, -12.0, -3.700000000000001, -3.7000000000000006, -10.6, -4.000000000000001, -10.7, -3.700000000000001, -10.4, -3.800000000000001, -3.900000000000001, -10.1, -3.8000000000000007, -10.1, -4.0, -10.1, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -3.9000000000000012, -3.900000000000001, -3.9000000000000004, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -4.0, -3.8000000000000007, -4.300000000000001, -4.000000000000002, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000002, -10.6, -4.200000000000001, -4.000000000000002, -4.100000000000001, -4.000000000000002, -4.100000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -3.9000000000000012, -4.0, -4.000000000000001, -3.800000000000001, -4.200000000000001, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -3.7000000000000006, -4.200000000000001, -3.7000000000000006, -4.000000000000002, -4.200000000000001, -3.7000000000000006, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -4.0, -3.7000000000000006, -4.000000000000002, -3.800000000000001, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.9000000000000012, -4.000000000000002, -3.800000000000001, -3.7000000000000006, -3.900000000000001, -3.500000000000001, -3.9000000000000012, -11.4, -3.6000000000000005, -10.2, -4.000000000000002, -4.0, -3.900000000000001, -4.000000000000001, -4.000000000000001, -11.4, -4.100000000000001, -3.7000000000000006, -3.900000000000001, -4.000000000000001, -3.800000000000001, -3.900000000000001, -11.9, -4.100000000000001, -11.9, -10.5, -4.200000000000001, -10.1, -4.100000000000001, -3.8000000000000003, -3.8000000000000007, -3.900000000000001, -3.6000000000000005, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -4.000000000000001, -4.000000000000002, -3.900000000000001, -3.800000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -4.100000000000001, -3.5000000000000004, -4.000000000000001, -3.6000000000000005, -4.100000000000001, -3.6000000000000005, -3.500000000000001, -3.8000000000000007, -4.000000000000001, -3.9000000000000012, -3.700000000000001, -3.700000000000001, -4.300000000000001, -3.800000000000001, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -3.4000000000000004, -3.900000000000001, -4.1000000000000005, -3.8000000000000007, -12.2, -4.0, -3.7000000000000006, -4.000000000000001, -3.8000000000000007, -3.5000000000000004, -3.9000000000000012, -3.8000000000000003, -4.000000000000001, -4.000000000000002, -10.9, -4.000000000000001, -3.9000000000000012, -4.200000000000001, -3.700000000000001, -3.800000000000001, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -3.900000000000001, -4.000000000000001, -3.800000000000001, -3.5000000000000004, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.600000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -3.800000000000001, -3.8000000000000007, -4.200000000000001, -4.000000000000001, -3.8000000000000007, -4.200000000000001, -3.7, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -3.7000000000000006, -4.1000000000000005, -4.0], "episode_lengths": [3, 7, 21, 21, 21, 5, 21, 4, 3, 15, 21, 21, 5, 21, 7, 21, 4, 21, 21, 2, 21, 2, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 3, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 14, 21, 15, 6, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.66662842653493, "mean_inference_ms": 18.17018007434713, "mean_action_processing_ms": 0.9475483529109083, "mean_env_wait_ms": 1.6865132825757723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06929258605343612, "StateBufferConnector_ms": 0.009467374140293755, "ViewRequirementAgentConnector_ms": 0.12835006618020522}}, "episode_reward_max": -3.4000000000000004, "episode_reward_min": -12.2, "episode_reward_mean": -4.659798994974875, "episode_len_mean": 19.44221105527638, "episodes_this_iter": 199, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10.2, -10.7, -3.9000000000000012, -4.000000000000001, -3.900000000000001, -10.4, -4.000000000000002, -10.4, -10.2, -12.0, -3.700000000000001, -3.7000000000000006, -10.6, -4.000000000000001, -10.7, -3.700000000000001, -10.4, -3.800000000000001, -3.900000000000001, -10.1, -3.8000000000000007, -10.1, -4.0, -10.1, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -3.9000000000000012, -3.900000000000001, -3.9000000000000004, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -4.0, -3.8000000000000007, -4.300000000000001, -4.000000000000002, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000002, -10.6, -4.200000000000001, -4.000000000000002, -4.100000000000001, -4.000000000000002, -4.100000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -3.9000000000000012, -4.0, -4.000000000000001, -3.800000000000001, -4.200000000000001, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -3.7000000000000006, -4.200000000000001, -3.7000000000000006, -4.000000000000002, -4.200000000000001, -3.7000000000000006, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -4.0, -3.7000000000000006, -4.000000000000002, -3.800000000000001, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.9000000000000012, -4.000000000000002, -3.800000000000001, -3.7000000000000006, -3.900000000000001, -3.500000000000001, -3.9000000000000012, -11.4, -3.6000000000000005, -10.2, -4.000000000000002, -4.0, -3.900000000000001, -4.000000000000001, -4.000000000000001, -11.4, -4.100000000000001, -3.7000000000000006, -3.900000000000001, -4.000000000000001, -3.800000000000001, -3.900000000000001, -11.9, -4.100000000000001, -11.9, -10.5, -4.200000000000001, -10.1, -4.100000000000001, -3.8000000000000003, -3.8000000000000007, -3.900000000000001, -3.6000000000000005, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -4.000000000000001, -4.000000000000002, -3.900000000000001, -3.800000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -4.100000000000001, -3.5000000000000004, -4.000000000000001, -3.6000000000000005, -4.100000000000001, -3.6000000000000005, -3.500000000000001, -3.8000000000000007, -4.000000000000001, -3.9000000000000012, -3.700000000000001, -3.700000000000001, -4.300000000000001, -3.800000000000001, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -3.4000000000000004, -3.900000000000001, -4.1000000000000005, -3.8000000000000007, -12.2, -4.0, -3.7000000000000006, -4.000000000000001, -3.8000000000000007, -3.5000000000000004, -3.9000000000000012, -3.8000000000000003, -4.000000000000001, -4.000000000000002, -10.9, -4.000000000000001, -3.9000000000000012, -4.200000000000001, -3.700000000000001, -3.800000000000001, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -3.900000000000001, -4.000000000000001, -3.800000000000001, -3.5000000000000004, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.600000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -3.800000000000001, -3.8000000000000007, -4.200000000000001, -4.000000000000001, -3.8000000000000007, -4.200000000000001, -3.7, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -3.7000000000000006, -4.1000000000000005, -4.0], "episode_lengths": [3, 7, 21, 21, 21, 5, 21, 4, 3, 15, 21, 21, 5, 21, 7, 21, 4, 21, 21, 2, 21, 2, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 3, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 14, 21, 15, 6, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.66662842653493, "mean_inference_ms": 18.17018007434713, "mean_action_processing_ms": 0.9475483529109083, "mean_env_wait_ms": 1.6865132825757723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06929258605343612, "StateBufferConnector_ms": 0.009467374140293755, "ViewRequirementAgentConnector_ms": 0.12835006618020522}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 170923.727, "load_time_ms": 1.193, "load_throughput": 3352493.006, "learn_time_ms": 169981.425, "learn_throughput": 23.532, "synch_weights_time_ms": 176.616}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "episodes_total": 11792, "training_iteration": 56, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-06_23-35-09", "timestamp": 1680816909, "time_this_iter_s": 170.7981150150299, "time_total_s": 9573.641088724136, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01474522b0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014754d820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 9573.641088724136, "timesteps_since_restore": 0, "iterations_since_restore": 56, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.4300411522633745, "ram_util_percent": 24.12798353909465}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.74655586904095, "cur_kl_coeff": 24.631531333923345, "cur_lr": 0.01, "total_loss": 0.6052341716424111, "policy_loss": 0.00195461266839336, "vf_loss": 0.373049824380426, "vf_explained_var": 0.6464442205044532, "kl": 0.009346951854694384, "entropy": 2.9558512820992418, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 52545.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "sampler_results": {"episode_reward_max": -3.5000000000000004, "episode_reward_min": -11.7, "episode_reward_mean": -4.384803921568628, "episode_len_mean": 19.872549019607842, "episode_media": {}, "episodes_this_iter": 204, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.5, -3.7000000000000006, -3.900000000000001, -3.800000000000001, -3.900000000000001, -3.900000000000001, -3.9000000000000012, -11.0, -10.4, -10.4, -3.800000000000001, -3.8000000000000007, -10.4, -3.800000000000001, -3.8000000000000007, -3.700000000000001, -3.800000000000001, -3.8000000000000007, -10.7, -10.1, -4.100000000000001, -3.7000000000000006, -3.9000000000000012, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -3.900000000000001, -3.6000000000000005, -4.1000000000000005, -4.0, -4.000000000000001, -4.200000000000001, -3.8000000000000007, -3.900000000000001, -3.9000000000000012, -3.9000000000000004, -3.6000000000000005, -4.200000000000001, -4.000000000000001, -4.000000000000002, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.800000000000001, -4.000000000000002, -4.200000000000001, -3.7000000000000006, -4.000000000000002, -3.900000000000001, -3.700000000000001, -4.200000000000001, -3.7000000000000006, -3.700000000000001, -4.100000000000001, -3.700000000000001, -3.700000000000001, -3.800000000000001, -10.6, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -4.100000000000001, -3.9000000000000012, -3.800000000000001, -3.900000000000001, -4.1000000000000005, -4.000000000000002, -3.9000000000000012, -3.8000000000000007, -3.600000000000001, -3.9000000000000004, -4.300000000000001, -3.7000000000000006, -3.8000000000000003, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000002, -4.000000000000001, -4.100000000000001, -4.300000000000001, -3.9000000000000012, -3.7, -4.1000000000000005, -3.8000000000000007, -3.7000000000000006, -10.5, -3.900000000000001, -3.8000000000000007, -3.700000000000001, -4.000000000000002, -4.100000000000001, -10.3, -10.6, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -3.600000000000001, -10.1, -4.000000000000001, -4.100000000000001, -10.2, -10.4, -4.000000000000002, -4.000000000000001, -11.7, -4.000000000000001, -3.800000000000001, -4.000000000000001, -3.8000000000000007, -3.7000000000000006, -3.8000000000000007, -3.7000000000000006, -3.800000000000001, -4.000000000000001, -3.700000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.7000000000000006, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -3.9000000000000012, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.6000000000000005, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.6000000000000005, -3.900000000000001, -3.8000000000000007, -3.600000000000001, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000001, -3.9000000000000012, -4.1000000000000005, -3.5000000000000004, -4.300000000000001, -4.100000000000001, -3.8000000000000007, -3.6000000000000005, -4.200000000000001, -3.600000000000001, -3.800000000000001, -3.6000000000000005, -4.000000000000001, -4.000000000000002, -3.6000000000000005, -4.200000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -4.200000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000002, -4.100000000000001, -3.7000000000000006, -3.8000000000000007, -3.6000000000000005, -4.000000000000001, -3.7000000000000006, -3.700000000000001, -3.600000000000001, -3.900000000000001, -3.8000000000000007, -3.9000000000000012, -3.900000000000001, -4.200000000000001, -3.7000000000000006, -4.200000000000001, -3.8000000000000007, -4.100000000000001, -3.8000000000000007, -4.200000000000001, -4.000000000000001, -3.800000000000001, -4.000000000000001, -3.800000000000001, -4.000000000000001, -3.900000000000001, -4.200000000000001, -3.7000000000000006, -4.000000000000001, -3.7000000000000006], "episode_lengths": [5, 21, 21, 21, 21, 21, 21, 10, 4, 5, 21, 21, 4, 21, 21, 21, 21, 21, 8, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 4, 6, 21, 21, 21, 21, 2, 21, 21, 3, 5, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.668059557335738, "mean_inference_ms": 18.157921825066808, "mean_action_processing_ms": 0.9472333262907459, "mean_env_wait_ms": 1.682378666786576, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08135274344799566, "StateBufferConnector_ms": 0.010550957100064146, "ViewRequirementAgentConnector_ms": 0.14793884520437203}}, "episode_reward_max": -3.5000000000000004, "episode_reward_min": -11.7, "episode_reward_mean": -4.384803921568628, "episode_len_mean": 19.872549019607842, "episodes_this_iter": 204, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10.5, -3.7000000000000006, -3.900000000000001, -3.800000000000001, -3.900000000000001, -3.900000000000001, -3.9000000000000012, -11.0, -10.4, -10.4, -3.800000000000001, -3.8000000000000007, -10.4, -3.800000000000001, -3.8000000000000007, -3.700000000000001, -3.800000000000001, -3.8000000000000007, -10.7, -10.1, -4.100000000000001, -3.7000000000000006, -3.9000000000000012, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -3.900000000000001, -3.6000000000000005, -4.1000000000000005, -4.0, -4.000000000000001, -4.200000000000001, -3.8000000000000007, -3.900000000000001, -3.9000000000000012, -3.9000000000000004, -3.6000000000000005, -4.200000000000001, -4.000000000000001, -4.000000000000002, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.800000000000001, -4.000000000000002, -4.200000000000001, -3.7000000000000006, -4.000000000000002, -3.900000000000001, -3.700000000000001, -4.200000000000001, -3.7000000000000006, -3.700000000000001, -4.100000000000001, -3.700000000000001, -3.700000000000001, -3.800000000000001, -10.6, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -4.100000000000001, -3.9000000000000012, -3.800000000000001, -3.900000000000001, -4.1000000000000005, -4.000000000000002, -3.9000000000000012, -3.8000000000000007, -3.600000000000001, -3.9000000000000004, -4.300000000000001, -3.7000000000000006, -3.8000000000000003, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000002, -4.000000000000001, -4.100000000000001, -4.300000000000001, -3.9000000000000012, -3.7, -4.1000000000000005, -3.8000000000000007, -3.7000000000000006, -10.5, -3.900000000000001, -3.8000000000000007, -3.700000000000001, -4.000000000000002, -4.100000000000001, -10.3, -10.6, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -3.600000000000001, -10.1, -4.000000000000001, -4.100000000000001, -10.2, -10.4, -4.000000000000002, -4.000000000000001, -11.7, -4.000000000000001, -3.800000000000001, -4.000000000000001, -3.8000000000000007, -3.7000000000000006, -3.8000000000000007, -3.7000000000000006, -3.800000000000001, -4.000000000000001, -3.700000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.7000000000000006, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -3.9000000000000012, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.6000000000000005, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.6000000000000005, -3.900000000000001, -3.8000000000000007, -3.600000000000001, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000001, -3.9000000000000012, -4.1000000000000005, -3.5000000000000004, -4.300000000000001, -4.100000000000001, -3.8000000000000007, -3.6000000000000005, -4.200000000000001, -3.600000000000001, -3.800000000000001, -3.6000000000000005, -4.000000000000001, -4.000000000000002, -3.6000000000000005, -4.200000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -4.200000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000002, -4.100000000000001, -3.7000000000000006, -3.8000000000000007, -3.6000000000000005, -4.000000000000001, -3.7000000000000006, -3.700000000000001, -3.600000000000001, -3.900000000000001, -3.8000000000000007, -3.9000000000000012, -3.900000000000001, -4.200000000000001, -3.7000000000000006, -4.200000000000001, -3.8000000000000007, -4.100000000000001, -3.8000000000000007, -4.200000000000001, -4.000000000000001, -3.800000000000001, -4.000000000000001, -3.800000000000001, -4.000000000000001, -3.900000000000001, -4.200000000000001, -3.7000000000000006, -4.000000000000001, -3.7000000000000006], "episode_lengths": [5, 21, 21, 21, 21, 21, 21, 10, 4, 5, 21, 21, 4, 21, 21, 21, 21, 21, 8, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 4, 6, 21, 21, 21, 21, 2, 21, 21, 3, 5, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.668059557335738, "mean_inference_ms": 18.157921825066808, "mean_action_processing_ms": 0.9472333262907459, "mean_env_wait_ms": 1.682378666786576, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08135274344799566, "StateBufferConnector_ms": 0.010550957100064146, "ViewRequirementAgentConnector_ms": 0.14793884520437203}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 228000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 228000, "timers": {"training_iteration_time_ms": 170942.054, "load_time_ms": 1.188, "load_throughput": 3366485.272, "learn_time_ms": 169997.683, "learn_throughput": 23.53, "synch_weights_time_ms": 176.466}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "done": false, "episodes_total": 11996, "training_iteration": 57, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-06_23-38-00", "timestamp": 1680817080, "time_this_iter_s": 171.05375576019287, "time_total_s": 9744.69484448433, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476cba90>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01474de8b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 9744.69484448433, "timesteps_since_restore": 0, "iterations_since_restore": 57, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.548148148148147, "ram_util_percent": 24.1477366255144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.482181731090751, "cur_kl_coeff": 24.631531333923345, "cur_lr": 0.01, "total_loss": 0.5262383310464761, "policy_loss": 0.001728772550761219, "vf_loss": 0.30416554168507615, "vf_explained_var": 0.6670993160816931, "kl": 0.008945607952085093, "entropy": 2.935667411999036, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 53475.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "sampler_results": {"episode_reward_max": -3.3000000000000003, "episode_reward_min": -12.3, "episode_reward_mean": -4.282142857142858, "episode_len_mean": 20.183673469387756, "episode_media": {}, "episodes_this_iter": 196, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.900000000000001, -3.900000000000001, -3.900000000000001, -11.4, -3.7000000000000006, -3.900000000000001, -4.0, -4.000000000000001, -3.8000000000000007, -10.6, -10.2, -3.8000000000000007, -3.3000000000000003, -10.1, -3.8000000000000007, -3.5000000000000004, -3.900000000000001, -10.7, -3.7000000000000006, -3.7000000000000006, -4.000000000000001, -3.7000000000000006, -3.8000000000000007, -3.8000000000000007, -3.9000000000000004, -3.900000000000001, -3.8000000000000007, -3.7000000000000006, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -4.1000000000000005, -3.6000000000000005, -3.8000000000000007, -4.200000000000001, -4.000000000000001, -3.7000000000000006, -3.9000000000000012, -3.8000000000000007, -3.9000000000000012, -4.0, -3.900000000000001, -4.1000000000000005, -4.000000000000002, -3.900000000000001, -4.200000000000001, -3.900000000000001, -3.9000000000000012, -3.900000000000001, -4.100000000000001, -3.600000000000001, -3.800000000000001, -4.200000000000001, -4.400000000000001, -3.900000000000001, -4.400000000000001, -4.0, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.6000000000000005, -3.7000000000000006, -4.300000000000001, -3.900000000000001, -3.6000000000000005, -3.800000000000001, -3.9000000000000012, -3.7, -3.9000000000000012, -3.7, -4.000000000000001, -3.6000000000000005, -3.800000000000001, -3.900000000000001, -3.9000000000000012, -4.000000000000001, -4.000000000000002, -4.100000000000001, -4.1000000000000005, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.9000000000000012, -4.200000000000001, -4.000000000000002, -4.100000000000001, -3.9000000000000004, -3.8000000000000007, -4.000000000000001, -3.7000000000000006, -4.300000000000001, -4.000000000000001, -3.8000000000000007, -11.1, -3.7000000000000006, -12.3, -3.7000000000000006, -4.000000000000001, -4.0, -3.6000000000000005, -10.0, -3.8000000000000007, -10.1, -3.7000000000000006, -10.1, -3.7000000000000006, -3.800000000000001, -4.300000000000001, -3.9000000000000004, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -4.200000000000001, -3.800000000000001, -3.900000000000001, -3.800000000000001, -4.200000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000002, -3.8000000000000007, -4.0, -4.000000000000001, -3.900000000000001, -4.0, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.0, -4.000000000000001, -4.000000000000002, -4.0, -4.000000000000001, -3.8000000000000007, -10.9, -3.7000000000000006, -3.8000000000000007, -3.600000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.5000000000000004, -4.100000000000001, -3.9000000000000012, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -4.200000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -4.100000000000001, -3.7000000000000006, -3.7000000000000006, -3.8000000000000007, -3.9000000000000004, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.6000000000000005, -4.0, -3.9000000000000012, -4.200000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.1000000000000005, -4.0, -3.7000000000000006, -3.7000000000000006, -3.9000000000000004, -4.000000000000001, -4.0, -4.100000000000001, -4.0, -4.1000000000000005, -3.8000000000000007, -3.8000000000000007, -4.000000000000002, -3.900000000000001, -3.9000000000000004, -3.7000000000000006, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000003], "episode_lengths": [21, 21, 21, 13, 21, 21, 21, 21, 21, 5, 3, 21, 21, 2, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 17, 21, 21, 21, 21, 1, 21, 2, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.696773610700694, "mean_inference_ms": 18.177002098936303, "mean_action_processing_ms": 0.9473690074851655, "mean_env_wait_ms": 1.6768732252223062, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07563099569203902, "StateBufferConnector_ms": 0.009909454657106983, "ViewRequirementAgentConnector_ms": 0.13756727685733716}}, "episode_reward_max": -3.3000000000000003, "episode_reward_min": -12.3, "episode_reward_mean": -4.282142857142858, "episode_len_mean": 20.183673469387756, "episodes_this_iter": 196, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.900000000000001, -3.900000000000001, -3.900000000000001, -11.4, -3.7000000000000006, -3.900000000000001, -4.0, -4.000000000000001, -3.8000000000000007, -10.6, -10.2, -3.8000000000000007, -3.3000000000000003, -10.1, -3.8000000000000007, -3.5000000000000004, -3.900000000000001, -10.7, -3.7000000000000006, -3.7000000000000006, -4.000000000000001, -3.7000000000000006, -3.8000000000000007, -3.8000000000000007, -3.9000000000000004, -3.900000000000001, -3.8000000000000007, -3.7000000000000006, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -4.1000000000000005, -3.6000000000000005, -3.8000000000000007, -4.200000000000001, -4.000000000000001, -3.7000000000000006, -3.9000000000000012, -3.8000000000000007, -3.9000000000000012, -4.0, -3.900000000000001, -4.1000000000000005, -4.000000000000002, -3.900000000000001, -4.200000000000001, -3.900000000000001, -3.9000000000000012, -3.900000000000001, -4.100000000000001, -3.600000000000001, -3.800000000000001, -4.200000000000001, -4.400000000000001, -3.900000000000001, -4.400000000000001, -4.0, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.6000000000000005, -3.7000000000000006, -4.300000000000001, -3.900000000000001, -3.6000000000000005, -3.800000000000001, -3.9000000000000012, -3.7, -3.9000000000000012, -3.7, -4.000000000000001, -3.6000000000000005, -3.800000000000001, -3.900000000000001, -3.9000000000000012, -4.000000000000001, -4.000000000000002, -4.100000000000001, -4.1000000000000005, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.9000000000000012, -4.200000000000001, -4.000000000000002, -4.100000000000001, -3.9000000000000004, -3.8000000000000007, -4.000000000000001, -3.7000000000000006, -4.300000000000001, -4.000000000000001, -3.8000000000000007, -11.1, -3.7000000000000006, -12.3, -3.7000000000000006, -4.000000000000001, -4.0, -3.6000000000000005, -10.0, -3.8000000000000007, -10.1, -3.7000000000000006, -10.1, -3.7000000000000006, -3.800000000000001, -4.300000000000001, -3.9000000000000004, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -4.200000000000001, -3.800000000000001, -3.900000000000001, -3.800000000000001, -4.200000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000002, -3.8000000000000007, -4.0, -4.000000000000001, -3.900000000000001, -4.0, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.0, -4.000000000000001, -4.000000000000002, -4.0, -4.000000000000001, -3.8000000000000007, -10.9, -3.7000000000000006, -3.8000000000000007, -3.600000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.5000000000000004, -4.100000000000001, -3.9000000000000012, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -4.200000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -4.100000000000001, -3.7000000000000006, -3.7000000000000006, -3.8000000000000007, -3.9000000000000004, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.6000000000000005, -4.0, -3.9000000000000012, -4.200000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.1000000000000005, -4.0, -3.7000000000000006, -3.7000000000000006, -3.9000000000000004, -4.000000000000001, -4.0, -4.100000000000001, -4.0, -4.1000000000000005, -3.8000000000000007, -3.8000000000000007, -4.000000000000002, -3.900000000000001, -3.9000000000000004, -3.7000000000000006, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000003], "episode_lengths": [21, 21, 21, 13, 21, 21, 21, 21, 21, 5, 3, 21, 21, 2, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 17, 21, 21, 21, 21, 1, 21, 2, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.696773610700694, "mean_inference_ms": 18.177002098936303, "mean_action_processing_ms": 0.9473690074851655, "mean_env_wait_ms": 1.6768732252223062, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07563099569203902, "StateBufferConnector_ms": 0.009909454657106983, "ViewRequirementAgentConnector_ms": 0.13756727685733716}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 232000, "timers": {"training_iteration_time_ms": 170978.328, "load_time_ms": 1.177, "load_throughput": 3399087.483, "learn_time_ms": 170033.697, "learn_throughput": 23.525, "synch_weights_time_ms": 174.848}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "done": false, "episodes_total": 12192, "training_iteration": 58, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-06_23-40-51", "timestamp": 1680817251, "time_this_iter_s": 171.1293227672577, "time_total_s": 9915.824167251587, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476bccd0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0147464dc0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 9915.824167251587, "timesteps_since_restore": 0, "iterations_since_restore": 58, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.495061728395062, "ram_util_percent": 24.147325102880654}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.703710601150348, "cur_kl_coeff": 24.631531333923345, "cur_lr": 0.01, "total_loss": 0.5081898393610151, "policy_loss": 0.001153521979307776, "vf_loss": 0.28366545927460474, "vf_explained_var": 0.6419428563246163, "kl": 0.009068492777715688, "entropy": 2.9357808566862538, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 54405.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000}, "sampler_results": {"episode_reward_max": -3.400000000000001, "episode_reward_min": -12.0, "episode_reward_mean": -4.14179104477612, "episode_len_mean": 20.502487562189053, "episode_media": {}, "episodes_this_iter": 201, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.700000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -3.8000000000000007, -10.5, -11.2, -4.000000000000001, -3.9000000000000004, -3.6000000000000005, -10.2, -3.800000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.800000000000001, -3.800000000000001, -3.900000000000001, -3.900000000000001, -4.300000000000001, -3.9000000000000004, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -4.200000000000001, -3.8000000000000003, -4.000000000000001, -4.200000000000001, -3.7000000000000006, -4.200000000000001, -3.900000000000001, -3.9000000000000004, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -4.200000000000001, -4.0, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.7000000000000006, -4.200000000000001, -3.900000000000001, -4.000000000000002, -3.7000000000000006, -3.7000000000000006, -4.000000000000001, -3.800000000000001, -4.0, -4.100000000000001, -4.100000000000001, -3.900000000000001, -4.300000000000001, -4.100000000000001, -3.8000000000000007, -3.600000000000001, -4.100000000000001, -3.800000000000001, -4.000000000000001, -4.100000000000001, -4.0, -3.6000000000000005, -4.100000000000001, -3.900000000000001, -4.100000000000001, -3.700000000000001, -3.900000000000001, -4.1000000000000005, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -3.7000000000000006, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -4.200000000000001, -3.900000000000001, -4.100000000000001, -3.7000000000000006, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -3.800000000000001, -3.900000000000001, -4.200000000000001, -4.100000000000001, -3.800000000000001, -3.8000000000000007, -3.9000000000000004, -10.8, -10.1, -3.900000000000001, -3.9000000000000012, -3.900000000000001, -4.200000000000001, -3.8000000000000007, -10.4, -4.000000000000001, -3.900000000000001, -3.7000000000000006, -3.400000000000001, -3.8000000000000007, -3.700000000000001, -3.8000000000000007, -3.7000000000000006, -3.7000000000000006, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.700000000000001, -3.7000000000000006, -4.100000000000001, -3.8000000000000007, -4.300000000000001, -3.7000000000000006, -4.000000000000001, -3.9000000000000012, -3.6000000000000005, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.700000000000001, -3.900000000000001, -3.7000000000000006, -4.000000000000002, -4.0, -3.8000000000000007, -4.000000000000002, -3.7000000000000006, -4.200000000000001, -4.200000000000001, -3.7000000000000006, -3.800000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -3.8000000000000007, -4.100000000000001, -3.8000000000000007, -3.9000000000000012, -3.9000000000000012, -4.000000000000001, -3.6000000000000005, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -4.100000000000001, -3.9000000000000012, -4.200000000000001, -4.000000000000001, -4.1000000000000005, -3.600000000000001, -3.8000000000000007, -3.600000000000001, -4.000000000000001, -3.7000000000000006, -3.7000000000000006, -3.8000000000000007, -12.0, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -3.900000000000001, -4.200000000000001, -3.8000000000000007, -3.6000000000000005, -3.600000000000001, -3.8000000000000007, -3.9000000000000004, -3.9000000000000012, -4.100000000000001, -3.8000000000000003, -3.800000000000001, -3.8000000000000003, -3.900000000000001, -4.100000000000001, -4.100000000000001, -3.7000000000000006, -3.9000000000000004, -3.900000000000001, -3.7000000000000006, -4.100000000000001, -3.7000000000000006, -4.1000000000000005, -3.800000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 9, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 2, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.689318864460581, "mean_inference_ms": 18.199337272464547, "mean_action_processing_ms": 0.9497770518140454, "mean_env_wait_ms": 1.677517403187558, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09062586732171661, "StateBufferConnector_ms": 0.011497824939329233, "ViewRequirementAgentConnector_ms": 0.16536463552446506}}, "episode_reward_max": -3.400000000000001, "episode_reward_min": -12.0, "episode_reward_mean": -4.14179104477612, "episode_len_mean": 20.502487562189053, "episodes_this_iter": 201, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.700000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -3.8000000000000007, -10.5, -11.2, -4.000000000000001, -3.9000000000000004, -3.6000000000000005, -10.2, -3.800000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.800000000000001, -3.800000000000001, -3.900000000000001, -3.900000000000001, -4.300000000000001, -3.9000000000000004, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -4.200000000000001, -3.8000000000000003, -4.000000000000001, -4.200000000000001, -3.7000000000000006, -4.200000000000001, -3.900000000000001, -3.9000000000000004, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -4.200000000000001, -4.0, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.7000000000000006, -4.200000000000001, -3.900000000000001, -4.000000000000002, -3.7000000000000006, -3.7000000000000006, -4.000000000000001, -3.800000000000001, -4.0, -4.100000000000001, -4.100000000000001, -3.900000000000001, -4.300000000000001, -4.100000000000001, -3.8000000000000007, -3.600000000000001, -4.100000000000001, -3.800000000000001, -4.000000000000001, -4.100000000000001, -4.0, -3.6000000000000005, -4.100000000000001, -3.900000000000001, -4.100000000000001, -3.700000000000001, -3.900000000000001, -4.1000000000000005, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -3.7000000000000006, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -4.200000000000001, -3.900000000000001, -4.100000000000001, -3.7000000000000006, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -3.800000000000001, -3.900000000000001, -4.200000000000001, -4.100000000000001, -3.800000000000001, -3.8000000000000007, -3.9000000000000004, -10.8, -10.1, -3.900000000000001, -3.9000000000000012, -3.900000000000001, -4.200000000000001, -3.8000000000000007, -10.4, -4.000000000000001, -3.900000000000001, -3.7000000000000006, -3.400000000000001, -3.8000000000000007, -3.700000000000001, -3.8000000000000007, -3.7000000000000006, -3.7000000000000006, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.700000000000001, -3.7000000000000006, -4.100000000000001, -3.8000000000000007, -4.300000000000001, -3.7000000000000006, -4.000000000000001, -3.9000000000000012, -3.6000000000000005, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.700000000000001, -3.900000000000001, -3.7000000000000006, -4.000000000000002, -4.0, -3.8000000000000007, -4.000000000000002, -3.7000000000000006, -4.200000000000001, -4.200000000000001, -3.7000000000000006, -3.800000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -3.8000000000000007, -4.100000000000001, -3.8000000000000007, -3.9000000000000012, -3.9000000000000012, -4.000000000000001, -3.6000000000000005, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -4.100000000000001, -3.9000000000000012, -4.200000000000001, -4.000000000000001, -4.1000000000000005, -3.600000000000001, -3.8000000000000007, -3.600000000000001, -4.000000000000001, -3.7000000000000006, -3.7000000000000006, -3.8000000000000007, -12.0, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -3.900000000000001, -4.200000000000001, -3.8000000000000007, -3.6000000000000005, -3.600000000000001, -3.8000000000000007, -3.9000000000000004, -3.9000000000000012, -4.100000000000001, -3.8000000000000003, -3.800000000000001, -3.8000000000000003, -3.900000000000001, -4.100000000000001, -4.100000000000001, -3.7000000000000006, -3.9000000000000004, -3.900000000000001, -3.7000000000000006, -4.100000000000001, -3.7000000000000006, -4.1000000000000005, -3.800000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 9, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 2, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.689318864460581, "mean_inference_ms": 18.199337272464547, "mean_action_processing_ms": 0.9497770518140454, "mean_env_wait_ms": 1.677517403187558, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09062586732171661, "StateBufferConnector_ms": 0.011497824939329233, "ViewRequirementAgentConnector_ms": 0.16536463552446506}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 236000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 236000, "timers": {"training_iteration_time_ms": 170933.213, "load_time_ms": 1.169, "load_throughput": 3422943.649, "learn_time_ms": 169979.505, "learn_throughput": 23.532, "synch_weights_time_ms": 177.366}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000}, "done": false, "episodes_total": 12393, "training_iteration": 59, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-06_23-43-42", "timestamp": 1680817422, "time_this_iter_s": 170.88366842269897, "time_total_s": 10086.707835674286, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0147659c40>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01474cb700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 10086.707835674286, "timesteps_since_restore": 0, "iterations_since_restore": 59, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.439506172839507, "ram_util_percent": 24.186419753086412}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.056362322325347, "cur_kl_coeff": 24.631531333923345, "cur_lr": 0.01, "total_loss": 0.5754588735820625, "policy_loss": 0.0018735945084562865, "vf_loss": 0.35393311986599557, "vf_explained_var": 0.7222405541327692, "kl": 0.008917519450672746, "entropy": 2.9352008286342826, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 55335.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "sampler_results": {"episode_reward_max": -3.5000000000000004, "episode_reward_min": -12.8, "episode_reward_mean": -4.209473684210527, "episode_len_mean": 20.436842105263157, "episode_media": {}, "episodes_this_iter": 190, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.3, -3.8000000000000007, -10.3, -3.8000000000000007, -3.7000000000000006, -3.7000000000000006, -12.3, -12.2, -4.000000000000001, -10.6, -10.8, -10.4, -4.000000000000001, -3.7000000000000006, -10.5, -4.000000000000001, -3.6000000000000005, -3.7000000000000006, -3.900000000000001, -3.6000000000000005, -3.800000000000001, -4.0, -3.8000000000000007, -3.500000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -3.7000000000000006, -3.8000000000000007, -3.8000000000000007, -3.7000000000000006, -3.8000000000000007, -3.6000000000000005, -3.8000000000000007, -4.100000000000001, -3.7000000000000006, -3.7000000000000006, -3.5000000000000004, -4.000000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -4.200000000000001, -4.0, -3.8000000000000007, -4.100000000000001, -4.000000000000002, -4.100000000000001, -3.9000000000000012, -3.500000000000001, -3.7000000000000006, -3.7000000000000006, -3.9000000000000012, -3.8000000000000007, -3.9000000000000004, -3.9000000000000012, -4.100000000000001, -3.6000000000000005, -3.9000000000000012, -3.9000000000000004, -4.000000000000001, -3.800000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -3.7000000000000006, -3.9000000000000012, -3.7000000000000006, -3.5000000000000004, -4.000000000000001, -3.9000000000000012, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.9000000000000012, -4.000000000000001, -3.9000000000000012, -3.8000000000000007, -3.7000000000000006, -3.9000000000000004, -4.100000000000001, -3.900000000000001, -3.700000000000001, -3.700000000000001, -4.100000000000001, -3.9000000000000012, -3.7, -3.8000000000000007, -12.8, -3.9000000000000012, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -3.6000000000000005, -3.800000000000001, -3.8000000000000007, -3.7000000000000006, -3.7000000000000006, -3.7000000000000006, -4.100000000000001, -3.900000000000001, -3.9000000000000012, -3.8000000000000007, -4.100000000000001, -3.8000000000000007, -3.7000000000000006, -4.0, -3.600000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -3.6000000000000005, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.300000000000001, -3.900000000000001, -4.000000000000002, -3.8000000000000007, -4.000000000000001, -3.500000000000001, -3.900000000000001, -3.8000000000000003, -3.900000000000001, -4.000000000000002, -3.8000000000000007, -4.000000000000001, -3.700000000000001, -4.000000000000001, -3.5000000000000004, -3.8000000000000007, -3.9000000000000012, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -3.7000000000000006, -4.200000000000001, -3.8000000000000007, -4.0, -3.8000000000000007, -4.100000000000001, -3.8000000000000007, -4.200000000000001, -3.900000000000001, -3.9000000000000012, -3.9000000000000012, -4.000000000000001, -3.8000000000000007, -3.9000000000000012, -4.100000000000001, -3.7000000000000006, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.9000000000000012, -3.8000000000000007, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -3.7000000000000006, -3.900000000000001, -3.800000000000001, -3.900000000000001, -3.6, -4.200000000000001, -3.6, -4.100000000000001, -3.8000000000000007, -4.100000000000001], "episode_lengths": [4, 21, 4, 21, 21, 21, 16, 16, 21, 6, 8, 4, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.695413924323, "mean_inference_ms": 18.20945154226256, "mean_action_processing_ms": 0.949872640792544, "mean_env_wait_ms": 1.6745436133571057, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06927665911222759, "StateBufferConnector_ms": 0.008931912873920641, "ViewRequirementAgentConnector_ms": 0.12715716111032585}}, "episode_reward_max": -3.5000000000000004, "episode_reward_min": -12.8, "episode_reward_mean": -4.209473684210527, "episode_len_mean": 20.436842105263157, "episodes_this_iter": 190, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10.3, -3.8000000000000007, -10.3, -3.8000000000000007, -3.7000000000000006, -3.7000000000000006, -12.3, -12.2, -4.000000000000001, -10.6, -10.8, -10.4, -4.000000000000001, -3.7000000000000006, -10.5, -4.000000000000001, -3.6000000000000005, -3.7000000000000006, -3.900000000000001, -3.6000000000000005, -3.800000000000001, -4.0, -3.8000000000000007, -3.500000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -3.7000000000000006, -3.8000000000000007, -3.8000000000000007, -3.7000000000000006, -3.8000000000000007, -3.6000000000000005, -3.8000000000000007, -4.100000000000001, -3.7000000000000006, -3.7000000000000006, -3.5000000000000004, -4.000000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -4.200000000000001, -4.0, -3.8000000000000007, -4.100000000000001, -4.000000000000002, -4.100000000000001, -3.9000000000000012, -3.500000000000001, -3.7000000000000006, -3.7000000000000006, -3.9000000000000012, -3.8000000000000007, -3.9000000000000004, -3.9000000000000012, -4.100000000000001, -3.6000000000000005, -3.9000000000000012, -3.9000000000000004, -4.000000000000001, -3.800000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -3.7000000000000006, -3.9000000000000012, -3.7000000000000006, -3.5000000000000004, -4.000000000000001, -3.9000000000000012, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.9000000000000012, -4.000000000000001, -3.9000000000000012, -3.8000000000000007, -3.7000000000000006, -3.9000000000000004, -4.100000000000001, -3.900000000000001, -3.700000000000001, -3.700000000000001, -4.100000000000001, -3.9000000000000012, -3.7, -3.8000000000000007, -12.8, -3.9000000000000012, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -3.6000000000000005, -3.800000000000001, -3.8000000000000007, -3.7000000000000006, -3.7000000000000006, -3.7000000000000006, -4.100000000000001, -3.900000000000001, -3.9000000000000012, -3.8000000000000007, -4.100000000000001, -3.8000000000000007, -3.7000000000000006, -4.0, -3.600000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -3.6000000000000005, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.300000000000001, -3.900000000000001, -4.000000000000002, -3.8000000000000007, -4.000000000000001, -3.500000000000001, -3.900000000000001, -3.8000000000000003, -3.900000000000001, -4.000000000000002, -3.8000000000000007, -4.000000000000001, -3.700000000000001, -4.000000000000001, -3.5000000000000004, -3.8000000000000007, -3.9000000000000012, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -3.7000000000000006, -4.200000000000001, -3.8000000000000007, -4.0, -3.8000000000000007, -4.100000000000001, -3.8000000000000007, -4.200000000000001, -3.900000000000001, -3.9000000000000012, -3.9000000000000012, -4.000000000000001, -3.8000000000000007, -3.9000000000000012, -4.100000000000001, -3.7000000000000006, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.9000000000000012, -3.8000000000000007, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -3.7000000000000006, -3.900000000000001, -3.800000000000001, -3.900000000000001, -3.6, -4.200000000000001, -3.6, -4.100000000000001, -3.8000000000000007, -4.100000000000001], "episode_lengths": [4, 21, 4, 21, 21, 21, 16, 16, 21, 6, 8, 4, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.695413924323, "mean_inference_ms": 18.20945154226256, "mean_action_processing_ms": 0.949872640792544, "mean_env_wait_ms": 1.6745436133571057, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06927665911222759, "StateBufferConnector_ms": 0.008931912873920641, "ViewRequirementAgentConnector_ms": 0.12715716111032585}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 170949.862, "load_time_ms": 1.167, "load_throughput": 3427839.163, "learn_time_ms": 169997.848, "learn_throughput": 23.53, "synch_weights_time_ms": 176.371}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "episodes_total": 12583, "training_iteration": 60, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-06_23-46-33", "timestamp": 1680817593, "time_this_iter_s": 171.03746366500854, "time_total_s": 10257.745299339294, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0147756b20>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01474de8b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 10257.745299339294, "timesteps_since_restore": 0, "iterations_since_restore": 60, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.577049180327869, "ram_util_percent": 24.198360655737694}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.131057645428566, "cur_kl_coeff": 24.631531333923345, "cur_lr": 0.01, "total_loss": 0.7890881015748907, "policy_loss": 0.003068286346732288, "vf_loss": 0.4209036346805352, "vf_explained_var": 0.6372608902633831, "kl": 0.014823121796186852, "entropy": 2.8662988411482946, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 56265.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000}, "sampler_results": {"episode_reward_max": -3.500000000000001, "episode_reward_min": -12.600000000000001, "episode_reward_mean": -4.446938775510206, "episode_len_mean": 20.025510204081634, "episode_media": {}, "episodes_this_iter": 196, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.6, -4.300000000000001, -3.800000000000001, -4.100000000000001, -4.200000000000001, -3.6000000000000005, -11.4, -11.7, -3.9000000000000012, -4.0, -3.6000000000000005, -10.1, -10.2, -11.0, -3.700000000000001, -3.700000000000001, -3.8000000000000007, -3.900000000000001, -3.6000000000000005, -10.6, -4.000000000000002, -10.2, -3.9000000000000012, -10.5, -10.4, -10.2, -4.000000000000001, -4.000000000000001, -4.1000000000000005, -4.0, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000002, -3.8000000000000007, -4.000000000000002, -3.9000000000000012, -4.1000000000000005, -3.7000000000000006, -3.800000000000001, -4.000000000000002, -3.900000000000001, -3.8000000000000003, -3.8000000000000007, -3.6000000000000005, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -3.9000000000000004, -4.000000000000001, -4.200000000000001, -3.9000000000000012, -3.9000000000000012, -4.0, -3.800000000000001, -3.700000000000001, -3.700000000000001, -3.7000000000000006, -3.8000000000000007, -4.1000000000000005, -3.8000000000000007, -4.200000000000001, -3.7000000000000006, -4.0, -3.700000000000001, -3.7000000000000006, -4.000000000000001, -3.8000000000000007, -3.9000000000000004, -3.800000000000001, -4.0, -3.8000000000000007, -3.9000000000000012, -4.100000000000001, -3.800000000000001, -3.8000000000000003, -3.9000000000000004, -4.200000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -3.6000000000000005, -3.500000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.9000000000000004, -3.700000000000001, -3.900000000000001, -3.6000000000000005, -4.000000000000001, -3.900000000000001, -3.7000000000000006, -3.7000000000000006, -12.600000000000001, -3.700000000000001, -3.900000000000001, -3.8000000000000007, -10.7, -4.000000000000001, -3.7000000000000006, -3.9000000000000004, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -3.9000000000000004, -4.200000000000001, -3.800000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -3.7000000000000006, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -3.9000000000000012, -4.000000000000001, -3.800000000000001, -3.800000000000001, -3.8000000000000007, -4.100000000000001, -3.7000000000000006, -3.900000000000001, -4.100000000000001, -3.7000000000000006, -3.900000000000001, -4.1000000000000005, -3.8000000000000007, -3.9000000000000004, -3.9000000000000012, -4.4, -3.900000000000001, -3.800000000000001, -3.7000000000000006, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -4.300000000000001, -4.200000000000001, -12.2, -4.200000000000001, -3.7000000000000006, -4.0, -4.000000000000001, -3.800000000000001, -3.900000000000001, -3.8000000000000007, -3.800000000000001, -4.000000000000002, -4.300000000000001, -3.800000000000001, -4.000000000000002, -4.0, -3.900000000000001, -4.300000000000001, -3.6000000000000005, -3.900000000000001, -4.100000000000001, -4.100000000000001, -3.7000000000000006, -12.0, -3.9000000000000012, -4.000000000000001, -4.300000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -3.7000000000000006, -3.9000000000000004, -3.800000000000001, -4.200000000000001, -3.900000000000001, -4.100000000000001, -3.9000000000000012, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -3.800000000000001], "episode_lengths": [6, 21, 21, 21, 21, 21, 10, 14, 21, 21, 21, 2, 3, 9, 21, 21, 21, 21, 21, 7, 21, 3, 21, 5, 4, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.709729750915265, "mean_inference_ms": 18.236482003329346, "mean_action_processing_ms": 0.9493957063344364, "mean_env_wait_ms": 1.6775721194908328, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07888735557089047, "StateBufferConnector_ms": 0.010387994805160833, "ViewRequirementAgentConnector_ms": 0.14532658518577107}}, "episode_reward_max": -3.500000000000001, "episode_reward_min": -12.600000000000001, "episode_reward_mean": -4.446938775510206, "episode_len_mean": 20.025510204081634, "episodes_this_iter": 196, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10.6, -4.300000000000001, -3.800000000000001, -4.100000000000001, -4.200000000000001, -3.6000000000000005, -11.4, -11.7, -3.9000000000000012, -4.0, -3.6000000000000005, -10.1, -10.2, -11.0, -3.700000000000001, -3.700000000000001, -3.8000000000000007, -3.900000000000001, -3.6000000000000005, -10.6, -4.000000000000002, -10.2, -3.9000000000000012, -10.5, -10.4, -10.2, -4.000000000000001, -4.000000000000001, -4.1000000000000005, -4.0, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000002, -3.8000000000000007, -4.000000000000002, -3.9000000000000012, -4.1000000000000005, -3.7000000000000006, -3.800000000000001, -4.000000000000002, -3.900000000000001, -3.8000000000000003, -3.8000000000000007, -3.6000000000000005, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -3.9000000000000004, -4.000000000000001, -4.200000000000001, -3.9000000000000012, -3.9000000000000012, -4.0, -3.800000000000001, -3.700000000000001, -3.700000000000001, -3.7000000000000006, -3.8000000000000007, -4.1000000000000005, -3.8000000000000007, -4.200000000000001, -3.7000000000000006, -4.0, -3.700000000000001, -3.7000000000000006, -4.000000000000001, -3.8000000000000007, -3.9000000000000004, -3.800000000000001, -4.0, -3.8000000000000007, -3.9000000000000012, -4.100000000000001, -3.800000000000001, -3.8000000000000003, -3.9000000000000004, -4.200000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -3.6000000000000005, -3.500000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.9000000000000004, -3.700000000000001, -3.900000000000001, -3.6000000000000005, -4.000000000000001, -3.900000000000001, -3.7000000000000006, -3.7000000000000006, -12.600000000000001, -3.700000000000001, -3.900000000000001, -3.8000000000000007, -10.7, -4.000000000000001, -3.7000000000000006, -3.9000000000000004, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -3.9000000000000004, -4.200000000000001, -3.800000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -3.7000000000000006, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -3.9000000000000012, -4.000000000000001, -3.800000000000001, -3.800000000000001, -3.8000000000000007, -4.100000000000001, -3.7000000000000006, -3.900000000000001, -4.100000000000001, -3.7000000000000006, -3.900000000000001, -4.1000000000000005, -3.8000000000000007, -3.9000000000000004, -3.9000000000000012, -4.4, -3.900000000000001, -3.800000000000001, -3.7000000000000006, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -4.300000000000001, -4.200000000000001, -12.2, -4.200000000000001, -3.7000000000000006, -4.0, -4.000000000000001, -3.800000000000001, -3.900000000000001, -3.8000000000000007, -3.800000000000001, -4.000000000000002, -4.300000000000001, -3.800000000000001, -4.000000000000002, -4.0, -3.900000000000001, -4.300000000000001, -3.6000000000000005, -3.900000000000001, -4.100000000000001, -4.100000000000001, -3.7000000000000006, -12.0, -3.9000000000000012, -4.000000000000001, -4.300000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -3.7000000000000006, -3.9000000000000004, -3.800000000000001, -4.200000000000001, -3.900000000000001, -4.100000000000001, -3.9000000000000012, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -3.800000000000001], "episode_lengths": [6, 21, 21, 21, 21, 21, 10, 14, 21, 21, 21, 2, 3, 9, 21, 21, 21, 21, 21, 7, 21, 3, 21, 5, 4, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.709729750915265, "mean_inference_ms": 18.236482003329346, "mean_action_processing_ms": 0.9493957063344364, "mean_env_wait_ms": 1.6775721194908328, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07888735557089047, "StateBufferConnector_ms": 0.010387994805160833, "ViewRequirementAgentConnector_ms": 0.14532658518577107}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 244000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 244000, "timers": {"training_iteration_time_ms": 170962.545, "load_time_ms": 1.162, "load_throughput": 3442963.328, "learn_time_ms": 170004.935, "learn_throughput": 23.529, "synch_weights_time_ms": 177.07}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000}, "done": false, "episodes_total": 12779, "training_iteration": 61, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-06_23-49-24", "timestamp": 1680817764, "time_this_iter_s": 170.63650560379028, "time_total_s": 10428.381804943085, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0147659130>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01474cb700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 10428.381804943085, "timesteps_since_restore": 0, "iterations_since_restore": 61, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.342148760330579, "ram_util_percent": 24.149173553719002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.563012139258847, "cur_kl_coeff": 24.631531333923345, "cur_lr": 0.01, "total_loss": 0.5641725762637072, "policy_loss": 0.0013672241208804471, "vf_loss": 0.4249413351097735, "vf_explained_var": 0.60321553227722, "kl": 0.005597054242921282, "entropy": 2.897377836063344, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 57195.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000}, "sampler_results": {"episode_reward_max": -3.5000000000000004, "episode_reward_min": -13.0, "episode_reward_mean": -4.445544554455447, "episode_len_mean": 20.193069306930692, "episode_media": {}, "episodes_this_iter": 202, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.500000000000001, -3.800000000000001, -13.0, -4.000000000000001, -10.2, -11.1, -3.8000000000000007, -11.8, -4.300000000000001, -11.4, -3.900000000000001, -3.700000000000001, -10.3, -3.900000000000001, -4.200000000000001, -3.900000000000001, -3.7000000000000006, -10.3, -3.900000000000001, -3.800000000000001, -10.3, -3.6000000000000005, -3.900000000000001, -10.8, -3.8000000000000007, -3.800000000000001, -4.000000000000001, -4.200000000000001, -3.8000000000000007, -3.9000000000000012, -3.700000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.1000000000000005, -3.7000000000000006, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000002, -3.900000000000001, -4.100000000000001, -4.300000000000001, -4.200000000000001, -3.900000000000001, -11.6, -3.8000000000000007, -4.100000000000001, -3.9000000000000004, -11.0, -4.000000000000001, -4.000000000000001, -4.200000000000001, -3.7000000000000006, -3.800000000000001, -4.0, -3.8000000000000007, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -4.1000000000000005, -4.000000000000001, -3.8000000000000003, -3.600000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -3.600000000000001, -3.900000000000001, -3.7000000000000006, -3.5000000000000004, -3.900000000000001, -3.8000000000000007, -3.9000000000000012, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.800000000000001, -3.800000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -3.9000000000000004, -4.200000000000001, -3.900000000000001, -4.0, -4.200000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.800000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000002, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000002, -4.000000000000001, -10.5, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.500000000000001, -4.300000000000001, -4.0, -3.7000000000000006, -3.6000000000000005, -3.800000000000001, -3.900000000000001, -3.7000000000000006, -4.0, -3.700000000000001, -4.200000000000001, -4.200000000000001, -4.000000000000001, -4.200000000000001, -3.8000000000000007, -3.900000000000001, -4.0, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.300000000000001, -4.1000000000000005, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -4.100000000000001, -4.000000000000002, -4.000000000000001, -4.100000000000001, -3.9000000000000012, -4.1000000000000005, -3.900000000000001, -3.600000000000001, -4.000000000000002, -3.9000000000000012, -3.800000000000001, -4.000000000000002, -3.9000000000000012, -4.000000000000002, -3.800000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -12.4, -4.100000000000001, -4.000000000000001, -4.300000000000002, -4.200000000000001, -3.8000000000000003, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000002, -3.9000000000000004, -3.8000000000000007, -3.800000000000001, -4.000000000000001, -3.500000000000001, -3.8000000000000007, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -3.8000000000000003, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.6000000000000005, -4.100000000000001, -4.100000000000001, -11.0, -3.600000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -4.300000000000001, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -3.9000000000000012, -3.8000000000000007, -4.100000000000001, -3.800000000000001, -3.800000000000001, -4.000000000000002], "episode_lengths": [21, 21, 20, 21, 3, 10, 21, 12, 21, 11, 21, 21, 4, 21, 21, 21, 21, 4, 21, 21, 4, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.700057649364005, "mean_inference_ms": 18.20689391981801, "mean_action_processing_ms": 0.9484323185113219, "mean_env_wait_ms": 1.667542887696882, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07372020494819868, "StateBufferConnector_ms": 0.009600242765823214, "ViewRequirementAgentConnector_ms": 0.13643998910885047}}, "episode_reward_max": -3.5000000000000004, "episode_reward_min": -13.0, "episode_reward_mean": -4.445544554455447, "episode_len_mean": 20.193069306930692, "episodes_this_iter": 202, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.500000000000001, -3.800000000000001, -13.0, -4.000000000000001, -10.2, -11.1, -3.8000000000000007, -11.8, -4.300000000000001, -11.4, -3.900000000000001, -3.700000000000001, -10.3, -3.900000000000001, -4.200000000000001, -3.900000000000001, -3.7000000000000006, -10.3, -3.900000000000001, -3.800000000000001, -10.3, -3.6000000000000005, -3.900000000000001, -10.8, -3.8000000000000007, -3.800000000000001, -4.000000000000001, -4.200000000000001, -3.8000000000000007, -3.9000000000000012, -3.700000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.1000000000000005, -3.7000000000000006, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000002, -3.900000000000001, -4.100000000000001, -4.300000000000001, -4.200000000000001, -3.900000000000001, -11.6, -3.8000000000000007, -4.100000000000001, -3.9000000000000004, -11.0, -4.000000000000001, -4.000000000000001, -4.200000000000001, -3.7000000000000006, -3.800000000000001, -4.0, -3.8000000000000007, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -4.1000000000000005, -4.000000000000001, -3.8000000000000003, -3.600000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -3.600000000000001, -3.900000000000001, -3.7000000000000006, -3.5000000000000004, -3.900000000000001, -3.8000000000000007, -3.9000000000000012, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.800000000000001, -3.800000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -3.9000000000000004, -4.200000000000001, -3.900000000000001, -4.0, -4.200000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.800000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000002, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000002, -4.000000000000001, -10.5, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.500000000000001, -4.300000000000001, -4.0, -3.7000000000000006, -3.6000000000000005, -3.800000000000001, -3.900000000000001, -3.7000000000000006, -4.0, -3.700000000000001, -4.200000000000001, -4.200000000000001, -4.000000000000001, -4.200000000000001, -3.8000000000000007, -3.900000000000001, -4.0, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.300000000000001, -4.1000000000000005, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -4.100000000000001, -4.000000000000002, -4.000000000000001, -4.100000000000001, -3.9000000000000012, -4.1000000000000005, -3.900000000000001, -3.600000000000001, -4.000000000000002, -3.9000000000000012, -3.800000000000001, -4.000000000000002, -3.9000000000000012, -4.000000000000002, -3.800000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -12.4, -4.100000000000001, -4.000000000000001, -4.300000000000002, -4.200000000000001, -3.8000000000000003, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000002, -3.9000000000000004, -3.8000000000000007, -3.800000000000001, -4.000000000000001, -3.500000000000001, -3.8000000000000007, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -3.8000000000000003, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.6000000000000005, -4.100000000000001, -4.100000000000001, -11.0, -3.600000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -4.300000000000001, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -3.9000000000000012, -3.8000000000000007, -4.100000000000001, -3.800000000000001, -3.800000000000001, -4.000000000000002], "episode_lengths": [21, 21, 20, 21, 3, 10, 21, 12, 21, 11, 21, 21, 4, 21, 21, 21, 21, 4, 21, 21, 4, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.700057649364005, "mean_inference_ms": 18.20689391981801, "mean_action_processing_ms": 0.9484323185113219, "mean_env_wait_ms": 1.667542887696882, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07372020494819868, "StateBufferConnector_ms": 0.009600242765823214, "ViewRequirementAgentConnector_ms": 0.13643998910885047}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 248000, "timers": {"training_iteration_time_ms": 170962.926, "load_time_ms": 1.187, "load_throughput": 3370610.949, "learn_time_ms": 170011.848, "learn_throughput": 23.528, "synch_weights_time_ms": 178.52}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000}, "done": false, "episodes_total": 12981, "training_iteration": 62, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-06_23-52-15", "timestamp": 1680817935, "time_this_iter_s": 170.97751021385193, "time_total_s": 10599.359315156937, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0147659ca0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01475ec9d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 10599.359315156937, "timesteps_since_restore": 0, "iterations_since_restore": 62, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.383196721311475, "ram_util_percent": 24.19754098360655}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.431720950270211, "cur_kl_coeff": 24.631531333923345, "cur_lr": 0.01, "total_loss": 0.48336647972464564, "policy_loss": 1.994267516639284e-05, "vf_loss": 0.27200483239946827, "vf_explained_var": 0.6132033640338529, "kl": 0.00858012872437636, "entropy": 2.886065557695204, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 58125.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "sampler_results": {"episode_reward_max": -3.5000000000000004, "episode_reward_min": -11.7, "episode_reward_mean": -4.145408163265308, "episode_len_mean": 20.4234693877551, "episode_media": {}, "episodes_this_iter": 196, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.000000000000001, -3.900000000000001, -10.4, -4.000000000000001, -4.200000000000001, -4.000000000000001, -3.800000000000001, -3.800000000000001, -3.900000000000001, -10.9, -3.6000000000000005, -3.900000000000001, -10.1, -3.8000000000000007, -3.5000000000000004, -3.900000000000001, -3.8000000000000007, -3.6000000000000005, -4.1000000000000005, -3.8000000000000003, -10.4, -3.800000000000001, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -4.0, -4.000000000000001, -4.100000000000001, -3.9000000000000012, -4.100000000000001, -4.100000000000001, -3.700000000000001, -4.000000000000002, -4.000000000000002, -4.100000000000001, -3.900000000000001, -3.500000000000001, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -4.200000000000001, -4.000000000000001, -4.000000000000002, -3.9000000000000012, -4.100000000000001, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -3.6000000000000005, -3.9000000000000012, -4.000000000000001, -4.0, -4.200000000000001, -3.7000000000000006, -4.000000000000001, -4.0, -3.7000000000000006, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.7000000000000006, -4.000000000000002, -4.000000000000001, -4.500000000000001, -3.7000000000000006, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.7000000000000006, -4.200000000000001, -3.5000000000000004, -3.8000000000000007, -4.000000000000002, -4.300000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.9000000000000012, -4.000000000000002, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.6000000000000005, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -3.9000000000000012, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -4.200000000000001, -3.9000000000000012, -3.700000000000001, -10.1, -3.900000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -3.5000000000000004, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -3.500000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -4.100000000000001, -3.9000000000000012, -3.8000000000000007, -3.9000000000000012, -3.900000000000001, -3.900000000000001, -3.800000000000001, -3.800000000000001, -3.6000000000000005, -4.000000000000001, -3.9000000000000012, -3.800000000000001, -3.900000000000001, -3.8000000000000007, -3.7000000000000006, -3.6000000000000005, -3.9000000000000012, -3.900000000000001, -4.100000000000001, -3.800000000000001, -3.700000000000001, -4.000000000000001, -3.8000000000000007, -4.300000000000001, -4.200000000000001, -11.7, -3.900000000000001, -3.8000000000000007, -4.200000000000001, -4.100000000000001, -10.0, -3.6000000000000005, -3.800000000000001, -3.8000000000000007, -4.000000000000002, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -3.6000000000000005, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -3.8000000000000007, -4.200000000000001, -4.100000000000001, -3.800000000000001, -4.000000000000001, -3.6000000000000005, -3.700000000000001, -4.1000000000000005, -3.800000000000001, -3.800000000000001, -3.900000000000001, -3.8000000000000003, -4.000000000000001, -4.200000000000001, -3.700000000000001, -4.1000000000000005, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000003, -4.100000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -3.800000000000001, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -3.9000000000000012, -4.000000000000002, -3.5000000000000004, -3.8000000000000007], "episode_lengths": [21, 21, 5, 21, 21, 21, 21, 21, 21, 8, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.69764471411383, "mean_inference_ms": 18.19931300120253, "mean_action_processing_ms": 0.9478383253032371, "mean_env_wait_ms": 1.6641968223318526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0704371199315908, "StateBufferConnector_ms": 0.009095790434856805, "ViewRequirementAgentConnector_ms": 0.13016620460821657}}, "episode_reward_max": -3.5000000000000004, "episode_reward_min": -11.7, "episode_reward_mean": -4.145408163265308, "episode_len_mean": 20.4234693877551, "episodes_this_iter": 196, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.000000000000001, -3.900000000000001, -10.4, -4.000000000000001, -4.200000000000001, -4.000000000000001, -3.800000000000001, -3.800000000000001, -3.900000000000001, -10.9, -3.6000000000000005, -3.900000000000001, -10.1, -3.8000000000000007, -3.5000000000000004, -3.900000000000001, -3.8000000000000007, -3.6000000000000005, -4.1000000000000005, -3.8000000000000003, -10.4, -3.800000000000001, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -4.0, -4.000000000000001, -4.100000000000001, -3.9000000000000012, -4.100000000000001, -4.100000000000001, -3.700000000000001, -4.000000000000002, -4.000000000000002, -4.100000000000001, -3.900000000000001, -3.500000000000001, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -4.200000000000001, -4.000000000000001, -4.000000000000002, -3.9000000000000012, -4.100000000000001, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -3.6000000000000005, -3.9000000000000012, -4.000000000000001, -4.0, -4.200000000000001, -3.7000000000000006, -4.000000000000001, -4.0, -3.7000000000000006, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.7000000000000006, -4.000000000000002, -4.000000000000001, -4.500000000000001, -3.7000000000000006, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.7000000000000006, -4.200000000000001, -3.5000000000000004, -3.8000000000000007, -4.000000000000002, -4.300000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.9000000000000012, -4.000000000000002, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.6000000000000005, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -3.9000000000000012, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -4.200000000000001, -3.9000000000000012, -3.700000000000001, -10.1, -3.900000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -3.5000000000000004, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -3.500000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -4.100000000000001, -3.9000000000000012, -3.8000000000000007, -3.9000000000000012, -3.900000000000001, -3.900000000000001, -3.800000000000001, -3.800000000000001, -3.6000000000000005, -4.000000000000001, -3.9000000000000012, -3.800000000000001, -3.900000000000001, -3.8000000000000007, -3.7000000000000006, -3.6000000000000005, -3.9000000000000012, -3.900000000000001, -4.100000000000001, -3.800000000000001, -3.700000000000001, -4.000000000000001, -3.8000000000000007, -4.300000000000001, -4.200000000000001, -11.7, -3.900000000000001, -3.8000000000000007, -4.200000000000001, -4.100000000000001, -10.0, -3.6000000000000005, -3.800000000000001, -3.8000000000000007, -4.000000000000002, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -3.6000000000000005, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -3.8000000000000007, -4.200000000000001, -4.100000000000001, -3.800000000000001, -4.000000000000001, -3.6000000000000005, -3.700000000000001, -4.1000000000000005, -3.800000000000001, -3.800000000000001, -3.900000000000001, -3.8000000000000003, -4.000000000000001, -4.200000000000001, -3.700000000000001, -4.1000000000000005, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000003, -4.100000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -3.800000000000001, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -3.9000000000000012, -4.000000000000002, -3.5000000000000004, -3.8000000000000007], "episode_lengths": [21, 21, 5, 21, 21, 21, 21, 21, 21, 8, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.69764471411383, "mean_inference_ms": 18.19931300120253, "mean_action_processing_ms": 0.9478383253032371, "mean_env_wait_ms": 1.6641968223318526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0704371199315908, "StateBufferConnector_ms": 0.009095790434856805, "ViewRequirementAgentConnector_ms": 0.13016620460821657}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 252000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 252000, "timers": {"training_iteration_time_ms": 170862.856, "load_time_ms": 1.192, "load_throughput": 3355241.885, "learn_time_ms": 169908.162, "learn_throughput": 23.542, "synch_weights_time_ms": 181.493}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "done": false, "episodes_total": 13177, "training_iteration": 63, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-06_23-55-06", "timestamp": 1680818106, "time_this_iter_s": 170.47500777244568, "time_total_s": 10769.834322929382, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01474086d0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01473d8e50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 10769.834322929382, "timesteps_since_restore": 0, "iterations_since_restore": 63, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.404958677685951, "ram_util_percent": 24.199586776859494}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.894417896322025, "cur_kl_coeff": 24.631531333923345, "cur_lr": 0.01, "total_loss": 0.5597810443190318, "policy_loss": 0.0015756193728696916, "vf_loss": 0.3559222286026324, "vf_explained_var": 0.6425058502022938, "kl": 0.008212368171762234, "entropy": 2.900186558179958, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 59055.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "sampler_results": {"episode_reward_max": -3.500000000000001, "episode_reward_min": -12.600000000000001, "episode_reward_mean": -4.391584158415842, "episode_len_mean": 20.064356435643564, "episode_media": {}, "episodes_this_iter": 202, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.5, -11.7, -10.2, -3.6000000000000005, -3.7000000000000006, -3.900000000000001, -4.0, -10.7, -10.4, -3.600000000000001, -11.5, -10.8, -3.800000000000001, -4.000000000000001, -4.000000000000001, -3.700000000000001, -4.000000000000002, -4.000000000000002, -3.600000000000001, -3.7000000000000006, -11.5, -3.7000000000000006, -10.2, -4.000000000000001, -4.000000000000002, -10.1, -3.6000000000000005, -3.900000000000001, -3.700000000000001, -3.900000000000001, -4.200000000000001, -4.100000000000001, -3.800000000000001, -3.9000000000000012, -10.5, -4.000000000000001, -3.900000000000001, -3.9000000000000012, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -3.800000000000001, -4.200000000000001, -3.700000000000001, -3.9000000000000004, -3.8000000000000007, -3.800000000000001, -3.7000000000000006, -4.000000000000002, -3.9000000000000012, -3.800000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -12.600000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -3.9000000000000012, -4.100000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -4.1000000000000005, -4.100000000000001, -3.800000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.200000000000001, -3.8000000000000007, -4.000000000000001, -3.800000000000001, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -3.7000000000000006, -4.100000000000001, -4.200000000000001, -4.300000000000001, -3.9000000000000012, -4.000000000000001, -3.8000000000000007, -4.200000000000001, -3.7000000000000006, -3.7000000000000006, -3.8000000000000007, -4.000000000000001, -4.000000000000002, -4.000000000000001, -4.000000000000001, -3.700000000000001, -3.8000000000000007, -3.7000000000000006, -3.7000000000000006, -4.000000000000001, -3.6000000000000005, -10.6, -4.000000000000001, -3.700000000000001, -3.800000000000001, -3.8000000000000007, -3.500000000000001, -4.000000000000002, -10.5, -3.700000000000001, -3.900000000000001, -4.000000000000002, -3.900000000000001, -3.600000000000001, -4.100000000000001, -3.500000000000001, -4.1000000000000005, -3.7000000000000006, -3.7000000000000006, -3.900000000000001, -4.1000000000000005, -4.100000000000001, -3.800000000000001, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -4.000000000000002, -4.500000000000002, -3.900000000000001, -3.9000000000000012, -4.100000000000001, -3.600000000000001, -4.100000000000001, -4.200000000000001, -3.900000000000001, -4.0, -3.700000000000001, -4.200000000000001, -3.8000000000000007, -4.000000000000002, -3.800000000000001, -4.100000000000001, -3.6000000000000005, -4.000000000000001, -4.100000000000001, -4.100000000000001, -3.7, -3.600000000000001, -4.0, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -3.7000000000000006, -3.800000000000001, -3.500000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -3.9000000000000012, -4.0, -3.700000000000001, -4.000000000000002, -4.0, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -3.7000000000000006, -4.000000000000001, -3.700000000000001, -3.800000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.200000000000001, -4.200000000000001, -3.900000000000001, -3.900000000000001, -4.200000000000001, -4.100000000000001, -3.600000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.700000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001], "episode_lengths": [5, 13, 3, 21, 21, 21, 21, 6, 5, 21, 12, 8, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 3, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.704887595302631, "mean_inference_ms": 18.221068808494373, "mean_action_processing_ms": 0.9474204987281302, "mean_env_wait_ms": 1.6665500371722481, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07945145710860149, "StateBufferConnector_ms": 0.01022768492745881, "ViewRequirementAgentConnector_ms": 0.14321402748032372}}, "episode_reward_max": -3.500000000000001, "episode_reward_min": -12.600000000000001, "episode_reward_mean": -4.391584158415842, "episode_len_mean": 20.064356435643564, "episodes_this_iter": 202, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10.5, -11.7, -10.2, -3.6000000000000005, -3.7000000000000006, -3.900000000000001, -4.0, -10.7, -10.4, -3.600000000000001, -11.5, -10.8, -3.800000000000001, -4.000000000000001, -4.000000000000001, -3.700000000000001, -4.000000000000002, -4.000000000000002, -3.600000000000001, -3.7000000000000006, -11.5, -3.7000000000000006, -10.2, -4.000000000000001, -4.000000000000002, -10.1, -3.6000000000000005, -3.900000000000001, -3.700000000000001, -3.900000000000001, -4.200000000000001, -4.100000000000001, -3.800000000000001, -3.9000000000000012, -10.5, -4.000000000000001, -3.900000000000001, -3.9000000000000012, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -3.800000000000001, -4.200000000000001, -3.700000000000001, -3.9000000000000004, -3.8000000000000007, -3.800000000000001, -3.7000000000000006, -4.000000000000002, -3.9000000000000012, -3.800000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -12.600000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -3.9000000000000012, -4.100000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -4.1000000000000005, -4.100000000000001, -3.800000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.200000000000001, -3.8000000000000007, -4.000000000000001, -3.800000000000001, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -3.7000000000000006, -4.100000000000001, -4.200000000000001, -4.300000000000001, -3.9000000000000012, -4.000000000000001, -3.8000000000000007, -4.200000000000001, -3.7000000000000006, -3.7000000000000006, -3.8000000000000007, -4.000000000000001, -4.000000000000002, -4.000000000000001, -4.000000000000001, -3.700000000000001, -3.8000000000000007, -3.7000000000000006, -3.7000000000000006, -4.000000000000001, -3.6000000000000005, -10.6, -4.000000000000001, -3.700000000000001, -3.800000000000001, -3.8000000000000007, -3.500000000000001, -4.000000000000002, -10.5, -3.700000000000001, -3.900000000000001, -4.000000000000002, -3.900000000000001, -3.600000000000001, -4.100000000000001, -3.500000000000001, -4.1000000000000005, -3.7000000000000006, -3.7000000000000006, -3.900000000000001, -4.1000000000000005, -4.100000000000001, -3.800000000000001, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -4.000000000000002, -4.500000000000002, -3.900000000000001, -3.9000000000000012, -4.100000000000001, -3.600000000000001, -4.100000000000001, -4.200000000000001, -3.900000000000001, -4.0, -3.700000000000001, -4.200000000000001, -3.8000000000000007, -4.000000000000002, -3.800000000000001, -4.100000000000001, -3.6000000000000005, -4.000000000000001, -4.100000000000001, -4.100000000000001, -3.7, -3.600000000000001, -4.0, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -3.7000000000000006, -3.800000000000001, -3.500000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -3.9000000000000012, -4.0, -3.700000000000001, -4.000000000000002, -4.0, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -3.7000000000000006, -4.000000000000001, -3.700000000000001, -3.800000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.200000000000001, -4.200000000000001, -3.900000000000001, -3.900000000000001, -4.200000000000001, -4.100000000000001, -3.600000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.700000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001], "episode_lengths": [5, 13, 3, 21, 21, 21, 21, 6, 5, 21, 12, 8, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 3, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.704887595302631, "mean_inference_ms": 18.221068808494373, "mean_action_processing_ms": 0.9474204987281302, "mean_env_wait_ms": 1.6665500371722481, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07945145710860149, "StateBufferConnector_ms": 0.01022768492745881, "ViewRequirementAgentConnector_ms": 0.14321402748032372}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 170852.474, "load_time_ms": 1.144, "load_throughput": 3496564.545, "learn_time_ms": 169893.01, "learn_throughput": 23.544, "synch_weights_time_ms": 179.778}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "done": false, "episodes_total": 13379, "training_iteration": 64, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-06_23-57-56", "timestamp": 1680818276, "time_this_iter_s": 170.80686450004578, "time_total_s": 10940.641187429428, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476cbee0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0147520700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 10940.641187429428, "timesteps_since_restore": 0, "iterations_since_restore": 64, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.512345679012346, "ram_util_percent": 24.19999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.074106187846072, "cur_kl_coeff": 24.631531333923345, "cur_lr": 0.01, "total_loss": 0.8205213415466489, "policy_loss": 0.003304083964797438, "vf_loss": 0.4496070432326486, "vf_explained_var": 0.628388552575983, "kl": 0.014924375622336733, "entropy": 2.9013898552104993, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 59985.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000}, "sampler_results": {"episode_reward_max": -3.5000000000000004, "episode_reward_min": -12.5, "episode_reward_mean": -4.601904761904763, "episode_len_mean": 19.60952380952381, "episode_media": {}, "episodes_this_iter": 210, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.000000000000001, -3.900000000000001, -3.8000000000000007, -10.7, -3.9000000000000004, -3.900000000000001, -10.5, -3.900000000000001, -11.0, -4.0, -10.4, -3.8000000000000007, -3.9000000000000012, -10.5, -10.4, -10.4, -10.2, -10.6, -3.600000000000001, -10.1, -3.8000000000000007, -3.8000000000000007, -10.5, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -10.2, -10.1, -10.1, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.200000000000001, -3.700000000000001, -4.000000000000002, -4.100000000000001, -4.000000000000002, -4.0, -3.600000000000001, -4.000000000000001, -4.300000000000001, -3.9000000000000012, -4.000000000000002, -3.9000000000000012, -3.6000000000000005, -4.000000000000001, -4.100000000000001, -4.000000000000002, -10.9, -4.100000000000001, -3.900000000000001, -4.100000000000001, -11.7, -3.800000000000001, -4.0, -3.8000000000000007, -4.100000000000001, -3.500000000000001, -4.100000000000001, -10.4, -3.9000000000000012, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.700000000000001, -3.800000000000001, -3.800000000000001, -4.100000000000001, -3.9000000000000012, -4.0, -4.0, -3.900000000000001, -3.900000000000001, -3.800000000000001, -3.7000000000000006, -3.8000000000000007, -4.1000000000000005, -4.000000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -4.0, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -4.100000000000001, -3.800000000000001, -4.1000000000000005, -3.9000000000000012, -4.000000000000001, -4.200000000000001, -4.200000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -4.500000000000001, -3.6000000000000005, -4.100000000000001, -3.8000000000000007, -4.1000000000000005, -3.800000000000001, -3.9000000000000012, -4.100000000000001, -3.8000000000000007, -4.300000000000001, -4.000000000000002, -3.7, -3.900000000000001, -3.900000000000001, -3.6000000000000005, -12.2, -3.6000000000000005, -3.8000000000000003, -3.800000000000001, -11.6, -3.800000000000001, -4.100000000000001, -10.9, -3.900000000000001, -3.8000000000000007, -3.800000000000001, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -3.7000000000000006, -4.000000000000001, -4.4, -3.900000000000001, -3.800000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.6000000000000005, -3.6000000000000005, -4.1000000000000005, -3.500000000000001, -3.900000000000001, -4.200000000000001, -3.900000000000001, -4.100000000000001, -3.600000000000001, -4.100000000000001, -4.000000000000002, -4.000000000000001, -4.200000000000001, -3.8000000000000007, -3.7000000000000006, -4.300000000000001, -3.9000000000000012, -3.600000000000001, -4.200000000000001, -3.900000000000001, -3.800000000000001, -4.000000000000002, -4.1000000000000005, -4.100000000000001, -3.7000000000000006, -4.200000000000001, -4.100000000000001, -3.9000000000000012, -3.5000000000000004, -4.100000000000001, -4.000000000000002, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -3.8000000000000003, -3.700000000000001, -3.8000000000000003, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -3.9000000000000004, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -3.9000000000000004, -4.200000000000001, -3.900000000000001, -4.100000000000001, -3.9000000000000012, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -3.8000000000000003, -4.0, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.9000000000000012, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000002, -3.6000000000000005, -12.5, -3.800000000000001, -3.6000000000000005, -3.6000000000000005, -3.900000000000001, -4.000000000000001, -4.0, -3.900000000000001], "episode_lengths": [21, 21, 21, 7, 21, 21, 6, 21, 8, 21, 5, 21, 21, 6, 5, 4, 3, 7, 21, 2, 21, 21, 6, 21, 21, 21, 3, 2, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 12, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.709897972655101, "mean_inference_ms": 18.222518493610732, "mean_action_processing_ms": 0.9471705514791876, "mean_env_wait_ms": 1.6664250189081424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07243565150669642, "StateBufferConnector_ms": 0.009942395346505302, "ViewRequirementAgentConnector_ms": 0.13598578316824778}}, "episode_reward_max": -3.5000000000000004, "episode_reward_min": -12.5, "episode_reward_mean": -4.601904761904763, "episode_len_mean": 19.60952380952381, "episodes_this_iter": 210, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.000000000000001, -3.900000000000001, -3.8000000000000007, -10.7, -3.9000000000000004, -3.900000000000001, -10.5, -3.900000000000001, -11.0, -4.0, -10.4, -3.8000000000000007, -3.9000000000000012, -10.5, -10.4, -10.4, -10.2, -10.6, -3.600000000000001, -10.1, -3.8000000000000007, -3.8000000000000007, -10.5, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -10.2, -10.1, -10.1, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.200000000000001, -3.700000000000001, -4.000000000000002, -4.100000000000001, -4.000000000000002, -4.0, -3.600000000000001, -4.000000000000001, -4.300000000000001, -3.9000000000000012, -4.000000000000002, -3.9000000000000012, -3.6000000000000005, -4.000000000000001, -4.100000000000001, -4.000000000000002, -10.9, -4.100000000000001, -3.900000000000001, -4.100000000000001, -11.7, -3.800000000000001, -4.0, -3.8000000000000007, -4.100000000000001, -3.500000000000001, -4.100000000000001, -10.4, -3.9000000000000012, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.700000000000001, -3.800000000000001, -3.800000000000001, -4.100000000000001, -3.9000000000000012, -4.0, -4.0, -3.900000000000001, -3.900000000000001, -3.800000000000001, -3.7000000000000006, -3.8000000000000007, -4.1000000000000005, -4.000000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -4.0, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -4.100000000000001, -3.800000000000001, -4.1000000000000005, -3.9000000000000012, -4.000000000000001, -4.200000000000001, -4.200000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -4.500000000000001, -3.6000000000000005, -4.100000000000001, -3.8000000000000007, -4.1000000000000005, -3.800000000000001, -3.9000000000000012, -4.100000000000001, -3.8000000000000007, -4.300000000000001, -4.000000000000002, -3.7, -3.900000000000001, -3.900000000000001, -3.6000000000000005, -12.2, -3.6000000000000005, -3.8000000000000003, -3.800000000000001, -11.6, -3.800000000000001, -4.100000000000001, -10.9, -3.900000000000001, -3.8000000000000007, -3.800000000000001, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -3.7000000000000006, -4.000000000000001, -4.4, -3.900000000000001, -3.800000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.6000000000000005, -3.6000000000000005, -4.1000000000000005, -3.500000000000001, -3.900000000000001, -4.200000000000001, -3.900000000000001, -4.100000000000001, -3.600000000000001, -4.100000000000001, -4.000000000000002, -4.000000000000001, -4.200000000000001, -3.8000000000000007, -3.7000000000000006, -4.300000000000001, -3.9000000000000012, -3.600000000000001, -4.200000000000001, -3.900000000000001, -3.800000000000001, -4.000000000000002, -4.1000000000000005, -4.100000000000001, -3.7000000000000006, -4.200000000000001, -4.100000000000001, -3.9000000000000012, -3.5000000000000004, -4.100000000000001, -4.000000000000002, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -3.8000000000000003, -3.700000000000001, -3.8000000000000003, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -3.9000000000000004, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -3.9000000000000004, -4.200000000000001, -3.900000000000001, -4.100000000000001, -3.9000000000000012, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -3.8000000000000003, -4.0, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.9000000000000012, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000002, -3.6000000000000005, -12.5, -3.800000000000001, -3.6000000000000005, -3.6000000000000005, -3.900000000000001, -4.000000000000001, -4.0, -3.900000000000001], "episode_lengths": [21, 21, 21, 7, 21, 21, 6, 21, 8, 21, 5, 21, 21, 6, 5, 4, 3, 7, 21, 2, 21, 21, 6, 21, 21, 21, 3, 2, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 12, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 19, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.709897972655101, "mean_inference_ms": 18.222518493610732, "mean_action_processing_ms": 0.9471705514791876, "mean_env_wait_ms": 1.6664250189081424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07243565150669642, "StateBufferConnector_ms": 0.009942395346505302, "ViewRequirementAgentConnector_ms": 0.13598578316824778}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 260000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 260000, "timers": {"training_iteration_time_ms": 170887.158, "load_time_ms": 1.147, "load_throughput": 3486464.537, "learn_time_ms": 169925.183, "learn_throughput": 23.54, "synch_weights_time_ms": 176.33}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000}, "done": false, "episodes_total": 13589, "training_iteration": 65, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_00-00-48", "timestamp": 1680818448, "time_this_iter_s": 171.19134855270386, "time_total_s": 11111.832535982132, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01477a31c0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01473d8e50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 11111.832535982132, "timesteps_since_restore": 0, "iterations_since_restore": 65, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 6.043621399176955, "ram_util_percent": 24.120164609053493}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.148576934875981, "cur_kl_coeff": 24.631531333923345, "cur_lr": 0.01, "total_loss": 0.6166190522813028, "policy_loss": 0.0002248547665814879, "vf_loss": 0.42793729823603427, "vf_explained_var": 0.6616497387809138, "kl": 0.007651042831174138, "entropy": 2.9029782754118725, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 60915.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "sampler_results": {"episode_reward_max": -3.500000000000001, "episode_reward_min": -12.3, "episode_reward_mean": -4.323618090452261, "episode_len_mean": 20.22110552763819, "episode_media": {}, "episodes_this_iter": 199, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.8000000000000007, -10.1, -10.7, -10.8, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.9000000000000012, -10.7, -3.9000000000000004, -10.3, -12.0, -10.8, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -10.3, -3.7000000000000006, -10.2, -3.7000000000000006, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -3.7000000000000006, -11.3, -4.300000000000001, -4.000000000000001, -3.9000000000000012, -3.500000000000001, -4.200000000000001, -4.1000000000000005, -3.7000000000000006, -4.0, -3.9000000000000004, -4.1000000000000005, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -3.9000000000000004, -3.900000000000001, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -4.200000000000001, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -3.800000000000001, -3.6000000000000005, -4.000000000000001, -3.8000000000000007, -3.9000000000000004, -3.7000000000000006, -3.7000000000000006, -3.9000000000000012, -3.8000000000000007, -3.900000000000001, -3.800000000000001, -4.000000000000001, -3.7000000000000006, -3.9000000000000012, -3.700000000000001, -3.900000000000001, -3.8000000000000007, -4.1000000000000005, -3.6000000000000005, -4.000000000000001, -4.000000000000002, -3.700000000000001, -3.7000000000000006, -3.8000000000000007, -3.800000000000001, -3.9000000000000012, -3.9000000000000012, -3.9000000000000012, -3.700000000000001, -4.000000000000001, -3.900000000000001, -3.700000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -4.0, -3.800000000000001, -3.600000000000001, -4.000000000000002, -3.8000000000000007, -3.800000000000001, -4.1000000000000005, -3.800000000000001, -3.7000000000000006, -4.000000000000002, -3.8000000000000007, -3.900000000000001, -3.800000000000001, -4.100000000000001, -3.7000000000000006, -11.7, -3.800000000000001, -3.800000000000001, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -3.9000000000000012, -4.100000000000001, -3.8000000000000003, -4.000000000000001, -3.900000000000001, -3.9000000000000012, -3.7000000000000006, -3.900000000000001, -3.800000000000001, -3.600000000000001, -4.100000000000001, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.9000000000000004, -4.200000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -4.100000000000001, -3.7000000000000006, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -3.700000000000001, -3.9000000000000012, -3.8000000000000007, -4.100000000000001, -3.8000000000000007, -4.200000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -3.9000000000000012, -4.000000000000001, -3.7000000000000006, -3.8000000000000007, -4.200000000000001, -3.9000000000000004, -3.8000000000000007, -4.100000000000001, -3.7000000000000006, -3.8000000000000007, -4.200000000000001, -4.100000000000001, -4.100000000000001, -3.6000000000000005, -3.8000000000000007, -3.9000000000000012, -3.900000000000001, -12.3, -4.000000000000001, -4.1000000000000005, -4.000000000000001, -4.000000000000001, -3.9000000000000004, -3.8000000000000003, -4.100000000000001, -3.900000000000001, -3.600000000000001, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -4.0, -3.7000000000000006, -4.200000000000001, -4.200000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.9000000000000012, -4.000000000000001, -4.0, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.6000000000000005, -4.100000000000001, -4.100000000000001, -3.900000000000001, -3.8000000000000007], "episode_lengths": [21, 2, 7, 8, 21, 21, 21, 21, 7, 21, 4, 14, 7, 21, 21, 21, 4, 21, 3, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.70721330175765, "mean_inference_ms": 18.21922144450994, "mean_action_processing_ms": 0.9478038342434145, "mean_env_wait_ms": 1.6608508800211308, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07832673326808604, "StateBufferConnector_ms": 0.010480113963984964, "ViewRequirementAgentConnector_ms": 0.14465729794909607}}, "episode_reward_max": -3.500000000000001, "episode_reward_min": -12.3, "episode_reward_mean": -4.323618090452261, "episode_len_mean": 20.22110552763819, "episodes_this_iter": 199, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.8000000000000007, -10.1, -10.7, -10.8, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.9000000000000012, -10.7, -3.9000000000000004, -10.3, -12.0, -10.8, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -10.3, -3.7000000000000006, -10.2, -3.7000000000000006, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -3.7000000000000006, -11.3, -4.300000000000001, -4.000000000000001, -3.9000000000000012, -3.500000000000001, -4.200000000000001, -4.1000000000000005, -3.7000000000000006, -4.0, -3.9000000000000004, -4.1000000000000005, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -3.9000000000000004, -3.900000000000001, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -4.200000000000001, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -3.800000000000001, -3.6000000000000005, -4.000000000000001, -3.8000000000000007, -3.9000000000000004, -3.7000000000000006, -3.7000000000000006, -3.9000000000000012, -3.8000000000000007, -3.900000000000001, -3.800000000000001, -4.000000000000001, -3.7000000000000006, -3.9000000000000012, -3.700000000000001, -3.900000000000001, -3.8000000000000007, -4.1000000000000005, -3.6000000000000005, -4.000000000000001, -4.000000000000002, -3.700000000000001, -3.7000000000000006, -3.8000000000000007, -3.800000000000001, -3.9000000000000012, -3.9000000000000012, -3.9000000000000012, -3.700000000000001, -4.000000000000001, -3.900000000000001, -3.700000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -4.0, -3.800000000000001, -3.600000000000001, -4.000000000000002, -3.8000000000000007, -3.800000000000001, -4.1000000000000005, -3.800000000000001, -3.7000000000000006, -4.000000000000002, -3.8000000000000007, -3.900000000000001, -3.800000000000001, -4.100000000000001, -3.7000000000000006, -11.7, -3.800000000000001, -3.800000000000001, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -3.9000000000000012, -4.100000000000001, -3.8000000000000003, -4.000000000000001, -3.900000000000001, -3.9000000000000012, -3.7000000000000006, -3.900000000000001, -3.800000000000001, -3.600000000000001, -4.100000000000001, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.9000000000000004, -4.200000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -4.100000000000001, -3.7000000000000006, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -3.700000000000001, -3.9000000000000012, -3.8000000000000007, -4.100000000000001, -3.8000000000000007, -4.200000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -3.9000000000000012, -4.000000000000001, -3.7000000000000006, -3.8000000000000007, -4.200000000000001, -3.9000000000000004, -3.8000000000000007, -4.100000000000001, -3.7000000000000006, -3.8000000000000007, -4.200000000000001, -4.100000000000001, -4.100000000000001, -3.6000000000000005, -3.8000000000000007, -3.9000000000000012, -3.900000000000001, -12.3, -4.000000000000001, -4.1000000000000005, -4.000000000000001, -4.000000000000001, -3.9000000000000004, -3.8000000000000003, -4.100000000000001, -3.900000000000001, -3.600000000000001, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -4.0, -3.7000000000000006, -4.200000000000001, -4.200000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.9000000000000012, -4.000000000000001, -4.0, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.6000000000000005, -4.100000000000001, -4.100000000000001, -3.900000000000001, -3.8000000000000007], "episode_lengths": [21, 2, 7, 8, 21, 21, 21, 21, 7, 21, 4, 14, 7, 21, 21, 21, 4, 21, 3, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.70721330175765, "mean_inference_ms": 18.21922144450994, "mean_action_processing_ms": 0.9478038342434145, "mean_env_wait_ms": 1.6608508800211308, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07832673326808604, "StateBufferConnector_ms": 0.010480113963984964, "ViewRequirementAgentConnector_ms": 0.14465729794909607}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 264000, "timers": {"training_iteration_time_ms": 170897.696, "load_time_ms": 1.161, "load_throughput": 3443882.092, "learn_time_ms": 169931.184, "learn_throughput": 23.539, "synch_weights_time_ms": 175.675}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "done": false, "episodes_total": 13788, "training_iteration": 66, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_00-03-39", "timestamp": 1680818619, "time_this_iter_s": 170.90383219718933, "time_total_s": 11282.736368179321, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01475699a0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0147464160>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 11282.736368179321, "timesteps_since_restore": 0, "iterations_since_restore": 66, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.714814814814814, "ram_util_percent": 23.99876543209876}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.557155957016894, "cur_kl_coeff": 24.631531333923345, "cur_lr": 0.01, "total_loss": 0.8181533409663105, "policy_loss": 0.000406156907418883, "vf_loss": 0.279480942506944, "vf_explained_var": 0.7390425005907654, "kl": 0.021852732124792846, "entropy": 2.876332548100461, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 61845.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000}, "sampler_results": {"episode_reward_max": -3.4000000000000004, "episode_reward_min": -11.7, "episode_reward_mean": -4.105945945945947, "episode_len_mean": 20.691891891891892, "episode_media": {}, "episodes_this_iter": 185, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.900000000000001, -4.000000000000001, -4.000000000000002, -11.5, -10.6, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -3.9000000000000004, -11.4, -4.000000000000001, -3.9000000000000012, -3.9000000000000004, -3.700000000000001, -3.800000000000001, -4.100000000000001, -3.800000000000001, -10.3, -3.800000000000001, -3.7000000000000006, -3.7000000000000006, -4.0, -3.9000000000000012, -4.200000000000001, -4.000000000000001, -3.8000000000000007, -4.200000000000001, -4.100000000000001, -3.6000000000000005, -3.6, -3.9000000000000012, -3.9000000000000012, -4.000000000000001, -4.000000000000001, -3.800000000000001, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.9000000000000012, -4.000000000000001, -4.100000000000001, -3.9000000000000012, -3.8000000000000007, -3.9000000000000012, -4.000000000000002, -3.8000000000000007, -4.100000000000001, -4.300000000000001, -3.8000000000000007, -4.200000000000001, -3.900000000000001, -3.9000000000000012, -4.000000000000002, -4.300000000000001, -3.9000000000000012, -3.9000000000000004, -3.7000000000000006, -3.500000000000001, -3.9000000000000012, -4.100000000000001, -4.100000000000001, -4.200000000000001, -3.900000000000001, -3.6000000000000005, -3.8000000000000007, -3.800000000000001, -3.7000000000000006, -4.1000000000000005, -3.900000000000001, -4.100000000000001, -3.7000000000000006, -3.900000000000001, -4.200000000000001, -3.9000000000000012, -3.800000000000001, -4.100000000000001, -4.000000000000001, -3.700000000000001, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -4.000000000000002, -11.7, -4.100000000000001, -4.200000000000001, -3.9000000000000004, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -3.700000000000001, -3.700000000000001, -3.900000000000001, -3.4000000000000004, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -3.500000000000001, -4.1000000000000005, -4.100000000000001, -4.000000000000002, -3.9000000000000004, -4.000000000000002, -3.900000000000001, -4.000000000000002, -4.1000000000000005, -3.700000000000001, -3.800000000000001, -3.7000000000000006, -3.7000000000000006, -3.9000000000000012, -3.900000000000001, -3.600000000000001, -4.000000000000001, -3.9000000000000012, -4.100000000000001, -3.7000000000000006, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.1000000000000005, -4.100000000000001, -3.7000000000000006, -3.900000000000001, -3.8000000000000007, -3.7000000000000006, -3.7000000000000006, -3.9000000000000004, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -4.300000000000001, -3.9000000000000012, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -3.600000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -3.9000000000000012, -3.900000000000001, -3.9000000000000004, -3.6000000000000005, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.6000000000000005, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -3.800000000000001, -3.9000000000000012, -4.000000000000001, -3.9000000000000012, -3.8000000000000007, -3.5000000000000004, -4.0, -3.800000000000001, -4.200000000000001, -4.0, -4.100000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.9000000000000012, -4.000000000000001, -3.900000000000001, -4.100000000000001, -3.7000000000000006, -3.900000000000001, -4.0, -3.8000000000000007], "episode_lengths": [21, 21, 21, 13, 6, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.705957437975748, "mean_inference_ms": 18.189003160172497, "mean_action_processing_ms": 0.9464946914584593, "mean_env_wait_ms": 1.6510972483288764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07115286749762458, "StateBufferConnector_ms": 0.009310052201554581, "ViewRequirementAgentConnector_ms": 0.13358683199495883}}, "episode_reward_max": -3.4000000000000004, "episode_reward_min": -11.7, "episode_reward_mean": -4.105945945945947, "episode_len_mean": 20.691891891891892, "episodes_this_iter": 185, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.900000000000001, -4.000000000000001, -4.000000000000002, -11.5, -10.6, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -3.9000000000000004, -11.4, -4.000000000000001, -3.9000000000000012, -3.9000000000000004, -3.700000000000001, -3.800000000000001, -4.100000000000001, -3.800000000000001, -10.3, -3.800000000000001, -3.7000000000000006, -3.7000000000000006, -4.0, -3.9000000000000012, -4.200000000000001, -4.000000000000001, -3.8000000000000007, -4.200000000000001, -4.100000000000001, -3.6000000000000005, -3.6, -3.9000000000000012, -3.9000000000000012, -4.000000000000001, -4.000000000000001, -3.800000000000001, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.9000000000000012, -4.000000000000001, -4.100000000000001, -3.9000000000000012, -3.8000000000000007, -3.9000000000000012, -4.000000000000002, -3.8000000000000007, -4.100000000000001, -4.300000000000001, -3.8000000000000007, -4.200000000000001, -3.900000000000001, -3.9000000000000012, -4.000000000000002, -4.300000000000001, -3.9000000000000012, -3.9000000000000004, -3.7000000000000006, -3.500000000000001, -3.9000000000000012, -4.100000000000001, -4.100000000000001, -4.200000000000001, -3.900000000000001, -3.6000000000000005, -3.8000000000000007, -3.800000000000001, -3.7000000000000006, -4.1000000000000005, -3.900000000000001, -4.100000000000001, -3.7000000000000006, -3.900000000000001, -4.200000000000001, -3.9000000000000012, -3.800000000000001, -4.100000000000001, -4.000000000000001, -3.700000000000001, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -4.000000000000002, -11.7, -4.100000000000001, -4.200000000000001, -3.9000000000000004, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -3.700000000000001, -3.700000000000001, -3.900000000000001, -3.4000000000000004, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -3.500000000000001, -4.1000000000000005, -4.100000000000001, -4.000000000000002, -3.9000000000000004, -4.000000000000002, -3.900000000000001, -4.000000000000002, -4.1000000000000005, -3.700000000000001, -3.800000000000001, -3.7000000000000006, -3.7000000000000006, -3.9000000000000012, -3.900000000000001, -3.600000000000001, -4.000000000000001, -3.9000000000000012, -4.100000000000001, -3.7000000000000006, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.1000000000000005, -4.100000000000001, -3.7000000000000006, -3.900000000000001, -3.8000000000000007, -3.7000000000000006, -3.7000000000000006, -3.9000000000000004, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -4.300000000000001, -3.9000000000000012, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -3.600000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -3.9000000000000012, -3.900000000000001, -3.9000000000000004, -3.6000000000000005, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.6000000000000005, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -3.800000000000001, -3.9000000000000012, -4.000000000000001, -3.9000000000000012, -3.8000000000000007, -3.5000000000000004, -4.0, -3.800000000000001, -4.200000000000001, -4.0, -4.100000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.9000000000000012, -4.000000000000001, -3.900000000000001, -4.100000000000001, -3.7000000000000006, -3.900000000000001, -4.0, -3.8000000000000007], "episode_lengths": [21, 21, 21, 13, 6, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.705957437975748, "mean_inference_ms": 18.189003160172497, "mean_action_processing_ms": 0.9464946914584593, "mean_env_wait_ms": 1.6510972483288764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07115286749762458, "StateBufferConnector_ms": 0.009310052201554581, "ViewRequirementAgentConnector_ms": 0.13358683199495883}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 268000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 268000, "timers": {"training_iteration_time_ms": 170906.608, "load_time_ms": 1.159, "load_throughput": 3450540.085, "learn_time_ms": 169941.098, "learn_throughput": 23.538, "synch_weights_time_ms": 176.314}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000}, "done": false, "episodes_total": 13973, "training_iteration": 67, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_00-06-30", "timestamp": 1680818790, "time_this_iter_s": 171.14097785949707, "time_total_s": 11453.877346038818, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01477ae610>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01474cb790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 11453.877346038818, "timesteps_since_restore": 0, "iterations_since_restore": 67, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.634979423868312, "ram_util_percent": 24.09876543209877}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.820818681101645, "cur_kl_coeff": 36.94729700088501, "cur_lr": 0.01, "total_loss": 5.904754793970415, "policy_loss": 0.010686210355150603, "vf_loss": 0.37354038603683953, "vf_explained_var": 0.66166553721633, "kl": 0.14941629785430988, "entropy": 2.835849901809487, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 62775.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "sampler_results": {"episode_reward_max": -3.6000000000000005, "episode_reward_min": -12.600000000000001, "episode_reward_mean": -4.453, "episode_len_mean": 19.92, "episode_media": {}, "episodes_this_iter": 200, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.3, -3.700000000000001, -3.900000000000001, -10.2, -4.000000000000002, -10.2, -3.600000000000001, -3.8000000000000007, -4.100000000000001, -4.1000000000000005, -4.000000000000001, -10.8, -3.900000000000001, -4.000000000000001, -10.1, -10.2, -3.900000000000001, -3.6000000000000005, -10.1, -3.7000000000000006, -10.1, -3.900000000000001, -3.8000000000000007, -10.2, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.800000000000001, -3.800000000000001, -4.000000000000001, -3.9000000000000012, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.7000000000000006, -3.900000000000001, -3.700000000000001, -3.7000000000000006, -3.700000000000001, -3.800000000000001, -4.000000000000002, -3.9000000000000012, -11.3, -3.7000000000000006, -4.000000000000001, -3.9000000000000004, -4.0, -3.9000000000000012, -4.100000000000001, -11.8, -3.8000000000000007, -3.7000000000000006, -3.700000000000001, -3.700000000000001, -4.400000000000001, -3.8000000000000007, -3.7000000000000006, -3.9000000000000012, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -4.000000000000002, -11.8, -4.000000000000001, -4.200000000000001, -4.000000000000001, -3.800000000000001, -3.800000000000001, -4.000000000000002, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.200000000000001, -3.700000000000001, -4.000000000000001, -4.000000000000001, -4.200000000000001, -4.300000000000001, -3.7000000000000006, -4.0, -4.100000000000001, -3.900000000000001, -4.0, -3.9000000000000004, -4.200000000000001, -3.9000000000000012, -4.100000000000001, -3.900000000000001, -3.7000000000000006, -3.6000000000000005, -3.8000000000000007, -3.8000000000000007, -12.600000000000001, -4.000000000000001, -3.800000000000001, -3.900000000000001, -4.300000000000001, -3.9000000000000004, -4.000000000000001, -10.3, -3.6000000000000005, -3.700000000000001, -3.800000000000001, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.1000000000000005, -4.000000000000001, -4.200000000000001, -4.200000000000001, -4.000000000000001, -3.8000000000000007, -3.800000000000001, -3.700000000000001, -4.0, -4.200000000000001, -4.200000000000001, -3.9000000000000004, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.300000000000001, -4.100000000000001, -3.9000000000000012, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.700000000000001, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -4.200000000000001, -3.900000000000001, -4.1000000000000005, -4.000000000000001, -3.900000000000001, -3.9000000000000004, -4.100000000000001, -4.000000000000002, -11.6, -3.800000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.1000000000000005, -3.7000000000000006, -4.0, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -4.300000000000001, -4.200000000000001, -3.8000000000000007, -4.200000000000001, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -4.1000000000000005, -4.100000000000001, -4.000000000000001, -4.200000000000001, -3.7000000000000006, -4.200000000000001, -3.7, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -3.7000000000000006, -4.0, -4.200000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -3.9000000000000012, -3.900000000000001, -3.800000000000001, -4.100000000000001, -3.9000000000000012, -4.000000000000001, -3.8000000000000007, -4.0], "episode_lengths": [4, 21, 21, 3, 21, 3, 21, 21, 21, 21, 21, 7, 21, 21, 2, 3, 21, 21, 2, 21, 2, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.707476122952139, "mean_inference_ms": 18.20842431977249, "mean_action_processing_ms": 0.9464502387148418, "mean_env_wait_ms": 1.6535878163939624, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07825720310211182, "StateBufferConnector_ms": 0.010033130645751953, "ViewRequirementAgentConnector_ms": 0.14362919330596924}}, "episode_reward_max": -3.6000000000000005, "episode_reward_min": -12.600000000000001, "episode_reward_mean": -4.453, "episode_len_mean": 19.92, "episodes_this_iter": 200, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10.3, -3.700000000000001, -3.900000000000001, -10.2, -4.000000000000002, -10.2, -3.600000000000001, -3.8000000000000007, -4.100000000000001, -4.1000000000000005, -4.000000000000001, -10.8, -3.900000000000001, -4.000000000000001, -10.1, -10.2, -3.900000000000001, -3.6000000000000005, -10.1, -3.7000000000000006, -10.1, -3.900000000000001, -3.8000000000000007, -10.2, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.800000000000001, -3.800000000000001, -4.000000000000001, -3.9000000000000012, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.7000000000000006, -3.900000000000001, -3.700000000000001, -3.7000000000000006, -3.700000000000001, -3.800000000000001, -4.000000000000002, -3.9000000000000012, -11.3, -3.7000000000000006, -4.000000000000001, -3.9000000000000004, -4.0, -3.9000000000000012, -4.100000000000001, -11.8, -3.8000000000000007, -3.7000000000000006, -3.700000000000001, -3.700000000000001, -4.400000000000001, -3.8000000000000007, -3.7000000000000006, -3.9000000000000012, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -4.000000000000002, -11.8, -4.000000000000001, -4.200000000000001, -4.000000000000001, -3.800000000000001, -3.800000000000001, -4.000000000000002, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.200000000000001, -3.700000000000001, -4.000000000000001, -4.000000000000001, -4.200000000000001, -4.300000000000001, -3.7000000000000006, -4.0, -4.100000000000001, -3.900000000000001, -4.0, -3.9000000000000004, -4.200000000000001, -3.9000000000000012, -4.100000000000001, -3.900000000000001, -3.7000000000000006, -3.6000000000000005, -3.8000000000000007, -3.8000000000000007, -12.600000000000001, -4.000000000000001, -3.800000000000001, -3.900000000000001, -4.300000000000001, -3.9000000000000004, -4.000000000000001, -10.3, -3.6000000000000005, -3.700000000000001, -3.800000000000001, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.1000000000000005, -4.000000000000001, -4.200000000000001, -4.200000000000001, -4.000000000000001, -3.8000000000000007, -3.800000000000001, -3.700000000000001, -4.0, -4.200000000000001, -4.200000000000001, -3.9000000000000004, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.300000000000001, -4.100000000000001, -3.9000000000000012, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.700000000000001, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -4.200000000000001, -3.900000000000001, -4.1000000000000005, -4.000000000000001, -3.900000000000001, -3.9000000000000004, -4.100000000000001, -4.000000000000002, -11.6, -3.800000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.1000000000000005, -3.7000000000000006, -4.0, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -4.300000000000001, -4.200000000000001, -3.8000000000000007, -4.200000000000001, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -4.1000000000000005, -4.100000000000001, -4.000000000000001, -4.200000000000001, -3.7000000000000006, -4.200000000000001, -3.7, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -3.7000000000000006, -4.0, -4.200000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -3.9000000000000012, -3.900000000000001, -3.800000000000001, -4.100000000000001, -3.9000000000000012, -4.000000000000001, -3.8000000000000007, -4.0], "episode_lengths": [4, 21, 21, 3, 21, 3, 21, 21, 21, 21, 21, 7, 21, 21, 2, 3, 21, 21, 2, 21, 2, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.707476122952139, "mean_inference_ms": 18.20842431977249, "mean_action_processing_ms": 0.9464502387148418, "mean_env_wait_ms": 1.6535878163939624, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07825720310211182, "StateBufferConnector_ms": 0.010033130645751953, "ViewRequirementAgentConnector_ms": 0.14362919330596924}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 170882.159, "load_time_ms": 1.16, "load_throughput": 3447137.045, "learn_time_ms": 169913.432, "learn_throughput": 23.541, "synch_weights_time_ms": 177.605}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "done": false, "episodes_total": 14173, "training_iteration": 68, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_00-09-21", "timestamp": 1680818961, "time_this_iter_s": 170.8865098953247, "time_total_s": 11624.763855934143, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0147659490>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014740d9d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 11624.763855934143, "timesteps_since_restore": 0, "iterations_since_restore": 68, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.411934156378601, "ram_util_percent": 24.099588477366257}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.14306425817551, "cur_kl_coeff": 55.42094550132753, "cur_lr": 0.01, "total_loss": 1.616558910261399, "policy_loss": 0.002872662693612598, "vf_loss": 0.35427602829151256, "vf_explained_var": 0.6811187887704501, "kl": 0.02272444538897597, "entropy": 2.887270687472436, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 63705.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "sampler_results": {"episode_reward_max": -3.5000000000000004, "episode_reward_min": -12.4, "episode_reward_mean": -4.282828282828284, "episode_len_mean": 20.328282828282827, "episode_media": {}, "episodes_this_iter": 198, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.800000000000001, -4.000000000000001, -3.900000000000001, -12.4, -10.8, -3.800000000000001, -10.3, -10.4, -10.3, -4.100000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -10.1, -3.900000000000001, -3.9000000000000012, -4.100000000000001, -3.8000000000000007, -3.7000000000000006, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -3.7000000000000006, -3.9000000000000012, -4.000000000000001, -4.0, -3.9000000000000012, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.200000000000001, -3.8000000000000007, -3.9000000000000012, -4.200000000000001, -4.000000000000002, -4.000000000000002, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.0, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.7000000000000006, -3.900000000000001, -3.6000000000000005, -4.200000000000001, -3.9000000000000012, -3.7000000000000006, -4.000000000000001, -3.900000000000001, -4.000000000000002, -3.9000000000000012, -4.1000000000000005, -4.000000000000001, -3.9000000000000012, -3.700000000000001, -3.9000000000000012, -4.000000000000001, -4.000000000000001, -4.0, -4.200000000000001, -3.7000000000000006, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.800000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.9000000000000012, -3.800000000000001, -3.900000000000001, -4.200000000000001, -3.800000000000001, -4.000000000000001, -3.8000000000000003, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -3.9000000000000012, -3.8000000000000007, -4.200000000000001, -4.000000000000001, -3.9000000000000012, -4.000000000000002, -3.900000000000001, -4.200000000000001, -10.5, -4.100000000000001, -12.1, -3.8000000000000007, -4.100000000000001, -3.600000000000001, -3.900000000000001, -3.8000000000000007, -11.1, -4.0, -3.9000000000000012, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000002, -3.900000000000001, -4.200000000000001, -3.900000000000001, -4.0, -3.8000000000000007, -4.000000000000002, -4.0, -10.5, -3.8000000000000007, -3.9000000000000012, -3.900000000000001, -4.1000000000000005, -3.8000000000000007, -3.8000000000000007, -4.200000000000001, -3.700000000000001, -3.6000000000000005, -3.900000000000001, -3.900000000000001, -4.200000000000001, -3.8000000000000007, -4.1000000000000005, -4.000000000000002, -4.0, -3.8000000000000007, -3.800000000000001, -4.000000000000001, -4.100000000000001, -3.700000000000001, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -3.5000000000000004, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.700000000000001, -4.300000000000001, -3.900000000000001, -3.6000000000000005, -4.000000000000002, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -3.8000000000000007, -4.1000000000000005, -3.9000000000000017, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -3.9000000000000012, -4.000000000000001, -3.9000000000000012, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.5000000000000004, -4.200000000000001, -3.700000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000002, -3.900000000000001, -4.200000000000001, -4.0, -4.200000000000001], "episode_lengths": [21, 21, 21, 17, 7, 21, 4, 5, 4, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 15, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.698740370761747, "mean_inference_ms": 18.20099610660628, "mean_action_processing_ms": 0.9465418692084836, "mean_env_wait_ms": 1.6486986009246232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08016029993693034, "StateBufferConnector_ms": 0.01027704489351523, "ViewRequirementAgentConnector_ms": 0.14473488836577444}}, "episode_reward_max": -3.5000000000000004, "episode_reward_min": -12.4, "episode_reward_mean": -4.282828282828284, "episode_len_mean": 20.328282828282827, "episodes_this_iter": 198, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.800000000000001, -4.000000000000001, -3.900000000000001, -12.4, -10.8, -3.800000000000001, -10.3, -10.4, -10.3, -4.100000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -10.1, -3.900000000000001, -3.9000000000000012, -4.100000000000001, -3.8000000000000007, -3.7000000000000006, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -3.7000000000000006, -3.9000000000000012, -4.000000000000001, -4.0, -3.9000000000000012, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.200000000000001, -3.8000000000000007, -3.9000000000000012, -4.200000000000001, -4.000000000000002, -4.000000000000002, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.0, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.7000000000000006, -3.900000000000001, -3.6000000000000005, -4.200000000000001, -3.9000000000000012, -3.7000000000000006, -4.000000000000001, -3.900000000000001, -4.000000000000002, -3.9000000000000012, -4.1000000000000005, -4.000000000000001, -3.9000000000000012, -3.700000000000001, -3.9000000000000012, -4.000000000000001, -4.000000000000001, -4.0, -4.200000000000001, -3.7000000000000006, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.800000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.9000000000000012, -3.800000000000001, -3.900000000000001, -4.200000000000001, -3.800000000000001, -4.000000000000001, -3.8000000000000003, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -3.9000000000000012, -3.8000000000000007, -4.200000000000001, -4.000000000000001, -3.9000000000000012, -4.000000000000002, -3.900000000000001, -4.200000000000001, -10.5, -4.100000000000001, -12.1, -3.8000000000000007, -4.100000000000001, -3.600000000000001, -3.900000000000001, -3.8000000000000007, -11.1, -4.0, -3.9000000000000012, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000002, -3.900000000000001, -4.200000000000001, -3.900000000000001, -4.0, -3.8000000000000007, -4.000000000000002, -4.0, -10.5, -3.8000000000000007, -3.9000000000000012, -3.900000000000001, -4.1000000000000005, -3.8000000000000007, -3.8000000000000007, -4.200000000000001, -3.700000000000001, -3.6000000000000005, -3.900000000000001, -3.900000000000001, -4.200000000000001, -3.8000000000000007, -4.1000000000000005, -4.000000000000002, -4.0, -3.8000000000000007, -3.800000000000001, -4.000000000000001, -4.100000000000001, -3.700000000000001, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -3.5000000000000004, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.700000000000001, -4.300000000000001, -3.900000000000001, -3.6000000000000005, -4.000000000000002, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -3.8000000000000007, -4.1000000000000005, -3.9000000000000017, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -3.9000000000000012, -4.000000000000001, -3.9000000000000012, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.5000000000000004, -4.200000000000001, -3.700000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000002, -3.900000000000001, -4.200000000000001, -4.0, -4.200000000000001], "episode_lengths": [21, 21, 21, 17, 7, 21, 4, 5, 4, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 15, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.698740370761747, "mean_inference_ms": 18.20099610660628, "mean_action_processing_ms": 0.9465418692084836, "mean_env_wait_ms": 1.6486986009246232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08016029993693034, "StateBufferConnector_ms": 0.01027704489351523, "ViewRequirementAgentConnector_ms": 0.14473488836577444}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 276000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 276000, "timers": {"training_iteration_time_ms": 170917.008, "load_time_ms": 1.171, "load_throughput": 3416600.346, "learn_time_ms": 169956.701, "learn_throughput": 23.535, "synch_weights_time_ms": 176.492}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "done": false, "episodes_total": 14371, "training_iteration": 69, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_00-12-12", "timestamp": 1680819132, "time_this_iter_s": 171.2345006465912, "time_total_s": 11795.998356580734, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476d7ca0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0147488e50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 11795.998356580734, "timesteps_since_restore": 0, "iterations_since_restore": 69, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.387704918032788, "ram_util_percent": 24.09754098360656}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 39.453232603175664, "cur_kl_coeff": 83.13141825199128, "cur_lr": 0.01, "total_loss": 13.076315548915856, "policy_loss": 0.011389957486541681, "vf_loss": 0.19528698763780056, "vf_explained_var": 0.7456495799044127, "kl": 0.1548107704657131, "entropy": 2.857690506724901, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 64635.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "sampler_results": {"episode_reward_max": -3.6, "episode_reward_min": -11.4, "episode_reward_mean": -4.064646464646466, "episode_len_mean": 20.59090909090909, "episode_media": {}, "episodes_this_iter": 198, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.000000000000001, -3.7000000000000006, -3.8000000000000003, -10.4, -3.7000000000000006, -4.100000000000001, -3.800000000000001, -3.900000000000001, -4.200000000000001, -3.9000000000000012, -4.000000000000001, -3.900000000000001, -10.2, -3.9000000000000012, -3.7000000000000006, -3.9000000000000012, -3.6000000000000005, -3.800000000000001, -3.8000000000000007, -3.6, -4.100000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -4.000000000000002, -3.7000000000000006, -4.000000000000001, -3.7, -3.900000000000001, -3.600000000000001, -4.000000000000001, -4.1000000000000005, -3.7000000000000006, -3.8000000000000007, -3.7000000000000006, -3.8000000000000007, -3.700000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000003, -4.1000000000000005, -3.600000000000001, -4.000000000000002, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.200000000000001, -3.7000000000000006, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -4.100000000000001, -3.800000000000001, -4.1000000000000005, -3.900000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.800000000000001, -4.000000000000002, -3.900000000000001, -3.800000000000001, -3.7000000000000006, -3.900000000000001, -3.8000000000000003, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.9000000000000004, -4.000000000000002, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -4.300000000000001, -4.200000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.7000000000000006, -4.1000000000000005, -3.800000000000001, -4.000000000000001, -11.4, -3.900000000000001, -3.700000000000001, -3.8000000000000003, -3.8000000000000007, -3.800000000000001, -3.800000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.300000000000001, -3.9000000000000012, -10.2, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -4.100000000000001, -10.1, -3.9000000000000012, -4.000000000000001, -3.700000000000001, -4.000000000000001, -4.0, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -3.7000000000000006, -3.900000000000001, -3.800000000000001, -3.700000000000001, -4.200000000000001, -3.6000000000000005, -4.000000000000001, -3.900000000000001, -3.8000000000000003, -3.9000000000000012, -3.900000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.700000000000001, -3.700000000000001, -4.200000000000001, -3.8000000000000007, -3.7000000000000006, -3.9000000000000012, -4.100000000000001, -3.7000000000000006, -3.800000000000001, -3.9000000000000017, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -3.900000000000001, -3.800000000000001, -3.900000000000001, -4.200000000000001, -4.100000000000001, -4.300000000000001, -3.9000000000000004, -3.800000000000001, -4.1000000000000005, -3.7, -4.200000000000001, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.7000000000000006, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -3.7000000000000006, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -3.9000000000000012, -3.600000000000001, -4.000000000000001, -3.8000000000000007, -4.0, -3.9000000000000004, -3.900000000000001, -3.900000000000001, -3.700000000000001, -4.000000000000001, -3.7000000000000006, -4.0, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.0, -4.0, -3.800000000000001, -3.900000000000001, -4.0, -3.900000000000001, -3.800000000000001, -3.6000000000000005, -3.900000000000001, -3.7000000000000006, -4.100000000000001], "episode_lengths": [21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.703183291187871, "mean_inference_ms": 18.201845654110876, "mean_action_processing_ms": 0.9459632538983518, "mean_env_wait_ms": 1.6450210659616307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07482189120668353, "StateBufferConnector_ms": 0.009648486821338384, "ViewRequirementAgentConnector_ms": 0.136315461361047}}, "episode_reward_max": -3.6, "episode_reward_min": -11.4, "episode_reward_mean": -4.064646464646466, "episode_len_mean": 20.59090909090909, "episodes_this_iter": 198, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.000000000000001, -3.7000000000000006, -3.8000000000000003, -10.4, -3.7000000000000006, -4.100000000000001, -3.800000000000001, -3.900000000000001, -4.200000000000001, -3.9000000000000012, -4.000000000000001, -3.900000000000001, -10.2, -3.9000000000000012, -3.7000000000000006, -3.9000000000000012, -3.6000000000000005, -3.800000000000001, -3.8000000000000007, -3.6, -4.100000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -4.000000000000002, -3.7000000000000006, -4.000000000000001, -3.7, -3.900000000000001, -3.600000000000001, -4.000000000000001, -4.1000000000000005, -3.7000000000000006, -3.8000000000000007, -3.7000000000000006, -3.8000000000000007, -3.700000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000003, -4.1000000000000005, -3.600000000000001, -4.000000000000002, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.200000000000001, -3.7000000000000006, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -4.100000000000001, -3.800000000000001, -4.1000000000000005, -3.900000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.800000000000001, -4.000000000000002, -3.900000000000001, -3.800000000000001, -3.7000000000000006, -3.900000000000001, -3.8000000000000003, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.9000000000000004, -4.000000000000002, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -4.300000000000001, -4.200000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.7000000000000006, -4.1000000000000005, -3.800000000000001, -4.000000000000001, -11.4, -3.900000000000001, -3.700000000000001, -3.8000000000000003, -3.8000000000000007, -3.800000000000001, -3.800000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.300000000000001, -3.9000000000000012, -10.2, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -4.100000000000001, -10.1, -3.9000000000000012, -4.000000000000001, -3.700000000000001, -4.000000000000001, -4.0, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -3.7000000000000006, -3.900000000000001, -3.800000000000001, -3.700000000000001, -4.200000000000001, -3.6000000000000005, -4.000000000000001, -3.900000000000001, -3.8000000000000003, -3.9000000000000012, -3.900000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.700000000000001, -3.700000000000001, -4.200000000000001, -3.8000000000000007, -3.7000000000000006, -3.9000000000000012, -4.100000000000001, -3.7000000000000006, -3.800000000000001, -3.9000000000000017, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -3.900000000000001, -3.800000000000001, -3.900000000000001, -4.200000000000001, -4.100000000000001, -4.300000000000001, -3.9000000000000004, -3.800000000000001, -4.1000000000000005, -3.7, -4.200000000000001, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.7000000000000006, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -3.7000000000000006, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -3.9000000000000012, -3.600000000000001, -4.000000000000001, -3.8000000000000007, -4.0, -3.9000000000000004, -3.900000000000001, -3.900000000000001, -3.700000000000001, -4.000000000000001, -3.7000000000000006, -4.0, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.0, -4.0, -3.800000000000001, -3.900000000000001, -4.0, -3.900000000000001, -3.800000000000001, -3.6000000000000005, -3.900000000000001, -3.7000000000000006, -4.100000000000001], "episode_lengths": [21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.703183291187871, "mean_inference_ms": 18.201845654110876, "mean_action_processing_ms": 0.9459632538983518, "mean_env_wait_ms": 1.6450210659616307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07482189120668353, "StateBufferConnector_ms": 0.009648486821338384, "ViewRequirementAgentConnector_ms": 0.136315461361047}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 280000, "timers": {"training_iteration_time_ms": 170896.809, "load_time_ms": 1.221, "load_throughput": 3275904.245, "learn_time_ms": 169931.387, "learn_throughput": 23.539, "synch_weights_time_ms": 177.765}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "done": false, "episodes_total": 14569, "training_iteration": 70, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_00-15-03", "timestamp": 1680819303, "time_this_iter_s": 170.83620595932007, "time_total_s": 11966.834562540054, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01473e25e0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0147464160>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 11966.834562540054, "timesteps_since_restore": 0, "iterations_since_restore": 70, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.355555555555556, "ram_util_percent": 24.10205761316873}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22.229815243649227, "cur_kl_coeff": 124.69712737798687, "cur_lr": 0.01, "total_loss": 0.5467066923857377, "policy_loss": 5.772998356210288e-05, "vf_loss": 0.30688891066338425, "vf_explained_var": 0.6625098830910139, "kl": 0.0019227391568038196, "entropy": 2.919717981738429, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 65565.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000}, "sampler_results": {"episode_reward_max": -3.500000000000001, "episode_reward_min": -12.200000000000001, "episode_reward_mean": -4.110526315789474, "episode_len_mean": 20.736842105263158, "episode_media": {}, "episodes_this_iter": 190, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.7000000000000006, -10.8, -4.100000000000001, -11.8, -3.7, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.9000000000000012, -3.700000000000001, -3.600000000000001, -3.8000000000000007, -3.900000000000001, -3.7000000000000006, -10.5, -3.800000000000001, -4.000000000000002, -4.000000000000001, -4.100000000000001, -4.000000000000002, -4.100000000000001, -3.800000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -3.8000000000000003, -3.9000000000000012, -3.900000000000001, -3.9000000000000004, -3.900000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -3.800000000000001, -3.8000000000000007, -4.100000000000001, -4.100000000000001, -3.9000000000000004, -4.0, -4.300000000000001, -4.100000000000001, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -3.800000000000001, -4.100000000000001, -3.9000000000000012, -4.000000000000001, -3.900000000000001, -3.800000000000001, -3.900000000000001, -3.8000000000000007, -3.7000000000000006, -3.500000000000001, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -3.8000000000000003, -4.1000000000000005, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.800000000000001, -4.0, -4.100000000000001, -3.800000000000001, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -4.100000000000001, -3.6000000000000005, -4.000000000000001, -3.9000000000000012, -3.8000000000000007, -3.9000000000000004, -4.000000000000001, -4.000000000000002, -4.100000000000001, -3.800000000000001, -3.900000000000001, -3.8000000000000007, -3.7000000000000006, -4.000000000000002, -3.9000000000000012, -3.8000000000000007, -4.000000000000001, -3.800000000000001, -3.8000000000000007, -3.7000000000000006, -11.8, -3.900000000000001, -4.300000000000001, -3.8000000000000007, -3.800000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000003, -3.6000000000000005, -4.100000000000001, -3.7000000000000006, -3.9000000000000004, -4.100000000000001, -4.000000000000001, -3.700000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.200000000000001, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.7, -3.8000000000000007, -3.800000000000001, -4.200000000000001, -3.8000000000000007, -3.900000000000001, -3.500000000000001, -4.100000000000001, -3.6000000000000005, -4.100000000000001, -3.7000000000000006, -4.000000000000002, -4.100000000000001, -3.900000000000001, -3.700000000000001, -4.100000000000001, -3.7000000000000006, -3.6000000000000005, -4.300000000000001, -3.9000000000000012, -4.000000000000001, -4.100000000000001, -3.7, -3.7000000000000006, -3.900000000000001, -3.700000000000001, -3.8000000000000007, -3.8000000000000007, -4.100000000000001, -4.000000000000002, -12.200000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000003, -4.200000000000001, -3.9000000000000012, -3.9000000000000004, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -4.200000000000001, -4.200000000000001, -3.800000000000001, -4.200000000000001, -3.8000000000000007, -3.6000000000000005, -3.900000000000001, -3.9000000000000012, -4.100000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -3.500000000000001, -4.100000000000001, -3.600000000000001, -3.900000000000001, -4.1000000000000005, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -4.200000000000001, -3.700000000000001, -4.000000000000001], "episode_lengths": [21, 7, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.698520895648768, "mean_inference_ms": 18.20597577004076, "mean_action_processing_ms": 0.9457666152733125, "mean_env_wait_ms": 1.645847292157287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07536373640361585, "StateBufferConnector_ms": 0.009776291094328227, "ViewRequirementAgentConnector_ms": 0.13968543002479955}}, "episode_reward_max": -3.500000000000001, "episode_reward_min": -12.200000000000001, "episode_reward_mean": -4.110526315789474, "episode_len_mean": 20.736842105263158, "episodes_this_iter": 190, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.7000000000000006, -10.8, -4.100000000000001, -11.8, -3.7, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.9000000000000012, -3.700000000000001, -3.600000000000001, -3.8000000000000007, -3.900000000000001, -3.7000000000000006, -10.5, -3.800000000000001, -4.000000000000002, -4.000000000000001, -4.100000000000001, -4.000000000000002, -4.100000000000001, -3.800000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -3.8000000000000003, -3.9000000000000012, -3.900000000000001, -3.9000000000000004, -3.900000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -3.800000000000001, -3.8000000000000007, -4.100000000000001, -4.100000000000001, -3.9000000000000004, -4.0, -4.300000000000001, -4.100000000000001, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -3.800000000000001, -4.100000000000001, -3.9000000000000012, -4.000000000000001, -3.900000000000001, -3.800000000000001, -3.900000000000001, -3.8000000000000007, -3.7000000000000006, -3.500000000000001, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -3.8000000000000003, -4.1000000000000005, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.800000000000001, -4.0, -4.100000000000001, -3.800000000000001, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -4.100000000000001, -3.6000000000000005, -4.000000000000001, -3.9000000000000012, -3.8000000000000007, -3.9000000000000004, -4.000000000000001, -4.000000000000002, -4.100000000000001, -3.800000000000001, -3.900000000000001, -3.8000000000000007, -3.7000000000000006, -4.000000000000002, -3.9000000000000012, -3.8000000000000007, -4.000000000000001, -3.800000000000001, -3.8000000000000007, -3.7000000000000006, -11.8, -3.900000000000001, -4.300000000000001, -3.8000000000000007, -3.800000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000003, -3.6000000000000005, -4.100000000000001, -3.7000000000000006, -3.9000000000000004, -4.100000000000001, -4.000000000000001, -3.700000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.200000000000001, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.7, -3.8000000000000007, -3.800000000000001, -4.200000000000001, -3.8000000000000007, -3.900000000000001, -3.500000000000001, -4.100000000000001, -3.6000000000000005, -4.100000000000001, -3.7000000000000006, -4.000000000000002, -4.100000000000001, -3.900000000000001, -3.700000000000001, -4.100000000000001, -3.7000000000000006, -3.6000000000000005, -4.300000000000001, -3.9000000000000012, -4.000000000000001, -4.100000000000001, -3.7, -3.7000000000000006, -3.900000000000001, -3.700000000000001, -3.8000000000000007, -3.8000000000000007, -4.100000000000001, -4.000000000000002, -12.200000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000003, -4.200000000000001, -3.9000000000000012, -3.9000000000000004, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -4.200000000000001, -4.200000000000001, -3.800000000000001, -4.200000000000001, -3.8000000000000007, -3.6000000000000005, -3.900000000000001, -3.9000000000000012, -4.100000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -3.500000000000001, -4.100000000000001, -3.600000000000001, -3.900000000000001, -4.1000000000000005, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -4.200000000000001, -3.700000000000001, -4.000000000000001], "episode_lengths": [21, 7, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.698520895648768, "mean_inference_ms": 18.20597577004076, "mean_action_processing_ms": 0.9457666152733125, "mean_env_wait_ms": 1.645847292157287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07536373640361585, "StateBufferConnector_ms": 0.009776291094328227, "ViewRequirementAgentConnector_ms": 0.13968543002479955}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 284000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 284000, "timers": {"training_iteration_time_ms": 170937.785, "load_time_ms": 1.221, "load_throughput": 3275520.5, "learn_time_ms": 169973.886, "learn_throughput": 23.533, "synch_weights_time_ms": 178.16}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000}, "done": false, "episodes_total": 14759, "training_iteration": 71, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_00-17-54", "timestamp": 1680819474, "time_this_iter_s": 171.04537200927734, "time_total_s": 12137.879934549332, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01474233d0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01474a80d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 12137.879934549332, "timesteps_since_restore": 0, "iterations_since_restore": 71, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.4747933884297515, "ram_util_percent": 24.099586776859507}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.934683575168732, "cur_kl_coeff": 62.34856368899344, "cur_lr": 0.01, "total_loss": 0.4785698203490146, "policy_loss": -0.001329956902691754, "vf_loss": 0.4363046679525606, "vf_explained_var": 0.6575311096124752, "kl": 0.0006992159150941398, "entropy": 2.905947425288539, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 66495.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "sampler_results": {"episode_reward_max": -3.5000000000000004, "episode_reward_min": -12.6, "episode_reward_mean": -4.446969696969697, "episode_len_mean": 20.005050505050505, "episode_media": {}, "episodes_this_iter": 198, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.700000000000001, -3.9000000000000012, -4.100000000000001, -3.900000000000001, -3.7000000000000006, -3.9000000000000012, -3.900000000000001, -3.900000000000001, -10.8, -4.100000000000001, -10.7, -4.100000000000001, -4.1000000000000005, -3.8000000000000007, -10.1, -10.3, -4.1000000000000005, -11.4, -3.7000000000000006, -3.9000000000000012, -3.900000000000001, -10.2, -10.4, -10.1, -3.900000000000001, -11.3, -3.900000000000001, -4.1000000000000005, -3.6000000000000005, -3.700000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.500000000000001, -3.9000000000000012, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -3.6000000000000005, -4.000000000000002, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -3.7000000000000006, -3.700000000000001, -4.200000000000001, -3.9000000000000004, -3.900000000000001, -4.000000000000002, -4.400000000000001, -4.400000000000001, -3.9000000000000004, -4.200000000000001, -4.000000000000001, -10.2, -3.800000000000001, -4.000000000000002, -3.900000000000001, -3.7000000000000006, -3.600000000000001, -4.000000000000001, -3.700000000000001, -4.1000000000000005, -12.6, -4.0, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.200000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.7000000000000006, -3.5000000000000004, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.1000000000000005, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.800000000000001, -3.900000000000001, -4.200000000000001, -4.100000000000001, -3.900000000000001, -3.6000000000000005, -3.600000000000001, -3.700000000000001, -11.2, -3.700000000000001, -3.8000000000000007, -4.200000000000001, -4.100000000000001, -11.0, -3.700000000000001, -10.9, -3.9000000000000004, -3.8000000000000003, -3.900000000000001, -4.200000000000001, -12.2, -4.100000000000001, -4.1000000000000005, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -3.700000000000001, -4.000000000000001, -4.200000000000001, -3.800000000000001, -3.900000000000001, -3.7000000000000006, -4.100000000000001, -4.200000000000001, -3.8000000000000003, -4.100000000000001, -4.100000000000001, -3.900000000000001, -4.200000000000001, -3.900000000000001, -3.800000000000001, -3.5000000000000004, -4.000000000000001, -4.100000000000001, -3.8000000000000003, -3.900000000000001, -4.000000000000001, -3.6000000000000005, -3.8000000000000007, -3.900000000000001, -3.600000000000001, -4.200000000000001, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -3.700000000000001, -4.200000000000001, -3.700000000000001, -4.000000000000001, -3.900000000000001, -3.500000000000001, -3.9000000000000012, -3.9000000000000004, -3.900000000000001, -3.900000000000001, -4.100000000000001, -4.200000000000001, -4.200000000000001, -3.7000000000000006, -3.7000000000000006, -3.8000000000000003, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.1000000000000005, -4.000000000000001, -3.900000000000001, -4.100000000000001, -3.5000000000000004, -3.9000000000000012, -3.700000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.9000000000000012, -4.200000000000001, -4.000000000000002, -3.7000000000000006, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -4.200000000000001, -4.000000000000002, -4.000000000000001, -4.000000000000001, -3.800000000000001, -3.700000000000001, -3.9000000000000012, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -3.8000000000000007, -3.7, -4.200000000000001, -3.500000000000001, -3.700000000000001, -4.000000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 7, 21, 21, 21, 2, 4, 21, 11, 21, 21, 21, 3, 5, 2, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 9, 21, 9, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.709047293559241, "mean_inference_ms": 18.21581017739654, "mean_action_processing_ms": 0.9463896844759725, "mean_env_wait_ms": 1.6475382488209203, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0748105723448474, "StateBufferConnector_ms": 0.010171081080581203, "ViewRequirementAgentConnector_ms": 0.13818825134123214}}, "episode_reward_max": -3.5000000000000004, "episode_reward_min": -12.6, "episode_reward_mean": -4.446969696969697, "episode_len_mean": 20.005050505050505, "episodes_this_iter": 198, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.700000000000001, -3.9000000000000012, -4.100000000000001, -3.900000000000001, -3.7000000000000006, -3.9000000000000012, -3.900000000000001, -3.900000000000001, -10.8, -4.100000000000001, -10.7, -4.100000000000001, -4.1000000000000005, -3.8000000000000007, -10.1, -10.3, -4.1000000000000005, -11.4, -3.7000000000000006, -3.9000000000000012, -3.900000000000001, -10.2, -10.4, -10.1, -3.900000000000001, -11.3, -3.900000000000001, -4.1000000000000005, -3.6000000000000005, -3.700000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.500000000000001, -3.9000000000000012, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -3.6000000000000005, -4.000000000000002, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -3.7000000000000006, -3.700000000000001, -4.200000000000001, -3.9000000000000004, -3.900000000000001, -4.000000000000002, -4.400000000000001, -4.400000000000001, -3.9000000000000004, -4.200000000000001, -4.000000000000001, -10.2, -3.800000000000001, -4.000000000000002, -3.900000000000001, -3.7000000000000006, -3.600000000000001, -4.000000000000001, -3.700000000000001, -4.1000000000000005, -12.6, -4.0, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.200000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.7000000000000006, -3.5000000000000004, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.1000000000000005, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.800000000000001, -3.900000000000001, -4.200000000000001, -4.100000000000001, -3.900000000000001, -3.6000000000000005, -3.600000000000001, -3.700000000000001, -11.2, -3.700000000000001, -3.8000000000000007, -4.200000000000001, -4.100000000000001, -11.0, -3.700000000000001, -10.9, -3.9000000000000004, -3.8000000000000003, -3.900000000000001, -4.200000000000001, -12.2, -4.100000000000001, -4.1000000000000005, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -3.700000000000001, -4.000000000000001, -4.200000000000001, -3.800000000000001, -3.900000000000001, -3.7000000000000006, -4.100000000000001, -4.200000000000001, -3.8000000000000003, -4.100000000000001, -4.100000000000001, -3.900000000000001, -4.200000000000001, -3.900000000000001, -3.800000000000001, -3.5000000000000004, -4.000000000000001, -4.100000000000001, -3.8000000000000003, -3.900000000000001, -4.000000000000001, -3.6000000000000005, -3.8000000000000007, -3.900000000000001, -3.600000000000001, -4.200000000000001, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -3.700000000000001, -4.200000000000001, -3.700000000000001, -4.000000000000001, -3.900000000000001, -3.500000000000001, -3.9000000000000012, -3.9000000000000004, -3.900000000000001, -3.900000000000001, -4.100000000000001, -4.200000000000001, -4.200000000000001, -3.7000000000000006, -3.7000000000000006, -3.8000000000000003, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.1000000000000005, -4.000000000000001, -3.900000000000001, -4.100000000000001, -3.5000000000000004, -3.9000000000000012, -3.700000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.9000000000000012, -4.200000000000001, -4.000000000000002, -3.7000000000000006, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -4.200000000000001, -4.000000000000002, -4.000000000000001, -4.000000000000001, -3.800000000000001, -3.700000000000001, -3.9000000000000012, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -3.8000000000000007, -3.7, -4.200000000000001, -3.500000000000001, -3.700000000000001, -4.000000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 7, 21, 21, 21, 2, 4, 21, 11, 21, 21, 21, 3, 5, 2, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 9, 21, 9, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.709047293559241, "mean_inference_ms": 18.21581017739654, "mean_action_processing_ms": 0.9463896844759725, "mean_env_wait_ms": 1.6475382488209203, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0748105723448474, "StateBufferConnector_ms": 0.010171081080581203, "ViewRequirementAgentConnector_ms": 0.13818825134123214}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 170891.726, "load_time_ms": 1.198, "load_throughput": 3339679.911, "learn_time_ms": 169928.393, "learn_throughput": 23.539, "synch_weights_time_ms": 178.009}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "episodes_total": 14957, "training_iteration": 72, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_00-20-45", "timestamp": 1680819645, "time_this_iter_s": 170.51582622528076, "time_total_s": 12308.395760774612, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01475a5760>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01474a8040>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 12308.395760774612, "timesteps_since_restore": 0, "iterations_since_restore": 72, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.366666666666666, "ram_util_percent": 24.101234567901237}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.765308086205554, "cur_kl_coeff": 31.17428184449672, "cur_lr": 0.01, "total_loss": 0.44429637470072314, "policy_loss": -0.0051566678835379505, "vf_loss": 0.42283210320979037, "vf_explained_var": 0.6642342833421564, "kl": 0.0008539390933516989, "entropy": 2.8991443508414814, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 67425.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000}, "sampler_results": {"episode_reward_max": -3.5000000000000004, "episode_reward_min": -12.4, "episode_reward_mean": -4.444117647058825, "episode_len_mean": 19.970588235294116, "episode_media": {}, "episodes_this_iter": 204, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.900000000000001, -3.8000000000000007, -10.4, -3.900000000000001, -3.7000000000000006, -10.3, -3.900000000000001, -10.6, -4.000000000000001, -3.7000000000000006, -4.000000000000002, -10.9, -3.900000000000001, -3.8000000000000007, -3.6000000000000005, -3.800000000000001, -3.8000000000000007, -3.5000000000000004, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -10.1, -3.7000000000000006, -10.4, -10.3, -10.8, -11.0, -10.1, -11.0, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -4.300000000000001, -4.000000000000001, -3.8000000000000007, -4.200000000000001, -3.900000000000001, -3.6000000000000005, -4.100000000000001, -3.900000000000001, -4.200000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -3.800000000000001, -3.8000000000000007, -4.200000000000001, -3.7000000000000006, -12.4, -4.000000000000001, -4.000000000000002, -3.800000000000001, -4.000000000000002, -4.000000000000002, -3.8000000000000007, -3.9000000000000012, -4.100000000000001, -4.200000000000001, -3.5000000000000004, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -4.200000000000001, -3.800000000000001, -3.900000000000001, -4.200000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -4.200000000000001, -3.900000000000001, -3.8000000000000007, -4.0, -3.900000000000001, -3.9000000000000004, -3.9000000000000004, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -4.300000000000001, -4.200000000000001, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -3.9000000000000004, -4.200000000000001, -3.9000000000000012, -3.8000000000000007, -3.600000000000001, -4.100000000000001, -4.0, -3.900000000000001, -3.900000000000001, -3.900000000000001, -4.300000000000001, -3.8000000000000007, -4.000000000000002, -4.200000000000001, -12.3, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -10.5, -10.6, -3.7000000000000006, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -4.100000000000001, -3.6000000000000005, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -3.9000000000000012, -4.000000000000001, -3.8000000000000007, -4.200000000000001, -4.000000000000001, -4.1000000000000005, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.9000000000000004, -4.100000000000001, -4.000000000000001, -4.0, -4.1000000000000005, -3.8000000000000003, -3.5000000000000004, -4.000000000000001, -3.8000000000000007, -4.000000000000002, -4.200000000000001, -4.100000000000001, -4.1000000000000005, -4.300000000000001, -3.900000000000001, -4.100000000000001, -3.7000000000000006, -3.6000000000000005, -4.100000000000001, -4.000000000000001, -3.700000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000002, -3.900000000000001, -3.800000000000001, -4.000000000000001, -3.7000000000000006, -3.900000000000001, -3.9000000000000012, -4.300000000000001, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -3.9000000000000012, -4.200000000000001, -3.8000000000000007, -3.800000000000001, -4.000000000000001, -4.1000000000000005, -3.600000000000001, -4.000000000000001, -4.200000000000001, -4.1000000000000005, -3.7000000000000006, -3.8000000000000007, -3.600000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -3.5000000000000004, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.200000000000001, -3.9000000000000004, -4.200000000000001, -4.000000000000001, -3.7000000000000006], "episode_lengths": [21, 21, 5, 21, 21, 4, 21, 7, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 4, 4, 7, 7, 2, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 6, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.715492318405483, "mean_inference_ms": 18.216541911577497, "mean_action_processing_ms": 0.945267857646557, "mean_env_wait_ms": 1.6465444990773639, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07527657583648083, "StateBufferConnector_ms": 0.010237623663509594, "ViewRequirementAgentConnector_ms": 0.13866634929881377}}, "episode_reward_max": -3.5000000000000004, "episode_reward_min": -12.4, "episode_reward_mean": -4.444117647058825, "episode_len_mean": 19.970588235294116, "episodes_this_iter": 204, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.900000000000001, -3.8000000000000007, -10.4, -3.900000000000001, -3.7000000000000006, -10.3, -3.900000000000001, -10.6, -4.000000000000001, -3.7000000000000006, -4.000000000000002, -10.9, -3.900000000000001, -3.8000000000000007, -3.6000000000000005, -3.800000000000001, -3.8000000000000007, -3.5000000000000004, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -10.1, -3.7000000000000006, -10.4, -10.3, -10.8, -11.0, -10.1, -11.0, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -4.300000000000001, -4.000000000000001, -3.8000000000000007, -4.200000000000001, -3.900000000000001, -3.6000000000000005, -4.100000000000001, -3.900000000000001, -4.200000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -3.800000000000001, -3.8000000000000007, -4.200000000000001, -3.7000000000000006, -12.4, -4.000000000000001, -4.000000000000002, -3.800000000000001, -4.000000000000002, -4.000000000000002, -3.8000000000000007, -3.9000000000000012, -4.100000000000001, -4.200000000000001, -3.5000000000000004, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -4.200000000000001, -3.800000000000001, -3.900000000000001, -4.200000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -4.200000000000001, -3.900000000000001, -3.8000000000000007, -4.0, -3.900000000000001, -3.9000000000000004, -3.9000000000000004, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -4.300000000000001, -4.200000000000001, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -3.9000000000000004, -4.200000000000001, -3.9000000000000012, -3.8000000000000007, -3.600000000000001, -4.100000000000001, -4.0, -3.900000000000001, -3.900000000000001, -3.900000000000001, -4.300000000000001, -3.8000000000000007, -4.000000000000002, -4.200000000000001, -12.3, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -10.5, -10.6, -3.7000000000000006, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -4.100000000000001, -3.6000000000000005, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -3.9000000000000012, -4.000000000000001, -3.8000000000000007, -4.200000000000001, -4.000000000000001, -4.1000000000000005, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.9000000000000004, -4.100000000000001, -4.000000000000001, -4.0, -4.1000000000000005, -3.8000000000000003, -3.5000000000000004, -4.000000000000001, -3.8000000000000007, -4.000000000000002, -4.200000000000001, -4.100000000000001, -4.1000000000000005, -4.300000000000001, -3.900000000000001, -4.100000000000001, -3.7000000000000006, -3.6000000000000005, -4.100000000000001, -4.000000000000001, -3.700000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000002, -3.900000000000001, -3.800000000000001, -4.000000000000001, -3.7000000000000006, -3.900000000000001, -3.9000000000000012, -4.300000000000001, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -3.9000000000000012, -4.200000000000001, -3.8000000000000007, -3.800000000000001, -4.000000000000001, -4.1000000000000005, -3.600000000000001, -4.000000000000001, -4.200000000000001, -4.1000000000000005, -3.7000000000000006, -3.8000000000000007, -3.600000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -3.5000000000000004, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.200000000000001, -3.9000000000000004, -4.200000000000001, -4.000000000000001, -3.7000000000000006], "episode_lengths": [21, 21, 5, 21, 21, 4, 21, 7, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 4, 4, 7, 7, 2, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 6, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.715492318405483, "mean_inference_ms": 18.216541911577497, "mean_action_processing_ms": 0.945267857646557, "mean_env_wait_ms": 1.6465444990773639, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07527657583648083, "StateBufferConnector_ms": 0.010237623663509594, "ViewRequirementAgentConnector_ms": 0.13866634929881377}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 292000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 292000, "timers": {"training_iteration_time_ms": 170911.775, "load_time_ms": 1.192, "load_throughput": 3354973.504, "learn_time_ms": 169947.891, "learn_throughput": 23.537, "synch_weights_time_ms": 178.443}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000}, "done": false, "episodes_total": 15161, "training_iteration": 73, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_00-23-35", "timestamp": 1680819815, "time_this_iter_s": 170.67547583580017, "time_total_s": 12479.071236610413, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476f2e80>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01473d84c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 12479.071236610413, "timesteps_since_restore": 0, "iterations_since_restore": 73, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.390909090909091, "ram_util_percent": 24.101652892561987}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.353712205092112, "cur_kl_coeff": 15.58714092224836, "cur_lr": 0.01, "total_loss": 0.4012580353556381, "policy_loss": -0.0030858128170122303, "vf_loss": 0.3527011590459013, "vf_explained_var": 0.704517069234643, "kl": 0.0033131598877521504, "entropy": 2.8962827628658663, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 68355.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000}, "sampler_results": {"episode_reward_max": -3.500000000000001, "episode_reward_min": -11.6, "episode_reward_mean": -4.33989898989899, "episode_len_mean": 19.8989898989899, "episode_media": {}, "episodes_this_iter": 198, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.700000000000001, -3.700000000000001, -3.7000000000000006, -4.200000000000001, -3.8000000000000007, -3.7000000000000006, -3.900000000000001, -10.3, -4.100000000000001, -3.500000000000001, -10.1, -10.3, -3.8000000000000007, -10.4, -10.3, -3.7000000000000006, -10.3, -3.8000000000000007, -3.800000000000001, -10.2, -10.1, -10.1, -3.9000000000000012, -10.1, -3.800000000000001, -3.900000000000001, -3.800000000000001, -4.000000000000001, -4.000000000000002, -3.500000000000001, -3.900000000000001, -3.7000000000000006, -4.1000000000000005, -3.7000000000000006, -4.100000000000001, -3.6000000000000005, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.200000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000002, -4.000000000000002, -3.8000000000000007, -3.900000000000001, -3.800000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.200000000000001, -3.9000000000000012, -4.000000000000001, -4.000000000000001, -3.6000000000000005, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.9000000000000004, -4.300000000000001, -3.8000000000000007, -4.000000000000002, -4.1000000000000005, -4.0, -3.900000000000001, -3.800000000000001, -3.9000000000000004, -3.800000000000001, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -4.0, -3.900000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000002, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.300000000000001, -3.600000000000001, -3.7000000000000006, -3.8000000000000007, -4.000000000000002, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000002, -3.9000000000000012, -3.800000000000001, -3.9000000000000012, -3.600000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -4.200000000000001, -3.7000000000000006, -3.8000000000000007, -3.8000000000000016, -3.7000000000000006, -4.000000000000001, -4.0, -4.100000000000001, -3.900000000000001, -4.200000000000001, -3.900000000000001, -3.900000000000001, -10.5, -4.100000000000001, -11.6, -4.000000000000001, -3.700000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -3.800000000000001, -3.7000000000000006, -4.100000000000001, -3.700000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000002, -4.000000000000001, -4.0, -4.100000000000001, -3.600000000000001, -4.100000000000001, -4.100000000000001, -3.700000000000001, -3.7000000000000006, -3.900000000000001, -4.000000000000002, -3.800000000000001, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -3.7000000000000006, -3.800000000000001, -3.700000000000001, -3.9000000000000004, -4.300000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.7000000000000006, -4.300000000000001, -4.200000000000001, -4.000000000000002, -3.7000000000000006, -3.8000000000000007, -3.7000000000000006, -4.1000000000000005, -3.8000000000000007, -3.7000000000000006, -4.100000000000001, -3.6000000000000005, -4.000000000000002, -4.400000000000001, -3.7000000000000006, -3.8000000000000007, -10.7, -3.600000000000001, -4.200000000000001, -3.8000000000000007, -3.600000000000001, -4.000000000000001, -3.9000000000000012, -4.000000000000001, -3.9000000000000012, -4.100000000000001, -3.900000000000001, -3.9000000000000004, -4.100000000000001, -4.000000000000002, -3.8000000000000007, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -4.000000000000002, -3.700000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -4.0, -3.800000000000001, -4.100000000000001, -3.900000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 2, 4, 21, 5, 4, 21, 3, 21, 21, 3, 2, 2, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.712265892467986, "mean_inference_ms": 18.219255702810507, "mean_action_processing_ms": 0.9448242061964329, "mean_env_wait_ms": 1.641385447244866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0737670696142948, "StateBufferConnector_ms": 0.009911590152316622, "ViewRequirementAgentConnector_ms": 0.13428721765075066}}, "episode_reward_max": -3.500000000000001, "episode_reward_min": -11.6, "episode_reward_mean": -4.33989898989899, "episode_len_mean": 19.8989898989899, "episodes_this_iter": 198, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.700000000000001, -3.700000000000001, -3.7000000000000006, -4.200000000000001, -3.8000000000000007, -3.7000000000000006, -3.900000000000001, -10.3, -4.100000000000001, -3.500000000000001, -10.1, -10.3, -3.8000000000000007, -10.4, -10.3, -3.7000000000000006, -10.3, -3.8000000000000007, -3.800000000000001, -10.2, -10.1, -10.1, -3.9000000000000012, -10.1, -3.800000000000001, -3.900000000000001, -3.800000000000001, -4.000000000000001, -4.000000000000002, -3.500000000000001, -3.900000000000001, -3.7000000000000006, -4.1000000000000005, -3.7000000000000006, -4.100000000000001, -3.6000000000000005, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.200000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000002, -4.000000000000002, -3.8000000000000007, -3.900000000000001, -3.800000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.200000000000001, -3.9000000000000012, -4.000000000000001, -4.000000000000001, -3.6000000000000005, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.9000000000000004, -4.300000000000001, -3.8000000000000007, -4.000000000000002, -4.1000000000000005, -4.0, -3.900000000000001, -3.800000000000001, -3.9000000000000004, -3.800000000000001, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -4.0, -3.900000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000002, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.300000000000001, -3.600000000000001, -3.7000000000000006, -3.8000000000000007, -4.000000000000002, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000002, -3.9000000000000012, -3.800000000000001, -3.9000000000000012, -3.600000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -4.200000000000001, -3.7000000000000006, -3.8000000000000007, -3.8000000000000016, -3.7000000000000006, -4.000000000000001, -4.0, -4.100000000000001, -3.900000000000001, -4.200000000000001, -3.900000000000001, -3.900000000000001, -10.5, -4.100000000000001, -11.6, -4.000000000000001, -3.700000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -3.800000000000001, -3.7000000000000006, -4.100000000000001, -3.700000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000002, -4.000000000000001, -4.0, -4.100000000000001, -3.600000000000001, -4.100000000000001, -4.100000000000001, -3.700000000000001, -3.7000000000000006, -3.900000000000001, -4.000000000000002, -3.800000000000001, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -3.7000000000000006, -3.800000000000001, -3.700000000000001, -3.9000000000000004, -4.300000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.7000000000000006, -4.300000000000001, -4.200000000000001, -4.000000000000002, -3.7000000000000006, -3.8000000000000007, -3.7000000000000006, -4.1000000000000005, -3.8000000000000007, -3.7000000000000006, -4.100000000000001, -3.6000000000000005, -4.000000000000002, -4.400000000000001, -3.7000000000000006, -3.8000000000000007, -10.7, -3.600000000000001, -4.200000000000001, -3.8000000000000007, -3.600000000000001, -4.000000000000001, -3.9000000000000012, -4.000000000000001, -3.9000000000000012, -4.100000000000001, -3.900000000000001, -3.9000000000000004, -4.100000000000001, -4.000000000000002, -3.8000000000000007, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -4.000000000000002, -3.700000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -4.0, -3.800000000000001, -4.100000000000001, -3.900000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 2, 4, 21, 5, 4, 21, 3, 21, 21, 3, 2, 2, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.712265892467986, "mean_inference_ms": 18.219255702810507, "mean_action_processing_ms": 0.9448242061964329, "mean_env_wait_ms": 1.641385447244866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0737670696142948, "StateBufferConnector_ms": 0.009911590152316622, "ViewRequirementAgentConnector_ms": 0.13428721765075066}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 296000, "timers": {"training_iteration_time_ms": 170915.327, "load_time_ms": 1.191, "load_throughput": 3359676.392, "learn_time_ms": 169956.343, "learn_throughput": 23.535, "synch_weights_time_ms": 179.195}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000}, "done": false, "episodes_total": 15359, "training_iteration": 74, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_00-26-26", "timestamp": 1680819986, "time_this_iter_s": 170.84369707107544, "time_total_s": 12649.914933681488, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f014746e8e0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0147488790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 12649.914933681488, "timesteps_since_restore": 0, "iterations_since_restore": 74, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.57283950617284, "ram_util_percent": 24.104115226337452}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.597629308956925, "cur_kl_coeff": 7.79357046112418, "cur_lr": 0.01, "total_loss": 0.36617978804454365, "policy_loss": -0.0011680195463560923, "vf_loss": 0.29411039871554223, "vf_explained_var": 0.6473580194416867, "kl": 0.009397157156506368, "entropy": 2.8918992985961256, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 69285.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "sampler_results": {"episode_reward_max": -3.5000000000000004, "episode_reward_min": -12.1, "episode_reward_mean": -4.160824742268042, "episode_len_mean": 20.644329896907216, "episode_media": {}, "episodes_this_iter": 194, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.000000000000001, -10.9, -4.1000000000000005, -4.000000000000001, -3.8000000000000003, -4.0, -3.8000000000000007, -3.8000000000000007, -10.2, -4.000000000000001, -3.7000000000000006, -3.7, -4.000000000000001, -3.8000000000000007, -3.9000000000000012, -3.8000000000000007, -3.8000000000000003, -4.200000000000001, -3.8000000000000003, -3.8000000000000007, -4.0, -3.9000000000000004, -3.900000000000001, -4.100000000000001, -3.6000000000000005, -3.900000000000001, -3.900000000000001, -4.100000000000001, -4.200000000000001, -3.7000000000000006, -3.6000000000000005, -4.000000000000002, -3.500000000000001, -3.9000000000000012, -3.9000000000000012, -4.100000000000001, -4.000000000000002, -4.000000000000001, -3.7000000000000006, -4.300000000000001, -4.200000000000001, -3.9000000000000004, -3.900000000000001, -4.0, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -4.1000000000000005, -4.100000000000001, -4.200000000000001, -3.7000000000000006, -4.100000000000001, -11.2, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000002, -3.9000000000000012, -3.9000000000000004, -4.000000000000001, -3.900000000000001, -4.200000000000001, -4.100000000000001, -3.800000000000001, -3.6000000000000005, -3.9000000000000012, -3.8000000000000003, -3.800000000000001, -3.900000000000001, -3.800000000000001, -4.100000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.200000000000001, -4.300000000000001, -4.000000000000001, -3.9000000000000012, -4.000000000000002, -3.8000000000000007, -4.100000000000001, -4.300000000000001, -4.200000000000001, -3.8000000000000003, -4.1000000000000005, -4.200000000000001, -4.200000000000001, -3.8000000000000007, -4.200000000000001, -4.000000000000001, -3.9000000000000004, -3.900000000000001, -3.7000000000000006, -10.7, -3.900000000000001, -3.600000000000001, -12.0, -3.900000000000001, -3.600000000000001, -12.1, -4.000000000000001, -3.800000000000001, -3.5000000000000004, -4.100000000000001, -3.900000000000001, -3.900000000000001, -3.9000000000000012, -3.900000000000001, -3.9000000000000012, -3.600000000000001, -4.100000000000001, -4.000000000000002, -3.7000000000000006, -3.900000000000001, -3.9000000000000004, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -4.300000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -3.700000000000001, -3.800000000000001, -4.200000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.700000000000001, -3.9000000000000004, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -3.5000000000000004, -4.100000000000001, -3.8000000000000007, -3.9000000000000004, -4.200000000000001, -4.000000000000001, -4.200000000000001, -3.900000000000001, -3.9000000000000012, -3.8000000000000007, -3.800000000000001, -3.8000000000000007, -3.9000000000000004, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -3.6000000000000005, -3.6000000000000005, -3.8000000000000007, -3.9000000000000012, -4.000000000000002, -4.1000000000000005, -3.7000000000000006, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.200000000000001, -4.200000000000001, -3.800000000000001, -3.900000000000001, -3.8000000000000007, -4.1000000000000005, -3.9000000000000012, -4.000000000000002, -3.9000000000000012, -4.000000000000001, -3.800000000000001, -3.600000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001], "episode_lengths": [21, 8, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 14, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.70568499684369, "mean_inference_ms": 18.208337843602752, "mean_action_processing_ms": 0.9443242395133847, "mean_env_wait_ms": 1.6328429642275937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07995858634870077, "StateBufferConnector_ms": 0.01033372485760561, "ViewRequirementAgentConnector_ms": 0.14511051866197094}}, "episode_reward_max": -3.5000000000000004, "episode_reward_min": -12.1, "episode_reward_mean": -4.160824742268042, "episode_len_mean": 20.644329896907216, "episodes_this_iter": 194, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.000000000000001, -10.9, -4.1000000000000005, -4.000000000000001, -3.8000000000000003, -4.0, -3.8000000000000007, -3.8000000000000007, -10.2, -4.000000000000001, -3.7000000000000006, -3.7, -4.000000000000001, -3.8000000000000007, -3.9000000000000012, -3.8000000000000007, -3.8000000000000003, -4.200000000000001, -3.8000000000000003, -3.8000000000000007, -4.0, -3.9000000000000004, -3.900000000000001, -4.100000000000001, -3.6000000000000005, -3.900000000000001, -3.900000000000001, -4.100000000000001, -4.200000000000001, -3.7000000000000006, -3.6000000000000005, -4.000000000000002, -3.500000000000001, -3.9000000000000012, -3.9000000000000012, -4.100000000000001, -4.000000000000002, -4.000000000000001, -3.7000000000000006, -4.300000000000001, -4.200000000000001, -3.9000000000000004, -3.900000000000001, -4.0, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -4.1000000000000005, -4.100000000000001, -4.200000000000001, -3.7000000000000006, -4.100000000000001, -11.2, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000002, -3.9000000000000012, -3.9000000000000004, -4.000000000000001, -3.900000000000001, -4.200000000000001, -4.100000000000001, -3.800000000000001, -3.6000000000000005, -3.9000000000000012, -3.8000000000000003, -3.800000000000001, -3.900000000000001, -3.800000000000001, -4.100000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.200000000000001, -4.300000000000001, -4.000000000000001, -3.9000000000000012, -4.000000000000002, -3.8000000000000007, -4.100000000000001, -4.300000000000001, -4.200000000000001, -3.8000000000000003, -4.1000000000000005, -4.200000000000001, -4.200000000000001, -3.8000000000000007, -4.200000000000001, -4.000000000000001, -3.9000000000000004, -3.900000000000001, -3.7000000000000006, -10.7, -3.900000000000001, -3.600000000000001, -12.0, -3.900000000000001, -3.600000000000001, -12.1, -4.000000000000001, -3.800000000000001, -3.5000000000000004, -4.100000000000001, -3.900000000000001, -3.900000000000001, -3.9000000000000012, -3.900000000000001, -3.9000000000000012, -3.600000000000001, -4.100000000000001, -4.000000000000002, -3.7000000000000006, -3.900000000000001, -3.9000000000000004, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -4.300000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -3.700000000000001, -3.800000000000001, -4.200000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.700000000000001, -3.9000000000000004, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -3.5000000000000004, -4.100000000000001, -3.8000000000000007, -3.9000000000000004, -4.200000000000001, -4.000000000000001, -4.200000000000001, -3.900000000000001, -3.9000000000000012, -3.8000000000000007, -3.800000000000001, -3.8000000000000007, -3.9000000000000004, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -3.6000000000000005, -3.6000000000000005, -3.8000000000000007, -3.9000000000000012, -4.000000000000002, -4.1000000000000005, -3.7000000000000006, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.200000000000001, -4.200000000000001, -3.800000000000001, -3.900000000000001, -3.8000000000000007, -4.1000000000000005, -3.9000000000000012, -4.000000000000002, -3.9000000000000012, -4.000000000000001, -3.800000000000001, -3.600000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001], "episode_lengths": [21, 8, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 14, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.70568499684369, "mean_inference_ms": 18.208337843602752, "mean_action_processing_ms": 0.9443242395133847, "mean_env_wait_ms": 1.6328429642275937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07995858634870077, "StateBufferConnector_ms": 0.01033372485760561, "ViewRequirementAgentConnector_ms": 0.14511051866197094}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 300000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 300000, "timers": {"training_iteration_time_ms": 170843.854, "load_time_ms": 1.189, "load_throughput": 3364325.018, "learn_time_ms": 169882.29, "learn_throughput": 23.546, "synch_weights_time_ms": 182.012}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "done": false, "episodes_total": 15553, "training_iteration": 75, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_00-29-17", "timestamp": 1680820157, "time_this_iter_s": 170.47643423080444, "time_total_s": 12820.391367912292, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f014746e2b0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01473d84c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 12820.391367912292, "timesteps_since_restore": 0, "iterations_since_restore": 75, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.332644628099174, "ram_util_percent": 24.103305785123972}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.030197533228064, "cur_kl_coeff": 7.79357046112418, "cur_lr": 0.01, "total_loss": 0.38071678287640054, "policy_loss": -0.004188987787973175, "vf_loss": 0.28959045268354877, "vf_explained_var": 0.6594174672839462, "kl": 0.012229993806992938, "entropy": 2.881684914968347, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 70215.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "sampler_results": {"episode_reward_max": -3.500000000000001, "episode_reward_min": -11.5, "episode_reward_mean": -4.275634517766498, "episode_len_mean": 20.279187817258883, "episode_media": {}, "episodes_this_iter": 197, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.4, -11.5, -3.9000000000000012, -3.7000000000000006, -3.8000000000000003, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.800000000000001, -10.6, -11.2, -10.1, -3.6000000000000005, -3.8000000000000007, -10.5, -3.900000000000001, -10.8, -3.600000000000001, -4.100000000000001, -3.8000000000000003, -4.000000000000001, -10.4, -3.8000000000000007, -4.100000000000001, -4.0, -3.800000000000001, -4.000000000000002, -3.700000000000001, -3.900000000000001, -4.000000000000001, -4.1000000000000005, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.800000000000001, -3.8000000000000007, -4.200000000000001, -3.7000000000000006, -3.8000000000000007, -4.200000000000001, -3.800000000000001, -3.900000000000001, -4.200000000000001, -3.800000000000001, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -4.000000000000002, -4.000000000000001, -3.800000000000001, -4.000000000000002, -4.000000000000001, -4.200000000000001, -4.100000000000001, -3.7000000000000006, -4.1000000000000005, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.700000000000001, -3.800000000000001, -3.900000000000001, -4.200000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -3.7000000000000006, -4.000000000000001, -4.200000000000001, -4.1000000000000005, -4.000000000000001, -3.900000000000001, -3.7000000000000006, -4.000000000000002, -3.8000000000000007, -3.900000000000001, -3.700000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000002, -4.1000000000000005, -3.900000000000001, -3.9000000000000012, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -4.100000000000001, -4.000000000000002, -3.700000000000001, -3.900000000000001, -3.9000000000000012, -4.1000000000000005, -3.900000000000001, -10.5, -10.7, -3.900000000000001, -3.9000000000000004, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000002, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.600000000000001, -4.200000000000001, -3.900000000000001, -3.700000000000001, -4.000000000000002, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.9000000000000004, -4.000000000000001, -3.600000000000001, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -4.1000000000000005, -3.7000000000000006, -4.0, -4.100000000000001, -3.7000000000000006, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -3.9000000000000004, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -3.7000000000000006, -3.9000000000000012, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -4.100000000000001, -4.1000000000000005, -4.200000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.200000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -4.200000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -4.100000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -3.800000000000001, -3.7000000000000006, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -4.400000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -4.0, -4.100000000000001, -4.1000000000000005, -3.8000000000000007, -4.000000000000002, -4.100000000000001, -4.100000000000001, -3.800000000000001, -4.000000000000001, -3.500000000000001, -3.900000000000001], "episode_lengths": [11, 12, 21, 21, 21, 21, 21, 21, 21, 6, 9, 2, 21, 21, 5, 21, 7, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.704884592224827, "mean_inference_ms": 18.21839510516256, "mean_action_processing_ms": 0.9448026677989798, "mean_env_wait_ms": 1.6343950480911473, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07635881452996114, "StateBufferConnector_ms": 0.010385973199369944, "ViewRequirementAgentConnector_ms": 0.14104818934716548}}, "episode_reward_max": -3.500000000000001, "episode_reward_min": -11.5, "episode_reward_mean": -4.275634517766498, "episode_len_mean": 20.279187817258883, "episodes_this_iter": 197, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11.4, -11.5, -3.9000000000000012, -3.7000000000000006, -3.8000000000000003, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.800000000000001, -10.6, -11.2, -10.1, -3.6000000000000005, -3.8000000000000007, -10.5, -3.900000000000001, -10.8, -3.600000000000001, -4.100000000000001, -3.8000000000000003, -4.000000000000001, -10.4, -3.8000000000000007, -4.100000000000001, -4.0, -3.800000000000001, -4.000000000000002, -3.700000000000001, -3.900000000000001, -4.000000000000001, -4.1000000000000005, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.800000000000001, -3.8000000000000007, -4.200000000000001, -3.7000000000000006, -3.8000000000000007, -4.200000000000001, -3.800000000000001, -3.900000000000001, -4.200000000000001, -3.800000000000001, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -4.000000000000002, -4.000000000000001, -3.800000000000001, -4.000000000000002, -4.000000000000001, -4.200000000000001, -4.100000000000001, -3.7000000000000006, -4.1000000000000005, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.700000000000001, -3.800000000000001, -3.900000000000001, -4.200000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -3.7000000000000006, -4.000000000000001, -4.200000000000001, -4.1000000000000005, -4.000000000000001, -3.900000000000001, -3.7000000000000006, -4.000000000000002, -3.8000000000000007, -3.900000000000001, -3.700000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000002, -4.1000000000000005, -3.900000000000001, -3.9000000000000012, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -4.100000000000001, -4.000000000000002, -3.700000000000001, -3.900000000000001, -3.9000000000000012, -4.1000000000000005, -3.900000000000001, -10.5, -10.7, -3.900000000000001, -3.9000000000000004, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000002, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.600000000000001, -4.200000000000001, -3.900000000000001, -3.700000000000001, -4.000000000000002, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.9000000000000004, -4.000000000000001, -3.600000000000001, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -4.1000000000000005, -3.7000000000000006, -4.0, -4.100000000000001, -3.7000000000000006, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -3.9000000000000004, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -3.7000000000000006, -3.9000000000000012, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -4.100000000000001, -4.1000000000000005, -4.200000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.200000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -4.200000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -4.100000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -3.800000000000001, -3.7000000000000006, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -4.400000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -4.0, -4.100000000000001, -4.1000000000000005, -3.8000000000000007, -4.000000000000002, -4.100000000000001, -4.100000000000001, -3.800000000000001, -4.000000000000001, -3.500000000000001, -3.900000000000001], "episode_lengths": [11, 12, 21, 21, 21, 21, 21, 21, 21, 6, 9, 2, 21, 21, 5, 21, 7, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.704884592224827, "mean_inference_ms": 18.21839510516256, "mean_action_processing_ms": 0.9448026677989798, "mean_env_wait_ms": 1.6343950480911473, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07635881452996114, "StateBufferConnector_ms": 0.010385973199369944, "ViewRequirementAgentConnector_ms": 0.14104818934716548}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 170819.39, "load_time_ms": 1.174, "load_throughput": 3407994.475, "learn_time_ms": 169855.991, "learn_throughput": 23.549, "synch_weights_time_ms": 181.776}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "done": false, "episodes_total": 15750, "training_iteration": 76, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_00-32-07", "timestamp": 1680820327, "time_this_iter_s": 170.65794134140015, "time_total_s": 12991.049309253693, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476d1610>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01474738b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 12991.049309253693, "timesteps_since_restore": 0, "iterations_since_restore": 76, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.389300411522633, "ram_util_percent": 24.111934156378602}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.88286735434686, "cur_kl_coeff": 7.79357046112418, "cur_lr": 0.01, "total_loss": 0.5958808064721124, "policy_loss": 0.0016941259229575755, "vf_loss": 0.46741755887545566, "vf_explained_var": 0.6589464595240931, "kl": 0.016265859521026674, "entropy": 2.8449700886203395, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 71145.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000}, "sampler_results": {"episode_reward_max": -3.5000000000000004, "episode_reward_min": -13.100000000000001, "episode_reward_mean": -4.4725, "episode_len_mean": 20.025, "episode_media": {}, "episodes_this_iter": 200, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.000000000000001, -3.9000000000000004, -4.000000000000002, -4.1000000000000005, -10.4, -3.9000000000000012, -11.1, -4.000000000000001, -10.4, -10.5, -3.9000000000000012, -11.3, -4.000000000000001, -4.200000000000001, -3.500000000000001, -10.7, -4.100000000000001, -4.100000000000001, -3.6000000000000005, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.7000000000000006, -10.1, -4.0, -10.7, -10.9, -4.000000000000001, -4.200000000000001, -4.100000000000001, -3.7000000000000006, -4.100000000000001, -3.7000000000000006, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.200000000000001, -3.900000000000001, -4.0, -4.100000000000001, -3.700000000000001, -3.900000000000001, -4.300000000000001, -3.8000000000000007, -3.9000000000000012, -3.8000000000000003, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -13.100000000000001, -4.0, -3.7000000000000006, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -3.9000000000000012, -4.000000000000001, -4.200000000000001, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -4.200000000000001, -3.8000000000000007, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -4.000000000000001, -4.300000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000002, -3.900000000000001, -4.100000000000001, -3.9000000000000004, -3.8000000000000007, -4.000000000000002, -4.300000000000001, -4.1000000000000005, -4.000000000000002, -4.100000000000001, -3.8000000000000007, -3.9000000000000012, -3.900000000000001, -3.8000000000000007, -4.000000000000002, -3.900000000000001, -3.900000000000001, -3.800000000000001, -3.8000000000000007, -3.6000000000000005, -10.4, -3.8000000000000007, -4.000000000000001, -3.6000000000000005, -4.100000000000001, -3.7000000000000006, -3.900000000000001, -3.900000000000001, -12.0, -10.6, -4.100000000000001, -4.000000000000001, -4.000000000000001, -11.3, -4.100000000000001, -10.4, -3.8000000000000007, -4.000000000000001, -3.800000000000001, -3.7, -4.200000000000001, -4.000000000000002, -4.000000000000002, -4.000000000000001, -4.000000000000001, -3.600000000000001, -3.7000000000000006, -4.100000000000001, -3.8000000000000007, -4.1000000000000005, -3.8000000000000007, -3.500000000000001, -3.900000000000001, -3.800000000000001, -3.500000000000001, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -4.000000000000002, -4.300000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000001, -4.1000000000000005, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000002, -4.000000000000002, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -4.100000000000001, -3.900000000000001, -3.7000000000000006, -4.200000000000001, -4.000000000000001, -4.000000000000001, -4.200000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -4.200000000000001, -3.900000000000001, -3.9000000000000004, -4.200000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -3.5000000000000004, -3.900000000000001, -4.100000000000001, -4.000000000000002, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.9000000000000004, -3.8000000000000003, -4.200000000000001, -3.900000000000001, -4.200000000000001, -3.7000000000000006, -3.900000000000001, -3.6000000000000005, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007], "episode_lengths": [21, 21, 21, 21, 5, 21, 10, 21, 5, 6, 21, 12, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 2, 21, 6, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 15, 6, 21, 21, 21, 10, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.711595228165486, "mean_inference_ms": 18.224958671059877, "mean_action_processing_ms": 0.944579218518494, "mean_env_wait_ms": 1.6359258804284158, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08043599128723145, "StateBufferConnector_ms": 0.010587573051452637, "ViewRequirementAgentConnector_ms": 0.14759480953216553}}, "episode_reward_max": -3.5000000000000004, "episode_reward_min": -13.100000000000001, "episode_reward_mean": -4.4725, "episode_len_mean": 20.025, "episodes_this_iter": 200, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.000000000000001, -3.9000000000000004, -4.000000000000002, -4.1000000000000005, -10.4, -3.9000000000000012, -11.1, -4.000000000000001, -10.4, -10.5, -3.9000000000000012, -11.3, -4.000000000000001, -4.200000000000001, -3.500000000000001, -10.7, -4.100000000000001, -4.100000000000001, -3.6000000000000005, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.7000000000000006, -10.1, -4.0, -10.7, -10.9, -4.000000000000001, -4.200000000000001, -4.100000000000001, -3.7000000000000006, -4.100000000000001, -3.7000000000000006, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.200000000000001, -3.900000000000001, -4.0, -4.100000000000001, -3.700000000000001, -3.900000000000001, -4.300000000000001, -3.8000000000000007, -3.9000000000000012, -3.8000000000000003, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -13.100000000000001, -4.0, -3.7000000000000006, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -3.9000000000000012, -4.000000000000001, -4.200000000000001, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -4.200000000000001, -3.8000000000000007, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -4.000000000000001, -4.300000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000002, -3.900000000000001, -4.100000000000001, -3.9000000000000004, -3.8000000000000007, -4.000000000000002, -4.300000000000001, -4.1000000000000005, -4.000000000000002, -4.100000000000001, -3.8000000000000007, -3.9000000000000012, -3.900000000000001, -3.8000000000000007, -4.000000000000002, -3.900000000000001, -3.900000000000001, -3.800000000000001, -3.8000000000000007, -3.6000000000000005, -10.4, -3.8000000000000007, -4.000000000000001, -3.6000000000000005, -4.100000000000001, -3.7000000000000006, -3.900000000000001, -3.900000000000001, -12.0, -10.6, -4.100000000000001, -4.000000000000001, -4.000000000000001, -11.3, -4.100000000000001, -10.4, -3.8000000000000007, -4.000000000000001, -3.800000000000001, -3.7, -4.200000000000001, -4.000000000000002, -4.000000000000002, -4.000000000000001, -4.000000000000001, -3.600000000000001, -3.7000000000000006, -4.100000000000001, -3.8000000000000007, -4.1000000000000005, -3.8000000000000007, -3.500000000000001, -3.900000000000001, -3.800000000000001, -3.500000000000001, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -4.000000000000002, -4.300000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000001, -4.1000000000000005, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000002, -4.000000000000002, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -4.100000000000001, -3.900000000000001, -3.7000000000000006, -4.200000000000001, -4.000000000000001, -4.000000000000001, -4.200000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -4.200000000000001, -3.900000000000001, -3.9000000000000004, -4.200000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -3.5000000000000004, -3.900000000000001, -4.100000000000001, -4.000000000000002, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.9000000000000004, -3.8000000000000003, -4.200000000000001, -3.900000000000001, -4.200000000000001, -3.7000000000000006, -3.900000000000001, -3.6000000000000005, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007], "episode_lengths": [21, 21, 21, 21, 5, 21, 10, 21, 5, 6, 21, 12, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 2, 21, 6, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 15, 6, 21, 21, 21, 10, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.711595228165486, "mean_inference_ms": 18.224958671059877, "mean_action_processing_ms": 0.944579218518494, "mean_env_wait_ms": 1.6359258804284158, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08043599128723145, "StateBufferConnector_ms": 0.010587573051452637, "ViewRequirementAgentConnector_ms": 0.14759480953216553}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 308000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 308000, "timers": {"training_iteration_time_ms": 170800.118, "load_time_ms": 1.179, "load_throughput": 3393312.568, "learn_time_ms": 169829.983, "learn_throughput": 23.553, "synch_weights_time_ms": 186.362}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000}, "done": false, "episodes_total": 15950, "training_iteration": 77, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_00-34-58", "timestamp": 1680820498, "time_this_iter_s": 170.9489631652832, "time_total_s": 13161.998272418976, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476b9bb0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01473a5f70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 13161.998272418976, "timesteps_since_restore": 0, "iterations_since_restore": 77, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.283950617283951, "ram_util_percent": 24.1045267489712}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.393742671064151, "cur_kl_coeff": 7.79357046112418, "cur_lr": 0.01, "total_loss": 0.4974941532618256, "policy_loss": -0.006472459963713121, "vf_loss": 0.35246072119121913, "vf_explained_var": 0.7217350518831642, "kl": 0.019439856486297362, "entropy": 2.8348895624119748, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 72075.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "sampler_results": {"episode_reward_max": -3.400000000000001, "episode_reward_min": -12.1, "episode_reward_mean": -4.290594059405941, "episode_len_mean": 20.178217821782177, "episode_media": {}, "episodes_this_iter": 202, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.1, -3.700000000000001, -10.3, -11.4, -3.8000000000000007, -3.800000000000001, -3.9000000000000017, -10.6, -10.4, -3.6000000000000005, -3.8000000000000007, -10.3, -4.000000000000001, -3.800000000000001, -4.200000000000001, -3.9000000000000012, -3.8000000000000007, -10.1, -3.900000000000001, -4.100000000000001, -3.400000000000001, -4.200000000000001, -10.7, -10.4, -3.6000000000000005, -3.9000000000000004, -10.1, -3.8000000000000007, -3.6000000000000005, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.6000000000000005, -4.100000000000001, -3.900000000000001, -4.300000000000001, -4.0, -4.100000000000001, -3.900000000000001, -4.200000000000001, -3.700000000000001, -4.100000000000001, -3.9000000000000012, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -4.200000000000001, -4.200000000000001, -3.900000000000001, -3.8000000000000007, -4.300000000000001, -3.900000000000001, -3.800000000000001, -4.000000000000001, -3.9000000000000012, -3.6000000000000005, -3.6000000000000005, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.9000000000000004, -4.000000000000002, -4.000000000000001, -3.700000000000001, -4.000000000000001, -3.800000000000001, -3.8000000000000007, -3.9000000000000012, -4.000000000000001, -4.000000000000002, -4.300000000000001, -4.000000000000002, -3.7000000000000006, -3.9000000000000012, -3.700000000000001, -4.300000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000002, -3.5000000000000004, -4.000000000000001, -4.000000000000002, -4.100000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -3.800000000000001, -4.000000000000001, -3.9000000000000012, -3.8000000000000007, -4.1000000000000005, -3.8000000000000007, -3.6000000000000005, -10.4, -3.8000000000000007, -3.7, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.8000000000000003, -3.6000000000000005, -4.000000000000001, -3.900000000000001, -3.8000000000000003, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000002, -4.300000000000001, -3.900000000000001, -3.8000000000000007, -3.800000000000001, -3.9000000000000012, -3.600000000000001, -3.800000000000001, -4.200000000000001, -4.1000000000000005, -4.100000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -3.900000000000001, -3.700000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.800000000000001, -3.700000000000001, -3.8000000000000007, -3.9000000000000004, -4.200000000000001, -3.900000000000001, -3.8000000000000007, -4.0, -3.8000000000000003, -3.700000000000001, -4.200000000000001, -3.6000000000000005, -3.900000000000001, -4.000000000000001, -4.000000000000002, -4.000000000000001, -4.100000000000001, -3.9000000000000012, -3.600000000000001, -4.000000000000001, -3.9000000000000004, -3.7000000000000006, -3.8000000000000007, -3.900000000000001, -3.9000000000000012, -4.0, -3.900000000000001, -4.200000000000001, -4.000000000000001, -3.500000000000001, -4.200000000000001, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -3.6000000000000005, -4.100000000000001, -3.700000000000001, -4.200000000000001, -3.8000000000000007, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.800000000000001, -4.300000000000001, -4.200000000000001, -3.8000000000000007, -3.9000000000000004, -4.000000000000001, -3.9000000000000012, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -3.9000000000000004, -4.100000000000001, -4.200000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -3.700000000000001], "episode_lengths": [16, 21, 4, 12, 21, 21, 21, 6, 4, 21, 21, 4, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 6, 4, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.705165583227478, "mean_inference_ms": 18.22772169254401, "mean_action_processing_ms": 0.9453964504388789, "mean_env_wait_ms": 1.635462925594272, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08439946882795579, "StateBufferConnector_ms": 0.010749609163492033, "ViewRequirementAgentConnector_ms": 0.15411872674923133}}, "episode_reward_max": -3.400000000000001, "episode_reward_min": -12.1, "episode_reward_mean": -4.290594059405941, "episode_len_mean": 20.178217821782177, "episodes_this_iter": 202, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-12.1, -3.700000000000001, -10.3, -11.4, -3.8000000000000007, -3.800000000000001, -3.9000000000000017, -10.6, -10.4, -3.6000000000000005, -3.8000000000000007, -10.3, -4.000000000000001, -3.800000000000001, -4.200000000000001, -3.9000000000000012, -3.8000000000000007, -10.1, -3.900000000000001, -4.100000000000001, -3.400000000000001, -4.200000000000001, -10.7, -10.4, -3.6000000000000005, -3.9000000000000004, -10.1, -3.8000000000000007, -3.6000000000000005, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.6000000000000005, -4.100000000000001, -3.900000000000001, -4.300000000000001, -4.0, -4.100000000000001, -3.900000000000001, -4.200000000000001, -3.700000000000001, -4.100000000000001, -3.9000000000000012, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -4.200000000000001, -4.200000000000001, -3.900000000000001, -3.8000000000000007, -4.300000000000001, -3.900000000000001, -3.800000000000001, -4.000000000000001, -3.9000000000000012, -3.6000000000000005, -3.6000000000000005, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.9000000000000004, -4.000000000000002, -4.000000000000001, -3.700000000000001, -4.000000000000001, -3.800000000000001, -3.8000000000000007, -3.9000000000000012, -4.000000000000001, -4.000000000000002, -4.300000000000001, -4.000000000000002, -3.7000000000000006, -3.9000000000000012, -3.700000000000001, -4.300000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000002, -3.5000000000000004, -4.000000000000001, -4.000000000000002, -4.100000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -3.800000000000001, -4.000000000000001, -3.9000000000000012, -3.8000000000000007, -4.1000000000000005, -3.8000000000000007, -3.6000000000000005, -10.4, -3.8000000000000007, -3.7, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.8000000000000003, -3.6000000000000005, -4.000000000000001, -3.900000000000001, -3.8000000000000003, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000002, -4.300000000000001, -3.900000000000001, -3.8000000000000007, -3.800000000000001, -3.9000000000000012, -3.600000000000001, -3.800000000000001, -4.200000000000001, -4.1000000000000005, -4.100000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -3.900000000000001, -3.700000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.800000000000001, -3.700000000000001, -3.8000000000000007, -3.9000000000000004, -4.200000000000001, -3.900000000000001, -3.8000000000000007, -4.0, -3.8000000000000003, -3.700000000000001, -4.200000000000001, -3.6000000000000005, -3.900000000000001, -4.000000000000001, -4.000000000000002, -4.000000000000001, -4.100000000000001, -3.9000000000000012, -3.600000000000001, -4.000000000000001, -3.9000000000000004, -3.7000000000000006, -3.8000000000000007, -3.900000000000001, -3.9000000000000012, -4.0, -3.900000000000001, -4.200000000000001, -4.000000000000001, -3.500000000000001, -4.200000000000001, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -3.6000000000000005, -4.100000000000001, -3.700000000000001, -4.200000000000001, -3.8000000000000007, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.800000000000001, -4.300000000000001, -4.200000000000001, -3.8000000000000007, -3.9000000000000004, -4.000000000000001, -3.9000000000000012, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -3.9000000000000004, -4.100000000000001, -4.200000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -3.700000000000001], "episode_lengths": [16, 21, 4, 12, 21, 21, 21, 6, 4, 21, 21, 4, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 6, 4, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.705165583227478, "mean_inference_ms": 18.22772169254401, "mean_action_processing_ms": 0.9453964504388789, "mean_env_wait_ms": 1.635462925594272, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08439946882795579, "StateBufferConnector_ms": 0.010749609163492033, "ViewRequirementAgentConnector_ms": 0.15411872674923133}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 312000, "timers": {"training_iteration_time_ms": 170816.865, "load_time_ms": 1.188, "load_throughput": 3366958.197, "learn_time_ms": 169846.299, "learn_throughput": 23.551, "synch_weights_time_ms": 185.642}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "done": false, "episodes_total": 16152, "training_iteration": 78, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_00-37-50", "timestamp": 1680820670, "time_this_iter_s": 171.05277848243713, "time_total_s": 13333.051050901413, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01475e28e0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0147473d30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 13333.051050901413, "timesteps_since_restore": 0, "iterations_since_restore": 78, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.5172839506172835, "ram_util_percent": 24.118518518518517}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.879228789575638, "cur_kl_coeff": 7.79357046112418, "cur_lr": 0.01, "total_loss": 0.5547377270996892, "policy_loss": -0.0012277742512323843, "vf_loss": 0.4093276382053411, "vf_explained_var": 0.6503032584985097, "kl": 0.018815235515320373, "entropy": 2.8404655917998283, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 73005.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 316000}, "sampler_results": {"episode_reward_max": -3.600000000000001, "episode_reward_min": -12.2, "episode_reward_mean": -4.334693877551021, "episode_len_mean": 20.229591836734695, "episode_media": {}, "episodes_this_iter": 196, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.8000000000000007, -10.3, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -10.5, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -11.3, -3.8000000000000003, -3.8000000000000007, -10.9, -11.0, -3.7000000000000006, -3.800000000000001, -11.1, -3.9000000000000012, -4.100000000000001, -10.2, -3.7000000000000006, -10.7, -3.9000000000000004, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000002, -3.9000000000000012, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000002, -3.8000000000000007, -4.200000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -4.200000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.400000000000001, -4.300000000000002, -3.700000000000001, -3.800000000000001, -4.100000000000001, -3.900000000000001, -4.0, -4.1000000000000005, -3.900000000000001, -4.200000000000001, -4.000000000000002, -4.1000000000000005, -3.9000000000000012, -4.1000000000000005, -3.8000000000000007, -4.300000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -3.7000000000000006, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -3.8000000000000007, -3.700000000000001, -4.400000000000001, -4.100000000000001, -3.9000000000000012, -3.7000000000000006, -3.900000000000001, -3.8000000000000003, -4.100000000000001, -4.0, -12.2, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -3.800000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000002, -10.0, -10.8, -3.900000000000001, -4.0, -4.000000000000001, -4.000000000000001, -3.600000000000001, -3.900000000000001, -4.000000000000002, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -4.000000000000002, -4.0, -4.100000000000001, -4.0, -3.8000000000000007, -3.7000000000000006, -4.200000000000001, -3.600000000000001, -3.9000000000000012, -4.100000000000001, -4.100000000000001, -3.9000000000000012, -4.000000000000001, -4.200000000000001, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000002, -3.8000000000000003, -3.7000000000000006, -3.900000000000001, -4.1000000000000005, -4.000000000000002, -4.100000000000001, -4.100000000000001, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -4.100000000000001, -4.100000000000001, -3.7000000000000006, -3.700000000000001, -4.1000000000000005, -4.0, -4.300000000000001, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -4.200000000000001, -3.600000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -4.0, -3.7000000000000006, -4.000000000000001, -4.300000000000001, -4.000000000000002, -4.000000000000001, -3.900000000000001, -4.0, -4.200000000000001, -4.100000000000001, -4.100000000000001, -3.700000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.800000000000001, -4.0, -4.1000000000000005, -3.900000000000001, -3.900000000000001], "episode_lengths": [21, 4, 21, 21, 21, 21, 6, 21, 21, 21, 10, 21, 21, 8, 8, 21, 21, 9, 21, 21, 3, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.702429962129889, "mean_inference_ms": 18.224684928881043, "mean_action_processing_ms": 0.9451113404383046, "mean_env_wait_ms": 1.6268908221188394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07228754004653619, "StateBufferConnector_ms": 0.009502318440651407, "ViewRequirementAgentConnector_ms": 0.13208291968520808}}, "episode_reward_max": -3.600000000000001, "episode_reward_min": -12.2, "episode_reward_mean": -4.334693877551021, "episode_len_mean": 20.229591836734695, "episodes_this_iter": 196, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.8000000000000007, -10.3, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -10.5, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -11.3, -3.8000000000000003, -3.8000000000000007, -10.9, -11.0, -3.7000000000000006, -3.800000000000001, -11.1, -3.9000000000000012, -4.100000000000001, -10.2, -3.7000000000000006, -10.7, -3.9000000000000004, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000002, -3.9000000000000012, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000002, -3.8000000000000007, -4.200000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -4.200000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.400000000000001, -4.300000000000002, -3.700000000000001, -3.800000000000001, -4.100000000000001, -3.900000000000001, -4.0, -4.1000000000000005, -3.900000000000001, -4.200000000000001, -4.000000000000002, -4.1000000000000005, -3.9000000000000012, -4.1000000000000005, -3.8000000000000007, -4.300000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -3.7000000000000006, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -3.8000000000000007, -3.700000000000001, -4.400000000000001, -4.100000000000001, -3.9000000000000012, -3.7000000000000006, -3.900000000000001, -3.8000000000000003, -4.100000000000001, -4.0, -12.2, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -3.800000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000002, -10.0, -10.8, -3.900000000000001, -4.0, -4.000000000000001, -4.000000000000001, -3.600000000000001, -3.900000000000001, -4.000000000000002, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -4.000000000000002, -4.0, -4.100000000000001, -4.0, -3.8000000000000007, -3.7000000000000006, -4.200000000000001, -3.600000000000001, -3.9000000000000012, -4.100000000000001, -4.100000000000001, -3.9000000000000012, -4.000000000000001, -4.200000000000001, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000002, -3.8000000000000003, -3.7000000000000006, -3.900000000000001, -4.1000000000000005, -4.000000000000002, -4.100000000000001, -4.100000000000001, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -4.100000000000001, -4.100000000000001, -3.7000000000000006, -3.700000000000001, -4.1000000000000005, -4.0, -4.300000000000001, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -4.200000000000001, -3.600000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -4.0, -3.7000000000000006, -4.000000000000001, -4.300000000000001, -4.000000000000002, -4.000000000000001, -3.900000000000001, -4.0, -4.200000000000001, -4.100000000000001, -4.100000000000001, -3.700000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.800000000000001, -4.0, -4.1000000000000005, -3.900000000000001, -3.900000000000001], "episode_lengths": [21, 4, 21, 21, 21, 21, 6, 21, 21, 21, 10, 21, 21, 8, 8, 21, 21, 9, 21, 21, 3, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.702429962129889, "mean_inference_ms": 18.224684928881043, "mean_action_processing_ms": 0.9451113404383046, "mean_env_wait_ms": 1.6268908221188394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07228754004653619, "StateBufferConnector_ms": 0.009502318440651407, "ViewRequirementAgentConnector_ms": 0.13208291968520808}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 316000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 316000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 316000, "timers": {"training_iteration_time_ms": 170832.361, "load_time_ms": 1.19, "load_throughput": 3362369.682, "learn_time_ms": 169861.296, "learn_throughput": 23.549, "synch_weights_time_ms": 187.982}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 316000}, "done": false, "episodes_total": 16348, "training_iteration": 79, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_00-40-41", "timestamp": 1680820841, "time_this_iter_s": 171.38800311088562, "time_total_s": 13504.439054012299, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f014746e310>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01473a5f70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 13504.439054012299, "timesteps_since_restore": 0, "iterations_since_restore": 79, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.347131147540983, "ram_util_percent": 24.172131147540977}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.552553409914816, "cur_kl_coeff": 7.79357046112418, "cur_lr": 0.01, "total_loss": 0.46979829300875947, "policy_loss": 0.0030599841229637624, "vf_loss": 0.32616876565640973, "vf_explained_var": 0.6395844477479176, "kl": 0.018036603495498658, "entropy": 2.8172825813293456, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 73935.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "sampler_results": {"episode_reward_max": -3.5000000000000004, "episode_reward_min": -12.600000000000001, "episode_reward_mean": -4.156770833333334, "episode_len_mean": 20.625, "episode_media": {}, "episodes_this_iter": 192, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.9000000000000012, -10.4, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -12.600000000000001, -4.000000000000002, -10.4, -3.600000000000001, -3.900000000000001, -3.8000000000000003, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -3.7000000000000006, -10.3, -4.100000000000001, -4.100000000000001, -3.9000000000000012, -4.1000000000000005, -3.700000000000001, -3.700000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.800000000000001, -3.600000000000001, -4.200000000000001, -4.100000000000001, -4.100000000000001, -3.700000000000001, -4.200000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -4.300000000000001, -4.100000000000001, -4.100000000000001, -3.9000000000000012, -4.000000000000001, -3.800000000000001, -4.200000000000001, -3.6000000000000014, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -4.300000000000001, -4.300000000000001, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -3.8000000000000007, -3.700000000000001, -3.9000000000000004, -3.900000000000001, -3.8000000000000007, -3.9000000000000012, -4.200000000000001, -3.5000000000000004, -4.000000000000001, -4.200000000000001, -4.100000000000001, -4.200000000000001, -3.7000000000000006, -4.000000000000002, -4.000000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000002, -3.9000000000000012, -4.1000000000000005, -4.100000000000001, -3.7, -3.8000000000000007, -4.300000000000001, -4.0, -4.000000000000001, -3.5000000000000004, -3.7000000000000006, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -3.800000000000001, -4.100000000000001, -4.000000000000001, -3.800000000000001, -3.8000000000000003, -3.900000000000001, -4.100000000000001, -11.3, -3.900000000000001, -4.200000000000001, -3.8000000000000007, -3.6000000000000005, -3.9000000000000012, -3.900000000000001, -3.700000000000001, -3.700000000000001, -4.000000000000002, -3.7000000000000006, -3.8000000000000007, -3.700000000000001, -3.900000000000001, -4.000000000000002, -4.100000000000001, -3.8000000000000007, -3.9000000000000004, -3.900000000000001, -4.300000000000001, -3.900000000000001, -4.200000000000001, -3.600000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000002, -4.200000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -4.200000000000001, -4.1000000000000005, -3.9000000000000004, -4.100000000000001, -3.900000000000001, -4.000000000000001, -3.700000000000001, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -3.800000000000001, -3.9000000000000004, -3.8000000000000007, -3.800000000000001, -4.200000000000001, -3.7, -3.8000000000000007, -4.1000000000000005, -4.000000000000001, -3.900000000000001, -3.9000000000000012, -3.7000000000000006, -3.700000000000001, -4.0, -11.6, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -4.100000000000001, -3.800000000000001, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -4.300000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000002, -3.8000000000000003, -4.000000000000002, -3.7000000000000006, -3.9000000000000012, -4.4, -3.7000000000000006, -3.800000000000001, -4.300000000000002, -3.9000000000000012, -4.300000000000001, -4.1000000000000005, -3.8000000000000007, -3.8000000000000007, -3.600000000000001, -4.000000000000001, -3.9000000000000004, -4.000000000000001, -3.800000000000001], "episode_lengths": [21, 5, 21, 21, 21, 21, 21, 19, 21, 4, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.69454621846741, "mean_inference_ms": 18.23611954056842, "mean_action_processing_ms": 0.9460184190289666, "mean_env_wait_ms": 1.6234280844417779, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08168828984101613, "StateBufferConnector_ms": 0.010571504632631937, "ViewRequirementAgentConnector_ms": 0.15190280973911285}}, "episode_reward_max": -3.5000000000000004, "episode_reward_min": -12.600000000000001, "episode_reward_mean": -4.156770833333334, "episode_len_mean": 20.625, "episodes_this_iter": 192, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.9000000000000012, -10.4, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -12.600000000000001, -4.000000000000002, -10.4, -3.600000000000001, -3.900000000000001, -3.8000000000000003, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -3.7000000000000006, -10.3, -4.100000000000001, -4.100000000000001, -3.9000000000000012, -4.1000000000000005, -3.700000000000001, -3.700000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.800000000000001, -3.600000000000001, -4.200000000000001, -4.100000000000001, -4.100000000000001, -3.700000000000001, -4.200000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -4.300000000000001, -4.100000000000001, -4.100000000000001, -3.9000000000000012, -4.000000000000001, -3.800000000000001, -4.200000000000001, -3.6000000000000014, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -4.300000000000001, -4.300000000000001, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -3.8000000000000007, -3.700000000000001, -3.9000000000000004, -3.900000000000001, -3.8000000000000007, -3.9000000000000012, -4.200000000000001, -3.5000000000000004, -4.000000000000001, -4.200000000000001, -4.100000000000001, -4.200000000000001, -3.7000000000000006, -4.000000000000002, -4.000000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000002, -3.9000000000000012, -4.1000000000000005, -4.100000000000001, -3.7, -3.8000000000000007, -4.300000000000001, -4.0, -4.000000000000001, -3.5000000000000004, -3.7000000000000006, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -3.800000000000001, -4.100000000000001, -4.000000000000001, -3.800000000000001, -3.8000000000000003, -3.900000000000001, -4.100000000000001, -11.3, -3.900000000000001, -4.200000000000001, -3.8000000000000007, -3.6000000000000005, -3.9000000000000012, -3.900000000000001, -3.700000000000001, -3.700000000000001, -4.000000000000002, -3.7000000000000006, -3.8000000000000007, -3.700000000000001, -3.900000000000001, -4.000000000000002, -4.100000000000001, -3.8000000000000007, -3.9000000000000004, -3.900000000000001, -4.300000000000001, -3.900000000000001, -4.200000000000001, -3.600000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000002, -4.200000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -4.200000000000001, -4.1000000000000005, -3.9000000000000004, -4.100000000000001, -3.900000000000001, -4.000000000000001, -3.700000000000001, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -3.800000000000001, -3.9000000000000004, -3.8000000000000007, -3.800000000000001, -4.200000000000001, -3.7, -3.8000000000000007, -4.1000000000000005, -4.000000000000001, -3.900000000000001, -3.9000000000000012, -3.7000000000000006, -3.700000000000001, -4.0, -11.6, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -4.100000000000001, -3.800000000000001, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -4.300000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000002, -3.8000000000000003, -4.000000000000002, -3.7000000000000006, -3.9000000000000012, -4.4, -3.7000000000000006, -3.800000000000001, -4.300000000000002, -3.9000000000000012, -4.300000000000001, -4.1000000000000005, -3.8000000000000007, -3.8000000000000007, -3.600000000000001, -4.000000000000001, -3.9000000000000004, -4.000000000000001, -3.800000000000001], "episode_lengths": [21, 5, 21, 21, 21, 21, 21, 19, 21, 4, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.69454621846741, "mean_inference_ms": 18.23611954056842, "mean_action_processing_ms": 0.9460184190289666, "mean_env_wait_ms": 1.6234280844417779, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08168828984101613, "StateBufferConnector_ms": 0.010571504632631937, "ViewRequirementAgentConnector_ms": 0.15190280973911285}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 170989.806, "load_time_ms": 1.141, "load_throughput": 3505404.4, "learn_time_ms": 170008.533, "learn_throughput": 23.528, "synch_weights_time_ms": 188.923}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "episodes_total": 16540, "training_iteration": 80, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_00-43-33", "timestamp": 1680821013, "time_this_iter_s": 172.4108545780182, "time_total_s": 13676.849908590317, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01475e29d0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014740d310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 13676.849908590317, "timesteps_since_restore": 0, "iterations_since_restore": 80, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.308163265306123, "ram_util_percent": 24.134285714285717}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.831747186568475, "cur_kl_coeff": 7.79357046112418, "cur_lr": 0.01, "total_loss": 0.4031400740707433, "policy_loss": 9.80398827983487e-05, "vf_loss": 0.25944447991668534, "vf_explained_var": 0.7179298412415289, "kl": 0.018425130413786347, "entropy": 2.8349181498250653, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 74865.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "sampler_results": {"episode_reward_max": -3.5000000000000004, "episode_reward_min": -11.0, "episode_reward_mean": -4.231632653061225, "episode_len_mean": 20.255102040816325, "episode_media": {}, "episodes_this_iter": 196, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.6, -11.0, -3.9000000000000012, -3.900000000000001, -3.700000000000001, -10.8, -4.100000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -10.9, -3.6000000000000005, -4.200000000000001, -3.8000000000000007, -10.1, -4.000000000000001, -4.100000000000001, -3.600000000000001, -4.000000000000002, -10.1, -3.8000000000000007, -3.8000000000000007, -10.1, -3.7000000000000006, -10.2, -4.100000000000001, -3.800000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.9000000000000012, -4.200000000000001, -4.200000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000002, -3.900000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000002, -4.1000000000000005, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -4.000000000000001, -4.0, -4.0, -4.200000000000001, -4.000000000000001, -4.200000000000001, -4.200000000000001, -4.200000000000001, -3.900000000000001, -4.000000000000001, -4.0, -4.000000000000001, -4.000000000000001, -4.1000000000000005, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.700000000000001, -3.8000000000000003, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.6, -4.000000000000001, -4.000000000000001, -3.700000000000001, -3.9000000000000004, -4.100000000000001, -4.000000000000001, -4.200000000000001, -3.8000000000000003, -4.100000000000001, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -4.000000000000002, -4.200000000000001, -3.8000000000000007, -4.200000000000001, -3.7000000000000006, -4.200000000000001, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -3.800000000000001, -4.300000000000001, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -10.2, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.6000000000000005, -4.100000000000001, -4.000000000000001, -4.0, -4.000000000000001, -3.6000000000000005, -4.000000000000002, -4.0, -4.000000000000002, -3.9000000000000004, -3.8000000000000007, -3.8000000000000007, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.600000000000001, -4.100000000000001, -3.7000000000000006, -3.5000000000000004, -4.000000000000001, -3.800000000000001, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -4.100000000000001, -3.800000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -3.700000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.800000000000001, -3.900000000000001, -3.8000000000000003, -4.100000000000001, -3.800000000000001, -3.9000000000000012, -4.000000000000001, -3.9000000000000012, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.700000000000001, -4.000000000000001, -4.000000000000002, -4.100000000000001, -3.900000000000001, -4.000000000000002, -4.100000000000001, -4.100000000000001, -3.600000000000001, -3.9000000000000012, -3.9000000000000012, -4.0, -4.100000000000001, -4.1000000000000005, -3.800000000000001, -3.7000000000000006, -4.200000000000001, -3.900000000000001, -3.9000000000000012, -3.8000000000000007, -3.600000000000001, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -3.7000000000000006, -3.800000000000001, -4.0, -4.200000000000001, -4.000000000000001, -3.800000000000001, -4.0, -3.700000000000001, -4.200000000000001, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -3.8000000000000007], "episode_lengths": [7, 9, 21, 21, 21, 7, 21, 21, 21, 21, 8, 21, 21, 21, 2, 21, 21, 21, 21, 2, 21, 21, 2, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.69436618173527, "mean_inference_ms": 18.248968986975697, "mean_action_processing_ms": 0.9467452278617954, "mean_env_wait_ms": 1.6294529892499618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0779773507799421, "StateBufferConnector_ms": 0.010412809800128547, "ViewRequirementAgentConnector_ms": 0.14480729492343203}}, "episode_reward_max": -3.5000000000000004, "episode_reward_min": -11.0, "episode_reward_mean": -4.231632653061225, "episode_len_mean": 20.255102040816325, "episodes_this_iter": 196, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10.6, -11.0, -3.9000000000000012, -3.900000000000001, -3.700000000000001, -10.8, -4.100000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -10.9, -3.6000000000000005, -4.200000000000001, -3.8000000000000007, -10.1, -4.000000000000001, -4.100000000000001, -3.600000000000001, -4.000000000000002, -10.1, -3.8000000000000007, -3.8000000000000007, -10.1, -3.7000000000000006, -10.2, -4.100000000000001, -3.800000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.9000000000000012, -4.200000000000001, -4.200000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000002, -3.900000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000002, -4.1000000000000005, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -4.000000000000001, -4.0, -4.0, -4.200000000000001, -4.000000000000001, -4.200000000000001, -4.200000000000001, -4.200000000000001, -3.900000000000001, -4.000000000000001, -4.0, -4.000000000000001, -4.000000000000001, -4.1000000000000005, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.700000000000001, -3.8000000000000003, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.6, -4.000000000000001, -4.000000000000001, -3.700000000000001, -3.9000000000000004, -4.100000000000001, -4.000000000000001, -4.200000000000001, -3.8000000000000003, -4.100000000000001, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -4.000000000000002, -4.200000000000001, -3.8000000000000007, -4.200000000000001, -3.7000000000000006, -4.200000000000001, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -3.800000000000001, -4.300000000000001, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -10.2, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.6000000000000005, -4.100000000000001, -4.000000000000001, -4.0, -4.000000000000001, -3.6000000000000005, -4.000000000000002, -4.0, -4.000000000000002, -3.9000000000000004, -3.8000000000000007, -3.8000000000000007, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.600000000000001, -4.100000000000001, -3.7000000000000006, -3.5000000000000004, -4.000000000000001, -3.800000000000001, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -4.100000000000001, -3.800000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -3.700000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.800000000000001, -3.900000000000001, -3.8000000000000003, -4.100000000000001, -3.800000000000001, -3.9000000000000012, -4.000000000000001, -3.9000000000000012, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.700000000000001, -4.000000000000001, -4.000000000000002, -4.100000000000001, -3.900000000000001, -4.000000000000002, -4.100000000000001, -4.100000000000001, -3.600000000000001, -3.9000000000000012, -3.9000000000000012, -4.0, -4.100000000000001, -4.1000000000000005, -3.800000000000001, -3.7000000000000006, -4.200000000000001, -3.900000000000001, -3.9000000000000012, -3.8000000000000007, -3.600000000000001, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -3.7000000000000006, -3.800000000000001, -4.0, -4.200000000000001, -4.000000000000001, -3.800000000000001, -4.0, -3.700000000000001, -4.200000000000001, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -3.8000000000000007], "episode_lengths": [7, 9, 21, 21, 21, 7, 21, 21, 21, 21, 8, 21, 21, 21, 2, 21, 21, 21, 21, 2, 21, 21, 2, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.69436618173527, "mean_inference_ms": 18.248968986975697, "mean_action_processing_ms": 0.9467452278617954, "mean_env_wait_ms": 1.6294529892499618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0779773507799421, "StateBufferConnector_ms": 0.010412809800128547, "ViewRequirementAgentConnector_ms": 0.14480729492343203}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 324000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 324000, "timers": {"training_iteration_time_ms": 171031.755, "load_time_ms": 1.146, "load_throughput": 3489074.763, "learn_time_ms": 170050.592, "learn_throughput": 23.522, "synch_weights_time_ms": 188.661}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "done": false, "episodes_total": 16736, "training_iteration": 81, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_00-46-25", "timestamp": 1680821185, "time_this_iter_s": 171.46812510490417, "time_total_s": 13848.318033695221, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476cb550>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01474885e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 13848.318033695221, "timesteps_since_restore": 0, "iterations_since_restore": 81, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.558606557377049, "ram_util_percent": 24.138934426229508}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.2730581514297, "cur_kl_coeff": 7.79357046112418, "cur_lr": 0.01, "total_loss": 0.4936566200147393, "policy_loss": -0.00021047183482717443, "vf_loss": 0.3057128654051853, "vf_explained_var": 0.6961769292431493, "kl": 0.02414223729327361, "entropy": 2.8711957582863428, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 75795.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000}, "sampler_results": {"episode_reward_max": -3.400000000000001, "episode_reward_min": -11.7, "episode_reward_mean": -4.186597938144331, "episode_len_mean": 20.49484536082474, "episode_media": {}, "episodes_this_iter": 194, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.100000000000001, -10.5, -3.900000000000001, -4.200000000000001, -4.1000000000000005, -3.700000000000001, -10.5, -10.6, -4.100000000000001, -4.100000000000001, -11.7, -4.000000000000002, -3.7000000000000006, -3.7000000000000006, -3.8000000000000007, -4.000000000000001, -4.300000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000002, -3.7000000000000006, -10.4, -3.900000000000001, -10.3, -3.900000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -3.7000000000000006, -3.900000000000001, -3.900000000000001, -3.600000000000001, -3.800000000000001, -3.7000000000000006, -3.800000000000001, -4.000000000000001, -4.200000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.200000000000001, -3.8000000000000007, -4.1000000000000005, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -4.0, -4.100000000000001, -3.900000000000001, -3.7000000000000006, -3.7000000000000006, -4.100000000000001, -4.000000000000001, -4.000000000000002, -4.100000000000001, -4.200000000000001, -4.1000000000000005, -3.800000000000001, -4.000000000000001, -3.5000000000000004, -4.000000000000002, -3.7000000000000006, -3.8000000000000007, -3.8000000000000007, -3.7000000000000006, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -3.800000000000001, -4.0, -4.100000000000001, -4.100000000000001, -4.300000000000001, -4.000000000000001, -3.400000000000001, -4.000000000000001, -4.300000000000001, -3.9000000000000012, -3.600000000000001, -3.600000000000001, -4.200000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -3.800000000000001, -4.000000000000002, -3.800000000000001, -3.9000000000000012, -3.900000000000001, -4.200000000000001, -3.800000000000001, -4.1000000000000005, -3.8000000000000007, -3.9000000000000004, -4.000000000000001, -4.0, -3.700000000000001, -3.900000000000001, -3.800000000000001, -11.7, -3.9000000000000012, -3.9000000000000012, -3.900000000000001, -3.800000000000001, -4.1000000000000005, -3.9000000000000012, -4.000000000000002, -3.800000000000001, -3.900000000000001, -3.500000000000001, -3.9000000000000012, -4.000000000000001, -4.0, -3.9000000000000004, -3.9000000000000012, -3.8000000000000007, -3.8000000000000007, -4.1000000000000005, -3.8000000000000007, -4.100000000000001, -4.200000000000001, -4.100000000000001, -3.9000000000000012, -3.8000000000000003, -3.9000000000000004, -3.800000000000001, -3.900000000000001, -4.100000000000001, -4.0, -4.000000000000001, -4.000000000000001, -3.600000000000001, -3.500000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.0, -3.600000000000001, -3.800000000000001, -3.900000000000001, -3.8000000000000007, -3.9000000000000004, -4.100000000000001, -4.100000000000001, -4.200000000000001, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.9000000000000004, -4.0, -4.100000000000001, -3.8000000000000003, -4.0, -3.900000000000001, -4.200000000000001, -4.200000000000001, -4.100000000000001, -3.9000000000000004, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.0, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.400000000000001, -3.7000000000000006, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.200000000000001, -3.9000000000000012, -3.700000000000001, -3.8000000000000007, -4.0, -3.8000000000000007, -4.000000000000001, -3.7000000000000006, -3.8000000000000007], "episode_lengths": [21, 6, 21, 21, 21, 21, 5, 6, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.686093623908196, "mean_inference_ms": 18.25971622550679, "mean_action_processing_ms": 0.9463434240269927, "mean_env_wait_ms": 1.6275947326440345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07318332023227338, "StateBufferConnector_ms": 0.00959020300009816, "ViewRequirementAgentConnector_ms": 0.13241546670186152}}, "episode_reward_max": -3.400000000000001, "episode_reward_min": -11.7, "episode_reward_mean": -4.186597938144331, "episode_len_mean": 20.49484536082474, "episodes_this_iter": 194, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.100000000000001, -10.5, -3.900000000000001, -4.200000000000001, -4.1000000000000005, -3.700000000000001, -10.5, -10.6, -4.100000000000001, -4.100000000000001, -11.7, -4.000000000000002, -3.7000000000000006, -3.7000000000000006, -3.8000000000000007, -4.000000000000001, -4.300000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000002, -3.7000000000000006, -10.4, -3.900000000000001, -10.3, -3.900000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -3.7000000000000006, -3.900000000000001, -3.900000000000001, -3.600000000000001, -3.800000000000001, -3.7000000000000006, -3.800000000000001, -4.000000000000001, -4.200000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.200000000000001, -3.8000000000000007, -4.1000000000000005, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -4.0, -4.100000000000001, -3.900000000000001, -3.7000000000000006, -3.7000000000000006, -4.100000000000001, -4.000000000000001, -4.000000000000002, -4.100000000000001, -4.200000000000001, -4.1000000000000005, -3.800000000000001, -4.000000000000001, -3.5000000000000004, -4.000000000000002, -3.7000000000000006, -3.8000000000000007, -3.8000000000000007, -3.7000000000000006, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -3.800000000000001, -4.0, -4.100000000000001, -4.100000000000001, -4.300000000000001, -4.000000000000001, -3.400000000000001, -4.000000000000001, -4.300000000000001, -3.9000000000000012, -3.600000000000001, -3.600000000000001, -4.200000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -3.800000000000001, -4.000000000000002, -3.800000000000001, -3.9000000000000012, -3.900000000000001, -4.200000000000001, -3.800000000000001, -4.1000000000000005, -3.8000000000000007, -3.9000000000000004, -4.000000000000001, -4.0, -3.700000000000001, -3.900000000000001, -3.800000000000001, -11.7, -3.9000000000000012, -3.9000000000000012, -3.900000000000001, -3.800000000000001, -4.1000000000000005, -3.9000000000000012, -4.000000000000002, -3.800000000000001, -3.900000000000001, -3.500000000000001, -3.9000000000000012, -4.000000000000001, -4.0, -3.9000000000000004, -3.9000000000000012, -3.8000000000000007, -3.8000000000000007, -4.1000000000000005, -3.8000000000000007, -4.100000000000001, -4.200000000000001, -4.100000000000001, -3.9000000000000012, -3.8000000000000003, -3.9000000000000004, -3.800000000000001, -3.900000000000001, -4.100000000000001, -4.0, -4.000000000000001, -4.000000000000001, -3.600000000000001, -3.500000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.0, -3.600000000000001, -3.800000000000001, -3.900000000000001, -3.8000000000000007, -3.9000000000000004, -4.100000000000001, -4.100000000000001, -4.200000000000001, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.9000000000000004, -4.0, -4.100000000000001, -3.8000000000000003, -4.0, -3.900000000000001, -4.200000000000001, -4.200000000000001, -4.100000000000001, -3.9000000000000004, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.0, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.400000000000001, -3.7000000000000006, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.200000000000001, -3.9000000000000012, -3.700000000000001, -3.8000000000000007, -4.0, -3.8000000000000007, -4.000000000000001, -3.7000000000000006, -3.8000000000000007], "episode_lengths": [21, 6, 21, 21, 21, 21, 5, 6, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.686093623908196, "mean_inference_ms": 18.25971622550679, "mean_action_processing_ms": 0.9463434240269927, "mean_env_wait_ms": 1.6275947326440345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07318332023227338, "StateBufferConnector_ms": 0.00959020300009816, "ViewRequirementAgentConnector_ms": 0.13241546670186152}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 328000, "timers": {"training_iteration_time_ms": 171186.584, "load_time_ms": 1.143, "load_throughput": 3499262.905, "learn_time_ms": 170204.332, "learn_throughput": 23.501, "synch_weights_time_ms": 187.714}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000}, "done": false, "episodes_total": 16930, "training_iteration": 82, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_00-49-17", "timestamp": 1680821357, "time_this_iter_s": 172.0639750957489, "time_total_s": 14020.38200879097, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476f22b0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01474a8940>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 14020.38200879097, "timesteps_since_restore": 0, "iterations_since_restore": 82, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.36188524590164, "ram_util_percent": 24.178278688524582}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.840319518632786, "cur_kl_coeff": 11.690355691686277, "cur_lr": 0.01, "total_loss": 0.5573627627654982, "policy_loss": 0.0008788027224801881, "vf_loss": 0.2896625240964274, "vf_explained_var": 0.7468873900111004, "kl": 0.02282406554584922, "entropy": 2.8563288768132526, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 76725.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 332000}, "sampler_results": {"episode_reward_max": -3.4000000000000004, "episode_reward_min": -12.5, "episode_reward_mean": -4.103045685279189, "episode_len_mean": 20.685279187817258, "episode_media": {}, "episodes_this_iter": 197, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.8000000000000007, -3.900000000000001, -4.200000000000001, -3.900000000000001, -3.700000000000001, -3.700000000000001, -10.2, -10.5, -4.000000000000001, -4.000000000000002, -3.700000000000001, -4.0, -3.900000000000001, -3.600000000000001, -3.4000000000000004, -3.700000000000001, -3.7000000000000006, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.9000000000000017, -3.900000000000001, -3.800000000000001, -4.000000000000001, -4.000000000000001, -4.0, -3.900000000000001, -3.8000000000000007, -4.200000000000001, -4.100000000000001, -3.9000000000000012, -3.700000000000001, -4.0, -3.900000000000001, -4.000000000000001, -4.300000000000001, -3.7000000000000006, -3.800000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -4.300000000000001, -3.900000000000001, -3.900000000000001, -3.9000000000000004, -4.100000000000001, -4.200000000000001, -3.8000000000000007, -3.900000000000001, -4.1000000000000005, -4.000000000000002, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -4.0, -3.7000000000000006, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -3.600000000000001, -4.100000000000001, -4.100000000000001, -4.0, -4.200000000000001, -4.100000000000001, -3.700000000000001, -4.100000000000001, -3.700000000000001, -3.9000000000000004, -3.900000000000001, -4.100000000000001, -3.700000000000001, -3.9000000000000012, -3.9000000000000012, -3.8000000000000007, -4.200000000000001, -3.7000000000000006, -4.000000000000001, -3.8000000000000003, -4.000000000000001, -4.0, -4.000000000000001, -3.7000000000000006, -4.100000000000001, -4.100000000000001, -4.200000000000001, -3.9000000000000012, -3.800000000000001, -4.200000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000002, -4.100000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -3.6000000000000005, -3.7000000000000006, -4.000000000000002, -3.8000000000000007, -3.8000000000000007, -3.700000000000001, -4.000000000000001, -10.8, -10.9, -12.5, -4.0, -3.9000000000000012, -4.000000000000001, -3.700000000000001, -3.9000000000000012, -4.100000000000001, -3.900000000000001, -4.400000000000001, -3.9000000000000012, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000002, -3.800000000000001, -3.600000000000001, -4.000000000000001, -3.7, -3.9000000000000012, -4.000000000000002, -4.000000000000002, -3.800000000000001, -3.7000000000000006, -3.8000000000000007, -3.8000000000000007, -3.800000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000002, -4.000000000000001, -3.800000000000001, -4.300000000000001, -4.000000000000002, -4.000000000000001, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -3.9000000000000012, -3.9000000000000012, -4.000000000000002, -3.800000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -4.300000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.7000000000000006, -4.0, -3.900000000000001, -4.000000000000001, -4.0, -4.000000000000001, -3.9000000000000012, -3.800000000000001, -3.800000000000001, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -3.9000000000000012, -4.000000000000002, -3.700000000000001, -3.8000000000000007, -4.1000000000000005, -4.000000000000001, -4.000000000000002, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.700000000000001, -3.9000000000000012, -3.8000000000000007, -4.200000000000001, -3.9000000000000012, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.8000000000000007], "episode_lengths": [21, 21, 21, 21, 21, 21, 3, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 7, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.680386216077457, "mean_inference_ms": 18.220009248982112, "mean_action_processing_ms": 0.9452688820307434, "mean_env_wait_ms": 1.6177464876244962, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0745629296084951, "StateBufferConnector_ms": 0.009769836658148597, "ViewRequirementAgentConnector_ms": 0.1362397586028588}}, "episode_reward_max": -3.4000000000000004, "episode_reward_min": -12.5, "episode_reward_mean": -4.103045685279189, "episode_len_mean": 20.685279187817258, "episodes_this_iter": 197, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.8000000000000007, -3.900000000000001, -4.200000000000001, -3.900000000000001, -3.700000000000001, -3.700000000000001, -10.2, -10.5, -4.000000000000001, -4.000000000000002, -3.700000000000001, -4.0, -3.900000000000001, -3.600000000000001, -3.4000000000000004, -3.700000000000001, -3.7000000000000006, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.9000000000000017, -3.900000000000001, -3.800000000000001, -4.000000000000001, -4.000000000000001, -4.0, -3.900000000000001, -3.8000000000000007, -4.200000000000001, -4.100000000000001, -3.9000000000000012, -3.700000000000001, -4.0, -3.900000000000001, -4.000000000000001, -4.300000000000001, -3.7000000000000006, -3.800000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -4.300000000000001, -3.900000000000001, -3.900000000000001, -3.9000000000000004, -4.100000000000001, -4.200000000000001, -3.8000000000000007, -3.900000000000001, -4.1000000000000005, -4.000000000000002, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -4.0, -3.7000000000000006, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -3.600000000000001, -4.100000000000001, -4.100000000000001, -4.0, -4.200000000000001, -4.100000000000001, -3.700000000000001, -4.100000000000001, -3.700000000000001, -3.9000000000000004, -3.900000000000001, -4.100000000000001, -3.700000000000001, -3.9000000000000012, -3.9000000000000012, -3.8000000000000007, -4.200000000000001, -3.7000000000000006, -4.000000000000001, -3.8000000000000003, -4.000000000000001, -4.0, -4.000000000000001, -3.7000000000000006, -4.100000000000001, -4.100000000000001, -4.200000000000001, -3.9000000000000012, -3.800000000000001, -4.200000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000002, -4.100000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -3.6000000000000005, -3.7000000000000006, -4.000000000000002, -3.8000000000000007, -3.8000000000000007, -3.700000000000001, -4.000000000000001, -10.8, -10.9, -12.5, -4.0, -3.9000000000000012, -4.000000000000001, -3.700000000000001, -3.9000000000000012, -4.100000000000001, -3.900000000000001, -4.400000000000001, -3.9000000000000012, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000002, -3.800000000000001, -3.600000000000001, -4.000000000000001, -3.7, -3.9000000000000012, -4.000000000000002, -4.000000000000002, -3.800000000000001, -3.7000000000000006, -3.8000000000000007, -3.8000000000000007, -3.800000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000002, -4.000000000000001, -3.800000000000001, -4.300000000000001, -4.000000000000002, -4.000000000000001, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -3.9000000000000012, -3.9000000000000012, -4.000000000000002, -3.800000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -4.300000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.7000000000000006, -4.0, -3.900000000000001, -4.000000000000001, -4.0, -4.000000000000001, -3.9000000000000012, -3.800000000000001, -3.800000000000001, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -3.9000000000000012, -4.000000000000002, -3.700000000000001, -3.8000000000000007, -4.1000000000000005, -4.000000000000001, -4.000000000000002, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.700000000000001, -3.9000000000000012, -3.8000000000000007, -4.200000000000001, -3.9000000000000012, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.8000000000000007], "episode_lengths": [21, 21, 21, 21, 21, 21, 3, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 7, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.680386216077457, "mean_inference_ms": 18.220009248982112, "mean_action_processing_ms": 0.9452688820307434, "mean_env_wait_ms": 1.6177464876244962, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0745629296084951, "StateBufferConnector_ms": 0.009769836658148597, "ViewRequirementAgentConnector_ms": 0.1362397586028588}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 332000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 332000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 332000, "timers": {"training_iteration_time_ms": 171248.737, "load_time_ms": 1.162, "load_throughput": 3441127.269, "learn_time_ms": 170268.407, "learn_throughput": 23.492, "synch_weights_time_ms": 188.286}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 332000}, "done": false, "episodes_total": 17127, "training_iteration": 83, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_00-52-08", "timestamp": 1680821528, "time_this_iter_s": 171.2984800338745, "time_total_s": 14191.680488824844, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01475e2940>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01473a53a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 14191.680488824844, "timesteps_since_restore": 0, "iterations_since_restore": 83, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.361475409836065, "ram_util_percent": 24.188524590163926}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.745826767849666, "cur_kl_coeff": 17.535533537529403, "cur_lr": 0.01, "total_loss": 3.7761051550167064, "policy_loss": 0.01865395127435125, "vf_loss": 0.24825581008548378, "vf_explained_var": 0.7047835165454496, "kl": 0.20011910546423306, "entropy": 2.7176905795451134, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 77655.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "sampler_results": {"episode_reward_max": -3.6000000000000005, "episode_reward_min": -10.9, "episode_reward_mean": -4.075263157894737, "episode_len_mean": 20.66842105263158, "episode_media": {}, "episodes_this_iter": 190, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.6000000000000005, -3.900000000000001, -4.0, -3.7000000000000006, -3.700000000000001, -4.100000000000001, -3.900000000000001, -10.3, -10.9, -3.700000000000001, -3.6000000000000005, -3.800000000000001, -3.900000000000001, -3.7000000000000006, -4.000000000000002, -3.8000000000000007, -3.8000000000000007, -3.800000000000001, -3.9000000000000012, -4.000000000000001, -4.000000000000002, -4.000000000000001, -3.9000000000000012, -3.700000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000001, -4.200000000000001, -3.7000000000000006, -4.100000000000001, -4.000000000000001, -3.700000000000001, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -3.700000000000001, -4.200000000000001, -3.800000000000001, -4.300000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -4.200000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.700000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -3.7000000000000006, -4.300000000000001, -4.0, -4.200000000000001, -4.0, -4.200000000000001, -4.000000000000002, -4.200000000000001, -3.900000000000001, -3.7000000000000006, -4.100000000000001, -4.000000000000001, -3.6000000000000005, -3.900000000000001, -3.900000000000001, -3.800000000000001, -3.9000000000000012, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -4.200000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.9000000000000012, -3.8000000000000007, -3.9000000000000012, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -4.100000000000001, -3.800000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000002, -3.9000000000000012, -4.000000000000002, -10.5, -4.0, -4.200000000000001, -3.800000000000001, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -4.0, -4.000000000000001, -4.100000000000001, -3.6000000000000005, -3.9000000000000012, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.1000000000000005, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000002, -3.8000000000000007, -3.8000000000000007, -3.8000000000000003, -4.0, -4.000000000000001, -3.7000000000000006, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.800000000000001, -4.000000000000002, -4.100000000000001, -3.800000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -4.400000000000001, -4.000000000000002, -3.900000000000001, -3.800000000000001, -3.8000000000000007, -4.200000000000001, -4.0, -3.6000000000000005, -3.700000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000002, -3.8000000000000007, -3.8000000000000007, -4.300000000000001, -3.700000000000001, -3.9000000000000012, -4.000000000000002, -4.200000000000001, -4.200000000000001, -3.8000000000000007, -4.000000000000001, -4.300000000000001, -4.1000000000000005, -4.000000000000001, -4.000000000000001, -4.300000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000002, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -3.600000000000001, -3.7000000000000006, -3.9000000000000012, -3.900000000000001, -3.9000000000000012, -3.9000000000000012, -10.2, -3.7000000000000015, -4.000000000000002, -4.000000000000002, -4.000000000000001, -3.8000000000000007, -3.7000000000000006, -3.800000000000001, -4.000000000000001, -4.0, -4.000000000000001, -4.000000000000001, -4.000000000000002, -4.200000000000001, -3.900000000000001, -4.000000000000001, -4.1000000000000005, -3.900000000000001, -3.900000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 4, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.67705023793721, "mean_inference_ms": 18.226488059298372, "mean_action_processing_ms": 0.945423131535648, "mean_env_wait_ms": 1.618223391260313, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07593067068802684, "StateBufferConnector_ms": 0.010063773707339638, "ViewRequirementAgentConnector_ms": 0.1411018873515882}}, "episode_reward_max": -3.6000000000000005, "episode_reward_min": -10.9, "episode_reward_mean": -4.075263157894737, "episode_len_mean": 20.66842105263158, "episodes_this_iter": 190, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.6000000000000005, -3.900000000000001, -4.0, -3.7000000000000006, -3.700000000000001, -4.100000000000001, -3.900000000000001, -10.3, -10.9, -3.700000000000001, -3.6000000000000005, -3.800000000000001, -3.900000000000001, -3.7000000000000006, -4.000000000000002, -3.8000000000000007, -3.8000000000000007, -3.800000000000001, -3.9000000000000012, -4.000000000000001, -4.000000000000002, -4.000000000000001, -3.9000000000000012, -3.700000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000001, -4.200000000000001, -3.7000000000000006, -4.100000000000001, -4.000000000000001, -3.700000000000001, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -3.700000000000001, -4.200000000000001, -3.800000000000001, -4.300000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -4.200000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.700000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -3.7000000000000006, -4.300000000000001, -4.0, -4.200000000000001, -4.0, -4.200000000000001, -4.000000000000002, -4.200000000000001, -3.900000000000001, -3.7000000000000006, -4.100000000000001, -4.000000000000001, -3.6000000000000005, -3.900000000000001, -3.900000000000001, -3.800000000000001, -3.9000000000000012, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -4.200000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.9000000000000012, -3.8000000000000007, -3.9000000000000012, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -4.100000000000001, -3.800000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000002, -3.9000000000000012, -4.000000000000002, -10.5, -4.0, -4.200000000000001, -3.800000000000001, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -4.0, -4.000000000000001, -4.100000000000001, -3.6000000000000005, -3.9000000000000012, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.1000000000000005, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000002, -3.8000000000000007, -3.8000000000000007, -3.8000000000000003, -4.0, -4.000000000000001, -3.7000000000000006, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.800000000000001, -4.000000000000002, -4.100000000000001, -3.800000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -4.400000000000001, -4.000000000000002, -3.900000000000001, -3.800000000000001, -3.8000000000000007, -4.200000000000001, -4.0, -3.6000000000000005, -3.700000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000002, -3.8000000000000007, -3.8000000000000007, -4.300000000000001, -3.700000000000001, -3.9000000000000012, -4.000000000000002, -4.200000000000001, -4.200000000000001, -3.8000000000000007, -4.000000000000001, -4.300000000000001, -4.1000000000000005, -4.000000000000001, -4.000000000000001, -4.300000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000002, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -3.600000000000001, -3.7000000000000006, -3.9000000000000012, -3.900000000000001, -3.9000000000000012, -3.9000000000000012, -10.2, -3.7000000000000015, -4.000000000000002, -4.000000000000002, -4.000000000000001, -3.8000000000000007, -3.7000000000000006, -3.800000000000001, -4.000000000000001, -4.0, -4.000000000000001, -4.000000000000001, -4.000000000000002, -4.200000000000001, -3.900000000000001, -4.000000000000001, -4.1000000000000005, -3.900000000000001, -3.900000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 4, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.67705023793721, "mean_inference_ms": 18.226488059298372, "mean_action_processing_ms": 0.945423131535648, "mean_env_wait_ms": 1.618223391260313, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07593067068802684, "StateBufferConnector_ms": 0.010063773707339638, "ViewRequirementAgentConnector_ms": 0.1411018873515882}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 171305.465, "load_time_ms": 1.163, "load_throughput": 3440562.722, "learn_time_ms": 170324.427, "learn_throughput": 23.485, "synch_weights_time_ms": 187.683}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "episodes_total": 17317, "training_iteration": 84, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_00-55-00", "timestamp": 1680821700, "time_this_iter_s": 171.41116786003113, "time_total_s": 14363.091656684875, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f014732e430>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01474a81f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 14363.091656684875, "timesteps_since_restore": 0, "iterations_since_restore": 84, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.314754098360655, "ram_util_percent": 24.16680327868852}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.459131058313513, "cur_kl_coeff": 26.303300306294105, "cur_lr": 0.01, "total_loss": 0.40299864912465694, "policy_loss": 0.0019926056901734043, "vf_loss": 0.29110074402984754, "vf_explained_var": 0.7388029022883343, "kl": 0.004178384335127018, "entropy": 2.7872558645022814, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 78585.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000}, "sampler_results": {"episode_reward_max": -3.5000000000000004, "episode_reward_min": -11.5, "episode_reward_mean": -4.029015544041451, "episode_len_mean": 20.94300518134715, "episode_media": {}, "episodes_this_iter": 193, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.8000000000000003, -4.100000000000001, -4.1000000000000005, -3.600000000000001, -3.500000000000001, -4.100000000000001, -3.7000000000000006, -3.900000000000001, -4.100000000000001, -3.9000000000000004, -3.600000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.8000000000000003, -4.1000000000000005, -4.200000000000001, -3.7000000000000006, -11.5, -3.9000000000000012, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -4.200000000000001, -4.1000000000000005, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -3.800000000000001, -4.100000000000001, -4.100000000000001, -4.1000000000000005, -3.9000000000000004, -4.1000000000000005, -3.900000000000001, -4.1000000000000005, -3.900000000000001, -3.7000000000000006, -3.7000000000000006, -4.200000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000002, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -4.200000000000001, -3.900000000000001, -3.7000000000000006, -4.300000000000001, -3.8000000000000007, -3.9000000000000012, -4.000000000000002, -3.9000000000000012, -3.900000000000001, -3.900000000000001, -3.800000000000001, -3.7000000000000006, -3.900000000000001, -3.5000000000000004, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -4.100000000000001, -3.7000000000000006, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -4.300000000000001, -3.900000000000001, -4.000000000000001, -4.4, -4.200000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.200000000000001, -4.200000000000001, -4.300000000000001, -4.100000000000001, -4.000000000000002, -3.7000000000000006, -3.900000000000001, -4.200000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.0, -3.900000000000001, -4.1000000000000005, -4.1000000000000005, -4.000000000000002, -4.000000000000001, -4.100000000000001, -4.200000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.0, -4.000000000000001, -4.0, -3.7000000000000006, -4.100000000000001, -3.900000000000001, -3.9000000000000012, -3.8000000000000007, -4.200000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.800000000000001, -4.100000000000001, -4.300000000000001, -4.300000000000001, -4.200000000000001, -4.000000000000002, -4.000000000000001, -4.000000000000002, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.800000000000001, -3.800000000000001, -4.100000000000001, -3.9000000000000012, -3.800000000000001, -3.8000000000000007, -4.300000000000001, -3.7000000000000006, -4.100000000000001, -3.7000000000000006, -3.9000000000000012, -3.7000000000000006, -4.100000000000001, -4.300000000000001, -4.000000000000001, -4.0, -4.000000000000001, -3.700000000000001, -4.200000000000001, -4.000000000000002, -4.100000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -4.1000000000000005, -3.9000000000000012, -3.9000000000000012, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -4.300000000000001, -4.300000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -4.300000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -3.9000000000000012, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -4.1000000000000005, -4.000000000000002, -3.9000000000000012, -4.000000000000001, -4.0, -4.100000000000001, -3.9000000000000012, -3.900000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.673584545128865, "mean_inference_ms": 18.234717478912795, "mean_action_processing_ms": 0.9461503664283578, "mean_env_wait_ms": 1.6159469162719216, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08035064361256021, "StateBufferConnector_ms": 0.010656075156414447, "ViewRequirementAgentConnector_ms": 0.14646003901031968}}, "episode_reward_max": -3.5000000000000004, "episode_reward_min": -11.5, "episode_reward_mean": -4.029015544041451, "episode_len_mean": 20.94300518134715, "episodes_this_iter": 193, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.8000000000000003, -4.100000000000001, -4.1000000000000005, -3.600000000000001, -3.500000000000001, -4.100000000000001, -3.7000000000000006, -3.900000000000001, -4.100000000000001, -3.9000000000000004, -3.600000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.8000000000000003, -4.1000000000000005, -4.200000000000001, -3.7000000000000006, -11.5, -3.9000000000000012, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -4.200000000000001, -4.1000000000000005, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -3.800000000000001, -4.100000000000001, -4.100000000000001, -4.1000000000000005, -3.9000000000000004, -4.1000000000000005, -3.900000000000001, -4.1000000000000005, -3.900000000000001, -3.7000000000000006, -3.7000000000000006, -4.200000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000002, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -4.200000000000001, -3.900000000000001, -3.7000000000000006, -4.300000000000001, -3.8000000000000007, -3.9000000000000012, -4.000000000000002, -3.9000000000000012, -3.900000000000001, -3.900000000000001, -3.800000000000001, -3.7000000000000006, -3.900000000000001, -3.5000000000000004, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -4.100000000000001, -3.7000000000000006, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -4.300000000000001, -3.900000000000001, -4.000000000000001, -4.4, -4.200000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.200000000000001, -4.200000000000001, -4.300000000000001, -4.100000000000001, -4.000000000000002, -3.7000000000000006, -3.900000000000001, -4.200000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.0, -3.900000000000001, -4.1000000000000005, -4.1000000000000005, -4.000000000000002, -4.000000000000001, -4.100000000000001, -4.200000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.0, -4.000000000000001, -4.0, -3.7000000000000006, -4.100000000000001, -3.900000000000001, -3.9000000000000012, -3.8000000000000007, -4.200000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.800000000000001, -4.100000000000001, -4.300000000000001, -4.300000000000001, -4.200000000000001, -4.000000000000002, -4.000000000000001, -4.000000000000002, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.800000000000001, -3.800000000000001, -4.100000000000001, -3.9000000000000012, -3.800000000000001, -3.8000000000000007, -4.300000000000001, -3.7000000000000006, -4.100000000000001, -3.7000000000000006, -3.9000000000000012, -3.7000000000000006, -4.100000000000001, -4.300000000000001, -4.000000000000001, -4.0, -4.000000000000001, -3.700000000000001, -4.200000000000001, -4.000000000000002, -4.100000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -4.1000000000000005, -3.9000000000000012, -3.9000000000000012, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -4.300000000000001, -4.300000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -4.300000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -3.9000000000000012, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -4.1000000000000005, -4.000000000000002, -3.9000000000000012, -4.000000000000001, -4.0, -4.100000000000001, -3.9000000000000012, -3.900000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.673584545128865, "mean_inference_ms": 18.234717478912795, "mean_action_processing_ms": 0.9461503664283578, "mean_env_wait_ms": 1.6159469162719216, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08035064361256021, "StateBufferConnector_ms": 0.010656075156414447, "ViewRequirementAgentConnector_ms": 0.14646003901031968}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 340000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 340000, "timers": {"training_iteration_time_ms": 171470.394, "load_time_ms": 1.184, "load_throughput": 3378280.375, "learn_time_ms": 170490.937, "learn_throughput": 23.462, "synch_weights_time_ms": 188.07}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000}, "done": false, "episodes_total": 17510, "training_iteration": 85, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_00-57-52", "timestamp": 1680821872, "time_this_iter_s": 172.1239459514618, "time_total_s": 14535.215602636337, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0147423ee0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01473a5310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 14535.215602636337, "timesteps_since_restore": 0, "iterations_since_restore": 85, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.561065573770491, "ram_util_percent": 24.103278688524593}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.104660455257662, "cur_kl_coeff": 13.151650153147052, "cur_lr": 0.01, "total_loss": 0.3287082721288967, "policy_loss": -0.0008008757826461586, "vf_loss": 0.24017687222009065, "vf_explained_var": 0.7603551346768616, "kl": 0.00679247631720813, "entropy": 2.7637766335600165, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 79515.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000}, "sampler_results": {"episode_reward_max": -3.6000000000000005, "episode_reward_min": -10.6, "episode_reward_mean": -4.026804123711341, "episode_len_mean": 20.922680412371133, "episode_media": {}, "episodes_this_iter": 194, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.100000000000001, -3.9000000000000012, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -4.000000000000001, -3.800000000000001, -4.100000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000001, -3.8000000000000007, -3.9000000000000004, -3.600000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.6000000000000005, -3.900000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -3.7000000000000006, -4.1000000000000005, -3.800000000000001, -3.900000000000001, -3.7000000000000006, -3.7000000000000006, -4.300000000000001, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -4.000000000000002, -4.000000000000002, -3.7000000000000006, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.300000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.300000000000001, -3.9000000000000012, -3.7000000000000006, -4.200000000000001, -4.000000000000002, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -4.300000000000001, -3.900000000000001, -4.000000000000001, -4.300000000000001, -4.100000000000001, -4.200000000000001, -3.800000000000001, -3.8000000000000007, -3.9000000000000012, -4.000000000000001, -4.0, -4.000000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -4.200000000000001, -3.700000000000001, -3.9000000000000004, -4.000000000000002, -3.800000000000001, -4.200000000000001, -4.100000000000001, -3.900000000000001, -4.300000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.1000000000000005, -3.8000000000000007, -4.100000000000001, -10.6, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -4.200000000000001, -4.200000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.300000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.800000000000001, -4.200000000000001, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -4.0, -4.000000000000002, -4.300000000000001, -3.800000000000001, -3.9000000000000012, -4.100000000000001, -4.0, -4.100000000000001, -3.7000000000000006, -4.1000000000000005, -4.000000000000001, -4.100000000000001, -3.9000000000000012, -3.8000000000000007, -4.100000000000001, -4.100000000000001, -4.100000000000001, -3.9000000000000012, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -3.9000000000000012, -4.300000000000002, -4.200000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -3.800000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -4.300000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000001, -3.9000000000000012, -4.000000000000001, -3.8000000000000007, -3.800000000000001, -3.9000000000000012, -4.200000000000001, -4.000000000000001, -4.1000000000000005, -3.9000000000000012, -4.4, -4.200000000000001, -3.8000000000000007, -4.200000000000001, -3.8000000000000003, -3.800000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000002, -4.000000000000001, -4.200000000000001, -3.900000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.670987135107014, "mean_inference_ms": 18.215482644861062, "mean_action_processing_ms": 0.9450565517047603, "mean_env_wait_ms": 1.6108513823883022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06915613548042848, "StateBufferConnector_ms": 0.009317127699704515, "ViewRequirementAgentConnector_ms": 0.12825088402659623}}, "episode_reward_max": -3.6000000000000005, "episode_reward_min": -10.6, "episode_reward_mean": -4.026804123711341, "episode_len_mean": 20.922680412371133, "episodes_this_iter": 194, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.100000000000001, -3.9000000000000012, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -4.000000000000001, -3.800000000000001, -4.100000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000001, -3.8000000000000007, -3.9000000000000004, -3.600000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.6000000000000005, -3.900000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -3.7000000000000006, -4.1000000000000005, -3.800000000000001, -3.900000000000001, -3.7000000000000006, -3.7000000000000006, -4.300000000000001, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -4.000000000000002, -4.000000000000002, -3.7000000000000006, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.300000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.300000000000001, -3.9000000000000012, -3.7000000000000006, -4.200000000000001, -4.000000000000002, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -4.300000000000001, -3.900000000000001, -4.000000000000001, -4.300000000000001, -4.100000000000001, -4.200000000000001, -3.800000000000001, -3.8000000000000007, -3.9000000000000012, -4.000000000000001, -4.0, -4.000000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -4.200000000000001, -3.700000000000001, -3.9000000000000004, -4.000000000000002, -3.800000000000001, -4.200000000000001, -4.100000000000001, -3.900000000000001, -4.300000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.1000000000000005, -3.8000000000000007, -4.100000000000001, -10.6, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -4.200000000000001, -4.200000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.300000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.800000000000001, -4.200000000000001, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -4.0, -4.000000000000002, -4.300000000000001, -3.800000000000001, -3.9000000000000012, -4.100000000000001, -4.0, -4.100000000000001, -3.7000000000000006, -4.1000000000000005, -4.000000000000001, -4.100000000000001, -3.9000000000000012, -3.8000000000000007, -4.100000000000001, -4.100000000000001, -4.100000000000001, -3.9000000000000012, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -3.9000000000000012, -4.300000000000002, -4.200000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -3.800000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -4.300000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000001, -3.9000000000000012, -4.000000000000001, -3.8000000000000007, -3.800000000000001, -3.9000000000000012, -4.200000000000001, -4.000000000000001, -4.1000000000000005, -3.9000000000000012, -4.4, -4.200000000000001, -3.8000000000000007, -4.200000000000001, -3.8000000000000003, -3.800000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000002, -4.000000000000001, -4.200000000000001, -3.900000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.670987135107014, "mean_inference_ms": 18.215482644861062, "mean_action_processing_ms": 0.9450565517047603, "mean_env_wait_ms": 1.6108513823883022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06915613548042848, "StateBufferConnector_ms": 0.009317127699704515, "ViewRequirementAgentConnector_ms": 0.12825088402659623}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 344000, "timers": {"training_iteration_time_ms": 171567.911, "load_time_ms": 1.182, "load_throughput": 3384345.511, "learn_time_ms": 170596.407, "learn_throughput": 23.447, "synch_weights_time_ms": 188.307}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000}, "done": false, "episodes_total": 17704, "training_iteration": 86, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_01-00-44", "timestamp": 1680822044, "time_this_iter_s": 171.63357949256897, "time_total_s": 14706.849182128906, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476d1fd0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01474a81f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 14706.849182128906, "timesteps_since_restore": 0, "iterations_since_restore": 86, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.964081632653061, "ram_util_percent": 24.167346938775502}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.467413162159664, "cur_kl_coeff": 13.151650153147052, "cur_lr": 0.01, "total_loss": 0.36453641740384923, "policy_loss": 0.004081115393989509, "vf_loss": 0.2308412362811386, "vf_explained_var": 0.7332942042299496, "kl": 0.009855345989138098, "entropy": 2.773974762937074, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 80445.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "sampler_results": {"episode_reward_max": -3.6000000000000005, "episode_reward_min": -10.5, "episode_reward_mean": -4.0088541666666675, "episode_len_mean": 20.921875, "episode_media": {}, "episodes_this_iter": 192, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.000000000000001, -3.600000000000001, -3.6000000000000005, -3.8000000000000007, -3.8000000000000007, -4.200000000000001, -3.7000000000000006, -3.7000000000000006, -4.200000000000001, -3.900000000000001, -4.100000000000001, -4.1000000000000005, -3.800000000000001, -4.000000000000001, -3.600000000000001, -3.9000000000000004, -10.5, -3.6000000000000005, -3.7000000000000006, -3.7000000000000006, -3.600000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -3.7000000000000006, -4.100000000000001, -3.900000000000001, -3.9000000000000012, -4.100000000000001, -4.000000000000001, -4.1000000000000005, -3.900000000000001, -3.8000000000000003, -3.8000000000000007, -3.9000000000000012, -4.200000000000001, -3.9000000000000012, -4.200000000000001, -4.000000000000001, -3.9000000000000012, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.200000000000001, -3.900000000000001, -3.9000000000000012, -4.200000000000001, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000002, -3.900000000000001, -3.9000000000000012, -3.8000000000000003, -3.600000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.9000000000000012, -3.8000000000000007, -4.300000000000001, -4.300000000000001, -3.9000000000000012, -4.000000000000001, -3.900000000000001, -4.200000000000001, -3.8000000000000007, -4.200000000000001, -3.9000000000000012, -4.100000000000001, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -4.000000000000002, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.200000000000001, -4.100000000000001, -3.8000000000000007, -4.200000000000001, -4.000000000000001, -4.0, -3.800000000000001, -3.900000000000001, -4.100000000000001, -3.9000000000000012, -4.000000000000002, -4.000000000000001, -4.000000000000001, -3.700000000000001, -3.6000000000000005, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.200000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -4.300000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.9000000000000004, -4.300000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.9000000000000004, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.300000000000001, -4.000000000000001, -4.000000000000002, -4.000000000000002, -4.1000000000000005, -3.9000000000000004, -4.000000000000002, -3.900000000000001, -3.800000000000001, -4.200000000000001, -4.300000000000001, -4.100000000000001, -4.300000000000001, -3.8000000000000007, -4.200000000000001, -4.000000000000002, -4.100000000000001, -3.9000000000000012, -3.8000000000000003, -3.800000000000001, -3.7000000000000006, -4.200000000000001, -4.000000000000001, -4.000000000000002, -3.900000000000001, -3.700000000000001, -4.100000000000001, -4.1000000000000005, -3.9000000000000012, -4.1000000000000005, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -4.300000000000001, -4.200000000000001, -3.9000000000000012, -4.100000000000001, -3.800000000000001, -3.8000000000000003, -4.0, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -4.300000000000001, -3.900000000000001, -3.700000000000001, -4.200000000000001, -3.9000000000000012, -3.8000000000000007, -4.300000000000001, -4.000000000000002, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000001, -4.300000000000001, -4.000000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000001, -4.100000000000001, -4.300000000000002, -4.000000000000001, -3.900000000000001, -3.900000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.667329790952582, "mean_inference_ms": 18.197568830672566, "mean_action_processing_ms": 0.9441940638495433, "mean_env_wait_ms": 1.6096614097215973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0737551599740982, "StateBufferConnector_ms": 0.009575734535853067, "ViewRequirementAgentConnector_ms": 0.13460094730059305}}, "episode_reward_max": -3.6000000000000005, "episode_reward_min": -10.5, "episode_reward_mean": -4.0088541666666675, "episode_len_mean": 20.921875, "episodes_this_iter": 192, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.000000000000001, -3.600000000000001, -3.6000000000000005, -3.8000000000000007, -3.8000000000000007, -4.200000000000001, -3.7000000000000006, -3.7000000000000006, -4.200000000000001, -3.900000000000001, -4.100000000000001, -4.1000000000000005, -3.800000000000001, -4.000000000000001, -3.600000000000001, -3.9000000000000004, -10.5, -3.6000000000000005, -3.7000000000000006, -3.7000000000000006, -3.600000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -3.7000000000000006, -4.100000000000001, -3.900000000000001, -3.9000000000000012, -4.100000000000001, -4.000000000000001, -4.1000000000000005, -3.900000000000001, -3.8000000000000003, -3.8000000000000007, -3.9000000000000012, -4.200000000000001, -3.9000000000000012, -4.200000000000001, -4.000000000000001, -3.9000000000000012, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.200000000000001, -3.900000000000001, -3.9000000000000012, -4.200000000000001, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000002, -3.900000000000001, -3.9000000000000012, -3.8000000000000003, -3.600000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.9000000000000012, -3.8000000000000007, -4.300000000000001, -4.300000000000001, -3.9000000000000012, -4.000000000000001, -3.900000000000001, -4.200000000000001, -3.8000000000000007, -4.200000000000001, -3.9000000000000012, -4.100000000000001, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -4.000000000000002, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.200000000000001, -4.100000000000001, -3.8000000000000007, -4.200000000000001, -4.000000000000001, -4.0, -3.800000000000001, -3.900000000000001, -4.100000000000001, -3.9000000000000012, -4.000000000000002, -4.000000000000001, -4.000000000000001, -3.700000000000001, -3.6000000000000005, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.200000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -4.300000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.9000000000000004, -4.300000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.9000000000000004, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.300000000000001, -4.000000000000001, -4.000000000000002, -4.000000000000002, -4.1000000000000005, -3.9000000000000004, -4.000000000000002, -3.900000000000001, -3.800000000000001, -4.200000000000001, -4.300000000000001, -4.100000000000001, -4.300000000000001, -3.8000000000000007, -4.200000000000001, -4.000000000000002, -4.100000000000001, -3.9000000000000012, -3.8000000000000003, -3.800000000000001, -3.7000000000000006, -4.200000000000001, -4.000000000000001, -4.000000000000002, -3.900000000000001, -3.700000000000001, -4.100000000000001, -4.1000000000000005, -3.9000000000000012, -4.1000000000000005, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -4.300000000000001, -4.200000000000001, -3.9000000000000012, -4.100000000000001, -3.800000000000001, -3.8000000000000003, -4.0, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -4.300000000000001, -3.900000000000001, -3.700000000000001, -4.200000000000001, -3.9000000000000012, -3.8000000000000007, -4.300000000000001, -4.000000000000002, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000001, -4.300000000000001, -4.000000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000001, -4.100000000000001, -4.300000000000002, -4.000000000000001, -3.900000000000001, -3.900000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.667329790952582, "mean_inference_ms": 18.197568830672566, "mean_action_processing_ms": 0.9441940638495433, "mean_env_wait_ms": 1.6096614097215973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0737551599740982, "StateBufferConnector_ms": 0.009575734535853067, "ViewRequirementAgentConnector_ms": 0.13460094730059305}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 348000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 348000, "timers": {"training_iteration_time_ms": 171669.071, "load_time_ms": 1.185, "load_throughput": 3375969.092, "learn_time_ms": 170699.107, "learn_throughput": 23.433, "synch_weights_time_ms": 183.663}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "done": false, "episodes_total": 17896, "training_iteration": 87, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_01-03-36", "timestamp": 1680822216, "time_this_iter_s": 171.95865035057068, "time_total_s": 14878.807832479477, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0147659820>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014731f280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 14878.807832479477, "timesteps_since_restore": 0, "iterations_since_restore": 87, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.725819672131147, "ram_util_percent": 24.20122950819671}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.235794384248795, "cur_kl_coeff": 13.151650153147052, "cur_lr": 0.01, "total_loss": 0.40482865308801974, "policy_loss": -0.0013716379761375406, "vf_loss": 0.255395318655878, "vf_explained_var": 0.7407026841435381, "kl": 0.011466619492663692, "entropy": 2.8430756333053755, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 81375.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "sampler_results": {"episode_reward_max": -3.6, "episode_reward_min": -12.1, "episode_reward_mean": -4.06448087431694, "episode_len_mean": 20.76502732240437, "episode_media": {}, "episodes_this_iter": 183, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.000000000000001, -3.7000000000000006, -3.8000000000000003, -3.900000000000001, -3.8000000000000007, -4.000000000000002, -3.800000000000001, -3.8000000000000007, -4.100000000000001, -4.200000000000001, -3.900000000000001, -4.000000000000001, -10.3, -4.0, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.0, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000002, -4.100000000000001, -3.9000000000000004, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -4.100000000000001, -4.100000000000001, -3.9000000000000012, -4.100000000000001, -4.200000000000001, -3.900000000000001, -4.000000000000001, -4.200000000000001, -3.9000000000000004, -3.900000000000001, -4.100000000000001, -4.200000000000001, -3.900000000000001, -3.6000000000000005, -4.200000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.9000000000000004, -4.300000000000001, -3.800000000000001, -4.200000000000001, -3.800000000000001, -3.8000000000000003, -4.0, -3.900000000000001, -4.200000000000001, -3.900000000000001, -3.8000000000000007, -4.0, -3.8000000000000007, -4.200000000000001, -3.900000000000001, -4.1000000000000005, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000002, -4.300000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.800000000000001, -4.000000000000002, -4.000000000000002, -3.9000000000000012, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -4.100000000000001, -3.8000000000000007, -3.700000000000001, -3.800000000000001, -12.1, -4.200000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000002, -3.6, -3.700000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.800000000000001, -3.8000000000000007, -4.1000000000000005, -3.900000000000001, -10.0, -4.000000000000001, -3.800000000000001, -3.8000000000000007, -3.900000000000001, -4.200000000000001, -4.0, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -4.000000000000002, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.0, -3.8000000000000007, -4.200000000000001, -4.200000000000001, -4.200000000000001, -3.8000000000000007, -3.800000000000001, -4.100000000000001, -3.800000000000001, -4.300000000000001, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -3.600000000000001, -3.600000000000001, -3.6000000000000005, -3.700000000000001, -3.7000000000000006, -4.100000000000001, -3.7, -4.200000000000001, -3.8000000000000007, -4.000000000000002, -3.8000000000000007, -4.200000000000001, -3.9000000000000004, -3.9000000000000012, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.800000000000001, -3.7000000000000006, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.200000000000001, -3.800000000000001, -3.7000000000000006, -4.000000000000001, -4.200000000000001, -4.300000000000001, -3.600000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000002, -4.000000000000001, -4.100000000000001, -4.100000000000001, -3.800000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.9000000000000012, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.800000000000001, -3.900000000000001, -4.000000000000001, -3.9000000000000012], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.666145065898109, "mean_inference_ms": 18.184354138266393, "mean_action_processing_ms": 0.943644075200168, "mean_env_wait_ms": 1.604757675972893, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.071478020298025, "StateBufferConnector_ms": 0.009385614447254952, "ViewRequirementAgentConnector_ms": 0.13304212705685142}}, "episode_reward_max": -3.6, "episode_reward_min": -12.1, "episode_reward_mean": -4.06448087431694, "episode_len_mean": 20.76502732240437, "episodes_this_iter": 183, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.000000000000001, -3.7000000000000006, -3.8000000000000003, -3.900000000000001, -3.8000000000000007, -4.000000000000002, -3.800000000000001, -3.8000000000000007, -4.100000000000001, -4.200000000000001, -3.900000000000001, -4.000000000000001, -10.3, -4.0, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.0, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000002, -4.100000000000001, -3.9000000000000004, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -4.100000000000001, -4.100000000000001, -3.9000000000000012, -4.100000000000001, -4.200000000000001, -3.900000000000001, -4.000000000000001, -4.200000000000001, -3.9000000000000004, -3.900000000000001, -4.100000000000001, -4.200000000000001, -3.900000000000001, -3.6000000000000005, -4.200000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.9000000000000004, -4.300000000000001, -3.800000000000001, -4.200000000000001, -3.800000000000001, -3.8000000000000003, -4.0, -3.900000000000001, -4.200000000000001, -3.900000000000001, -3.8000000000000007, -4.0, -3.8000000000000007, -4.200000000000001, -3.900000000000001, -4.1000000000000005, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000002, -4.300000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.800000000000001, -4.000000000000002, -4.000000000000002, -3.9000000000000012, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -4.100000000000001, -3.8000000000000007, -3.700000000000001, -3.800000000000001, -12.1, -4.200000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000002, -3.6, -3.700000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.800000000000001, -3.8000000000000007, -4.1000000000000005, -3.900000000000001, -10.0, -4.000000000000001, -3.800000000000001, -3.8000000000000007, -3.900000000000001, -4.200000000000001, -4.0, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -4.000000000000002, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.0, -3.8000000000000007, -4.200000000000001, -4.200000000000001, -4.200000000000001, -3.8000000000000007, -3.800000000000001, -4.100000000000001, -3.800000000000001, -4.300000000000001, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -3.600000000000001, -3.600000000000001, -3.6000000000000005, -3.700000000000001, -3.7000000000000006, -4.100000000000001, -3.7, -4.200000000000001, -3.8000000000000007, -4.000000000000002, -3.8000000000000007, -4.200000000000001, -3.9000000000000004, -3.9000000000000012, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.800000000000001, -3.7000000000000006, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.200000000000001, -3.800000000000001, -3.7000000000000006, -4.000000000000001, -4.200000000000001, -4.300000000000001, -3.600000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000002, -4.000000000000001, -4.100000000000001, -4.100000000000001, -3.800000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.9000000000000012, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.800000000000001, -3.900000000000001, -4.000000000000001, -3.9000000000000012], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.666145065898109, "mean_inference_ms": 18.184354138266393, "mean_action_processing_ms": 0.943644075200168, "mean_env_wait_ms": 1.604757675972893, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.071478020298025, "StateBufferConnector_ms": 0.009385614447254952, "ViewRequirementAgentConnector_ms": 0.13304212705685142}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 171822.519, "load_time_ms": 1.17, "load_throughput": 3418897.946, "learn_time_ms": 170857.795, "learn_throughput": 23.411, "synch_weights_time_ms": 180.458}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "done": false, "episodes_total": 18079, "training_iteration": 88, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_01-06-28", "timestamp": 1680822388, "time_this_iter_s": 172.5872359275818, "time_total_s": 15051.395068407059, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0147659520>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01474a81f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 15051.395068407059, "timesteps_since_restore": 0, "iterations_since_restore": 88, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.637142857142857, "ram_util_percent": 24.200408163265298}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.290282733209672, "cur_kl_coeff": 13.151650153147052, "cur_lr": 0.01, "total_loss": 0.6516245165098739, "policy_loss": -0.000854296416484861, "vf_loss": 0.3515995030762047, "vf_explained_var": 0.7359560030121957, "kl": 0.022877684507333743, "entropy": 2.876609436158211, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 82305.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 356000}, "sampler_results": {"episode_reward_max": -3.400000000000001, "episode_reward_min": -12.700000000000001, "episode_reward_mean": -4.042051282051283, "episode_len_mean": 20.846153846153847, "episode_media": {}, "episodes_this_iter": 195, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.900000000000001, -4.100000000000001, -3.8000000000000007, -12.700000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.800000000000001, -10.6, -10.7, -3.400000000000001, -3.9000000000000012, -4.000000000000001, -3.700000000000001, -3.800000000000001, -3.8000000000000007, -3.700000000000001, -3.700000000000001, -3.900000000000001, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -4.200000000000001, -3.9000000000000012, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000002, -3.800000000000001, -3.8000000000000007, -4.200000000000001, -3.800000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.1000000000000005, -4.000000000000002, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.0, -3.900000000000001, -3.900000000000001, -4.0, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000002, -3.600000000000001, -3.6000000000000005, -4.0, -4.0, -4.300000000000001, -3.900000000000001, -4.0, -3.9000000000000004, -3.700000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.5000000000000013, -4.100000000000001, -4.0, -4.100000000000001, -3.800000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -3.500000000000001, -4.200000000000001, -3.9000000000000004, -3.900000000000001, -3.7000000000000006, -4.000000000000002, -3.900000000000001, -3.800000000000001, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -3.800000000000001, -4.000000000000001, -3.800000000000001, -3.800000000000001, -4.000000000000002, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -4.100000000000001, -4.100000000000001, -3.9000000000000004, -3.7000000000000006, -3.8000000000000007, -3.8000000000000007, -3.800000000000001, -3.9000000000000012, -3.9000000000000004, -3.8000000000000007, -3.7000000000000006, -4.100000000000001, -3.600000000000001, -4.200000000000001, -4.300000000000001, -4.200000000000001, -4.000000000000001, -3.900000000000001, -3.800000000000001, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -4.300000000000001, -4.1000000000000005, -3.900000000000001, -4.200000000000001, -3.9000000000000004, -3.7000000000000006, -3.9000000000000012, -3.7, -3.900000000000001, -3.900000000000001, -3.800000000000001, -4.000000000000002, -4.0, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -4.100000000000001, -3.9000000000000012, -3.700000000000001, -3.9000000000000004, -4.100000000000001, -3.800000000000001, -4.0, -3.700000000000001, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -4.200000000000001, -4.000000000000001, -3.9000000000000004, -3.700000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.9000000000000004, -4.000000000000001, -3.900000000000001, -3.6000000000000005, -4.200000000000001, -3.9000000000000004, -4.200000000000001, -4.000000000000001, -4.200000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -3.9000000000000012, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -3.800000000000001, -4.100000000000001, -4.000000000000001, -4.0, -4.200000000000001, -3.8000000000000007, -3.800000000000001, -3.8000000000000007, -4.0, -3.800000000000001, -3.8000000000000007, -3.700000000000001, -3.9000000000000004, -3.9000000000000012, -4.000000000000002, -4.200000000000001, -3.600000000000001, -4.000000000000001, -3.7000000000000006, -4.000000000000001], "episode_lengths": [21, 21, 21, 19, 21, 21, 21, 21, 21, 7, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.66185989797825, "mean_inference_ms": 18.186407826948034, "mean_action_processing_ms": 0.9433569076308082, "mean_env_wait_ms": 1.6070835321837438, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07887351207244091, "StateBufferConnector_ms": 0.010271805983323317, "ViewRequirementAgentConnector_ms": 0.14539694174742088}}, "episode_reward_max": -3.400000000000001, "episode_reward_min": -12.700000000000001, "episode_reward_mean": -4.042051282051283, "episode_len_mean": 20.846153846153847, "episodes_this_iter": 195, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.900000000000001, -4.100000000000001, -3.8000000000000007, -12.700000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.800000000000001, -10.6, -10.7, -3.400000000000001, -3.9000000000000012, -4.000000000000001, -3.700000000000001, -3.800000000000001, -3.8000000000000007, -3.700000000000001, -3.700000000000001, -3.900000000000001, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -4.200000000000001, -3.9000000000000012, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000002, -3.800000000000001, -3.8000000000000007, -4.200000000000001, -3.800000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.1000000000000005, -4.000000000000002, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.0, -3.900000000000001, -3.900000000000001, -4.0, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000002, -3.600000000000001, -3.6000000000000005, -4.0, -4.0, -4.300000000000001, -3.900000000000001, -4.0, -3.9000000000000004, -3.700000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.5000000000000013, -4.100000000000001, -4.0, -4.100000000000001, -3.800000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -3.500000000000001, -4.200000000000001, -3.9000000000000004, -3.900000000000001, -3.7000000000000006, -4.000000000000002, -3.900000000000001, -3.800000000000001, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -3.800000000000001, -4.000000000000001, -3.800000000000001, -3.800000000000001, -4.000000000000002, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -4.100000000000001, -4.100000000000001, -3.9000000000000004, -3.7000000000000006, -3.8000000000000007, -3.8000000000000007, -3.800000000000001, -3.9000000000000012, -3.9000000000000004, -3.8000000000000007, -3.7000000000000006, -4.100000000000001, -3.600000000000001, -4.200000000000001, -4.300000000000001, -4.200000000000001, -4.000000000000001, -3.900000000000001, -3.800000000000001, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -4.300000000000001, -4.1000000000000005, -3.900000000000001, -4.200000000000001, -3.9000000000000004, -3.7000000000000006, -3.9000000000000012, -3.7, -3.900000000000001, -3.900000000000001, -3.800000000000001, -4.000000000000002, -4.0, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -4.100000000000001, -3.9000000000000012, -3.700000000000001, -3.9000000000000004, -4.100000000000001, -3.800000000000001, -4.0, -3.700000000000001, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -4.200000000000001, -4.000000000000001, -3.9000000000000004, -3.700000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.9000000000000004, -4.000000000000001, -3.900000000000001, -3.6000000000000005, -4.200000000000001, -3.9000000000000004, -4.200000000000001, -4.000000000000001, -4.200000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -3.9000000000000012, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -3.800000000000001, -4.100000000000001, -4.000000000000001, -4.0, -4.200000000000001, -3.8000000000000007, -3.800000000000001, -3.8000000000000007, -4.0, -3.800000000000001, -3.8000000000000007, -3.700000000000001, -3.9000000000000004, -3.9000000000000012, -4.000000000000002, -4.200000000000001, -3.600000000000001, -4.000000000000001, -3.7000000000000006, -4.000000000000001], "episode_lengths": [21, 21, 21, 19, 21, 21, 21, 21, 21, 7, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.66185989797825, "mean_inference_ms": 18.186407826948034, "mean_action_processing_ms": 0.9433569076308082, "mean_env_wait_ms": 1.6070835321837438, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07887351207244091, "StateBufferConnector_ms": 0.010271805983323317, "ViewRequirementAgentConnector_ms": 0.14539694174742088}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 356000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 356000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 356000, "timers": {"training_iteration_time_ms": 171852.707, "load_time_ms": 1.182, "load_throughput": 3384140.713, "learn_time_ms": 170887.786, "learn_throughput": 23.407, "synch_weights_time_ms": 180.203}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 356000}, "done": false, "episodes_total": 18274, "training_iteration": 89, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_01-09-20", "timestamp": 1680822560, "time_this_iter_s": 171.689954996109, "time_total_s": 15223.085023403168, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01475691c0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014731fca0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 15223.085023403168, "timesteps_since_restore": 0, "iterations_since_restore": 89, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.295102040816326, "ram_util_percent": 24.206122448979585}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.462609022150758, "cur_kl_coeff": 19.727475229720586, "cur_lr": 0.01, "total_loss": 3.3460006077703768, "policy_loss": 0.018126000539069213, "vf_loss": 0.2905205140350967, "vf_explained_var": 0.7531078005990675, "kl": 0.1539656698539783, "entropy": 2.81625602258149, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 83235.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "sampler_results": {"episode_reward_max": -3.4000000000000004, "episode_reward_min": -10.9, "episode_reward_mean": -4.000512820512821, "episode_len_mean": 20.84102564102564, "episode_media": {}, "episodes_this_iter": 195, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.9, -3.900000000000001, -3.600000000000001, -3.800000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.700000000000001, -3.600000000000001, -3.7000000000000006, -3.700000000000001, -3.8000000000000003, -4.000000000000001, -10.2, -3.6000000000000005, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -4.1000000000000005, -3.900000000000001, -3.600000000000001, -4.300000000000001, -3.900000000000001, -3.9000000000000012, -3.8000000000000007, -4.200000000000001, -4.000000000000001, -4.400000000000001, -4.000000000000002, -3.800000000000001, -4.300000000000001, -4.100000000000001, -4.0, -3.800000000000001, -4.1000000000000005, -3.5000000000000004, -4.1000000000000005, -3.900000000000001, -3.700000000000001, -3.900000000000001, -4.000000000000002, -3.6000000000000014, -4.000000000000002, -3.9000000000000012, -3.900000000000001, -3.7000000000000006, -4.100000000000001, -3.9000000000000012, -3.8000000000000007, -3.600000000000001, -4.0, -3.8000000000000007, -4.000000000000002, -4.100000000000001, -3.8000000000000007, -3.9000000000000004, -3.400000000000001, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.7000000000000006, -3.600000000000001, -3.900000000000001, -3.800000000000001, -4.100000000000001, -3.9000000000000012, -3.9000000000000012, -3.900000000000001, -3.900000000000001, -4.1000000000000005, -4.000000000000001, -4.200000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000001, -4.1000000000000005, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -4.200000000000001, -4.100000000000001, -3.800000000000001, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -3.600000000000001, -3.800000000000001, -3.8000000000000007, -4.000000000000001, -3.9000000000000012, -4.100000000000001, -4.0, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000002, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.1000000000000005, -3.700000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -4.0, -3.800000000000001, -4.000000000000001, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000001, -4.200000000000001, -3.800000000000001, -4.100000000000001, -4.100000000000001, -3.800000000000001, -3.8000000000000007, -4.000000000000002, -3.9000000000000012, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -3.7000000000000006, -3.7000000000000006, -4.000000000000001, -3.4000000000000004, -4.200000000000001, -3.800000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.700000000000001, -4.000000000000001, -4.200000000000001, -4.200000000000001, -3.800000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.700000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000002, -3.8000000000000007, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -3.8000000000000007, -3.700000000000001, -3.7000000000000006, -3.900000000000001, -4.100000000000001, -4.100000000000001, -3.800000000000001, -4.100000000000001, -3.7000000000000006, -4.200000000000001, -4.100000000000001, -3.800000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.700000000000001, -4.200000000000001, -4.000000000000001, -3.700000000000001], "episode_lengths": [8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.659194520822608, "mean_inference_ms": 18.18898949017345, "mean_action_processing_ms": 0.9436906936148676, "mean_env_wait_ms": 1.6063208480833004, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07536484644963191, "StateBufferConnector_ms": 0.009940465291341146, "ViewRequirementAgentConnector_ms": 0.13711868188320062}}, "episode_reward_max": -3.4000000000000004, "episode_reward_min": -10.9, "episode_reward_mean": -4.000512820512821, "episode_len_mean": 20.84102564102564, "episodes_this_iter": 195, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10.9, -3.900000000000001, -3.600000000000001, -3.800000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.700000000000001, -3.600000000000001, -3.7000000000000006, -3.700000000000001, -3.8000000000000003, -4.000000000000001, -10.2, -3.6000000000000005, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -4.1000000000000005, -3.900000000000001, -3.600000000000001, -4.300000000000001, -3.900000000000001, -3.9000000000000012, -3.8000000000000007, -4.200000000000001, -4.000000000000001, -4.400000000000001, -4.000000000000002, -3.800000000000001, -4.300000000000001, -4.100000000000001, -4.0, -3.800000000000001, -4.1000000000000005, -3.5000000000000004, -4.1000000000000005, -3.900000000000001, -3.700000000000001, -3.900000000000001, -4.000000000000002, -3.6000000000000014, -4.000000000000002, -3.9000000000000012, -3.900000000000001, -3.7000000000000006, -4.100000000000001, -3.9000000000000012, -3.8000000000000007, -3.600000000000001, -4.0, -3.8000000000000007, -4.000000000000002, -4.100000000000001, -3.8000000000000007, -3.9000000000000004, -3.400000000000001, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.7000000000000006, -3.600000000000001, -3.900000000000001, -3.800000000000001, -4.100000000000001, -3.9000000000000012, -3.9000000000000012, -3.900000000000001, -3.900000000000001, -4.1000000000000005, -4.000000000000001, -4.200000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000001, -4.1000000000000005, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -4.200000000000001, -4.100000000000001, -3.800000000000001, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -3.600000000000001, -3.800000000000001, -3.8000000000000007, -4.000000000000001, -3.9000000000000012, -4.100000000000001, -4.0, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000002, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.1000000000000005, -3.700000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -4.0, -3.800000000000001, -4.000000000000001, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000001, -4.200000000000001, -3.800000000000001, -4.100000000000001, -4.100000000000001, -3.800000000000001, -3.8000000000000007, -4.000000000000002, -3.9000000000000012, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -3.7000000000000006, -3.7000000000000006, -4.000000000000001, -3.4000000000000004, -4.200000000000001, -3.800000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.700000000000001, -4.000000000000001, -4.200000000000001, -4.200000000000001, -3.800000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.700000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000002, -3.8000000000000007, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -3.8000000000000007, -3.700000000000001, -3.7000000000000006, -3.900000000000001, -4.100000000000001, -4.100000000000001, -3.800000000000001, -4.100000000000001, -3.7000000000000006, -4.200000000000001, -4.100000000000001, -3.800000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.700000000000001, -4.200000000000001, -4.000000000000001, -3.700000000000001], "episode_lengths": [8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.659194520822608, "mean_inference_ms": 18.18898949017345, "mean_action_processing_ms": 0.9436906936148676, "mean_env_wait_ms": 1.6063208480833004, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07536484644963191, "StateBufferConnector_ms": 0.009940465291341146, "ViewRequirementAgentConnector_ms": 0.13711868188320062}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 171829.556, "load_time_ms": 1.177, "load_throughput": 3398398.963, "learn_time_ms": 170879.617, "learn_throughput": 23.408, "synch_weights_time_ms": 174.8}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "episodes_total": 18469, "training_iteration": 90, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_01-12-12", "timestamp": 1680822732, "time_this_iter_s": 172.17779779434204, "time_total_s": 15395.26282119751, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01472fcc10>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014731f280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 15395.26282119751, "timesteps_since_restore": 0, "iterations_since_restore": 90, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.355327868852459, "ram_util_percent": 24.20286885245901}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.219068800762136, "cur_kl_coeff": 29.59121284458087, "cur_lr": 0.01, "total_loss": 0.43501873762416904, "policy_loss": -0.0029511996830302862, "vf_loss": 0.28213835210409216, "vf_explained_var": 0.6778706820421322, "kl": 0.0052661437685983204, "entropy": 2.8780304049932828, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 84165.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 364000}, "sampler_results": {"episode_reward_max": -3.400000000000001, "episode_reward_min": -11.8, "episode_reward_mean": -4.119289340101524, "episode_len_mean": 20.6497461928934, "episode_media": {}, "episodes_this_iter": 197, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.8, -3.8000000000000007, -3.900000000000001, -3.7000000000000006, -10.6, -4.000000000000001, -4.000000000000001, -10.5, -3.900000000000001, -4.000000000000001, -4.100000000000001, -10.6, -3.800000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -3.8000000000000003, -3.8000000000000007, -3.400000000000001, -4.000000000000001, -3.900000000000001, -10.5, -3.700000000000001, -3.8000000000000007, -3.7000000000000006, -4.000000000000002, -3.8000000000000007, -3.800000000000001, -4.1000000000000005, -3.9000000000000012, -3.900000000000001, -4.400000000000001, -4.1000000000000005, -3.7000000000000006, -3.900000000000001, -3.8000000000000007, -3.800000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.600000000000001, -4.000000000000001, -3.900000000000001, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -4.1000000000000005, -3.7000000000000006, -4.200000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000002, -4.200000000000001, -3.800000000000001, -3.9000000000000012, -4.000000000000002, -4.000000000000001, -4.000000000000002, -4.000000000000001, -3.7000000000000006, -4.000000000000002, -4.200000000000001, -4.100000000000001, -4.1000000000000005, -4.100000000000001, -4.000000000000002, -4.000000000000001, -4.000000000000001, -4.1000000000000005, -3.9000000000000012, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -3.800000000000001, -4.100000000000001, -3.900000000000001, -3.7, -4.100000000000001, -4.000000000000002, -3.900000000000001, -4.200000000000001, -4.000000000000001, -3.900000000000001, -3.9000000000000012, -4.000000000000001, -4.000000000000001, -4.0, -4.200000000000001, -3.700000000000001, -3.9000000000000004, -4.100000000000001, -3.9000000000000012, -3.800000000000001, -3.500000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.6000000000000005, -3.800000000000001, -3.800000000000001, -3.9000000000000004, -3.900000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.700000000000001, -4.0, -3.900000000000001, -4.100000000000001, -4.000000000000001, -4.1000000000000005, -3.800000000000001, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.800000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000002, -4.000000000000002, -4.100000000000001, -3.9000000000000012, -4.0, -4.100000000000001, -3.900000000000001, -4.100000000000001, -3.700000000000001, -3.700000000000001, -4.100000000000001, -3.900000000000001, -3.9000000000000012, -4.200000000000001, -4.000000000000002, -4.200000000000001, -3.9000000000000012, -4.100000000000001, -3.9000000000000012, -4.0, -4.100000000000001, -4.0, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -3.6000000000000005, -3.9000000000000004, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.0, -4.200000000000001, -3.8000000000000007, -3.8000000000000007, -3.9000000000000004, -3.900000000000001, -4.000000000000001, -3.9000000000000012, -3.8000000000000007, -4.100000000000001, -3.800000000000001, -4.000000000000002, -3.9000000000000012, -3.900000000000001, -3.900000000000001, -3.700000000000001, -3.7000000000000006, -3.800000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.9000000000000012, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -4.000000000000001], "episode_lengths": [13, 21, 21, 21, 6, 21, 21, 6, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.655910025230803, "mean_inference_ms": 18.188860723081262, "mean_action_processing_ms": 0.9429012874047268, "mean_env_wait_ms": 1.604934002915762, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07302470618698198, "StateBufferConnector_ms": 0.009660793439990979, "ViewRequirementAgentConnector_ms": 0.13590730386337047}}, "episode_reward_max": -3.400000000000001, "episode_reward_min": -11.8, "episode_reward_mean": -4.119289340101524, "episode_len_mean": 20.6497461928934, "episodes_this_iter": 197, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11.8, -3.8000000000000007, -3.900000000000001, -3.7000000000000006, -10.6, -4.000000000000001, -4.000000000000001, -10.5, -3.900000000000001, -4.000000000000001, -4.100000000000001, -10.6, -3.800000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -3.8000000000000003, -3.8000000000000007, -3.400000000000001, -4.000000000000001, -3.900000000000001, -10.5, -3.700000000000001, -3.8000000000000007, -3.7000000000000006, -4.000000000000002, -3.8000000000000007, -3.800000000000001, -4.1000000000000005, -3.9000000000000012, -3.900000000000001, -4.400000000000001, -4.1000000000000005, -3.7000000000000006, -3.900000000000001, -3.8000000000000007, -3.800000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.600000000000001, -4.000000000000001, -3.900000000000001, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -4.1000000000000005, -3.7000000000000006, -4.200000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000002, -4.200000000000001, -3.800000000000001, -3.9000000000000012, -4.000000000000002, -4.000000000000001, -4.000000000000002, -4.000000000000001, -3.7000000000000006, -4.000000000000002, -4.200000000000001, -4.100000000000001, -4.1000000000000005, -4.100000000000001, -4.000000000000002, -4.000000000000001, -4.000000000000001, -4.1000000000000005, -3.9000000000000012, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -3.800000000000001, -4.100000000000001, -3.900000000000001, -3.7, -4.100000000000001, -4.000000000000002, -3.900000000000001, -4.200000000000001, -4.000000000000001, -3.900000000000001, -3.9000000000000012, -4.000000000000001, -4.000000000000001, -4.0, -4.200000000000001, -3.700000000000001, -3.9000000000000004, -4.100000000000001, -3.9000000000000012, -3.800000000000001, -3.500000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.6000000000000005, -3.800000000000001, -3.800000000000001, -3.9000000000000004, -3.900000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.700000000000001, -4.0, -3.900000000000001, -4.100000000000001, -4.000000000000001, -4.1000000000000005, -3.800000000000001, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.800000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000002, -4.000000000000002, -4.100000000000001, -3.9000000000000012, -4.0, -4.100000000000001, -3.900000000000001, -4.100000000000001, -3.700000000000001, -3.700000000000001, -4.100000000000001, -3.900000000000001, -3.9000000000000012, -4.200000000000001, -4.000000000000002, -4.200000000000001, -3.9000000000000012, -4.100000000000001, -3.9000000000000012, -4.0, -4.100000000000001, -4.0, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -3.6000000000000005, -3.9000000000000004, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.0, -4.200000000000001, -3.8000000000000007, -3.8000000000000007, -3.9000000000000004, -3.900000000000001, -4.000000000000001, -3.9000000000000012, -3.8000000000000007, -4.100000000000001, -3.800000000000001, -4.000000000000002, -3.9000000000000012, -3.900000000000001, -3.900000000000001, -3.700000000000001, -3.7000000000000006, -3.800000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.9000000000000012, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -4.000000000000001], "episode_lengths": [13, 21, 21, 21, 6, 21, 21, 6, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.655910025230803, "mean_inference_ms": 18.188860723081262, "mean_action_processing_ms": 0.9429012874047268, "mean_env_wait_ms": 1.604934002915762, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07302470618698198, "StateBufferConnector_ms": 0.009660793439990979, "ViewRequirementAgentConnector_ms": 0.13590730386337047}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 364000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 364000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 364000, "timers": {"training_iteration_time_ms": 171905.584, "load_time_ms": 1.177, "load_throughput": 3399225.221, "learn_time_ms": 170961.258, "learn_throughput": 23.397, "synch_weights_time_ms": 171.954}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 364000}, "done": false, "episodes_total": 18666, "training_iteration": 91, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_01-15-05", "timestamp": 1680822905, "time_this_iter_s": 172.22657656669617, "time_total_s": 15567.489397764206, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01472af370>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0147357b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 15567.489397764206, "timesteps_since_restore": 0, "iterations_since_restore": 91, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.32530612244898, "ram_util_percent": 24.204897959183665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.596771551332166, "cur_kl_coeff": 29.59121284458087, "cur_lr": 0.01, "total_loss": 0.6237094440847956, "policy_loss": 0.0027024554744643227, "vf_loss": 0.36847723633531604, "vf_explained_var": 0.703261923661796, "kl": 0.008533943811151756, "entropy": 2.8640677205977902, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 85095.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "sampler_results": {"episode_reward_max": -3.5000000000000004, "episode_reward_min": -11.8, "episode_reward_mean": -4.253926701570681, "episode_len_mean": 20.308900523560208, "episode_media": {}, "episodes_this_iter": 191, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.8000000000000007, -10.9, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -3.800000000000001, -4.300000000000001, -4.000000000000002, -4.100000000000001, -10.3, -4.100000000000001, -4.100000000000001, -10.7, -10.5, -3.800000000000001, -3.9000000000000012, -10.1, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -3.8000000000000003, -4.100000000000001, -3.8000000000000007, -4.200000000000001, -4.200000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000002, -3.8000000000000007, -3.9000000000000012, -3.700000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.1000000000000005, -4.000000000000001, -3.800000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000001, -3.5000000000000004, -3.9000000000000012, -4.200000000000001, -3.900000000000001, -4.200000000000001, -3.8000000000000007, -4.100000000000001, -4.000000000000002, -3.900000000000001, -4.000000000000001, -3.700000000000001, -3.900000000000001, -3.9000000000000012, -3.700000000000001, -3.9000000000000012, -3.8000000000000007, -3.800000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.6000000000000005, -4.000000000000001, -4.200000000000001, -4.1000000000000005, -3.900000000000001, -3.800000000000001, -4.200000000000001, -3.900000000000001, -3.8000000000000007, -3.7000000000000006, -3.9000000000000012, -4.100000000000001, -4.0, -4.200000000000001, -4.200000000000001, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -3.900000000000001, -4.100000000000001, -3.7000000000000006, -4.100000000000001, -3.700000000000001, -4.000000000000001, -3.8000000000000007, -10.3, -3.700000000000001, -3.7000000000000006, -10.8, -4.1000000000000005, -4.1000000000000005, -3.8000000000000007, -3.7000000000000006, -3.8000000000000007, -11.8, -3.9000000000000012, -4.000000000000002, -3.8000000000000007, -3.8000000000000007, -3.700000000000001, -10.5, -3.800000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -4.0, -3.8000000000000003, -3.700000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.700000000000001, -3.8000000000000003, -4.000000000000002, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000003, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -3.800000000000001, -3.8000000000000007, -3.900000000000001, -3.9000000000000012, -3.8000000000000007, -4.100000000000001, -4.200000000000001, -3.6000000000000005, -3.800000000000001, -4.000000000000001, -4.200000000000001, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.9000000000000012, -3.900000000000001, -4.000000000000002, -4.000000000000002, -4.100000000000001, -3.7000000000000006, -4.000000000000001, -3.800000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000002, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -3.9000000000000012, -3.8000000000000007, -4.0, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.9000000000000012, -4.0, -3.7000000000000006, -4.100000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.7, -4.1000000000000005, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -3.700000000000001, -3.700000000000001, -3.900000000000001, -3.7000000000000006], "episode_lengths": [21, 8, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 7, 4, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 8, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.654006035053962, "mean_inference_ms": 18.179327520487234, "mean_action_processing_ms": 0.9421843676589301, "mean_env_wait_ms": 1.6038604845692668, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07369955172713515, "StateBufferConnector_ms": 0.009766923195404531, "ViewRequirementAgentConnector_ms": 0.1367807388305664}}, "episode_reward_max": -3.5000000000000004, "episode_reward_min": -11.8, "episode_reward_mean": -4.253926701570681, "episode_len_mean": 20.308900523560208, "episodes_this_iter": 191, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.8000000000000007, -10.9, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -3.800000000000001, -4.300000000000001, -4.000000000000002, -4.100000000000001, -10.3, -4.100000000000001, -4.100000000000001, -10.7, -10.5, -3.800000000000001, -3.9000000000000012, -10.1, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -3.8000000000000003, -4.100000000000001, -3.8000000000000007, -4.200000000000001, -4.200000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000002, -3.8000000000000007, -3.9000000000000012, -3.700000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.1000000000000005, -4.000000000000001, -3.800000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000001, -3.5000000000000004, -3.9000000000000012, -4.200000000000001, -3.900000000000001, -4.200000000000001, -3.8000000000000007, -4.100000000000001, -4.000000000000002, -3.900000000000001, -4.000000000000001, -3.700000000000001, -3.900000000000001, -3.9000000000000012, -3.700000000000001, -3.9000000000000012, -3.8000000000000007, -3.800000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.6000000000000005, -4.000000000000001, -4.200000000000001, -4.1000000000000005, -3.900000000000001, -3.800000000000001, -4.200000000000001, -3.900000000000001, -3.8000000000000007, -3.7000000000000006, -3.9000000000000012, -4.100000000000001, -4.0, -4.200000000000001, -4.200000000000001, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -3.900000000000001, -4.100000000000001, -3.7000000000000006, -4.100000000000001, -3.700000000000001, -4.000000000000001, -3.8000000000000007, -10.3, -3.700000000000001, -3.7000000000000006, -10.8, -4.1000000000000005, -4.1000000000000005, -3.8000000000000007, -3.7000000000000006, -3.8000000000000007, -11.8, -3.9000000000000012, -4.000000000000002, -3.8000000000000007, -3.8000000000000007, -3.700000000000001, -10.5, -3.800000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -4.0, -3.8000000000000003, -3.700000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.700000000000001, -3.8000000000000003, -4.000000000000002, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000003, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -3.800000000000001, -3.8000000000000007, -3.900000000000001, -3.9000000000000012, -3.8000000000000007, -4.100000000000001, -4.200000000000001, -3.6000000000000005, -3.800000000000001, -4.000000000000001, -4.200000000000001, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.9000000000000012, -3.900000000000001, -4.000000000000002, -4.000000000000002, -4.100000000000001, -3.7000000000000006, -4.000000000000001, -3.800000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000002, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -3.9000000000000012, -3.8000000000000007, -4.0, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.9000000000000012, -4.0, -3.7000000000000006, -4.100000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.7, -4.1000000000000005, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -3.700000000000001, -3.700000000000001, -3.900000000000001, -3.7000000000000006], "episode_lengths": [21, 8, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 7, 4, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 8, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.654006035053962, "mean_inference_ms": 18.179327520487234, "mean_action_processing_ms": 0.9421843676589301, "mean_env_wait_ms": 1.6038604845692668, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07369955172713515, "StateBufferConnector_ms": 0.009766923195404531, "ViewRequirementAgentConnector_ms": 0.1367807388305664}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 368000, "timers": {"training_iteration_time_ms": 171954.342, "load_time_ms": 1.199, "load_throughput": 3335099.096, "learn_time_ms": 171011.765, "learn_throughput": 23.39, "synch_weights_time_ms": 171.983}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "done": false, "episodes_total": 18857, "training_iteration": 92, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_01-17-57", "timestamp": 1680823077, "time_this_iter_s": 172.55252051353455, "time_total_s": 15740.04191827774, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476b9070>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014738fe50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 15740.04191827774, "timesteps_since_restore": 0, "iterations_since_restore": 92, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.52520325203252, "ram_util_percent": 24.20243902439023}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.056008719372493, "cur_kl_coeff": 29.59121284458087, "cur_lr": 0.01, "total_loss": 0.5288909458585324, "policy_loss": 0.0031233911978341238, "vf_loss": 0.2629700526755343, "vf_explained_var": 0.6862412514225129, "kl": 0.00888093031382048, "entropy": 2.8399593271234984, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 86025.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "sampler_results": {"episode_reward_max": -3.300000000000001, "episode_reward_min": -11.9, "episode_reward_mean": -4.126530612244899, "episode_len_mean": 20.622448979591837, "episode_media": {}, "episodes_this_iter": 196, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.000000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000002, -10.2, -4.000000000000001, -3.900000000000001, -3.6000000000000005, -3.800000000000001, -3.700000000000001, -3.900000000000001, -3.6000000000000005, -3.9000000000000012, -4.200000000000001, -10.7, -4.000000000000001, -10.2, -3.800000000000001, -3.900000000000001, -10.2, -4.1000000000000005, -4.000000000000002, -4.000000000000001, -4.200000000000001, -4.1000000000000005, -4.000000000000002, -3.6000000000000005, -4.1000000000000005, -4.300000000000001, -3.8000000000000007, -4.200000000000001, -3.800000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.1000000000000005, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -3.9000000000000004, -4.100000000000001, -4.100000000000001, -3.6000000000000005, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -3.8000000000000007, -3.7000000000000006, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.300000000000001, -3.800000000000001, -4.100000000000001, -3.800000000000001, -4.200000000000001, -4.100000000000001, -3.8000000000000003, -3.6000000000000005, -3.9000000000000004, -3.900000000000001, -3.9000000000000012, -3.900000000000001, -3.9000000000000012, -4.0, -4.300000000000001, -3.6000000000000005, -4.200000000000001, -4.200000000000001, -3.9000000000000012, -3.700000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -3.7000000000000006, -4.0, -4.300000000000001, -3.800000000000001, -4.0, -4.200000000000001, -4.200000000000001, -3.800000000000001, -3.800000000000001, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -4.000000000000002, -4.100000000000001, -3.9000000000000004, -3.800000000000001, -3.700000000000001, -11.9, -3.300000000000001, -4.000000000000002, -4.1000000000000005, -4.000000000000001, -3.9000000000000012, -3.9000000000000012, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.300000000000001, -4.1000000000000005, -3.900000000000001, -4.000000000000001, -3.700000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000002, -4.200000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.6000000000000005, -3.900000000000001, -4.100000000000001, -4.300000000000001, -3.9000000000000012, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.0, -3.900000000000001, -4.000000000000001, -4.1000000000000005, -4.200000000000001, -4.000000000000001, -3.700000000000001, -3.800000000000001, -4.000000000000002, -3.8000000000000007, -4.200000000000001, -4.000000000000002, -3.9000000000000004, -3.9000000000000004, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -4.200000000000001, -4.0, -3.900000000000001, -4.200000000000001, -3.900000000000001, -4.0, -3.8000000000000007, -3.7000000000000006, -4.100000000000001, -4.100000000000001, -3.9000000000000004, -3.900000000000001, -4.200000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -3.9000000000000012, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000002, -3.800000000000001, -4.100000000000001, -4.1000000000000005, -4.000000000000001, -3.9000000000000004, -3.700000000000001, -3.700000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.600000000000001, -3.900000000000001], "episode_lengths": [21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 3, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.659401852446953, "mean_inference_ms": 18.18537727980585, "mean_action_processing_ms": 0.9423238759783941, "mean_env_wait_ms": 1.6022282931834175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07504054478236608, "StateBufferConnector_ms": 0.00985264778137207, "ViewRequirementAgentConnector_ms": 0.13883576101186323}}, "episode_reward_max": -3.300000000000001, "episode_reward_min": -11.9, "episode_reward_mean": -4.126530612244899, "episode_len_mean": 20.622448979591837, "episodes_this_iter": 196, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.000000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000002, -10.2, -4.000000000000001, -3.900000000000001, -3.6000000000000005, -3.800000000000001, -3.700000000000001, -3.900000000000001, -3.6000000000000005, -3.9000000000000012, -4.200000000000001, -10.7, -4.000000000000001, -10.2, -3.800000000000001, -3.900000000000001, -10.2, -4.1000000000000005, -4.000000000000002, -4.000000000000001, -4.200000000000001, -4.1000000000000005, -4.000000000000002, -3.6000000000000005, -4.1000000000000005, -4.300000000000001, -3.8000000000000007, -4.200000000000001, -3.800000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.1000000000000005, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -3.9000000000000004, -4.100000000000001, -4.100000000000001, -3.6000000000000005, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -3.8000000000000007, -3.7000000000000006, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.300000000000001, -3.800000000000001, -4.100000000000001, -3.800000000000001, -4.200000000000001, -4.100000000000001, -3.8000000000000003, -3.6000000000000005, -3.9000000000000004, -3.900000000000001, -3.9000000000000012, -3.900000000000001, -3.9000000000000012, -4.0, -4.300000000000001, -3.6000000000000005, -4.200000000000001, -4.200000000000001, -3.9000000000000012, -3.700000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -3.7000000000000006, -4.0, -4.300000000000001, -3.800000000000001, -4.0, -4.200000000000001, -4.200000000000001, -3.800000000000001, -3.800000000000001, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -4.000000000000002, -4.100000000000001, -3.9000000000000004, -3.800000000000001, -3.700000000000001, -11.9, -3.300000000000001, -4.000000000000002, -4.1000000000000005, -4.000000000000001, -3.9000000000000012, -3.9000000000000012, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.300000000000001, -4.1000000000000005, -3.900000000000001, -4.000000000000001, -3.700000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000002, -4.200000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.6000000000000005, -3.900000000000001, -4.100000000000001, -4.300000000000001, -3.9000000000000012, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.0, -3.900000000000001, -4.000000000000001, -4.1000000000000005, -4.200000000000001, -4.000000000000001, -3.700000000000001, -3.800000000000001, -4.000000000000002, -3.8000000000000007, -4.200000000000001, -4.000000000000002, -3.9000000000000004, -3.9000000000000004, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -4.200000000000001, -4.0, -3.900000000000001, -4.200000000000001, -3.900000000000001, -4.0, -3.8000000000000007, -3.7000000000000006, -4.100000000000001, -4.100000000000001, -3.9000000000000004, -3.900000000000001, -4.200000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -3.9000000000000012, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000002, -3.800000000000001, -4.100000000000001, -4.1000000000000005, -4.000000000000001, -3.9000000000000004, -3.700000000000001, -3.700000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.600000000000001, -3.900000000000001], "episode_lengths": [21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 3, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 15, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.659401852446953, "mean_inference_ms": 18.18537727980585, "mean_action_processing_ms": 0.9423238759783941, "mean_env_wait_ms": 1.6022282931834175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07504054478236608, "StateBufferConnector_ms": 0.00985264778137207, "ViewRequirementAgentConnector_ms": 0.13883576101186323}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 372000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 372000, "timers": {"training_iteration_time_ms": 172053.949, "load_time_ms": 1.184, "load_throughput": 3377532.261, "learn_time_ms": 171106.574, "learn_throughput": 23.377, "synch_weights_time_ms": 172.657}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "done": false, "episodes_total": 19053, "training_iteration": 93, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_01-20-50", "timestamp": 1680823250, "time_this_iter_s": 172.2926197052002, "time_total_s": 15912.33453798294, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f014746e160>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01474a81f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 15912.33453798294, "timesteps_since_restore": 0, "iterations_since_restore": 93, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.34734693877551, "ram_util_percent": 24.20204081632652}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.97005856165322, "cur_kl_coeff": 29.59121284458087, "cur_lr": 0.01, "total_loss": 0.5156093192396946, "policy_loss": -0.0051047424204967995, "vf_loss": 0.23625612564144596, "vf_explained_var": 0.7348269979799947, "kl": 0.009612919007157607, "entropy": 2.8318259557088217, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 86955.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000}, "sampler_results": {"episode_reward_max": -3.5000000000000004, "episode_reward_min": -10.8, "episode_reward_mean": -4.080710659898478, "episode_len_mean": 20.65482233502538, "episode_media": {}, "episodes_this_iter": 197, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.900000000000001, -4.100000000000001, -3.600000000000001, -10.3, -4.000000000000002, -3.8000000000000007, -3.7000000000000006, -4.100000000000001, -3.900000000000001, -3.6000000000000005, -3.900000000000001, -10.8, -3.8000000000000007, -3.900000000000001, -3.800000000000001, -3.7000000000000006, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -10.1, -3.6000000000000005, -10.1, -3.8000000000000007, -4.200000000000001, -4.000000000000001, -4.000000000000002, -4.200000000000001, -3.900000000000001, -4.0, -3.9000000000000012, -4.300000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -4.0, -4.000000000000001, -4.200000000000001, -4.000000000000002, -4.000000000000001, -4.300000000000001, -3.900000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000002, -4.300000000000001, -4.200000000000001, -4.200000000000001, -4.300000000000001, -3.9000000000000012, -4.100000000000001, -3.8000000000000007, -4.000000000000002, -3.900000000000001, -4.100000000000001, -3.700000000000001, -3.900000000000001, -4.000000000000002, -3.9000000000000012, -3.9000000000000012, -3.700000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000002, -4.000000000000001, -3.6000000000000005, -3.800000000000001, -3.7000000000000006, -3.900000000000001, -4.300000000000001, -4.1000000000000005, -4.000000000000002, -3.900000000000001, -4.300000000000001, -4.1000000000000005, -3.900000000000001, -4.100000000000001, -4.000000000000002, -4.200000000000001, -4.000000000000001, -3.5000000000000004, -4.000000000000002, -3.800000000000001, -4.000000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -3.700000000000001, -3.9000000000000012, -3.800000000000001, -4.000000000000002, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -3.500000000000001, -3.8000000000000007, -4.200000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -3.9000000000000004, -4.100000000000001, -3.6000000000000005, -3.8000000000000007, -4.0, -4.200000000000001, -3.700000000000001, -4.0, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -4.200000000000001, -4.100000000000001, -4.000000000000001, -3.800000000000001, -3.7000000000000006, -3.8000000000000007, -3.800000000000001, -3.9000000000000012, -4.200000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -3.9000000000000004, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -3.800000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -3.9000000000000012, -4.200000000000001, -3.8000000000000007, -4.1000000000000005, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000002, -4.200000000000001, -3.7000000000000006, -3.8000000000000007, -3.9000000000000004, -4.100000000000001, -3.700000000000001, -4.100000000000001, -3.700000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.6000000000000005, -3.800000000000001, -3.900000000000001, -3.9000000000000012, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.9000000000000012, -4.000000000000001, -3.6000000000000005, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.0, -3.700000000000001, -3.900000000000001, -4.1000000000000005, -3.9000000000000004, -3.900000000000001, -3.900000000000001], "episode_lengths": [21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.657036421706302, "mean_inference_ms": 18.182164670335258, "mean_action_processing_ms": 0.9417428651902439, "mean_env_wait_ms": 1.6001678126738816, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07415931236925465, "StateBufferConnector_ms": 0.009728930323257058, "ViewRequirementAgentConnector_ms": 0.13916444052294427}}, "episode_reward_max": -3.5000000000000004, "episode_reward_min": -10.8, "episode_reward_mean": -4.080710659898478, "episode_len_mean": 20.65482233502538, "episodes_this_iter": 197, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.900000000000001, -4.100000000000001, -3.600000000000001, -10.3, -4.000000000000002, -3.8000000000000007, -3.7000000000000006, -4.100000000000001, -3.900000000000001, -3.6000000000000005, -3.900000000000001, -10.8, -3.8000000000000007, -3.900000000000001, -3.800000000000001, -3.7000000000000006, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -10.1, -3.6000000000000005, -10.1, -3.8000000000000007, -4.200000000000001, -4.000000000000001, -4.000000000000002, -4.200000000000001, -3.900000000000001, -4.0, -3.9000000000000012, -4.300000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -4.0, -4.000000000000001, -4.200000000000001, -4.000000000000002, -4.000000000000001, -4.300000000000001, -3.900000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000002, -4.300000000000001, -4.200000000000001, -4.200000000000001, -4.300000000000001, -3.9000000000000012, -4.100000000000001, -3.8000000000000007, -4.000000000000002, -3.900000000000001, -4.100000000000001, -3.700000000000001, -3.900000000000001, -4.000000000000002, -3.9000000000000012, -3.9000000000000012, -3.700000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000002, -4.000000000000001, -3.6000000000000005, -3.800000000000001, -3.7000000000000006, -3.900000000000001, -4.300000000000001, -4.1000000000000005, -4.000000000000002, -3.900000000000001, -4.300000000000001, -4.1000000000000005, -3.900000000000001, -4.100000000000001, -4.000000000000002, -4.200000000000001, -4.000000000000001, -3.5000000000000004, -4.000000000000002, -3.800000000000001, -4.000000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -3.700000000000001, -3.9000000000000012, -3.800000000000001, -4.000000000000002, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -3.500000000000001, -3.8000000000000007, -4.200000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -3.9000000000000004, -4.100000000000001, -3.6000000000000005, -3.8000000000000007, -4.0, -4.200000000000001, -3.700000000000001, -4.0, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -4.200000000000001, -4.100000000000001, -4.000000000000001, -3.800000000000001, -3.7000000000000006, -3.8000000000000007, -3.800000000000001, -3.9000000000000012, -4.200000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -3.9000000000000004, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -3.800000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -3.9000000000000012, -4.200000000000001, -3.8000000000000007, -4.1000000000000005, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000002, -4.200000000000001, -3.7000000000000006, -3.8000000000000007, -3.9000000000000004, -4.100000000000001, -3.700000000000001, -4.100000000000001, -3.700000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.6000000000000005, -3.800000000000001, -3.900000000000001, -3.9000000000000012, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.9000000000000012, -4.000000000000001, -3.6000000000000005, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.0, -3.700000000000001, -3.900000000000001, -4.1000000000000005, -3.9000000000000004, -3.900000000000001, -3.900000000000001], "episode_lengths": [21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.657036421706302, "mean_inference_ms": 18.182164670335258, "mean_action_processing_ms": 0.9417428651902439, "mean_env_wait_ms": 1.6001678126738816, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07415931236925465, "StateBufferConnector_ms": 0.009728930323257058, "ViewRequirementAgentConnector_ms": 0.13916444052294427}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 376000, "timers": {"training_iteration_time_ms": 172168.879, "load_time_ms": 1.209, "load_throughput": 3307484.672, "learn_time_ms": 171217.797, "learn_throughput": 23.362, "synch_weights_time_ms": 174.063}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000}, "done": false, "episodes_total": 19250, "training_iteration": 94, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_01-23-42", "timestamp": 1680823422, "time_this_iter_s": 172.5596888065338, "time_total_s": 16084.894226789474, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476bccd0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014736b5e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 16084.894226789474, "timesteps_since_restore": 0, "iterations_since_restore": 94, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.341224489795918, "ram_util_percent": 24.206530612244883}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.04153996949555, "cur_kl_coeff": 29.59121284458087, "cur_lr": 0.01, "total_loss": 0.6477297893334781, "policy_loss": -0.00021973287746790917, "vf_loss": 0.2654990893217825, "vf_explained_var": 0.7263993694577165, "kl": 0.012924459401796, "entropy": 2.830456728063604, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 87885.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000}, "sampler_results": {"episode_reward_max": -3.5000000000000004, "episode_reward_min": -11.9, "episode_reward_mean": -4.070526315789475, "episode_len_mean": 20.842105263157894, "episode_media": {}, "episodes_this_iter": 190, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.7, -3.800000000000001, -4.1000000000000005, -3.600000000000001, -3.700000000000001, -10.4, -4.100000000000001, -4.000000000000001, -3.500000000000001, -4.1000000000000005, -4.300000000000001, -4.000000000000001, -3.900000000000001, -3.700000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.800000000000001, -4.300000000000001, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -4.1000000000000005, -4.200000000000001, -4.000000000000001, -3.9000000000000012, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -3.700000000000001, -4.200000000000001, -3.900000000000001, -3.7000000000000006, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -4.0, -3.700000000000001, -3.9000000000000012, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -4.000000000000002, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.200000000000001, -3.9000000000000012, -4.1000000000000005, -3.800000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000002, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -4.100000000000001, -3.800000000000001, -3.900000000000001, -3.9000000000000004, -4.200000000000001, -4.000000000000001, -4.100000000000001, -3.7, -4.100000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.300000000000001, -4.0, -4.200000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000016, -4.100000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -4.200000000000001, -4.200000000000001, -3.8000000000000007, -3.800000000000001, -11.9, -3.800000000000001, -3.9000000000000004, -3.9000000000000012, -4.000000000000001, -4.100000000000001, -4.000000000000002, -4.200000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -3.800000000000001, -3.800000000000001, -3.900000000000001, -3.6000000000000005, -3.900000000000001, -4.0, -4.200000000000001, -4.000000000000002, -3.900000000000001, -4.200000000000001, -3.700000000000001, -3.5000000000000004, -3.8000000000000007, -4.100000000000001, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -4.1000000000000005, -3.900000000000001, -4.000000000000002, -3.7000000000000006, -4.300000000000001, -4.100000000000001, -4.300000000000001, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.9000000000000012, -3.900000000000001, -3.8000000000000007, -4.0, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000002, -3.600000000000001, -3.9000000000000012, -3.8000000000000007, -4.500000000000002, -4.100000000000001, -3.5000000000000004, -4.0, -4.0, -4.300000000000001, -3.9000000000000012, -4.200000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -4.1000000000000005, -4.1000000000000005, -3.700000000000001, -3.9000000000000012, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.200000000000001, -3.8000000000000003, -4.000000000000001, -4.000000000000001, -3.800000000000001, -4.0, -4.000000000000002, -3.900000000000001, -4.100000000000001], "episode_lengths": [14, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.653616794977063, "mean_inference_ms": 18.189460443940128, "mean_action_processing_ms": 0.9417923817177406, "mean_env_wait_ms": 1.5963771413927037, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.073747760371158, "StateBufferConnector_ms": 0.009651309565493935, "ViewRequirementAgentConnector_ms": 0.13624454799451327}}, "episode_reward_max": -3.5000000000000004, "episode_reward_min": -11.9, "episode_reward_mean": -4.070526315789475, "episode_len_mean": 20.842105263157894, "episodes_this_iter": 190, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11.7, -3.800000000000001, -4.1000000000000005, -3.600000000000001, -3.700000000000001, -10.4, -4.100000000000001, -4.000000000000001, -3.500000000000001, -4.1000000000000005, -4.300000000000001, -4.000000000000001, -3.900000000000001, -3.700000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.800000000000001, -4.300000000000001, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -4.1000000000000005, -4.200000000000001, -4.000000000000001, -3.9000000000000012, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -3.700000000000001, -4.200000000000001, -3.900000000000001, -3.7000000000000006, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -4.0, -3.700000000000001, -3.9000000000000012, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -4.000000000000002, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.200000000000001, -3.9000000000000012, -4.1000000000000005, -3.800000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000002, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -4.100000000000001, -3.800000000000001, -3.900000000000001, -3.9000000000000004, -4.200000000000001, -4.000000000000001, -4.100000000000001, -3.7, -4.100000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.300000000000001, -4.0, -4.200000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000016, -4.100000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -4.200000000000001, -4.200000000000001, -3.8000000000000007, -3.800000000000001, -11.9, -3.800000000000001, -3.9000000000000004, -3.9000000000000012, -4.000000000000001, -4.100000000000001, -4.000000000000002, -4.200000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -3.800000000000001, -3.800000000000001, -3.900000000000001, -3.6000000000000005, -3.900000000000001, -4.0, -4.200000000000001, -4.000000000000002, -3.900000000000001, -4.200000000000001, -3.700000000000001, -3.5000000000000004, -3.8000000000000007, -4.100000000000001, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -4.1000000000000005, -3.900000000000001, -4.000000000000002, -3.7000000000000006, -4.300000000000001, -4.100000000000001, -4.300000000000001, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.9000000000000012, -3.900000000000001, -3.8000000000000007, -4.0, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000002, -3.600000000000001, -3.9000000000000012, -3.8000000000000007, -4.500000000000002, -4.100000000000001, -3.5000000000000004, -4.0, -4.0, -4.300000000000001, -3.9000000000000012, -4.200000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -4.1000000000000005, -4.1000000000000005, -3.700000000000001, -3.9000000000000012, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.200000000000001, -3.8000000000000003, -4.000000000000001, -4.000000000000001, -3.800000000000001, -4.0, -4.000000000000002, -3.900000000000001, -4.100000000000001], "episode_lengths": [14, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.653616794977063, "mean_inference_ms": 18.189460443940128, "mean_action_processing_ms": 0.9417923817177406, "mean_env_wait_ms": 1.5963771413927037, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.073747760371158, "StateBufferConnector_ms": 0.009651309565493935, "ViewRequirementAgentConnector_ms": 0.13624454799451327}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 380000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 380000, "timers": {"training_iteration_time_ms": 172249.804, "load_time_ms": 1.185, "load_throughput": 3374610.99, "learn_time_ms": 171304.119, "learn_throughput": 23.35, "synch_weights_time_ms": 173.986}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000}, "done": false, "episodes_total": 19440, "training_iteration": 95, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_01-26-35", "timestamp": 1680823595, "time_this_iter_s": 172.93387937545776, "time_total_s": 16257.828106164932, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01475a5670>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f0147473d30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 16257.828106164932, "timesteps_since_restore": 0, "iterations_since_restore": 95, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.597560975609756, "ram_util_percent": 24.20162601626015}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.650447466809263, "cur_kl_coeff": 29.59121284458087, "cur_lr": 0.01, "total_loss": 0.55899178914886, "policy_loss": 0.0014830000598424224, "vf_loss": 0.26851326219176735, "vf_explained_var": 0.7432592634231814, "kl": 0.009766261438433562, "entropy": 2.8358204205830893, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 88815.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "sampler_results": {"episode_reward_max": -3.400000000000001, "episode_reward_min": -10.5, "episode_reward_mean": -4.012953367875649, "episode_len_mean": 20.818652849740932, "episode_media": {}, "episodes_this_iter": 193, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.800000000000001, -3.700000000000001, -10.5, -3.900000000000001, -3.800000000000001, -4.1000000000000005, -3.9000000000000012, -4.100000000000001, -3.6000000000000005, -3.9000000000000012, -3.7000000000000006, -3.800000000000001, -4.100000000000001, -3.900000000000001, -10.1, -3.900000000000001, -3.900000000000001, -4.0, -4.000000000000001, -3.8000000000000003, -3.700000000000001, -3.7000000000000006, -3.900000000000001, -4.200000000000001, -3.9000000000000012, -4.100000000000001, -3.900000000000001, -4.000000000000002, -3.800000000000001, -4.300000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -4.200000000000001, -3.9000000000000012, -3.900000000000001, -4.200000000000001, -4.100000000000001, -3.700000000000001, -3.600000000000001, -3.8000000000000007, -3.500000000000001, -4.200000000000001, -4.300000000000001, -4.000000000000002, -4.300000000000002, -4.000000000000002, -4.000000000000001, -4.200000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -3.800000000000001, -4.000000000000001, -4.000000000000001, -4.4, -3.8000000000000007, -4.200000000000001, -4.100000000000001, -4.300000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.700000000000001, -3.6, -4.000000000000001, -3.800000000000001, -3.900000000000001, -4.000000000000001, -3.9000000000000012, -4.200000000000001, -4.200000000000001, -4.200000000000001, -4.100000000000001, -4.1000000000000005, -3.5000000000000004, -3.9000000000000012, -4.000000000000001, -4.1000000000000005, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -3.700000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -3.400000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -4.0, -4.100000000000001, -3.900000000000001, -4.000000000000002, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.700000000000001, -4.1000000000000005, -3.900000000000001, -3.9000000000000004, -4.100000000000001, -3.700000000000001, -3.7000000000000006, -3.9000000000000012, -4.000000000000002, -4.200000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.0, -4.000000000000001, -3.700000000000001, -4.200000000000001, -3.9000000000000012, -4.0, -3.900000000000001, -3.5000000000000004, -3.7000000000000006, -4.100000000000001, -4.200000000000001, -4.000000000000001, -3.8000000000000007, -3.8000000000000016, -3.8000000000000007, -4.000000000000001, -3.800000000000001, -4.000000000000001, -4.000000000000001, -4.4, -4.200000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -4.300000000000001, -3.900000000000001, -4.200000000000001, -3.9000000000000012, -3.9000000000000012, -4.100000000000001, -3.600000000000001, -3.900000000000001, -3.8000000000000007, -3.8000000000000003, -3.9000000000000012, -3.600000000000001, -3.800000000000001, -3.900000000000001, -4.000000000000001, -4.1000000000000005, -4.000000000000002, -3.800000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.4, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -3.800000000000001, -3.800000000000001, -3.6000000000000005, -4.000000000000001, -3.900000000000001, -4.100000000000001, -3.7000000000000006, -4.100000000000001, -3.9000000000000004, -3.900000000000001, -4.0, -4.000000000000001, -4.000000000000002, -4.100000000000001, -3.900000000000001, -4.200000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.600000000000001, -3.7000000000000006, -3.900000000000001, -3.700000000000001, -4.100000000000001, -4.000000000000002, -3.6000000000000005], "episode_lengths": [21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.653134256861371, "mean_inference_ms": 18.17764185272816, "mean_action_processing_ms": 0.940937785152255, "mean_env_wait_ms": 1.5929635890202773, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07085096033125961, "StateBufferConnector_ms": 0.009174791642421267, "ViewRequirementAgentConnector_ms": 0.13186425125043008}}, "episode_reward_max": -3.400000000000001, "episode_reward_min": -10.5, "episode_reward_mean": -4.012953367875649, "episode_len_mean": 20.818652849740932, "episodes_this_iter": 193, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.800000000000001, -3.700000000000001, -10.5, -3.900000000000001, -3.800000000000001, -4.1000000000000005, -3.9000000000000012, -4.100000000000001, -3.6000000000000005, -3.9000000000000012, -3.7000000000000006, -3.800000000000001, -4.100000000000001, -3.900000000000001, -10.1, -3.900000000000001, -3.900000000000001, -4.0, -4.000000000000001, -3.8000000000000003, -3.700000000000001, -3.7000000000000006, -3.900000000000001, -4.200000000000001, -3.9000000000000012, -4.100000000000001, -3.900000000000001, -4.000000000000002, -3.800000000000001, -4.300000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -4.200000000000001, -3.9000000000000012, -3.900000000000001, -4.200000000000001, -4.100000000000001, -3.700000000000001, -3.600000000000001, -3.8000000000000007, -3.500000000000001, -4.200000000000001, -4.300000000000001, -4.000000000000002, -4.300000000000002, -4.000000000000002, -4.000000000000001, -4.200000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -3.800000000000001, -4.000000000000001, -4.000000000000001, -4.4, -3.8000000000000007, -4.200000000000001, -4.100000000000001, -4.300000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.700000000000001, -3.6, -4.000000000000001, -3.800000000000001, -3.900000000000001, -4.000000000000001, -3.9000000000000012, -4.200000000000001, -4.200000000000001, -4.200000000000001, -4.100000000000001, -4.1000000000000005, -3.5000000000000004, -3.9000000000000012, -4.000000000000001, -4.1000000000000005, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -3.700000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -3.400000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -4.0, -4.100000000000001, -3.900000000000001, -4.000000000000002, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.700000000000001, -4.1000000000000005, -3.900000000000001, -3.9000000000000004, -4.100000000000001, -3.700000000000001, -3.7000000000000006, -3.9000000000000012, -4.000000000000002, -4.200000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.0, -4.000000000000001, -3.700000000000001, -4.200000000000001, -3.9000000000000012, -4.0, -3.900000000000001, -3.5000000000000004, -3.7000000000000006, -4.100000000000001, -4.200000000000001, -4.000000000000001, -3.8000000000000007, -3.8000000000000016, -3.8000000000000007, -4.000000000000001, -3.800000000000001, -4.000000000000001, -4.000000000000001, -4.4, -4.200000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -4.300000000000001, -3.900000000000001, -4.200000000000001, -3.9000000000000012, -3.9000000000000012, -4.100000000000001, -3.600000000000001, -3.900000000000001, -3.8000000000000007, -3.8000000000000003, -3.9000000000000012, -3.600000000000001, -3.800000000000001, -3.900000000000001, -4.000000000000001, -4.1000000000000005, -4.000000000000002, -3.800000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.4, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -3.800000000000001, -3.800000000000001, -3.6000000000000005, -4.000000000000001, -3.900000000000001, -4.100000000000001, -3.7000000000000006, -4.100000000000001, -3.9000000000000004, -3.900000000000001, -4.0, -4.000000000000001, -4.000000000000002, -4.100000000000001, -3.900000000000001, -4.200000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.600000000000001, -3.7000000000000006, -3.900000000000001, -3.700000000000001, -4.100000000000001, -4.000000000000002, -3.6000000000000005], "episode_lengths": [21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.653134256861371, "mean_inference_ms": 18.17764185272816, "mean_action_processing_ms": 0.940937785152255, "mean_env_wait_ms": 1.5929635890202773, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07085096033125961, "StateBufferConnector_ms": 0.009174791642421267, "ViewRequirementAgentConnector_ms": 0.13186425125043008}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 172372.404, "load_time_ms": 1.29, "load_throughput": 3100747.778, "learn_time_ms": 171417.828, "learn_throughput": 23.335, "synch_weights_time_ms": 174.06}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "episodes_total": 19633, "training_iteration": 96, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_01-29-28", "timestamp": 1680823768, "time_this_iter_s": 172.85826969146729, "time_total_s": 16430.6863758564, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01473e2c70>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014736b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 16430.6863758564, "timesteps_since_restore": 0, "iterations_since_restore": 96, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.512195121951219, "ram_util_percent": 24.20203252032519}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.301212174918064, "cur_kl_coeff": 29.59121284458087, "cur_lr": 0.01, "total_loss": 0.6865889292170284, "policy_loss": -0.0056991435537335055, "vf_loss": 0.27858423931944754, "vf_explained_var": 0.7560655662449457, "kl": 0.013980630918541142, "entropy": 2.820495625977875, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 89745.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 388000}, "sampler_results": {"episode_reward_max": -3.6000000000000005, "episode_reward_min": -11.2, "episode_reward_mean": -4.010309278350516, "episode_len_mean": 20.86082474226804, "episode_media": {}, "episodes_this_iter": 194, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.100000000000001, -4.1000000000000005, -3.7000000000000006, -3.700000000000001, -3.8000000000000003, -3.900000000000001, -3.700000000000001, -3.900000000000001, -3.900000000000001, -11.2, -3.7000000000000006, -3.8000000000000007, -3.900000000000001, -4.300000000000001, -3.700000000000001, -3.7000000000000006, -3.8000000000000007, -3.6000000000000014, -3.700000000000001, -10.4, -3.8000000000000007, -3.700000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.200000000000001, -3.8000000000000007, -4.100000000000001, -3.800000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -4.200000000000001, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000002, -4.100000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -3.700000000000001, -4.100000000000001, -4.200000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -3.8000000000000003, -4.000000000000001, -3.9000000000000004, -3.6000000000000005, -3.900000000000001, -3.700000000000001, -4.200000000000001, -3.800000000000001, -3.8000000000000003, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -3.6000000000000005, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.300000000000001, -4.200000000000001, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000002, -3.8000000000000003, -3.8000000000000007, -3.8000000000000007, -4.100000000000001, -4.200000000000001, -4.200000000000001, -4.200000000000001, -4.000000000000001, -3.9000000000000012, -4.200000000000001, -3.6000000000000005, -4.100000000000001, -3.900000000000001, -4.000000000000002, -4.000000000000001, -4.300000000000001, -4.100000000000001, -3.6000000000000005, -3.700000000000001, -3.9000000000000012, -4.300000000000001, -4.200000000000001, -4.200000000000001, -3.900000000000001, -4.1000000000000005, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -4.300000000000001, -4.100000000000001, -3.900000000000001, -3.9000000000000004, -3.800000000000001, -4.200000000000001, -3.8000000000000007, -3.9000000000000012, -4.100000000000001, -3.900000000000001, -3.700000000000001, -3.9000000000000012, -4.200000000000001, -4.000000000000001, -3.9000000000000012, -3.9000000000000012, -3.8000000000000007, -4.100000000000001, -4.0, -3.9000000000000004, -4.000000000000002, -3.900000000000001, -3.800000000000001, -4.000000000000001, -3.600000000000001, -4.100000000000001, -4.000000000000001, -3.700000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -3.7000000000000006, -4.100000000000001, -3.7000000000000006, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -4.200000000000001, -3.9000000000000012, -4.000000000000001, -3.900000000000001, -4.300000000000001, -3.8000000000000007, -4.100000000000001, -3.8000000000000007, -4.000000000000002, -4.000000000000001, -3.900000000000001, -4.100000000000001, -3.9000000000000012, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.600000000000001, -4.200000000000001, -3.8000000000000007, -3.9000000000000012, -3.900000000000001, -4.100000000000001, -3.7000000000000006, -4.000000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000002, -3.900000000000001, -3.700000000000001, -3.9000000000000012, -3.900000000000001, -3.8000000000000003, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000002, -4.200000000000001, -3.7000000000000006, -3.8000000000000007, -3.900000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.649926247860108, "mean_inference_ms": 18.171130159986358, "mean_action_processing_ms": 0.9407953633319791, "mean_env_wait_ms": 1.5929926655951083, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07253479711788217, "StateBufferConnector_ms": 0.0097240369344495, "ViewRequirementAgentConnector_ms": 0.1332177329309208}}, "episode_reward_max": -3.6000000000000005, "episode_reward_min": -11.2, "episode_reward_mean": -4.010309278350516, "episode_len_mean": 20.86082474226804, "episodes_this_iter": 194, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.100000000000001, -4.1000000000000005, -3.7000000000000006, -3.700000000000001, -3.8000000000000003, -3.900000000000001, -3.700000000000001, -3.900000000000001, -3.900000000000001, -11.2, -3.7000000000000006, -3.8000000000000007, -3.900000000000001, -4.300000000000001, -3.700000000000001, -3.7000000000000006, -3.8000000000000007, -3.6000000000000014, -3.700000000000001, -10.4, -3.8000000000000007, -3.700000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.200000000000001, -3.8000000000000007, -4.100000000000001, -3.800000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -4.200000000000001, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000002, -4.100000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -3.700000000000001, -4.100000000000001, -4.200000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -3.8000000000000003, -4.000000000000001, -3.9000000000000004, -3.6000000000000005, -3.900000000000001, -3.700000000000001, -4.200000000000001, -3.800000000000001, -3.8000000000000003, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -3.6000000000000005, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.300000000000001, -4.200000000000001, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000002, -3.8000000000000003, -3.8000000000000007, -3.8000000000000007, -4.100000000000001, -4.200000000000001, -4.200000000000001, -4.200000000000001, -4.000000000000001, -3.9000000000000012, -4.200000000000001, -3.6000000000000005, -4.100000000000001, -3.900000000000001, -4.000000000000002, -4.000000000000001, -4.300000000000001, -4.100000000000001, -3.6000000000000005, -3.700000000000001, -3.9000000000000012, -4.300000000000001, -4.200000000000001, -4.200000000000001, -3.900000000000001, -4.1000000000000005, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -4.300000000000001, -4.100000000000001, -3.900000000000001, -3.9000000000000004, -3.800000000000001, -4.200000000000001, -3.8000000000000007, -3.9000000000000012, -4.100000000000001, -3.900000000000001, -3.700000000000001, -3.9000000000000012, -4.200000000000001, -4.000000000000001, -3.9000000000000012, -3.9000000000000012, -3.8000000000000007, -4.100000000000001, -4.0, -3.9000000000000004, -4.000000000000002, -3.900000000000001, -3.800000000000001, -4.000000000000001, -3.600000000000001, -4.100000000000001, -4.000000000000001, -3.700000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -3.7000000000000006, -4.100000000000001, -3.7000000000000006, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -4.200000000000001, -3.9000000000000012, -4.000000000000001, -3.900000000000001, -4.300000000000001, -3.8000000000000007, -4.100000000000001, -3.8000000000000007, -4.000000000000002, -4.000000000000001, -3.900000000000001, -4.100000000000001, -3.9000000000000012, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.600000000000001, -4.200000000000001, -3.8000000000000007, -3.9000000000000012, -3.900000000000001, -4.100000000000001, -3.7000000000000006, -4.000000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000002, -3.900000000000001, -3.700000000000001, -3.9000000000000012, -3.900000000000001, -3.8000000000000003, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000002, -4.200000000000001, -3.7000000000000006, -3.8000000000000007, -3.900000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.649926247860108, "mean_inference_ms": 18.171130159986358, "mean_action_processing_ms": 0.9407953633319791, "mean_env_wait_ms": 1.5929926655951083, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07253479711788217, "StateBufferConnector_ms": 0.0097240369344495, "ViewRequirementAgentConnector_ms": 0.1332177329309208}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 388000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 388000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 388000, "timers": {"training_iteration_time_ms": 172475.706, "load_time_ms": 1.283, "load_throughput": 3118789.456, "learn_time_ms": 171528.264, "learn_throughput": 23.32, "synch_weights_time_ms": 173.424}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 388000}, "done": false, "episodes_total": 19827, "training_iteration": 97, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_01-32-21", "timestamp": 1680823941, "time_this_iter_s": 172.99162912368774, "time_total_s": 16603.678004980087, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01477a3340>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014736b3a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 16603.678004980087, "timesteps_since_restore": 0, "iterations_since_restore": 97, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.305306122448979, "ram_util_percent": 24.20204081632652}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.305461848166683, "cur_kl_coeff": 29.59121284458087, "cur_lr": 0.01, "total_loss": 0.5791206004037972, "policy_loss": 0.005427652236039159, "vf_loss": 0.28590491509405513, "vf_explained_var": 0.6997693293838091, "kl": 0.009725455739000256, "entropy": 2.84088373491841, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 90675.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000}, "sampler_results": {"episode_reward_max": -3.5000000000000004, "episode_reward_min": -11.6, "episode_reward_mean": -4.065425531914895, "episode_len_mean": 20.77127659574468, "episode_media": {}, "episodes_this_iter": 188, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.000000000000001, -3.800000000000001, -3.800000000000001, -3.9000000000000004, -11.6, -3.700000000000001, -4.200000000000001, -3.7000000000000006, -4.000000000000001, -3.700000000000001, -4.000000000000002, -4.100000000000001, -4.100000000000001, -10.1, -3.700000000000001, -4.000000000000001, -3.800000000000001, -10.6, -4.100000000000001, -4.100000000000001, -3.800000000000001, -4.000000000000001, -4.000000000000002, -4.4, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000002, -4.100000000000001, -4.200000000000001, -3.7000000000000006, -4.200000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.200000000000001, -3.9000000000000012, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -3.800000000000001, -4.000000000000001, -3.8000000000000007, -4.300000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000002, -4.100000000000001, -4.100000000000001, -4.400000000000001, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -3.800000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -3.800000000000001, -3.8000000000000007, -4.100000000000001, -3.7000000000000006, -3.900000000000001, -3.700000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -4.200000000000001, -3.900000000000001, -4.0, -3.8000000000000007, -4.100000000000001, -3.9000000000000012, -4.100000000000001, -4.000000000000001, -3.7000000000000006, -3.8000000000000007, -4.000000000000001, -3.9000000000000012, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -3.9000000000000012, -4.000000000000001, -3.600000000000001, -3.9000000000000012, -3.500000000000001, -3.9000000000000004, -3.5000000000000004, -3.900000000000001, -4.000000000000001, -4.000000000000002, -4.1000000000000005, -3.8000000000000007, -3.9000000000000012, -3.7000000000000006, -3.900000000000001, -3.600000000000001, -3.8000000000000007, -4.000000000000002, -4.200000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000001, -3.8000000000000003, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -3.9000000000000012, -3.900000000000001, -4.300000000000001, -3.900000000000001, -3.9000000000000012, -3.7000000000000006, -4.000000000000001, -3.800000000000001, -3.900000000000001, -3.9000000000000012, -3.8000000000000007, -3.800000000000001, -4.200000000000001, -4.000000000000001, -4.1000000000000005, -3.700000000000001, -3.7000000000000006, -4.200000000000001, -3.7000000000000006, -3.8000000000000007, -4.100000000000001, -4.200000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -4.1000000000000005, -3.700000000000001, -4.100000000000001, -3.700000000000001, -3.9000000000000012, -4.100000000000001, -3.9000000000000004, -3.8000000000000003, -3.8000000000000007, -3.8000000000000007, -3.9000000000000004, -3.9000000000000012, -4.000000000000002, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.300000000000001, -4.100000000000001, -3.9000000000000012, -3.900000000000001, -4.000000000000002, -4.000000000000001, -4.200000000000001, -3.900000000000001, -4.000000000000001, -3.6000000000000005, -4.100000000000001, -4.100000000000001, -3.600000000000001, -4.1000000000000005, -3.8000000000000007], "episode_lengths": [21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.654423277992732, "mean_inference_ms": 18.197881429409353, "mean_action_processing_ms": 0.9415254952513926, "mean_env_wait_ms": 1.5913550647844987, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08083100014544548, "StateBufferConnector_ms": 0.010561055325447245, "ViewRequirementAgentConnector_ms": 0.14736665056106893}}, "episode_reward_max": -3.5000000000000004, "episode_reward_min": -11.6, "episode_reward_mean": -4.065425531914895, "episode_len_mean": 20.77127659574468, "episodes_this_iter": 188, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.000000000000001, -3.800000000000001, -3.800000000000001, -3.9000000000000004, -11.6, -3.700000000000001, -4.200000000000001, -3.7000000000000006, -4.000000000000001, -3.700000000000001, -4.000000000000002, -4.100000000000001, -4.100000000000001, -10.1, -3.700000000000001, -4.000000000000001, -3.800000000000001, -10.6, -4.100000000000001, -4.100000000000001, -3.800000000000001, -4.000000000000001, -4.000000000000002, -4.4, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000002, -4.100000000000001, -4.200000000000001, -3.7000000000000006, -4.200000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.200000000000001, -3.9000000000000012, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -3.800000000000001, -4.000000000000001, -3.8000000000000007, -4.300000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000002, -4.100000000000001, -4.100000000000001, -4.400000000000001, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -3.800000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -3.800000000000001, -3.8000000000000007, -4.100000000000001, -3.7000000000000006, -3.900000000000001, -3.700000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -4.200000000000001, -3.900000000000001, -4.0, -3.8000000000000007, -4.100000000000001, -3.9000000000000012, -4.100000000000001, -4.000000000000001, -3.7000000000000006, -3.8000000000000007, -4.000000000000001, -3.9000000000000012, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -3.9000000000000012, -4.000000000000001, -3.600000000000001, -3.9000000000000012, -3.500000000000001, -3.9000000000000004, -3.5000000000000004, -3.900000000000001, -4.000000000000001, -4.000000000000002, -4.1000000000000005, -3.8000000000000007, -3.9000000000000012, -3.7000000000000006, -3.900000000000001, -3.600000000000001, -3.8000000000000007, -4.000000000000002, -4.200000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000001, -3.8000000000000003, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -3.9000000000000012, -3.900000000000001, -4.300000000000001, -3.900000000000001, -3.9000000000000012, -3.7000000000000006, -4.000000000000001, -3.800000000000001, -3.900000000000001, -3.9000000000000012, -3.8000000000000007, -3.800000000000001, -4.200000000000001, -4.000000000000001, -4.1000000000000005, -3.700000000000001, -3.7000000000000006, -4.200000000000001, -3.7000000000000006, -3.8000000000000007, -4.100000000000001, -4.200000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -4.1000000000000005, -3.700000000000001, -4.100000000000001, -3.700000000000001, -3.9000000000000012, -4.100000000000001, -3.9000000000000004, -3.8000000000000003, -3.8000000000000007, -3.8000000000000007, -3.9000000000000004, -3.9000000000000012, -4.000000000000002, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.300000000000001, -4.100000000000001, -3.9000000000000012, -3.900000000000001, -4.000000000000002, -4.000000000000001, -4.200000000000001, -3.900000000000001, -4.000000000000001, -3.6000000000000005, -4.100000000000001, -4.100000000000001, -3.600000000000001, -4.1000000000000005, -3.8000000000000007], "episode_lengths": [21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.654423277992732, "mean_inference_ms": 18.197881429409353, "mean_action_processing_ms": 0.9415254952513926, "mean_env_wait_ms": 1.5913550647844987, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08083100014544548, "StateBufferConnector_ms": 0.010561055325447245, "ViewRequirementAgentConnector_ms": 0.14736665056106893}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 392000, "timers": {"training_iteration_time_ms": 172499.287, "load_time_ms": 1.292, "load_throughput": 3096055.657, "learn_time_ms": 171548.574, "learn_throughput": 23.317, "synch_weights_time_ms": 176.22}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000}, "done": false, "episodes_total": 20015, "training_iteration": 98, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_01-35-14", "timestamp": 1680824114, "time_this_iter_s": 172.82261657714844, "time_total_s": 16776.500621557236, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01473e2760>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01474a81f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 16776.500621557236, "timesteps_since_restore": 0, "iterations_since_restore": 98, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.333333333333333, "ram_util_percent": 24.202439024390234}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.563571398745301, "cur_kl_coeff": 29.59121284458087, "cur_lr": 0.01, "total_loss": 0.4933468597350262, "policy_loss": -0.00018368687015026807, "vf_loss": 0.2686701554925211, "vf_explained_var": 0.724510936326878, "kl": 0.007598890567270999, "entropy": 2.8678539993942427, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 91605.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "sampler_results": {"episode_reward_max": -3.500000000000001, "episode_reward_min": -11.3, "episode_reward_mean": -4.022051282051283, "episode_len_mean": 20.815384615384616, "episode_media": {}, "episodes_this_iter": 195, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.000000000000001, -3.800000000000001, -3.800000000000001, -4.000000000000001, -3.8000000000000003, -3.9000000000000012, -10.6, -11.3, -4.1000000000000005, -3.7000000000000006, -4.000000000000001, -4.1000000000000005, -11.1, -4.100000000000001, -3.700000000000001, -3.7000000000000006, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.9000000000000012, -3.8000000000000007, -3.7000000000000006, -3.7000000000000006, -4.200000000000001, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -4.000000000000002, -3.500000000000001, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -4.100000000000001, -4.000000000000002, -3.8000000000000007, -3.600000000000001, -3.700000000000001, -4.100000000000001, -3.900000000000001, -3.9000000000000012, -4.0, -3.900000000000001, -3.800000000000001, -4.000000000000001, -3.7000000000000006, -4.100000000000001, -3.8000000000000003, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -4.0, -4.000000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000002, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -3.900000000000001, -4.0, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.9000000000000012, -3.7000000000000006, -4.200000000000001, -4.000000000000001, -3.800000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.700000000000001, -4.100000000000001, -4.100000000000001, -3.600000000000001, -4.200000000000001, -4.100000000000001, -4.200000000000001, -3.900000000000001, -4.000000000000001, -4.300000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000002, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.9000000000000012, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.800000000000001, -4.000000000000002, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -4.000000000000002, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -3.800000000000001, -3.700000000000001, -4.4, -4.0, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000003, -4.100000000000001, -3.700000000000001, -3.700000000000001, -3.8000000000000007, -4.000000000000001, -3.800000000000001, -3.7000000000000006, -3.900000000000001, -3.500000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.9000000000000004, -3.600000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -4.0, -4.0, -4.000000000000001, -3.9000000000000012, -3.9000000000000012, -4.1000000000000005, -3.8000000000000007, -3.9000000000000004, -3.900000000000001, -3.600000000000001, -4.100000000000001, -3.6000000000000005, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.600000000000001, -3.800000000000001, -3.9000000000000012, -4.000000000000001, -4.200000000000001, -3.7000000000000006, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -3.700000000000001, -3.8000000000000007, -4.300000000000001, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -3.9000000000000004, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.9000000000000012, -4.100000000000001, -4.100000000000001, -4.000000000000002, -3.8000000000000007, -4.000000000000002, -3.7000000000000006, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -3.600000000000001, -3.8000000000000007, -4.1000000000000005, -3.900000000000001, -3.9000000000000004], "episode_lengths": [21, 21, 21, 21, 21, 21, 6, 11, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.651329830731916, "mean_inference_ms": 18.18044070007314, "mean_action_processing_ms": 0.9406691008955048, "mean_env_wait_ms": 1.5910115687185724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07520797925117688, "StateBufferConnector_ms": 0.010043168679261819, "ViewRequirementAgentConnector_ms": 0.1378310032379933}}, "episode_reward_max": -3.500000000000001, "episode_reward_min": -11.3, "episode_reward_mean": -4.022051282051283, "episode_len_mean": 20.815384615384616, "episodes_this_iter": 195, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.000000000000001, -3.800000000000001, -3.800000000000001, -4.000000000000001, -3.8000000000000003, -3.9000000000000012, -10.6, -11.3, -4.1000000000000005, -3.7000000000000006, -4.000000000000001, -4.1000000000000005, -11.1, -4.100000000000001, -3.700000000000001, -3.7000000000000006, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.9000000000000012, -3.8000000000000007, -3.7000000000000006, -3.7000000000000006, -4.200000000000001, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -4.000000000000002, -3.500000000000001, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -4.100000000000001, -4.000000000000002, -3.8000000000000007, -3.600000000000001, -3.700000000000001, -4.100000000000001, -3.900000000000001, -3.9000000000000012, -4.0, -3.900000000000001, -3.800000000000001, -4.000000000000001, -3.7000000000000006, -4.100000000000001, -3.8000000000000003, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -4.0, -4.000000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000002, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -3.900000000000001, -4.0, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.9000000000000012, -3.7000000000000006, -4.200000000000001, -4.000000000000001, -3.800000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.700000000000001, -4.100000000000001, -4.100000000000001, -3.600000000000001, -4.200000000000001, -4.100000000000001, -4.200000000000001, -3.900000000000001, -4.000000000000001, -4.300000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000002, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.9000000000000012, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.800000000000001, -4.000000000000002, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -4.000000000000002, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -3.800000000000001, -3.700000000000001, -4.4, -4.0, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000003, -4.100000000000001, -3.700000000000001, -3.700000000000001, -3.8000000000000007, -4.000000000000001, -3.800000000000001, -3.7000000000000006, -3.900000000000001, -3.500000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.9000000000000004, -3.600000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -4.0, -4.0, -4.000000000000001, -3.9000000000000012, -3.9000000000000012, -4.1000000000000005, -3.8000000000000007, -3.9000000000000004, -3.900000000000001, -3.600000000000001, -4.100000000000001, -3.6000000000000005, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.600000000000001, -3.800000000000001, -3.9000000000000012, -4.000000000000001, -4.200000000000001, -3.7000000000000006, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -3.700000000000001, -3.8000000000000007, -4.300000000000001, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -3.9000000000000004, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.9000000000000012, -4.100000000000001, -4.100000000000001, -4.000000000000002, -3.8000000000000007, -4.000000000000002, -3.7000000000000006, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -3.600000000000001, -3.8000000000000007, -4.1000000000000005, -3.900000000000001, -3.9000000000000004], "episode_lengths": [21, 21, 21, 21, 21, 21, 6, 11, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.651329830731916, "mean_inference_ms": 18.18044070007314, "mean_action_processing_ms": 0.9406691008955048, "mean_env_wait_ms": 1.5910115687185724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07520797925117688, "StateBufferConnector_ms": 0.010043168679261819, "ViewRequirementAgentConnector_ms": 0.1378310032379933}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 396000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 396000, "timers": {"training_iteration_time_ms": 172655.895, "load_time_ms": 1.287, "load_throughput": 3108676.462, "learn_time_ms": 171709.065, "learn_throughput": 23.295, "synch_weights_time_ms": 175.331}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "done": false, "episodes_total": 20210, "training_iteration": 99, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_01-38-07", "timestamp": 1680824287, "time_this_iter_s": 173.25459456443787, "time_total_s": 16949.755216121674, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0147286a60>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014736b160>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 16949.755216121674, "timesteps_since_restore": 0, "iterations_since_restore": 99, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.547154471544715, "ram_util_percent": 24.20162601626015}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.271746581600558, "cur_kl_coeff": 29.59121284458087, "cur_lr": 0.01, "total_loss": 0.5316845855365196, "policy_loss": 0.0004036525679972544, "vf_loss": 0.22677093854834957, "vf_explained_var": 0.738037880069466, "kl": 0.010290554588440285, "entropy": 2.885312499794909, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 92535.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "sampler_results": {"episode_reward_max": -3.4000000000000012, "episode_reward_min": -10.9, "episode_reward_mean": -4.033678756476685, "episode_len_mean": 20.740932642487046, "episode_media": {}, "episodes_this_iter": 193, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.6000000000000005, -4.100000000000001, -3.8000000000000007, -10.9, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -4.1000000000000005, -3.900000000000001, -4.100000000000001, -10.1, -3.7000000000000006, -4.000000000000001, -4.100000000000001, -3.7000000000000006, -3.600000000000001, -10.2, -3.7000000000000006, -3.900000000000001, -4.100000000000001, -4.100000000000001, -3.9000000000000012, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -3.9000000000000012, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -3.7000000000000006, -4.000000000000001, -4.0, -3.6000000000000005, -4.200000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -4.1000000000000005, -4.200000000000001, -4.100000000000001, -4.100000000000001, -3.7000000000000006, -4.100000000000001, -3.6000000000000005, -3.9000000000000012, -3.8000000000000007, -3.7000000000000015, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -3.9000000000000012, -4.100000000000001, -4.200000000000001, -4.200000000000001, -4.000000000000001, -3.800000000000001, -4.200000000000001, -3.8000000000000007, -3.500000000000001, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -4.1000000000000005, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -4.1000000000000005, -3.700000000000001, -4.100000000000001, -4.1000000000000005, -4.000000000000001, -3.800000000000001, -3.9000000000000012, -3.900000000000001, -4.300000000000001, -3.7000000000000006, -4.100000000000001, -3.800000000000001, -3.9000000000000012, -4.100000000000001, -3.900000000000001, -4.1000000000000005, -3.500000000000001, -3.8000000000000007, -3.700000000000001, -3.700000000000001, -3.600000000000001, -3.900000000000001, -3.8000000000000007, -3.6, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -3.9000000000000012, -3.900000000000001, -3.800000000000001, -3.8000000000000007, -4.300000000000001, -4.000000000000001, -4.100000000000001, -3.4000000000000012, -3.9000000000000012, -3.8000000000000007, -4.100000000000001, -4.200000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -4.1000000000000005, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -3.6000000000000005, -4.000000000000001, -4.000000000000001, -4.0, -3.600000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -4.000000000000001, -3.800000000000001, -3.700000000000001, -3.700000000000001, -4.200000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000002, -3.8000000000000007, -4.000000000000001, -4.000000000000002, -3.8000000000000007, -3.8000000000000007, -4.100000000000001, -3.8000000000000007, -4.200000000000001, -3.6000000000000005, -4.100000000000001, -4.1000000000000005, -3.900000000000001, -4.100000000000001, -4.200000000000001, -3.8000000000000007, -3.7000000000000006, -4.000000000000001, -3.900000000000001, -3.800000000000001, -4.200000000000001, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -4.100000000000001, -3.7000000000000015, -4.100000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.9000000000000012, -4.200000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.1000000000000005, -3.900000000000001, -4.000000000000001, -3.9000000000000012, -3.8000000000000007, -4.100000000000001, -3.900000000000001], "episode_lengths": [21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.65092010162304, "mean_inference_ms": 18.167560356072908, "mean_action_processing_ms": 0.9403701827347881, "mean_env_wait_ms": 1.5862321847340666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07430037068579481, "StateBufferConnector_ms": 0.00992970145428119, "ViewRequirementAgentConnector_ms": 0.1380539928693228}}, "episode_reward_max": -3.4000000000000012, "episode_reward_min": -10.9, "episode_reward_mean": -4.033678756476685, "episode_len_mean": 20.740932642487046, "episodes_this_iter": 193, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.6000000000000005, -4.100000000000001, -3.8000000000000007, -10.9, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -4.1000000000000005, -3.900000000000001, -4.100000000000001, -10.1, -3.7000000000000006, -4.000000000000001, -4.100000000000001, -3.7000000000000006, -3.600000000000001, -10.2, -3.7000000000000006, -3.900000000000001, -4.100000000000001, -4.100000000000001, -3.9000000000000012, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -3.9000000000000012, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -3.7000000000000006, -4.000000000000001, -4.0, -3.6000000000000005, -4.200000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -4.1000000000000005, -4.200000000000001, -4.100000000000001, -4.100000000000001, -3.7000000000000006, -4.100000000000001, -3.6000000000000005, -3.9000000000000012, -3.8000000000000007, -3.7000000000000015, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -3.9000000000000012, -4.100000000000001, -4.200000000000001, -4.200000000000001, -4.000000000000001, -3.800000000000001, -4.200000000000001, -3.8000000000000007, -3.500000000000001, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -4.1000000000000005, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -4.1000000000000005, -3.700000000000001, -4.100000000000001, -4.1000000000000005, -4.000000000000001, -3.800000000000001, -3.9000000000000012, -3.900000000000001, -4.300000000000001, -3.7000000000000006, -4.100000000000001, -3.800000000000001, -3.9000000000000012, -4.100000000000001, -3.900000000000001, -4.1000000000000005, -3.500000000000001, -3.8000000000000007, -3.700000000000001, -3.700000000000001, -3.600000000000001, -3.900000000000001, -3.8000000000000007, -3.6, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -3.9000000000000012, -3.900000000000001, -3.800000000000001, -3.8000000000000007, -4.300000000000001, -4.000000000000001, -4.100000000000001, -3.4000000000000012, -3.9000000000000012, -3.8000000000000007, -4.100000000000001, -4.200000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -4.1000000000000005, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -3.6000000000000005, -4.000000000000001, -4.000000000000001, -4.0, -3.600000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -4.000000000000001, -3.800000000000001, -3.700000000000001, -3.700000000000001, -4.200000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000002, -3.8000000000000007, -4.000000000000001, -4.000000000000002, -3.8000000000000007, -3.8000000000000007, -4.100000000000001, -3.8000000000000007, -4.200000000000001, -3.6000000000000005, -4.100000000000001, -4.1000000000000005, -3.900000000000001, -4.100000000000001, -4.200000000000001, -3.8000000000000007, -3.7000000000000006, -4.000000000000001, -3.900000000000001, -3.800000000000001, -4.200000000000001, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -4.100000000000001, -3.7000000000000015, -4.100000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.9000000000000012, -4.200000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.1000000000000005, -3.900000000000001, -4.000000000000001, -3.9000000000000012, -3.8000000000000007, -4.100000000000001, -3.900000000000001], "episode_lengths": [21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.65092010162304, "mean_inference_ms": 18.167560356072908, "mean_action_processing_ms": 0.9403701827347881, "mean_env_wait_ms": 1.5862321847340666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07430037068579481, "StateBufferConnector_ms": 0.00992970145428119, "ViewRequirementAgentConnector_ms": 0.1380539928693228}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 172742.949, "load_time_ms": 1.295, "load_throughput": 3088247.984, "learn_time_ms": 171792.897, "learn_throughput": 23.284, "synch_weights_time_ms": 178.973}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": false, "episodes_total": 20403, "training_iteration": 100, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_01-41-00", "timestamp": 1680824460, "time_this_iter_s": 173.05224776268005, "time_total_s": 17122.807463884354, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476f2e50>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01472bc430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 17122.807463884354, "timesteps_since_restore": 0, "iterations_since_restore": 100, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.374493927125506, "ram_util_percent": 24.255465587044544}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.082385957881968, "cur_kl_coeff": 29.59121284458087, "cur_lr": 0.01, "total_loss": 0.5595345925159192, "policy_loss": 0.0027684634621505454, "vf_loss": 0.29796362225246686, "vf_explained_var": 0.7075690827062053, "kl": 0.008745924132561277, "entropy": 2.8983574700611894, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 93465.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_agent_steps_sampled": 404000, "num_agent_steps_trained": 404000}, "sampler_results": {"episode_reward_max": -3.5000000000000004, "episode_reward_min": -11.4, "episode_reward_mean": -4.096354166666668, "episode_len_mean": 20.65625, "episode_media": {}, "episodes_this_iter": 192, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.000000000000001, -10.5, -10.4, -3.8000000000000007, -4.300000000000001, -10.7, -3.900000000000001, -4.100000000000001, -3.7000000000000006, -3.900000000000001, -3.800000000000001, -3.9000000000000004, -3.700000000000001, -3.8000000000000007, -3.9000000000000004, -3.900000000000001, -11.4, -3.9000000000000012, -3.600000000000001, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -3.7000000000000006, -4.200000000000001, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -3.7000000000000006, -4.200000000000001, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.700000000000001, -3.7000000000000006, -4.100000000000001, -3.800000000000001, -3.7000000000000006, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.9000000000000004, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.9000000000000004, -4.400000000000001, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -3.800000000000001, -3.7000000000000006, -4.100000000000001, -3.9000000000000004, -4.100000000000001, -4.100000000000001, -3.800000000000001, -4.0, -4.1000000000000005, -4.000000000000001, -3.6000000000000005, -4.000000000000002, -4.000000000000001, -4.200000000000001, -4.100000000000001, -4.200000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.9000000000000004, -4.000000000000002, -3.7000000000000006, -4.000000000000002, -3.800000000000001, -3.8000000000000007, -4.000000000000001, -4.300000000000001, -3.9000000000000012, -3.8000000000000007, -3.9000000000000012, -4.000000000000001, -3.600000000000001, -3.700000000000001, -3.700000000000001, -11.3, -4.000000000000001, -3.700000000000001, -3.900000000000001, -4.4, -4.100000000000001, -3.9000000000000004, -3.6, -3.900000000000001, -4.000000000000001, -3.9000000000000012, -4.100000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000002, -3.800000000000001, -3.700000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000002, -4.100000000000001, -3.7000000000000006, -4.100000000000001, -3.900000000000001, -4.0, -4.000000000000002, -4.000000000000001, -3.6000000000000005, -3.900000000000001, -3.7000000000000015, -4.100000000000001, -4.300000000000001, -3.8000000000000007, -4.000000000000001, -3.8000000000000003, -3.8000000000000007, -3.700000000000001, -3.9000000000000004, -4.1000000000000005, -3.900000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -3.7000000000000006, -4.000000000000001, -4.100000000000001, -4.000000000000002, -3.8000000000000007, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -3.6000000000000005, -3.9000000000000012, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -3.700000000000001, -3.7000000000000006, -3.900000000000001, -3.5000000000000004, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.5000000000000004, -3.5000000000000004, -3.9000000000000012, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -4.0, -3.800000000000001, -4.000000000000001, -3.6000000000000005, -3.8000000000000007, -4.000000000000001, -3.6000000000000005, -3.900000000000001, -3.8000000000000007, -4.000000000000002, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -3.8000000000000007, -3.8000000000000007, -3.500000000000001, -4.200000000000001, -3.900000000000001, -4.1000000000000005, -3.700000000000001, -3.800000000000001, -4.100000000000001], "episode_lengths": [21, 6, 4, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.65048781570656, "mean_inference_ms": 18.152718206905362, "mean_action_processing_ms": 0.9403920399263788, "mean_env_wait_ms": 1.5856661412477218, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07410397132237752, "StateBufferConnector_ms": 0.009494771560033163, "ViewRequirementAgentConnector_ms": 0.1373554269472758}}, "episode_reward_max": -3.5000000000000004, "episode_reward_min": -11.4, "episode_reward_mean": -4.096354166666668, "episode_len_mean": 20.65625, "episodes_this_iter": 192, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.000000000000001, -10.5, -10.4, -3.8000000000000007, -4.300000000000001, -10.7, -3.900000000000001, -4.100000000000001, -3.7000000000000006, -3.900000000000001, -3.800000000000001, -3.9000000000000004, -3.700000000000001, -3.8000000000000007, -3.9000000000000004, -3.900000000000001, -11.4, -3.9000000000000012, -3.600000000000001, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -3.7000000000000006, -4.200000000000001, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -3.7000000000000006, -4.200000000000001, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.700000000000001, -3.7000000000000006, -4.100000000000001, -3.800000000000001, -3.7000000000000006, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.9000000000000004, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.9000000000000004, -4.400000000000001, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -3.800000000000001, -3.7000000000000006, -4.100000000000001, -3.9000000000000004, -4.100000000000001, -4.100000000000001, -3.800000000000001, -4.0, -4.1000000000000005, -4.000000000000001, -3.6000000000000005, -4.000000000000002, -4.000000000000001, -4.200000000000001, -4.100000000000001, -4.200000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.9000000000000004, -4.000000000000002, -3.7000000000000006, -4.000000000000002, -3.800000000000001, -3.8000000000000007, -4.000000000000001, -4.300000000000001, -3.9000000000000012, -3.8000000000000007, -3.9000000000000012, -4.000000000000001, -3.600000000000001, -3.700000000000001, -3.700000000000001, -11.3, -4.000000000000001, -3.700000000000001, -3.900000000000001, -4.4, -4.100000000000001, -3.9000000000000004, -3.6, -3.900000000000001, -4.000000000000001, -3.9000000000000012, -4.100000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000002, -3.800000000000001, -3.700000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000002, -4.100000000000001, -3.7000000000000006, -4.100000000000001, -3.900000000000001, -4.0, -4.000000000000002, -4.000000000000001, -3.6000000000000005, -3.900000000000001, -3.7000000000000015, -4.100000000000001, -4.300000000000001, -3.8000000000000007, -4.000000000000001, -3.8000000000000003, -3.8000000000000007, -3.700000000000001, -3.9000000000000004, -4.1000000000000005, -3.900000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -3.7000000000000006, -4.000000000000001, -4.100000000000001, -4.000000000000002, -3.8000000000000007, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -3.6000000000000005, -3.9000000000000012, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -3.700000000000001, -3.7000000000000006, -3.900000000000001, -3.5000000000000004, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.5000000000000004, -3.5000000000000004, -3.9000000000000012, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -4.0, -3.800000000000001, -4.000000000000001, -3.6000000000000005, -3.8000000000000007, -4.000000000000001, -3.6000000000000005, -3.900000000000001, -3.8000000000000007, -4.000000000000002, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -3.8000000000000007, -3.8000000000000007, -3.500000000000001, -4.200000000000001, -3.900000000000001, -4.1000000000000005, -3.700000000000001, -3.800000000000001, -4.100000000000001], "episode_lengths": [21, 6, 4, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.65048781570656, "mean_inference_ms": 18.152718206905362, "mean_action_processing_ms": 0.9403920399263788, "mean_env_wait_ms": 1.5856661412477218, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07410397132237752, "StateBufferConnector_ms": 0.009494771560033163, "ViewRequirementAgentConnector_ms": 0.1373554269472758}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 404000, "num_agent_steps_trained": 404000, "num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 404000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 404000, "timers": {"training_iteration_time_ms": 172848.739, "load_time_ms": 1.315, "load_throughput": 3040782.977, "learn_time_ms": 171872.727, "learn_throughput": 23.273, "synch_weights_time_ms": 200.4}, "counters": {"num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_agent_steps_sampled": 404000, "num_agent_steps_trained": 404000}, "done": false, "episodes_total": 20595, "training_iteration": 101, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_01-43-54", "timestamp": 1680824634, "time_this_iter_s": 173.28358602523804, "time_total_s": 17296.09104990959, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0147286af0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014736b160>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 17296.09104990959, "timesteps_since_restore": 0, "iterations_since_restore": 101, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.326422764227642, "ram_util_percent": 24.269512195121955}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.233856821060181, "cur_kl_coeff": 29.59121284458087, "cur_lr": 0.01, "total_loss": 1.3178843304795282, "policy_loss": 0.005574060604977672, "vf_loss": 0.25063889468869854, "vf_explained_var": 0.6807159414855383, "kl": 0.03587792678132168, "entropy": 2.869755572272885, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 94395.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000}, "sampler_results": {"episode_reward_max": -3.5000000000000004, "episode_reward_min": -11.5, "episode_reward_mean": -4.080829015544042, "episode_len_mean": 20.637305699481864, "episode_media": {}, "episodes_this_iter": 193, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.8000000000000007, -3.900000000000001, -3.8000000000000003, -3.900000000000001, -3.600000000000001, -10.4, -3.9000000000000004, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000002, -3.900000000000001, -3.800000000000001, -3.900000000000001, -3.5000000000000004, -3.800000000000001, -4.000000000000001, -3.7000000000000006, -11.5, -10.6, -3.700000000000001, -4.000000000000002, -10.8, -3.9000000000000012, -4.000000000000002, -4.200000000000001, -3.7000000000000006, -3.900000000000001, -3.7000000000000006, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -3.7, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -3.800000000000001, -3.700000000000001, -3.700000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.700000000000001, -3.9000000000000012, -4.100000000000001, -3.9000000000000012, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -4.300000000000001, -3.800000000000001, -3.900000000000001, -4.000000000000001, -3.800000000000001, -3.900000000000001, -3.800000000000001, -4.100000000000001, -4.000000000000002, -3.900000000000001, -4.300000000000001, -3.8000000000000007, -3.9000000000000012, -4.000000000000001, -4.100000000000001, -3.800000000000001, -4.000000000000001, -3.900000000000001, -3.600000000000001, -4.000000000000001, -3.800000000000001, -3.700000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -3.800000000000001, -4.000000000000001, -3.7000000000000006, -3.900000000000001, -4.200000000000001, -4.300000000000001, -3.900000000000001, -3.700000000000001, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -4.1000000000000005, -4.000000000000002, -3.8000000000000007, -3.900000000000001, -3.7000000000000006, -3.700000000000001, -4.100000000000001, -3.900000000000001, -10.3, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -3.7000000000000006, -3.700000000000001, -3.900000000000001, -3.900000000000001, -3.700000000000001, -4.1000000000000005, -4.200000000000001, -3.500000000000001, -4.000000000000002, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -3.8000000000000003, -3.900000000000001, -3.700000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000002, -3.8000000000000003, -3.800000000000001, -3.7000000000000006, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000002, -3.7000000000000006, -3.700000000000001, -4.100000000000001, -3.8000000000000007, -4.200000000000001, -4.0, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.9000000000000012, -3.8000000000000007, -3.800000000000001, -3.700000000000001, -4.1000000000000005, -4.100000000000001, -3.9000000000000012, -4.200000000000001, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -3.6000000000000005, -3.900000000000001, -3.9000000000000012, -4.100000000000001, -3.800000000000001, -3.900000000000001, -3.6000000000000005, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -3.6, -4.000000000000001, -3.7000000000000006, -4.200000000000001, -3.700000000000001, -4.000000000000002, -3.900000000000001, -3.900000000000001, -3.9000000000000012, -4.000000000000001, -3.900000000000001, -3.9000000000000012, -4.100000000000001, -3.7000000000000006, -3.800000000000001, -4.0, -4.300000000000001, -4.000000000000002, -4.200000000000001, -3.800000000000001, -3.9000000000000012, -3.7000000000000006, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -3.9000000000000012], "episode_lengths": [21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 6, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.657557888915987, "mean_inference_ms": 18.16876668662506, "mean_action_processing_ms": 0.9411410623152451, "mean_env_wait_ms": 1.5907744215600936, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07590629893881051, "StateBufferConnector_ms": 0.009722413176699623, "ViewRequirementAgentConnector_ms": 0.1389465183791719}}, "episode_reward_max": -3.5000000000000004, "episode_reward_min": -11.5, "episode_reward_mean": -4.080829015544042, "episode_len_mean": 20.637305699481864, "episodes_this_iter": 193, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.8000000000000007, -3.900000000000001, -3.8000000000000003, -3.900000000000001, -3.600000000000001, -10.4, -3.9000000000000004, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000002, -3.900000000000001, -3.800000000000001, -3.900000000000001, -3.5000000000000004, -3.800000000000001, -4.000000000000001, -3.7000000000000006, -11.5, -10.6, -3.700000000000001, -4.000000000000002, -10.8, -3.9000000000000012, -4.000000000000002, -4.200000000000001, -3.7000000000000006, -3.900000000000001, -3.7000000000000006, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -3.7, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -3.800000000000001, -3.700000000000001, -3.700000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.700000000000001, -3.9000000000000012, -4.100000000000001, -3.9000000000000012, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -4.300000000000001, -3.800000000000001, -3.900000000000001, -4.000000000000001, -3.800000000000001, -3.900000000000001, -3.800000000000001, -4.100000000000001, -4.000000000000002, -3.900000000000001, -4.300000000000001, -3.8000000000000007, -3.9000000000000012, -4.000000000000001, -4.100000000000001, -3.800000000000001, -4.000000000000001, -3.900000000000001, -3.600000000000001, -4.000000000000001, -3.800000000000001, -3.700000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -3.800000000000001, -4.000000000000001, -3.7000000000000006, -3.900000000000001, -4.200000000000001, -4.300000000000001, -3.900000000000001, -3.700000000000001, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -4.1000000000000005, -4.000000000000002, -3.8000000000000007, -3.900000000000001, -3.7000000000000006, -3.700000000000001, -4.100000000000001, -3.900000000000001, -10.3, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -3.7000000000000006, -3.700000000000001, -3.900000000000001, -3.900000000000001, -3.700000000000001, -4.1000000000000005, -4.200000000000001, -3.500000000000001, -4.000000000000002, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -3.8000000000000003, -3.900000000000001, -3.700000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000002, -3.8000000000000003, -3.800000000000001, -3.7000000000000006, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000002, -3.7000000000000006, -3.700000000000001, -4.100000000000001, -3.8000000000000007, -4.200000000000001, -4.0, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.9000000000000012, -3.8000000000000007, -3.800000000000001, -3.700000000000001, -4.1000000000000005, -4.100000000000001, -3.9000000000000012, -4.200000000000001, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -3.6000000000000005, -3.900000000000001, -3.9000000000000012, -4.100000000000001, -3.800000000000001, -3.900000000000001, -3.6000000000000005, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -3.6, -4.000000000000001, -3.7000000000000006, -4.200000000000001, -3.700000000000001, -4.000000000000002, -3.900000000000001, -3.900000000000001, -3.9000000000000012, -4.000000000000001, -3.900000000000001, -3.9000000000000012, -4.100000000000001, -3.7000000000000006, -3.800000000000001, -4.0, -4.300000000000001, -4.000000000000002, -4.200000000000001, -3.800000000000001, -3.9000000000000012, -3.7000000000000006, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -3.9000000000000012], "episode_lengths": [21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 6, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.657557888915987, "mean_inference_ms": 18.16876668662506, "mean_action_processing_ms": 0.9411410623152451, "mean_env_wait_ms": 1.5907744215600936, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07590629893881051, "StateBufferConnector_ms": 0.009722413176699623, "ViewRequirementAgentConnector_ms": 0.1389465183791719}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 408000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 408000, "timers": {"training_iteration_time_ms": 172890.052, "load_time_ms": 1.287, "load_throughput": 3107639.987, "learn_time_ms": 171918.711, "learn_throughput": 23.267, "synch_weights_time_ms": 195.891}, "counters": {"num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000}, "done": false, "episodes_total": 20788, "training_iteration": 102, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_01-46-47", "timestamp": 1680824807, "time_this_iter_s": 172.96359086036682, "time_total_s": 17469.05464076996, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476cb0d0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01472bc4c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 17469.05464076996, "timesteps_since_restore": 0, "iterations_since_restore": 102, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.5613821138211375, "ram_util_percent": 24.295934959349605}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22.946127113731958, "cur_kl_coeff": 44.386819266871306, "cur_lr": 0.01, "total_loss": 2.973025375869005, "policy_loss": 0.007620380352431488, "vf_loss": 0.24329011476328297, "vf_explained_var": 0.7320108795037834, "kl": 0.06132710170238942, "entropy": 2.8619063256889263, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 95325.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_agent_steps_sampled": 412000, "num_agent_steps_trained": 412000}, "sampler_results": {"episode_reward_max": -3.4000000000000004, "episode_reward_min": -11.6, "episode_reward_mean": -4.086458333333334, "episode_len_mean": 20.645833333333332, "episode_media": {}, "episodes_this_iter": 192, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.000000000000001, -4.0, -4.000000000000002, -11.6, -10.7, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -10.4, -3.900000000000001, -4.000000000000001, -10.3, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.800000000000001, -3.700000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.9000000000000012, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -4.200000000000001, -3.8000000000000007, -3.800000000000001, -3.8000000000000007, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -4.200000000000001, -4.0, -3.8000000000000007, -3.700000000000001, -3.600000000000001, -3.8000000000000007, -3.9000000000000004, -3.600000000000001, -4.000000000000001, -4.100000000000001, -3.9000000000000012, -4.000000000000002, -3.8000000000000003, -3.7000000000000006, -3.500000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -4.300000000000001, -3.900000000000001, -3.9000000000000012, -3.800000000000001, -3.500000000000001, -3.800000000000001, -4.000000000000001, -3.800000000000001, -3.900000000000001, -3.9000000000000012, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.700000000000001, -3.9000000000000004, -4.000000000000001, -4.000000000000002, -4.000000000000001, -3.600000000000001, -3.8000000000000007, -3.7000000000000006, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -3.9000000000000004, -3.9000000000000012, -4.200000000000001, -3.900000000000001, -3.9000000000000012, -4.200000000000001, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.700000000000001, -3.900000000000001, -4.100000000000001, -11.2, -4.000000000000002, -3.900000000000001, -4.000000000000002, -3.900000000000001, -3.900000000000001, -3.9000000000000004, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -3.9000000000000012, -3.900000000000001, -4.100000000000001, -3.800000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.9000000000000012, -4.200000000000001, -4.200000000000001, -3.900000000000001, -3.9000000000000012, -3.800000000000001, -4.000000000000002, -3.800000000000001, -3.9000000000000012, -3.700000000000001, -4.300000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -4.1000000000000005, -4.200000000000001, -3.7, -4.0, -3.8000000000000007, -4.100000000000001, -3.7000000000000006, -4.000000000000002, -4.200000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.6000000000000005, -4.100000000000001, -3.900000000000001, -3.6000000000000005, -3.900000000000001, -3.600000000000001, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -3.4000000000000004, -3.9000000000000004, -4.100000000000001, -4.200000000000001, -3.9000000000000004, -3.8000000000000007, -4.200000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.7000000000000006, -3.9000000000000012, -4.200000000000001, -3.800000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -3.700000000000001, -3.9000000000000012, -3.7000000000000006, -3.8000000000000007, -3.900000000000001, -4.0, -3.900000000000001, -3.700000000000001, -3.900000000000001, -3.8000000000000007, -3.7000000000000006, -3.5000000000000004, -3.8000000000000003, -4.000000000000002, -3.9000000000000012], "episode_lengths": [21, 21, 21, 12, 7, 21, 21, 21, 21, 21, 5, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.649783220112605, "mean_inference_ms": 18.176310001169806, "mean_action_processing_ms": 0.9408034450526225, "mean_env_wait_ms": 1.5897377355428801, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07737179597218831, "StateBufferConnector_ms": 0.010101248820622763, "ViewRequirementAgentConnector_ms": 0.14100844661394754}}, "episode_reward_max": -3.4000000000000004, "episode_reward_min": -11.6, "episode_reward_mean": -4.086458333333334, "episode_len_mean": 20.645833333333332, "episodes_this_iter": 192, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.000000000000001, -4.0, -4.000000000000002, -11.6, -10.7, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -10.4, -3.900000000000001, -4.000000000000001, -10.3, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.800000000000001, -3.700000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.9000000000000012, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -4.200000000000001, -3.8000000000000007, -3.800000000000001, -3.8000000000000007, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -4.200000000000001, -4.0, -3.8000000000000007, -3.700000000000001, -3.600000000000001, -3.8000000000000007, -3.9000000000000004, -3.600000000000001, -4.000000000000001, -4.100000000000001, -3.9000000000000012, -4.000000000000002, -3.8000000000000003, -3.7000000000000006, -3.500000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -4.300000000000001, -3.900000000000001, -3.9000000000000012, -3.800000000000001, -3.500000000000001, -3.800000000000001, -4.000000000000001, -3.800000000000001, -3.900000000000001, -3.9000000000000012, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.700000000000001, -3.9000000000000004, -4.000000000000001, -4.000000000000002, -4.000000000000001, -3.600000000000001, -3.8000000000000007, -3.7000000000000006, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -3.9000000000000004, -3.9000000000000012, -4.200000000000001, -3.900000000000001, -3.9000000000000012, -4.200000000000001, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.700000000000001, -3.900000000000001, -4.100000000000001, -11.2, -4.000000000000002, -3.900000000000001, -4.000000000000002, -3.900000000000001, -3.900000000000001, -3.9000000000000004, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -3.9000000000000012, -3.900000000000001, -4.100000000000001, -3.800000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.9000000000000012, -4.200000000000001, -4.200000000000001, -3.900000000000001, -3.9000000000000012, -3.800000000000001, -4.000000000000002, -3.800000000000001, -3.9000000000000012, -3.700000000000001, -4.300000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -4.1000000000000005, -4.200000000000001, -3.7, -4.0, -3.8000000000000007, -4.100000000000001, -3.7000000000000006, -4.000000000000002, -4.200000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.6000000000000005, -4.100000000000001, -3.900000000000001, -3.6000000000000005, -3.900000000000001, -3.600000000000001, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -3.4000000000000004, -3.9000000000000004, -4.100000000000001, -4.200000000000001, -3.9000000000000004, -3.8000000000000007, -4.200000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.7000000000000006, -3.9000000000000012, -4.200000000000001, -3.800000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -3.700000000000001, -3.9000000000000012, -3.7000000000000006, -3.8000000000000007, -3.900000000000001, -4.0, -3.900000000000001, -3.700000000000001, -3.900000000000001, -3.8000000000000007, -3.7000000000000006, -3.5000000000000004, -3.8000000000000003, -4.000000000000002, -3.9000000000000012], "episode_lengths": [21, 21, 21, 12, 7, 21, 21, 21, 21, 21, 5, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.649783220112605, "mean_inference_ms": 18.176310001169806, "mean_action_processing_ms": 0.9408034450526225, "mean_env_wait_ms": 1.5897377355428801, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07737179597218831, "StateBufferConnector_ms": 0.010101248820622763, "ViewRequirementAgentConnector_ms": 0.14100844661394754}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 412000, "num_agent_steps_trained": 412000, "num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 412000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 412000, "timers": {"training_iteration_time_ms": 172960.766, "load_time_ms": 1.291, "load_throughput": 3098228.288, "learn_time_ms": 171993.081, "learn_throughput": 23.257, "synch_weights_time_ms": 190.747}, "counters": {"num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_agent_steps_sampled": 412000, "num_agent_steps_trained": 412000}, "done": false, "episodes_total": 20980, "training_iteration": 103, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_01-49-40", "timestamp": 1680824980, "time_this_iter_s": 172.99859619140625, "time_total_s": 17642.053236961365, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476d1dc0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014728c820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 17642.053236961365, "timesteps_since_restore": 0, "iterations_since_restore": 103, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.282926829268292, "ram_util_percent": 24.28861788617887}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.393327119273525, "cur_kl_coeff": 66.58022890030699, "cur_lr": 0.01, "total_loss": 1.911657364652442, "policy_loss": 0.001586249377578497, "vf_loss": 0.2077067378187372, "vf_explained_var": 0.7520642274169511, "kl": 0.025568616278554057, "entropy": 2.8780798478793073, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 96255.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "sampler_results": {"episode_reward_max": -3.5000000000000004, "episode_reward_min": -10.5, "episode_reward_mean": -3.9757731958762896, "episode_len_mean": 20.824742268041238, "episode_media": {}, "episodes_this_iter": 194, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.900000000000001, -3.600000000000001, -10.5, -3.8000000000000003, -3.6, -3.900000000000001, -3.8000000000000007, -3.700000000000001, -4.200000000000001, -3.6000000000000014, -3.900000000000001, -3.600000000000001, -10.2, -3.9000000000000012, -3.600000000000001, -4.000000000000001, -3.8000000000000007, -3.700000000000001, -3.800000000000001, -3.6000000000000005, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -3.9000000000000012, -4.000000000000002, -3.700000000000001, -4.000000000000001, -3.700000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000001, -3.9000000000000004, -3.900000000000001, -3.800000000000001, -4.000000000000002, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -3.900000000000001, -4.200000000000001, -4.000000000000001, -3.7000000000000006, -3.800000000000001, -4.200000000000001, -3.7000000000000006, -4.000000000000002, -3.6000000000000005, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.800000000000001, -4.000000000000002, -4.000000000000001, -4.100000000000001, -3.600000000000001, -3.900000000000001, -4.100000000000001, -3.6000000000000005, -4.0, -4.100000000000001, -4.000000000000001, -4.200000000000001, -4.300000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -3.7000000000000006, -3.900000000000001, -4.000000000000001, -4.000000000000002, -4.200000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.5000000000000004, -3.900000000000001, -4.200000000000001, -3.700000000000001, -4.200000000000001, -3.900000000000001, -4.000000000000002, -4.000000000000002, -3.9000000000000012, -4.000000000000002, -3.900000000000001, -4.200000000000001, -3.9000000000000004, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -3.9000000000000012, -3.6000000000000005, -3.900000000000001, -3.800000000000001, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -3.9000000000000012, -4.000000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000001, -4.300000000000001, -3.800000000000001, -4.100000000000001, -3.6000000000000005, -3.600000000000001, -4.0, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -4.200000000000001, -3.8000000000000007, -4.200000000000001, -3.6000000000000005, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -3.9000000000000012, -3.7000000000000006, -3.8000000000000007, -3.600000000000001, -3.8000000000000007, -3.800000000000001, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -4.000000000000001, -3.700000000000001, -3.9000000000000012, -3.9000000000000012, -4.0, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -4.300000000000001, -3.800000000000001, -4.000000000000001, -4.1000000000000005, -3.900000000000001, -4.000000000000002, -3.7000000000000006, -4.000000000000002, -4.100000000000001, -4.000000000000001, -4.000000000000001, -3.6000000000000005, -3.700000000000001, -4.0, -4.200000000000001, -4.300000000000001, -3.6000000000000005, -3.800000000000001, -4.200000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000001, -3.500000000000001, -4.1000000000000005, -4.000000000000001, -3.900000000000001, -3.9000000000000012, -4.100000000000001, -3.800000000000001, -3.900000000000001, -3.8000000000000007, -4.200000000000001, -3.9000000000000012, -3.700000000000001, -3.800000000000001, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -3.700000000000001, -3.8000000000000007, -3.900000000000001, -3.700000000000001, -4.0], "episode_lengths": [21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.64412725024036, "mean_inference_ms": 18.138366851976155, "mean_action_processing_ms": 0.9397273580827558, "mean_env_wait_ms": 1.5817822082070438, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07233521373001571, "StateBufferConnector_ms": 0.009713467863417164, "ViewRequirementAgentConnector_ms": 0.13359699052633697}}, "episode_reward_max": -3.5000000000000004, "episode_reward_min": -10.5, "episode_reward_mean": -3.9757731958762896, "episode_len_mean": 20.824742268041238, "episodes_this_iter": 194, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.900000000000001, -3.600000000000001, -10.5, -3.8000000000000003, -3.6, -3.900000000000001, -3.8000000000000007, -3.700000000000001, -4.200000000000001, -3.6000000000000014, -3.900000000000001, -3.600000000000001, -10.2, -3.9000000000000012, -3.600000000000001, -4.000000000000001, -3.8000000000000007, -3.700000000000001, -3.800000000000001, -3.6000000000000005, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -3.9000000000000012, -4.000000000000002, -3.700000000000001, -4.000000000000001, -3.700000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000001, -3.9000000000000004, -3.900000000000001, -3.800000000000001, -4.000000000000002, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -3.900000000000001, -4.200000000000001, -4.000000000000001, -3.7000000000000006, -3.800000000000001, -4.200000000000001, -3.7000000000000006, -4.000000000000002, -3.6000000000000005, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.800000000000001, -4.000000000000002, -4.000000000000001, -4.100000000000001, -3.600000000000001, -3.900000000000001, -4.100000000000001, -3.6000000000000005, -4.0, -4.100000000000001, -4.000000000000001, -4.200000000000001, -4.300000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -3.7000000000000006, -3.900000000000001, -4.000000000000001, -4.000000000000002, -4.200000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.5000000000000004, -3.900000000000001, -4.200000000000001, -3.700000000000001, -4.200000000000001, -3.900000000000001, -4.000000000000002, -4.000000000000002, -3.9000000000000012, -4.000000000000002, -3.900000000000001, -4.200000000000001, -3.9000000000000004, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -3.9000000000000012, -3.6000000000000005, -3.900000000000001, -3.800000000000001, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -3.9000000000000012, -4.000000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000001, -4.300000000000001, -3.800000000000001, -4.100000000000001, -3.6000000000000005, -3.600000000000001, -4.0, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -4.200000000000001, -3.8000000000000007, -4.200000000000001, -3.6000000000000005, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -3.9000000000000012, -3.7000000000000006, -3.8000000000000007, -3.600000000000001, -3.8000000000000007, -3.800000000000001, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -4.000000000000001, -3.700000000000001, -3.9000000000000012, -3.9000000000000012, -4.0, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -4.300000000000001, -3.800000000000001, -4.000000000000001, -4.1000000000000005, -3.900000000000001, -4.000000000000002, -3.7000000000000006, -4.000000000000002, -4.100000000000001, -4.000000000000001, -4.000000000000001, -3.6000000000000005, -3.700000000000001, -4.0, -4.200000000000001, -4.300000000000001, -3.6000000000000005, -3.800000000000001, -4.200000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000001, -3.500000000000001, -4.1000000000000005, -4.000000000000001, -3.900000000000001, -3.9000000000000012, -4.100000000000001, -3.800000000000001, -3.900000000000001, -3.8000000000000007, -4.200000000000001, -3.9000000000000012, -3.700000000000001, -3.800000000000001, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -3.700000000000001, -3.8000000000000007, -3.900000000000001, -3.700000000000001, -4.0], "episode_lengths": [21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.64412725024036, "mean_inference_ms": 18.138366851976155, "mean_action_processing_ms": 0.9397273580827558, "mean_env_wait_ms": 1.5817822082070438, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07233521373001571, "StateBufferConnector_ms": 0.009713467863417164, "ViewRequirementAgentConnector_ms": 0.13359699052633697}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 416000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 416000, "timers": {"training_iteration_time_ms": 172966.455, "load_time_ms": 1.271, "load_throughput": 3147695.31, "learn_time_ms": 172005.447, "learn_throughput": 23.255, "synch_weights_time_ms": 190.082}, "counters": {"num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "done": false, "episodes_total": 21174, "training_iteration": 104, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_01-52-33", "timestamp": 1680825153, "time_this_iter_s": 172.61681151390076, "time_total_s": 17814.670048475266, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476595b0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f01472bc790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 17814.670048475266, "timesteps_since_restore": 0, "iterations_since_restore": 104, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.339183673469388, "ram_util_percent": 24.228571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 55.61257069597962, "cur_kl_coeff": 99.87034335046044, "cur_lr": 0.01, "total_loss": 18.905797336532945, "policy_loss": 0.02237735608472459, "vf_loss": 0.22554119843789328, "vf_explained_var": 0.7650877109137915, "kl": 0.18682101034796247, "entropy": 2.8262477620955435, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 97185.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000}, "sampler_results": {"episode_reward_max": -3.5000000000000004, "episode_reward_min": -10.7, "episode_reward_mean": -3.983769633507854, "episode_len_mean": 20.842931937172775, "episode_media": {}, "episodes_this_iter": 191, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.8000000000000007, -3.900000000000001, -10.7, -4.000000000000001, -3.7000000000000006, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.9000000000000012, -4.100000000000001, -3.8000000000000003, -4.000000000000001, -3.800000000000001, -3.9000000000000012, -10.4, -4.100000000000001, -3.900000000000001, -3.7000000000000006, -3.9000000000000004, -3.6, -3.8000000000000007, -3.6000000000000005, -4.000000000000001, -3.9000000000000012, -4.0, -3.900000000000001, -4.200000000000001, -3.9000000000000012, -3.8000000000000007, -3.900000000000001, -4.200000000000001, -3.900000000000001, -3.900000000000001, -3.800000000000001, -4.300000000000001, -3.900000000000001, -3.700000000000001, -4.000000000000002, -4.200000000000001, -3.7000000000000006, -4.200000000000001, -3.800000000000001, -4.100000000000001, -3.6000000000000005, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.0, -3.8000000000000007, -4.000000000000002, -3.700000000000001, -3.900000000000001, -4.000000000000002, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -3.7000000000000006, -4.000000000000001, -3.8000000000000007, -4.000000000000002, -3.7000000000000006, -3.900000000000001, -3.9000000000000012, -3.8000000000000007, -4.100000000000001, -3.600000000000001, -3.800000000000001, -3.900000000000001, -4.0, -4.1000000000000005, -4.200000000000001, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -4.200000000000001, -3.900000000000001, -4.100000000000001, -3.800000000000001, -4.000000000000001, -3.9000000000000012, -4.200000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000002, -4.000000000000001, -3.800000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.800000000000001, -3.800000000000001, -4.100000000000001, -3.8000000000000007, -3.500000000000001, -4.000000000000001, -4.000000000000001, -4.0, -4.200000000000001, -4.000000000000001, -4.100000000000001, -4.0, -4.100000000000001, -4.000000000000001, -4.0, -3.9000000000000012, -4.0, -4.000000000000001, -4.000000000000001, -3.800000000000001, -3.7000000000000006, -3.9000000000000012, -3.9000000000000012, -4.000000000000002, -4.000000000000001, -3.800000000000001, -3.6000000000000005, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -3.7000000000000006, -3.8000000000000007, -4.000000000000002, -3.900000000000001, -3.7000000000000006, -4.000000000000002, -3.8000000000000007, -3.9000000000000012, -4.100000000000001, -3.9000000000000004, -3.8000000000000007, -3.8000000000000007, -4.200000000000001, -4.100000000000001, -3.9000000000000012, -4.000000000000001, -3.7000000000000006, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000002, -3.900000000000001, -3.800000000000001, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.600000000000001, -3.5000000000000004, -3.900000000000001, -3.9000000000000012, -4.000000000000002, -4.000000000000001, -3.900000000000001, -4.100000000000001, -3.600000000000001, -3.6000000000000005, -3.900000000000001, -3.8000000000000003, -4.000000000000002, -3.7000000000000006, -3.900000000000001, -4.0, -3.8000000000000003, -4.0, -3.9000000000000012, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.9000000000000004, -4.000000000000002, -4.300000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.8000000000000007], "episode_lengths": [21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.650800032635042, "mean_inference_ms": 18.153955712974064, "mean_action_processing_ms": 0.9394329623850964, "mean_env_wait_ms": 1.5853323404681394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0724666405722733, "StateBufferConnector_ms": 0.009206327468312847, "ViewRequirementAgentConnector_ms": 0.1328885243201131}}, "episode_reward_max": -3.5000000000000004, "episode_reward_min": -10.7, "episode_reward_mean": -3.983769633507854, "episode_len_mean": 20.842931937172775, "episodes_this_iter": 191, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.8000000000000007, -3.900000000000001, -10.7, -4.000000000000001, -3.7000000000000006, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.9000000000000012, -4.100000000000001, -3.8000000000000003, -4.000000000000001, -3.800000000000001, -3.9000000000000012, -10.4, -4.100000000000001, -3.900000000000001, -3.7000000000000006, -3.9000000000000004, -3.6, -3.8000000000000007, -3.6000000000000005, -4.000000000000001, -3.9000000000000012, -4.0, -3.900000000000001, -4.200000000000001, -3.9000000000000012, -3.8000000000000007, -3.900000000000001, -4.200000000000001, -3.900000000000001, -3.900000000000001, -3.800000000000001, -4.300000000000001, -3.900000000000001, -3.700000000000001, -4.000000000000002, -4.200000000000001, -3.7000000000000006, -4.200000000000001, -3.800000000000001, -4.100000000000001, -3.6000000000000005, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.0, -3.8000000000000007, -4.000000000000002, -3.700000000000001, -3.900000000000001, -4.000000000000002, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -3.7000000000000006, -4.000000000000001, -3.8000000000000007, -4.000000000000002, -3.7000000000000006, -3.900000000000001, -3.9000000000000012, -3.8000000000000007, -4.100000000000001, -3.600000000000001, -3.800000000000001, -3.900000000000001, -4.0, -4.1000000000000005, -4.200000000000001, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -4.200000000000001, -3.900000000000001, -4.100000000000001, -3.800000000000001, -4.000000000000001, -3.9000000000000012, -4.200000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000002, -4.000000000000001, -3.800000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.800000000000001, -3.800000000000001, -4.100000000000001, -3.8000000000000007, -3.500000000000001, -4.000000000000001, -4.000000000000001, -4.0, -4.200000000000001, -4.000000000000001, -4.100000000000001, -4.0, -4.100000000000001, -4.000000000000001, -4.0, -3.9000000000000012, -4.0, -4.000000000000001, -4.000000000000001, -3.800000000000001, -3.7000000000000006, -3.9000000000000012, -3.9000000000000012, -4.000000000000002, -4.000000000000001, -3.800000000000001, -3.6000000000000005, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -3.7000000000000006, -3.8000000000000007, -4.000000000000002, -3.900000000000001, -3.7000000000000006, -4.000000000000002, -3.8000000000000007, -3.9000000000000012, -4.100000000000001, -3.9000000000000004, -3.8000000000000007, -3.8000000000000007, -4.200000000000001, -4.100000000000001, -3.9000000000000012, -4.000000000000001, -3.7000000000000006, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000002, -3.900000000000001, -3.800000000000001, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.600000000000001, -3.5000000000000004, -3.900000000000001, -3.9000000000000012, -4.000000000000002, -4.000000000000001, -3.900000000000001, -4.100000000000001, -3.600000000000001, -3.6000000000000005, -3.900000000000001, -3.8000000000000003, -4.000000000000002, -3.7000000000000006, -3.900000000000001, -4.0, -3.8000000000000003, -4.0, -3.9000000000000012, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.9000000000000004, -4.000000000000002, -4.300000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.8000000000000007], "episode_lengths": [21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.650800032635042, "mean_inference_ms": 18.153955712974064, "mean_action_processing_ms": 0.9394329623850964, "mean_env_wait_ms": 1.5853323404681394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0724666405722733, "StateBufferConnector_ms": 0.009206327468312847, "ViewRequirementAgentConnector_ms": 0.1328885243201131}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 420000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 420000, "timers": {"training_iteration_time_ms": 172997.214, "load_time_ms": 1.275, "load_throughput": 3138157.196, "learn_time_ms": 172035.348, "learn_throughput": 23.251, "synch_weights_time_ms": 189.406}, "counters": {"num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000}, "done": false, "episodes_total": 21365, "training_iteration": 105, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_01-55-26", "timestamp": 1680825326, "time_this_iter_s": 173.24422001838684, "time_total_s": 17987.914268493652, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f014746eb50>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7effc010f820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 17987.914268493652, "timesteps_since_restore": 0, "iterations_since_restore": 105, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.4890243902439035, "ram_util_percent": 24.29146341463416}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 30.942262341130164, "cur_kl_coeff": 149.8055150256907, "cur_lr": 0.01, "total_loss": 0.6466424376213102, "policy_loss": 0.0010286530464767448, "vf_loss": 0.26684918538216623, "vf_explained_var": 0.728441410551789, "kl": 0.0025283756036835396, "entropy": 2.890592291790952, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 98115.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 424000, "num_agent_steps_trained": 424000}, "sampler_results": {"episode_reward_max": -3.3000000000000007, "episode_reward_min": -11.6, "episode_reward_mean": -4.056476683937825, "episode_len_mean": 20.72538860103627, "episode_media": {}, "episodes_this_iter": 193, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.400000000000001, -3.700000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.600000000000001, -3.900000000000001, -3.900000000000001, -3.9000000000000012, -3.7000000000000006, -4.100000000000001, -3.500000000000001, -4.000000000000001, -3.600000000000001, -4.000000000000001, -3.900000000000001, -10.1, -3.6000000000000005, -3.6000000000000005, -3.900000000000001, -4.200000000000001, -4.200000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -3.800000000000001, -3.700000000000001, -4.000000000000001, -3.900000000000001, -4.0, -4.000000000000001, -4.1000000000000005, -3.900000000000001, -4.100000000000001, -4.0, -4.000000000000002, -3.700000000000001, -4.200000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000002, -3.900000000000001, -3.800000000000001, -3.9000000000000004, -3.900000000000001, -3.9000000000000012, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000002, -3.600000000000001, -4.000000000000001, -4.000000000000002, -4.200000000000001, -4.100000000000001, -3.900000000000001, -4.200000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -4.200000000000001, -4.000000000000002, -4.100000000000001, -4.000000000000002, -3.900000000000001, -3.800000000000001, -4.4, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -3.8000000000000007, -3.9000000000000012, -4.000000000000002, -4.100000000000001, -4.200000000000001, -3.9000000000000012, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -3.9000000000000004, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.9000000000000012, -4.1000000000000005, -3.900000000000001, -3.800000000000001, -3.8000000000000007, -3.3000000000000007, -3.900000000000001, -3.900000000000001, -3.700000000000001, -4.000000000000002, -10.8, -4.100000000000001, -3.7, -10.8, -4.000000000000001, -11.6, -3.800000000000001, -3.7000000000000006, -3.800000000000001, -4.200000000000001, -4.000000000000002, -3.900000000000001, -4.1000000000000005, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.700000000000001, -3.600000000000001, -3.900000000000001, -3.7000000000000006, -3.700000000000001, -3.8000000000000007, -4.000000000000002, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -3.800000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -4.200000000000001, -3.8000000000000007, -3.8000000000000007, -3.9000000000000012, -3.9000000000000012, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -3.800000000000001, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -3.9000000000000012, -4.100000000000001, -3.600000000000001, -3.800000000000001, -3.700000000000001, -3.800000000000001, -4.100000000000001, -4.0, -3.800000000000001, -3.8000000000000007, -3.6000000000000005, -3.800000000000001, -4.000000000000002, -3.8000000000000007, -3.9000000000000012, -4.000000000000001, -3.8000000000000007, -4.0, -3.9000000000000004, -3.900000000000001, -3.600000000000001, -4.100000000000001, -4.1000000000000005, -3.500000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.7000000000000006, -4.100000000000001, -4.100000000000001, -4.100000000000001, -3.800000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.1000000000000005, -3.9000000000000012, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000001, -3.700000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 8, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.645022874082876, "mean_inference_ms": 18.163604576137175, "mean_action_processing_ms": 0.9402829563731597, "mean_env_wait_ms": 1.5838413858601355, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0790915958621959, "StateBufferConnector_ms": 0.00992587193306246, "ViewRequirementAgentConnector_ms": 0.14485744614675256}}, "episode_reward_max": -3.3000000000000007, "episode_reward_min": -11.6, "episode_reward_mean": -4.056476683937825, "episode_len_mean": 20.72538860103627, "episodes_this_iter": 193, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.400000000000001, -3.700000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.600000000000001, -3.900000000000001, -3.900000000000001, -3.9000000000000012, -3.7000000000000006, -4.100000000000001, -3.500000000000001, -4.000000000000001, -3.600000000000001, -4.000000000000001, -3.900000000000001, -10.1, -3.6000000000000005, -3.6000000000000005, -3.900000000000001, -4.200000000000001, -4.200000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -3.800000000000001, -3.700000000000001, -4.000000000000001, -3.900000000000001, -4.0, -4.000000000000001, -4.1000000000000005, -3.900000000000001, -4.100000000000001, -4.0, -4.000000000000002, -3.700000000000001, -4.200000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000002, -3.900000000000001, -3.800000000000001, -3.9000000000000004, -3.900000000000001, -3.9000000000000012, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000002, -3.600000000000001, -4.000000000000001, -4.000000000000002, -4.200000000000001, -4.100000000000001, -3.900000000000001, -4.200000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -4.200000000000001, -4.000000000000002, -4.100000000000001, -4.000000000000002, -3.900000000000001, -3.800000000000001, -4.4, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -3.8000000000000007, -3.9000000000000012, -4.000000000000002, -4.100000000000001, -4.200000000000001, -3.9000000000000012, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -3.9000000000000004, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.9000000000000012, -4.1000000000000005, -3.900000000000001, -3.800000000000001, -3.8000000000000007, -3.3000000000000007, -3.900000000000001, -3.900000000000001, -3.700000000000001, -4.000000000000002, -10.8, -4.100000000000001, -3.7, -10.8, -4.000000000000001, -11.6, -3.800000000000001, -3.7000000000000006, -3.800000000000001, -4.200000000000001, -4.000000000000002, -3.900000000000001, -4.1000000000000005, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.700000000000001, -3.600000000000001, -3.900000000000001, -3.7000000000000006, -3.700000000000001, -3.8000000000000007, -4.000000000000002, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -3.800000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -4.200000000000001, -3.8000000000000007, -3.8000000000000007, -3.9000000000000012, -3.9000000000000012, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -3.800000000000001, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -3.9000000000000012, -4.100000000000001, -3.600000000000001, -3.800000000000001, -3.700000000000001, -3.800000000000001, -4.100000000000001, -4.0, -3.800000000000001, -3.8000000000000007, -3.6000000000000005, -3.800000000000001, -4.000000000000002, -3.8000000000000007, -3.9000000000000012, -4.000000000000001, -3.8000000000000007, -4.0, -3.9000000000000004, -3.900000000000001, -3.600000000000001, -4.100000000000001, -4.1000000000000005, -3.500000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.7000000000000006, -4.100000000000001, -4.100000000000001, -4.100000000000001, -3.800000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.1000000000000005, -3.9000000000000012, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000001, -3.700000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 8, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.645022874082876, "mean_inference_ms": 18.163604576137175, "mean_action_processing_ms": 0.9402829563731597, "mean_env_wait_ms": 1.5838413858601355, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0790915958621959, "StateBufferConnector_ms": 0.00992587193306246, "ViewRequirementAgentConnector_ms": 0.14485744614675256}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 424000, "num_agent_steps_trained": 424000, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 424000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 424000, "timers": {"training_iteration_time_ms": 173011.286, "load_time_ms": 1.169, "load_throughput": 3422734.153, "learn_time_ms": 172051.803, "learn_throughput": 23.249, "synch_weights_time_ms": 188.896}, "counters": {"num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 424000, "num_agent_steps_trained": 424000}, "done": false, "episodes_total": 21558, "training_iteration": 106, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_01-58-19", "timestamp": 1680825499, "time_this_iter_s": 172.9982454776764, "time_total_s": 18160.91251397133, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476cba90>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014736b160>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 18160.91251397133, "timesteps_since_restore": 0, "iterations_since_restore": 106, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.323170731707317, "ram_util_percent": 24.29959349593497}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.049689626950089, "cur_kl_coeff": 74.90275751284535, "cur_lr": 0.01, "total_loss": 0.3311898001029046, "policy_loss": 0.003351051030400139, "vf_loss": 0.2597208288408095, "vf_explained_var": 0.7108001212919912, "kl": 0.0009094181014143521, "entropy": 2.875525604268556, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 99045.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_agent_steps_sampled": 428000, "num_agent_steps_trained": 428000}, "sampler_results": {"episode_reward_max": -3.4000000000000004, "episode_reward_min": -10.9, "episode_reward_mean": -4.080000000000001, "episode_len_mean": 20.625, "episode_media": {}, "episodes_this_iter": 200, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.800000000000001, -4.1000000000000005, -4.200000000000001, -3.8000000000000007, -10.6, -3.600000000000001, -4.200000000000001, -10.5, -3.900000000000001, -4.000000000000001, -10.7, -4.0, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -4.200000000000001, -3.800000000000001, -4.100000000000001, -3.8000000000000003, -3.9000000000000012, -10.5, -3.700000000000001, -3.8000000000000007, -3.900000000000001, -3.5000000000000004, -4.100000000000001, -3.700000000000001, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.800000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000002, -4.000000000000001, -4.000000000000001, -3.8000000000000003, -4.000000000000002, -3.700000000000001, -3.800000000000001, -3.9000000000000012, -4.000000000000002, -3.800000000000001, -3.900000000000001, -3.900000000000001, -3.400000000000001, -3.8000000000000007, -3.7000000000000006, -3.7000000000000006, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.200000000000001, -3.7000000000000006, -3.700000000000001, -4.000000000000001, -4.0, -3.9000000000000012, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -4.300000000000001, -4.100000000000001, -3.800000000000001, -3.8000000000000007, -3.8000000000000007, -3.700000000000001, -4.000000000000002, -3.8000000000000007, -3.4000000000000004, -3.900000000000001, -3.900000000000001, -4.0, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -3.7000000000000006, -3.800000000000001, -4.200000000000001, -3.9000000000000012, -3.9000000000000012, -4.000000000000002, -4.000000000000001, -3.800000000000001, -4.000000000000001, -3.7000000000000006, -3.6000000000000005, -4.000000000000002, -3.900000000000001, -10.9, -3.9000000000000012, -4.100000000000001, -3.8000000000000016, -4.300000000000002, -4.200000000000001, -4.100000000000001, -3.8000000000000007, -4.300000000000001, -4.000000000000001, -3.700000000000001, -3.900000000000001, -3.9000000000000012, -4.1000000000000005, -3.900000000000001, -3.8000000000000007, -3.800000000000001, -4.000000000000001, -4.100000000000001, -3.700000000000001, -3.900000000000001, -3.9000000000000012, -4.1000000000000005, -3.9000000000000012, -3.9000000000000012, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -4.200000000000001, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -3.700000000000001, -4.200000000000001, -3.800000000000001, -3.600000000000001, -3.9000000000000004, -3.700000000000001, -4.000000000000001, -3.800000000000001, -3.7000000000000006, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -3.9000000000000004, -3.900000000000001, -3.800000000000001, -4.000000000000001, -3.900000000000001, -4.200000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -4.200000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.700000000000001, -3.7000000000000006, -3.6000000000000005, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -4.000000000000002, -3.6000000000000005, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.7000000000000006, -3.9000000000000012, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -3.800000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -4.300000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.0, -3.700000000000001, -4.000000000000001, -4.000000000000001, -4.200000000000001, -3.7000000000000006, -4.0, -3.800000000000001, -3.8000000000000007], "episode_lengths": [21, 21, 21, 21, 6, 21, 21, 5, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.64256039338377, "mean_inference_ms": 18.14100881092797, "mean_action_processing_ms": 0.9393920925163545, "mean_env_wait_ms": 1.5844612681715358, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.073020339012146, "StateBufferConnector_ms": 0.009827613830566406, "ViewRequirementAgentConnector_ms": 0.13587534427642822}}, "episode_reward_max": -3.4000000000000004, "episode_reward_min": -10.9, "episode_reward_mean": -4.080000000000001, "episode_len_mean": 20.625, "episodes_this_iter": 200, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.800000000000001, -4.1000000000000005, -4.200000000000001, -3.8000000000000007, -10.6, -3.600000000000001, -4.200000000000001, -10.5, -3.900000000000001, -4.000000000000001, -10.7, -4.0, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -4.200000000000001, -3.800000000000001, -4.100000000000001, -3.8000000000000003, -3.9000000000000012, -10.5, -3.700000000000001, -3.8000000000000007, -3.900000000000001, -3.5000000000000004, -4.100000000000001, -3.700000000000001, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.800000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000002, -4.000000000000001, -4.000000000000001, -3.8000000000000003, -4.000000000000002, -3.700000000000001, -3.800000000000001, -3.9000000000000012, -4.000000000000002, -3.800000000000001, -3.900000000000001, -3.900000000000001, -3.400000000000001, -3.8000000000000007, -3.7000000000000006, -3.7000000000000006, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.200000000000001, -3.7000000000000006, -3.700000000000001, -4.000000000000001, -4.0, -3.9000000000000012, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -4.300000000000001, -4.100000000000001, -3.800000000000001, -3.8000000000000007, -3.8000000000000007, -3.700000000000001, -4.000000000000002, -3.8000000000000007, -3.4000000000000004, -3.900000000000001, -3.900000000000001, -4.0, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -3.7000000000000006, -3.800000000000001, -4.200000000000001, -3.9000000000000012, -3.9000000000000012, -4.000000000000002, -4.000000000000001, -3.800000000000001, -4.000000000000001, -3.7000000000000006, -3.6000000000000005, -4.000000000000002, -3.900000000000001, -10.9, -3.9000000000000012, -4.100000000000001, -3.8000000000000016, -4.300000000000002, -4.200000000000001, -4.100000000000001, -3.8000000000000007, -4.300000000000001, -4.000000000000001, -3.700000000000001, -3.900000000000001, -3.9000000000000012, -4.1000000000000005, -3.900000000000001, -3.8000000000000007, -3.800000000000001, -4.000000000000001, -4.100000000000001, -3.700000000000001, -3.900000000000001, -3.9000000000000012, -4.1000000000000005, -3.9000000000000012, -3.9000000000000012, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -4.200000000000001, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -3.700000000000001, -4.200000000000001, -3.800000000000001, -3.600000000000001, -3.9000000000000004, -3.700000000000001, -4.000000000000001, -3.800000000000001, -3.7000000000000006, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -3.9000000000000004, -3.900000000000001, -3.800000000000001, -4.000000000000001, -3.900000000000001, -4.200000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -4.200000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.700000000000001, -3.7000000000000006, -3.6000000000000005, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -4.000000000000002, -3.6000000000000005, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.7000000000000006, -3.9000000000000012, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -3.800000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -4.300000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.0, -3.700000000000001, -4.000000000000001, -4.000000000000001, -4.200000000000001, -3.7000000000000006, -4.0, -3.800000000000001, -3.8000000000000007], "episode_lengths": [21, 21, 21, 21, 6, 21, 21, 5, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.64256039338377, "mean_inference_ms": 18.14100881092797, "mean_action_processing_ms": 0.9393920925163545, "mean_env_wait_ms": 1.5844612681715358, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.073020339012146, "StateBufferConnector_ms": 0.009827613830566406, "ViewRequirementAgentConnector_ms": 0.13587534427642822}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 428000, "num_agent_steps_trained": 428000, "num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 428000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 428000, "timers": {"training_iteration_time_ms": 173055.891, "load_time_ms": 1.176, "load_throughput": 3401982.318, "learn_time_ms": 172096.693, "learn_throughput": 23.243, "synch_weights_time_ms": 188.565}, "counters": {"num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_agent_steps_sampled": 428000, "num_agent_steps_trained": 428000}, "done": false, "episodes_total": 21758, "training_iteration": 107, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_02-01-12", "timestamp": 1680825672, "time_this_iter_s": 173.43905377388, "time_total_s": 18334.35156774521, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476d16d0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7effc010f5e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 18334.35156774521, "timesteps_since_restore": 0, "iterations_since_restore": 107, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 6.322672064777327, "ram_util_percent": 24.295546558704462}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.881220955489784, "cur_kl_coeff": 37.45137875642268, "cur_lr": 0.01, "total_loss": 0.3399229391287732, "policy_loss": -0.0003813084214925766, "vf_loss": 0.30675793508848836, "vf_explained_var": 0.7314328298132907, "kl": 0.0008957297922191379, "entropy": 2.8727396718917353, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 99975.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "sampler_results": {"episode_reward_max": -3.5000000000000004, "episode_reward_min": -11.9, "episode_reward_mean": -4.049222797927461, "episode_len_mean": 20.72538860103627, "episode_media": {}, "episodes_this_iter": 193, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.1000000000000005, -3.900000000000001, -4.000000000000002, -4.100000000000001, -4.100000000000001, -3.500000000000001, -3.8000000000000007, -3.700000000000001, -3.900000000000001, -3.8000000000000007, -3.700000000000001, -3.900000000000001, -3.5000000000000004, -3.900000000000001, -10.2, -3.800000000000001, -4.000000000000001, -4.000000000000002, -3.7000000000000006, -3.700000000000001, -4.000000000000001, -4.1000000000000005, -4.100000000000001, -4.100000000000001, -3.7000000000000006, -3.9000000000000012, -3.7000000000000006, -3.7000000000000006, -4.000000000000001, -4.100000000000001, -3.6000000000000005, -3.9000000000000012, -3.800000000000001, -4.100000000000001, -4.000000000000001, -3.700000000000001, -4.000000000000002, -3.8000000000000007, -3.800000000000001, -4.000000000000001, -3.6000000000000005, -3.900000000000001, -3.700000000000001, -3.800000000000001, -3.900000000000001, -3.800000000000001, -3.8000000000000007, -3.7000000000000006, -4.000000000000002, -3.800000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -3.700000000000001, -3.9000000000000012, -3.8000000000000003, -4.200000000000001, -3.9000000000000012, -4.100000000000001, -3.9000000000000012, -4.1000000000000005, -3.900000000000001, -3.500000000000001, -4.000000000000001, -4.300000000000001, -3.900000000000001, -4.100000000000001, -3.600000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.800000000000001, -3.7000000000000006, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -3.700000000000001, -3.9000000000000012, -3.7000000000000006, -4.0, -4.1000000000000005, -3.900000000000001, -4.100000000000001, -3.7000000000000006, -3.700000000000001, -4.100000000000001, -10.9, -10.5, -11.9, -3.8000000000000007, -3.800000000000001, -4.200000000000001, -3.9000000000000012, -4.100000000000001, -3.6000000000000005, -3.900000000000001, -4.200000000000001, -3.900000000000001, -3.8000000000000007, -4.0, -3.8000000000000007, -3.900000000000001, -3.700000000000001, -3.9000000000000012, -3.8000000000000007, -4.000000000000001, -4.0, -4.000000000000002, -4.1000000000000005, -4.300000000000001, -3.900000000000001, -4.100000000000001, -3.9000000000000012, -3.7000000000000006, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -3.800000000000001, -3.800000000000001, -3.600000000000001, -3.8000000000000003, -3.6000000000000005, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.9000000000000012, -4.000000000000001, -3.800000000000001, -4.200000000000001, -4.1000000000000005, -4.100000000000001, -3.8000000000000007, -3.9000000000000012, -4.200000000000001, -3.900000000000001, -4.0, -4.400000000000001, -3.9000000000000004, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -3.9000000000000004, -4.100000000000001, -3.8000000000000003, -4.000000000000001, -3.8000000000000007, -4.300000000000001, -3.8000000000000007, -3.8000000000000007, -3.7000000000000006, -3.800000000000001, -4.000000000000001, -4.000000000000002, -3.900000000000001, -3.800000000000001, -4.000000000000001, -4.100000000000001, -3.9000000000000004, -3.9000000000000012, -4.0, -3.8000000000000007, -3.700000000000001, -4.100000000000001, -3.700000000000001, -3.8000000000000007, -4.200000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.9000000000000004, -3.9000000000000012, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -3.800000000000001, -3.7000000000000006, -3.8000000000000007, -3.700000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 6, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.639091324064845, "mean_inference_ms": 18.135949895727848, "mean_action_processing_ms": 0.9394894339122275, "mean_env_wait_ms": 1.5816844580111884, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07627998608999302, "StateBufferConnector_ms": 0.010002462357437054, "ViewRequirementAgentConnector_ms": 0.1369856799822397}}, "episode_reward_max": -3.5000000000000004, "episode_reward_min": -11.9, "episode_reward_mean": -4.049222797927461, "episode_len_mean": 20.72538860103627, "episodes_this_iter": 193, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.1000000000000005, -3.900000000000001, -4.000000000000002, -4.100000000000001, -4.100000000000001, -3.500000000000001, -3.8000000000000007, -3.700000000000001, -3.900000000000001, -3.8000000000000007, -3.700000000000001, -3.900000000000001, -3.5000000000000004, -3.900000000000001, -10.2, -3.800000000000001, -4.000000000000001, -4.000000000000002, -3.7000000000000006, -3.700000000000001, -4.000000000000001, -4.1000000000000005, -4.100000000000001, -4.100000000000001, -3.7000000000000006, -3.9000000000000012, -3.7000000000000006, -3.7000000000000006, -4.000000000000001, -4.100000000000001, -3.6000000000000005, -3.9000000000000012, -3.800000000000001, -4.100000000000001, -4.000000000000001, -3.700000000000001, -4.000000000000002, -3.8000000000000007, -3.800000000000001, -4.000000000000001, -3.6000000000000005, -3.900000000000001, -3.700000000000001, -3.800000000000001, -3.900000000000001, -3.800000000000001, -3.8000000000000007, -3.7000000000000006, -4.000000000000002, -3.800000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -3.700000000000001, -3.9000000000000012, -3.8000000000000003, -4.200000000000001, -3.9000000000000012, -4.100000000000001, -3.9000000000000012, -4.1000000000000005, -3.900000000000001, -3.500000000000001, -4.000000000000001, -4.300000000000001, -3.900000000000001, -4.100000000000001, -3.600000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.800000000000001, -3.7000000000000006, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -3.700000000000001, -3.9000000000000012, -3.7000000000000006, -4.0, -4.1000000000000005, -3.900000000000001, -4.100000000000001, -3.7000000000000006, -3.700000000000001, -4.100000000000001, -10.9, -10.5, -11.9, -3.8000000000000007, -3.800000000000001, -4.200000000000001, -3.9000000000000012, -4.100000000000001, -3.6000000000000005, -3.900000000000001, -4.200000000000001, -3.900000000000001, -3.8000000000000007, -4.0, -3.8000000000000007, -3.900000000000001, -3.700000000000001, -3.9000000000000012, -3.8000000000000007, -4.000000000000001, -4.0, -4.000000000000002, -4.1000000000000005, -4.300000000000001, -3.900000000000001, -4.100000000000001, -3.9000000000000012, -3.7000000000000006, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -3.800000000000001, -3.800000000000001, -3.600000000000001, -3.8000000000000003, -3.6000000000000005, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.9000000000000012, -4.000000000000001, -3.800000000000001, -4.200000000000001, -4.1000000000000005, -4.100000000000001, -3.8000000000000007, -3.9000000000000012, -4.200000000000001, -3.900000000000001, -4.0, -4.400000000000001, -3.9000000000000004, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -3.9000000000000004, -4.100000000000001, -3.8000000000000003, -4.000000000000001, -3.8000000000000007, -4.300000000000001, -3.8000000000000007, -3.8000000000000007, -3.7000000000000006, -3.800000000000001, -4.000000000000001, -4.000000000000002, -3.900000000000001, -3.800000000000001, -4.000000000000001, -4.100000000000001, -3.9000000000000004, -3.9000000000000012, -4.0, -3.8000000000000007, -3.700000000000001, -4.100000000000001, -3.700000000000001, -3.8000000000000007, -4.200000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.9000000000000004, -3.9000000000000012, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -3.800000000000001, -3.7000000000000006, -3.8000000000000007, -3.700000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 6, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.639091324064845, "mean_inference_ms": 18.135949895727848, "mean_action_processing_ms": 0.9394894339122275, "mean_env_wait_ms": 1.5816844580111884, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07627998608999302, "StateBufferConnector_ms": 0.010002462357437054, "ViewRequirementAgentConnector_ms": 0.1369856799822397}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 432000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 173082.985, "load_time_ms": 1.192, "load_throughput": 3356517.286, "learn_time_ms": 172127.788, "learn_throughput": 23.239, "synch_weights_time_ms": 186.984}, "counters": {"num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "episodes_total": 21951, "training_iteration": 108, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_02-04-06", "timestamp": 1680825846, "time_this_iter_s": 173.0937066078186, "time_total_s": 18507.445274353027, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01472af0d0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7effc0134820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 18507.445274353027, "timesteps_since_restore": 0, "iterations_since_restore": 108, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.386991869918699, "ram_util_percent": 24.29959349593497}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.779775749996144, "cur_kl_coeff": 18.72568937821134, "cur_lr": 0.01, "total_loss": 0.32235894003602605, "policy_loss": -0.0004795493337736335, "vf_loss": 0.2942001190477161, "vf_explained_var": 0.7516050493845375, "kl": 0.0015293628505562709, "entropy": 2.879566192114225, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 100905.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_agent_steps_sampled": 436000, "num_agent_steps_trained": 436000}, "sampler_results": {"episode_reward_max": -3.6, "episode_reward_min": -10.4, "episode_reward_mean": -4.033689839572194, "episode_len_mean": 20.72192513368984, "episode_media": {}, "episodes_this_iter": 187, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.000000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.800000000000001, -4.100000000000001, -4.000000000000001, -4.1000000000000005, -4.200000000000001, -3.8000000000000007, -10.3, -10.4, -4.100000000000001, -3.8000000000000007, -3.600000000000001, -3.7000000000000006, -3.800000000000001, -10.1, -3.800000000000001, -3.600000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.1000000000000005, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -3.800000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -3.700000000000001, -3.8000000000000007, -3.900000000000001, -3.9000000000000012, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.6000000000000005, -3.7, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.6000000000000005, -4.0, -3.900000000000001, -3.700000000000001, -4.000000000000001, -4.300000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.1000000000000005, -3.900000000000001, -3.9000000000000012, -3.700000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -4.200000000000001, -3.700000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -3.9000000000000004, -4.300000000000001, -3.7000000000000006, -4.1000000000000005, -3.900000000000001, -3.700000000000001, -3.800000000000001, -3.9000000000000012, -4.1000000000000005, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.9000000000000012, -4.000000000000001, -3.800000000000001, -4.000000000000002, -4.000000000000001, -3.900000000000001, -3.7000000000000006, -4.200000000000001, -3.800000000000001, -4.0, -4.000000000000001, -3.8000000000000007, -3.9000000000000004, -3.6, -4.100000000000001, -3.9000000000000004, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -4.200000000000001, -4.000000000000002, -3.9000000000000012, -4.1000000000000005, -3.900000000000001, -4.0, -3.700000000000001, -3.700000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.200000000000001, -4.200000000000001, -3.7000000000000006, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000002, -3.8000000000000007, -3.7000000000000006, -4.000000000000001, -4.000000000000001, -3.800000000000001, -4.100000000000001, -3.800000000000001, -3.900000000000001, -3.9000000000000012, -3.600000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.8000000000000003, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -3.6000000000000005, -4.000000000000001, -4.200000000000001, -3.8000000000000007, -4.200000000000001, -3.7000000000000006, -3.8000000000000007, -3.700000000000001, -4.000000000000001, -3.900000000000001, -3.7000000000000006, -3.9000000000000012, -3.800000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -4.200000000000001, -3.900000000000001, -4.100000000000001, -4.200000000000001, -4.300000000000001, -3.900000000000001, -4.1000000000000005, -4.100000000000001, -3.6000000000000005, -3.9000000000000004, -4.100000000000001, -4.200000000000001, -4.200000000000001, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.300000000000001, -3.6000000000000005, -4.000000000000002, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -3.7000000000000006, -4.0, -3.700000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 5, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.639665214748034, "mean_inference_ms": 18.128256199918727, "mean_action_processing_ms": 0.9386807593685461, "mean_env_wait_ms": 1.5812666894873684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07361817487420882, "StateBufferConnector_ms": 0.00985204217268184, "ViewRequirementAgentConnector_ms": 0.13722225943988658}}, "episode_reward_max": -3.6, "episode_reward_min": -10.4, "episode_reward_mean": -4.033689839572194, "episode_len_mean": 20.72192513368984, "episodes_this_iter": 187, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.000000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.800000000000001, -4.100000000000001, -4.000000000000001, -4.1000000000000005, -4.200000000000001, -3.8000000000000007, -10.3, -10.4, -4.100000000000001, -3.8000000000000007, -3.600000000000001, -3.7000000000000006, -3.800000000000001, -10.1, -3.800000000000001, -3.600000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.1000000000000005, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -3.800000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -3.700000000000001, -3.8000000000000007, -3.900000000000001, -3.9000000000000012, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.6000000000000005, -3.7, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.6000000000000005, -4.0, -3.900000000000001, -3.700000000000001, -4.000000000000001, -4.300000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.1000000000000005, -3.900000000000001, -3.9000000000000012, -3.700000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -4.200000000000001, -3.700000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -3.9000000000000004, -4.300000000000001, -3.7000000000000006, -4.1000000000000005, -3.900000000000001, -3.700000000000001, -3.800000000000001, -3.9000000000000012, -4.1000000000000005, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.9000000000000012, -4.000000000000001, -3.800000000000001, -4.000000000000002, -4.000000000000001, -3.900000000000001, -3.7000000000000006, -4.200000000000001, -3.800000000000001, -4.0, -4.000000000000001, -3.8000000000000007, -3.9000000000000004, -3.6, -4.100000000000001, -3.9000000000000004, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -4.200000000000001, -4.000000000000002, -3.9000000000000012, -4.1000000000000005, -3.900000000000001, -4.0, -3.700000000000001, -3.700000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.200000000000001, -4.200000000000001, -3.7000000000000006, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000002, -3.8000000000000007, -3.7000000000000006, -4.000000000000001, -4.000000000000001, -3.800000000000001, -4.100000000000001, -3.800000000000001, -3.900000000000001, -3.9000000000000012, -3.600000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.8000000000000003, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -3.6000000000000005, -4.000000000000001, -4.200000000000001, -3.8000000000000007, -4.200000000000001, -3.7000000000000006, -3.8000000000000007, -3.700000000000001, -4.000000000000001, -3.900000000000001, -3.7000000000000006, -3.9000000000000012, -3.800000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -4.200000000000001, -3.900000000000001, -4.100000000000001, -4.200000000000001, -4.300000000000001, -3.900000000000001, -4.1000000000000005, -4.100000000000001, -3.6000000000000005, -3.9000000000000004, -4.100000000000001, -4.200000000000001, -4.200000000000001, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.300000000000001, -3.6000000000000005, -4.000000000000002, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -3.7000000000000006, -4.0, -3.700000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 5, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.639665214748034, "mean_inference_ms": 18.128256199918727, "mean_action_processing_ms": 0.9386807593685461, "mean_env_wait_ms": 1.5812666894873684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07361817487420882, "StateBufferConnector_ms": 0.00985204217268184, "ViewRequirementAgentConnector_ms": 0.13722225943988658}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 436000, "num_agent_steps_trained": 436000, "num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 436000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 436000, "timers": {"training_iteration_time_ms": 173195.102, "load_time_ms": 1.172, "load_throughput": 3412986.146, "learn_time_ms": 172234.977, "learn_throughput": 23.224, "synch_weights_time_ms": 187.227}, "counters": {"num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_agent_steps_sampled": 436000, "num_agent_steps_trained": 436000}, "done": false, "episodes_total": 22138, "training_iteration": 109, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_02-07-00", "timestamp": 1680826020, "time_this_iter_s": 174.37787437438965, "time_total_s": 18681.823148727417, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7effc09488e0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7effc010f790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 18681.823148727417, "timesteps_since_restore": 0, "iterations_since_restore": 109, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.481048387096774, "ram_util_percent": 24.299596774193553}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.799864566069777, "cur_kl_coeff": 9.36284468910567, "cur_lr": 0.01, "total_loss": 0.3458918147289785, "policy_loss": -0.005402096445041318, "vf_loss": 0.2927600093105788, "vf_explained_var": 0.7068122725973847, "kl": 0.006251722038473173, "entropy": 2.880383885034951, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 101835.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000}, "sampler_results": {"episode_reward_max": -3.500000000000001, "episode_reward_min": -10.9, "episode_reward_mean": -4.047692307692309, "episode_len_mean": 20.68717948717949, "episode_media": {}, "episodes_this_iter": 195, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.9, -3.700000000000001, -3.700000000000001, -4.000000000000002, -4.100000000000001, -10.3, -3.900000000000001, -3.900000000000001, -4.200000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -10.5, -3.800000000000001, -3.7000000000000006, -4.000000000000001, -3.8000000000000007, -3.700000000000001, -3.500000000000001, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -3.800000000000001, -3.800000000000001, -4.200000000000001, -4.000000000000002, -4.000000000000001, -3.900000000000001, -4.0, -3.900000000000001, -3.8000000000000007, -3.9000000000000004, -3.800000000000001, -4.100000000000001, -3.8000000000000003, -3.8000000000000007, -3.500000000000001, -3.700000000000001, -3.900000000000001, -4.100000000000001, -3.700000000000001, -3.800000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -4.0, -3.800000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000001, -3.800000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000002, -4.200000000000001, -4.000000000000002, -4.200000000000001, -4.100000000000001, -3.800000000000001, -3.7000000000000006, -3.8000000000000007, -3.500000000000001, -4.000000000000001, -4.000000000000002, -3.700000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.200000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -3.9000000000000012, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.700000000000001, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -3.7000000000000006, -4.300000000000001, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -3.8000000000000007, -4.000000000000001, -3.700000000000001, -3.8000000000000007, -3.900000000000001, -10.5, -3.600000000000001, -3.6000000000000005, -4.100000000000001, -4.100000000000001, -3.600000000000001, -3.800000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.1000000000000005, -4.000000000000001, -3.6000000000000005, -4.200000000000001, -4.100000000000001, -4.200000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.300000000000001, -3.600000000000001, -3.600000000000001, -3.8000000000000007, -4.000000000000001, -3.6000000000000005, -3.7000000000000006, -3.900000000000001, -4.000000000000002, -3.900000000000001, -3.9000000000000012, -3.600000000000001, -3.800000000000001, -3.500000000000001, -3.8000000000000007, -4.000000000000001, -4.0, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.6000000000000005, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -3.9000000000000012, -3.9000000000000012, -4.100000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.7000000000000006, -4.000000000000001, -3.700000000000001, -3.8000000000000007, -4.200000000000001, -3.8000000000000007, -4.000000000000002, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -4.200000000000001, -4.000000000000002, -4.000000000000001, -4.300000000000001, -4.300000000000001, -3.700000000000001, -3.900000000000001, -3.9000000000000004, -3.700000000000001, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -3.9000000000000012, -3.9000000000000012, -3.7000000000000006, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -3.900000000000001, -3.9000000000000004, -4.000000000000001, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -3.8000000000000007, -3.9000000000000012, -4.000000000000002, -3.8000000000000007, -4.000000000000002], "episode_lengths": [9, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.6378798460749, "mean_inference_ms": 18.142126109793686, "mean_action_processing_ms": 0.9390105125053861, "mean_env_wait_ms": 1.580487926449691, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07894528217804737, "StateBufferConnector_ms": 0.010302250201885518, "ViewRequirementAgentConnector_ms": 0.14443238576253256}}, "episode_reward_max": -3.500000000000001, "episode_reward_min": -10.9, "episode_reward_mean": -4.047692307692309, "episode_len_mean": 20.68717948717949, "episodes_this_iter": 195, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10.9, -3.700000000000001, -3.700000000000001, -4.000000000000002, -4.100000000000001, -10.3, -3.900000000000001, -3.900000000000001, -4.200000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -10.5, -3.800000000000001, -3.7000000000000006, -4.000000000000001, -3.8000000000000007, -3.700000000000001, -3.500000000000001, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -3.800000000000001, -3.800000000000001, -4.200000000000001, -4.000000000000002, -4.000000000000001, -3.900000000000001, -4.0, -3.900000000000001, -3.8000000000000007, -3.9000000000000004, -3.800000000000001, -4.100000000000001, -3.8000000000000003, -3.8000000000000007, -3.500000000000001, -3.700000000000001, -3.900000000000001, -4.100000000000001, -3.700000000000001, -3.800000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -4.0, -3.800000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000001, -3.800000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000002, -4.200000000000001, -4.000000000000002, -4.200000000000001, -4.100000000000001, -3.800000000000001, -3.7000000000000006, -3.8000000000000007, -3.500000000000001, -4.000000000000001, -4.000000000000002, -3.700000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.200000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -3.9000000000000012, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.700000000000001, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -3.7000000000000006, -4.300000000000001, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -3.8000000000000007, -4.000000000000001, -3.700000000000001, -3.8000000000000007, -3.900000000000001, -10.5, -3.600000000000001, -3.6000000000000005, -4.100000000000001, -4.100000000000001, -3.600000000000001, -3.800000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.1000000000000005, -4.000000000000001, -3.6000000000000005, -4.200000000000001, -4.100000000000001, -4.200000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.300000000000001, -3.600000000000001, -3.600000000000001, -3.8000000000000007, -4.000000000000001, -3.6000000000000005, -3.7000000000000006, -3.900000000000001, -4.000000000000002, -3.900000000000001, -3.9000000000000012, -3.600000000000001, -3.800000000000001, -3.500000000000001, -3.8000000000000007, -4.000000000000001, -4.0, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.6000000000000005, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -3.9000000000000012, -3.9000000000000012, -4.100000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.7000000000000006, -4.000000000000001, -3.700000000000001, -3.8000000000000007, -4.200000000000001, -3.8000000000000007, -4.000000000000002, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -4.200000000000001, -4.000000000000002, -4.000000000000001, -4.300000000000001, -4.300000000000001, -3.700000000000001, -3.900000000000001, -3.9000000000000004, -3.700000000000001, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -3.9000000000000012, -3.9000000000000012, -3.7000000000000006, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -3.900000000000001, -3.9000000000000004, -4.000000000000001, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -3.8000000000000007, -3.9000000000000012, -4.000000000000002, -3.8000000000000007, -4.000000000000002], "episode_lengths": [9, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.6378798460749, "mean_inference_ms": 18.142126109793686, "mean_action_processing_ms": 0.9390105125053861, "mean_env_wait_ms": 1.580487926449691, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07894528217804737, "StateBufferConnector_ms": 0.010302250201885518, "ViewRequirementAgentConnector_ms": 0.14443238576253256}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 440000, "timers": {"training_iteration_time_ms": 173289.252, "load_time_ms": 1.169, "load_throughput": 3422943.649, "learn_time_ms": 172325.164, "learn_throughput": 23.212, "synch_weights_time_ms": 186.813}, "counters": {"num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000}, "done": false, "episodes_total": 22333, "training_iteration": 110, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_02-09-54", "timestamp": 1680826194, "time_this_iter_s": 173.99005246162415, "time_total_s": 18855.81320118904, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01477a3370>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014736b160>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 18855.81320118904, "timesteps_since_restore": 0, "iterations_since_restore": 110, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.322672064777327, "ram_util_percent": 24.29676113360325}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.973128612964384, "cur_kl_coeff": 9.36284468910567, "cur_lr": 0.01, "total_loss": 0.3242983574207912, "policy_loss": -0.005612435876842468, "vf_loss": 0.26411933029691376, "vf_explained_var": 0.7392326023629917, "kl": 0.007026867024673734, "entropy": 2.8817220775029995, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 102765.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000}, "sampler_results": {"episode_reward_max": -3.400000000000001, "episode_reward_min": -11.0, "episode_reward_mean": -4.101522842639595, "episode_len_mean": 20.497461928934012, "episode_media": {}, "episodes_this_iter": 197, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.7000000000000006, -4.0, -3.7000000000000006, -3.900000000000001, -10.4, -3.7000000000000006, -4.000000000000001, -10.2, -10.2, -3.7000000000000006, -4.000000000000001, -3.900000000000001, -10.3, -3.900000000000001, -3.5000000000000004, -11.0, -3.800000000000001, -3.8000000000000007, -4.1000000000000005, -3.900000000000001, -10.4, -3.700000000000001, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -3.9000000000000012, -3.900000000000001, -4.100000000000001, -3.9000000000000004, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -3.700000000000001, -4.200000000000001, -3.7000000000000006, -3.8000000000000007, -4.000000000000002, -3.800000000000001, -3.900000000000001, -3.7000000000000006, -4.300000000000001, -4.000000000000001, -3.7000000000000006, -4.200000000000001, -3.8000000000000007, -3.8000000000000007, -3.500000000000001, -3.900000000000001, -4.000000000000001, -3.400000000000001, -3.800000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.200000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000001, -3.9000000000000012, -3.700000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000001, -3.900000000000001, -3.6000000000000005, -4.0, -3.8000000000000003, -4.000000000000001, -4.100000000000001, -4.1000000000000005, -3.8000000000000007, -3.800000000000001, -4.000000000000001, -3.900000000000001, -4.0, -4.000000000000002, -4.000000000000001, -3.700000000000001, -3.9000000000000012, -4.100000000000001, -4.000000000000002, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -3.600000000000001, -4.0, -4.000000000000001, -4.0, -3.600000000000001, -4.100000000000001, -3.7000000000000006, -3.900000000000001, -3.6000000000000005, -3.6000000000000005, -4.000000000000001, -3.8000000000000007, -3.700000000000001, -4.1000000000000005, -3.8000000000000007, -3.700000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -3.9000000000000004, -4.000000000000002, -4.000000000000002, -4.100000000000001, -4.000000000000001, -3.500000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.7000000000000006, -3.9000000000000012, -3.900000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.600000000000001, -3.8000000000000007, -3.900000000000001, -3.9000000000000012, -3.800000000000001, -4.000000000000002, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -3.900000000000001, -3.800000000000001, -4.200000000000001, -4.100000000000001, -3.600000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -4.1000000000000005, -3.7000000000000006, -3.8000000000000007, -3.6000000000000005, -3.800000000000001, -4.200000000000001, -4.000000000000001, -3.600000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.700000000000001, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -3.9000000000000012, -3.700000000000001, -3.7000000000000006, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -4.000000000000001, -4.300000000000001, -4.300000000000001, -3.7000000000000006, -3.800000000000001, -4.000000000000001, -3.8000000000000007, -4.200000000000001], "episode_lengths": [21, 21, 21, 21, 5, 21, 21, 3, 3, 21, 21, 21, 4, 21, 21, 7, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.638432044561718, "mean_inference_ms": 18.15121181329368, "mean_action_processing_ms": 0.9399718161886511, "mean_env_wait_ms": 1.5831453197306802, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08697848634671439, "StateBufferConnector_ms": 0.011866951956966807, "ViewRequirementAgentConnector_ms": 0.16164041412663338}}, "episode_reward_max": -3.400000000000001, "episode_reward_min": -11.0, "episode_reward_mean": -4.101522842639595, "episode_len_mean": 20.497461928934012, "episodes_this_iter": 197, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.7000000000000006, -4.0, -3.7000000000000006, -3.900000000000001, -10.4, -3.7000000000000006, -4.000000000000001, -10.2, -10.2, -3.7000000000000006, -4.000000000000001, -3.900000000000001, -10.3, -3.900000000000001, -3.5000000000000004, -11.0, -3.800000000000001, -3.8000000000000007, -4.1000000000000005, -3.900000000000001, -10.4, -3.700000000000001, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -3.9000000000000012, -3.900000000000001, -4.100000000000001, -3.9000000000000004, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -3.700000000000001, -4.200000000000001, -3.7000000000000006, -3.8000000000000007, -4.000000000000002, -3.800000000000001, -3.900000000000001, -3.7000000000000006, -4.300000000000001, -4.000000000000001, -3.7000000000000006, -4.200000000000001, -3.8000000000000007, -3.8000000000000007, -3.500000000000001, -3.900000000000001, -4.000000000000001, -3.400000000000001, -3.800000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.200000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000001, -3.9000000000000012, -3.700000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000001, -3.900000000000001, -3.6000000000000005, -4.0, -3.8000000000000003, -4.000000000000001, -4.100000000000001, -4.1000000000000005, -3.8000000000000007, -3.800000000000001, -4.000000000000001, -3.900000000000001, -4.0, -4.000000000000002, -4.000000000000001, -3.700000000000001, -3.9000000000000012, -4.100000000000001, -4.000000000000002, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -3.600000000000001, -4.0, -4.000000000000001, -4.0, -3.600000000000001, -4.100000000000001, -3.7000000000000006, -3.900000000000001, -3.6000000000000005, -3.6000000000000005, -4.000000000000001, -3.8000000000000007, -3.700000000000001, -4.1000000000000005, -3.8000000000000007, -3.700000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -3.9000000000000004, -4.000000000000002, -4.000000000000002, -4.100000000000001, -4.000000000000001, -3.500000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.7000000000000006, -3.9000000000000012, -3.900000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.600000000000001, -3.8000000000000007, -3.900000000000001, -3.9000000000000012, -3.800000000000001, -4.000000000000002, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -3.900000000000001, -3.800000000000001, -4.200000000000001, -4.100000000000001, -3.600000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -4.1000000000000005, -3.7000000000000006, -3.8000000000000007, -3.6000000000000005, -3.800000000000001, -4.200000000000001, -4.000000000000001, -3.600000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.700000000000001, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -3.9000000000000012, -3.700000000000001, -3.7000000000000006, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -4.000000000000001, -4.300000000000001, -4.300000000000001, -3.7000000000000006, -3.800000000000001, -4.000000000000001, -3.8000000000000007, -4.200000000000001], "episode_lengths": [21, 21, 21, 21, 5, 21, 21, 3, 3, 21, 21, 21, 4, 21, 21, 7, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.638432044561718, "mean_inference_ms": 18.15121181329368, "mean_action_processing_ms": 0.9399718161886511, "mean_env_wait_ms": 1.5831453197306802, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08697848634671439, "StateBufferConnector_ms": 0.011866951956966807, "ViewRequirementAgentConnector_ms": 0.16164041412663338}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 444000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 444000, "timers": {"training_iteration_time_ms": 173313.137, "load_time_ms": 1.144, "load_throughput": 3496273.08, "learn_time_ms": 172367.987, "learn_throughput": 23.206, "synch_weights_time_ms": 164.036}, "counters": {"num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000}, "done": false, "episodes_total": 22530, "training_iteration": 111, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_02-12-48", "timestamp": 1680826368, "time_this_iter_s": 173.5234842300415, "time_total_s": 19029.336685419083, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476d7a90>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7effc010f790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 19029.336685419083, "timesteps_since_restore": 0, "iterations_since_restore": 111, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.357489878542511, "ram_util_percent": 24.295141700404873}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.791767183683252, "cur_kl_coeff": 9.36284468910567, "cur_lr": 0.01, "total_loss": 0.42461053119391523, "policy_loss": -0.0008810782679907417, "vf_loss": 0.31061557331873524, "vf_explained_var": 0.7333102981249492, "kl": 0.012269352180057116, "entropy": 2.862220621878101, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 103695.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "sampler_results": {"episode_reward_max": -3.5000000000000004, "episode_reward_min": -11.8, "episode_reward_mean": -4.067005076142133, "episode_len_mean": 20.700507614213198, "episode_media": {}, "episodes_this_iter": 197, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.2, -4.000000000000001, -10.7, -3.900000000000001, -4.200000000000001, -3.800000000000001, -4.100000000000001, -3.8000000000000007, -3.5000000000000004, -3.6000000000000005, -3.8000000000000003, -10.1, -3.8000000000000007, -4.000000000000002, -3.8000000000000007, -4.200000000000001, -3.700000000000001, -4.000000000000001, -4.200000000000001, -3.8000000000000007, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -3.9000000000000012, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -4.0, -4.200000000000001, -4.200000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -4.200000000000001, -4.100000000000001, -3.800000000000001, -3.8000000000000007, -3.8000000000000003, -3.6000000000000005, -3.800000000000001, -3.900000000000001, -3.9000000000000004, -4.200000000000001, -3.900000000000001, -4.200000000000001, -3.800000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -4.300000000000001, -3.800000000000001, -4.000000000000001, -3.8000000000000007, -3.700000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.600000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -4.200000000000001, -3.7, -4.000000000000001, -3.900000000000001, -4.000000000000002, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.200000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.800000000000001, -4.000000000000002, -4.0, -4.100000000000001, -4.200000000000001, -4.100000000000001, -3.800000000000001, -3.8000000000000007, -3.7000000000000006, -3.600000000000001, -4.000000000000001, -11.8, -3.7000000000000006, -4.100000000000001, -3.9000000000000012, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -4.200000000000001, -3.900000000000001, -3.700000000000001, -3.900000000000001, -3.800000000000001, -4.200000000000001, -3.900000000000001, -4.000000000000001, -3.700000000000001, -3.9000000000000004, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.200000000000001, -3.9000000000000012, -3.6000000000000005, -3.8000000000000007, -3.700000000000001, -4.000000000000002, -4.000000000000001, -4.0, -3.600000000000001, -3.9000000000000004, -3.900000000000001, -3.900000000000001, -3.700000000000001, -4.100000000000001, -3.9000000000000012, -4.000000000000002, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -3.9000000000000012, -4.000000000000002, -3.9000000000000012, -4.000000000000001, -4.100000000000001, -3.9000000000000012, -3.8000000000000003, -3.900000000000001, -3.7000000000000006, -4.200000000000001, -3.8000000000000007, -3.800000000000001, -4.000000000000001, -4.100000000000001, -3.800000000000001, -4.000000000000001, -4.400000000000001, -3.8000000000000007, -4.000000000000001, -3.9000000000000012, -3.9000000000000012, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.700000000000001, -4.000000000000001, -3.9000000000000004, -3.7000000000000006, -4.200000000000001, -3.5000000000000004, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -4.200000000000001, -3.800000000000001, -4.0, -3.9000000000000012, -4.000000000000001, -3.900000000000001, -4.200000000000001, -3.800000000000001, -3.9000000000000012, -4.000000000000002, -3.900000000000001, -3.800000000000001, -3.7000000000000006, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001], "episode_lengths": [3, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.63641743777952, "mean_inference_ms": 18.141878105745633, "mean_action_processing_ms": 0.9393931225270253, "mean_env_wait_ms": 1.5797683691315114, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07015545356092114, "StateBufferConnector_ms": 0.009139540231772486, "ViewRequirementAgentConnector_ms": 0.13116785717494597}}, "episode_reward_max": -3.5000000000000004, "episode_reward_min": -11.8, "episode_reward_mean": -4.067005076142133, "episode_len_mean": 20.700507614213198, "episodes_this_iter": 197, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10.2, -4.000000000000001, -10.7, -3.900000000000001, -4.200000000000001, -3.800000000000001, -4.100000000000001, -3.8000000000000007, -3.5000000000000004, -3.6000000000000005, -3.8000000000000003, -10.1, -3.8000000000000007, -4.000000000000002, -3.8000000000000007, -4.200000000000001, -3.700000000000001, -4.000000000000001, -4.200000000000001, -3.8000000000000007, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -3.9000000000000012, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -4.0, -4.200000000000001, -4.200000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -4.200000000000001, -4.100000000000001, -3.800000000000001, -3.8000000000000007, -3.8000000000000003, -3.6000000000000005, -3.800000000000001, -3.900000000000001, -3.9000000000000004, -4.200000000000001, -3.900000000000001, -4.200000000000001, -3.800000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -4.300000000000001, -3.800000000000001, -4.000000000000001, -3.8000000000000007, -3.700000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.600000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -4.200000000000001, -3.7, -4.000000000000001, -3.900000000000001, -4.000000000000002, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.200000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.800000000000001, -4.000000000000002, -4.0, -4.100000000000001, -4.200000000000001, -4.100000000000001, -3.800000000000001, -3.8000000000000007, -3.7000000000000006, -3.600000000000001, -4.000000000000001, -11.8, -3.7000000000000006, -4.100000000000001, -3.9000000000000012, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -4.200000000000001, -3.900000000000001, -3.700000000000001, -3.900000000000001, -3.800000000000001, -4.200000000000001, -3.900000000000001, -4.000000000000001, -3.700000000000001, -3.9000000000000004, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.200000000000001, -3.9000000000000012, -3.6000000000000005, -3.8000000000000007, -3.700000000000001, -4.000000000000002, -4.000000000000001, -4.0, -3.600000000000001, -3.9000000000000004, -3.900000000000001, -3.900000000000001, -3.700000000000001, -4.100000000000001, -3.9000000000000012, -4.000000000000002, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -3.9000000000000012, -4.000000000000002, -3.9000000000000012, -4.000000000000001, -4.100000000000001, -3.9000000000000012, -3.8000000000000003, -3.900000000000001, -3.7000000000000006, -4.200000000000001, -3.8000000000000007, -3.800000000000001, -4.000000000000001, -4.100000000000001, -3.800000000000001, -4.000000000000001, -4.400000000000001, -3.8000000000000007, -4.000000000000001, -3.9000000000000012, -3.9000000000000012, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.700000000000001, -4.000000000000001, -3.9000000000000004, -3.7000000000000006, -4.200000000000001, -3.5000000000000004, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -4.200000000000001, -3.800000000000001, -4.0, -3.9000000000000012, -4.000000000000001, -3.900000000000001, -4.200000000000001, -3.800000000000001, -3.9000000000000012, -4.000000000000002, -3.900000000000001, -3.800000000000001, -3.7000000000000006, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001], "episode_lengths": [3, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.63641743777952, "mean_inference_ms": 18.141878105745633, "mean_action_processing_ms": 0.9393931225270253, "mean_env_wait_ms": 1.5797683691315114, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07015545356092114, "StateBufferConnector_ms": 0.009139540231772486, "ViewRequirementAgentConnector_ms": 0.13116785717494597}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 448000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 173483.117, "load_time_ms": 1.158, "load_throughput": 3455657.261, "learn_time_ms": 172526.309, "learn_throughput": 23.185, "synch_weights_time_ms": 168.809}, "counters": {"num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "episodes_total": 22727, "training_iteration": 112, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_02-15-42", "timestamp": 1680826542, "time_this_iter_s": 174.66766905784607, "time_total_s": 19204.00435447693, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01475a5c40>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7effc01345e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 19204.00435447693, "timesteps_since_restore": 0, "iterations_since_restore": 112, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.516129032258065, "ram_util_percent": 24.295564516129037}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.333466204776558, "cur_kl_coeff": 9.36284468910567, "cur_lr": 0.01, "total_loss": 0.45487817690096877, "policy_loss": 0.002066750002283883, "vf_loss": 0.29458242796601786, "vf_explained_var": 0.7263686825511276, "kl": 0.016899671757991817, "entropy": 2.8893734460235923, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 104625.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 452000, "num_agent_steps_trained": 452000}, "sampler_results": {"episode_reward_max": -3.400000000000001, "episode_reward_min": -12.7, "episode_reward_mean": -4.051871657754011, "episode_len_mean": 20.796791443850267, "episode_media": {}, "episodes_this_iter": 187, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.6000000000000005, -10.7, -3.7000000000000006, -3.8000000000000007, -3.900000000000001, -3.6000000000000005, -3.800000000000001, -12.7, -10.6, -4.100000000000001, -3.8000000000000007, -3.9000000000000012, -3.900000000000001, -3.700000000000001, -3.800000000000001, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -3.800000000000001, -3.700000000000001, -3.800000000000001, -4.000000000000002, -3.6000000000000005, -4.100000000000001, -3.900000000000001, -3.600000000000001, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -3.8000000000000007, -4.1000000000000005, -4.200000000000001, -4.200000000000001, -4.100000000000001, -3.700000000000001, -4.200000000000001, -4.200000000000001, -3.700000000000001, -3.900000000000001, -3.800000000000001, -3.8000000000000007, -3.600000000000001, -3.900000000000001, -4.000000000000002, -3.7000000000000015, -3.8000000000000007, -3.700000000000001, -3.700000000000001, -3.8000000000000007, -3.9000000000000012, -3.800000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.9000000000000004, -3.9000000000000012, -3.600000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.9000000000000012, -4.200000000000001, -3.900000000000001, -3.400000000000001, -4.1000000000000005, -3.900000000000001, -4.100000000000001, -4.100000000000001, -3.700000000000001, -3.400000000000001, -3.800000000000001, -3.9000000000000012, -3.9000000000000017, -4.100000000000001, -4.300000000000001, -4.100000000000001, -3.500000000000001, -4.100000000000001, -3.9000000000000012, -3.800000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -3.700000000000001, -4.000000000000002, -11.7, -4.200000000000001, -3.9000000000000012, -4.000000000000001, -3.6000000000000005, -4.000000000000002, -3.8000000000000007, -3.9000000000000012, -4.200000000000001, -3.8000000000000007, -3.7000000000000006, -3.700000000000001, -4.200000000000001, -3.8000000000000007, -3.800000000000001, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -3.800000000000001, -4.000000000000002, -3.8000000000000003, -4.000000000000002, -3.6000000000000005, -3.8000000000000016, -3.8000000000000007, -3.9000000000000012, -4.100000000000001, -3.9000000000000012, -3.8000000000000007, -3.7000000000000006, -4.300000000000001, -4.000000000000002, -3.5000000000000004, -3.700000000000001, -4.100000000000001, -3.800000000000001, -4.200000000000001, -3.9000000000000012, -3.8000000000000007, -3.600000000000001, -3.8000000000000007, -4.200000000000001, -3.6, -3.7000000000000006, -3.900000000000001, -3.8000000000000007, -3.8000000000000003, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -3.7000000000000006, -4.200000000000001, -4.1000000000000005, -3.900000000000001, -3.800000000000001, -3.900000000000001, -4.000000000000001, -4.1000000000000005, -3.8000000000000007, -4.000000000000002, -4.000000000000001, -3.6000000000000005, -3.9000000000000012, -4.0, -3.900000000000001, -3.900000000000001, -4.200000000000001, -3.9000000000000012, -4.0, -3.7000000000000006, -3.700000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.700000000000001, -3.700000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.1000000000000005, -4.000000000000001, -3.900000000000001, -4.200000000000001, -3.8000000000000007], "episode_lengths": [21, 7, 21, 21, 21, 21, 21, 19, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.640821133107375, "mean_inference_ms": 18.14489179700432, "mean_action_processing_ms": 0.9388437404355177, "mean_env_wait_ms": 1.5787237648414614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07215821169276926, "StateBufferConnector_ms": 0.009453870395925594, "ViewRequirementAgentConnector_ms": 0.13408125403093143}}, "episode_reward_max": -3.400000000000001, "episode_reward_min": -12.7, "episode_reward_mean": -4.051871657754011, "episode_len_mean": 20.796791443850267, "episodes_this_iter": 187, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.6000000000000005, -10.7, -3.7000000000000006, -3.8000000000000007, -3.900000000000001, -3.6000000000000005, -3.800000000000001, -12.7, -10.6, -4.100000000000001, -3.8000000000000007, -3.9000000000000012, -3.900000000000001, -3.700000000000001, -3.800000000000001, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -3.800000000000001, -3.700000000000001, -3.800000000000001, -4.000000000000002, -3.6000000000000005, -4.100000000000001, -3.900000000000001, -3.600000000000001, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -3.8000000000000007, -4.1000000000000005, -4.200000000000001, -4.200000000000001, -4.100000000000001, -3.700000000000001, -4.200000000000001, -4.200000000000001, -3.700000000000001, -3.900000000000001, -3.800000000000001, -3.8000000000000007, -3.600000000000001, -3.900000000000001, -4.000000000000002, -3.7000000000000015, -3.8000000000000007, -3.700000000000001, -3.700000000000001, -3.8000000000000007, -3.9000000000000012, -3.800000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.9000000000000004, -3.9000000000000012, -3.600000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.9000000000000012, -4.200000000000001, -3.900000000000001, -3.400000000000001, -4.1000000000000005, -3.900000000000001, -4.100000000000001, -4.100000000000001, -3.700000000000001, -3.400000000000001, -3.800000000000001, -3.9000000000000012, -3.9000000000000017, -4.100000000000001, -4.300000000000001, -4.100000000000001, -3.500000000000001, -4.100000000000001, -3.9000000000000012, -3.800000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -3.700000000000001, -4.000000000000002, -11.7, -4.200000000000001, -3.9000000000000012, -4.000000000000001, -3.6000000000000005, -4.000000000000002, -3.8000000000000007, -3.9000000000000012, -4.200000000000001, -3.8000000000000007, -3.7000000000000006, -3.700000000000001, -4.200000000000001, -3.8000000000000007, -3.800000000000001, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -3.800000000000001, -4.000000000000002, -3.8000000000000003, -4.000000000000002, -3.6000000000000005, -3.8000000000000016, -3.8000000000000007, -3.9000000000000012, -4.100000000000001, -3.9000000000000012, -3.8000000000000007, -3.7000000000000006, -4.300000000000001, -4.000000000000002, -3.5000000000000004, -3.700000000000001, -4.100000000000001, -3.800000000000001, -4.200000000000001, -3.9000000000000012, -3.8000000000000007, -3.600000000000001, -3.8000000000000007, -4.200000000000001, -3.6, -3.7000000000000006, -3.900000000000001, -3.8000000000000007, -3.8000000000000003, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -3.7000000000000006, -4.200000000000001, -4.1000000000000005, -3.900000000000001, -3.800000000000001, -3.900000000000001, -4.000000000000001, -4.1000000000000005, -3.8000000000000007, -4.000000000000002, -4.000000000000001, -3.6000000000000005, -3.9000000000000012, -4.0, -3.900000000000001, -3.900000000000001, -4.200000000000001, -3.9000000000000012, -4.0, -3.7000000000000006, -3.700000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.700000000000001, -3.700000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.1000000000000005, -4.000000000000001, -3.900000000000001, -4.200000000000001, -3.8000000000000007], "episode_lengths": [21, 7, 21, 21, 21, 21, 21, 19, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.640821133107375, "mean_inference_ms": 18.14489179700432, "mean_action_processing_ms": 0.9388437404355177, "mean_env_wait_ms": 1.5787237648414614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07215821169276926, "StateBufferConnector_ms": 0.009453870395925594, "ViewRequirementAgentConnector_ms": 0.13408125403093143}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 452000, "num_agent_steps_trained": 452000, "num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 452000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 452000, "timers": {"training_iteration_time_ms": 173533.969, "load_time_ms": 1.181, "load_throughput": 3386189.803, "learn_time_ms": 172583.181, "learn_throughput": 23.177, "synch_weights_time_ms": 168.03}, "counters": {"num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 452000, "num_agent_steps_trained": 452000}, "done": false, "episodes_total": 22914, "training_iteration": 113, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_02-18-36", "timestamp": 1680826716, "time_this_iter_s": 173.509530544281, "time_total_s": 19377.51388502121, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01477ae670>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7effc01340d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 19377.51388502121, "timesteps_since_restore": 0, "iterations_since_restore": 113, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.353441295546559, "ram_util_percent": 24.297165991902844}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.34493822256724, "cur_kl_coeff": 9.36284468910567, "cur_lr": 0.01, "total_loss": 0.44481607276185225, "policy_loss": 0.007835973061180564, "vf_loss": 0.22974879204906443, "vf_explained_var": 0.7607762964822913, "kl": 0.02213337075131725, "entropy": 2.9414185649605207, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 105555.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "sampler_results": {"episode_reward_max": -3.500000000000001, "episode_reward_min": -10.7, "episode_reward_mean": -3.955154639175258, "episode_len_mean": 20.84536082474227, "episode_media": {}, "episodes_this_iter": 194, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.9000000000000004, -3.500000000000001, -3.7000000000000006, -3.9000000000000012, -3.900000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.7000000000000006, -10.4, -3.800000000000001, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -4.1000000000000005, -3.9000000000000012, -4.200000000000001, -3.900000000000001, -3.700000000000001, -4.000000000000002, -3.900000000000001, -3.8000000000000003, -3.700000000000001, -3.700000000000001, -3.8000000000000007, -3.6000000000000005, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -4.000000000000002, -3.800000000000001, -3.9000000000000004, -3.9000000000000004, -4.000000000000001, -3.9000000000000004, -3.900000000000001, -4.000000000000001, -3.9000000000000012, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.7, -4.000000000000001, -3.900000000000001, -3.6000000000000005, -3.700000000000001, -3.600000000000001, -3.7000000000000006, -3.8000000000000007, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000002, -4.200000000000001, -3.9000000000000012, -4.000000000000001, -3.6000000000000005, -3.900000000000001, -3.900000000000001, -3.800000000000001, -3.700000000000001, -3.500000000000001, -3.900000000000001, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.9000000000000012, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000001, -3.900000000000001, -3.7000000000000006, -3.8000000000000003, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000002, -4.200000000000001, -4.000000000000002, -4.200000000000001, -3.6000000000000005, -3.8000000000000007, -3.9000000000000012, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -3.600000000000001, -3.900000000000001, -3.9000000000000004, -3.8000000000000007, -3.8000000000000007, -3.9000000000000012, -10.7, -3.7000000000000006, -3.800000000000001, -3.8000000000000007, -3.800000000000001, -3.800000000000001, -4.000000000000001, -3.900000000000001, -3.7, -3.7000000000000006, -4.300000000000001, -3.900000000000001, -4.200000000000001, -3.8000000000000007, -3.600000000000001, -3.9000000000000012, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -3.9000000000000012, -4.000000000000001, -4.000000000000002, -3.600000000000001, -3.900000000000001, -3.700000000000001, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -3.700000000000001, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -3.900000000000001, -3.6000000000000005, -4.100000000000001, -4.200000000000001, -4.100000000000001, -3.8000000000000007, -3.6000000000000005, -4.0, -3.9000000000000012, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.7000000000000006, -3.700000000000001, -4.100000000000001, -3.900000000000001, -3.700000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.6000000000000005, -3.700000000000001, -4.000000000000001, -3.800000000000001, -3.9000000000000012, -3.8000000000000007, -3.9000000000000004, -3.9000000000000012, -4.000000000000001, -3.7000000000000006, -4.000000000000002, -3.8000000000000007, -3.7000000000000006, -4.100000000000001, -3.900000000000001, -3.800000000000001, -4.200000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -3.8000000000000007, -3.900000000000001, -4.1000000000000005, -3.8000000000000003, -4.000000000000001, -3.600000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.9000000000000012], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.640698613401403, "mean_inference_ms": 18.13709747669687, "mean_action_processing_ms": 0.9385943528618892, "mean_env_wait_ms": 1.578255503828394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07133655941363462, "StateBufferConnector_ms": 0.009448749502909552, "ViewRequirementAgentConnector_ms": 0.13025753276864277}}, "episode_reward_max": -3.500000000000001, "episode_reward_min": -10.7, "episode_reward_mean": -3.955154639175258, "episode_len_mean": 20.84536082474227, "episodes_this_iter": 194, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.9000000000000004, -3.500000000000001, -3.7000000000000006, -3.9000000000000012, -3.900000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.7000000000000006, -10.4, -3.800000000000001, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -4.1000000000000005, -3.9000000000000012, -4.200000000000001, -3.900000000000001, -3.700000000000001, -4.000000000000002, -3.900000000000001, -3.8000000000000003, -3.700000000000001, -3.700000000000001, -3.8000000000000007, -3.6000000000000005, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -4.000000000000002, -3.800000000000001, -3.9000000000000004, -3.9000000000000004, -4.000000000000001, -3.9000000000000004, -3.900000000000001, -4.000000000000001, -3.9000000000000012, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.7, -4.000000000000001, -3.900000000000001, -3.6000000000000005, -3.700000000000001, -3.600000000000001, -3.7000000000000006, -3.8000000000000007, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000002, -4.200000000000001, -3.9000000000000012, -4.000000000000001, -3.6000000000000005, -3.900000000000001, -3.900000000000001, -3.800000000000001, -3.700000000000001, -3.500000000000001, -3.900000000000001, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.9000000000000012, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000001, -3.900000000000001, -3.7000000000000006, -3.8000000000000003, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000002, -4.200000000000001, -4.000000000000002, -4.200000000000001, -3.6000000000000005, -3.8000000000000007, -3.9000000000000012, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -3.600000000000001, -3.900000000000001, -3.9000000000000004, -3.8000000000000007, -3.8000000000000007, -3.9000000000000012, -10.7, -3.7000000000000006, -3.800000000000001, -3.8000000000000007, -3.800000000000001, -3.800000000000001, -4.000000000000001, -3.900000000000001, -3.7, -3.7000000000000006, -4.300000000000001, -3.900000000000001, -4.200000000000001, -3.8000000000000007, -3.600000000000001, -3.9000000000000012, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -3.9000000000000012, -4.000000000000001, -4.000000000000002, -3.600000000000001, -3.900000000000001, -3.700000000000001, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -3.700000000000001, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -3.900000000000001, -3.6000000000000005, -4.100000000000001, -4.200000000000001, -4.100000000000001, -3.8000000000000007, -3.6000000000000005, -4.0, -3.9000000000000012, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.7000000000000006, -3.700000000000001, -4.100000000000001, -3.900000000000001, -3.700000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.6000000000000005, -3.700000000000001, -4.000000000000001, -3.800000000000001, -3.9000000000000012, -3.8000000000000007, -3.9000000000000004, -3.9000000000000012, -4.000000000000001, -3.7000000000000006, -4.000000000000002, -3.8000000000000007, -3.7000000000000006, -4.100000000000001, -3.900000000000001, -3.800000000000001, -4.200000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -3.8000000000000007, -3.900000000000001, -4.1000000000000005, -3.8000000000000003, -4.000000000000001, -3.600000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.9000000000000012], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.640698613401403, "mean_inference_ms": 18.13709747669687, "mean_action_processing_ms": 0.9385943528618892, "mean_env_wait_ms": 1.578255503828394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07133655941363462, "StateBufferConnector_ms": 0.009448749502909552, "ViewRequirementAgentConnector_ms": 0.13025753276864277}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 456000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 456000, "timers": {"training_iteration_time_ms": 173629.221, "load_time_ms": 1.175, "load_throughput": 3404743.892, "learn_time_ms": 172680.814, "learn_throughput": 23.164, "synch_weights_time_ms": 165.677}, "counters": {"num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "done": false, "episodes_total": 23108, "training_iteration": 114, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_02-21-29", "timestamp": 1680826889, "time_this_iter_s": 173.5697431564331, "time_total_s": 19551.083628177643, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476d7b50>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7effc0134790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 19551.083628177643, "timesteps_since_restore": 0, "iterations_since_restore": 114, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.442105263157896, "ram_util_percent": 24.287044534412964}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.432775010857531, "cur_kl_coeff": 14.044267033658507, "cur_lr": 0.01, "total_loss": 0.9689020193232003, "policy_loss": 0.0032289302136789084, "vf_loss": 0.2262719144664144, "vf_explained_var": 0.6971740133018904, "kl": 0.052647902025911276, "entropy": 2.9218612473498107, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 106485.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_agent_steps_sampled": 460000, "num_agent_steps_trained": 460000}, "sampler_results": {"episode_reward_max": -3.5000000000000004, "episode_reward_min": -11.3, "episode_reward_mean": -4.031794871794872, "episode_len_mean": 20.594871794871796, "episode_media": {}, "episodes_this_iter": 195, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.9000000000000012, -3.800000000000001, -10.4, -3.700000000000001, -4.000000000000002, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -11.3, -4.0, -3.8000000000000007, -10.2, -4.000000000000001, -3.800000000000001, -3.6000000000000005, -3.6000000000000005, -4.000000000000001, -3.8000000000000007, -3.9000000000000012, -10.4, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -3.7000000000000006, -3.7000000000000006, -3.900000000000001, -3.8000000000000003, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -4.100000000000001, -4.0, -3.900000000000001, -3.800000000000001, -3.8000000000000007, -3.7000000000000006, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -3.700000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -4.0, -4.0, -3.8000000000000003, -4.000000000000001, -4.1000000000000005, -3.900000000000001, -3.800000000000001, -3.8000000000000007, -3.7000000000000006, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -3.700000000000001, -3.8000000000000007, -4.200000000000001, -3.900000000000001, -3.8000000000000007, -3.9000000000000004, -3.9000000000000012, -4.200000000000001, -3.600000000000001, -4.200000000000001, -3.9000000000000012, -4.000000000000001, -4.200000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000002, -3.7000000000000006, -3.7000000000000006, -3.600000000000001, -3.900000000000001, -3.5000000000000004, -4.000000000000001, -3.800000000000001, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -3.600000000000001, -3.900000000000001, -3.800000000000001, -3.9000000000000012, -3.7000000000000006, -3.9000000000000012, -10.4, -3.8000000000000007, -3.5000000000000004, -3.800000000000001, -3.6000000000000005, -3.7000000000000006, -3.700000000000001, -4.200000000000001, -3.8000000000000007, -3.8000000000000007, -3.700000000000001, -3.7000000000000006, -3.5000000000000004, -3.7000000000000006, -3.7000000000000006, -3.900000000000001, -4.100000000000001, -3.6000000000000005, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.8000000000000003, -3.6, -3.8000000000000003, -3.900000000000001, -3.9000000000000012, -3.6000000000000005, -4.300000000000001, -3.8000000000000003, -3.7000000000000006, -3.7000000000000006, -3.9000000000000012, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -4.100000000000001, -3.8000000000000007, -3.9000000000000012, -4.1000000000000005, -3.8000000000000007, -4.200000000000001, -4.000000000000001, -3.700000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -3.700000000000001, -3.900000000000001, -3.800000000000001, -3.8000000000000003, -3.9000000000000004, -3.7000000000000006, -3.7000000000000006, -4.100000000000001, -3.8000000000000007, -3.9000000000000004, -3.8000000000000007, -3.500000000000001, -3.900000000000001, -3.9000000000000012, -3.800000000000001, -3.800000000000001, -3.900000000000001, -4.100000000000001, -3.800000000000001, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -4.0, -3.800000000000001, -3.600000000000001, -3.8000000000000007, -3.700000000000001, -3.7000000000000006, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.9000000000000012, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -3.9000000000000012, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.600000000000001, -4.100000000000001, -3.800000000000001, -4.0, -4.000000000000001, -3.7000000000000006, -3.900000000000001, -4.000000000000001], "episode_lengths": [21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.639168596648686, "mean_inference_ms": 18.135519818054835, "mean_action_processing_ms": 0.9382781489957419, "mean_env_wait_ms": 1.5791306437057497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07914653191199669, "StateBufferConnector_ms": 0.010603513473119492, "ViewRequirementAgentConnector_ms": 0.14532052553617036}}, "episode_reward_max": -3.5000000000000004, "episode_reward_min": -11.3, "episode_reward_mean": -4.031794871794872, "episode_len_mean": 20.594871794871796, "episodes_this_iter": 195, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.9000000000000012, -3.800000000000001, -10.4, -3.700000000000001, -4.000000000000002, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -11.3, -4.0, -3.8000000000000007, -10.2, -4.000000000000001, -3.800000000000001, -3.6000000000000005, -3.6000000000000005, -4.000000000000001, -3.8000000000000007, -3.9000000000000012, -10.4, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -3.7000000000000006, -3.7000000000000006, -3.900000000000001, -3.8000000000000003, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -4.100000000000001, -4.0, -3.900000000000001, -3.800000000000001, -3.8000000000000007, -3.7000000000000006, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -3.700000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -4.0, -4.0, -3.8000000000000003, -4.000000000000001, -4.1000000000000005, -3.900000000000001, -3.800000000000001, -3.8000000000000007, -3.7000000000000006, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -3.700000000000001, -3.8000000000000007, -4.200000000000001, -3.900000000000001, -3.8000000000000007, -3.9000000000000004, -3.9000000000000012, -4.200000000000001, -3.600000000000001, -4.200000000000001, -3.9000000000000012, -4.000000000000001, -4.200000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000002, -3.7000000000000006, -3.7000000000000006, -3.600000000000001, -3.900000000000001, -3.5000000000000004, -4.000000000000001, -3.800000000000001, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -3.600000000000001, -3.900000000000001, -3.800000000000001, -3.9000000000000012, -3.7000000000000006, -3.9000000000000012, -10.4, -3.8000000000000007, -3.5000000000000004, -3.800000000000001, -3.6000000000000005, -3.7000000000000006, -3.700000000000001, -4.200000000000001, -3.8000000000000007, -3.8000000000000007, -3.700000000000001, -3.7000000000000006, -3.5000000000000004, -3.7000000000000006, -3.7000000000000006, -3.900000000000001, -4.100000000000001, -3.6000000000000005, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.8000000000000003, -3.6, -3.8000000000000003, -3.900000000000001, -3.9000000000000012, -3.6000000000000005, -4.300000000000001, -3.8000000000000003, -3.7000000000000006, -3.7000000000000006, -3.9000000000000012, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -4.100000000000001, -3.8000000000000007, -3.9000000000000012, -4.1000000000000005, -3.8000000000000007, -4.200000000000001, -4.000000000000001, -3.700000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -3.700000000000001, -3.900000000000001, -3.800000000000001, -3.8000000000000003, -3.9000000000000004, -3.7000000000000006, -3.7000000000000006, -4.100000000000001, -3.8000000000000007, -3.9000000000000004, -3.8000000000000007, -3.500000000000001, -3.900000000000001, -3.9000000000000012, -3.800000000000001, -3.800000000000001, -3.900000000000001, -4.100000000000001, -3.800000000000001, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -4.0, -3.800000000000001, -3.600000000000001, -3.8000000000000007, -3.700000000000001, -3.7000000000000006, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.9000000000000012, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -3.9000000000000012, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.600000000000001, -4.100000000000001, -3.800000000000001, -4.0, -4.000000000000001, -3.7000000000000006, -3.900000000000001, -4.000000000000001], "episode_lengths": [21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.639168596648686, "mean_inference_ms": 18.135519818054835, "mean_action_processing_ms": 0.9382781489957419, "mean_env_wait_ms": 1.5791306437057497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07914653191199669, "StateBufferConnector_ms": 0.010603513473119492, "ViewRequirementAgentConnector_ms": 0.14532052553617036}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 460000, "num_agent_steps_trained": 460000, "num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 460000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 460000, "timers": {"training_iteration_time_ms": 173706.786, "load_time_ms": 1.172, "load_throughput": 3412361.388, "learn_time_ms": 172753.803, "learn_throughput": 23.154, "synch_weights_time_ms": 164.655}, "counters": {"num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_agent_steps_sampled": 460000, "num_agent_steps_trained": 460000}, "done": false, "episodes_total": 23303, "training_iteration": 115, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_02-24-23", "timestamp": 1680827063, "time_this_iter_s": 174.01809215545654, "time_total_s": 19725.1017203331, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01472af1f0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7effc01345e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 19725.1017203331, "timesteps_since_restore": 0, "iterations_since_restore": 115, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.349392712550608, "ram_util_percent": 24.29959514170042}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.653319942310292, "cur_kl_coeff": 21.06640055048775, "cur_lr": 0.01, "total_loss": 1.487314238299125, "policy_loss": 0.003318239231243409, "vf_loss": 0.21887281329961875, "vf_explained_var": 0.7352791145283689, "kl": 0.06005407464490222, "entropy": 2.929617352895839, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 107415.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "sampler_results": {"episode_reward_max": -3.3000000000000007, "episode_reward_min": -11.3, "episode_reward_mean": -3.972105263157895, "episode_len_mean": 20.8, "episode_media": {}, "episodes_this_iter": 190, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.6000000000000005, -4.000000000000001, -3.7000000000000006, -4.1000000000000005, -4.000000000000001, -3.9000000000000012, -10.5, -3.8000000000000007, -10.8, -4.100000000000001, -3.7000000000000006, -4.000000000000002, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.700000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -4.000000000000002, -3.600000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.300000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -3.6000000000000005, -3.5000000000000004, -3.9000000000000012, -3.900000000000001, -3.900000000000001, -3.8000000000000003, -3.8000000000000007, -3.7000000000000006, -4.000000000000001, -4.200000000000001, -4.000000000000001, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -3.8000000000000007, -3.700000000000001, -3.7000000000000006, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -3.9000000000000012, -3.700000000000001, -3.900000000000001, -4.000000000000002, -3.8000000000000007, -4.100000000000001, -4.000000000000002, -3.8000000000000007, -4.300000000000001, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -3.8000000000000007, -3.700000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -3.7000000000000006, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -3.500000000000001, -3.900000000000001, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.7000000000000006, -3.900000000000001, -3.700000000000001, -3.8000000000000003, -3.9000000000000004, -3.600000000000001, -3.9000000000000012, -3.8000000000000003, -3.700000000000001, -4.000000000000001, -3.900000000000001, -3.9000000000000012, -3.9000000000000012, -4.000000000000002, -3.900000000000001, -3.800000000000001, -11.3, -3.900000000000001, -3.6000000000000005, -4.100000000000001, -3.8000000000000003, -3.6000000000000005, -4.000000000000001, -3.900000000000001, -4.000000000000002, -3.6000000000000005, -3.8000000000000007, -3.8000000000000007, -3.9000000000000012, -3.8000000000000007, -4.1000000000000005, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -3.7000000000000006, -3.6000000000000005, -3.8000000000000007, -4.0, -4.000000000000002, -3.8000000000000003, -4.000000000000001, -3.700000000000001, -3.700000000000001, -4.000000000000002, -3.700000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -3.9000000000000004, -3.700000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.7000000000000006, -3.7000000000000006, -4.000000000000001, -3.800000000000001, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -3.800000000000001, -3.8000000000000003, -4.100000000000001, -3.7000000000000006, -3.800000000000001, -3.8000000000000007, -4.000000000000002, -4.000000000000001, -4.200000000000001, -4.000000000000001, -3.7000000000000006, -3.700000000000001, -3.800000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -3.3000000000000007, -3.700000000000001, -3.700000000000001, -3.8000000000000007, -3.600000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.9000000000000004, -3.8000000000000007, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -3.700000000000001, -3.900000000000001, -3.700000000000001, -3.6000000000000005, -3.7000000000000006, -3.8000000000000003, -3.900000000000001, -4.1000000000000005, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.9000000000000012, -3.7000000000000006, -3.900000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 5, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.635018574099128, "mean_inference_ms": 18.1454019267104, "mean_action_processing_ms": 0.9383937296606456, "mean_env_wait_ms": 1.5777439521703567, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0725865364074707, "StateBufferConnector_ms": 0.0094788952877647, "ViewRequirementAgentConnector_ms": 0.13258984214381167}}, "episode_reward_max": -3.3000000000000007, "episode_reward_min": -11.3, "episode_reward_mean": -3.972105263157895, "episode_len_mean": 20.8, "episodes_this_iter": 190, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.6000000000000005, -4.000000000000001, -3.7000000000000006, -4.1000000000000005, -4.000000000000001, -3.9000000000000012, -10.5, -3.8000000000000007, -10.8, -4.100000000000001, -3.7000000000000006, -4.000000000000002, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.700000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -4.000000000000002, -3.600000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.300000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -3.6000000000000005, -3.5000000000000004, -3.9000000000000012, -3.900000000000001, -3.900000000000001, -3.8000000000000003, -3.8000000000000007, -3.7000000000000006, -4.000000000000001, -4.200000000000001, -4.000000000000001, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -3.8000000000000007, -3.700000000000001, -3.7000000000000006, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -3.9000000000000012, -3.700000000000001, -3.900000000000001, -4.000000000000002, -3.8000000000000007, -4.100000000000001, -4.000000000000002, -3.8000000000000007, -4.300000000000001, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -3.8000000000000007, -3.700000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -3.7000000000000006, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -3.500000000000001, -3.900000000000001, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.7000000000000006, -3.900000000000001, -3.700000000000001, -3.8000000000000003, -3.9000000000000004, -3.600000000000001, -3.9000000000000012, -3.8000000000000003, -3.700000000000001, -4.000000000000001, -3.900000000000001, -3.9000000000000012, -3.9000000000000012, -4.000000000000002, -3.900000000000001, -3.800000000000001, -11.3, -3.900000000000001, -3.6000000000000005, -4.100000000000001, -3.8000000000000003, -3.6000000000000005, -4.000000000000001, -3.900000000000001, -4.000000000000002, -3.6000000000000005, -3.8000000000000007, -3.8000000000000007, -3.9000000000000012, -3.8000000000000007, -4.1000000000000005, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -3.7000000000000006, -3.6000000000000005, -3.8000000000000007, -4.0, -4.000000000000002, -3.8000000000000003, -4.000000000000001, -3.700000000000001, -3.700000000000001, -4.000000000000002, -3.700000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -3.9000000000000004, -3.700000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.7000000000000006, -3.7000000000000006, -4.000000000000001, -3.800000000000001, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -3.800000000000001, -3.8000000000000003, -4.100000000000001, -3.7000000000000006, -3.800000000000001, -3.8000000000000007, -4.000000000000002, -4.000000000000001, -4.200000000000001, -4.000000000000001, -3.7000000000000006, -3.700000000000001, -3.800000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -3.3000000000000007, -3.700000000000001, -3.700000000000001, -3.8000000000000007, -3.600000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.9000000000000004, -3.8000000000000007, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -3.700000000000001, -3.900000000000001, -3.700000000000001, -3.6000000000000005, -3.7000000000000006, -3.8000000000000003, -3.900000000000001, -4.1000000000000005, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.9000000000000012, -3.7000000000000006, -3.900000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 5, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 12, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.635018574099128, "mean_inference_ms": 18.1454019267104, "mean_action_processing_ms": 0.9383937296606456, "mean_env_wait_ms": 1.5777439521703567, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0725865364074707, "StateBufferConnector_ms": 0.0094788952877647, "ViewRequirementAgentConnector_ms": 0.13258984214381167}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 464000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 464000, "timers": {"training_iteration_time_ms": 173858.858, "load_time_ms": 1.177, "load_throughput": 3397779.533, "learn_time_ms": 172899.746, "learn_throughput": 23.135, "synch_weights_time_ms": 165.61}, "counters": {"num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "done": false, "episodes_total": 23493, "training_iteration": 116, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_02-27-18", "timestamp": 1680827238, "time_this_iter_s": 174.5194628238678, "time_total_s": 19899.621183156967, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01473e20d0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7effc00b58b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 19899.621183156967, "timesteps_since_restore": 0, "iterations_since_restore": 116, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.604032258064516, "ram_util_percent": 24.30120967741936}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.366230680609263, "cur_kl_coeff": 31.599600825731628, "cur_lr": 0.01, "total_loss": 0.6273114854169469, "policy_loss": -0.00017138631859173377, "vf_loss": 0.2750961745698606, "vf_explained_var": 0.7221651617557772, "kl": 0.011151618406704504, "entropy": 2.9719071826627177, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 108345.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "sampler_results": {"episode_reward_max": -3.400000000000001, "episode_reward_min": -10.6, "episode_reward_mean": -4.037628865979382, "episode_len_mean": 20.582474226804123, "episode_media": {}, "episodes_this_iter": 194, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.5, -3.700000000000001, -3.8000000000000003, -3.600000000000001, -3.900000000000001, -4.000000000000002, -10.1, -4.0, -3.7, -3.900000000000001, -3.700000000000001, -3.900000000000001, -3.9000000000000012, -3.9000000000000012, -3.9000000000000012, -3.8000000000000007, -3.900000000000001, -10.5, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.300000000000001, -3.400000000000001, -4.000000000000002, -3.800000000000001, -4.200000000000001, -3.8000000000000007, -4.200000000000001, -4.100000000000001, -3.6000000000000005, -3.800000000000001, -3.7000000000000006, -3.6000000000000005, -3.6000000000000005, -3.8000000000000003, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -3.600000000000001, -4.000000000000001, -3.900000000000001, -3.700000000000001, -3.6000000000000005, -4.100000000000001, -4.000000000000002, -3.5000000000000004, -4.000000000000002, -4.100000000000001, -4.000000000000002, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -3.800000000000001, -3.800000000000001, -3.700000000000001, -3.8000000000000007, -3.900000000000001, -3.800000000000001, -3.6000000000000005, -3.800000000000001, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -3.600000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.200000000000001, -3.8000000000000003, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -3.7, -4.000000000000001, -4.100000000000001, -3.600000000000001, -3.9000000000000012, -3.700000000000001, -3.7000000000000006, -3.700000000000001, -3.800000000000001, -4.300000000000002, -3.5000000000000004, -3.7000000000000006, -3.900000000000001, -4.100000000000001, -3.700000000000001, -3.8000000000000007, -3.900000000000001, -3.500000000000001, -3.8000000000000007, -3.900000000000001, -4.0, -3.7000000000000006, -3.900000000000001, -3.900000000000001, -3.500000000000001, -3.9000000000000012, -3.6000000000000005, -3.5000000000000004, -3.900000000000001, -3.8000000000000003, -4.100000000000001, -10.5, -3.8000000000000007, -3.8000000000000007, -10.6, -3.9000000000000004, -4.100000000000001, -3.7000000000000006, -4.400000000000001, -3.900000000000001, -3.9000000000000012, -3.600000000000001, -3.6000000000000005, -3.8000000000000007, -4.000000000000001, -3.800000000000001, -4.000000000000002, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -3.9000000000000012, -4.000000000000001, -4.300000000000001, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -4.000000000000001, -3.700000000000001, -4.000000000000001, -3.900000000000001, -4.200000000000001, -4.100000000000001, -3.900000000000001, -4.1000000000000005, -3.800000000000001, -4.1000000000000005, -3.800000000000001, -3.8000000000000007, -3.8000000000000007, -3.700000000000001, -3.900000000000001, -3.8000000000000003, -4.000000000000001, -3.7000000000000006, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -4.100000000000001, -3.800000000000001, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -3.600000000000001, -3.900000000000001, -3.600000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000002, -3.900000000000001, -4.0, -3.7000000000000006, -4.000000000000001, -3.8000000000000007, -4.300000000000001, -3.700000000000001, -3.7000000000000006, -4.000000000000001, -4.0, -4.200000000000001, -4.000000000000001, -3.7000000000000006, -3.8000000000000007, -3.8000000000000003, -3.800000000000001, -3.600000000000001, -4.100000000000001, -4.0], "episode_lengths": [5, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.636514986621869, "mean_inference_ms": 18.135481472444848, "mean_action_processing_ms": 0.9381715629500798, "mean_env_wait_ms": 1.5772687134506518, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0766274855308926, "StateBufferConnector_ms": 0.010840057097759443, "ViewRequirementAgentConnector_ms": 0.14389458390855298}}, "episode_reward_max": -3.400000000000001, "episode_reward_min": -10.6, "episode_reward_mean": -4.037628865979382, "episode_len_mean": 20.582474226804123, "episodes_this_iter": 194, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10.5, -3.700000000000001, -3.8000000000000003, -3.600000000000001, -3.900000000000001, -4.000000000000002, -10.1, -4.0, -3.7, -3.900000000000001, -3.700000000000001, -3.900000000000001, -3.9000000000000012, -3.9000000000000012, -3.9000000000000012, -3.8000000000000007, -3.900000000000001, -10.5, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.300000000000001, -3.400000000000001, -4.000000000000002, -3.800000000000001, -4.200000000000001, -3.8000000000000007, -4.200000000000001, -4.100000000000001, -3.6000000000000005, -3.800000000000001, -3.7000000000000006, -3.6000000000000005, -3.6000000000000005, -3.8000000000000003, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -3.600000000000001, -4.000000000000001, -3.900000000000001, -3.700000000000001, -3.6000000000000005, -4.100000000000001, -4.000000000000002, -3.5000000000000004, -4.000000000000002, -4.100000000000001, -4.000000000000002, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -3.800000000000001, -3.800000000000001, -3.700000000000001, -3.8000000000000007, -3.900000000000001, -3.800000000000001, -3.6000000000000005, -3.800000000000001, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -3.600000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.200000000000001, -3.8000000000000003, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -3.7, -4.000000000000001, -4.100000000000001, -3.600000000000001, -3.9000000000000012, -3.700000000000001, -3.7000000000000006, -3.700000000000001, -3.800000000000001, -4.300000000000002, -3.5000000000000004, -3.7000000000000006, -3.900000000000001, -4.100000000000001, -3.700000000000001, -3.8000000000000007, -3.900000000000001, -3.500000000000001, -3.8000000000000007, -3.900000000000001, -4.0, -3.7000000000000006, -3.900000000000001, -3.900000000000001, -3.500000000000001, -3.9000000000000012, -3.6000000000000005, -3.5000000000000004, -3.900000000000001, -3.8000000000000003, -4.100000000000001, -10.5, -3.8000000000000007, -3.8000000000000007, -10.6, -3.9000000000000004, -4.100000000000001, -3.7000000000000006, -4.400000000000001, -3.900000000000001, -3.9000000000000012, -3.600000000000001, -3.6000000000000005, -3.8000000000000007, -4.000000000000001, -3.800000000000001, -4.000000000000002, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -3.9000000000000012, -4.000000000000001, -4.300000000000001, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -4.000000000000001, -3.700000000000001, -4.000000000000001, -3.900000000000001, -4.200000000000001, -4.100000000000001, -3.900000000000001, -4.1000000000000005, -3.800000000000001, -4.1000000000000005, -3.800000000000001, -3.8000000000000007, -3.8000000000000007, -3.700000000000001, -3.900000000000001, -3.8000000000000003, -4.000000000000001, -3.7000000000000006, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -4.100000000000001, -3.800000000000001, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -3.600000000000001, -3.900000000000001, -3.600000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000002, -3.900000000000001, -4.0, -3.7000000000000006, -4.000000000000001, -3.8000000000000007, -4.300000000000001, -3.700000000000001, -3.7000000000000006, -4.000000000000001, -4.0, -4.200000000000001, -4.000000000000001, -3.7000000000000006, -3.8000000000000007, -3.8000000000000003, -3.800000000000001, -3.600000000000001, -4.100000000000001, -4.0], "episode_lengths": [5, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.636514986621869, "mean_inference_ms": 18.135481472444848, "mean_action_processing_ms": 0.9381715629500798, "mean_env_wait_ms": 1.5772687134506518, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0766274855308926, "StateBufferConnector_ms": 0.010840057097759443, "ViewRequirementAgentConnector_ms": 0.14389458390855298}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 468000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 468000, "timers": {"training_iteration_time_ms": 173890.697, "load_time_ms": 1.17, "load_throughput": 3418479.971, "learn_time_ms": 172927.237, "learn_throughput": 23.131, "synch_weights_time_ms": 167.761}, "counters": {"num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "done": false, "episodes_total": 23687, "training_iteration": 117, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_02-30-12", "timestamp": 1680827412, "time_this_iter_s": 173.75736594200134, "time_total_s": 20073.37854909897, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01474230d0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7effc00b5310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 20073.37854909897, "timesteps_since_restore": 0, "iterations_since_restore": 117, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.428744939271255, "ram_util_percent": 23.93522267206478}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.22522322984152, "cur_kl_coeff": 31.599600825731628, "cur_lr": 0.01, "total_loss": 0.4336964819139691, "policy_loss": -0.003880808591061542, "vf_loss": 0.16858688263643173, "vf_explained_var": 0.7563274927677647, "kl": 0.00851246196970967, "entropy": 3.000819471574599, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 109275.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 472000, "num_agent_steps_trained": 472000}, "sampler_results": {"episode_reward_max": -3.5000000000000004, "episode_reward_min": -11.2, "episode_reward_mean": -3.9171875000000007, "episode_len_mean": 20.854166666666668, "episode_media": {}, "episodes_this_iter": 192, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.7000000000000006, -4.100000000000001, -3.800000000000001, -4.000000000000001, -3.8000000000000007, -3.9000000000000012, -3.800000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.7000000000000006, -4.000000000000002, -10.2, -3.900000000000001, -3.800000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000002, -3.800000000000001, -3.600000000000001, -3.900000000000001, -3.700000000000001, -3.800000000000001, -3.6000000000000005, -3.7000000000000006, -3.9000000000000012, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.800000000000001, -3.900000000000001, -3.9000000000000012, -3.9000000000000012, -3.9000000000000012, -3.8000000000000007, -4.000000000000001, -4.000000000000002, -3.6000000000000005, -3.600000000000001, -3.8000000000000007, -3.8000000000000003, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -4.300000000000001, -3.7000000000000006, -3.8000000000000007, -3.8000000000000007, -3.9000000000000004, -3.900000000000001, -3.7000000000000006, -4.100000000000001, -4.100000000000001, -3.700000000000001, -3.9000000000000004, -3.800000000000001, -3.800000000000001, -3.900000000000001, -3.500000000000001, -3.800000000000001, -3.8000000000000007, -3.6000000000000005, -3.7000000000000006, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -3.7000000000000006, -4.100000000000001, -4.000000000000002, -4.200000000000001, -3.8000000000000007, -3.8000000000000007, -4.300000000000001, -3.500000000000001, -3.900000000000001, -3.9000000000000012, -3.9000000000000012, -3.5000000000000004, -4.000000000000002, -3.8000000000000007, -3.6000000000000005, -3.800000000000001, -4.0, -3.800000000000001, -3.8000000000000007, -3.9000000000000012, -3.500000000000001, -3.800000000000001, -3.700000000000001, -3.900000000000001, -11.2, -3.900000000000001, -3.8000000000000003, -3.7000000000000006, -3.700000000000001, -4.000000000000002, -3.9000000000000012, -3.700000000000001, -3.800000000000001, -3.7000000000000006, -3.6000000000000005, -3.800000000000001, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -3.8000000000000007, -3.800000000000001, -3.6000000000000005, -3.900000000000001, -3.7000000000000006, -3.700000000000001, -3.900000000000001, -3.5000000000000004, -3.900000000000001, -4.000000000000001, -3.700000000000001, -3.800000000000001, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -4.100000000000001, -3.8000000000000003, -4.000000000000001, -3.8000000000000007, -3.800000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -3.6000000000000005, -4.100000000000001, -3.700000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.700000000000001, -3.8000000000000003, -3.700000000000001, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -3.9000000000000012, -3.7000000000000006, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -3.700000000000001, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -3.800000000000001, -3.900000000000001, -3.8000000000000007, -3.7, -3.7000000000000006, -3.700000000000001, -3.500000000000001, -3.800000000000001, -4.100000000000001, -4.300000000000001, -3.9000000000000012, -4.200000000000001, -3.800000000000001, -3.8000000000000007, -3.900000000000001, -3.7000000000000006, -4.1000000000000005, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -3.5000000000000004, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -3.800000000000001, -3.9000000000000004, -3.9000000000000012, -4.0, -3.6000000000000005, -3.8000000000000007], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.630259635462593, "mean_inference_ms": 18.137720497263263, "mean_action_processing_ms": 0.9386659906599863, "mean_env_wait_ms": 1.57821409432679, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0734062244494756, "StateBufferConnector_ms": 0.009536991516749064, "ViewRequirementAgentConnector_ms": 0.13605145116647085}}, "episode_reward_max": -3.5000000000000004, "episode_reward_min": -11.2, "episode_reward_mean": -3.9171875000000007, "episode_len_mean": 20.854166666666668, "episodes_this_iter": 192, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.7000000000000006, -4.100000000000001, -3.800000000000001, -4.000000000000001, -3.8000000000000007, -3.9000000000000012, -3.800000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.7000000000000006, -4.000000000000002, -10.2, -3.900000000000001, -3.800000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000002, -3.800000000000001, -3.600000000000001, -3.900000000000001, -3.700000000000001, -3.800000000000001, -3.6000000000000005, -3.7000000000000006, -3.9000000000000012, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.800000000000001, -3.900000000000001, -3.9000000000000012, -3.9000000000000012, -3.9000000000000012, -3.8000000000000007, -4.000000000000001, -4.000000000000002, -3.6000000000000005, -3.600000000000001, -3.8000000000000007, -3.8000000000000003, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -4.300000000000001, -3.7000000000000006, -3.8000000000000007, -3.8000000000000007, -3.9000000000000004, -3.900000000000001, -3.7000000000000006, -4.100000000000001, -4.100000000000001, -3.700000000000001, -3.9000000000000004, -3.800000000000001, -3.800000000000001, -3.900000000000001, -3.500000000000001, -3.800000000000001, -3.8000000000000007, -3.6000000000000005, -3.7000000000000006, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -3.7000000000000006, -4.100000000000001, -4.000000000000002, -4.200000000000001, -3.8000000000000007, -3.8000000000000007, -4.300000000000001, -3.500000000000001, -3.900000000000001, -3.9000000000000012, -3.9000000000000012, -3.5000000000000004, -4.000000000000002, -3.8000000000000007, -3.6000000000000005, -3.800000000000001, -4.0, -3.800000000000001, -3.8000000000000007, -3.9000000000000012, -3.500000000000001, -3.800000000000001, -3.700000000000001, -3.900000000000001, -11.2, -3.900000000000001, -3.8000000000000003, -3.7000000000000006, -3.700000000000001, -4.000000000000002, -3.9000000000000012, -3.700000000000001, -3.800000000000001, -3.7000000000000006, -3.6000000000000005, -3.800000000000001, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -3.8000000000000007, -3.800000000000001, -3.6000000000000005, -3.900000000000001, -3.7000000000000006, -3.700000000000001, -3.900000000000001, -3.5000000000000004, -3.900000000000001, -4.000000000000001, -3.700000000000001, -3.800000000000001, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -4.100000000000001, -3.8000000000000003, -4.000000000000001, -3.8000000000000007, -3.800000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -3.6000000000000005, -4.100000000000001, -3.700000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.700000000000001, -3.8000000000000003, -3.700000000000001, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -3.9000000000000012, -3.7000000000000006, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -3.700000000000001, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -3.800000000000001, -3.900000000000001, -3.8000000000000007, -3.7, -3.7000000000000006, -3.700000000000001, -3.500000000000001, -3.800000000000001, -4.100000000000001, -4.300000000000001, -3.9000000000000012, -4.200000000000001, -3.800000000000001, -3.8000000000000007, -3.900000000000001, -3.7000000000000006, -4.1000000000000005, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -3.5000000000000004, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -3.800000000000001, -3.9000000000000004, -3.9000000000000012, -4.0, -3.6000000000000005, -3.8000000000000007], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.630259635462593, "mean_inference_ms": 18.137720497263263, "mean_action_processing_ms": 0.9386659906599863, "mean_env_wait_ms": 1.57821409432679, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0734062244494756, "StateBufferConnector_ms": 0.009536991516749064, "ViewRequirementAgentConnector_ms": 0.13605145116647085}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 472000, "num_agent_steps_trained": 472000, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 472000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 472000, "timers": {"training_iteration_time_ms": 173961.726, "load_time_ms": 1.168, "load_throughput": 3426089.158, "learn_time_ms": 172993.201, "learn_throughput": 23.122, "synch_weights_time_ms": 168.609}, "counters": {"num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 472000, "num_agent_steps_trained": 472000}, "done": false, "episodes_total": 23879, "training_iteration": 118, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_02-33-06", "timestamp": 1680827586, "time_this_iter_s": 173.80664825439453, "time_total_s": 20247.185197353363, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476597f0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7effc0095430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 20247.185197353363, "timesteps_since_restore": 0, "iterations_since_restore": 118, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.356451612903226, "ram_util_percent": 23.883064516129032}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.363100596397153, "cur_kl_coeff": 31.599600825731628, "cur_lr": 0.01, "total_loss": 0.9279578887527028, "policy_loss": 0.002516108019257425, "vf_loss": 0.3083713177791847, "vf_explained_var": 0.7312827713386987, "kl": 0.019527792421818, "entropy": 2.986908000515353, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 110205.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 476000, "num_agent_steps_trained": 476000}, "sampler_results": {"episode_reward_max": -3.4000000000000004, "episode_reward_min": -11.8, "episode_reward_mean": -4.030208333333334, "episode_len_mean": 20.645833333333332, "episode_media": {}, "episodes_this_iter": 192, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.100000000000001, -4.000000000000001, -3.700000000000001, -3.700000000000001, -3.900000000000001, -3.9000000000000004, -3.600000000000001, -10.4, -3.5000000000000004, -4.200000000000001, -3.800000000000001, -3.4000000000000004, -4.000000000000001, -3.5, -4.200000000000001, -10.5, -4.100000000000001, -10.8, -10.4, -3.800000000000001, -3.6, -4.000000000000001, -3.900000000000001, -3.600000000000001, -3.900000000000001, -3.8000000000000007, -3.800000000000001, -4.000000000000001, -3.8000000000000007, -4.0, -3.900000000000001, -4.000000000000002, -3.8000000000000007, -3.600000000000001, -4.000000000000001, -4.100000000000001, -3.700000000000001, -3.8000000000000007, -4.000000000000001, -4.0, -3.800000000000001, -4.000000000000001, -4.000000000000002, -3.7000000000000006, -3.6000000000000005, -3.6000000000000005, -4.000000000000002, -3.900000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000002, -3.7000000000000006, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -3.8000000000000007, -3.600000000000001, -4.1000000000000005, -3.9000000000000004, -3.7000000000000006, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -3.700000000000001, -3.900000000000001, -3.6000000000000005, -3.900000000000001, -3.8000000000000007, -3.7000000000000006, -3.8000000000000007, -3.9000000000000012, -3.8000000000000007, -4.0, -4.1000000000000005, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -4.1000000000000005, -3.9000000000000012, -3.8000000000000007, -3.900000000000001, -3.500000000000001, -4.100000000000001, -3.600000000000001, -3.8000000000000003, -4.000000000000001, -3.900000000000001, -3.600000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000002, -3.700000000000001, -3.900000000000001, -3.800000000000001, -3.800000000000001, -4.100000000000001, -3.8000000000000007, -3.7000000000000006, -3.6000000000000005, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -3.700000000000001, -11.8, -3.9000000000000004, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -4.100000000000001, -4.000000000000002, -3.8000000000000003, -4.000000000000001, -3.600000000000001, -3.6000000000000005, -3.9000000000000012, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.9000000000000004, -3.7000000000000006, -3.700000000000001, -3.8000000000000007, -3.500000000000001, -3.700000000000001, -3.700000000000001, -4.100000000000001, -3.6000000000000005, -3.900000000000001, -3.900000000000001, -3.800000000000001, -4.000000000000001, -3.6000000000000005, -3.800000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -3.8000000000000007, -4.000000000000001, -3.700000000000001, -4.200000000000001, -3.9000000000000012, -3.900000000000001, -3.7000000000000006, -3.9000000000000012, -3.8000000000000007, -3.700000000000001, -3.7000000000000006, -3.800000000000001, -3.9000000000000012, -4.100000000000001, -3.800000000000001, -3.7000000000000006, -4.1000000000000005, -3.7, -3.6000000000000005, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.1000000000000005, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -3.7000000000000006, -3.600000000000001, -3.8000000000000007, -3.800000000000001, -3.8000000000000007, -4.100000000000001, -3.500000000000001, -3.6000000000000005, -3.9000000000000012, -3.9000000000000012, -4.100000000000001, -3.7000000000000006, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -3.700000000000001, -4.000000000000001, -3.9000000000000004, -3.5000000000000004, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.800000000000001, -3.700000000000001, -3.600000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 6, 21, 7, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.634330201792347, "mean_inference_ms": 18.15402346733453, "mean_action_processing_ms": 0.9388205539641151, "mean_env_wait_ms": 1.5811516428617942, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07636807858943939, "StateBufferConnector_ms": 0.009993587930997213, "ViewRequirementAgentConnector_ms": 0.13904087245464325}}, "episode_reward_max": -3.4000000000000004, "episode_reward_min": -11.8, "episode_reward_mean": -4.030208333333334, "episode_len_mean": 20.645833333333332, "episodes_this_iter": 192, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.100000000000001, -4.000000000000001, -3.700000000000001, -3.700000000000001, -3.900000000000001, -3.9000000000000004, -3.600000000000001, -10.4, -3.5000000000000004, -4.200000000000001, -3.800000000000001, -3.4000000000000004, -4.000000000000001, -3.5, -4.200000000000001, -10.5, -4.100000000000001, -10.8, -10.4, -3.800000000000001, -3.6, -4.000000000000001, -3.900000000000001, -3.600000000000001, -3.900000000000001, -3.8000000000000007, -3.800000000000001, -4.000000000000001, -3.8000000000000007, -4.0, -3.900000000000001, -4.000000000000002, -3.8000000000000007, -3.600000000000001, -4.000000000000001, -4.100000000000001, -3.700000000000001, -3.8000000000000007, -4.000000000000001, -4.0, -3.800000000000001, -4.000000000000001, -4.000000000000002, -3.7000000000000006, -3.6000000000000005, -3.6000000000000005, -4.000000000000002, -3.900000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000002, -3.7000000000000006, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -3.8000000000000007, -3.600000000000001, -4.1000000000000005, -3.9000000000000004, -3.7000000000000006, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -3.700000000000001, -3.900000000000001, -3.6000000000000005, -3.900000000000001, -3.8000000000000007, -3.7000000000000006, -3.8000000000000007, -3.9000000000000012, -3.8000000000000007, -4.0, -4.1000000000000005, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -4.1000000000000005, -3.9000000000000012, -3.8000000000000007, -3.900000000000001, -3.500000000000001, -4.100000000000001, -3.600000000000001, -3.8000000000000003, -4.000000000000001, -3.900000000000001, -3.600000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000002, -3.700000000000001, -3.900000000000001, -3.800000000000001, -3.800000000000001, -4.100000000000001, -3.8000000000000007, -3.7000000000000006, -3.6000000000000005, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -3.700000000000001, -11.8, -3.9000000000000004, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -4.100000000000001, -4.000000000000002, -3.8000000000000003, -4.000000000000001, -3.600000000000001, -3.6000000000000005, -3.9000000000000012, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.9000000000000004, -3.7000000000000006, -3.700000000000001, -3.8000000000000007, -3.500000000000001, -3.700000000000001, -3.700000000000001, -4.100000000000001, -3.6000000000000005, -3.900000000000001, -3.900000000000001, -3.800000000000001, -4.000000000000001, -3.6000000000000005, -3.800000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -3.8000000000000007, -4.000000000000001, -3.700000000000001, -4.200000000000001, -3.9000000000000012, -3.900000000000001, -3.7000000000000006, -3.9000000000000012, -3.8000000000000007, -3.700000000000001, -3.7000000000000006, -3.800000000000001, -3.9000000000000012, -4.100000000000001, -3.800000000000001, -3.7000000000000006, -4.1000000000000005, -3.7, -3.6000000000000005, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.1000000000000005, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -3.7000000000000006, -3.600000000000001, -3.8000000000000007, -3.800000000000001, -3.8000000000000007, -4.100000000000001, -3.500000000000001, -3.6000000000000005, -3.9000000000000012, -3.9000000000000012, -4.100000000000001, -3.7000000000000006, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -3.700000000000001, -4.000000000000001, -3.9000000000000004, -3.5000000000000004, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.800000000000001, -3.700000000000001, -3.600000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 6, 21, 7, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.634330201792347, "mean_inference_ms": 18.15402346733453, "mean_action_processing_ms": 0.9388205539641151, "mean_env_wait_ms": 1.5811516428617942, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07636807858943939, "StateBufferConnector_ms": 0.009993587930997213, "ViewRequirementAgentConnector_ms": 0.13904087245464325}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 476000, "num_agent_steps_trained": 476000, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 476000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 476000, "timers": {"training_iteration_time_ms": 173974.587, "load_time_ms": 1.179, "load_throughput": 3391871.904, "learn_time_ms": 173013.71, "learn_throughput": 23.12, "synch_weights_time_ms": 164.645}, "counters": {"num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 476000, "num_agent_steps_trained": 476000}, "done": false, "episodes_total": 24071, "training_iteration": 119, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_02-36-00", "timestamp": 1680827760, "time_this_iter_s": 174.50770783424377, "time_total_s": 20421.692905187607, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01475a5700>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7effc00958b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 20421.692905187607, "timesteps_since_restore": 0, "iterations_since_restore": 119, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.525806451612903, "ram_util_percent": 23.724193548387095}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.587890441956059, "cur_kl_coeff": 31.599600825731628, "cur_lr": 0.01, "total_loss": 0.5739142940970519, "policy_loss": -0.002361385071630119, "vf_loss": 0.21785358436085203, "vf_explained_var": 0.7139895528234461, "kl": 0.01134261429354909, "entropy": 2.9382801901909614, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 111135.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "sampler_results": {"episode_reward_max": -3.4000000000000004, "episode_reward_min": -10.9, "episode_reward_mean": -3.924479166666668, "episode_len_mean": 20.859375, "episode_media": {}, "episodes_this_iter": 192, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.7000000000000006, -3.8000000000000007, -3.8000000000000007, -3.400000000000001, -3.900000000000001, -3.8000000000000007, -3.9000000000000012, -3.8000000000000003, -3.900000000000001, -3.9000000000000012, -3.900000000000001, -3.800000000000001, -4.100000000000001, -3.700000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000002, -3.700000000000001, -3.8000000000000007, -3.500000000000001, -3.700000000000001, -4.100000000000001, -3.500000000000001, -3.9000000000000012, -3.7000000000000006, -3.7000000000000006, -4.100000000000001, -3.900000000000001, -4.000000000000002, -3.7000000000000006, -3.7000000000000006, -3.600000000000001, -3.7000000000000006, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -3.7000000000000006, -3.7000000000000006, -3.6000000000000005, -4.100000000000001, -3.6000000000000005, -3.9000000000000004, -3.6000000000000005, -3.9000000000000012, -4.000000000000002, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000002, -3.9000000000000012, -3.700000000000001, -4.100000000000001, -3.9000000000000012, -3.8000000000000007, -3.700000000000001, -3.700000000000001, -3.700000000000001, -3.900000000000001, -3.800000000000001, -4.300000000000001, -3.6000000000000005, -3.7000000000000006, -3.900000000000001, -4.0, -3.9000000000000012, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.9000000000000004, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -3.6000000000000005, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -3.8000000000000007, -4.000000000000001, -3.700000000000001, -4.200000000000001, -3.9000000000000004, -10.9, -3.800000000000001, -3.800000000000001, -4.200000000000001, -10.6, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -3.8000000000000003, -3.6000000000000005, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.600000000000001, -4.000000000000001, -3.600000000000001, -3.800000000000001, -4.000000000000001, -4.1000000000000005, -3.9000000000000012, -3.900000000000001, -3.900000000000001, -3.9000000000000004, -3.7000000000000006, -4.100000000000001, -3.8000000000000007, -4.000000000000002, -3.800000000000001, -3.7000000000000006, -3.6000000000000005, -3.900000000000001, -3.700000000000001, -3.8000000000000007, -3.9000000000000012, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -4.200000000000001, -3.700000000000001, -3.8000000000000007, -4.000000000000002, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -3.700000000000001, -3.9000000000000012, -3.7000000000000006, -3.700000000000001, -3.9000000000000012, -3.800000000000001, -3.900000000000001, -3.6000000000000005, -3.9000000000000012, -3.6000000000000005, -3.800000000000001, -3.8000000000000007, -4.000000000000001, -3.4000000000000004, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.9000000000000012, -3.800000000000001, -3.900000000000001, -3.900000000000001, -3.600000000000001, -4.000000000000001, -3.9000000000000012, -3.8000000000000007, -3.700000000000001, -4.200000000000001, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -3.7000000000000006, -3.8000000000000007, -3.6000000000000005, -3.8000000000000007, -3.9000000000000012, -4.000000000000002, -3.7], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.629542864537415, "mean_inference_ms": 18.143417167589927, "mean_action_processing_ms": 0.9384656452468977, "mean_env_wait_ms": 1.5766910296313619, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07464997470378876, "StateBufferConnector_ms": 0.009924670060475668, "ViewRequirementAgentConnector_ms": 0.1354508101940155}}, "episode_reward_max": -3.4000000000000004, "episode_reward_min": -10.9, "episode_reward_mean": -3.924479166666668, "episode_len_mean": 20.859375, "episodes_this_iter": 192, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.7000000000000006, -3.8000000000000007, -3.8000000000000007, -3.400000000000001, -3.900000000000001, -3.8000000000000007, -3.9000000000000012, -3.8000000000000003, -3.900000000000001, -3.9000000000000012, -3.900000000000001, -3.800000000000001, -4.100000000000001, -3.700000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000002, -3.700000000000001, -3.8000000000000007, -3.500000000000001, -3.700000000000001, -4.100000000000001, -3.500000000000001, -3.9000000000000012, -3.7000000000000006, -3.7000000000000006, -4.100000000000001, -3.900000000000001, -4.000000000000002, -3.7000000000000006, -3.7000000000000006, -3.600000000000001, -3.7000000000000006, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -3.7000000000000006, -3.7000000000000006, -3.6000000000000005, -4.100000000000001, -3.6000000000000005, -3.9000000000000004, -3.6000000000000005, -3.9000000000000012, -4.000000000000002, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000002, -3.9000000000000012, -3.700000000000001, -4.100000000000001, -3.9000000000000012, -3.8000000000000007, -3.700000000000001, -3.700000000000001, -3.700000000000001, -3.900000000000001, -3.800000000000001, -4.300000000000001, -3.6000000000000005, -3.7000000000000006, -3.900000000000001, -4.0, -3.9000000000000012, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.9000000000000004, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -3.6000000000000005, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -3.8000000000000007, -4.000000000000001, -3.700000000000001, -4.200000000000001, -3.9000000000000004, -10.9, -3.800000000000001, -3.800000000000001, -4.200000000000001, -10.6, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -3.8000000000000003, -3.6000000000000005, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.600000000000001, -4.000000000000001, -3.600000000000001, -3.800000000000001, -4.000000000000001, -4.1000000000000005, -3.9000000000000012, -3.900000000000001, -3.900000000000001, -3.9000000000000004, -3.7000000000000006, -4.100000000000001, -3.8000000000000007, -4.000000000000002, -3.800000000000001, -3.7000000000000006, -3.6000000000000005, -3.900000000000001, -3.700000000000001, -3.8000000000000007, -3.9000000000000012, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -4.200000000000001, -3.700000000000001, -3.8000000000000007, -4.000000000000002, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -3.700000000000001, -3.9000000000000012, -3.7000000000000006, -3.700000000000001, -3.9000000000000012, -3.800000000000001, -3.900000000000001, -3.6000000000000005, -3.9000000000000012, -3.6000000000000005, -3.800000000000001, -3.8000000000000007, -4.000000000000001, -3.4000000000000004, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.9000000000000012, -3.800000000000001, -3.900000000000001, -3.900000000000001, -3.600000000000001, -4.000000000000001, -3.9000000000000012, -3.8000000000000007, -3.700000000000001, -4.200000000000001, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -3.7000000000000006, -3.8000000000000007, -3.6000000000000005, -3.8000000000000007, -3.9000000000000012, -4.000000000000002, -3.7], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.629542864537415, "mean_inference_ms": 18.143417167589927, "mean_action_processing_ms": 0.9384656452468977, "mean_env_wait_ms": 1.5766910296313619, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07464997470378876, "StateBufferConnector_ms": 0.009924670060475668, "ViewRequirementAgentConnector_ms": 0.1354508101940155}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 174010.23, "load_time_ms": 1.181, "load_throughput": 3385779.787, "learn_time_ms": 173054.933, "learn_throughput": 23.114, "synch_weights_time_ms": 164.322}, "counters": {"num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "episodes_total": 24263, "training_iteration": 120, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_02-38-55", "timestamp": 1680827935, "time_this_iter_s": 174.34777569770813, "time_total_s": 20596.040680885315, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0147659070>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7effc0095310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 20596.040680885315, "timesteps_since_restore": 0, "iterations_since_restore": 120, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.331048387096774, "ram_util_percent": 23.709677419354833}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.41074994379474, "cur_kl_coeff": 31.599600825731628, "cur_lr": 0.01, "total_loss": 0.729091169689131, "policy_loss": 0.0008062709853934345, "vf_loss": 0.19026055875164205, "vf_explained_var": 0.7683924286596236, "kl": 0.01702630115048309, "entropy": 2.9311960907392605, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 112065.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_agent_steps_sampled": 484000, "num_agent_steps_trained": 484000}, "sampler_results": {"episode_reward_max": -3.4000000000000004, "episode_reward_min": -10.1, "episode_reward_mean": -3.9260416666666678, "episode_len_mean": 20.901041666666668, "episode_media": {}, "episodes_this_iter": 192, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.7000000000000006, -4.200000000000001, -3.900000000000001, -3.800000000000001, -3.9000000000000012, -3.600000000000001, -3.600000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.7000000000000006, -4.000000000000002, -4.0, -3.900000000000001, -3.900000000000001, -3.800000000000001, -4.100000000000001, -3.900000000000001, -4.4, -3.700000000000001, -3.9000000000000004, -3.8000000000000007, -3.9000000000000012, -3.900000000000001, -4.0, -3.800000000000001, -3.800000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -4.000000000000002, -3.600000000000001, -3.8000000000000007, -3.4000000000000004, -3.8000000000000003, -3.900000000000001, -3.800000000000001, -4.000000000000001, -3.800000000000001, -3.7000000000000006, -3.8000000000000003, -3.8000000000000007, -3.700000000000001, -3.6000000000000005, -3.900000000000001, -4.000000000000001, -3.9000000000000012, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -3.8000000000000003, -4.000000000000001, -4.200000000000001, -4.000000000000002, -3.900000000000001, -3.600000000000001, -3.900000000000001, -3.800000000000001, -4.000000000000001, -4.100000000000001, -3.5000000000000004, -3.8000000000000007, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -4.200000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -3.800000000000001, -3.8000000000000007, -4.1000000000000005, -4.1000000000000005, -4.1000000000000005, -3.900000000000001, -3.600000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000002, -3.8000000000000007, -3.900000000000001, -3.6000000000000005, -3.700000000000001, -4.100000000000001, -4.000000000000002, -3.6, -3.9000000000000004, -4.100000000000001, -3.900000000000001, -4.200000000000001, -3.900000000000001, -3.800000000000001, -3.8000000000000007, -4.0, -3.8000000000000007, -4.200000000000001, -4.100000000000001, -10.1, -3.8000000000000007, -3.7000000000000006, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -4.0, -3.6000000000000005, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000002, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -3.9000000000000012, -3.900000000000001, -3.6000000000000005, -4.200000000000001, -4.200000000000001, -3.800000000000001, -3.9000000000000012, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.7000000000000006, -4.200000000000001, -4.100000000000001, -3.900000000000001, -3.800000000000001, -4.000000000000001, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -3.9000000000000012, -3.900000000000001, -4.200000000000001, -3.900000000000001, -3.900000000000001, -3.9000000000000012, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.0, -3.900000000000001, -3.8000000000000007, -3.700000000000001, -4.200000000000001, -3.9000000000000012, -3.7, -4.200000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -4.1000000000000005, -3.7000000000000006, -3.8000000000000007, -4.000000000000002, -3.500000000000001, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -3.700000000000001, -4.000000000000001, -3.900000000000001, -3.700000000000001, -4.000000000000001, -4.0, -3.8000000000000007, -3.600000000000001, -4.100000000000001, -3.6000000000000005, -4.200000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.6000000000000005, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -3.600000000000001, -4.000000000000001, -4.0], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.6330130006941, "mean_inference_ms": 18.131586044316908, "mean_action_processing_ms": 0.9380557570356681, "mean_env_wait_ms": 1.5740052571346588, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07476272682348888, "StateBufferConnector_ms": 0.009981667002042135, "ViewRequirementAgentConnector_ms": 0.13569394747416177}}, "episode_reward_max": -3.4000000000000004, "episode_reward_min": -10.1, "episode_reward_mean": -3.9260416666666678, "episode_len_mean": 20.901041666666668, "episodes_this_iter": 192, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.7000000000000006, -4.200000000000001, -3.900000000000001, -3.800000000000001, -3.9000000000000012, -3.600000000000001, -3.600000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.7000000000000006, -4.000000000000002, -4.0, -3.900000000000001, -3.900000000000001, -3.800000000000001, -4.100000000000001, -3.900000000000001, -4.4, -3.700000000000001, -3.9000000000000004, -3.8000000000000007, -3.9000000000000012, -3.900000000000001, -4.0, -3.800000000000001, -3.800000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -4.000000000000002, -3.600000000000001, -3.8000000000000007, -3.4000000000000004, -3.8000000000000003, -3.900000000000001, -3.800000000000001, -4.000000000000001, -3.800000000000001, -3.7000000000000006, -3.8000000000000003, -3.8000000000000007, -3.700000000000001, -3.6000000000000005, -3.900000000000001, -4.000000000000001, -3.9000000000000012, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -3.8000000000000003, -4.000000000000001, -4.200000000000001, -4.000000000000002, -3.900000000000001, -3.600000000000001, -3.900000000000001, -3.800000000000001, -4.000000000000001, -4.100000000000001, -3.5000000000000004, -3.8000000000000007, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -4.200000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -3.800000000000001, -3.8000000000000007, -4.1000000000000005, -4.1000000000000005, -4.1000000000000005, -3.900000000000001, -3.600000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000002, -3.8000000000000007, -3.900000000000001, -3.6000000000000005, -3.700000000000001, -4.100000000000001, -4.000000000000002, -3.6, -3.9000000000000004, -4.100000000000001, -3.900000000000001, -4.200000000000001, -3.900000000000001, -3.800000000000001, -3.8000000000000007, -4.0, -3.8000000000000007, -4.200000000000001, -4.100000000000001, -10.1, -3.8000000000000007, -3.7000000000000006, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -4.0, -3.6000000000000005, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000002, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -3.9000000000000012, -3.900000000000001, -3.6000000000000005, -4.200000000000001, -4.200000000000001, -3.800000000000001, -3.9000000000000012, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.7000000000000006, -4.200000000000001, -4.100000000000001, -3.900000000000001, -3.800000000000001, -4.000000000000001, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -3.9000000000000012, -3.900000000000001, -4.200000000000001, -3.900000000000001, -3.900000000000001, -3.9000000000000012, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.0, -3.900000000000001, -3.8000000000000007, -3.700000000000001, -4.200000000000001, -3.9000000000000012, -3.7, -4.200000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -4.1000000000000005, -3.7000000000000006, -3.8000000000000007, -4.000000000000002, -3.500000000000001, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -3.700000000000001, -4.000000000000001, -3.900000000000001, -3.700000000000001, -4.000000000000001, -4.0, -3.8000000000000007, -3.600000000000001, -4.100000000000001, -3.6000000000000005, -4.200000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.6000000000000005, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -3.600000000000001, -4.000000000000001, -4.0], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.6330130006941, "mean_inference_ms": 18.131586044316908, "mean_action_processing_ms": 0.9380557570356681, "mean_env_wait_ms": 1.5740052571346588, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07476272682348888, "StateBufferConnector_ms": 0.009981667002042135, "ViewRequirementAgentConnector_ms": 0.13569394747416177}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 484000, "num_agent_steps_trained": 484000, "num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 484000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 484000, "timers": {"training_iteration_time_ms": 174019.792, "load_time_ms": 1.182, "load_throughput": 3383662.949, "learn_time_ms": 173068.661, "learn_throughput": 23.112, "synch_weights_time_ms": 168.86}, "counters": {"num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_agent_steps_sampled": 484000, "num_agent_steps_trained": 484000}, "done": false, "episodes_total": 24455, "training_iteration": 121, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_02-41-48", "timestamp": 1680828108, "time_this_iter_s": 173.62092566490173, "time_total_s": 20769.661606550217, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7effc0123b50>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff947c5700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 20769.661606550217, "timesteps_since_restore": 0, "iterations_since_restore": 121, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.390283400809717, "ram_util_percent": 23.795951417004062}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.48688084002464, "cur_kl_coeff": 31.599600825731628, "cur_lr": 0.01, "total_loss": 1.1206217600753712, "policy_loss": 0.007824169899467178, "vf_loss": 0.20118286898459797, "vf_explained_var": 0.7483280258153074, "kl": 0.02884893073326087, "entropy": 2.9126398555694086, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 112995.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_agent_steps_sampled": 488000, "num_agent_steps_trained": 488000}, "sampler_results": {"episode_reward_max": -3.400000000000001, "episode_reward_min": -11.8, "episode_reward_mean": -3.9673684210526323, "episode_len_mean": 20.857894736842105, "episode_media": {}, "episodes_this_iter": 190, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.7000000000000006, -11.8, -4.000000000000001, -3.700000000000001, -3.700000000000001, -3.800000000000001, -3.800000000000001, -3.900000000000001, -4.100000000000001, -3.7000000000000006, -10.1, -3.700000000000001, -4.100000000000001, -4.100000000000001, -3.700000000000001, -3.7000000000000006, -3.9000000000000012, -4.100000000000001, -3.600000000000001, -4.000000000000001, -3.800000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.9000000000000012, -3.5000000000000013, -3.700000000000001, -4.100000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000001, -3.9000000000000004, -4.000000000000001, -3.9000000000000004, -4.100000000000001, -4.100000000000001, -3.700000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -3.800000000000001, -3.9000000000000012, -4.0, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000002, -4.1000000000000005, -3.8000000000000003, -3.8000000000000007, -3.900000000000001, -3.800000000000001, -4.000000000000002, -4.1000000000000005, -4.000000000000001, -3.7000000000000006, -3.8000000000000007, -3.7000000000000006, -3.700000000000001, -3.900000000000001, -4.100000000000001, -4.300000000000001, -3.800000000000001, -3.800000000000001, -3.8000000000000007, -4.200000000000001, -3.7000000000000006, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -3.800000000000001, -3.8000000000000007, -3.900000000000001, -4.200000000000001, -4.200000000000001, -3.800000000000001, -4.300000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.800000000000001, -3.9000000000000004, -3.5000000000000004, -4.000000000000001, -3.700000000000001, -3.600000000000001, -3.900000000000001, -3.900000000000001, -3.6000000000000005, -4.000000000000001, -3.900000000000001, -3.9000000000000004, -3.8000000000000007, -4.100000000000001, -4.200000000000001, -3.900000000000001, -3.9000000000000012, -3.7000000000000006, -3.9000000000000012, -4.100000000000001, -3.700000000000001, -3.800000000000001, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.700000000000001, -4.100000000000001, -3.900000000000001, -3.700000000000001, -3.8000000000000003, -3.400000000000001, -3.8000000000000007, -3.900000000000001, -3.6000000000000005, -4.000000000000001, -3.7000000000000006, -3.900000000000001, -4.200000000000001, -3.8000000000000007, -4.000000000000001, -3.500000000000001, -3.7000000000000006, -3.8000000000000007, -4.100000000000001, -3.8000000000000007, -4.200000000000001, -3.9000000000000012, -4.000000000000001, -3.8000000000000003, -4.100000000000001, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -3.800000000000001, -3.700000000000001, -4.000000000000001, -4.100000000000001, -4.0, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -4.000000000000002, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -4.000000000000002, -4.0, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.6000000000000005, -3.800000000000001, -3.800000000000001, -3.6, -3.700000000000001, -3.7000000000000006, -4.000000000000001, -3.9000000000000012, -4.000000000000001, -3.900000000000001, -3.9000000000000004, -3.9000000000000012, -4.0, -3.900000000000001, -3.700000000000001, -3.9000000000000012, -3.900000000000001, -4.1000000000000005, -3.7000000000000006, -3.7000000000000006, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.7000000000000006, -4.000000000000001, -3.8000000000000007], "episode_lengths": [21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.630570619138522, "mean_inference_ms": 18.12507051317254, "mean_action_processing_ms": 0.9378386576067379, "mean_env_wait_ms": 1.573706847344069, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07411944238763106, "StateBufferConnector_ms": 0.009640141537314966, "ViewRequirementAgentConnector_ms": 0.13595970053421824}}, "episode_reward_max": -3.400000000000001, "episode_reward_min": -11.8, "episode_reward_mean": -3.9673684210526323, "episode_len_mean": 20.857894736842105, "episodes_this_iter": 190, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.7000000000000006, -11.8, -4.000000000000001, -3.700000000000001, -3.700000000000001, -3.800000000000001, -3.800000000000001, -3.900000000000001, -4.100000000000001, -3.7000000000000006, -10.1, -3.700000000000001, -4.100000000000001, -4.100000000000001, -3.700000000000001, -3.7000000000000006, -3.9000000000000012, -4.100000000000001, -3.600000000000001, -4.000000000000001, -3.800000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.9000000000000012, -3.5000000000000013, -3.700000000000001, -4.100000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000001, -3.9000000000000004, -4.000000000000001, -3.9000000000000004, -4.100000000000001, -4.100000000000001, -3.700000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -3.800000000000001, -3.9000000000000012, -4.0, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000002, -4.1000000000000005, -3.8000000000000003, -3.8000000000000007, -3.900000000000001, -3.800000000000001, -4.000000000000002, -4.1000000000000005, -4.000000000000001, -3.7000000000000006, -3.8000000000000007, -3.7000000000000006, -3.700000000000001, -3.900000000000001, -4.100000000000001, -4.300000000000001, -3.800000000000001, -3.800000000000001, -3.8000000000000007, -4.200000000000001, -3.7000000000000006, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -3.800000000000001, -3.8000000000000007, -3.900000000000001, -4.200000000000001, -4.200000000000001, -3.800000000000001, -4.300000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.800000000000001, -3.9000000000000004, -3.5000000000000004, -4.000000000000001, -3.700000000000001, -3.600000000000001, -3.900000000000001, -3.900000000000001, -3.6000000000000005, -4.000000000000001, -3.900000000000001, -3.9000000000000004, -3.8000000000000007, -4.100000000000001, -4.200000000000001, -3.900000000000001, -3.9000000000000012, -3.7000000000000006, -3.9000000000000012, -4.100000000000001, -3.700000000000001, -3.800000000000001, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.700000000000001, -4.100000000000001, -3.900000000000001, -3.700000000000001, -3.8000000000000003, -3.400000000000001, -3.8000000000000007, -3.900000000000001, -3.6000000000000005, -4.000000000000001, -3.7000000000000006, -3.900000000000001, -4.200000000000001, -3.8000000000000007, -4.000000000000001, -3.500000000000001, -3.7000000000000006, -3.8000000000000007, -4.100000000000001, -3.8000000000000007, -4.200000000000001, -3.9000000000000012, -4.000000000000001, -3.8000000000000003, -4.100000000000001, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -3.800000000000001, -3.700000000000001, -4.000000000000001, -4.100000000000001, -4.0, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -4.000000000000002, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -4.000000000000002, -4.0, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.6000000000000005, -3.800000000000001, -3.800000000000001, -3.6, -3.700000000000001, -3.7000000000000006, -4.000000000000001, -3.9000000000000012, -4.000000000000001, -3.900000000000001, -3.9000000000000004, -3.9000000000000012, -4.0, -3.900000000000001, -3.700000000000001, -3.9000000000000012, -3.900000000000001, -4.1000000000000005, -3.7000000000000006, -3.7000000000000006, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.7000000000000006, -4.000000000000001, -3.8000000000000007], "episode_lengths": [21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.630570619138522, "mean_inference_ms": 18.12507051317254, "mean_action_processing_ms": 0.9378386576067379, "mean_env_wait_ms": 1.573706847344069, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07411944238763106, "StateBufferConnector_ms": 0.009640141537314966, "ViewRequirementAgentConnector_ms": 0.13595970053421824}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 488000, "num_agent_steps_trained": 488000, "num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 488000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 488000, "timers": {"training_iteration_time_ms": 173969.387, "load_time_ms": 1.181, "load_throughput": 3386053.12, "learn_time_ms": 173023.427, "learn_throughput": 23.118, "synch_weights_time_ms": 169.298}, "counters": {"num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_agent_steps_sampled": 488000, "num_agent_steps_trained": 488000}, "done": false, "episodes_total": 24645, "training_iteration": 122, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_02-44-43", "timestamp": 1680828283, "time_this_iter_s": 174.16105794906616, "time_total_s": 20943.822664499283, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01472fc5b0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff947c51f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 20943.822664499283, "timesteps_since_restore": 0, "iterations_since_restore": 122, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.2854251012145745, "ram_util_percent": 23.799190283400822}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.592057347041305, "cur_kl_coeff": 47.399401238597434, "cur_lr": 0.01, "total_loss": Infinity, "policy_loss": 0.004594912774790759, "vf_loss": 0.29765113992716674, "vf_explained_var": 0.7561976428313922, "kl": Infinity, "entropy": 2.904068757128972, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 113925.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000}, "sampler_results": {"episode_reward_max": -3.3000000000000007, "episode_reward_min": -12.8, "episode_reward_mean": -3.99421052631579, "episode_len_mean": 20.842105263157894, "episode_media": {}, "episodes_this_iter": 190, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.7000000000000006, -3.900000000000001, -4.100000000000001, -3.600000000000001, -3.8000000000000007, -3.900000000000001, -4.1000000000000005, -4.100000000000001, -3.700000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.0, -3.9000000000000012, -4.000000000000001, -4.0, -3.9000000000000012, -3.900000000000001, -3.9000000000000004, -3.7000000000000006, -3.500000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -3.9000000000000012, -3.900000000000001, -3.7000000000000006, -4.200000000000001, -4.000000000000001, -3.8000000000000007, -4.200000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.7000000000000006, -3.6000000000000005, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -3.8000000000000007, -4.200000000000001, -4.200000000000001, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -3.800000000000001, -3.900000000000001, -3.8000000000000007, -3.7, -3.700000000000001, -4.100000000000001, -3.9000000000000004, -3.8000000000000007, -3.6000000000000005, -3.600000000000001, -4.000000000000002, -3.6000000000000005, -3.6000000000000005, -4.200000000000001, -4.000000000000002, -3.800000000000001, -3.700000000000001, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -4.200000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -3.8000000000000007, -3.900000000000001, -3.800000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.8000000000000003, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000002, -4.000000000000001, -3.600000000000001, -3.900000000000001, -3.7000000000000006, -3.7000000000000006, -3.9000000000000012, -4.000000000000002, -10.3, -3.7000000000000006, -10.9, -3.700000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.3000000000000007, -3.800000000000001, -12.8, -3.7000000000000006, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.700000000000001, -4.200000000000001, -3.600000000000001, -3.8000000000000007, -4.200000000000001, -4.100000000000001, -3.7, -3.700000000000001, -4.000000000000001, -3.9000000000000012, -3.700000000000001, -3.9000000000000004, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.700000000000001, -3.7000000000000006, -3.600000000000001, -3.900000000000001, -3.9000000000000012, -3.9000000000000004, -4.200000000000001, -3.8000000000000007, -3.9000000000000012, -3.900000000000001, -3.900000000000001, -3.6000000000000005, -3.900000000000001, -4.000000000000001, -3.9000000000000004, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -3.8000000000000016, -3.900000000000001, -3.800000000000001, -3.800000000000001, -3.8000000000000007, -3.6000000000000005, -3.8000000000000007, -3.6000000000000005, -3.8000000000000007, -4.1000000000000005, -3.7000000000000006, -4.1000000000000005, -3.9000000000000012, -3.9000000000000012, -4.100000000000001, -4.000000000000001, -3.7000000000000006, -4.300000000000001, -3.9000000000000012, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -3.6, -3.9000000000000012, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -4.0, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -3.700000000000001, -3.800000000000001, -3.900000000000001, -3.7000000000000006, -3.800000000000001, -4.0, -4.100000000000001, -3.7000000000000006, -4.000000000000001, -4.000000000000001, -3.800000000000001, -3.9000000000000012, -3.900000000000001, -3.700000000000001, -3.600000000000001, -3.800000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 9, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.635799848441122, "mean_inference_ms": 18.131574904934734, "mean_action_processing_ms": 0.9382141327597417, "mean_env_wait_ms": 1.5755663023331727, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07676701796682257, "StateBufferConnector_ms": 0.00985835727892424, "ViewRequirementAgentConnector_ms": 0.13977766036987305}}, "episode_reward_max": -3.3000000000000007, "episode_reward_min": -12.8, "episode_reward_mean": -3.99421052631579, "episode_len_mean": 20.842105263157894, "episodes_this_iter": 190, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.7000000000000006, -3.900000000000001, -4.100000000000001, -3.600000000000001, -3.8000000000000007, -3.900000000000001, -4.1000000000000005, -4.100000000000001, -3.700000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.0, -3.9000000000000012, -4.000000000000001, -4.0, -3.9000000000000012, -3.900000000000001, -3.9000000000000004, -3.7000000000000006, -3.500000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -3.9000000000000012, -3.900000000000001, -3.7000000000000006, -4.200000000000001, -4.000000000000001, -3.8000000000000007, -4.200000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.7000000000000006, -3.6000000000000005, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -3.8000000000000007, -4.200000000000001, -4.200000000000001, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -3.800000000000001, -3.900000000000001, -3.8000000000000007, -3.7, -3.700000000000001, -4.100000000000001, -3.9000000000000004, -3.8000000000000007, -3.6000000000000005, -3.600000000000001, -4.000000000000002, -3.6000000000000005, -3.6000000000000005, -4.200000000000001, -4.000000000000002, -3.800000000000001, -3.700000000000001, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -4.200000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -3.8000000000000007, -3.900000000000001, -3.800000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.8000000000000003, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000002, -4.000000000000001, -3.600000000000001, -3.900000000000001, -3.7000000000000006, -3.7000000000000006, -3.9000000000000012, -4.000000000000002, -10.3, -3.7000000000000006, -10.9, -3.700000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.3000000000000007, -3.800000000000001, -12.8, -3.7000000000000006, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.700000000000001, -4.200000000000001, -3.600000000000001, -3.8000000000000007, -4.200000000000001, -4.100000000000001, -3.7, -3.700000000000001, -4.000000000000001, -3.9000000000000012, -3.700000000000001, -3.9000000000000004, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.700000000000001, -3.7000000000000006, -3.600000000000001, -3.900000000000001, -3.9000000000000012, -3.9000000000000004, -4.200000000000001, -3.8000000000000007, -3.9000000000000012, -3.900000000000001, -3.900000000000001, -3.6000000000000005, -3.900000000000001, -4.000000000000001, -3.9000000000000004, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -3.8000000000000016, -3.900000000000001, -3.800000000000001, -3.800000000000001, -3.8000000000000007, -3.6000000000000005, -3.8000000000000007, -3.6000000000000005, -3.8000000000000007, -4.1000000000000005, -3.7000000000000006, -4.1000000000000005, -3.9000000000000012, -3.9000000000000012, -4.100000000000001, -4.000000000000001, -3.7000000000000006, -4.300000000000001, -3.9000000000000012, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -3.6, -3.9000000000000012, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -4.0, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -3.700000000000001, -3.800000000000001, -3.900000000000001, -3.7000000000000006, -3.800000000000001, -4.0, -4.100000000000001, -3.7000000000000006, -4.000000000000001, -4.000000000000001, -3.800000000000001, -3.9000000000000012, -3.900000000000001, -3.700000000000001, -3.600000000000001, -3.800000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 9, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.635799848441122, "mean_inference_ms": 18.131574904934734, "mean_action_processing_ms": 0.9382141327597417, "mean_env_wait_ms": 1.5755663023331727, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07676701796682257, "StateBufferConnector_ms": 0.00985835727892424, "ViewRequirementAgentConnector_ms": 0.13977766036987305}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 492000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 492000, "timers": {"training_iteration_time_ms": 174110.71, "load_time_ms": 1.148, "load_throughput": 3485667.747, "learn_time_ms": 173160.227, "learn_throughput": 23.1, "synch_weights_time_ms": 172.832}, "counters": {"num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000}, "done": false, "episodes_total": 24835, "training_iteration": 123, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_02-47-38", "timestamp": 1680828458, "time_this_iter_s": 174.92308807373047, "time_total_s": 21118.745752573013, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0147569880>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014728cca0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 21118.745752573013, "timesteps_since_restore": 0, "iterations_since_restore": 123, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.566265060240964, "ram_util_percent": 23.802811244979925}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 46.890206353895124, "cur_kl_coeff": 71.09910185789616, "cur_lr": 0.01, "total_loss": Infinity, "policy_loss": 0.019705498491924617, "vf_loss": 0.32928525096466466, "vf_explained_var": 0.729805814578969, "kl": Infinity, "entropy": 2.831293729171958, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 114855.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "sampler_results": {"episode_reward_max": -3.4000000000000004, "episode_reward_min": -10.6, "episode_reward_mean": -4.007291666666668, "episode_len_mean": 20.734375, "episode_media": {}, "episodes_this_iter": 192, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.800000000000001, -3.8000000000000007, -4.000000000000001, -3.9000000000000012, -3.8000000000000007, -4.200000000000001, -4.000000000000002, -3.900000000000001, -3.900000000000001, -3.9000000000000012, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -3.8000000000000007, -3.9000000000000012, -3.800000000000001, -4.100000000000001, -4.300000000000001, -3.900000000000001, -3.900000000000001, -3.9000000000000012, -3.800000000000001, -3.800000000000001, -3.900000000000001, -3.700000000000001, -4.100000000000001, -3.800000000000001, -4.100000000000001, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -3.900000000000001, -3.800000000000001, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.800000000000001, -3.800000000000001, -4.000000000000002, -3.8000000000000007, -4.200000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -3.9000000000000012, -3.6000000000000005, -4.200000000000001, -3.9000000000000012, -4.000000000000001, -4.000000000000001, -4.000000000000002, -4.200000000000001, -3.900000000000001, -3.9000000000000012, -4.100000000000001, -3.9000000000000012, -3.9000000000000004, -4.100000000000001, -4.000000000000001, -3.9000000000000004, -3.8000000000000007, -4.200000000000001, -4.000000000000001, -3.900000000000001, -3.800000000000001, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.9000000000000004, -3.700000000000001, -4.200000000000001, -4.000000000000002, -3.7, -4.100000000000001, -3.900000000000001, -4.200000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000003, -3.5000000000000004, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.9000000000000004, -3.800000000000001, -3.8000000000000007, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -3.5000000000000004, -3.8000000000000007, -3.800000000000001, -10.6, -4.200000000000001, -4.100000000000001, -10.2, -4.000000000000001, -3.8000000000000007, -3.9000000000000012, -10.2, -3.7000000000000006, -3.6000000000000005, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -3.9000000000000004, -3.9000000000000012, -4.200000000000001, -3.9000000000000012, -3.900000000000001, -4.100000000000001, -4.100000000000001, -3.7, -4.1000000000000005, -3.9000000000000012, -3.700000000000001, -3.9000000000000012, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000002, -3.8000000000000007, -4.300000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.1000000000000005, -4.000000000000001, -3.9000000000000004, -4.1000000000000005, -4.100000000000001, -4.100000000000001, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.800000000000001, -4.100000000000001, -3.9000000000000012, -3.800000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -3.700000000000001, -4.000000000000002, -4.100000000000001, -3.900000000000001, -3.9000000000000004, -3.7000000000000006, -3.900000000000001, -3.7000000000000006, -3.700000000000001, -3.7000000000000006, -3.8000000000000007, -4.000000000000001, -3.8000000000000003, -3.900000000000001, -3.6000000000000005, -3.600000000000001, -3.700000000000001, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -4.100000000000001, -3.9000000000000012, -3.900000000000001, -3.700000000000001, -4.000000000000001, -3.8000000000000007, -3.7000000000000006, -3.7000000000000006, -3.6000000000000005, -3.800000000000001, -3.4000000000000004, -3.9000000000000012, -3.8000000000000007], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 3, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.638304352047589, "mean_inference_ms": 18.150593343199734, "mean_action_processing_ms": 0.938561677544344, "mean_env_wait_ms": 1.5774331281186111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08259837826093037, "StateBufferConnector_ms": 0.010778382420539856, "ViewRequirementAgentConnector_ms": 0.1471247524023056}}, "episode_reward_max": -3.4000000000000004, "episode_reward_min": -10.6, "episode_reward_mean": -4.007291666666668, "episode_len_mean": 20.734375, "episodes_this_iter": 192, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.800000000000001, -3.8000000000000007, -4.000000000000001, -3.9000000000000012, -3.8000000000000007, -4.200000000000001, -4.000000000000002, -3.900000000000001, -3.900000000000001, -3.9000000000000012, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -3.8000000000000007, -3.9000000000000012, -3.800000000000001, -4.100000000000001, -4.300000000000001, -3.900000000000001, -3.900000000000001, -3.9000000000000012, -3.800000000000001, -3.800000000000001, -3.900000000000001, -3.700000000000001, -4.100000000000001, -3.800000000000001, -4.100000000000001, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -3.900000000000001, -3.800000000000001, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.800000000000001, -3.800000000000001, -4.000000000000002, -3.8000000000000007, -4.200000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -3.9000000000000012, -3.6000000000000005, -4.200000000000001, -3.9000000000000012, -4.000000000000001, -4.000000000000001, -4.000000000000002, -4.200000000000001, -3.900000000000001, -3.9000000000000012, -4.100000000000001, -3.9000000000000012, -3.9000000000000004, -4.100000000000001, -4.000000000000001, -3.9000000000000004, -3.8000000000000007, -4.200000000000001, -4.000000000000001, -3.900000000000001, -3.800000000000001, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.9000000000000004, -3.700000000000001, -4.200000000000001, -4.000000000000002, -3.7, -4.100000000000001, -3.900000000000001, -4.200000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000003, -3.5000000000000004, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.9000000000000004, -3.800000000000001, -3.8000000000000007, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -3.5000000000000004, -3.8000000000000007, -3.800000000000001, -10.6, -4.200000000000001, -4.100000000000001, -10.2, -4.000000000000001, -3.8000000000000007, -3.9000000000000012, -10.2, -3.7000000000000006, -3.6000000000000005, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -3.9000000000000004, -3.9000000000000012, -4.200000000000001, -3.9000000000000012, -3.900000000000001, -4.100000000000001, -4.100000000000001, -3.7, -4.1000000000000005, -3.9000000000000012, -3.700000000000001, -3.9000000000000012, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000002, -3.8000000000000007, -4.300000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.1000000000000005, -4.000000000000001, -3.9000000000000004, -4.1000000000000005, -4.100000000000001, -4.100000000000001, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.800000000000001, -4.100000000000001, -3.9000000000000012, -3.800000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -3.700000000000001, -4.000000000000002, -4.100000000000001, -3.900000000000001, -3.9000000000000004, -3.7000000000000006, -3.900000000000001, -3.7000000000000006, -3.700000000000001, -3.7000000000000006, -3.8000000000000007, -4.000000000000001, -3.8000000000000003, -3.900000000000001, -3.6000000000000005, -3.600000000000001, -3.700000000000001, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -4.100000000000001, -3.9000000000000012, -3.900000000000001, -3.700000000000001, -4.000000000000001, -3.8000000000000007, -3.7000000000000006, -3.7000000000000006, -3.6000000000000005, -3.800000000000001, -3.4000000000000004, -3.9000000000000012, -3.8000000000000007], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 3, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.638304352047589, "mean_inference_ms": 18.150593343199734, "mean_action_processing_ms": 0.938561677544344, "mean_env_wait_ms": 1.5774331281186111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08259837826093037, "StateBufferConnector_ms": 0.010778382420539856, "ViewRequirementAgentConnector_ms": 0.1471247524023056}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000, "num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 496000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 496000, "timers": {"training_iteration_time_ms": 174182.35, "load_time_ms": 1.155, "load_throughput": 3463361.546, "learn_time_ms": 173226.198, "learn_throughput": 23.091, "synch_weights_time_ms": 175.465}, "counters": {"num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "done": false, "episodes_total": 25027, "training_iteration": 124, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_02-50-32", "timestamp": 1680828632, "time_this_iter_s": 174.28663802146912, "time_total_s": 21293.032390594482, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7effc0123280>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff947c11f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 21293.032390594482, "timesteps_since_restore": 0, "iterations_since_restore": 124, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.378225806451613, "ram_util_percent": 23.80120967741936}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 25.98514926279745, "cur_kl_coeff": 106.6486527868442, "cur_lr": 0.01, "total_loss": Infinity, "policy_loss": -0.000547896598976466, "vf_loss": 0.2414669365652146, "vf_explained_var": 0.731854522228241, "kl": Infinity, "entropy": 2.897472159836882, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 115785.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_agent_steps_sampled": 500000, "num_agent_steps_trained": 500000}, "sampler_results": {"episode_reward_max": -3.500000000000001, "episode_reward_min": -10.2, "episode_reward_mean": -3.932307692307693, "episode_len_mean": 20.907692307692308, "episode_media": {}, "episodes_this_iter": 195, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.000000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -4.200000000000001, -4.0, -4.000000000000001, -3.8000000000000003, -3.8000000000000007, -3.900000000000001, -10.2, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -3.7000000000000006, -3.9000000000000012, -3.6000000000000005, -3.8000000000000007, -3.8000000000000007, -3.800000000000001, -3.9000000000000004, -3.600000000000001, -3.9000000000000004, -3.900000000000001, -3.900000000000001, -3.9000000000000012, -3.8000000000000007, -4.000000000000002, -4.200000000000001, -3.7000000000000006, -4.100000000000001, -4.0, -3.6000000000000005, -3.7000000000000006, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -3.800000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.700000000000001, -4.000000000000001, -3.700000000000001, -4.100000000000001, -3.900000000000001, -3.7000000000000006, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -3.9000000000000012, -3.700000000000001, -3.8000000000000007, -4.100000000000001, -4.100000000000001, -4.100000000000001, -3.600000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.700000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.800000000000001, -3.800000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.0, -4.000000000000001, -4.200000000000001, -3.700000000000001, -3.900000000000001, -3.7000000000000006, -4.100000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.6000000000000005, -4.000000000000001, -4.000000000000001, -3.800000000000001, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -3.9000000000000012, -3.6000000000000005, -3.7000000000000006, -4.000000000000001, -4.000000000000002, -3.700000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -3.9000000000000012, -4.100000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000002, -3.8000000000000003, -4.000000000000001, -3.800000000000001, -4.100000000000001, -3.500000000000001, -3.800000000000001, -3.9000000000000004, -3.7000000000000006, -3.7000000000000006, -3.7000000000000006, -3.8000000000000007, -3.9000000000000004, -4.000000000000001, -4.100000000000001, -4.1000000000000005, -3.800000000000001, -3.8000000000000003, -4.100000000000001, -3.900000000000001, -4.000000000000001, -3.800000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.7000000000000006, -4.200000000000001, -3.7000000000000006, -4.000000000000001, -3.600000000000001, -3.800000000000001, -3.900000000000001, -3.900000000000001, -3.6000000000000005, -4.000000000000001, -4.100000000000001, -4.0, -3.900000000000001, -3.900000000000001, -3.6000000000000005, -3.7000000000000006, -3.900000000000001, -4.200000000000001, -3.900000000000001, -4.0, -4.100000000000001, -3.700000000000001, -3.800000000000001, -3.900000000000001, -3.800000000000001, -4.100000000000001, -4.200000000000001, -3.700000000000001, -3.900000000000001, -3.700000000000001, -3.6000000000000005, -4.100000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.0, -4.0, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.600000000000001, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -4.0, -4.100000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.6324444502923, "mean_inference_ms": 18.120406314129184, "mean_action_processing_ms": 0.9378410915594201, "mean_env_wait_ms": 1.5726481769829943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07655950692983773, "StateBufferConnector_ms": 0.0100099123441256, "ViewRequirementAgentConnector_ms": 0.13847766778407952}}, "episode_reward_max": -3.500000000000001, "episode_reward_min": -10.2, "episode_reward_mean": -3.932307692307693, "episode_len_mean": 20.907692307692308, "episodes_this_iter": 195, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.000000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -4.200000000000001, -4.0, -4.000000000000001, -3.8000000000000003, -3.8000000000000007, -3.900000000000001, -10.2, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -3.7000000000000006, -3.9000000000000012, -3.6000000000000005, -3.8000000000000007, -3.8000000000000007, -3.800000000000001, -3.9000000000000004, -3.600000000000001, -3.9000000000000004, -3.900000000000001, -3.900000000000001, -3.9000000000000012, -3.8000000000000007, -4.000000000000002, -4.200000000000001, -3.7000000000000006, -4.100000000000001, -4.0, -3.6000000000000005, -3.7000000000000006, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -3.800000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.700000000000001, -4.000000000000001, -3.700000000000001, -4.100000000000001, -3.900000000000001, -3.7000000000000006, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -3.9000000000000012, -3.700000000000001, -3.8000000000000007, -4.100000000000001, -4.100000000000001, -4.100000000000001, -3.600000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.700000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.800000000000001, -3.800000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.0, -4.000000000000001, -4.200000000000001, -3.700000000000001, -3.900000000000001, -3.7000000000000006, -4.100000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.6000000000000005, -4.000000000000001, -4.000000000000001, -3.800000000000001, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -3.9000000000000012, -3.6000000000000005, -3.7000000000000006, -4.000000000000001, -4.000000000000002, -3.700000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -3.9000000000000012, -4.100000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000002, -3.8000000000000003, -4.000000000000001, -3.800000000000001, -4.100000000000001, -3.500000000000001, -3.800000000000001, -3.9000000000000004, -3.7000000000000006, -3.7000000000000006, -3.7000000000000006, -3.8000000000000007, -3.9000000000000004, -4.000000000000001, -4.100000000000001, -4.1000000000000005, -3.800000000000001, -3.8000000000000003, -4.100000000000001, -3.900000000000001, -4.000000000000001, -3.800000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.7000000000000006, -4.200000000000001, -3.7000000000000006, -4.000000000000001, -3.600000000000001, -3.800000000000001, -3.900000000000001, -3.900000000000001, -3.6000000000000005, -4.000000000000001, -4.100000000000001, -4.0, -3.900000000000001, -3.900000000000001, -3.6000000000000005, -3.7000000000000006, -3.900000000000001, -4.200000000000001, -3.900000000000001, -4.0, -4.100000000000001, -3.700000000000001, -3.800000000000001, -3.900000000000001, -3.800000000000001, -4.100000000000001, -4.200000000000001, -3.700000000000001, -3.900000000000001, -3.700000000000001, -3.6000000000000005, -4.100000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.0, -4.0, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.600000000000001, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -4.0, -4.100000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.6324444502923, "mean_inference_ms": 18.120406314129184, "mean_action_processing_ms": 0.9378410915594201, "mean_env_wait_ms": 1.5726481769829943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07655950692983773, "StateBufferConnector_ms": 0.0100099123441256, "ViewRequirementAgentConnector_ms": 0.13847766778407952}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 500000, "num_agent_steps_trained": 500000, "num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 500000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 500000, "timers": {"training_iteration_time_ms": 174170.032, "load_time_ms": 1.156, "load_throughput": 3460361.356, "learn_time_ms": 173219.559, "learn_throughput": 23.092, "synch_weights_time_ms": 176.619}, "counters": {"num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_agent_steps_sampled": 500000, "num_agent_steps_trained": 500000}, "done": false, "episodes_total": 25222, "training_iteration": 125, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_02-53-26", "timestamp": 1680828806, "time_this_iter_s": 173.8939335346222, "time_total_s": 21466.926324129105, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01472af8e0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff947c1700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 21466.926324129105, "timesteps_since_restore": 0, "iterations_since_restore": 125, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.255060728744939, "ram_util_percent": 23.8012145748988}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 89.76420750976891, "cur_kl_coeff": 159.97297918026638, "cur_lr": 0.01, "total_loss": Infinity, "policy_loss": 0.015003482300052119, "vf_loss": 0.2253595270216465, "vf_explained_var": 0.7354732273727335, "kl": Infinity, "entropy": 2.8561379892851715, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 116715.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "sampler_results": {"episode_reward_max": -3.4000000000000004, "episode_reward_min": -11.9, "episode_reward_mean": -3.963684210526317, "episode_len_mean": 20.86315789473684, "episode_media": {}, "episodes_this_iter": 190, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.1000000000000005, -3.800000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -4.200000000000001, -3.900000000000001, -3.900000000000001, -3.700000000000001, -4.000000000000001, -3.600000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000002, -4.100000000000001, -4.100000000000001, -3.700000000000001, -3.8000000000000003, -4.000000000000001, -10.1, -3.8000000000000007, -3.7000000000000006, -3.8000000000000007, -3.7000000000000006, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -3.7000000000000006, -3.800000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.0, -3.800000000000001, -4.0, -3.900000000000001, -3.8000000000000007, -3.9000000000000012, -4.200000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -3.9000000000000012, -3.7000000000000006, -3.6000000000000005, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.800000000000001, -3.9000000000000012, -4.1000000000000005, -3.900000000000001, -3.900000000000001, -3.800000000000001, -4.0, -3.7000000000000006, -4.0, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -3.800000000000001, -4.000000000000001, -4.000000000000001, -4.300000000000001, -4.000000000000001, -4.1000000000000005, -4.000000000000002, -3.8000000000000007, -4.200000000000001, -3.8000000000000007, -4.100000000000001, -4.100000000000001, -3.9000000000000012, -3.8000000000000007, -3.700000000000001, -3.900000000000001, -3.800000000000001, -4.000000000000001, -3.9000000000000012, -3.700000000000001, -3.700000000000001, -3.6000000000000005, -3.6000000000000005, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -3.800000000000001, -3.700000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -11.9, -3.500000000000001, -3.800000000000001, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -3.400000000000001, -3.8000000000000007, -3.700000000000001, -4.000000000000001, -4.300000000000001, -4.1000000000000005, -3.600000000000001, -3.700000000000001, -4.200000000000001, -3.800000000000001, -3.800000000000001, -3.600000000000001, -4.1000000000000005, -4.100000000000001, -3.9000000000000012, -3.6000000000000005, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.700000000000001, -4.100000000000001, -4.000000000000001, -3.700000000000001, -3.5000000000000004, -3.8000000000000007, -4.100000000000001, -3.700000000000001, -3.700000000000001, -4.000000000000002, -3.6000000000000005, -3.9000000000000012, -3.600000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -3.800000000000001, -4.200000000000001, -3.9000000000000012, -3.600000000000001, -4.300000000000001, -3.900000000000001, -3.900000000000001, -4.0, -4.300000000000001, -3.5000000000000004, -3.800000000000001, -3.900000000000001, -3.8000000000000007, -3.7000000000000006, -4.0, -4.200000000000001, -3.700000000000001, -3.9000000000000012, -3.900000000000001, -4.0, -3.7, -3.4000000000000004, -4.300000000000001, -3.7000000000000006, -3.7000000000000006, -4.0, -4.0, -4.0, -3.800000000000001, -4.100000000000001, -3.6000000000000005, -3.600000000000001, -3.7000000000000006, -4.200000000000001, -3.800000000000001, -3.6000000000000005, -3.7000000000000006, -4.000000000000001, -4.100000000000001, -3.9000000000000012, -4.000000000000001, -3.8000000000000007, -3.8000000000000007], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.635227933910864, "mean_inference_ms": 18.132720107278033, "mean_action_processing_ms": 0.9380048977691331, "mean_env_wait_ms": 1.5750941400172158, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0703523033543637, "StateBufferConnector_ms": 0.009271094673558286, "ViewRequirementAgentConnector_ms": 0.13118505477905273}}, "episode_reward_max": -3.4000000000000004, "episode_reward_min": -11.9, "episode_reward_mean": -3.963684210526317, "episode_len_mean": 20.86315789473684, "episodes_this_iter": 190, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.1000000000000005, -3.800000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -4.200000000000001, -3.900000000000001, -3.900000000000001, -3.700000000000001, -4.000000000000001, -3.600000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000002, -4.100000000000001, -4.100000000000001, -3.700000000000001, -3.8000000000000003, -4.000000000000001, -10.1, -3.8000000000000007, -3.7000000000000006, -3.8000000000000007, -3.7000000000000006, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -3.7000000000000006, -3.800000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.0, -3.800000000000001, -4.0, -3.900000000000001, -3.8000000000000007, -3.9000000000000012, -4.200000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -3.9000000000000012, -3.7000000000000006, -3.6000000000000005, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.800000000000001, -3.9000000000000012, -4.1000000000000005, -3.900000000000001, -3.900000000000001, -3.800000000000001, -4.0, -3.7000000000000006, -4.0, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -3.800000000000001, -4.000000000000001, -4.000000000000001, -4.300000000000001, -4.000000000000001, -4.1000000000000005, -4.000000000000002, -3.8000000000000007, -4.200000000000001, -3.8000000000000007, -4.100000000000001, -4.100000000000001, -3.9000000000000012, -3.8000000000000007, -3.700000000000001, -3.900000000000001, -3.800000000000001, -4.000000000000001, -3.9000000000000012, -3.700000000000001, -3.700000000000001, -3.6000000000000005, -3.6000000000000005, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -3.800000000000001, -3.700000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -11.9, -3.500000000000001, -3.800000000000001, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -3.400000000000001, -3.8000000000000007, -3.700000000000001, -4.000000000000001, -4.300000000000001, -4.1000000000000005, -3.600000000000001, -3.700000000000001, -4.200000000000001, -3.800000000000001, -3.800000000000001, -3.600000000000001, -4.1000000000000005, -4.100000000000001, -3.9000000000000012, -3.6000000000000005, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.700000000000001, -4.100000000000001, -4.000000000000001, -3.700000000000001, -3.5000000000000004, -3.8000000000000007, -4.100000000000001, -3.700000000000001, -3.700000000000001, -4.000000000000002, -3.6000000000000005, -3.9000000000000012, -3.600000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -3.800000000000001, -4.200000000000001, -3.9000000000000012, -3.600000000000001, -4.300000000000001, -3.900000000000001, -3.900000000000001, -4.0, -4.300000000000001, -3.5000000000000004, -3.800000000000001, -3.900000000000001, -3.8000000000000007, -3.7000000000000006, -4.0, -4.200000000000001, -3.700000000000001, -3.9000000000000012, -3.900000000000001, -4.0, -3.7, -3.4000000000000004, -4.300000000000001, -3.7000000000000006, -3.7000000000000006, -4.0, -4.0, -4.0, -3.800000000000001, -4.100000000000001, -3.6000000000000005, -3.600000000000001, -3.7000000000000006, -4.200000000000001, -3.800000000000001, -3.6000000000000005, -3.7000000000000006, -4.000000000000001, -4.100000000000001, -3.9000000000000012, -4.000000000000001, -3.8000000000000007, -3.8000000000000007], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 14, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.635227933910864, "mean_inference_ms": 18.132720107278033, "mean_action_processing_ms": 0.9380048977691331, "mean_env_wait_ms": 1.5750941400172158, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0703523033543637, "StateBufferConnector_ms": 0.009271094673558286, "ViewRequirementAgentConnector_ms": 0.13118505477905273}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 504000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 504000, "timers": {"training_iteration_time_ms": 174193.152, "load_time_ms": 1.153, "load_throughput": 3469162.342, "learn_time_ms": 173248.254, "learn_throughput": 23.088, "synch_weights_time_ms": 176.912}, "counters": {"num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "done": false, "episodes_total": 25412, "training_iteration": 126, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_02-56-21", "timestamp": 1680828981, "time_this_iter_s": 174.75361466407776, "time_total_s": 21641.679938793182, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476d1f70>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7effc0095670>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 21641.679938793182, "timesteps_since_restore": 0, "iterations_since_restore": 126, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.6136546184738965, "ram_util_percent": 23.814056224899602}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 68.21168548778822, "cur_kl_coeff": 239.95946877039944, "cur_lr": 0.01, "total_loss": Infinity, "policy_loss": -0.001898493098034974, "vf_loss": 0.1985192874666824, "vf_explained_var": 0.6957672183231641, "kl": Infinity, "entropy": 2.896137747713315, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 117645.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_agent_steps_sampled": 508000, "num_agent_steps_trained": 508000}, "sampler_results": {"episode_reward_max": -3.4000000000000004, "episode_reward_min": -10.4, "episode_reward_mean": -3.9913705583756345, "episode_len_mean": 20.720812182741117, "episode_media": {}, "episodes_this_iter": 197, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.500000000000001, -4.000000000000001, -4.100000000000001, -10.4, -3.900000000000001, -3.8000000000000007, -3.9000000000000012, -4.200000000000001, -3.8000000000000007, -3.700000000000001, -4.100000000000001, -10.2, -3.8000000000000007, -3.8000000000000007, -3.700000000000001, -3.500000000000001, -3.6000000000000005, -4.100000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.800000000000001, -3.800000000000001, -4.100000000000001, -3.800000000000001, -4.100000000000001, -3.7000000000000006, -3.8000000000000007, -4.200000000000001, -3.7000000000000006, -3.9000000000000004, -4.000000000000001, -3.8000000000000003, -3.600000000000001, -4.000000000000001, -3.8000000000000003, -4.000000000000002, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.0, -3.6000000000000005, -4.200000000000001, -4.000000000000001, -3.7000000000000006, -4.200000000000001, -3.8000000000000007, -4.1000000000000005, -4.200000000000001, -3.8000000000000003, -3.8000000000000007, -3.9000000000000012, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -3.900000000000001, -3.9000000000000012, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -4.0, -4.000000000000001, -3.900000000000001, -4.1000000000000005, -4.000000000000001, -3.7000000000000006, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000001, -3.8000000000000007, -3.700000000000001, -4.000000000000001, -3.9000000000000012, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -3.700000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.600000000000001, -3.8000000000000007, -3.8000000000000007, -3.9000000000000012, -3.9000000000000012, -3.700000000000001, -3.8000000000000003, -3.7000000000000006, -4.100000000000001, -3.7000000000000006, -3.8000000000000007, -3.4000000000000004, -10.0, -3.500000000000001, -4.200000000000001, -4.000000000000002, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -3.700000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -3.8000000000000003, -3.8000000000000007, -3.7000000000000006, -4.300000000000001, -3.8000000000000007, -3.9000000000000012, -3.800000000000001, -4.000000000000001, -3.5000000000000004, -3.8000000000000007, -3.7000000000000006, -4.200000000000001, -4.200000000000001, -3.9000000000000012, -4.100000000000001, -3.9000000000000012, -4.100000000000001, -4.0, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -3.800000000000001, -3.8000000000000007, -3.8000000000000003, -4.100000000000001, -4.300000000000001, -3.900000000000001, -3.6000000000000005, -3.8000000000000007, -3.8000000000000007, -4.100000000000001, -3.8000000000000007, -3.6, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000002, -4.000000000000002, -3.900000000000001, -3.900000000000001, -4.0, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -3.800000000000001, -3.8000000000000007, -4.0, -3.8000000000000007, -4.000000000000002, -3.700000000000001, -3.900000000000001, -3.600000000000001, -3.900000000000001, -3.900000000000001, -3.800000000000001, -3.6000000000000005, -4.000000000000002, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.500000000000001, -4.200000000000001, -3.7000000000000006, -3.8000000000000003, -4.000000000000002, -4.000000000000001, -4.000000000000001, -3.700000000000001, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -3.7000000000000006, -3.8000000000000007, -3.900000000000001, -3.800000000000001, -4.100000000000001, -3.7, -4.000000000000001, -3.5000000000000004, -3.9000000000000012, -3.900000000000001], "episode_lengths": [21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.634333170187801, "mean_inference_ms": 18.1271150597551, "mean_action_processing_ms": 0.9373305562749055, "mean_env_wait_ms": 1.5739079152828537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07272383888360813, "StateBufferConnector_ms": 0.0093515754351156, "ViewRequirementAgentConnector_ms": 0.1309117689955658}}, "episode_reward_max": -3.4000000000000004, "episode_reward_min": -10.4, "episode_reward_mean": -3.9913705583756345, "episode_len_mean": 20.720812182741117, "episodes_this_iter": 197, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.500000000000001, -4.000000000000001, -4.100000000000001, -10.4, -3.900000000000001, -3.8000000000000007, -3.9000000000000012, -4.200000000000001, -3.8000000000000007, -3.700000000000001, -4.100000000000001, -10.2, -3.8000000000000007, -3.8000000000000007, -3.700000000000001, -3.500000000000001, -3.6000000000000005, -4.100000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.800000000000001, -3.800000000000001, -4.100000000000001, -3.800000000000001, -4.100000000000001, -3.7000000000000006, -3.8000000000000007, -4.200000000000001, -3.7000000000000006, -3.9000000000000004, -4.000000000000001, -3.8000000000000003, -3.600000000000001, -4.000000000000001, -3.8000000000000003, -4.000000000000002, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.0, -3.6000000000000005, -4.200000000000001, -4.000000000000001, -3.7000000000000006, -4.200000000000001, -3.8000000000000007, -4.1000000000000005, -4.200000000000001, -3.8000000000000003, -3.8000000000000007, -3.9000000000000012, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -3.900000000000001, -3.9000000000000012, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -4.0, -4.000000000000001, -3.900000000000001, -4.1000000000000005, -4.000000000000001, -3.7000000000000006, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000001, -3.8000000000000007, -3.700000000000001, -4.000000000000001, -3.9000000000000012, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -3.700000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.600000000000001, -3.8000000000000007, -3.8000000000000007, -3.9000000000000012, -3.9000000000000012, -3.700000000000001, -3.8000000000000003, -3.7000000000000006, -4.100000000000001, -3.7000000000000006, -3.8000000000000007, -3.4000000000000004, -10.0, -3.500000000000001, -4.200000000000001, -4.000000000000002, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -3.700000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -3.8000000000000003, -3.8000000000000007, -3.7000000000000006, -4.300000000000001, -3.8000000000000007, -3.9000000000000012, -3.800000000000001, -4.000000000000001, -3.5000000000000004, -3.8000000000000007, -3.7000000000000006, -4.200000000000001, -4.200000000000001, -3.9000000000000012, -4.100000000000001, -3.9000000000000012, -4.100000000000001, -4.0, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -3.800000000000001, -3.8000000000000007, -3.8000000000000003, -4.100000000000001, -4.300000000000001, -3.900000000000001, -3.6000000000000005, -3.8000000000000007, -3.8000000000000007, -4.100000000000001, -3.8000000000000007, -3.6, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000002, -4.000000000000002, -3.900000000000001, -3.900000000000001, -4.0, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -3.800000000000001, -3.8000000000000007, -4.0, -3.8000000000000007, -4.000000000000002, -3.700000000000001, -3.900000000000001, -3.600000000000001, -3.900000000000001, -3.900000000000001, -3.800000000000001, -3.6000000000000005, -4.000000000000002, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.500000000000001, -4.200000000000001, -3.7000000000000006, -3.8000000000000003, -4.000000000000002, -4.000000000000001, -4.000000000000001, -3.700000000000001, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -3.7000000000000006, -3.8000000000000007, -3.900000000000001, -3.800000000000001, -4.100000000000001, -3.7, -4.000000000000001, -3.5000000000000004, -3.9000000000000012, -3.900000000000001], "episode_lengths": [21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 1, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.634333170187801, "mean_inference_ms": 18.1271150597551, "mean_action_processing_ms": 0.9373305562749055, "mean_env_wait_ms": 1.5739079152828537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07272383888360813, "StateBufferConnector_ms": 0.0093515754351156, "ViewRequirementAgentConnector_ms": 0.1309117689955658}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 508000, "num_agent_steps_trained": 508000, "num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 508000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 508000, "timers": {"training_iteration_time_ms": 174244.17, "load_time_ms": 1.163, "load_throughput": 3440633.28, "learn_time_ms": 173301.318, "learn_throughput": 23.081, "synch_weights_time_ms": 176.048}, "counters": {"num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_agent_steps_sampled": 508000, "num_agent_steps_trained": 508000}, "done": false, "episodes_total": 25609, "training_iteration": 127, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_02-59-15", "timestamp": 1680829155, "time_this_iter_s": 174.26692461967468, "time_total_s": 21815.946863412857, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01473e2ee0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff947c11f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 21815.946863412857, "timesteps_since_restore": 0, "iterations_since_restore": 127, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.312955465587043, "ram_util_percent": 23.803643724696364}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 221.3526373365874, "cur_kl_coeff": 359.9392031555993, "cur_lr": 0.01, "total_loss": Infinity, "policy_loss": 0.023656393754826758, "vf_loss": 0.2625687777755722, "vf_explained_var": 0.7654816404465706, "kl": Infinity, "entropy": 2.8199769652658895, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 118575.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "sampler_results": {"episode_reward_max": -3.5000000000000004, "episode_reward_min": -10.3, "episode_reward_mean": -3.941116751269036, "episode_len_mean": 20.82233502538071, "episode_media": {}, "episodes_this_iter": 197, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.9000000000000004, -3.900000000000001, -4.1000000000000005, -10.3, -3.700000000000001, -3.800000000000001, -3.900000000000001, -3.6000000000000005, -3.9000000000000012, -3.800000000000001, -3.700000000000001, -3.700000000000001, -3.9000000000000012, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.5000000000000004, -10.2, -3.800000000000001, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -3.800000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000003, -3.800000000000001, -3.9000000000000012, -3.7000000000000006, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.800000000000001, -3.6000000000000005, -3.900000000000001, -4.000000000000002, -4.1000000000000005, -4.000000000000001, -3.9000000000000004, -3.8000000000000007, -3.900000000000001, -4.200000000000001, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -3.700000000000001, -3.9000000000000012, -4.000000000000002, -3.800000000000001, -3.700000000000001, -4.0, -3.900000000000001, -4.0, -3.7000000000000006, -3.5000000000000004, -3.7000000000000006, -4.200000000000001, -3.8000000000000007, -3.7000000000000006, -4.200000000000001, -3.8000000000000007, -4.000000000000001, -3.6000000000000005, -4.000000000000001, -4.000000000000002, -3.800000000000001, -3.700000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000003, -4.100000000000001, -4.000000000000002, -3.6000000000000005, -3.7, -3.900000000000001, -4.000000000000001, -4.1000000000000005, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.6000000000000005, -3.8000000000000007, -3.800000000000001, -3.9000000000000004, -3.700000000000001, -3.900000000000001, -3.800000000000001, -3.9000000000000012, -4.0, -3.600000000000001, -4.200000000000001, -3.8000000000000007, -4.000000000000002, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -3.8000000000000003, -4.000000000000001, -3.9000000000000012, -4.200000000000001, -3.900000000000001, -3.800000000000001, -4.200000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -3.9000000000000004, -4.0, -3.900000000000001, -3.7000000000000006, -3.9000000000000012, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.600000000000001, -3.900000000000001, -4.100000000000001, -4.300000000000001, -3.6000000000000005, -3.6000000000000005, -3.900000000000001, -3.700000000000001, -3.7, -4.000000000000001, -3.900000000000001, -3.6000000000000005, -3.800000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -4.1000000000000005, -4.000000000000002, -3.8000000000000007, -3.800000000000001, -3.700000000000001, -4.100000000000001, -3.500000000000001, -4.100000000000001, -3.7000000000000006, -3.800000000000001, -3.8000000000000007, -3.7000000000000006, -3.8000000000000007, -3.8000000000000007, -3.7000000000000006, -3.9000000000000004, -3.700000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -3.7000000000000006, -3.9000000000000004, -3.900000000000001, -3.7000000000000006, -3.800000000000001, -4.100000000000001, -3.7000000000000006, -3.500000000000001, -3.800000000000001, -4.200000000000001, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -4.000000000000002, -3.7000000000000006, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -3.900000000000001, -3.700000000000001, -4.100000000000001, -3.7000000000000006, -3.900000000000001, -4.200000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001], "episode_lengths": [21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.62962264445979, "mean_inference_ms": 18.11749882926659, "mean_action_processing_ms": 0.9370666935735088, "mean_env_wait_ms": 1.5726018771918036, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07042763802000714, "StateBufferConnector_ms": 0.009299050732917593, "ViewRequirementAgentConnector_ms": 0.13128767158779395}}, "episode_reward_max": -3.5000000000000004, "episode_reward_min": -10.3, "episode_reward_mean": -3.941116751269036, "episode_len_mean": 20.82233502538071, "episodes_this_iter": 197, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.9000000000000004, -3.900000000000001, -4.1000000000000005, -10.3, -3.700000000000001, -3.800000000000001, -3.900000000000001, -3.6000000000000005, -3.9000000000000012, -3.800000000000001, -3.700000000000001, -3.700000000000001, -3.9000000000000012, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.5000000000000004, -10.2, -3.800000000000001, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -3.800000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000003, -3.800000000000001, -3.9000000000000012, -3.7000000000000006, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.800000000000001, -3.6000000000000005, -3.900000000000001, -4.000000000000002, -4.1000000000000005, -4.000000000000001, -3.9000000000000004, -3.8000000000000007, -3.900000000000001, -4.200000000000001, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -3.700000000000001, -3.9000000000000012, -4.000000000000002, -3.800000000000001, -3.700000000000001, -4.0, -3.900000000000001, -4.0, -3.7000000000000006, -3.5000000000000004, -3.7000000000000006, -4.200000000000001, -3.8000000000000007, -3.7000000000000006, -4.200000000000001, -3.8000000000000007, -4.000000000000001, -3.6000000000000005, -4.000000000000001, -4.000000000000002, -3.800000000000001, -3.700000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000003, -4.100000000000001, -4.000000000000002, -3.6000000000000005, -3.7, -3.900000000000001, -4.000000000000001, -4.1000000000000005, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.6000000000000005, -3.8000000000000007, -3.800000000000001, -3.9000000000000004, -3.700000000000001, -3.900000000000001, -3.800000000000001, -3.9000000000000012, -4.0, -3.600000000000001, -4.200000000000001, -3.8000000000000007, -4.000000000000002, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -3.8000000000000003, -4.000000000000001, -3.9000000000000012, -4.200000000000001, -3.900000000000001, -3.800000000000001, -4.200000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -3.9000000000000004, -4.0, -3.900000000000001, -3.7000000000000006, -3.9000000000000012, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.600000000000001, -3.900000000000001, -4.100000000000001, -4.300000000000001, -3.6000000000000005, -3.6000000000000005, -3.900000000000001, -3.700000000000001, -3.7, -4.000000000000001, -3.900000000000001, -3.6000000000000005, -3.800000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -4.1000000000000005, -4.000000000000002, -3.8000000000000007, -3.800000000000001, -3.700000000000001, -4.100000000000001, -3.500000000000001, -4.100000000000001, -3.7000000000000006, -3.800000000000001, -3.8000000000000007, -3.7000000000000006, -3.8000000000000007, -3.8000000000000007, -3.7000000000000006, -3.9000000000000004, -3.700000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -3.7000000000000006, -3.9000000000000004, -3.900000000000001, -3.7000000000000006, -3.800000000000001, -4.100000000000001, -3.7000000000000006, -3.500000000000001, -3.800000000000001, -4.200000000000001, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -4.000000000000002, -3.7000000000000006, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -3.900000000000001, -3.700000000000001, -4.100000000000001, -3.7000000000000006, -3.900000000000001, -4.200000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001], "episode_lengths": [21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.62962264445979, "mean_inference_ms": 18.11749882926659, "mean_action_processing_ms": 0.9370666935735088, "mean_env_wait_ms": 1.5726018771918036, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07042763802000714, "StateBufferConnector_ms": 0.009299050732917593, "ViewRequirementAgentConnector_ms": 0.13128767158779395}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000, "num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 512000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 512000, "timers": {"training_iteration_time_ms": 174299.109, "load_time_ms": 1.148, "load_throughput": 3484002.907, "learn_time_ms": 173363.984, "learn_throughput": 23.073, "synch_weights_time_ms": 172.702}, "counters": {"num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "done": false, "episodes_total": 25806, "training_iteration": 128, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_03-02-09", "timestamp": 1680829329, "time_this_iter_s": 174.35490918159485, "time_total_s": 21990.301772594452, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7eff9479ee80>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014728cca0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 21990.301772594452, "timesteps_since_restore": 0, "iterations_since_restore": 128, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 6.34516129032258, "ram_util_percent": 23.82822580645162}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 160.6347816026339, "cur_kl_coeff": 539.9088047333989, "cur_lr": 0.01, "total_loss": 3.244202630954885, "policy_loss": 0.008567310978348057, "vf_loss": 0.23111262423216655, "vf_explained_var": 0.7887797197987957, "kl": 0.0055648706246204235, "entropy": 2.8972304497995682, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 119505.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000}, "sampler_results": {"episode_reward_max": -3.5000000000000004, "episode_reward_min": -4.300000000000001, "episode_reward_mean": -3.8984293193717283, "episode_len_mean": 21.0, "episode_media": {}, "episodes_this_iter": 191, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.100000000000001, -3.8000000000000007, -4.200000000000001, -3.8000000000000007, -4.100000000000001, -3.9000000000000012, -4.100000000000001, -4.200000000000001, -3.8000000000000007, -3.9000000000000012, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.200000000000001, -3.7000000000000006, -4.200000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -3.700000000000001, -4.200000000000001, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.6000000000000005, -3.700000000000001, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -3.8000000000000007, -3.800000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.6000000000000005, -3.900000000000001, -4.100000000000001, -3.9000000000000012, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.9000000000000004, -4.0, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.800000000000001, -3.7000000000000006, -4.000000000000001, -3.6000000000000005, -4.100000000000001, -3.600000000000001, -3.9000000000000012, -3.6000000000000005, -3.8000000000000007, -3.8000000000000007, -4.200000000000001, -3.9000000000000012, -3.8000000000000007, -4.100000000000001, -3.6000000000000005, -3.600000000000001, -4.000000000000001, -4.000000000000002, -3.800000000000001, -4.300000000000001, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -3.9000000000000012, -4.100000000000001, -4.000000000000002, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -4.1000000000000005, -3.900000000000001, -4.200000000000001, -3.900000000000001, -4.1000000000000005, -3.700000000000001, -3.9000000000000012, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -3.9000000000000012, -3.900000000000001, -3.7000000000000006, -3.9000000000000012, -3.800000000000001, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.6000000000000005, -4.000000000000002, -3.700000000000001, -3.500000000000001, -3.8000000000000007, -3.5000000000000004, -4.100000000000001, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -4.000000000000002, -3.900000000000001, -3.800000000000001, -3.900000000000001, -4.000000000000002, -3.9000000000000012, -3.700000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.800000000000001, -3.800000000000001, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -3.9000000000000012, -3.900000000000001, -4.100000000000001, -4.200000000000001, -3.600000000000001, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -3.7000000000000006, -3.7000000000000006, -3.9000000000000012, -3.800000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.600000000000001, -3.7000000000000006, -3.800000000000001, -3.900000000000001, -3.900000000000001, -4.1000000000000005, -4.000000000000001, -3.600000000000001, -4.000000000000002, -3.800000000000001, -3.900000000000001, -4.000000000000002, -3.8000000000000007, -3.9000000000000012, -4.000000000000001, -3.6, -4.000000000000002, -3.900000000000001, -4.000000000000002, -3.9000000000000004, -3.900000000000001, -4.000000000000001, -3.8000000000000003, -3.900000000000001, -3.900000000000001, -3.9000000000000004, -3.700000000000001, -4.000000000000002, -3.8000000000000007, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -3.800000000000001, -3.7000000000000006, -4.0, -3.900000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.62354722302523, "mean_inference_ms": 18.108228193095606, "mean_action_processing_ms": 0.9369755269285702, "mean_env_wait_ms": 1.5705007039335872, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0732893719098955, "StateBufferConnector_ms": 0.00915053003121421, "ViewRequirementAgentConnector_ms": 0.13380824583363157}}, "episode_reward_max": -3.5000000000000004, "episode_reward_min": -4.300000000000001, "episode_reward_mean": -3.8984293193717283, "episode_len_mean": 21.0, "episodes_this_iter": 191, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.100000000000001, -3.8000000000000007, -4.200000000000001, -3.8000000000000007, -4.100000000000001, -3.9000000000000012, -4.100000000000001, -4.200000000000001, -3.8000000000000007, -3.9000000000000012, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.200000000000001, -3.7000000000000006, -4.200000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -3.700000000000001, -4.200000000000001, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.6000000000000005, -3.700000000000001, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -3.8000000000000007, -3.800000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.6000000000000005, -3.900000000000001, -4.100000000000001, -3.9000000000000012, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.9000000000000004, -4.0, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.800000000000001, -3.7000000000000006, -4.000000000000001, -3.6000000000000005, -4.100000000000001, -3.600000000000001, -3.9000000000000012, -3.6000000000000005, -3.8000000000000007, -3.8000000000000007, -4.200000000000001, -3.9000000000000012, -3.8000000000000007, -4.100000000000001, -3.6000000000000005, -3.600000000000001, -4.000000000000001, -4.000000000000002, -3.800000000000001, -4.300000000000001, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -3.9000000000000012, -4.100000000000001, -4.000000000000002, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -4.1000000000000005, -3.900000000000001, -4.200000000000001, -3.900000000000001, -4.1000000000000005, -3.700000000000001, -3.9000000000000012, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -3.9000000000000012, -3.900000000000001, -3.7000000000000006, -3.9000000000000012, -3.800000000000001, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.6000000000000005, -4.000000000000002, -3.700000000000001, -3.500000000000001, -3.8000000000000007, -3.5000000000000004, -4.100000000000001, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -4.000000000000002, -3.900000000000001, -3.800000000000001, -3.900000000000001, -4.000000000000002, -3.9000000000000012, -3.700000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.800000000000001, -3.800000000000001, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -3.9000000000000012, -3.900000000000001, -4.100000000000001, -4.200000000000001, -3.600000000000001, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -3.7000000000000006, -3.7000000000000006, -3.9000000000000012, -3.800000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.600000000000001, -3.7000000000000006, -3.800000000000001, -3.900000000000001, -3.900000000000001, -4.1000000000000005, -4.000000000000001, -3.600000000000001, -4.000000000000002, -3.800000000000001, -3.900000000000001, -4.000000000000002, -3.8000000000000007, -3.9000000000000012, -4.000000000000001, -3.6, -4.000000000000002, -3.900000000000001, -4.000000000000002, -3.9000000000000004, -3.900000000000001, -4.000000000000001, -3.8000000000000003, -3.900000000000001, -3.900000000000001, -3.9000000000000004, -3.700000000000001, -4.000000000000002, -3.8000000000000007, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -3.800000000000001, -3.7000000000000006, -4.0, -3.900000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.62354722302523, "mean_inference_ms": 18.108228193095606, "mean_action_processing_ms": 0.9369755269285702, "mean_env_wait_ms": 1.5705007039335872, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0732893719098955, "StateBufferConnector_ms": 0.00915053003121421, "ViewRequirementAgentConnector_ms": 0.13380824583363157}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 516000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 516000, "timers": {"training_iteration_time_ms": 174244.546, "load_time_ms": 1.158, "load_throughput": 3454234.301, "learn_time_ms": 173303.136, "learn_throughput": 23.081, "synch_weights_time_ms": 177.02}, "counters": {"num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000}, "done": false, "episodes_total": 25997, "training_iteration": 129, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_03-05-03", "timestamp": 1680829503, "time_this_iter_s": 173.95933175086975, "time_total_s": 22164.26110434532, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7eff94791460>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff947c11f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 22164.26110434532, "timesteps_since_restore": 0, "iterations_since_restore": 129, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.367741935483871, "ram_util_percent": 23.806854838709686}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 283.4015135477948, "cur_kl_coeff": 539.9088047333989, "cur_lr": 0.01, "total_loss": 26.44769002230818, "policy_loss": 0.009705363315660307, "vf_loss": 0.21485499616271705, "vf_explained_var": 0.7578825060398348, "kl": 0.04856955269997832, "entropy": 2.880445344986454, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 120435.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000}, "sampler_results": {"episode_reward_max": -3.5000000000000004, "episode_reward_min": -10.8, "episode_reward_mean": -3.9750000000000005, "episode_len_mean": 20.831521739130434, "episode_media": {}, "episodes_this_iter": 184, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.8, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.6000000000000005, -3.9000000000000004, -3.800000000000001, -3.9000000000000012, -3.8000000000000007, -3.9000000000000012, -4.000000000000002, -3.7000000000000006, -10.1, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.800000000000001, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -3.6000000000000005, -3.800000000000001, -3.8000000000000007, -4.100000000000001, -3.800000000000001, -4.100000000000001, -3.800000000000001, -3.6000000000000005, -4.100000000000001, -3.600000000000001, -3.9000000000000012, -3.800000000000001, -3.600000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.500000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -3.700000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000002, -3.800000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.700000000000001, -3.900000000000001, -4.300000000000001, -4.100000000000001, -4.200000000000001, -3.800000000000001, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -3.700000000000001, -4.1000000000000005, -3.9000000000000004, -4.1000000000000005, -4.200000000000001, -4.100000000000001, -4.000000000000002, -4.100000000000001, -4.000000000000002, -3.9000000000000012, -3.800000000000001, -3.8000000000000007, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -4.100000000000001, -4.200000000000001, -3.900000000000001, -4.000000000000001, -3.9000000000000012, -4.000000000000002, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000002, -3.7000000000000006, -4.000000000000001, -3.800000000000001, -3.900000000000001, -4.000000000000001, -4.200000000000001, -3.7000000000000006, -3.900000000000001, -3.600000000000001, -3.900000000000001, -4.1000000000000005, -3.8000000000000007, -3.9000000000000004, -3.900000000000001, -3.700000000000001, -3.7000000000000006, -4.100000000000001, -4.200000000000001, -4.0, -4.000000000000001, -3.9000000000000012, -4.000000000000002, -4.100000000000001, -4.000000000000001, -3.7000000000000006, -4.0, -3.8000000000000007, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -3.800000000000001, -3.9000000000000004, -4.200000000000001, -4.100000000000001, -3.9000000000000012, -3.900000000000001, -4.100000000000001, -3.9000000000000012, -3.8000000000000003, -3.900000000000001, -4.300000000000001, -3.6000000000000005, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -3.700000000000001, -4.200000000000001, -3.900000000000001, -3.900000000000001, -4.0, -3.8000000000000007, -4.200000000000001, -4.000000000000002, -3.500000000000001, -3.9000000000000012, -3.7000000000000006, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.7000000000000006, -3.5000000000000004, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.6000000000000005, -3.8000000000000007, -3.900000000000001, -3.5000000000000004, -3.8000000000000007, -4.000000000000001, -4.000000000000002, -4.300000000000001, -3.900000000000001, -4.000000000000001, -3.9000000000000012, -4.100000000000001, -3.800000000000001, -4.000000000000002, -3.9000000000000012, -3.7000000000000006, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -3.800000000000001, -3.800000000000001, -4.0], "episode_lengths": [9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.627157125976298, "mean_inference_ms": 18.111824779587174, "mean_action_processing_ms": 0.9369082774919567, "mean_env_wait_ms": 1.5701447525687267, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07459676784017812, "StateBufferConnector_ms": 0.009612803873808487, "ViewRequirementAgentConnector_ms": 0.13621553130771802}}, "episode_reward_max": -3.5000000000000004, "episode_reward_min": -10.8, "episode_reward_mean": -3.9750000000000005, "episode_len_mean": 20.831521739130434, "episodes_this_iter": 184, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10.8, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.6000000000000005, -3.9000000000000004, -3.800000000000001, -3.9000000000000012, -3.8000000000000007, -3.9000000000000012, -4.000000000000002, -3.7000000000000006, -10.1, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.800000000000001, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -3.6000000000000005, -3.800000000000001, -3.8000000000000007, -4.100000000000001, -3.800000000000001, -4.100000000000001, -3.800000000000001, -3.6000000000000005, -4.100000000000001, -3.600000000000001, -3.9000000000000012, -3.800000000000001, -3.600000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.500000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -3.700000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000002, -3.800000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.700000000000001, -3.900000000000001, -4.300000000000001, -4.100000000000001, -4.200000000000001, -3.800000000000001, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -3.700000000000001, -4.1000000000000005, -3.9000000000000004, -4.1000000000000005, -4.200000000000001, -4.100000000000001, -4.000000000000002, -4.100000000000001, -4.000000000000002, -3.9000000000000012, -3.800000000000001, -3.8000000000000007, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -4.100000000000001, -4.200000000000001, -3.900000000000001, -4.000000000000001, -3.9000000000000012, -4.000000000000002, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000002, -3.7000000000000006, -4.000000000000001, -3.800000000000001, -3.900000000000001, -4.000000000000001, -4.200000000000001, -3.7000000000000006, -3.900000000000001, -3.600000000000001, -3.900000000000001, -4.1000000000000005, -3.8000000000000007, -3.9000000000000004, -3.900000000000001, -3.700000000000001, -3.7000000000000006, -4.100000000000001, -4.200000000000001, -4.0, -4.000000000000001, -3.9000000000000012, -4.000000000000002, -4.100000000000001, -4.000000000000001, -3.7000000000000006, -4.0, -3.8000000000000007, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -3.800000000000001, -3.9000000000000004, -4.200000000000001, -4.100000000000001, -3.9000000000000012, -3.900000000000001, -4.100000000000001, -3.9000000000000012, -3.8000000000000003, -3.900000000000001, -4.300000000000001, -3.6000000000000005, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -3.700000000000001, -4.200000000000001, -3.900000000000001, -3.900000000000001, -4.0, -3.8000000000000007, -4.200000000000001, -4.000000000000002, -3.500000000000001, -3.9000000000000012, -3.7000000000000006, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.7000000000000006, -3.5000000000000004, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.6000000000000005, -3.8000000000000007, -3.900000000000001, -3.5000000000000004, -3.8000000000000007, -4.000000000000001, -4.000000000000002, -4.300000000000001, -3.900000000000001, -4.000000000000001, -3.9000000000000012, -4.100000000000001, -3.800000000000001, -4.000000000000002, -3.9000000000000012, -3.7000000000000006, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -3.800000000000001, -3.800000000000001, -4.0], "episode_lengths": [9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.627157125976298, "mean_inference_ms": 18.111824779587174, "mean_action_processing_ms": 0.9369082774919567, "mean_env_wait_ms": 1.5701447525687267, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07459676784017812, "StateBufferConnector_ms": 0.009612803873808487, "ViewRequirementAgentConnector_ms": 0.13621553130771802}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000, "num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 520000, "timers": {"training_iteration_time_ms": 174300.025, "load_time_ms": 1.172, "load_throughput": 3412291.984, "learn_time_ms": 173352.069, "learn_throughput": 23.074, "synch_weights_time_ms": 179.097}, "counters": {"num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000}, "done": false, "episodes_total": 26181, "training_iteration": 130, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_03-07-58", "timestamp": 1680829678, "time_this_iter_s": 174.9024670124054, "time_total_s": 22339.163571357727, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01475e2fa0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff947c1280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 22339.163571357727, "timesteps_since_restore": 0, "iterations_since_restore": 130, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.459274193548387, "ram_util_percent": 23.802016129032264}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 276.4079564802108, "cur_kl_coeff": 809.8632071000982, "cur_lr": 0.01, "total_loss": 14.008891662558721, "policy_loss": 0.006615869778518875, "vf_loss": 0.30572378369829345, "vf_explained_var": 0.687392662289322, "kl": 0.016912179306972995, "entropy": 2.8938651182318247, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 121365.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_agent_steps_sampled": 524000, "num_agent_steps_trained": 524000}, "sampler_results": {"episode_reward_max": -3.3000000000000007, "episode_reward_min": -12.0, "episode_reward_mean": -4.056410256410258, "episode_len_mean": 20.71794871794872, "episode_media": {}, "episodes_this_iter": 195, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.7000000000000006, -3.800000000000001, -3.9000000000000004, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -3.900000000000001, -3.9000000000000012, -3.3000000000000007, -4.300000000000001, -3.8000000000000007, -3.900000000000001, -3.800000000000001, -3.5000000000000004, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -10.4, -4.100000000000001, -4.1000000000000005, -4.000000000000002, -3.6000000000000005, -4.100000000000001, -3.8000000000000007, -3.9000000000000004, -4.100000000000001, -3.900000000000001, -3.7000000000000006, -3.600000000000001, -3.9000000000000012, -4.100000000000001, -3.700000000000001, -4.100000000000001, -3.600000000000001, -3.8000000000000007, -4.1000000000000005, -3.800000000000001, -3.900000000000001, -3.900000000000001, -3.800000000000001, -4.200000000000001, -3.600000000000001, -3.6000000000000005, -4.0, -4.000000000000002, -3.900000000000001, -3.700000000000001, -3.900000000000001, -3.9000000000000012, -4.200000000000001, -3.500000000000001, -3.8000000000000007, -3.8000000000000007, -4.100000000000001, -3.9000000000000004, -4.000000000000002, -4.000000000000001, -3.800000000000001, -4.100000000000001, -3.6000000000000005, -4.100000000000001, -4.100000000000001, -3.7000000000000006, -3.8000000000000003, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.800000000000001, -4.000000000000001, -3.9000000000000012, -3.800000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.600000000000001, -4.000000000000002, -3.900000000000001, -4.1000000000000005, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -3.700000000000001, -3.600000000000001, -11.2, -3.600000000000001, -3.900000000000001, -3.6, -3.7000000000000006, -3.800000000000001, -3.500000000000001, -4.200000000000001, -12.0, -3.7000000000000006, -3.9000000000000012, -12.0, -3.7000000000000006, -4.0, -10.1, -3.8000000000000003, -3.8000000000000007, -3.8000000000000007, -3.7000000000000006, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -4.1000000000000005, -3.500000000000001, -3.900000000000001, -3.7000000000000006, -4.200000000000001, -3.9000000000000012, -4.000000000000001, -3.8000000000000007, -3.9000000000000012, -4.200000000000001, -4.300000000000001, -4.0, -4.000000000000001, -3.900000000000001, -3.9000000000000004, -3.900000000000001, -4.000000000000002, -3.800000000000001, -3.600000000000001, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -3.700000000000001, -3.8000000000000003, -4.200000000000001, -4.100000000000001, -3.9000000000000012, -3.8000000000000007, -4.200000000000001, -4.200000000000001, -3.8000000000000007, -4.1000000000000005, -3.700000000000001, -4.200000000000001, -4.200000000000001, -4.200000000000001, -3.7000000000000006, -3.800000000000001, -3.900000000000001, -3.9000000000000012, -4.300000000000001, -4.0, -3.800000000000001, -3.800000000000001, -3.8000000000000003, -3.900000000000001, -3.700000000000001, -3.7000000000000006, -3.9000000000000012, -3.400000000000001, -4.0, -3.7000000000000006, -3.900000000000001, -4.000000000000001, -3.8000000000000003, -3.900000000000001, -3.7000000000000006, -3.600000000000001, -3.800000000000001, -4.100000000000001, -3.900000000000001, -3.9000000000000004, -4.200000000000001, -3.6000000000000005, -3.7000000000000006, -3.7000000000000006, -3.900000000000001, -3.600000000000001, -3.6000000000000005, -3.8000000000000007, -3.9000000000000012, -3.700000000000001, -3.700000000000001, -4.100000000000001, -3.9000000000000004, -3.700000000000001, -3.9000000000000012, -3.8000000000000007, -3.8000000000000007], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 16, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.62678978308075, "mean_inference_ms": 18.12134720588069, "mean_action_processing_ms": 0.9371037225202016, "mean_env_wait_ms": 1.5717108925439014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07893440050956531, "StateBufferConnector_ms": 0.010051360497107873, "ViewRequirementAgentConnector_ms": 0.14404785938752004}}, "episode_reward_max": -3.3000000000000007, "episode_reward_min": -12.0, "episode_reward_mean": -4.056410256410258, "episode_len_mean": 20.71794871794872, "episodes_this_iter": 195, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.7000000000000006, -3.800000000000001, -3.9000000000000004, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -3.900000000000001, -3.9000000000000012, -3.3000000000000007, -4.300000000000001, -3.8000000000000007, -3.900000000000001, -3.800000000000001, -3.5000000000000004, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -10.4, -4.100000000000001, -4.1000000000000005, -4.000000000000002, -3.6000000000000005, -4.100000000000001, -3.8000000000000007, -3.9000000000000004, -4.100000000000001, -3.900000000000001, -3.7000000000000006, -3.600000000000001, -3.9000000000000012, -4.100000000000001, -3.700000000000001, -4.100000000000001, -3.600000000000001, -3.8000000000000007, -4.1000000000000005, -3.800000000000001, -3.900000000000001, -3.900000000000001, -3.800000000000001, -4.200000000000001, -3.600000000000001, -3.6000000000000005, -4.0, -4.000000000000002, -3.900000000000001, -3.700000000000001, -3.900000000000001, -3.9000000000000012, -4.200000000000001, -3.500000000000001, -3.8000000000000007, -3.8000000000000007, -4.100000000000001, -3.9000000000000004, -4.000000000000002, -4.000000000000001, -3.800000000000001, -4.100000000000001, -3.6000000000000005, -4.100000000000001, -4.100000000000001, -3.7000000000000006, -3.8000000000000003, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.800000000000001, -4.000000000000001, -3.9000000000000012, -3.800000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.600000000000001, -4.000000000000002, -3.900000000000001, -4.1000000000000005, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -3.700000000000001, -3.600000000000001, -11.2, -3.600000000000001, -3.900000000000001, -3.6, -3.7000000000000006, -3.800000000000001, -3.500000000000001, -4.200000000000001, -12.0, -3.7000000000000006, -3.9000000000000012, -12.0, -3.7000000000000006, -4.0, -10.1, -3.8000000000000003, -3.8000000000000007, -3.8000000000000007, -3.7000000000000006, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -4.1000000000000005, -3.500000000000001, -3.900000000000001, -3.7000000000000006, -4.200000000000001, -3.9000000000000012, -4.000000000000001, -3.8000000000000007, -3.9000000000000012, -4.200000000000001, -4.300000000000001, -4.0, -4.000000000000001, -3.900000000000001, -3.9000000000000004, -3.900000000000001, -4.000000000000002, -3.800000000000001, -3.600000000000001, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -3.700000000000001, -3.8000000000000003, -4.200000000000001, -4.100000000000001, -3.9000000000000012, -3.8000000000000007, -4.200000000000001, -4.200000000000001, -3.8000000000000007, -4.1000000000000005, -3.700000000000001, -4.200000000000001, -4.200000000000001, -4.200000000000001, -3.7000000000000006, -3.800000000000001, -3.900000000000001, -3.9000000000000012, -4.300000000000001, -4.0, -3.800000000000001, -3.800000000000001, -3.8000000000000003, -3.900000000000001, -3.700000000000001, -3.7000000000000006, -3.9000000000000012, -3.400000000000001, -4.0, -3.7000000000000006, -3.900000000000001, -4.000000000000001, -3.8000000000000003, -3.900000000000001, -3.7000000000000006, -3.600000000000001, -3.800000000000001, -4.100000000000001, -3.900000000000001, -3.9000000000000004, -4.200000000000001, -3.6000000000000005, -3.7000000000000006, -3.7000000000000006, -3.900000000000001, -3.600000000000001, -3.6000000000000005, -3.8000000000000007, -3.9000000000000012, -3.700000000000001, -3.700000000000001, -4.100000000000001, -3.9000000000000004, -3.700000000000001, -3.9000000000000012, -3.8000000000000007, -3.8000000000000007], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 17, 21, 21, 16, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.62678978308075, "mean_inference_ms": 18.12134720588069, "mean_action_processing_ms": 0.9371037225202016, "mean_env_wait_ms": 1.5717108925439014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07893440050956531, "StateBufferConnector_ms": 0.010051360497107873, "ViewRequirementAgentConnector_ms": 0.14404785938752004}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 524000, "num_agent_steps_trained": 524000, "num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 524000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 524000, "timers": {"training_iteration_time_ms": 174373.104, "load_time_ms": 1.179, "load_throughput": 3392557.782, "learn_time_ms": 173423.919, "learn_throughput": 23.065, "synch_weights_time_ms": 178.625}, "counters": {"num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_agent_steps_sampled": 524000, "num_agent_steps_trained": 524000}, "done": false, "episodes_total": 26376, "training_iteration": 131, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_03-10-53", "timestamp": 1680829853, "time_this_iter_s": 174.3494029045105, "time_total_s": 22513.512974262238, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476d7e20>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7effc006ca60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 22513.512974262238, "timesteps_since_restore": 0, "iterations_since_restore": 131, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.318951612903225, "ram_util_percent": 23.80120967741936}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 470.68037840525307, "cur_kl_coeff": 809.8632071000982, "cur_lr": 0.01, "total_loss": 63.10986160208141, "policy_loss": 0.01050778323263731, "vf_loss": 0.227530763466512, "vf_explained_var": 0.7367442394456556, "kl": 0.0776326446653344, "entropy": 2.863523648631188, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 122295.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "sampler_results": {"episode_reward_max": -3.4000000000000004, "episode_reward_min": -10.7, "episode_reward_mean": -3.9635416666666674, "episode_len_mean": 20.828125, "episode_media": {}, "episodes_this_iter": 192, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.600000000000001, -4.100000000000001, -4.0, -4.000000000000001, -3.7000000000000006, -3.800000000000001, -3.900000000000001, -4.000000000000001, -3.700000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -10.7, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.9000000000000012, -4.1000000000000005, -3.8000000000000007, -3.700000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000001, -3.800000000000001, -4.000000000000001, -3.7000000000000006, -3.800000000000001, -3.9000000000000012, -4.0, -3.900000000000001, -3.9000000000000004, -4.100000000000001, -3.8000000000000007, -3.700000000000001, -3.500000000000001, -4.100000000000001, -3.6000000000000014, -4.000000000000001, -4.200000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.600000000000001, -4.000000000000001, -3.9000000000000012, -3.8000000000000007, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.5000000000000004, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.9000000000000004, -3.900000000000001, -4.100000000000001, -3.700000000000001, -4.000000000000001, -3.800000000000001, -3.900000000000001, -4.000000000000002, -4.100000000000001, -4.100000000000001, -4.000000000000002, -3.9000000000000012, -3.9000000000000012, -4.1000000000000005, -3.700000000000001, -4.100000000000001, -3.8000000000000007, -4.200000000000001, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.5000000000000004, -4.0, -3.600000000000001, -3.4000000000000004, -3.9000000000000004, -3.9000000000000004, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.700000000000001, -3.800000000000001, -3.7000000000000006, -4.100000000000001, -3.9000000000000012, -4.100000000000001, -3.900000000000001, -3.9000000000000012, -4.200000000000001, -4.0, -10.1, -4.300000000000001, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -4.4, -3.6000000000000005, -3.9000000000000004, -3.7000000000000006, -3.900000000000001, -3.7000000000000006, -4.100000000000001, -3.8000000000000007, -3.6000000000000014, -3.900000000000001, -3.9000000000000012, -3.6000000000000005, -3.6000000000000014, -3.800000000000001, -4.000000000000002, -3.9000000000000004, -4.100000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -4.200000000000001, -3.6000000000000005, -3.900000000000001, -3.9000000000000012, -3.8000000000000007, -3.8000000000000007, -3.7000000000000006, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.9000000000000012, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.0, -3.8000000000000007, -3.700000000000001, -4.000000000000001, -3.9000000000000004, -3.700000000000001, -4.000000000000001, -3.800000000000001, -4.1000000000000005, -4.100000000000001, -3.8000000000000007, -3.700000000000001, -3.800000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -3.900000000000001, -3.800000000000001, -4.100000000000001, -3.900000000000001, -3.7000000000000006, -3.7000000000000006, -3.800000000000001, -3.9000000000000012, -3.6, -3.7000000000000006, -3.900000000000001, -3.700000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -3.600000000000001, -4.000000000000001, -4.100000000000001, -3.600000000000001, -3.8000000000000007, -3.900000000000001, -3.7000000000000006, -4.100000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000003, -4.000000000000002, -4.1000000000000005, -4.0, -3.700000000000001, -4.000000000000001, -3.8000000000000007, -3.600000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.627512163696425, "mean_inference_ms": 18.12684283913062, "mean_action_processing_ms": 0.9378956088465481, "mean_env_wait_ms": 1.569743945143311, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07780144611994426, "StateBufferConnector_ms": 0.00989772379398346, "ViewRequirementAgentConnector_ms": 0.1426114390293757}}, "episode_reward_max": -3.4000000000000004, "episode_reward_min": -10.7, "episode_reward_mean": -3.9635416666666674, "episode_len_mean": 20.828125, "episodes_this_iter": 192, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.600000000000001, -4.100000000000001, -4.0, -4.000000000000001, -3.7000000000000006, -3.800000000000001, -3.900000000000001, -4.000000000000001, -3.700000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -10.7, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.9000000000000012, -4.1000000000000005, -3.8000000000000007, -3.700000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000001, -3.800000000000001, -4.000000000000001, -3.7000000000000006, -3.800000000000001, -3.9000000000000012, -4.0, -3.900000000000001, -3.9000000000000004, -4.100000000000001, -3.8000000000000007, -3.700000000000001, -3.500000000000001, -4.100000000000001, -3.6000000000000014, -4.000000000000001, -4.200000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.600000000000001, -4.000000000000001, -3.9000000000000012, -3.8000000000000007, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.5000000000000004, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.9000000000000004, -3.900000000000001, -4.100000000000001, -3.700000000000001, -4.000000000000001, -3.800000000000001, -3.900000000000001, -4.000000000000002, -4.100000000000001, -4.100000000000001, -4.000000000000002, -3.9000000000000012, -3.9000000000000012, -4.1000000000000005, -3.700000000000001, -4.100000000000001, -3.8000000000000007, -4.200000000000001, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.5000000000000004, -4.0, -3.600000000000001, -3.4000000000000004, -3.9000000000000004, -3.9000000000000004, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.700000000000001, -3.800000000000001, -3.7000000000000006, -4.100000000000001, -3.9000000000000012, -4.100000000000001, -3.900000000000001, -3.9000000000000012, -4.200000000000001, -4.0, -10.1, -4.300000000000001, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -4.4, -3.6000000000000005, -3.9000000000000004, -3.7000000000000006, -3.900000000000001, -3.7000000000000006, -4.100000000000001, -3.8000000000000007, -3.6000000000000014, -3.900000000000001, -3.9000000000000012, -3.6000000000000005, -3.6000000000000014, -3.800000000000001, -4.000000000000002, -3.9000000000000004, -4.100000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -4.200000000000001, -3.6000000000000005, -3.900000000000001, -3.9000000000000012, -3.8000000000000007, -3.8000000000000007, -3.7000000000000006, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.9000000000000012, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.0, -3.8000000000000007, -3.700000000000001, -4.000000000000001, -3.9000000000000004, -3.700000000000001, -4.000000000000001, -3.800000000000001, -4.1000000000000005, -4.100000000000001, -3.8000000000000007, -3.700000000000001, -3.800000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -3.900000000000001, -3.800000000000001, -4.100000000000001, -3.900000000000001, -3.7000000000000006, -3.7000000000000006, -3.800000000000001, -3.9000000000000012, -3.6, -3.7000000000000006, -3.900000000000001, -3.700000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -3.600000000000001, -4.000000000000001, -4.100000000000001, -3.600000000000001, -3.8000000000000007, -3.900000000000001, -3.7000000000000006, -4.100000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000003, -4.000000000000002, -4.1000000000000005, -4.0, -3.700000000000001, -4.000000000000001, -3.8000000000000007, -3.600000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.627512163696425, "mean_inference_ms": 18.12684283913062, "mean_action_processing_ms": 0.9378956088465481, "mean_env_wait_ms": 1.569743945143311, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07780144611994426, "StateBufferConnector_ms": 0.00989772379398346, "ViewRequirementAgentConnector_ms": 0.1426114390293757}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 528000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 174378.545, "load_time_ms": 1.177, "load_throughput": 3399500.729, "learn_time_ms": 173422.521, "learn_throughput": 23.065, "synch_weights_time_ms": 178.804}, "counters": {"num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "episodes_total": 26568, "training_iteration": 132, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_03-13-47", "timestamp": 1680830027, "time_this_iter_s": 174.2149703502655, "time_total_s": 22687.727944612503, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7eff9479a070>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff947c11f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 22687.727944612503, "timesteps_since_restore": 0, "iterations_since_restore": 132, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.3112903225806445, "ram_util_percent": 23.819758064516133}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 260.3289749730018, "cur_kl_coeff": 1214.7948106501476, "cur_lr": 0.01, "total_loss": 21.8869849704206, "policy_loss": -0.00016459452629249583, "vf_loss": 0.21561162428509806, "vf_explained_var": 0.7288160738765552, "kl": 0.017839669784973346, "entropy": 2.8945570376611527, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 123225.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_agent_steps_sampled": 532000, "num_agent_steps_trained": 532000}, "sampler_results": {"episode_reward_max": -3.400000000000001, "episode_reward_min": -12.2, "episode_reward_mean": -3.963917525773197, "episode_len_mean": 20.917525773195877, "episode_media": {}, "episodes_this_iter": 194, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.000000000000001, -3.400000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.0, -4.100000000000001, -3.8000000000000007, -4.000000000000002, -4.000000000000001, -3.8000000000000007, -3.800000000000001, -4.0, -4.100000000000001, -3.7000000000000006, -4.100000000000001, -3.7000000000000006, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -3.700000000000001, -3.900000000000001, -4.000000000000002, -3.7000000000000006, -3.800000000000001, -3.800000000000001, -3.7, -4.200000000000001, -4.100000000000001, -3.8000000000000007, -3.9000000000000012, -3.8000000000000007, -3.7000000000000006, -4.000000000000001, -3.7000000000000006, -3.800000000000001, -4.0, -4.300000000000001, -4.0, -3.900000000000001, -4.0, -4.000000000000001, -4.100000000000001, -3.6000000000000005, -4.100000000000001, -3.8000000000000007, -3.9000000000000012, -3.700000000000001, -4.100000000000001, -3.900000000000001, -3.6000000000000005, -3.9000000000000004, -3.800000000000001, -4.100000000000001, -3.9000000000000012, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -4.200000000000001, -3.700000000000001, -3.7000000000000006, -4.200000000000001, -3.900000000000001, -3.800000000000001, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -3.8000000000000007, -4.100000000000001, -4.100000000000001, -3.7000000000000006, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -3.800000000000001, -3.9000000000000012, -3.8000000000000007, -12.2, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -3.700000000000001, -3.900000000000001, -3.700000000000001, -3.700000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000002, -3.700000000000001, -10.8, -3.800000000000001, -4.300000000000001, -4.200000000000001, -3.900000000000001, -3.700000000000001, -3.700000000000001, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -3.900000000000001, -3.8000000000000007, -3.700000000000001, -4.000000000000002, -3.9000000000000004, -3.900000000000001, -3.8000000000000007, -3.700000000000001, -4.200000000000001, -3.800000000000001, -3.7, -3.800000000000001, -3.9000000000000012, -3.800000000000001, -3.7000000000000006, -3.8000000000000007, -3.8000000000000007, -3.700000000000001, -3.8000000000000007, -3.900000000000001, -3.700000000000001, -3.900000000000001, -4.100000000000001, -4.200000000000001, -3.700000000000001, -3.800000000000001, -3.7, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.800000000000001, -3.9000000000000012, -3.900000000000001, -3.700000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.300000000000001, -4.100000000000001, -3.700000000000001, -3.800000000000001, -3.7000000000000006, -4.1000000000000005, -4.000000000000002, -4.300000000000001, -3.8000000000000007, -3.900000000000001, -3.500000000000001, -3.8000000000000003, -3.8000000000000007, -4.000000000000001, -3.7000000000000006, -3.700000000000001, -4.000000000000001, -4.0, -4.100000000000001, -3.500000000000001, -3.800000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -4.0, -3.8000000000000003, -4.200000000000001, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -4.000000000000002, -3.7000000000000006, -4.000000000000001, -4.0, -4.000000000000001, -3.9000000000000012, -3.7000000000000006, -3.8000000000000007, -3.7000000000000006, -4.000000000000001, -3.7000000000000006, -3.5000000000000004, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -3.900000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.626041379026992, "mean_inference_ms": 18.12476884119029, "mean_action_processing_ms": 0.9372665926659882, "mean_env_wait_ms": 1.5698567777476637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07249264372992761, "StateBufferConnector_ms": 0.009495327153156713, "ViewRequirementAgentConnector_ms": 0.13371570823118858}}, "episode_reward_max": -3.400000000000001, "episode_reward_min": -12.2, "episode_reward_mean": -3.963917525773197, "episode_len_mean": 20.917525773195877, "episodes_this_iter": 194, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.000000000000001, -3.400000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.0, -4.100000000000001, -3.8000000000000007, -4.000000000000002, -4.000000000000001, -3.8000000000000007, -3.800000000000001, -4.0, -4.100000000000001, -3.7000000000000006, -4.100000000000001, -3.7000000000000006, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -3.700000000000001, -3.900000000000001, -4.000000000000002, -3.7000000000000006, -3.800000000000001, -3.800000000000001, -3.7, -4.200000000000001, -4.100000000000001, -3.8000000000000007, -3.9000000000000012, -3.8000000000000007, -3.7000000000000006, -4.000000000000001, -3.7000000000000006, -3.800000000000001, -4.0, -4.300000000000001, -4.0, -3.900000000000001, -4.0, -4.000000000000001, -4.100000000000001, -3.6000000000000005, -4.100000000000001, -3.8000000000000007, -3.9000000000000012, -3.700000000000001, -4.100000000000001, -3.900000000000001, -3.6000000000000005, -3.9000000000000004, -3.800000000000001, -4.100000000000001, -3.9000000000000012, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -4.200000000000001, -3.700000000000001, -3.7000000000000006, -4.200000000000001, -3.900000000000001, -3.800000000000001, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -3.8000000000000007, -4.100000000000001, -4.100000000000001, -3.7000000000000006, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -3.800000000000001, -3.9000000000000012, -3.8000000000000007, -12.2, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -3.700000000000001, -3.900000000000001, -3.700000000000001, -3.700000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000002, -3.700000000000001, -10.8, -3.800000000000001, -4.300000000000001, -4.200000000000001, -3.900000000000001, -3.700000000000001, -3.700000000000001, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -3.900000000000001, -3.8000000000000007, -3.700000000000001, -4.000000000000002, -3.9000000000000004, -3.900000000000001, -3.8000000000000007, -3.700000000000001, -4.200000000000001, -3.800000000000001, -3.7, -3.800000000000001, -3.9000000000000012, -3.800000000000001, -3.7000000000000006, -3.8000000000000007, -3.8000000000000007, -3.700000000000001, -3.8000000000000007, -3.900000000000001, -3.700000000000001, -3.900000000000001, -4.100000000000001, -4.200000000000001, -3.700000000000001, -3.800000000000001, -3.7, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.800000000000001, -3.9000000000000012, -3.900000000000001, -3.700000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.300000000000001, -4.100000000000001, -3.700000000000001, -3.800000000000001, -3.7000000000000006, -4.1000000000000005, -4.000000000000002, -4.300000000000001, -3.8000000000000007, -3.900000000000001, -3.500000000000001, -3.8000000000000003, -3.8000000000000007, -4.000000000000001, -3.7000000000000006, -3.700000000000001, -4.000000000000001, -4.0, -4.100000000000001, -3.500000000000001, -3.800000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -4.0, -3.8000000000000003, -4.200000000000001, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -4.000000000000002, -3.7000000000000006, -4.000000000000001, -4.0, -4.000000000000001, -3.9000000000000012, -3.7000000000000006, -3.8000000000000007, -3.7000000000000006, -4.000000000000001, -3.7000000000000006, -3.5000000000000004, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -3.900000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 18, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.626041379026992, "mean_inference_ms": 18.12476884119029, "mean_action_processing_ms": 0.9372665926659882, "mean_env_wait_ms": 1.5698567777476637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07249264372992761, "StateBufferConnector_ms": 0.009495327153156713, "ViewRequirementAgentConnector_ms": 0.13371570823118858}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 532000, "num_agent_steps_trained": 532000, "num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 532000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 532000, "timers": {"training_iteration_time_ms": 174391.33, "load_time_ms": 1.181, "load_throughput": 3386326.498, "learn_time_ms": 173433.366, "learn_throughput": 23.064, "synch_weights_time_ms": 179.213}, "counters": {"num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_agent_steps_sampled": 532000, "num_agent_steps_trained": 532000}, "done": false, "episodes_total": 26762, "training_iteration": 133, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_03-16-42", "timestamp": 1680830202, "time_this_iter_s": 175.05127787590027, "time_total_s": 22862.779222488403, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0147659dc0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff947d00d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 22862.779222488403, "timesteps_since_restore": 0, "iterations_since_restore": 133, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.528915662650602, "ram_util_percent": 23.803212851405625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 674.9711284350324, "cur_kl_coeff": 1214.7948106501476, "cur_lr": 0.01, "total_loss": Infinity, "policy_loss": 0.019903278132520054, "vf_loss": 0.22659852403786876, "vf_explained_var": 0.7602618218750082, "kl": Infinity, "entropy": 2.6201541741689045, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 124155.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_agent_steps_sampled": 536000, "num_agent_steps_trained": 536000}, "sampler_results": {"episode_reward_max": -3.500000000000001, "episode_reward_min": -10.3, "episode_reward_mean": -3.9809523809523815, "episode_len_mean": 20.91005291005291, "episode_media": {}, "episodes_this_iter": 189, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.000000000000001, -3.6000000000000005, -3.8000000000000007, -4.200000000000001, -3.9000000000000012, -4.000000000000001, -3.6000000000000005, -4.000000000000002, -4.200000000000001, -3.900000000000001, -4.100000000000001, -3.9000000000000017, -3.900000000000001, -10.3, -4.000000000000001, -3.800000000000001, -4.200000000000001, -4.300000000000001, -4.100000000000001, -4.100000000000001, -3.9000000000000012, -3.7000000000000006, -3.8000000000000007, -3.6000000000000005, -4.000000000000001, -4.100000000000001, -3.800000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000002, -3.8000000000000007, -4.100000000000001, -4.000000000000002, -3.8000000000000007, -3.7000000000000006, -3.800000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.7000000000000006, -3.8000000000000007, -4.100000000000001, -4.100000000000001, -4.100000000000001, -3.800000000000001, -3.900000000000001, -3.6000000000000005, -4.400000000000001, -4.100000000000001, -3.9000000000000012, -4.100000000000001, -4.1000000000000005, -4.200000000000001, -4.100000000000001, -3.900000000000001, -3.9000000000000012, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -3.600000000000001, -3.900000000000001, -4.000000000000002, -3.900000000000001, -3.9000000000000004, -3.800000000000001, -4.000000000000001, -4.000000000000002, -4.000000000000001, -4.100000000000001, -4.100000000000001, -3.9000000000000012, -4.100000000000001, -4.1000000000000005, -3.900000000000001, -3.600000000000001, -3.900000000000001, -3.900000000000001, -3.600000000000001, -3.9000000000000004, -4.000000000000001, -4.400000000000002, -4.0, -4.000000000000001, -3.9000000000000004, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -3.9000000000000004, -3.7000000000000006, -3.500000000000001, -4.200000000000001, -3.700000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -3.800000000000001, -4.000000000000001, -3.900000000000001, -3.9000000000000012, -4.000000000000001, -3.900000000000001, -3.600000000000001, -4.000000000000002, -4.100000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.7000000000000006, -4.000000000000002, -4.000000000000001, -4.300000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -4.100000000000001, -3.800000000000001, -4.100000000000001, -3.9000000000000012, -3.7000000000000006, -4.000000000000001, -4.400000000000001, -3.900000000000001, -3.9000000000000012, -3.700000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.600000000000001, -4.0, -4.200000000000001, -4.000000000000001, -4.000000000000002, -3.900000000000001, -3.9000000000000012, -3.900000000000001, -4.200000000000001, -3.9000000000000012, -4.200000000000001, -3.800000000000001, -4.000000000000002, -4.1000000000000005, -4.000000000000002, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -3.8000000000000003, -3.7000000000000006, -4.000000000000001, -3.7000000000000006, -4.200000000000001, -3.700000000000001, -3.7000000000000006, -4.1000000000000005, -4.000000000000001, -3.9000000000000004, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -4.200000000000001, -3.700000000000001, -4.000000000000002, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -3.800000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.625986972689432, "mean_inference_ms": 18.139771523763446, "mean_action_processing_ms": 0.9374525357175991, "mean_env_wait_ms": 1.572366608771573, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07638187004775597, "StateBufferConnector_ms": 0.009872295238353588, "ViewRequirementAgentConnector_ms": 0.1413026184001297}}, "episode_reward_max": -3.500000000000001, "episode_reward_min": -10.3, "episode_reward_mean": -3.9809523809523815, "episode_len_mean": 20.91005291005291, "episodes_this_iter": 189, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.000000000000001, -3.6000000000000005, -3.8000000000000007, -4.200000000000001, -3.9000000000000012, -4.000000000000001, -3.6000000000000005, -4.000000000000002, -4.200000000000001, -3.900000000000001, -4.100000000000001, -3.9000000000000017, -3.900000000000001, -10.3, -4.000000000000001, -3.800000000000001, -4.200000000000001, -4.300000000000001, -4.100000000000001, -4.100000000000001, -3.9000000000000012, -3.7000000000000006, -3.8000000000000007, -3.6000000000000005, -4.000000000000001, -4.100000000000001, -3.800000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000002, -3.8000000000000007, -4.100000000000001, -4.000000000000002, -3.8000000000000007, -3.7000000000000006, -3.800000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.7000000000000006, -3.8000000000000007, -4.100000000000001, -4.100000000000001, -4.100000000000001, -3.800000000000001, -3.900000000000001, -3.6000000000000005, -4.400000000000001, -4.100000000000001, -3.9000000000000012, -4.100000000000001, -4.1000000000000005, -4.200000000000001, -4.100000000000001, -3.900000000000001, -3.9000000000000012, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -3.600000000000001, -3.900000000000001, -4.000000000000002, -3.900000000000001, -3.9000000000000004, -3.800000000000001, -4.000000000000001, -4.000000000000002, -4.000000000000001, -4.100000000000001, -4.100000000000001, -3.9000000000000012, -4.100000000000001, -4.1000000000000005, -3.900000000000001, -3.600000000000001, -3.900000000000001, -3.900000000000001, -3.600000000000001, -3.9000000000000004, -4.000000000000001, -4.400000000000002, -4.0, -4.000000000000001, -3.9000000000000004, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -3.9000000000000004, -3.7000000000000006, -3.500000000000001, -4.200000000000001, -3.700000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -3.800000000000001, -4.000000000000001, -3.900000000000001, -3.9000000000000012, -4.000000000000001, -3.900000000000001, -3.600000000000001, -4.000000000000002, -4.100000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.7000000000000006, -4.000000000000002, -4.000000000000001, -4.300000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -4.100000000000001, -3.800000000000001, -4.100000000000001, -3.9000000000000012, -3.7000000000000006, -4.000000000000001, -4.400000000000001, -3.900000000000001, -3.9000000000000012, -3.700000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.600000000000001, -4.0, -4.200000000000001, -4.000000000000001, -4.000000000000002, -3.900000000000001, -3.9000000000000012, -3.900000000000001, -4.200000000000001, -3.9000000000000012, -4.200000000000001, -3.800000000000001, -4.000000000000002, -4.1000000000000005, -4.000000000000002, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -3.8000000000000003, -3.7000000000000006, -4.000000000000001, -3.7000000000000006, -4.200000000000001, -3.700000000000001, -3.7000000000000006, -4.1000000000000005, -4.000000000000001, -3.9000000000000004, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -4.200000000000001, -3.700000000000001, -4.000000000000002, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -3.800000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.625986972689432, "mean_inference_ms": 18.139771523763446, "mean_action_processing_ms": 0.9374525357175991, "mean_env_wait_ms": 1.572366608771573, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07638187004775597, "StateBufferConnector_ms": 0.009872295238353588, "ViewRequirementAgentConnector_ms": 0.1413026184001297}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 536000, "num_agent_steps_trained": 536000, "num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 536000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 536000, "timers": {"training_iteration_time_ms": 174444.463, "load_time_ms": 1.191, "load_throughput": 3358331.365, "learn_time_ms": 173487.213, "learn_throughput": 23.056, "synch_weights_time_ms": 178.525}, "counters": {"num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_agent_steps_sampled": 536000, "num_agent_steps_trained": 536000}, "done": false, "episodes_total": 26951, "training_iteration": 134, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_03-19-37", "timestamp": 1680830377, "time_this_iter_s": 174.81764721870422, "time_total_s": 23037.596869707108, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01473e2d90>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7f014728cca0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 23037.596869707108, "timesteps_since_restore": 0, "iterations_since_restore": 134, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.3297188755020075, "ram_util_percent": 23.802008032128516}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 970.2867662122172, "cur_kl_coeff": 1822.1922159752214, "cur_lr": 0.01, "total_loss": Infinity, "policy_loss": 0.008800853554519915, "vf_loss": 0.34149962307945375, "vf_explained_var": 0.7102805084438735, "kl": Infinity, "entropy": 2.6309173286602063, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 125085.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "sampler_results": {"episode_reward_max": -3.7000000000000006, "episode_reward_min": -11.4, "episode_reward_mean": -4.077202072538861, "episode_len_mean": 20.94818652849741, "episode_media": {}, "episodes_this_iter": 193, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.300000000000001, -4.300000000000001, -4.000000000000001, -4.000000000000001, -3.800000000000001, -4.200000000000001, -4.100000000000001, -3.9000000000000012, -4.400000000000001, -4.200000000000001, -4.300000000000001, -4.100000000000001, -4.200000000000001, -4.300000000000002, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -4.300000000000001, -3.9000000000000012, -4.100000000000001, -4.200000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -4.200000000000001, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -4.1000000000000005, -3.7000000000000006, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.200000000000001, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.300000000000001, -4.000000000000001, -4.000000000000002, -4.200000000000001, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.300000000000001, -4.1000000000000005, -4.100000000000001, -3.9000000000000012, -4.100000000000001, -4.200000000000001, -4.200000000000001, -4.000000000000002, -4.000000000000001, -4.000000000000002, -4.200000000000001, -4.000000000000001, -3.9000000000000004, -4.0, -3.7000000000000006, -3.9000000000000012, -4.000000000000002, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.300000000000001, -4.200000000000001, -11.4, -4.000000000000001, -3.900000000000001, -4.000000000000002, -4.400000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -4.300000000000001, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.0, -4.100000000000001, -4.300000000000001, -4.300000000000001, -4.0, -4.200000000000001, -4.000000000000001, -4.300000000000001, -4.100000000000001, -4.200000000000001, -4.0, -4.200000000000001, -4.100000000000001, -4.000000000000002, -3.900000000000001, -4.000000000000001, -3.9000000000000004, -3.900000000000001, -4.000000000000001, -3.700000000000001, -4.300000000000001, -4.200000000000001, -4.000000000000002, -3.900000000000001, -3.9000000000000012, -3.800000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -4.300000000000001, -3.9000000000000012, -4.000000000000001, -4.000000000000002, -4.300000000000001, -3.9000000000000012, -4.200000000000001, -4.300000000000001, -4.0, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.7000000000000006, -3.700000000000001, -4.000000000000001, -4.000000000000001, -3.800000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000002, -4.200000000000001, -4.100000000000001, -4.1000000000000005, -4.400000000000001, -4.0, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -4.000000000000002, -3.9000000000000012, -4.000000000000001, -3.900000000000001, -4.1000000000000005, -3.9000000000000012, -4.100000000000001, -3.800000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.1000000000000005, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -3.9000000000000004, -4.300000000000001, -4.000000000000001, -3.7000000000000006, -4.100000000000001, -3.9000000000000012], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.620788699103647, "mean_inference_ms": 18.116937277116005, "mean_action_processing_ms": 0.9371425068787578, "mean_env_wait_ms": 1.5678060253662058, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07625589716619778, "StateBufferConnector_ms": 0.010005303615115467, "ViewRequirementAgentConnector_ms": 0.1403646765595273}}, "episode_reward_max": -3.7000000000000006, "episode_reward_min": -11.4, "episode_reward_mean": -4.077202072538861, "episode_len_mean": 20.94818652849741, "episodes_this_iter": 193, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.300000000000001, -4.300000000000001, -4.000000000000001, -4.000000000000001, -3.800000000000001, -4.200000000000001, -4.100000000000001, -3.9000000000000012, -4.400000000000001, -4.200000000000001, -4.300000000000001, -4.100000000000001, -4.200000000000001, -4.300000000000002, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -4.300000000000001, -3.9000000000000012, -4.100000000000001, -4.200000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -4.200000000000001, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -4.1000000000000005, -3.7000000000000006, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.200000000000001, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.300000000000001, -4.000000000000001, -4.000000000000002, -4.200000000000001, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.300000000000001, -4.1000000000000005, -4.100000000000001, -3.9000000000000012, -4.100000000000001, -4.200000000000001, -4.200000000000001, -4.000000000000002, -4.000000000000001, -4.000000000000002, -4.200000000000001, -4.000000000000001, -3.9000000000000004, -4.0, -3.7000000000000006, -3.9000000000000012, -4.000000000000002, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.300000000000001, -4.200000000000001, -11.4, -4.000000000000001, -3.900000000000001, -4.000000000000002, -4.400000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -4.300000000000001, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.0, -4.100000000000001, -4.300000000000001, -4.300000000000001, -4.0, -4.200000000000001, -4.000000000000001, -4.300000000000001, -4.100000000000001, -4.200000000000001, -4.0, -4.200000000000001, -4.100000000000001, -4.000000000000002, -3.900000000000001, -4.000000000000001, -3.9000000000000004, -3.900000000000001, -4.000000000000001, -3.700000000000001, -4.300000000000001, -4.200000000000001, -4.000000000000002, -3.900000000000001, -3.9000000000000012, -3.800000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -4.300000000000001, -3.9000000000000012, -4.000000000000001, -4.000000000000002, -4.300000000000001, -3.9000000000000012, -4.200000000000001, -4.300000000000001, -4.0, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.7000000000000006, -3.700000000000001, -4.000000000000001, -4.000000000000001, -3.800000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000002, -4.200000000000001, -4.100000000000001, -4.1000000000000005, -4.400000000000001, -4.0, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -4.000000000000002, -3.9000000000000012, -4.000000000000001, -3.900000000000001, -4.1000000000000005, -3.9000000000000012, -4.100000000000001, -3.800000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.1000000000000005, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -3.9000000000000004, -4.300000000000001, -4.000000000000001, -3.7000000000000006, -4.100000000000001, -3.9000000000000012], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 11, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.620788699103647, "mean_inference_ms": 18.116937277116005, "mean_action_processing_ms": 0.9371425068787578, "mean_env_wait_ms": 1.5678060253662058, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07625589716619778, "StateBufferConnector_ms": 0.010005303615115467, "ViewRequirementAgentConnector_ms": 0.1403646765595273}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 540000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 540000, "timers": {"training_iteration_time_ms": 174506.186, "load_time_ms": 1.197, "load_throughput": 3340610.888, "learn_time_ms": 173545.321, "learn_throughput": 23.049, "synch_weights_time_ms": 179.912}, "counters": {"num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "done": false, "episodes_total": 27144, "training_iteration": 135, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_03-22-32", "timestamp": 1680830552, "time_this_iter_s": 174.5121660232544, "time_total_s": 23212.109035730362, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01472fc310>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7effc004f430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 23212.109035730362, "timesteps_since_restore": 0, "iterations_since_restore": 135, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.352419354838709, "ram_util_percent": 23.803225806451618}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1810.2422688720046, "cur_kl_coeff": 2733.288323962833, "cur_lr": 0.01, "total_loss": Infinity, "policy_loss": 0.019309941359785615, "vf_loss": 0.2958910574275319, "vf_explained_var": 0.7197986010582217, "kl": Infinity, "entropy": 2.6185187596146777, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 126015.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "sampler_results": {"episode_reward_max": -3.7000000000000006, "episode_reward_min": -11.0, "episode_reward_mean": -4.1067010309278364, "episode_len_mean": 20.757731958762886, "episode_media": {}, "episodes_this_iter": 194, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.9000000000000004, -4.000000000000002, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -4.200000000000001, -4.000000000000001, -3.900000000000001, -4.0, -4.000000000000001, -4.200000000000001, -4.200000000000001, -4.000000000000001, -3.7000000000000006, -10.3, -4.000000000000001, -4.100000000000001, -11.0, -4.300000000000002, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.200000000000001, -4.300000000000001, -3.800000000000001, -4.1000000000000005, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -4.200000000000001, -3.8000000000000003, -4.000000000000002, -4.1000000000000005, -4.200000000000001, -4.1000000000000005, -4.1000000000000005, -4.000000000000002, -3.900000000000001, -4.100000000000001, -4.1000000000000005, -3.8000000000000007, -4.000000000000001, -3.9000000000000004, -3.8000000000000007, -3.8000000000000007, -4.200000000000001, -3.9000000000000012, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -4.200000000000001, -4.200000000000001, -3.9000000000000012, -3.900000000000001, -4.0, -4.000000000000002, -4.000000000000001, -4.300000000000001, -4.1000000000000005, -4.100000000000001, -4.300000000000002, -4.100000000000001, -3.9000000000000012, -3.900000000000001, -3.900000000000001, -4.100000000000001, -4.200000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000002, -4.100000000000001, -4.000000000000001, -4.200000000000001, -3.900000000000001, -4.000000000000001, -4.200000000000001, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.800000000000001, -3.7000000000000006, -3.900000000000001, -3.8000000000000007, -4.200000000000001, -3.8000000000000007, -10.3, -4.200000000000001, -3.9000000000000012, -4.0, -4.000000000000002, -4.000000000000001, -3.8000000000000007, -3.9000000000000012, -4.000000000000001, -4.300000000000001, -4.300000000000001, -4.100000000000001, -4.200000000000001, -4.200000000000001, -4.100000000000001, -3.700000000000001, -4.300000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -3.9000000000000004, -4.100000000000001, -3.7000000000000006, -4.0, -4.300000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.9000000000000012, -4.000000000000002, -3.9000000000000012, -4.000000000000002, -4.000000000000001, -4.100000000000001, -3.9000000000000012, -4.200000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000002, -4.000000000000002, -3.9000000000000012, -4.0, -4.200000000000001, -4.000000000000001, -4.0, -3.800000000000001, -3.900000000000001, -4.100000000000001, -4.1000000000000005, -3.800000000000001, -4.000000000000001, -3.9000000000000012, -4.1000000000000005, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -4.400000000000001, -4.300000000000001, -3.8000000000000003, -3.800000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000002, -3.800000000000001, -4.000000000000002, -3.8000000000000007, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.300000000000001, -3.800000000000001, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -3.700000000000001, -4.0, -3.900000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -3.9000000000000004, -3.900000000000001, -3.800000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.623246668987017, "mean_inference_ms": 18.126561091148965, "mean_action_processing_ms": 0.9370984737441753, "mean_env_wait_ms": 1.5679540317886191, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07435661001303762, "StateBufferConnector_ms": 0.009479104858083823, "ViewRequirementAgentConnector_ms": 0.13772015719069647}}, "episode_reward_max": -3.7000000000000006, "episode_reward_min": -11.0, "episode_reward_mean": -4.1067010309278364, "episode_len_mean": 20.757731958762886, "episodes_this_iter": 194, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.9000000000000004, -4.000000000000002, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -4.200000000000001, -4.000000000000001, -3.900000000000001, -4.0, -4.000000000000001, -4.200000000000001, -4.200000000000001, -4.000000000000001, -3.7000000000000006, -10.3, -4.000000000000001, -4.100000000000001, -11.0, -4.300000000000002, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.200000000000001, -4.300000000000001, -3.800000000000001, -4.1000000000000005, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -4.200000000000001, -3.8000000000000003, -4.000000000000002, -4.1000000000000005, -4.200000000000001, -4.1000000000000005, -4.1000000000000005, -4.000000000000002, -3.900000000000001, -4.100000000000001, -4.1000000000000005, -3.8000000000000007, -4.000000000000001, -3.9000000000000004, -3.8000000000000007, -3.8000000000000007, -4.200000000000001, -3.9000000000000012, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -4.200000000000001, -4.200000000000001, -3.9000000000000012, -3.900000000000001, -4.0, -4.000000000000002, -4.000000000000001, -4.300000000000001, -4.1000000000000005, -4.100000000000001, -4.300000000000002, -4.100000000000001, -3.9000000000000012, -3.900000000000001, -3.900000000000001, -4.100000000000001, -4.200000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000002, -4.100000000000001, -4.000000000000001, -4.200000000000001, -3.900000000000001, -4.000000000000001, -4.200000000000001, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.800000000000001, -3.7000000000000006, -3.900000000000001, -3.8000000000000007, -4.200000000000001, -3.8000000000000007, -10.3, -4.200000000000001, -3.9000000000000012, -4.0, -4.000000000000002, -4.000000000000001, -3.8000000000000007, -3.9000000000000012, -4.000000000000001, -4.300000000000001, -4.300000000000001, -4.100000000000001, -4.200000000000001, -4.200000000000001, -4.100000000000001, -3.700000000000001, -4.300000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -3.9000000000000004, -4.100000000000001, -3.7000000000000006, -4.0, -4.300000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.9000000000000012, -4.000000000000002, -3.9000000000000012, -4.000000000000002, -4.000000000000001, -4.100000000000001, -3.9000000000000012, -4.200000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000002, -4.000000000000002, -3.9000000000000012, -4.0, -4.200000000000001, -4.000000000000001, -4.0, -3.800000000000001, -3.900000000000001, -4.100000000000001, -4.1000000000000005, -3.800000000000001, -4.000000000000001, -3.9000000000000012, -4.1000000000000005, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -4.400000000000001, -4.300000000000001, -3.8000000000000003, -3.800000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000002, -3.800000000000001, -4.000000000000002, -3.8000000000000007, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.300000000000001, -3.800000000000001, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -3.700000000000001, -4.0, -3.900000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -3.9000000000000004, -3.900000000000001, -3.800000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.623246668987017, "mean_inference_ms": 18.126561091148965, "mean_action_processing_ms": 0.9370984737441753, "mean_env_wait_ms": 1.5679540317886191, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07435661001303762, "StateBufferConnector_ms": 0.009479104858083823, "ViewRequirementAgentConnector_ms": 0.13772015719069647}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000, "num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 544000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 544000, "timers": {"training_iteration_time_ms": 174508.411, "load_time_ms": 1.211, "load_throughput": 3303511.991, "learn_time_ms": 173550.133, "learn_throughput": 23.048, "synch_weights_time_ms": 179.846}, "counters": {"num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "done": false, "episodes_total": 27338, "training_iteration": 136, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_03-25-26", "timestamp": 1680830726, "time_this_iter_s": 174.7748920917511, "time_total_s": 23386.883927822113, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7effc258e5e0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7effc006c550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 23386.883927822113, "timesteps_since_restore": 0, "iterations_since_restore": 136, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.542338709677419, "ram_util_percent": 23.80080645161291}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1645.0435319551857, "cur_kl_coeff": 4099.932485944249, "cur_lr": 0.01, "total_loss": Infinity, "policy_loss": -0.000563280197781741, "vf_loss": 0.316535203447265, "vf_explained_var": 0.7242728804388354, "kl": Infinity, "entropy": 2.6692851228098715, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 126945.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_agent_steps_sampled": 548000, "num_agent_steps_trained": 548000}, "sampler_results": {"episode_reward_max": -3.6000000000000005, "episode_reward_min": -10.7, "episode_reward_mean": -4.097326203208557, "episode_len_mean": 20.823529411764707, "episode_media": {}, "episodes_this_iter": 187, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.200000000000001, -4.300000000000001, -4.000000000000001, -4.200000000000001, -3.900000000000001, -4.100000000000001, -3.800000000000001, -3.8000000000000007, -3.900000000000001, -4.200000000000001, -10.7, -4.200000000000001, -4.200000000000001, -3.900000000000001, -4.500000000000002, -4.0, -3.900000000000001, -10.2, -4.000000000000001, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -3.800000000000001, -4.200000000000001, -4.000000000000001, -4.4, -4.100000000000001, -3.7000000000000006, -3.8000000000000007, -3.900000000000001, -3.800000000000001, -4.200000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000002, -4.200000000000001, -4.000000000000001, -4.100000000000001, -3.800000000000001, -4.100000000000001, -3.9000000000000012, -4.000000000000001, -4.200000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.800000000000001, -4.300000000000001, -4.100000000000001, -4.200000000000001, -4.300000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.1000000000000005, -4.0, -4.1000000000000005, -4.100000000000001, -4.100000000000001, -3.900000000000001, -4.200000000000001, -4.100000000000001, -4.200000000000001, -4.1000000000000005, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -3.8000000000000003, -4.200000000000001, -4.000000000000002, -4.100000000000001, -4.300000000000002, -4.200000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.1000000000000005, -4.200000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000002, -4.1000000000000005, -4.300000000000001, -3.7000000000000006, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -4.200000000000001, -3.900000000000001, -4.100000000000001, -4.200000000000001, -3.8000000000000007, -4.000000000000001, -4.0, -4.200000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -3.700000000000001, -4.000000000000001, -4.100000000000001, -3.7000000000000006, -4.400000000000001, -4.1000000000000005, -4.300000000000001, -4.300000000000001, -4.100000000000001, -3.900000000000001, -4.200000000000001, -4.100000000000001, -4.1000000000000005, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -4.000000000000002, -4.300000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.100000000000001, -3.700000000000001, -3.600000000000001, -4.100000000000001, -4.100000000000001, -3.8000000000000003, -4.200000000000001, -4.200000000000001, -3.7000000000000015, -4.200000000000001, -3.700000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.600000000000001, -4.000000000000001, -3.9000000000000012, -4.0, -4.100000000000001, -4.300000000000001, -4.000000000000001, -3.9000000000000004, -4.300000000000001, -3.9000000000000004, -4.0, -4.200000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.1000000000000005, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.0, -3.8000000000000007, -3.9000000000000012, -4.100000000000001, -4.200000000000001, -4.000000000000001, -3.7000000000000006, -3.9000000000000004, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -4.200000000000001, -3.900000000000001, -4.300000000000001, -3.900000000000001, -3.8000000000000007, -3.6000000000000005, -3.900000000000001, -3.9000000000000004, -3.9000000000000012, -4.000000000000002, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.200000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.620495818223631, "mean_inference_ms": 18.140014237568302, "mean_action_processing_ms": 0.9374098566622541, "mean_env_wait_ms": 1.564747004788274, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07726483166536545, "StateBufferConnector_ms": 0.009890801128856638, "ViewRequirementAgentConnector_ms": 0.14110809978954295}}, "episode_reward_max": -3.6000000000000005, "episode_reward_min": -10.7, "episode_reward_mean": -4.097326203208557, "episode_len_mean": 20.823529411764707, "episodes_this_iter": 187, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.200000000000001, -4.300000000000001, -4.000000000000001, -4.200000000000001, -3.900000000000001, -4.100000000000001, -3.800000000000001, -3.8000000000000007, -3.900000000000001, -4.200000000000001, -10.7, -4.200000000000001, -4.200000000000001, -3.900000000000001, -4.500000000000002, -4.0, -3.900000000000001, -10.2, -4.000000000000001, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -3.800000000000001, -4.200000000000001, -4.000000000000001, -4.4, -4.100000000000001, -3.7000000000000006, -3.8000000000000007, -3.900000000000001, -3.800000000000001, -4.200000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000002, -4.200000000000001, -4.000000000000001, -4.100000000000001, -3.800000000000001, -4.100000000000001, -3.9000000000000012, -4.000000000000001, -4.200000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.800000000000001, -4.300000000000001, -4.100000000000001, -4.200000000000001, -4.300000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.1000000000000005, -4.0, -4.1000000000000005, -4.100000000000001, -4.100000000000001, -3.900000000000001, -4.200000000000001, -4.100000000000001, -4.200000000000001, -4.1000000000000005, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -3.8000000000000003, -4.200000000000001, -4.000000000000002, -4.100000000000001, -4.300000000000002, -4.200000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.1000000000000005, -4.200000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000002, -4.1000000000000005, -4.300000000000001, -3.7000000000000006, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -4.200000000000001, -3.900000000000001, -4.100000000000001, -4.200000000000001, -3.8000000000000007, -4.000000000000001, -4.0, -4.200000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -3.700000000000001, -4.000000000000001, -4.100000000000001, -3.7000000000000006, -4.400000000000001, -4.1000000000000005, -4.300000000000001, -4.300000000000001, -4.100000000000001, -3.900000000000001, -4.200000000000001, -4.100000000000001, -4.1000000000000005, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -4.000000000000002, -4.300000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.100000000000001, -3.700000000000001, -3.600000000000001, -4.100000000000001, -4.100000000000001, -3.8000000000000003, -4.200000000000001, -4.200000000000001, -3.7000000000000015, -4.200000000000001, -3.700000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.600000000000001, -4.000000000000001, -3.9000000000000012, -4.0, -4.100000000000001, -4.300000000000001, -4.000000000000001, -3.9000000000000004, -4.300000000000001, -3.9000000000000004, -4.0, -4.200000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.1000000000000005, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.0, -3.8000000000000007, -3.9000000000000012, -4.100000000000001, -4.200000000000001, -4.000000000000001, -3.7000000000000006, -3.9000000000000004, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -4.200000000000001, -3.900000000000001, -4.300000000000001, -3.900000000000001, -3.8000000000000007, -3.6000000000000005, -3.900000000000001, -3.9000000000000004, -3.9000000000000012, -4.000000000000002, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.200000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.620495818223631, "mean_inference_ms": 18.140014237568302, "mean_action_processing_ms": 0.9374098566622541, "mean_env_wait_ms": 1.564747004788274, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07726483166536545, "StateBufferConnector_ms": 0.009890801128856638, "ViewRequirementAgentConnector_ms": 0.14110809978954295}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 548000, "num_agent_steps_trained": 548000, "num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 548000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 548000, "timers": {"training_iteration_time_ms": 174528.273, "load_time_ms": 1.23, "load_throughput": 3251461.462, "learn_time_ms": 173566.744, "learn_throughput": 23.046, "synch_weights_time_ms": 180.241}, "counters": {"num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_agent_steps_sampled": 548000, "num_agent_steps_trained": 548000}, "done": false, "episodes_total": 27525, "training_iteration": 137, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_03-28-21", "timestamp": 1680830901, "time_this_iter_s": 174.46464896202087, "time_total_s": 23561.348576784134, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01473e2400>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff947c11f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 23561.348576784134, "timesteps_since_restore": 0, "iterations_since_restore": 137, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.363306451612903, "ram_util_percent": 23.800000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4487.459099619876, "cur_kl_coeff": 6149.898728916373, "cur_lr": 0.01, "total_loss": Infinity, "policy_loss": 0.020895701642799122, "vf_loss": 0.3117629558008204, "vf_explained_var": 0.7236305505357763, "kl": Infinity, "entropy": 2.5865803260636584, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 127875.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000}, "sampler_results": {"episode_reward_max": -3.4000000000000004, "episode_reward_min": -10.3, "episode_reward_mean": -4.052356020942409, "episode_len_mean": 20.910994764397905, "episode_media": {}, "episodes_this_iter": 191, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.200000000000001, -4.000000000000001, -4.000000000000001, -4.200000000000001, -3.9000000000000004, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000002, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -3.900000000000001, -10.3, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.9000000000000012, -4.100000000000001, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -4.200000000000001, -4.100000000000001, -4.300000000000001, -4.000000000000001, -4.0, -4.000000000000001, -3.700000000000001, -4.200000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000002, -4.1000000000000005, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000002, -3.900000000000001, -4.200000000000001, -4.200000000000001, -3.900000000000001, -4.0, -3.8000000000000007, -3.9000000000000012, -3.9000000000000004, -3.8000000000000007, -4.200000000000001, -3.900000000000001, -3.9000000000000004, -3.600000000000001, -4.200000000000001, -3.7000000000000006, -4.0, -4.100000000000001, -4.0, -4.100000000000001, -4.0, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -4.200000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -4.0, -4.000000000000001, -4.300000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000002, -4.100000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -4.0, -4.0, -3.6000000000000005, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -4.0, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -3.700000000000001, -4.100000000000001, -4.4, -3.800000000000001, -4.200000000000001, -4.0, -3.9000000000000012, -4.200000000000001, -4.000000000000001, -3.900000000000001, -4.200000000000001, -4.300000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.300000000000001, -3.900000000000001, -3.9000000000000012, -4.100000000000001, -3.9000000000000004, -4.000000000000001, -4.300000000000001, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -4.100000000000001, -4.100000000000001, -3.9000000000000012, -3.900000000000001, -3.900000000000001, -4.200000000000001, -4.300000000000001, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -4.0, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.7000000000000006, -3.9000000000000012, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.300000000000001, -4.300000000000001, -4.000000000000001, -4.200000000000001, -3.8000000000000007, -3.9000000000000012, -4.200000000000001, -3.9000000000000012, -4.0, -3.4000000000000004, -4.200000000000001, -4.000000000000002, -4.000000000000001, -4.100000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.619897734502173, "mean_inference_ms": 18.13174764271056, "mean_action_processing_ms": 0.9374499486228651, "mean_env_wait_ms": 1.5634099865851447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07854019784178409, "StateBufferConnector_ms": 0.009942054748535156, "ViewRequirementAgentConnector_ms": 0.14441624985939544}}, "episode_reward_max": -3.4000000000000004, "episode_reward_min": -10.3, "episode_reward_mean": -4.052356020942409, "episode_len_mean": 20.910994764397905, "episodes_this_iter": 191, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.200000000000001, -4.000000000000001, -4.000000000000001, -4.200000000000001, -3.9000000000000004, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000002, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -3.900000000000001, -10.3, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.9000000000000012, -4.100000000000001, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -4.200000000000001, -4.100000000000001, -4.300000000000001, -4.000000000000001, -4.0, -4.000000000000001, -3.700000000000001, -4.200000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000002, -4.1000000000000005, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000002, -3.900000000000001, -4.200000000000001, -4.200000000000001, -3.900000000000001, -4.0, -3.8000000000000007, -3.9000000000000012, -3.9000000000000004, -3.8000000000000007, -4.200000000000001, -3.900000000000001, -3.9000000000000004, -3.600000000000001, -4.200000000000001, -3.7000000000000006, -4.0, -4.100000000000001, -4.0, -4.100000000000001, -4.0, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -4.200000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -4.0, -4.000000000000001, -4.300000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000002, -4.100000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -4.0, -4.0, -3.6000000000000005, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -4.0, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -3.700000000000001, -4.100000000000001, -4.4, -3.800000000000001, -4.200000000000001, -4.0, -3.9000000000000012, -4.200000000000001, -4.000000000000001, -3.900000000000001, -4.200000000000001, -4.300000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.300000000000001, -3.900000000000001, -3.9000000000000012, -4.100000000000001, -3.9000000000000004, -4.000000000000001, -4.300000000000001, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -4.100000000000001, -4.100000000000001, -3.9000000000000012, -3.900000000000001, -3.900000000000001, -4.200000000000001, -4.300000000000001, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -4.0, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.7000000000000006, -3.9000000000000012, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.300000000000001, -4.300000000000001, -4.000000000000001, -4.200000000000001, -3.8000000000000007, -3.9000000000000012, -4.200000000000001, -3.9000000000000012, -4.0, -3.4000000000000004, -4.200000000000001, -4.000000000000002, -4.000000000000001, -4.100000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.619897734502173, "mean_inference_ms": 18.13174764271056, "mean_action_processing_ms": 0.9374499486228651, "mean_env_wait_ms": 1.5634099865851447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07854019784178409, "StateBufferConnector_ms": 0.009942054748535156, "ViewRequirementAgentConnector_ms": 0.14441624985939544}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 552000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 552000, "timers": {"training_iteration_time_ms": 174524.785, "load_time_ms": 1.232, "load_throughput": 3247999.38, "learn_time_ms": 173554.31, "learn_throughput": 23.048, "synch_weights_time_ms": 187.147}, "counters": {"num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000}, "done": false, "episodes_total": 27716, "training_iteration": 138, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_03-31-15", "timestamp": 1680831075, "time_this_iter_s": 174.31834053993225, "time_total_s": 23735.666917324066, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01477a3790>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff9475b940>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 23735.666917324066, "timesteps_since_restore": 0, "iterations_since_restore": 138, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.36491935483871, "ram_util_percent": 23.80282258064517}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3597.800969827303, "cur_kl_coeff": 9224.84809337456, "cur_lr": 0.01, "total_loss": Infinity, "policy_loss": 0.003599324926573743, "vf_loss": 0.2560310297034761, "vf_explained_var": 0.733960977356921, "kl": Infinity, "entropy": 2.66210134003752, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 128805.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_agent_steps_sampled": 556000, "num_agent_steps_trained": 556000}, "sampler_results": {"episode_reward_max": -3.600000000000001, "episode_reward_min": -10.2, "episode_reward_mean": -4.057068062827226, "episode_len_mean": 20.905759162303664, "episode_media": {}, "episodes_this_iter": 191, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.200000000000001, -4.200000000000001, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -4.000000000000002, -4.200000000000001, -4.300000000000001, -4.000000000000001, -4.100000000000001, -4.1000000000000005, -4.200000000000001, -4.100000000000001, -4.200000000000001, -10.2, -4.200000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -4.300000000000001, -4.300000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000001, -3.900000000000001, -4.200000000000001, -3.900000000000001, -4.200000000000001, -4.200000000000001, -4.100000000000001, -3.8000000000000007, -3.9000000000000004, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -4.300000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000002, -4.000000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.300000000000001, -4.200000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.7000000000000006, -4.100000000000001, -4.1000000000000005, -4.100000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -4.1000000000000005, -4.100000000000001, -4.000000000000001, -4.0, -4.000000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.300000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.200000000000001, -4.1000000000000005, -4.200000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000002, -4.1000000000000005, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.700000000000001, -4.1000000000000005, -3.7000000000000006, -4.1000000000000005, -3.8000000000000007, -4.200000000000001, -3.800000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -3.800000000000001, -4.000000000000001, -3.900000000000001, -4.200000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000001, -3.8000000000000003, -3.7000000000000006, -4.000000000000001, -3.9000000000000004, -4.0, -4.100000000000001, -3.7000000000000006, -4.200000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.200000000000001, -4.200000000000001, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -3.9000000000000012, -3.900000000000001, -3.9000000000000004, -3.900000000000001, -4.100000000000001, -4.000000000000002, -4.200000000000001, -3.9000000000000012, -4.200000000000001, -4.000000000000002, -4.000000000000001, -4.100000000000001, -3.800000000000001, -4.000000000000001, -3.800000000000001, -3.900000000000001, -4.200000000000001, -3.8000000000000007, -4.300000000000001, -4.000000000000001, -4.100000000000001, -3.9000000000000012, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000002, -3.900000000000001, -3.900000000000001, -4.0, -3.600000000000001, -4.0, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.619872999777577, "mean_inference_ms": 18.134882953759092, "mean_action_processing_ms": 0.9374842405512673, "mean_env_wait_ms": 1.5638438221092121, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07527311434920546, "StateBufferConnector_ms": 0.009577311770454127, "ViewRequirementAgentConnector_ms": 0.13860670059763325}}, "episode_reward_max": -3.600000000000001, "episode_reward_min": -10.2, "episode_reward_mean": -4.057068062827226, "episode_len_mean": 20.905759162303664, "episodes_this_iter": 191, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.200000000000001, -4.200000000000001, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -4.000000000000002, -4.200000000000001, -4.300000000000001, -4.000000000000001, -4.100000000000001, -4.1000000000000005, -4.200000000000001, -4.100000000000001, -4.200000000000001, -10.2, -4.200000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -4.300000000000001, -4.300000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000001, -3.900000000000001, -4.200000000000001, -3.900000000000001, -4.200000000000001, -4.200000000000001, -4.100000000000001, -3.8000000000000007, -3.9000000000000004, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -4.300000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000002, -4.000000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.300000000000001, -4.200000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.7000000000000006, -4.100000000000001, -4.1000000000000005, -4.100000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -4.1000000000000005, -4.100000000000001, -4.000000000000001, -4.0, -4.000000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.300000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.200000000000001, -4.1000000000000005, -4.200000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000002, -4.1000000000000005, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.700000000000001, -4.1000000000000005, -3.7000000000000006, -4.1000000000000005, -3.8000000000000007, -4.200000000000001, -3.800000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -3.800000000000001, -4.000000000000001, -3.900000000000001, -4.200000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000001, -3.8000000000000003, -3.7000000000000006, -4.000000000000001, -3.9000000000000004, -4.0, -4.100000000000001, -3.7000000000000006, -4.200000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.200000000000001, -4.200000000000001, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -3.9000000000000012, -3.900000000000001, -3.9000000000000004, -3.900000000000001, -4.100000000000001, -4.000000000000002, -4.200000000000001, -3.9000000000000012, -4.200000000000001, -4.000000000000002, -4.000000000000001, -4.100000000000001, -3.800000000000001, -4.000000000000001, -3.800000000000001, -3.900000000000001, -4.200000000000001, -3.8000000000000007, -4.300000000000001, -4.000000000000001, -4.100000000000001, -3.9000000000000012, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000002, -3.900000000000001, -3.900000000000001, -4.0, -3.600000000000001, -4.0, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.619872999777577, "mean_inference_ms": 18.134882953759092, "mean_action_processing_ms": 0.9374842405512673, "mean_env_wait_ms": 1.5638438221092121, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07527311434920546, "StateBufferConnector_ms": 0.009577311770454127, "ViewRequirementAgentConnector_ms": 0.13860670059763325}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 556000, "num_agent_steps_trained": 556000, "num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 556000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 556000, "timers": {"training_iteration_time_ms": 174588.969, "load_time_ms": 1.224, "load_throughput": 3267800.783, "learn_time_ms": 173619.516, "learn_throughput": 23.039, "synch_weights_time_ms": 188.387}, "counters": {"num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_agent_steps_sampled": 556000, "num_agent_steps_trained": 556000}, "done": false, "episodes_total": 27907, "training_iteration": 139, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_03-34-10", "timestamp": 1680831250, "time_this_iter_s": 174.60314393043518, "time_total_s": 23910.2700612545, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7eff947661f0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7effc004f5e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 23910.2700612545, "timesteps_since_restore": 0, "iterations_since_restore": 139, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.372983870967742, "ram_util_percent": 23.821774193548393}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9709.129708599789, "cur_kl_coeff": 13837.272140061836, "cur_lr": 0.01, "total_loss": Infinity, "policy_loss": 0.01941427535888168, "vf_loss": 0.3041509414392133, "vf_explained_var": 0.7297546768060295, "kl": Infinity, "entropy": 2.5887066207906253, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 129735.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "sampler_results": {"episode_reward_max": -3.500000000000001, "episode_reward_min": -11.3, "episode_reward_mean": -4.052127659574469, "episode_len_mean": 20.94148936170213, "episode_media": {}, "episodes_this_iter": 188, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.8000000000000007, -3.800000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.200000000000001, -4.0, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.4, -4.200000000000001, -3.9000000000000012, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -3.700000000000001, -3.900000000000001, -3.500000000000001, -4.000000000000001, -4.000000000000001, -4.4, -4.1000000000000005, -3.9000000000000012, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -4.300000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000002, -4.000000000000001, -4.000000000000001, -4.200000000000001, -3.900000000000001, -4.0, -4.000000000000001, -4.200000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -3.9000000000000004, -4.000000000000001, -3.800000000000001, -3.8000000000000007, -4.200000000000001, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -4.0, -4.300000000000001, -4.300000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -4.300000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.9000000000000012, -3.9000000000000004, -11.3, -4.0, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -4.0, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.9000000000000004, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -4.1000000000000005, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000002, -4.100000000000001, -4.100000000000001, -4.1000000000000005, -4.100000000000001, -4.300000000000001, -4.100000000000001, -3.8000000000000003, -4.000000000000001, -4.1000000000000005, -4.0, -3.8000000000000007, -4.300000000000001, -3.8000000000000007, -3.900000000000001, -3.9000000000000012, -4.100000000000001, -3.900000000000001, -3.900000000000001, -3.9000000000000004, -3.700000000000001, -3.800000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.300000000000001, -4.100000000000001, -4.200000000000001, -4.200000000000001, -3.900000000000001, -4.1000000000000005, -4.000000000000001, -4.000000000000001, -4.000000000000002, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -4.0, -4.1000000000000005, -4.200000000000001, -3.800000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -3.9000000000000012, -4.100000000000001, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -3.8000000000000007, -3.900000000000001, -4.1000000000000005, -4.200000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.9000000000000012, -3.9000000000000012, -4.200000000000001, -4.100000000000001, -4.100000000000001, -3.700000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.0, -3.800000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.200000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.61863491207333, "mean_inference_ms": 18.138502447640647, "mean_action_processing_ms": 0.9374406810112783, "mean_env_wait_ms": 1.56102104181651, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07806991009002036, "StateBufferConnector_ms": 0.00999240165061139, "ViewRequirementAgentConnector_ms": 0.14231344486804717}}, "episode_reward_max": -3.500000000000001, "episode_reward_min": -11.3, "episode_reward_mean": -4.052127659574469, "episode_len_mean": 20.94148936170213, "episodes_this_iter": 188, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.8000000000000007, -3.800000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.200000000000001, -4.0, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.4, -4.200000000000001, -3.9000000000000012, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -3.700000000000001, -3.900000000000001, -3.500000000000001, -4.000000000000001, -4.000000000000001, -4.4, -4.1000000000000005, -3.9000000000000012, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -4.300000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000002, -4.000000000000001, -4.000000000000001, -4.200000000000001, -3.900000000000001, -4.0, -4.000000000000001, -4.200000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -3.9000000000000004, -4.000000000000001, -3.800000000000001, -3.8000000000000007, -4.200000000000001, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -4.0, -4.300000000000001, -4.300000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -4.300000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.9000000000000012, -3.9000000000000004, -11.3, -4.0, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -4.0, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.9000000000000004, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -4.1000000000000005, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000002, -4.100000000000001, -4.100000000000001, -4.1000000000000005, -4.100000000000001, -4.300000000000001, -4.100000000000001, -3.8000000000000003, -4.000000000000001, -4.1000000000000005, -4.0, -3.8000000000000007, -4.300000000000001, -3.8000000000000007, -3.900000000000001, -3.9000000000000012, -4.100000000000001, -3.900000000000001, -3.900000000000001, -3.9000000000000004, -3.700000000000001, -3.800000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.300000000000001, -4.100000000000001, -4.200000000000001, -4.200000000000001, -3.900000000000001, -4.1000000000000005, -4.000000000000001, -4.000000000000001, -4.000000000000002, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -4.0, -4.1000000000000005, -4.200000000000001, -3.800000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -3.9000000000000012, -4.100000000000001, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -3.8000000000000007, -3.900000000000001, -4.1000000000000005, -4.200000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.9000000000000012, -3.9000000000000012, -4.200000000000001, -4.100000000000001, -4.100000000000001, -3.700000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.0, -3.800000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.200000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.61863491207333, "mean_inference_ms": 18.138502447640647, "mean_action_processing_ms": 0.9374406810112783, "mean_env_wait_ms": 1.56102104181651, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07806991009002036, "StateBufferConnector_ms": 0.00999240165061139, "ViewRequirementAgentConnector_ms": 0.14231344486804717}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 560000, "timers": {"training_iteration_time_ms": 174557.228, "load_time_ms": 1.224, "load_throughput": 3269137.958, "learn_time_ms": 173591.514, "learn_throughput": 23.043, "synch_weights_time_ms": 186.78}, "counters": {"num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "done": false, "episodes_total": 28095, "training_iteration": 140, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_03-37-05", "timestamp": 1680831425, "time_this_iter_s": 174.58548140525818, "time_total_s": 24084.85554265976, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7effc0948c40>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff947a28b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 24084.85554265976, "timesteps_since_restore": 0, "iterations_since_restore": 140, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.5425702811244975, "ram_util_percent": 23.800803212851413}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8315.137423886536, "cur_kl_coeff": 20755.908210092755, "cur_lr": 0.01, "total_loss": Infinity, "policy_loss": -0.00026514403289183973, "vf_loss": 0.28650669794409506, "vf_explained_var": 0.7087373814916098, "kl": Infinity, "entropy": 2.6390587860538113, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 130665.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000}, "sampler_results": {"episode_reward_max": 97.2, "episode_reward_min": -4.400000000000001, "episode_reward_mean": -3.511458333333334, "episode_len_mean": 20.994791666666668, "episode_media": {}, "episodes_this_iter": 192, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.100000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000002, -4.100000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -3.900000000000001, -4.000000000000001, -4.300000000000001, -4.1000000000000005, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.9000000000000004, -3.8000000000000007, -4.200000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -4.300000000000001, -4.100000000000001, -4.000000000000002, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000002, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000002, -3.9000000000000012, -4.000000000000001, -4.300000000000001, -4.200000000000001, -4.100000000000001, -3.900000000000001, -3.800000000000001, -4.100000000000001, -4.200000000000001, -3.700000000000001, -4.100000000000001, -4.000000000000002, -4.200000000000001, -4.400000000000001, -3.7000000000000006, -4.200000000000001, -4.1000000000000005, -4.000000000000001, -4.200000000000001, -3.900000000000001, -3.8000000000000007, -4.0, -4.200000000000001, -4.4, -3.700000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.300000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000002, -4.200000000000001, -4.200000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.300000000000001, -4.300000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.0, -3.600000000000001, -3.8000000000000007, -3.900000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.300000000000001, -4.0, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.300000000000001, -3.900000000000001, -4.400000000000001, -4.300000000000001, -4.200000000000001, -4.200000000000001, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.200000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -3.700000000000001, -4.000000000000002, -4.000000000000001, -4.200000000000001, -3.6000000000000005, -3.900000000000001, -4.100000000000001, -4.300000000000001, -4.000000000000002, -3.900000000000001, -4.300000000000001, -4.0, -4.000000000000001, -3.800000000000001, -3.8000000000000007, -3.9000000000000012, -4.000000000000001, -4.200000000000001, -3.9000000000000012, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.200000000000001, 97.2, -4.300000000000001, -4.100000000000001, -3.9000000000000004, -4.200000000000001, -4.000000000000001, -4.000000000000001, -4.200000000000001, -3.900000000000001, -4.200000000000001, -4.200000000000001, -4.000000000000002, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.1000000000000005, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000002, -4.000000000000001, -3.9000000000000012, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000001, -3.9000000000000004, -4.300000000000001, -3.900000000000001, -3.9000000000000004, -3.9000000000000012, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.0, -4.0], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.621054078094309, "mean_inference_ms": 18.132520983292533, "mean_action_processing_ms": 0.9374270563597209, "mean_env_wait_ms": 1.5591697814256662, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08386286596457164, "StateBufferConnector_ms": 0.010548532009124756, "ViewRequirementAgentConnector_ms": 0.1518299182256063}}, "episode_reward_max": 97.2, "episode_reward_min": -4.400000000000001, "episode_reward_mean": -3.511458333333334, "episode_len_mean": 20.994791666666668, "episodes_this_iter": 192, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.100000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000002, -4.100000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -3.900000000000001, -4.000000000000001, -4.300000000000001, -4.1000000000000005, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.9000000000000004, -3.8000000000000007, -4.200000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -4.300000000000001, -4.100000000000001, -4.000000000000002, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000002, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000002, -3.9000000000000012, -4.000000000000001, -4.300000000000001, -4.200000000000001, -4.100000000000001, -3.900000000000001, -3.800000000000001, -4.100000000000001, -4.200000000000001, -3.700000000000001, -4.100000000000001, -4.000000000000002, -4.200000000000001, -4.400000000000001, -3.7000000000000006, -4.200000000000001, -4.1000000000000005, -4.000000000000001, -4.200000000000001, -3.900000000000001, -3.8000000000000007, -4.0, -4.200000000000001, -4.4, -3.700000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.300000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000002, -4.200000000000001, -4.200000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.300000000000001, -4.300000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.0, -3.600000000000001, -3.8000000000000007, -3.900000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.300000000000001, -4.0, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.300000000000001, -3.900000000000001, -4.400000000000001, -4.300000000000001, -4.200000000000001, -4.200000000000001, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.200000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -3.700000000000001, -4.000000000000002, -4.000000000000001, -4.200000000000001, -3.6000000000000005, -3.900000000000001, -4.100000000000001, -4.300000000000001, -4.000000000000002, -3.900000000000001, -4.300000000000001, -4.0, -4.000000000000001, -3.800000000000001, -3.8000000000000007, -3.9000000000000012, -4.000000000000001, -4.200000000000001, -3.9000000000000012, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.200000000000001, 97.2, -4.300000000000001, -4.100000000000001, -3.9000000000000004, -4.200000000000001, -4.000000000000001, -4.000000000000001, -4.200000000000001, -3.900000000000001, -4.200000000000001, -4.200000000000001, -4.000000000000002, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.1000000000000005, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000002, -4.000000000000001, -3.9000000000000012, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000001, -3.9000000000000004, -4.300000000000001, -3.900000000000001, -3.9000000000000004, -3.9000000000000012, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.0, -4.0], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.621054078094309, "mean_inference_ms": 18.132520983292533, "mean_action_processing_ms": 0.9374270563597209, "mean_env_wait_ms": 1.5591697814256662, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08386286596457164, "StateBufferConnector_ms": 0.010548532009124756, "ViewRequirementAgentConnector_ms": 0.1518299182256063}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 564000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 564000, "timers": {"training_iteration_time_ms": 174565.373, "load_time_ms": 1.221, "load_throughput": 3277312.08, "learn_time_ms": 173599.984, "learn_throughput": 23.041, "synch_weights_time_ms": 187.29}, "counters": {"num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000}, "done": false, "episodes_total": 28287, "training_iteration": 141, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_03-39-59", "timestamp": 1680831599, "time_this_iter_s": 174.4314796924591, "time_total_s": 24259.28702235222, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7eff947679d0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7effc00b5f70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 24259.28702235222, "timesteps_since_restore": 0, "iterations_since_restore": 141, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.280241935483871, "ram_util_percent": 23.80120967741936}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20085.73467472856, "cur_kl_coeff": 31133.862315139148, "cur_lr": 0.01, "total_loss": 4675.069873539094, "policy_loss": 0.022147742358426894, "vf_loss": 0.3179728920982089, "vf_explained_var": 0.7147726232646614, "kl": 0.15014936278683072, "entropy": 2.592188994153853, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 131595.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_agent_steps_sampled": 568000, "num_agent_steps_trained": 568000}, "sampler_results": {"episode_reward_max": -3.7000000000000006, "episode_reward_min": -10.3, "episode_reward_mean": -4.110880829015544, "episode_len_mean": 20.808290155440414, "episode_media": {}, "episodes_this_iter": 193, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.300000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.0, -3.900000000000001, -10.3, -4.200000000000001, -4.200000000000001, -4.200000000000001, -4.000000000000001, -10.1, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.200000000000001, -3.900000000000001, -4.000000000000002, -4.000000000000001, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -4.000000000000002, -4.200000000000001, -4.000000000000001, -3.900000000000001, -4.400000000000001, -4.0, -4.4, -4.000000000000001, -4.200000000000001, -4.000000000000001, -4.100000000000001, -4.1000000000000005, -4.000000000000001, -4.100000000000001, -4.000000000000002, -4.200000000000001, -3.9000000000000012, -4.000000000000001, -4.000000000000001, -4.1000000000000005, -4.100000000000001, -4.200000000000001, -4.000000000000002, -4.000000000000001, -4.300000000000001, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -4.300000000000001, -4.100000000000001, -4.100000000000001, -3.800000000000001, -4.000000000000001, -3.700000000000001, -3.9000000000000012, -4.100000000000001, -4.400000000000001, -3.8000000000000007, -3.8000000000000007, -4.100000000000001, -4.300000000000001, -4.400000000000001, -4.200000000000001, -4.1000000000000005, -4.200000000000001, -4.200000000000001, -4.300000000000001, -3.9000000000000012, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.1000000000000005, -3.8000000000000007, -4.300000000000002, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.800000000000001, -3.800000000000001, -3.800000000000001, -3.8000000000000007, -4.1000000000000005, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.200000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000002, -4.4, -4.000000000000001, -4.000000000000001, -4.300000000000001, -4.200000000000001, -4.300000000000001, -3.8000000000000007, -4.200000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -4.200000000000001, -4.200000000000001, -4.000000000000002, -4.4, -4.300000000000001, -4.100000000000001, -4.1000000000000005, -4.200000000000001, -4.200000000000001, -4.200000000000001, -4.000000000000001, -4.300000000000002, -3.7000000000000006, -3.9000000000000012, -3.9000000000000012, -4.100000000000001, -4.300000000000001, -4.200000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.0, -3.8000000000000007, -4.1000000000000005, -4.1000000000000005, -4.200000000000001, -4.100000000000001, -3.9000000000000012, -3.9000000000000012, -3.8000000000000003, -4.000000000000001, -3.9000000000000004, -4.100000000000001, -3.9000000000000012, -4.100000000000001, -3.8000000000000007, -4.1000000000000005, -4.300000000000001, -4.100000000000001, -4.200000000000001, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.1000000000000005, -4.100000000000001, -4.000000000000001, -4.000000000000002, -3.900000000000001, -3.900000000000001, -4.200000000000001, -4.100000000000001, -4.300000000000001, -4.000000000000001, -3.8000000000000007, -4.200000000000001, -3.900000000000001, -4.100000000000001, -4.1000000000000005, -4.100000000000001, -4.0, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -4.000000000000002, -3.8000000000000007, -3.700000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.9000000000000012, -3.8000000000000007], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.620669068552754, "mean_inference_ms": 18.135581535361496, "mean_action_processing_ms": 0.9376459779868139, "mean_env_wait_ms": 1.5581899565932134, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08389023301514936, "StateBufferConnector_ms": 0.010114259670435456, "ViewRequirementAgentConnector_ms": 0.15136590275739759}}, "episode_reward_max": -3.7000000000000006, "episode_reward_min": -10.3, "episode_reward_mean": -4.110880829015544, "episode_len_mean": 20.808290155440414, "episodes_this_iter": 193, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.300000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.0, -3.900000000000001, -10.3, -4.200000000000001, -4.200000000000001, -4.200000000000001, -4.000000000000001, -10.1, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.200000000000001, -3.900000000000001, -4.000000000000002, -4.000000000000001, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -4.000000000000002, -4.200000000000001, -4.000000000000001, -3.900000000000001, -4.400000000000001, -4.0, -4.4, -4.000000000000001, -4.200000000000001, -4.000000000000001, -4.100000000000001, -4.1000000000000005, -4.000000000000001, -4.100000000000001, -4.000000000000002, -4.200000000000001, -3.9000000000000012, -4.000000000000001, -4.000000000000001, -4.1000000000000005, -4.100000000000001, -4.200000000000001, -4.000000000000002, -4.000000000000001, -4.300000000000001, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -4.300000000000001, -4.100000000000001, -4.100000000000001, -3.800000000000001, -4.000000000000001, -3.700000000000001, -3.9000000000000012, -4.100000000000001, -4.400000000000001, -3.8000000000000007, -3.8000000000000007, -4.100000000000001, -4.300000000000001, -4.400000000000001, -4.200000000000001, -4.1000000000000005, -4.200000000000001, -4.200000000000001, -4.300000000000001, -3.9000000000000012, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.1000000000000005, -3.8000000000000007, -4.300000000000002, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.800000000000001, -3.800000000000001, -3.800000000000001, -3.8000000000000007, -4.1000000000000005, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.200000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000002, -4.4, -4.000000000000001, -4.000000000000001, -4.300000000000001, -4.200000000000001, -4.300000000000001, -3.8000000000000007, -4.200000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -4.200000000000001, -4.200000000000001, -4.000000000000002, -4.4, -4.300000000000001, -4.100000000000001, -4.1000000000000005, -4.200000000000001, -4.200000000000001, -4.200000000000001, -4.000000000000001, -4.300000000000002, -3.7000000000000006, -3.9000000000000012, -3.9000000000000012, -4.100000000000001, -4.300000000000001, -4.200000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.0, -3.8000000000000007, -4.1000000000000005, -4.1000000000000005, -4.200000000000001, -4.100000000000001, -3.9000000000000012, -3.9000000000000012, -3.8000000000000003, -4.000000000000001, -3.9000000000000004, -4.100000000000001, -3.9000000000000012, -4.100000000000001, -3.8000000000000007, -4.1000000000000005, -4.300000000000001, -4.100000000000001, -4.200000000000001, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.1000000000000005, -4.100000000000001, -4.000000000000001, -4.000000000000002, -3.900000000000001, -3.900000000000001, -4.200000000000001, -4.100000000000001, -4.300000000000001, -4.000000000000001, -3.8000000000000007, -4.200000000000001, -3.900000000000001, -4.100000000000001, -4.1000000000000005, -4.100000000000001, -4.0, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -4.000000000000002, -3.8000000000000007, -3.700000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.9000000000000012, -3.8000000000000007], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.620669068552754, "mean_inference_ms": 18.135581535361496, "mean_action_processing_ms": 0.9376459779868139, "mean_env_wait_ms": 1.5581899565932134, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08389023301514936, "StateBufferConnector_ms": 0.010114259670435456, "ViewRequirementAgentConnector_ms": 0.15136590275739759}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 568000, "num_agent_steps_trained": 568000, "num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 568000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 568000, "timers": {"training_iteration_time_ms": 174605.613, "load_time_ms": 1.246, "load_throughput": 3210888.978, "learn_time_ms": 173639.457, "learn_throughput": 23.036, "synch_weights_time_ms": 186.599}, "counters": {"num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_agent_steps_sampled": 568000, "num_agent_steps_trained": 568000}, "done": false, "episodes_total": 28480, "training_iteration": 142, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_03-42-54", "timestamp": 1680831774, "time_this_iter_s": 174.61771297454834, "time_total_s": 24433.904735326767, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7effc0130610>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff947c11f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 24433.904735326767, "timesteps_since_restore": 0, "iterations_since_restore": 142, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.353225806451612, "ram_util_percent": 23.808870967741946}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19248.343233760712, "cur_kl_coeff": 46700.79347270871, "cur_lr": 0.01, "total_loss": 411.3561210370833, "policy_loss": 0.0050918441390999224, "vf_loss": 0.29248111812017297, "vf_explained_var": 0.6554169052390642, "kl": 0.008801960771179243, "entropy": 2.6372565900125813, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 132525.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_agent_steps_sampled": 572000, "num_agent_steps_trained": 572000}, "sampler_results": {"episode_reward_max": -3.7000000000000006, "episode_reward_min": -10.4, "episode_reward_mean": -4.115706806282724, "episode_len_mean": 20.827225130890053, "episode_media": {}, "episodes_this_iter": 191, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.000000000000001, -4.300000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -4.1000000000000005, -4.400000000000001, -4.000000000000001, -4.000000000000002, -3.900000000000001, -4.000000000000001, -4.200000000000001, -10.3, -4.000000000000001, -4.0, -4.200000000000001, -4.000000000000001, -3.7000000000000006, -4.200000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000002, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -3.900000000000001, -4.300000000000001, -4.000000000000002, -3.9000000000000004, -4.200000000000001, -4.100000000000001, -3.7000000000000006, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -3.9000000000000012, -4.000000000000001, -4.1000000000000005, -4.200000000000001, -4.000000000000001, -4.100000000000001, -4.400000000000001, -4.0, -4.000000000000001, -4.200000000000001, -4.300000000000001, -4.500000000000001, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.300000000000001, -4.000000000000002, -4.300000000000001, -4.100000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -3.900000000000001, -4.0, -4.300000000000001, -4.200000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -3.9000000000000004, -4.200000000000001, -3.8000000000000007, -4.200000000000001, -4.000000000000001, -4.100000000000001, -3.9000000000000004, -3.7000000000000006, -3.9000000000000004, -4.200000000000001, -10.4, -3.8000000000000007, -4.0, -4.1000000000000005, -4.200000000000001, -4.000000000000001, -3.8000000000000003, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.200000000000001, -4.300000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -3.8000000000000007, -4.200000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000002, -4.200000000000001, -4.200000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000002, -3.9000000000000012, -4.100000000000001, -3.900000000000001, -4.200000000000001, -3.7000000000000006, -3.9000000000000012, -4.200000000000001, -4.000000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000002, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.300000000000001, -3.7000000000000006, -4.200000000000001, -3.9000000000000012, -4.100000000000001, -4.1000000000000005, -4.000000000000001, -3.800000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -3.9000000000000012, -3.7000000000000006, -4.000000000000002, -4.000000000000001, -3.9000000000000012, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.0, -3.900000000000001, -4.200000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000001, -4.100000000000001, -4.300000000000001, -3.900000000000001, -4.0, -3.8000000000000007, -4.000000000000001, -4.000000000000002, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -4.300000000000001, -4.000000000000002, -4.0, -4.100000000000001, -4.100000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000002], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.618146433999085, "mean_inference_ms": 18.127986806349096, "mean_action_processing_ms": 0.9376952344805256, "mean_env_wait_ms": 1.5569753240965998, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0756605757468658, "StateBufferConnector_ms": 0.00942627172819607, "ViewRequirementAgentConnector_ms": 0.1384708893860822}}, "episode_reward_max": -3.7000000000000006, "episode_reward_min": -10.4, "episode_reward_mean": -4.115706806282724, "episode_len_mean": 20.827225130890053, "episodes_this_iter": 191, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.000000000000001, -4.300000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -4.1000000000000005, -4.400000000000001, -4.000000000000001, -4.000000000000002, -3.900000000000001, -4.000000000000001, -4.200000000000001, -10.3, -4.000000000000001, -4.0, -4.200000000000001, -4.000000000000001, -3.7000000000000006, -4.200000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000002, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -3.900000000000001, -4.300000000000001, -4.000000000000002, -3.9000000000000004, -4.200000000000001, -4.100000000000001, -3.7000000000000006, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -3.9000000000000012, -4.000000000000001, -4.1000000000000005, -4.200000000000001, -4.000000000000001, -4.100000000000001, -4.400000000000001, -4.0, -4.000000000000001, -4.200000000000001, -4.300000000000001, -4.500000000000001, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.300000000000001, -4.000000000000002, -4.300000000000001, -4.100000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -3.900000000000001, -4.0, -4.300000000000001, -4.200000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -3.9000000000000004, -4.200000000000001, -3.8000000000000007, -4.200000000000001, -4.000000000000001, -4.100000000000001, -3.9000000000000004, -3.7000000000000006, -3.9000000000000004, -4.200000000000001, -10.4, -3.8000000000000007, -4.0, -4.1000000000000005, -4.200000000000001, -4.000000000000001, -3.8000000000000003, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.200000000000001, -4.300000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -3.8000000000000007, -4.200000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000002, -4.200000000000001, -4.200000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000002, -3.9000000000000012, -4.100000000000001, -3.900000000000001, -4.200000000000001, -3.7000000000000006, -3.9000000000000012, -4.200000000000001, -4.000000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000002, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.300000000000001, -3.7000000000000006, -4.200000000000001, -3.9000000000000012, -4.100000000000001, -4.1000000000000005, -4.000000000000001, -3.800000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -3.9000000000000012, -3.7000000000000006, -4.000000000000002, -4.000000000000001, -3.9000000000000012, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.0, -3.900000000000001, -4.200000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000001, -4.100000000000001, -4.300000000000001, -3.900000000000001, -4.0, -3.8000000000000007, -4.000000000000001, -4.000000000000002, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -4.300000000000001, -4.000000000000002, -4.0, -4.100000000000001, -4.100000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000002], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.618146433999085, "mean_inference_ms": 18.127986806349096, "mean_action_processing_ms": 0.9376952344805256, "mean_env_wait_ms": 1.5569753240965998, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0756605757468658, "StateBufferConnector_ms": 0.00942627172819607, "ViewRequirementAgentConnector_ms": 0.1384708893860822}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 572000, "num_agent_steps_trained": 572000, "num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 572000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 572000, "timers": {"training_iteration_time_ms": 174572.069, "load_time_ms": 1.244, "load_throughput": 3215750.978, "learn_time_ms": 173606.958, "learn_throughput": 23.041, "synch_weights_time_ms": 187.129}, "counters": {"num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_agent_steps_sampled": 572000, "num_agent_steps_trained": 572000}, "done": false, "episodes_total": 28671, "training_iteration": 143, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_03-45-48", "timestamp": 1680831948, "time_this_iter_s": 174.71522521972656, "time_total_s": 24608.619960546494, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476cb700>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7effc004f5e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 24608.619960546494, "timesteps_since_restore": 0, "iterations_since_restore": 143, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.584677419354839, "ram_util_percent": 23.80403225806452}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22756.586201280163, "cur_kl_coeff": 46700.79347270871, "cur_lr": 0.01, "total_loss": 920.8442364713197, "policy_loss": 0.007298179516588808, "vf_loss": 0.2362158694094227, "vf_explained_var": 0.6664945181339018, "kl": 0.019712742917941325, "entropy": 2.637304901307629, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 133455.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "sampler_results": {"episode_reward_max": -3.6000000000000005, "episode_reward_min": -11.0, "episode_reward_mean": -4.091145833333335, "episode_len_mean": 20.838541666666668, "episode_media": {}, "episodes_this_iter": 192, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.900000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -4.300000000000001, -3.700000000000001, -3.800000000000001, -3.8000000000000007, -4.100000000000001, -4.100000000000001, -10.1, -4.200000000000001, -3.9000000000000012, -4.200000000000001, -4.200000000000001, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000002, -4.000000000000001, -4.200000000000001, -4.200000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -4.300000000000001, -4.200000000000001, -4.0, -4.300000000000001, -4.000000000000001, -4.300000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.9000000000000012, -3.9000000000000012, -4.000000000000002, -3.9000000000000012, -4.0, -4.300000000000001, -3.8000000000000003, -3.700000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000002, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.300000000000001, -4.100000000000001, -4.0, -4.100000000000001, -4.100000000000001, -3.9000000000000004, -4.000000000000002, -4.300000000000001, -4.000000000000002, -4.000000000000001, -3.9000000000000012, -4.000000000000001, -3.8000000000000003, -4.200000000000001, -4.100000000000001, -4.200000000000001, -4.200000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.9000000000000004, -3.8000000000000007, -4.200000000000001, -4.000000000000001, -3.9000000000000012, -4.100000000000001, -4.000000000000001, -3.800000000000001, -4.000000000000001, -4.100000000000001, -4.1000000000000005, -4.100000000000001, -4.200000000000001, -4.000000000000001, -4.300000000000001, -3.800000000000001, -3.900000000000001, -4.200000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -11.0, -4.000000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -4.0, -3.900000000000001, -3.8000000000000007, -4.000000000000002, -4.200000000000001, -3.900000000000001, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.200000000000001, -4.300000000000001, -4.000000000000002, -4.100000000000001, -3.8000000000000007, -4.200000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000002, -4.000000000000001, -4.000000000000001, -3.8000000000000003, -4.200000000000001, -4.100000000000001, -4.200000000000001, -4.300000000000001, -4.100000000000001, -4.200000000000001, -3.7000000000000006, -4.200000000000001, -4.000000000000001, -4.0, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -4.200000000000001, -3.8000000000000007, -4.100000000000001, -4.200000000000001, -4.100000000000001, -3.900000000000001, -3.7000000000000006, -4.200000000000001, -3.9000000000000012, -4.200000000000001, -4.300000000000001, -4.200000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000002, -4.0, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.700000000000001, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000002, -4.100000000000001, -3.9000000000000012, -3.9000000000000012, -4.000000000000001, -4.000000000000001, -4.000000000000002, -3.7, -3.900000000000001, -3.6000000000000005, -3.8000000000000007, -4.200000000000001, -3.9000000000000012, -3.600000000000001, -4.300000000000001, -4.000000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.62173999533752, "mean_inference_ms": 18.139674563495756, "mean_action_processing_ms": 0.938427856188329, "mean_env_wait_ms": 1.5587623880980648, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07836135725180308, "StateBufferConnector_ms": 0.009436781207720438, "ViewRequirementAgentConnector_ms": 0.14202607174714407}}, "episode_reward_max": -3.6000000000000005, "episode_reward_min": -11.0, "episode_reward_mean": -4.091145833333335, "episode_len_mean": 20.838541666666668, "episodes_this_iter": 192, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.900000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -4.300000000000001, -3.700000000000001, -3.800000000000001, -3.8000000000000007, -4.100000000000001, -4.100000000000001, -10.1, -4.200000000000001, -3.9000000000000012, -4.200000000000001, -4.200000000000001, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000002, -4.000000000000001, -4.200000000000001, -4.200000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -4.300000000000001, -4.200000000000001, -4.0, -4.300000000000001, -4.000000000000001, -4.300000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.9000000000000012, -3.9000000000000012, -4.000000000000002, -3.9000000000000012, -4.0, -4.300000000000001, -3.8000000000000003, -3.700000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000002, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.300000000000001, -4.100000000000001, -4.0, -4.100000000000001, -4.100000000000001, -3.9000000000000004, -4.000000000000002, -4.300000000000001, -4.000000000000002, -4.000000000000001, -3.9000000000000012, -4.000000000000001, -3.8000000000000003, -4.200000000000001, -4.100000000000001, -4.200000000000001, -4.200000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.9000000000000004, -3.8000000000000007, -4.200000000000001, -4.000000000000001, -3.9000000000000012, -4.100000000000001, -4.000000000000001, -3.800000000000001, -4.000000000000001, -4.100000000000001, -4.1000000000000005, -4.100000000000001, -4.200000000000001, -4.000000000000001, -4.300000000000001, -3.800000000000001, -3.900000000000001, -4.200000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -11.0, -4.000000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -4.0, -3.900000000000001, -3.8000000000000007, -4.000000000000002, -4.200000000000001, -3.900000000000001, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.200000000000001, -4.300000000000001, -4.000000000000002, -4.100000000000001, -3.8000000000000007, -4.200000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000002, -4.000000000000001, -4.000000000000001, -3.8000000000000003, -4.200000000000001, -4.100000000000001, -4.200000000000001, -4.300000000000001, -4.100000000000001, -4.200000000000001, -3.7000000000000006, -4.200000000000001, -4.000000000000001, -4.0, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -4.200000000000001, -3.8000000000000007, -4.100000000000001, -4.200000000000001, -4.100000000000001, -3.900000000000001, -3.7000000000000006, -4.200000000000001, -3.9000000000000012, -4.200000000000001, -4.300000000000001, -4.200000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000002, -4.0, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.700000000000001, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000002, -4.100000000000001, -3.9000000000000012, -3.9000000000000012, -4.000000000000001, -4.000000000000001, -4.000000000000002, -3.7, -3.900000000000001, -3.6000000000000005, -3.8000000000000007, -4.200000000000001, -3.9000000000000012, -3.600000000000001, -4.300000000000001, -4.000000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.62173999533752, "mean_inference_ms": 18.139674563495756, "mean_action_processing_ms": 0.938427856188329, "mean_env_wait_ms": 1.5587623880980648, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07836135725180308, "StateBufferConnector_ms": 0.009436781207720438, "ViewRequirementAgentConnector_ms": 0.14202607174714407}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 576000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 174531.538, "load_time_ms": 1.232, "load_throughput": 3247936.502, "learn_time_ms": 173566.913, "learn_throughput": 23.046, "synch_weights_time_ms": 186.662}, "counters": {"num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "episodes_total": 28863, "training_iteration": 144, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_03-48-43", "timestamp": 1680832123, "time_this_iter_s": 174.40938639640808, "time_total_s": 24783.0293469429, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476d1d90>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7effc004fe50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 24783.0293469429, "timesteps_since_restore": 0, "iterations_since_restore": 144, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.349193548387096, "ram_util_percent": 23.812500000000007}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12979.618906263126, "cur_kl_coeff": 46700.79347270871, "cur_lr": 0.01, "total_loss": 205.54608968098958, "policy_loss": 0.0035346280633201522, "vf_loss": 0.2584785046196112, "vf_explained_var": 0.6452518938690104, "kl": 0.004395729977739549, "entropy": 2.6417082040540634, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 134385.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_agent_steps_sampled": 580000, "num_agent_steps_trained": 580000}, "sampler_results": {"episode_reward_max": -3.7000000000000006, "episode_reward_min": -4.400000000000001, "episode_reward_mean": -4.047368421052632, "episode_len_mean": 21.0, "episode_media": {}, "episodes_this_iter": 190, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.000000000000001, -4.300000000000001, -4.200000000000001, -4.200000000000001, -3.9000000000000012, -4.000000000000001, -4.200000000000001, -4.100000000000001, -4.200000000000001, -3.8000000000000007, -4.100000000000001, -4.1000000000000005, -3.900000000000001, -4.300000000000001, -3.900000000000001, -4.100000000000001, -4.1000000000000005, -4.000000000000001, -4.000000000000001, -3.9000000000000004, -4.100000000000001, -4.300000000000001, -4.100000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.300000000000001, -4.100000000000001, -4.0, -4.000000000000001, -4.300000000000001, -4.0, -4.100000000000001, -4.200000000000001, -4.1000000000000005, -4.100000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -3.9000000000000012, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -4.300000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.300000000000001, -4.300000000000001, -4.1000000000000005, -4.000000000000001, -4.000000000000002, -4.100000000000001, -3.900000000000001, -4.0, -3.900000000000001, -4.100000000000001, -4.000000000000002, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -4.300000000000001, -3.900000000000001, -4.200000000000001, -3.800000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000002, -3.900000000000001, -3.900000000000001, -3.9000000000000012, -4.100000000000001, -4.200000000000001, -4.200000000000001, -3.900000000000001, -3.9000000000000012, -3.9000000000000012, -3.900000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.300000000000001, -4.000000000000001, -4.000000000000002, -3.900000000000001, -4.200000000000001, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -4.000000000000002, -4.100000000000001, -4.000000000000001, -4.200000000000001, -3.8000000000000007, -4.1000000000000005, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.200000000000001, -3.8000000000000007, -4.200000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -3.9000000000000004, -4.200000000000001, -4.100000000000001, -3.7000000000000006, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000002, -4.300000000000001, -4.300000000000001, -3.900000000000001, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.300000000000001, -3.8000000000000003, -3.800000000000001, -3.900000000000001, -4.000000000000002, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.400000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -4.200000000000001, -4.300000000000001, -4.1000000000000005, -4.300000000000001, -4.000000000000001, -4.200000000000001, -4.300000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000002, -4.000000000000001, -3.9000000000000012, -4.300000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -3.700000000000001, -3.900000000000001, -4.000000000000001, -3.9000000000000012, -4.100000000000001, -3.9000000000000012, -3.900000000000001, -4.000000000000002, -4.100000000000001, -4.300000000000001, -4.0, -4.100000000000001, -3.8000000000000007, -3.700000000000001, -3.900000000000001, -3.9000000000000012, -4.100000000000001, -4.0, -3.9000000000000012, -3.8000000000000007, -4.200000000000001, -4.300000000000001, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -3.8000000000000007], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.62082895881978, "mean_inference_ms": 18.15429770956668, "mean_action_processing_ms": 0.9384798301568464, "mean_env_wait_ms": 1.557125648835995, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07836831243414628, "StateBufferConnector_ms": 0.009844805064954255, "ViewRequirementAgentConnector_ms": 0.1392172512255217}}, "episode_reward_max": -3.7000000000000006, "episode_reward_min": -4.400000000000001, "episode_reward_mean": -4.047368421052632, "episode_len_mean": 21.0, "episodes_this_iter": 190, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.000000000000001, -4.300000000000001, -4.200000000000001, -4.200000000000001, -3.9000000000000012, -4.000000000000001, -4.200000000000001, -4.100000000000001, -4.200000000000001, -3.8000000000000007, -4.100000000000001, -4.1000000000000005, -3.900000000000001, -4.300000000000001, -3.900000000000001, -4.100000000000001, -4.1000000000000005, -4.000000000000001, -4.000000000000001, -3.9000000000000004, -4.100000000000001, -4.300000000000001, -4.100000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.300000000000001, -4.100000000000001, -4.0, -4.000000000000001, -4.300000000000001, -4.0, -4.100000000000001, -4.200000000000001, -4.1000000000000005, -4.100000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -3.9000000000000012, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -4.300000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.300000000000001, -4.300000000000001, -4.1000000000000005, -4.000000000000001, -4.000000000000002, -4.100000000000001, -3.900000000000001, -4.0, -3.900000000000001, -4.100000000000001, -4.000000000000002, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -4.300000000000001, -3.900000000000001, -4.200000000000001, -3.800000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000002, -3.900000000000001, -3.900000000000001, -3.9000000000000012, -4.100000000000001, -4.200000000000001, -4.200000000000001, -3.900000000000001, -3.9000000000000012, -3.9000000000000012, -3.900000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.300000000000001, -4.000000000000001, -4.000000000000002, -3.900000000000001, -4.200000000000001, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -4.000000000000002, -4.100000000000001, -4.000000000000001, -4.200000000000001, -3.8000000000000007, -4.1000000000000005, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.200000000000001, -3.8000000000000007, -4.200000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -3.9000000000000004, -4.200000000000001, -4.100000000000001, -3.7000000000000006, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000002, -4.300000000000001, -4.300000000000001, -3.900000000000001, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.300000000000001, -3.8000000000000003, -3.800000000000001, -3.900000000000001, -4.000000000000002, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.400000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -4.200000000000001, -4.300000000000001, -4.1000000000000005, -4.300000000000001, -4.000000000000001, -4.200000000000001, -4.300000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000002, -4.000000000000001, -3.9000000000000012, -4.300000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -3.700000000000001, -3.900000000000001, -4.000000000000001, -3.9000000000000012, -4.100000000000001, -3.9000000000000012, -3.900000000000001, -4.000000000000002, -4.100000000000001, -4.300000000000001, -4.0, -4.100000000000001, -3.8000000000000007, -3.700000000000001, -3.900000000000001, -3.9000000000000012, -4.100000000000001, -4.0, -3.9000000000000012, -3.8000000000000007, -4.200000000000001, -4.300000000000001, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -3.8000000000000007], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.62082895881978, "mean_inference_ms": 18.15429770956668, "mean_action_processing_ms": 0.9384798301568464, "mean_env_wait_ms": 1.557125648835995, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07836831243414628, "StateBufferConnector_ms": 0.009844805064954255, "ViewRequirementAgentConnector_ms": 0.1392172512255217}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 580000, "num_agent_steps_trained": 580000, "num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 580000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 580000, "timers": {"training_iteration_time_ms": 174495.203, "load_time_ms": 1.225, "load_throughput": 3264748.487, "learn_time_ms": 173534.207, "learn_throughput": 23.05, "synch_weights_time_ms": 182.935}, "counters": {"num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_agent_steps_sampled": 580000, "num_agent_steps_trained": 580000}, "done": false, "episodes_total": 29053, "training_iteration": 145, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_03-51-37", "timestamp": 1680832297, "time_this_iter_s": 174.148277759552, "time_total_s": 24957.177624702454, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476f2340>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff947018b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 24957.177624702454, "timesteps_since_restore": 0, "iterations_since_restore": 145, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.322983870967741, "ram_util_percent": 23.80282258064517}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1573.8106251542285, "cur_kl_coeff": 23350.396736354356, "cur_lr": 0.01, "total_loss": 11.321844651493976, "policy_loss": 0.0034113795446452273, "vf_loss": 0.36431000662907476, "vf_explained_var": 0.6677558124065399, "kl": 0.00046911936700663287, "entropy": 2.6568772077560423, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 135315.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_agent_steps_sampled": 584000, "num_agent_steps_trained": 584000}, "sampler_results": {"episode_reward_max": -3.7, "episode_reward_min": -10.5, "episode_reward_mean": -4.116751269035533, "episode_len_mean": 20.736040609137056, "episode_media": {}, "episodes_this_iter": 197, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.200000000000001, -4.000000000000002, -4.200000000000001, -4.200000000000001, -3.7000000000000006, -4.200000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000002, -3.800000000000001, -4.100000000000001, -4.100000000000001, -4.200000000000001, -4.200000000000001, -4.200000000000001, -10.1, -10.5, -4.100000000000001, -3.9000000000000004, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -3.700000000000001, -4.200000000000001, -3.700000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -4.300000000000001, -3.900000000000001, -3.900000000000001, -4.200000000000001, -3.900000000000001, -4.000000000000001, -3.7, -4.100000000000001, -3.9000000000000012, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.0, -3.900000000000001, -4.200000000000001, -3.8000000000000007, -4.300000000000001, -4.100000000000001, -4.1000000000000005, -4.100000000000001, -3.900000000000001, -4.4, -3.900000000000001, -4.200000000000001, -4.400000000000001, -4.300000000000001, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000002, -3.900000000000001, -4.000000000000001, -3.800000000000001, -4.000000000000002, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -3.700000000000001, -4.000000000000002, -4.100000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.300000000000001, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -3.8000000000000007, -4.200000000000001, -3.7000000000000006, -10.4, -3.900000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000002, -3.8000000000000007, -4.1000000000000005, -4.000000000000001, -4.200000000000001, -3.900000000000001, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.300000000000001, -4.000000000000001, -4.300000000000001, -4.200000000000001, -4.1000000000000005, -4.000000000000002, -4.100000000000001, -4.200000000000001, -4.000000000000001, -4.100000000000001, -3.8000000000000003, -3.900000000000001, -4.300000000000001, -4.000000000000002, -3.9000000000000004, -4.000000000000002, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -3.9000000000000012, -4.200000000000001, -4.100000000000001, -3.900000000000001, -4.0, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.200000000000001, -4.300000000000001, -4.100000000000001, -3.800000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -4.300000000000001, -4.100000000000001, -4.200000000000001, -3.8000000000000007, -4.1000000000000005, -3.9000000000000012, -4.1000000000000005, -4.300000000000001, -4.300000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -4.200000000000001, -4.100000000000001, -3.900000000000001, -3.8000000000000003, -4.200000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -3.9000000000000012, -4.200000000000001, -4.000000000000001, -3.8000000000000007, -3.700000000000001, -3.900000000000001, -4.000000000000002, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000002, -4.200000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -3.8000000000000007, -3.900000000000001, -3.9000000000000012, -3.9000000000000012, -4.000000000000001, -3.700000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.9000000000000012, -3.8000000000000007, -3.900000000000001, -3.9000000000000012], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.616882479968911, "mean_inference_ms": 18.12849525467822, "mean_action_processing_ms": 0.9380739477758391, "mean_env_wait_ms": 1.5547530817821502, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08164226706257932, "StateBufferConnector_ms": 0.010196932681320887, "ViewRequirementAgentConnector_ms": 0.1466165339281111}}, "episode_reward_max": -3.7, "episode_reward_min": -10.5, "episode_reward_mean": -4.116751269035533, "episode_len_mean": 20.736040609137056, "episodes_this_iter": 197, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.200000000000001, -4.000000000000002, -4.200000000000001, -4.200000000000001, -3.7000000000000006, -4.200000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000002, -3.800000000000001, -4.100000000000001, -4.100000000000001, -4.200000000000001, -4.200000000000001, -4.200000000000001, -10.1, -10.5, -4.100000000000001, -3.9000000000000004, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -3.700000000000001, -4.200000000000001, -3.700000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -4.300000000000001, -3.900000000000001, -3.900000000000001, -4.200000000000001, -3.900000000000001, -4.000000000000001, -3.7, -4.100000000000001, -3.9000000000000012, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.0, -3.900000000000001, -4.200000000000001, -3.8000000000000007, -4.300000000000001, -4.100000000000001, -4.1000000000000005, -4.100000000000001, -3.900000000000001, -4.4, -3.900000000000001, -4.200000000000001, -4.400000000000001, -4.300000000000001, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000002, -3.900000000000001, -4.000000000000001, -3.800000000000001, -4.000000000000002, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -3.700000000000001, -4.000000000000002, -4.100000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.300000000000001, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -3.8000000000000007, -4.200000000000001, -3.7000000000000006, -10.4, -3.900000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000002, -3.8000000000000007, -4.1000000000000005, -4.000000000000001, -4.200000000000001, -3.900000000000001, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.300000000000001, -4.000000000000001, -4.300000000000001, -4.200000000000001, -4.1000000000000005, -4.000000000000002, -4.100000000000001, -4.200000000000001, -4.000000000000001, -4.100000000000001, -3.8000000000000003, -3.900000000000001, -4.300000000000001, -4.000000000000002, -3.9000000000000004, -4.000000000000002, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -3.9000000000000012, -4.200000000000001, -4.100000000000001, -3.900000000000001, -4.0, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.200000000000001, -4.300000000000001, -4.100000000000001, -3.800000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -4.300000000000001, -4.100000000000001, -4.200000000000001, -3.8000000000000007, -4.1000000000000005, -3.9000000000000012, -4.1000000000000005, -4.300000000000001, -4.300000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -4.200000000000001, -4.100000000000001, -3.900000000000001, -3.8000000000000003, -4.200000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -3.9000000000000012, -4.200000000000001, -4.000000000000001, -3.8000000000000007, -3.700000000000001, -3.900000000000001, -4.000000000000002, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000002, -4.200000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -3.8000000000000007, -3.900000000000001, -3.9000000000000012, -3.9000000000000012, -4.000000000000001, -3.700000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.9000000000000012, -3.8000000000000007, -3.900000000000001, -3.9000000000000012], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.616882479968911, "mean_inference_ms": 18.12849525467822, "mean_action_processing_ms": 0.9380739477758391, "mean_env_wait_ms": 1.5547530817821502, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08164226706257932, "StateBufferConnector_ms": 0.010196932681320887, "ViewRequirementAgentConnector_ms": 0.1466165339281111}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 584000, "num_agent_steps_trained": 584000, "num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 584000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 584000, "timers": {"training_iteration_time_ms": 174496.421, "load_time_ms": 1.209, "load_throughput": 3308854.528, "learn_time_ms": 173531.28, "learn_throughput": 23.051, "synch_weights_time_ms": 184.009}, "counters": {"num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_agent_steps_sampled": 584000, "num_agent_steps_trained": 584000}, "done": false, "episodes_total": 29250, "training_iteration": 146, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_03-54-32", "timestamp": 1680832472, "time_this_iter_s": 174.7859947681427, "time_total_s": 25131.963619470596, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7eff947273a0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff9471bd30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 25131.963619470596, "timesteps_since_restore": 0, "iterations_since_restore": 146, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.30281124497992, "ram_util_percent": 23.808433734939765}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 113.18673512038364, "cur_kl_coeff": 11675.198368177178, "cur_lr": 0.01, "total_loss": 0.5520657636685877, "policy_loss": 0.0020686525611146806, "vf_loss": 0.23547964050404488, "vf_explained_var": 0.6859007334837349, "kl": 2.6938940480601646e-05, "entropy": 2.6574641935286984, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 136245.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000}, "sampler_results": {"episode_reward_max": -3.5000000000000004, "episode_reward_min": -4.500000000000001, "episode_reward_mean": -4.032275132275133, "episode_len_mean": 21.0, "episode_media": {}, "episodes_this_iter": 189, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.100000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -4.200000000000001, -3.9000000000000004, -3.900000000000001, -4.200000000000001, -4.200000000000001, -4.300000000000001, -3.9000000000000004, -4.000000000000001, -3.9000000000000004, -4.500000000000001, -4.000000000000001, -4.100000000000001, -4.1000000000000005, -3.900000000000001, -4.200000000000001, -4.000000000000002, -4.000000000000001, -4.200000000000001, -3.9000000000000012, -4.000000000000001, -4.000000000000002, -4.100000000000001, -4.100000000000001, -3.9000000000000012, -3.700000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.7000000000000006, -3.900000000000001, -4.400000000000001, -3.900000000000001, -3.900000000000001, -3.9000000000000012, -4.100000000000001, -4.000000000000001, -3.9000000000000004, -4.100000000000001, -4.200000000000001, -4.200000000000001, -4.300000000000001, -3.9000000000000012, -4.100000000000001, -4.200000000000001, -4.000000000000002, -3.900000000000001, -4.000000000000002, -3.9000000000000012, -3.900000000000001, -3.900000000000001, -3.900000000000001, -4.200000000000001, -4.300000000000001, -4.200000000000001, -4.300000000000001, -4.000000000000002, -4.200000000000001, -4.000000000000001, -4.000000000000001, -4.1000000000000005, -4.100000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000001, -3.800000000000001, -3.900000000000001, -4.000000000000001, -4.0, -4.200000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000002, -3.9000000000000012, -4.100000000000001, -4.1000000000000005, -4.000000000000002, -4.300000000000001, -3.900000000000001, -4.000000000000001, -4.0, -4.000000000000001, -4.200000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000001, -4.200000000000001, -3.8000000000000007, -3.8000000000000007, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000002, -3.900000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -4.400000000000002, -4.1000000000000005, -4.000000000000001, -3.800000000000001, -4.300000000000001, -4.400000000000001, -4.200000000000001, -3.900000000000001, -4.000000000000001, -3.800000000000001, -4.100000000000001, -4.100000000000001, -4.200000000000001, -4.200000000000001, -3.800000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -4.300000000000001, -3.7000000000000006, -4.200000000000001, -4.000000000000001, -4.0, -4.000000000000002, -3.800000000000001, -4.300000000000001, -4.000000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -3.900000000000001, -4.300000000000001, -4.100000000000001, -4.100000000000001, -4.300000000000001, -4.1000000000000005, -3.800000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.5000000000000004, -4.100000000000001, -4.0, -4.1000000000000005, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.9000000000000004, -4.200000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.400000000000001, -4.000000000000002, -4.000000000000001, -4.000000000000002, -4.1000000000000005, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000002, -4.100000000000001, -4.100000000000001, -4.000000000000002, -4.200000000000001, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -3.7000000000000006, -4.100000000000001, -4.200000000000001, -4.100000000000001, -3.8000000000000007], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.618511757151214, "mean_inference_ms": 18.133462774484617, "mean_action_processing_ms": 0.9378045707541457, "mean_env_wait_ms": 1.5527613916631788, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06685547097019418, "StateBufferConnector_ms": 0.008730535153989439, "ViewRequirementAgentConnector_ms": 0.12628578004382907}}, "episode_reward_max": -3.5000000000000004, "episode_reward_min": -4.500000000000001, "episode_reward_mean": -4.032275132275133, "episode_len_mean": 21.0, "episodes_this_iter": 189, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.100000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -4.200000000000001, -3.9000000000000004, -3.900000000000001, -4.200000000000001, -4.200000000000001, -4.300000000000001, -3.9000000000000004, -4.000000000000001, -3.9000000000000004, -4.500000000000001, -4.000000000000001, -4.100000000000001, -4.1000000000000005, -3.900000000000001, -4.200000000000001, -4.000000000000002, -4.000000000000001, -4.200000000000001, -3.9000000000000012, -4.000000000000001, -4.000000000000002, -4.100000000000001, -4.100000000000001, -3.9000000000000012, -3.700000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.7000000000000006, -3.900000000000001, -4.400000000000001, -3.900000000000001, -3.900000000000001, -3.9000000000000012, -4.100000000000001, -4.000000000000001, -3.9000000000000004, -4.100000000000001, -4.200000000000001, -4.200000000000001, -4.300000000000001, -3.9000000000000012, -4.100000000000001, -4.200000000000001, -4.000000000000002, -3.900000000000001, -4.000000000000002, -3.9000000000000012, -3.900000000000001, -3.900000000000001, -3.900000000000001, -4.200000000000001, -4.300000000000001, -4.200000000000001, -4.300000000000001, -4.000000000000002, -4.200000000000001, -4.000000000000001, -4.000000000000001, -4.1000000000000005, -4.100000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000001, -3.800000000000001, -3.900000000000001, -4.000000000000001, -4.0, -4.200000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000002, -3.9000000000000012, -4.100000000000001, -4.1000000000000005, -4.000000000000002, -4.300000000000001, -3.900000000000001, -4.000000000000001, -4.0, -4.000000000000001, -4.200000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000001, -4.200000000000001, -3.8000000000000007, -3.8000000000000007, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000002, -3.900000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -4.400000000000002, -4.1000000000000005, -4.000000000000001, -3.800000000000001, -4.300000000000001, -4.400000000000001, -4.200000000000001, -3.900000000000001, -4.000000000000001, -3.800000000000001, -4.100000000000001, -4.100000000000001, -4.200000000000001, -4.200000000000001, -3.800000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -4.300000000000001, -3.7000000000000006, -4.200000000000001, -4.000000000000001, -4.0, -4.000000000000002, -3.800000000000001, -4.300000000000001, -4.000000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -3.900000000000001, -4.300000000000001, -4.100000000000001, -4.100000000000001, -4.300000000000001, -4.1000000000000005, -3.800000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.5000000000000004, -4.100000000000001, -4.0, -4.1000000000000005, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.9000000000000004, -4.200000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.400000000000001, -4.000000000000002, -4.000000000000001, -4.000000000000002, -4.1000000000000005, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000002, -4.100000000000001, -4.100000000000001, -4.000000000000002, -4.200000000000001, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -3.7000000000000006, -4.100000000000001, -4.200000000000001, -4.100000000000001, -3.8000000000000007], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.618511757151214, "mean_inference_ms": 18.133462774484617, "mean_action_processing_ms": 0.9378045707541457, "mean_env_wait_ms": 1.5527613916631788, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06685547097019418, "StateBufferConnector_ms": 0.008730535153989439, "ViewRequirementAgentConnector_ms": 0.12628578004382907}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 588000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 588000, "timers": {"training_iteration_time_ms": 174573.295, "load_time_ms": 1.194, "load_throughput": 3350016.174, "learn_time_ms": 173612.518, "learn_throughput": 23.04, "synch_weights_time_ms": 183.677}, "counters": {"num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000}, "done": false, "episodes_total": 29439, "training_iteration": 147, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_03-57-27", "timestamp": 1680832647, "time_this_iter_s": 175.2349739074707, "time_total_s": 25307.198593378067, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01477a36a0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7effc004fe50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 25307.198593378067, "timesteps_since_restore": 0, "iterations_since_restore": 147, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.581927710843374, "ram_util_percent": 23.816064257028117}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.78128122821931, "cur_kl_coeff": 5837.599184088589, "cur_lr": 0.01, "total_loss": 0.24729470559045352, "policy_loss": 0.0005359617742880057, "vf_loss": 0.2663426988467734, "vf_explained_var": 0.7124774387446783, "kl": -3.3547962670984703e-06, "entropy": 2.6577330112457274, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 137175.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "sampler_results": {"episode_reward_max": -3.6000000000000005, "episode_reward_min": -4.300000000000001, "episode_reward_mean": -4.0010362694300525, "episode_len_mean": 21.0, "episode_media": {}, "episodes_this_iter": 193, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.7000000000000006, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.200000000000001, -3.900000000000001, -3.900000000000001, -4.300000000000001, -4.000000000000001, -4.100000000000001, -4.0, -4.200000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000002, -4.100000000000001, -4.000000000000001, -4.200000000000001, -4.300000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.9000000000000012, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.800000000000001, -4.000000000000001, -4.100000000000001, -4.1000000000000005, -4.000000000000002, -3.8000000000000016, -4.100000000000001, -3.6000000000000005, -3.8000000000000007, -3.8000000000000003, -3.7000000000000006, -3.8000000000000007, -4.200000000000001, -4.000000000000001, -4.100000000000001, -4.300000000000001, -4.000000000000002, -4.000000000000001, -4.200000000000001, -3.8000000000000007, -3.9000000000000004, -4.300000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -4.0, -4.0, -4.200000000000001, -4.100000000000001, -4.0, -4.200000000000001, -4.1000000000000005, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -4.200000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.9000000000000012, -4.200000000000001, -4.200000000000001, -3.9000000000000012, -3.8000000000000007, -3.8000000000000007, -4.300000000000001, -4.000000000000001, -4.300000000000001, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -3.9000000000000012, -4.200000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -3.9000000000000012, -3.700000000000001, -4.000000000000001, -3.8000000000000007, -3.700000000000001, -4.000000000000001, -4.000000000000002, -4.000000000000001, -3.900000000000001, -4.0, -3.9000000000000004, -4.200000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.200000000000001, -3.900000000000001, -3.800000000000001, -3.8000000000000007, -4.100000000000001, -4.200000000000001, -4.000000000000002, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -4.200000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.0, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000001, -4.200000000000001, -3.900000000000001, -3.900000000000001, -4.300000000000001, -3.9000000000000012, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -3.9000000000000012, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.200000000000001, -4.0, -4.100000000000001, -3.7000000000000006, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -4.200000000000001, -3.9000000000000012, -4.0, -4.200000000000001, -3.7000000000000006, -3.8000000000000007, -4.200000000000001, -3.9000000000000012, -3.900000000000001, -3.9000000000000012, -4.100000000000001, -3.9000000000000012, -4.000000000000001, -3.8000000000000003, -3.9000000000000004, -3.900000000000001, -4.1000000000000005, -4.1000000000000005], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.616252579581314, "mean_inference_ms": 18.144191024739715, "mean_action_processing_ms": 0.9380263013671323, "mean_env_wait_ms": 1.5516510108191466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08310938128535611, "StateBufferConnector_ms": 0.010840262773741095, "ViewRequirementAgentConnector_ms": 0.14988931349522092}}, "episode_reward_max": -3.6000000000000005, "episode_reward_min": -4.300000000000001, "episode_reward_mean": -4.0010362694300525, "episode_len_mean": 21.0, "episodes_this_iter": 193, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.7000000000000006, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.200000000000001, -3.900000000000001, -3.900000000000001, -4.300000000000001, -4.000000000000001, -4.100000000000001, -4.0, -4.200000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000002, -4.100000000000001, -4.000000000000001, -4.200000000000001, -4.300000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.9000000000000012, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.800000000000001, -4.000000000000001, -4.100000000000001, -4.1000000000000005, -4.000000000000002, -3.8000000000000016, -4.100000000000001, -3.6000000000000005, -3.8000000000000007, -3.8000000000000003, -3.7000000000000006, -3.8000000000000007, -4.200000000000001, -4.000000000000001, -4.100000000000001, -4.300000000000001, -4.000000000000002, -4.000000000000001, -4.200000000000001, -3.8000000000000007, -3.9000000000000004, -4.300000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -4.0, -4.0, -4.200000000000001, -4.100000000000001, -4.0, -4.200000000000001, -4.1000000000000005, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -4.200000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.9000000000000012, -4.200000000000001, -4.200000000000001, -3.9000000000000012, -3.8000000000000007, -3.8000000000000007, -4.300000000000001, -4.000000000000001, -4.300000000000001, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -3.9000000000000012, -4.200000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -3.9000000000000012, -3.700000000000001, -4.000000000000001, -3.8000000000000007, -3.700000000000001, -4.000000000000001, -4.000000000000002, -4.000000000000001, -3.900000000000001, -4.0, -3.9000000000000004, -4.200000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.200000000000001, -3.900000000000001, -3.800000000000001, -3.8000000000000007, -4.100000000000001, -4.200000000000001, -4.000000000000002, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -4.200000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.0, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000001, -4.200000000000001, -3.900000000000001, -3.900000000000001, -4.300000000000001, -3.9000000000000012, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -3.9000000000000012, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.200000000000001, -4.0, -4.100000000000001, -3.7000000000000006, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -4.200000000000001, -3.9000000000000012, -4.0, -4.200000000000001, -3.7000000000000006, -3.8000000000000007, -4.200000000000001, -3.9000000000000012, -3.900000000000001, -3.9000000000000012, -4.100000000000001, -3.9000000000000012, -4.000000000000001, -3.8000000000000003, -3.9000000000000004, -3.900000000000001, -4.1000000000000005, -4.1000000000000005], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.616252579581314, "mean_inference_ms": 18.144191024739715, "mean_action_processing_ms": 0.9380263013671323, "mean_env_wait_ms": 1.5516510108191466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08310938128535611, "StateBufferConnector_ms": 0.010840262773741095, "ViewRequirementAgentConnector_ms": 0.14988931349522092}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000, "num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 592000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 592000, "timers": {"training_iteration_time_ms": 174645.194, "load_time_ms": 1.211, "load_throughput": 3302341.548, "learn_time_ms": 173683.557, "learn_throughput": 23.03, "synch_weights_time_ms": 180.822}, "counters": {"num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "done": false, "episodes_total": 29632, "training_iteration": 148, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_04-00-22", "timestamp": 1680832822, "time_this_iter_s": 175.03907918930054, "time_total_s": 25482.237672567368, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01473e2340>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff94727ee0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 25482.237672567368, "timesteps_since_restore": 0, "iterations_since_restore": 148, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.671084337349398, "ram_util_percent": 23.816064257028117}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22.604851144872686, "cur_kl_coeff": 2918.7995920442945, "cur_lr": 0.01, "total_loss": 0.373409326316949, "policy_loss": 0.002733916504889406, "vf_loss": 0.31049397790464023, "vf_explained_var": 0.7133224351431734, "kl": 2.061855549193963e-05, "entropy": 2.6570590908809373, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 138105.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_agent_steps_sampled": 596000, "num_agent_steps_trained": 596000}, "sampler_results": {"episode_reward_max": -3.7000000000000006, "episode_reward_min": -4.400000000000001, "episode_reward_mean": -4.030256410256411, "episode_len_mean": 21.0, "episode_media": {}, "episodes_this_iter": 195, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.100000000000001, -4.100000000000001, -4.0, -4.200000000000001, -4.000000000000001, -4.200000000000001, -4.200000000000001, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000002, -3.8000000000000007, -3.8000000000000007, -4.300000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.9000000000000004, -3.800000000000001, -4.000000000000002, -3.800000000000001, -4.300000000000001, -4.000000000000001, -3.9000000000000012, -4.4, -4.300000000000001, -4.400000000000001, -3.9000000000000012, -4.1000000000000005, -4.300000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -4.300000000000001, -4.200000000000001, -4.200000000000001, -4.1000000000000005, -3.900000000000001, -3.900000000000001, -4.000000000000002, -3.8000000000000007, -3.7000000000000006, -3.8000000000000003, -4.100000000000001, -4.200000000000001, -4.000000000000002, -4.000000000000001, -4.300000000000001, -4.000000000000001, -4.200000000000001, -4.200000000000001, -4.000000000000001, -4.0, -4.100000000000001, -4.000000000000001, -4.200000000000001, -4.0, -4.100000000000001, -3.900000000000001, -4.000000000000002, -4.100000000000001, -4.300000000000001, -4.000000000000001, -4.100000000000001, -3.9000000000000004, -4.100000000000001, -4.200000000000001, -3.800000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.300000000000001, -4.000000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000002, -4.100000000000001, -4.200000000000001, -4.100000000000001, -3.900000000000001, -3.800000000000001, -4.000000000000001, -3.900000000000001, -4.200000000000001, -4.200000000000001, -4.100000000000001, -4.200000000000001, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000002, -4.200000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000001, -3.9000000000000012, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -4.000000000000002, -4.000000000000001, -3.900000000000001, -4.200000000000001, -4.200000000000001, -4.100000000000001, -4.300000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.300000000000001, -3.900000000000001, -3.900000000000001, -4.1000000000000005, -4.100000000000001, -4.000000000000001, -4.000000000000002, -4.000000000000001, -4.000000000000001, -4.000000000000002, -4.1000000000000005, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -3.9000000000000012, -4.000000000000001, -3.7000000000000006, -4.200000000000001, -3.800000000000001, -4.200000000000001, -4.300000000000001, -4.100000000000001, -4.100000000000001, -3.9000000000000004, -3.8000000000000007, -4.200000000000001, -4.000000000000002, -4.100000000000001, -4.200000000000001, -3.900000000000001, -4.200000000000001, -4.200000000000001, -3.7000000000000006, -4.000000000000001, -4.300000000000001, -4.000000000000001, -4.100000000000001, -4.300000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -3.7000000000000006, -4.100000000000001, -3.800000000000001, -4.000000000000001, -3.800000000000001, -3.700000000000001, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000002, -3.900000000000001, -3.9000000000000012, -4.1000000000000005, -4.000000000000001, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -3.7000000000000006, -3.700000000000001, -4.200000000000001, -4.000000000000002, -3.8000000000000007, -4.000000000000001, -3.9000000000000012, -3.8000000000000007], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.617233802459351, "mean_inference_ms": 18.14432941990274, "mean_action_processing_ms": 0.938086371524803, "mean_env_wait_ms": 1.550227312228399, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08277844160031049, "StateBufferConnector_ms": 0.010645083892039763, "ViewRequirementAgentConnector_ms": 0.15231120280730417}}, "episode_reward_max": -3.7000000000000006, "episode_reward_min": -4.400000000000001, "episode_reward_mean": -4.030256410256411, "episode_len_mean": 21.0, "episodes_this_iter": 195, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.100000000000001, -4.100000000000001, -4.0, -4.200000000000001, -4.000000000000001, -4.200000000000001, -4.200000000000001, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000002, -3.8000000000000007, -3.8000000000000007, -4.300000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.9000000000000004, -3.800000000000001, -4.000000000000002, -3.800000000000001, -4.300000000000001, -4.000000000000001, -3.9000000000000012, -4.4, -4.300000000000001, -4.400000000000001, -3.9000000000000012, -4.1000000000000005, -4.300000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -4.300000000000001, -4.200000000000001, -4.200000000000001, -4.1000000000000005, -3.900000000000001, -3.900000000000001, -4.000000000000002, -3.8000000000000007, -3.7000000000000006, -3.8000000000000003, -4.100000000000001, -4.200000000000001, -4.000000000000002, -4.000000000000001, -4.300000000000001, -4.000000000000001, -4.200000000000001, -4.200000000000001, -4.000000000000001, -4.0, -4.100000000000001, -4.000000000000001, -4.200000000000001, -4.0, -4.100000000000001, -3.900000000000001, -4.000000000000002, -4.100000000000001, -4.300000000000001, -4.000000000000001, -4.100000000000001, -3.9000000000000004, -4.100000000000001, -4.200000000000001, -3.800000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.300000000000001, -4.000000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000002, -4.100000000000001, -4.200000000000001, -4.100000000000001, -3.900000000000001, -3.800000000000001, -4.000000000000001, -3.900000000000001, -4.200000000000001, -4.200000000000001, -4.100000000000001, -4.200000000000001, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000002, -4.200000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000001, -3.9000000000000012, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -4.000000000000002, -4.000000000000001, -3.900000000000001, -4.200000000000001, -4.200000000000001, -4.100000000000001, -4.300000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.300000000000001, -3.900000000000001, -3.900000000000001, -4.1000000000000005, -4.100000000000001, -4.000000000000001, -4.000000000000002, -4.000000000000001, -4.000000000000001, -4.000000000000002, -4.1000000000000005, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -3.9000000000000012, -4.000000000000001, -3.7000000000000006, -4.200000000000001, -3.800000000000001, -4.200000000000001, -4.300000000000001, -4.100000000000001, -4.100000000000001, -3.9000000000000004, -3.8000000000000007, -4.200000000000001, -4.000000000000002, -4.100000000000001, -4.200000000000001, -3.900000000000001, -4.200000000000001, -4.200000000000001, -3.7000000000000006, -4.000000000000001, -4.300000000000001, -4.000000000000001, -4.100000000000001, -4.300000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -3.7000000000000006, -4.100000000000001, -3.800000000000001, -4.000000000000001, -3.800000000000001, -3.700000000000001, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000002, -3.900000000000001, -3.9000000000000012, -4.1000000000000005, -4.000000000000001, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -3.7000000000000006, -3.700000000000001, -4.200000000000001, -4.000000000000002, -3.8000000000000007, -4.000000000000001, -3.9000000000000012, -3.8000000000000007], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.617233802459351, "mean_inference_ms": 18.14432941990274, "mean_action_processing_ms": 0.938086371524803, "mean_env_wait_ms": 1.550227312228399, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08277844160031049, "StateBufferConnector_ms": 0.010645083892039763, "ViewRequirementAgentConnector_ms": 0.15231120280730417}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 596000, "num_agent_steps_trained": 596000, "num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 596000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 596000, "timers": {"training_iteration_time_ms": 174668.162, "load_time_ms": 1.204, "load_throughput": 3321102.995, "learn_time_ms": 173695.772, "learn_throughput": 23.029, "synch_weights_time_ms": 182.318}, "counters": {"num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_agent_steps_sampled": 596000, "num_agent_steps_trained": 596000}, "done": false, "episodes_total": 29827, "training_iteration": 149, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_04-03-17", "timestamp": 1680832997, "time_this_iter_s": 174.83599615097046, "time_total_s": 25657.073668718338, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f014746eaf0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7effc004fe50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 25657.073668718338, "timesteps_since_restore": 0, "iterations_since_restore": 149, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 6.018548387096775, "ram_util_percent": 23.810887096774202}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 64.27413297212252, "cur_kl_coeff": 1459.3997960221473, "cur_lr": 0.01, "total_loss": 0.7181756441922037, "policy_loss": 0.0013458700690378426, "vf_loss": 0.29480442869406875, "vf_explained_var": 0.6735635221004486, "kl": 0.00028917733928868184, "entropy": 2.658060056419783, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 139035.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "sampler_results": {"episode_reward_max": -3.7000000000000006, "episode_reward_min": -10.9, "episode_reward_mean": -4.070312500000001, "episode_len_mean": 20.9375, "episode_media": {}, "episodes_this_iter": 192, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.000000000000001, -4.300000000000001, -4.200000000000001, -4.1000000000000005, -3.8000000000000003, -4.200000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.200000000000001, -3.9000000000000012, -4.000000000000002, -4.0, -4.200000000000001, -4.200000000000001, -4.200000000000001, -4.1000000000000005, -4.200000000000001, -4.100000000000001, -4.200000000000001, -3.9000000000000004, -4.100000000000001, -4.0, -4.300000000000001, -3.900000000000001, -4.000000000000001, -3.700000000000001, -4.100000000000001, -3.700000000000001, -3.8000000000000007, -4.1000000000000005, -4.000000000000002, -4.100000000000001, -4.100000000000001, -3.900000000000001, -4.200000000000001, -4.200000000000001, -4.000000000000001, -4.200000000000001, -4.300000000000001, -4.000000000000001, -3.8000000000000003, -3.800000000000001, -4.1000000000000005, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -4.300000000000001, -3.9000000000000012, -3.7000000000000006, -4.100000000000001, -4.000000000000001, -4.300000000000001, -4.200000000000001, -4.400000000000001, -4.200000000000001, -3.9000000000000012, -4.000000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -4.300000000000001, -3.900000000000001, -4.200000000000001, -4.0, -4.1000000000000005, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000002, -3.9000000000000004, -4.0, -4.200000000000001, -3.900000000000001, -4.300000000000001, -4.100000000000001, -4.1000000000000005, -4.1000000000000005, -4.100000000000001, -3.800000000000001, -4.100000000000001, -10.9, -4.0, -4.200000000000001, -3.900000000000001, -4.000000000000002, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -3.900000000000001, -3.9000000000000012, -4.100000000000001, -4.000000000000001, -4.200000000000001, -3.9000000000000012, -3.9000000000000012, -4.000000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000002, -4.100000000000001, -4.200000000000001, -3.900000000000001, -3.7000000000000006, -4.200000000000001, -4.000000000000001, -4.200000000000001, -4.200000000000001, -4.1000000000000005, -4.300000000000001, -3.800000000000001, -4.200000000000001, -3.800000000000001, -4.000000000000001, -4.300000000000001, -4.000000000000001, -4.300000000000001, -3.800000000000001, -4.100000000000001, -4.300000000000001, -4.1000000000000005, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.300000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -4.0, -4.200000000000001, -4.100000000000001, -4.000000000000002, -4.100000000000001, -4.500000000000002, -4.1000000000000005, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -3.800000000000001, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -4.200000000000001, -3.7000000000000006, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -4.200000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.200000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -4.1000000000000005, -3.9000000000000012, -4.000000000000001, -4.100000000000001, -4.400000000000001, -3.900000000000001, -3.900000000000001, -3.9000000000000004, -4.100000000000001, -3.900000000000001, -4.1000000000000005, -3.900000000000001, -4.000000000000001, -3.800000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.628436610537953, "mean_inference_ms": 18.223602626785944, "mean_action_processing_ms": 0.9401640365994481, "mean_env_wait_ms": 1.5529883870492707, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10520157714684804, "StateBufferConnector_ms": 0.012882178028424581, "ViewRequirementAgentConnector_ms": 0.1837071031332016}}, "episode_reward_max": -3.7000000000000006, "episode_reward_min": -10.9, "episode_reward_mean": -4.070312500000001, "episode_len_mean": 20.9375, "episodes_this_iter": 192, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.000000000000001, -4.300000000000001, -4.200000000000001, -4.1000000000000005, -3.8000000000000003, -4.200000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.200000000000001, -3.9000000000000012, -4.000000000000002, -4.0, -4.200000000000001, -4.200000000000001, -4.200000000000001, -4.1000000000000005, -4.200000000000001, -4.100000000000001, -4.200000000000001, -3.9000000000000004, -4.100000000000001, -4.0, -4.300000000000001, -3.900000000000001, -4.000000000000001, -3.700000000000001, -4.100000000000001, -3.700000000000001, -3.8000000000000007, -4.1000000000000005, -4.000000000000002, -4.100000000000001, -4.100000000000001, -3.900000000000001, -4.200000000000001, -4.200000000000001, -4.000000000000001, -4.200000000000001, -4.300000000000001, -4.000000000000001, -3.8000000000000003, -3.800000000000001, -4.1000000000000005, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -4.300000000000001, -3.9000000000000012, -3.7000000000000006, -4.100000000000001, -4.000000000000001, -4.300000000000001, -4.200000000000001, -4.400000000000001, -4.200000000000001, -3.9000000000000012, -4.000000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -4.300000000000001, -3.900000000000001, -4.200000000000001, -4.0, -4.1000000000000005, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000002, -3.9000000000000004, -4.0, -4.200000000000001, -3.900000000000001, -4.300000000000001, -4.100000000000001, -4.1000000000000005, -4.1000000000000005, -4.100000000000001, -3.800000000000001, -4.100000000000001, -10.9, -4.0, -4.200000000000001, -3.900000000000001, -4.000000000000002, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -3.900000000000001, -3.9000000000000012, -4.100000000000001, -4.000000000000001, -4.200000000000001, -3.9000000000000012, -3.9000000000000012, -4.000000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000002, -4.100000000000001, -4.200000000000001, -3.900000000000001, -3.7000000000000006, -4.200000000000001, -4.000000000000001, -4.200000000000001, -4.200000000000001, -4.1000000000000005, -4.300000000000001, -3.800000000000001, -4.200000000000001, -3.800000000000001, -4.000000000000001, -4.300000000000001, -4.000000000000001, -4.300000000000001, -3.800000000000001, -4.100000000000001, -4.300000000000001, -4.1000000000000005, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.300000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -4.0, -4.200000000000001, -4.100000000000001, -4.000000000000002, -4.100000000000001, -4.500000000000002, -4.1000000000000005, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -3.800000000000001, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -4.200000000000001, -3.7000000000000006, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -4.200000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.200000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -4.1000000000000005, -3.9000000000000012, -4.000000000000001, -4.100000000000001, -4.400000000000001, -3.900000000000001, -3.900000000000001, -3.9000000000000004, -4.100000000000001, -3.900000000000001, -4.1000000000000005, -3.900000000000001, -4.000000000000001, -3.800000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 9, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.628436610537953, "mean_inference_ms": 18.223602626785944, "mean_action_processing_ms": 0.9401640365994481, "mean_env_wait_ms": 1.5529883870492707, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10520157714684804, "StateBufferConnector_ms": 0.012882178028424581, "ViewRequirementAgentConnector_ms": 0.1837071031332016}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 600000, "timers": {"training_iteration_time_ms": 174754.195, "load_time_ms": 1.195, "load_throughput": 3348010.616, "learn_time_ms": 173752.682, "learn_throughput": 23.021, "synch_weights_time_ms": 181.776}, "counters": {"num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "done": false, "episodes_total": 30019, "training_iteration": 150, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_04-06-13", "timestamp": 1680833173, "time_this_iter_s": 175.44692063331604, "time_total_s": 25832.520589351654, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476d7b80>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff94718ee0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 25832.520589351654, "timesteps_since_restore": 0, "iterations_since_restore": 150, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.850800000000001, "ram_util_percent": 23.8184}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.487876677000393, "cur_kl_coeff": 729.6998980110736, "cur_lr": 0.01, "total_loss": 0.3560016997158527, "policy_loss": -0.0005865468858911465, "vf_loss": 0.27173167825225863, "vf_explained_var": 0.6734538422476861, "kl": 0.00011628968489982873, "entropy": 2.6607599014876993, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 139965.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 604000, "num_env_steps_trained": 604000, "num_agent_steps_sampled": 604000, "num_agent_steps_trained": 604000}, "sampler_results": {"episode_reward_max": -3.6000000000000005, "episode_reward_min": -10.7, "episode_reward_mean": -4.07663043478261, "episode_len_mean": 20.918478260869566, "episode_media": {}, "episodes_this_iter": 184, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.000000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000002, -3.900000000000001, -4.200000000000001, -4.0, -4.200000000000001, -10.7, -4.200000000000001, -4.100000000000001, -4.4, -4.200000000000001, -3.900000000000001, -3.800000000000001, -4.000000000000002, -4.000000000000002, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000002, -4.000000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000002, -4.100000000000001, -4.200000000000001, -4.200000000000001, -3.900000000000001, -4.200000000000001, -4.200000000000001, -4.200000000000001, -4.0, -4.100000000000001, -4.0, -4.200000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.9000000000000012, -4.100000000000001, -3.900000000000001, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.300000000000001, -4.000000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000001, -3.9000000000000004, -4.1000000000000005, -4.000000000000002, -3.900000000000001, -4.100000000000001, -4.000000000000002, -4.0, -3.900000000000001, -4.200000000000001, -3.9000000000000012, -4.000000000000001, -4.000000000000001, -4.1000000000000005, -4.000000000000002, -4.300000000000001, -3.700000000000001, -4.000000000000002, -3.9000000000000012, -4.200000000000001, -4.000000000000002, -4.000000000000002, -4.100000000000001, -3.900000000000001, -4.200000000000001, -4.200000000000001, -4.300000000000001, -4.100000000000001, -3.6000000000000005, -4.000000000000002, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.300000000000001, -4.200000000000001, -3.8000000000000007, -4.300000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -4.200000000000001, -4.200000000000001, -4.000000000000001, -3.900000000000001, -4.0, -4.100000000000001, -3.8000000000000007, -4.000000000000002, -4.200000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000002, -4.200000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.200000000000001, -3.9000000000000012, -3.900000000000001, -4.000000000000002, -4.200000000000001, -4.200000000000001, -4.0, -4.0, -4.100000000000001, -3.900000000000001, -4.300000000000001, -3.6000000000000005, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.200000000000001, -4.0, -3.900000000000001, -4.000000000000001, -4.1000000000000005, -3.9000000000000004, -4.200000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -4.300000000000001, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -4.300000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000002, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -3.800000000000001, -4.300000000000001, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -4.0, -4.1000000000000005, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.9000000000000012, -3.9000000000000012, -3.9000000000000012, -4.200000000000001, -3.9000000000000012, -4.100000000000001, -4.200000000000001, -4.000000000000001, -4.0, -4.000000000000001, -3.9000000000000012, -4.100000000000001, -3.6000000000000005, -4.100000000000001, -3.9000000000000012], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.628244134645934, "mean_inference_ms": 18.218229972672646, "mean_action_processing_ms": 0.9399167253479631, "mean_env_wait_ms": 1.5503724010343123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07466064847033957, "StateBufferConnector_ms": 0.009452648784803308, "ViewRequirementAgentConnector_ms": 0.1365465962368509}}, "episode_reward_max": -3.6000000000000005, "episode_reward_min": -10.7, "episode_reward_mean": -4.07663043478261, "episode_len_mean": 20.918478260869566, "episodes_this_iter": 184, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.000000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000002, -3.900000000000001, -4.200000000000001, -4.0, -4.200000000000001, -10.7, -4.200000000000001, -4.100000000000001, -4.4, -4.200000000000001, -3.900000000000001, -3.800000000000001, -4.000000000000002, -4.000000000000002, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000002, -4.000000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000002, -4.100000000000001, -4.200000000000001, -4.200000000000001, -3.900000000000001, -4.200000000000001, -4.200000000000001, -4.200000000000001, -4.0, -4.100000000000001, -4.0, -4.200000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.9000000000000012, -4.100000000000001, -3.900000000000001, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.300000000000001, -4.000000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000001, -3.9000000000000004, -4.1000000000000005, -4.000000000000002, -3.900000000000001, -4.100000000000001, -4.000000000000002, -4.0, -3.900000000000001, -4.200000000000001, -3.9000000000000012, -4.000000000000001, -4.000000000000001, -4.1000000000000005, -4.000000000000002, -4.300000000000001, -3.700000000000001, -4.000000000000002, -3.9000000000000012, -4.200000000000001, -4.000000000000002, -4.000000000000002, -4.100000000000001, -3.900000000000001, -4.200000000000001, -4.200000000000001, -4.300000000000001, -4.100000000000001, -3.6000000000000005, -4.000000000000002, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.300000000000001, -4.200000000000001, -3.8000000000000007, -4.300000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -4.200000000000001, -4.200000000000001, -4.000000000000001, -3.900000000000001, -4.0, -4.100000000000001, -3.8000000000000007, -4.000000000000002, -4.200000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000002, -4.200000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.200000000000001, -3.9000000000000012, -3.900000000000001, -4.000000000000002, -4.200000000000001, -4.200000000000001, -4.0, -4.0, -4.100000000000001, -3.900000000000001, -4.300000000000001, -3.6000000000000005, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.200000000000001, -4.0, -3.900000000000001, -4.000000000000001, -4.1000000000000005, -3.9000000000000004, -4.200000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -4.300000000000001, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -4.300000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000002, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -3.800000000000001, -4.300000000000001, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -4.0, -4.1000000000000005, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.9000000000000012, -3.9000000000000012, -3.9000000000000012, -4.200000000000001, -3.9000000000000012, -4.100000000000001, -4.200000000000001, -4.000000000000001, -4.0, -4.000000000000001, -3.9000000000000012, -4.100000000000001, -3.6000000000000005, -4.100000000000001, -3.9000000000000012], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.628244134645934, "mean_inference_ms": 18.218229972672646, "mean_action_processing_ms": 0.9399167253479631, "mean_env_wait_ms": 1.5503724010343123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07466064847033957, "StateBufferConnector_ms": 0.009452648784803308, "ViewRequirementAgentConnector_ms": 0.1365465962368509}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 604000, "num_agent_steps_trained": 604000, "num_env_steps_sampled": 604000, "num_env_steps_trained": 604000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 604000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 604000, "timers": {"training_iteration_time_ms": 174774.228, "load_time_ms": 1.186, "load_throughput": 3371898.063, "learn_time_ms": 173774.563, "learn_throughput": 23.018, "synch_weights_time_ms": 180.366}, "counters": {"num_env_steps_sampled": 604000, "num_env_steps_trained": 604000, "num_agent_steps_sampled": 604000, "num_agent_steps_trained": 604000}, "done": false, "episodes_total": 30203, "training_iteration": 151, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_04-09-07", "timestamp": 1680833347, "time_this_iter_s": 174.63091945648193, "time_total_s": 26007.151508808136, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01472af910>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff946d0700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 26007.151508808136, "timesteps_since_restore": 0, "iterations_since_restore": 151, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.277822580645162, "ram_util_percent": 23.805645161290325}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.038746437846973, "cur_kl_coeff": 364.8499490055368, "cur_lr": 0.01, "total_loss": 0.27824032785363434, "policy_loss": 0.002236678056739351, "vf_loss": 0.26496608897402724, "vf_explained_var": 0.6775631561715115, "kl": 3.025233083990902e-05, "entropy": 2.660668469244434, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 140895.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "sampler_results": {"episode_reward_max": -3.7000000000000006, "episode_reward_min": -10.1, "episode_reward_mean": -4.061139896373057, "episode_len_mean": 20.901554404145077, "episode_media": {}, "episodes_this_iter": 193, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.100000000000001, -4.000000000000002, -4.200000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -4.200000000000001, -4.300000000000001, -4.1000000000000005, -4.100000000000001, -3.900000000000001, -4.1000000000000005, -3.900000000000001, -3.900000000000001, -10.1, -4.200000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.200000000000001, -3.9000000000000012, -4.100000000000001, -4.000000000000001, -4.1000000000000005, -4.200000000000001, -4.000000000000001, -4.000000000000002, -4.100000000000001, -4.200000000000001, -3.9000000000000012, -4.000000000000001, -4.200000000000001, -3.8000000000000007, -3.900000000000001, -3.9000000000000004, -4.200000000000001, -4.200000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.300000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -3.800000000000001, -4.300000000000001, -4.000000000000001, -4.100000000000001, -4.400000000000001, -3.900000000000001, -4.100000000000001, -3.9000000000000012, -4.000000000000001, -3.9000000000000012, -4.000000000000001, -4.400000000000001, -4.100000000000001, -3.9000000000000012, -4.000000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000002, -4.000000000000001, -4.100000000000001, -4.200000000000001, -4.200000000000001, -4.000000000000002, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000002, -4.200000000000001, -4.100000000000001, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -3.9000000000000012, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.9000000000000012, -3.800000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000002, -4.100000000000001, -4.000000000000001, -4.200000000000001, -3.9000000000000012, -4.100000000000001, -3.9000000000000012, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.400000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -4.500000000000002, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -4.100000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.1000000000000005, -4.100000000000001, -3.900000000000001, -3.800000000000001, -4.100000000000001, -3.8000000000000007, -4.300000000000001, -3.8000000000000007, -4.100000000000001, -3.9000000000000012, -4.000000000000001, -4.300000000000001, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -4.000000000000002, -4.300000000000001, -4.000000000000001, -4.000000000000002, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -3.9000000000000004, -4.000000000000001, -3.9000000000000004, -4.200000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -3.8000000000000007, -3.8000000000000007, -4.200000000000001, -3.900000000000001, -4.0, -4.000000000000001, -4.000000000000001, -4.200000000000001, -4.0, -4.000000000000001, -4.300000000000001, -4.300000000000001, -4.000000000000002, -4.200000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -3.8000000000000007, -3.900000000000001, -3.700000000000001, -3.9000000000000004, -3.9000000000000004, -4.0, -4.0, -3.900000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.6283923197591, "mean_inference_ms": 18.238446022858348, "mean_action_processing_ms": 0.9405113756288508, "mean_env_wait_ms": 1.551085461133991, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08207368109510353, "StateBufferConnector_ms": 0.010444957357614151, "ViewRequirementAgentConnector_ms": 0.15084076421866144}}, "episode_reward_max": -3.7000000000000006, "episode_reward_min": -10.1, "episode_reward_mean": -4.061139896373057, "episode_len_mean": 20.901554404145077, "episodes_this_iter": 193, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.100000000000001, -4.000000000000002, -4.200000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -4.200000000000001, -4.300000000000001, -4.1000000000000005, -4.100000000000001, -3.900000000000001, -4.1000000000000005, -3.900000000000001, -3.900000000000001, -10.1, -4.200000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.200000000000001, -3.9000000000000012, -4.100000000000001, -4.000000000000001, -4.1000000000000005, -4.200000000000001, -4.000000000000001, -4.000000000000002, -4.100000000000001, -4.200000000000001, -3.9000000000000012, -4.000000000000001, -4.200000000000001, -3.8000000000000007, -3.900000000000001, -3.9000000000000004, -4.200000000000001, -4.200000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.300000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -3.800000000000001, -4.300000000000001, -4.000000000000001, -4.100000000000001, -4.400000000000001, -3.900000000000001, -4.100000000000001, -3.9000000000000012, -4.000000000000001, -3.9000000000000012, -4.000000000000001, -4.400000000000001, -4.100000000000001, -3.9000000000000012, -4.000000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000002, -4.000000000000001, -4.100000000000001, -4.200000000000001, -4.200000000000001, -4.000000000000002, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000002, -4.200000000000001, -4.100000000000001, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -3.9000000000000012, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.9000000000000012, -3.800000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000002, -4.100000000000001, -4.000000000000001, -4.200000000000001, -3.9000000000000012, -4.100000000000001, -3.9000000000000012, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.400000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -4.500000000000002, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -4.100000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.1000000000000005, -4.100000000000001, -3.900000000000001, -3.800000000000001, -4.100000000000001, -3.8000000000000007, -4.300000000000001, -3.8000000000000007, -4.100000000000001, -3.9000000000000012, -4.000000000000001, -4.300000000000001, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -4.000000000000002, -4.300000000000001, -4.000000000000001, -4.000000000000002, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -3.9000000000000004, -4.000000000000001, -3.9000000000000004, -4.200000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -3.8000000000000007, -3.8000000000000007, -4.200000000000001, -3.900000000000001, -4.0, -4.000000000000001, -4.000000000000001, -4.200000000000001, -4.0, -4.000000000000001, -4.300000000000001, -4.300000000000001, -4.000000000000002, -4.200000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -3.8000000000000007, -3.900000000000001, -3.700000000000001, -3.9000000000000004, -3.9000000000000004, -4.0, -4.0, -3.900000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.6283923197591, "mean_inference_ms": 18.238446022858348, "mean_action_processing_ms": 0.9405113756288508, "mean_env_wait_ms": 1.551085461133991, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08207368109510353, "StateBufferConnector_ms": 0.010444957357614151, "ViewRequirementAgentConnector_ms": 0.15084076421866144}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000, "num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 608000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 608000, "timers": {"training_iteration_time_ms": 174823.387, "load_time_ms": 1.16, "load_throughput": 3448270.646, "learn_time_ms": 173828.656, "learn_throughput": 23.011, "synch_weights_time_ms": 180.503}, "counters": {"num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "done": false, "episodes_total": 30396, "training_iteration": 152, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_04-12-03", "timestamp": 1680833523, "time_this_iter_s": 175.1086127758026, "time_total_s": 26182.26012158394, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7effc0130d90>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff946cfee0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 26182.26012158394, "timesteps_since_restore": 0, "iterations_since_restore": 152, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.3538152610441765, "ram_util_percent": 23.828915662650605}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.552891049846526, "cur_kl_coeff": 182.4249745027684, "cur_lr": 0.01, "total_loss": 0.317049175003914, "policy_loss": 5.6206884603667e-05, "vf_loss": 0.29967271955583685, "vf_explained_var": 0.6693516956862583, "kl": 9.494450772108003e-05, "entropy": 2.6612827006206716, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 141825.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "sampler_results": {"episode_reward_max": -3.6000000000000005, "episode_reward_min": -11.8, "episode_reward_mean": -4.083684210526316, "episode_len_mean": 20.957894736842107, "episode_media": {}, "episodes_this_iter": 190, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.300000000000001, -4.100000000000001, -4.200000000000001, -4.200000000000001, -4.100000000000001, -4.200000000000001, -4.200000000000001, -3.700000000000001, -4.200000000000001, -4.200000000000001, -4.000000000000002, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.1000000000000005, -4.200000000000001, -4.200000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -3.800000000000001, -4.000000000000002, -4.100000000000001, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -4.100000000000001, -4.300000000000001, -3.9000000000000012, -4.000000000000002, -4.200000000000001, -4.300000000000001, -4.000000000000002, -4.000000000000001, -4.000000000000001, -4.200000000000001, -3.7000000000000006, -3.9000000000000012, -4.000000000000002, -4.200000000000001, -4.0, -4.0, -4.200000000000001, -3.900000000000001, -4.300000000000002, -4.300000000000001, -3.9000000000000012, -4.200000000000001, -4.200000000000001, -4.100000000000001, -3.8000000000000007, -4.300000000000002, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.200000000000001, -4.200000000000001, -3.9000000000000012, -4.200000000000001, -3.8000000000000007, -4.000000000000001, -4.300000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.200000000000001, -4.100000000000001, -4.300000000000001, -3.9000000000000012, -3.9000000000000012, -3.800000000000001, -4.000000000000002, -4.300000000000001, -4.200000000000001, -4.200000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000002, -4.200000000000001, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -4.200000000000001, -3.900000000000001, -4.300000000000001, -3.9000000000000012, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -4.300000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -4.300000000000001, -4.300000000000001, -4.300000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -4.300000000000001, -4.000000000000002, -4.200000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -3.9000000000000004, -3.9000000000000012, -4.200000000000001, -4.200000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000002, -4.200000000000001, -4.100000000000001, -4.000000000000001, -3.7000000000000006, -3.8000000000000007, -4.200000000000001, -3.900000000000001, -4.200000000000001, -3.9000000000000012, -3.8000000000000007, -4.200000000000001, -4.000000000000001, -4.100000000000001, -11.8, -4.100000000000001, -4.000000000000002, -4.200000000000001, -4.000000000000001, -4.300000000000001, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -4.100000000000001, -4.200000000000001, -4.000000000000002, -4.1000000000000005, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -3.6000000000000005, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000002, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.0, -3.900000000000001, -3.900000000000001, -4.200000000000001, -3.8000000000000007, -4.200000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.62228181893069, "mean_inference_ms": 18.24165408984632, "mean_action_processing_ms": 0.9414149735972076, "mean_env_wait_ms": 1.5485698959231735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07633623323942486, "StateBufferConnector_ms": 0.009777169478567023, "ViewRequirementAgentConnector_ms": 0.14057008843672902}}, "episode_reward_max": -3.6000000000000005, "episode_reward_min": -11.8, "episode_reward_mean": -4.083684210526316, "episode_len_mean": 20.957894736842107, "episodes_this_iter": 190, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.300000000000001, -4.100000000000001, -4.200000000000001, -4.200000000000001, -4.100000000000001, -4.200000000000001, -4.200000000000001, -3.700000000000001, -4.200000000000001, -4.200000000000001, -4.000000000000002, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.1000000000000005, -4.200000000000001, -4.200000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -3.800000000000001, -4.000000000000002, -4.100000000000001, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -4.100000000000001, -4.300000000000001, -3.9000000000000012, -4.000000000000002, -4.200000000000001, -4.300000000000001, -4.000000000000002, -4.000000000000001, -4.000000000000001, -4.200000000000001, -3.7000000000000006, -3.9000000000000012, -4.000000000000002, -4.200000000000001, -4.0, -4.0, -4.200000000000001, -3.900000000000001, -4.300000000000002, -4.300000000000001, -3.9000000000000012, -4.200000000000001, -4.200000000000001, -4.100000000000001, -3.8000000000000007, -4.300000000000002, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.200000000000001, -4.200000000000001, -3.9000000000000012, -4.200000000000001, -3.8000000000000007, -4.000000000000001, -4.300000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.200000000000001, -4.100000000000001, -4.300000000000001, -3.9000000000000012, -3.9000000000000012, -3.800000000000001, -4.000000000000002, -4.300000000000001, -4.200000000000001, -4.200000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000002, -4.200000000000001, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -4.200000000000001, -3.900000000000001, -4.300000000000001, -3.9000000000000012, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -4.300000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -4.300000000000001, -4.300000000000001, -4.300000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -4.300000000000001, -4.000000000000002, -4.200000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -3.9000000000000004, -3.9000000000000012, -4.200000000000001, -4.200000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000002, -4.200000000000001, -4.100000000000001, -4.000000000000001, -3.7000000000000006, -3.8000000000000007, -4.200000000000001, -3.900000000000001, -4.200000000000001, -3.9000000000000012, -3.8000000000000007, -4.200000000000001, -4.000000000000001, -4.100000000000001, -11.8, -4.100000000000001, -4.000000000000002, -4.200000000000001, -4.000000000000001, -4.300000000000001, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -4.100000000000001, -4.200000000000001, -4.000000000000002, -4.1000000000000005, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -3.6000000000000005, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000002, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.0, -3.900000000000001, -3.900000000000001, -4.200000000000001, -3.8000000000000007, -4.200000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 13, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.62228181893069, "mean_inference_ms": 18.24165408984632, "mean_action_processing_ms": 0.9414149735972076, "mean_env_wait_ms": 1.5485698959231735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07633623323942486, "StateBufferConnector_ms": 0.009777169478567023, "ViewRequirementAgentConnector_ms": 0.14057008843672902}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 612000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 612000, "timers": {"training_iteration_time_ms": 174885.152, "load_time_ms": 1.165, "load_throughput": 3433380.948, "learn_time_ms": 173882.673, "learn_throughput": 23.004, "synch_weights_time_ms": 179.893}, "counters": {"num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "done": false, "episodes_total": 30586, "training_iteration": 153, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_04-14-58", "timestamp": 1680833698, "time_this_iter_s": 175.33003973960876, "time_total_s": 26357.590161323547, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7eff946f6fa0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff94718280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 26357.590161323547, "timesteps_since_restore": 0, "iterations_since_restore": 153, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.296399999999999, "ram_util_percent": 23.8884}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.42420225925343, "cur_kl_coeff": 91.2124872513842, "cur_lr": 0.01, "total_loss": 0.32404742334613834, "policy_loss": -0.0014542498187692736, "vf_loss": 0.3238018267737922, "vf_explained_var": 0.7154145359352071, "kl": 1.8636125501890553e-05, "entropy": 2.6600263354598837, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 142755.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_agent_steps_sampled": 616000, "num_agent_steps_trained": 616000}, "sampler_results": {"episode_reward_max": -3.7, "episode_reward_min": -11.1, "episode_reward_mean": -4.1287179487179495, "episode_len_mean": 20.764102564102565, "episode_media": {}, "episodes_this_iter": 195, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.900000000000001, -4.200000000000001, -3.8000000000000007, -10.2, -4.200000000000001, -10.6, -4.100000000000001, -4.0, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -11.1, -4.200000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000001, -4.300000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -4.200000000000001, -3.900000000000001, -4.1000000000000005, -4.000000000000001, -4.300000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.300000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -4.000000000000002, -4.200000000000001, -4.000000000000001, -4.300000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -3.9000000000000004, -4.000000000000001, -4.100000000000001, -3.7000000000000006, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.200000000000001, -4.200000000000001, -3.8000000000000007, -4.000000000000002, -4.000000000000001, -4.200000000000001, -4.000000000000002, -4.000000000000001, -3.900000000000001, -4.1000000000000005, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.1000000000000005, -3.900000000000001, -4.200000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -4.300000000000001, -4.000000000000002, -4.000000000000002, -3.7000000000000006, -4.200000000000001, -4.400000000000001, -4.000000000000001, -3.9000000000000012, -4.100000000000001, -4.100000000000001, -3.900000000000001, -3.7, -3.900000000000001, -3.700000000000001, -4.200000000000001, -3.900000000000001, -4.200000000000001, -4.200000000000001, -4.0, -3.900000000000001, -4.1000000000000005, -4.000000000000001, -4.100000000000001, -4.1000000000000005, -4.200000000000001, -4.0, -4.0, -3.900000000000001, -3.9000000000000004, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.9000000000000012, -3.900000000000001, -4.000000000000002, -4.300000000000001, -4.100000000000001, -4.200000000000001, -4.200000000000001, -4.000000000000001, -4.200000000000001, -4.300000000000001, -3.900000000000001, -4.000000000000001, -4.200000000000001, -4.200000000000001, -4.000000000000002, -4.000000000000001, -4.200000000000001, -4.500000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -4.200000000000001, -3.800000000000001, -4.200000000000001, -3.800000000000001, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.300000000000001, -4.400000000000001, -4.000000000000001, -3.800000000000001, -4.200000000000001, -4.300000000000002, -4.300000000000002, -4.1000000000000005, -4.100000000000001, -4.100000000000001, -3.800000000000001, -4.0, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.800000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -4.1000000000000005, -4.1000000000000005, -3.8000000000000007, -3.900000000000001, -4.0, -3.8000000000000007, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -3.7000000000000006, -4.100000000000001, -3.900000000000001, -4.1000000000000005, -3.900000000000001], "episode_lengths": [21, 21, 21, 3, 21, 6, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.620267429106876, "mean_inference_ms": 18.226927603520018, "mean_action_processing_ms": 0.9401476884515447, "mean_env_wait_ms": 1.5477435810808273, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0734864748441256, "StateBufferConnector_ms": 0.009838373233110476, "ViewRequirementAgentConnector_ms": 0.1349336673051883}}, "episode_reward_max": -3.7, "episode_reward_min": -11.1, "episode_reward_mean": -4.1287179487179495, "episode_len_mean": 20.764102564102565, "episodes_this_iter": 195, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.900000000000001, -4.200000000000001, -3.8000000000000007, -10.2, -4.200000000000001, -10.6, -4.100000000000001, -4.0, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -11.1, -4.200000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000001, -4.300000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -4.200000000000001, -3.900000000000001, -4.1000000000000005, -4.000000000000001, -4.300000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.300000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -4.000000000000002, -4.200000000000001, -4.000000000000001, -4.300000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -3.9000000000000004, -4.000000000000001, -4.100000000000001, -3.7000000000000006, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.200000000000001, -4.200000000000001, -3.8000000000000007, -4.000000000000002, -4.000000000000001, -4.200000000000001, -4.000000000000002, -4.000000000000001, -3.900000000000001, -4.1000000000000005, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.1000000000000005, -3.900000000000001, -4.200000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -4.300000000000001, -4.000000000000002, -4.000000000000002, -3.7000000000000006, -4.200000000000001, -4.400000000000001, -4.000000000000001, -3.9000000000000012, -4.100000000000001, -4.100000000000001, -3.900000000000001, -3.7, -3.900000000000001, -3.700000000000001, -4.200000000000001, -3.900000000000001, -4.200000000000001, -4.200000000000001, -4.0, -3.900000000000001, -4.1000000000000005, -4.000000000000001, -4.100000000000001, -4.1000000000000005, -4.200000000000001, -4.0, -4.0, -3.900000000000001, -3.9000000000000004, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.9000000000000012, -3.900000000000001, -4.000000000000002, -4.300000000000001, -4.100000000000001, -4.200000000000001, -4.200000000000001, -4.000000000000001, -4.200000000000001, -4.300000000000001, -3.900000000000001, -4.000000000000001, -4.200000000000001, -4.200000000000001, -4.000000000000002, -4.000000000000001, -4.200000000000001, -4.500000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -4.200000000000001, -3.800000000000001, -4.200000000000001, -3.800000000000001, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.300000000000001, -4.400000000000001, -4.000000000000001, -3.800000000000001, -4.200000000000001, -4.300000000000002, -4.300000000000002, -4.1000000000000005, -4.100000000000001, -4.100000000000001, -3.800000000000001, -4.0, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.800000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -4.1000000000000005, -4.1000000000000005, -3.8000000000000007, -3.900000000000001, -4.0, -3.8000000000000007, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -3.7000000000000006, -4.100000000000001, -3.900000000000001, -4.1000000000000005, -3.900000000000001], "episode_lengths": [21, 21, 21, 3, 21, 6, 21, 21, 21, 21, 21, 21, 21, 8, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.620267429106876, "mean_inference_ms": 18.226927603520018, "mean_action_processing_ms": 0.9401476884515447, "mean_env_wait_ms": 1.5477435810808273, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0734864748441256, "StateBufferConnector_ms": 0.009838373233110476, "ViewRequirementAgentConnector_ms": 0.1349336673051883}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 616000, "num_agent_steps_trained": 616000, "num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 616000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 616000, "timers": {"training_iteration_time_ms": 174980.874, "load_time_ms": 1.161, "load_throughput": 3444023.484, "learn_time_ms": 173977.996, "learn_throughput": 22.991, "synch_weights_time_ms": 180.336}, "counters": {"num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_agent_steps_sampled": 616000, "num_agent_steps_trained": 616000}, "done": false, "episodes_total": 30781, "training_iteration": 154, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_04-17-53", "timestamp": 1680833873, "time_this_iter_s": 175.3687686920166, "time_total_s": 26532.958930015564, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476cb4f0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff946cfa60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 26532.958930015564, "timesteps_since_restore": 0, "iterations_since_restore": 154, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.572289156626506, "ram_util_percent": 23.896385542168673}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.16059895535951, "cur_kl_coeff": 45.6062436256921, "cur_lr": 0.01, "total_loss": 0.22929742271981893, "policy_loss": -0.0013787989915218404, "vf_loss": 0.2277580637444732, "vf_explained_var": 0.6757762586557737, "kl": 6.398592310565545e-05, "entropy": 2.660263445556805, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 143685.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 620000, "num_env_steps_trained": 620000, "num_agent_steps_sampled": 620000, "num_agent_steps_trained": 620000}, "sampler_results": {"episode_reward_max": -3.8000000000000007, "episode_reward_min": -10.3, "episode_reward_mean": -4.08770053475936, "episode_len_mean": 20.90909090909091, "episode_media": {}, "episodes_this_iter": 187, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.100000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -4.4, -4.300000000000001, -4.100000000000001, -4.200000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000002, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.200000000000001, -4.200000000000001, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.200000000000001, -4.200000000000001, -4.000000000000002, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -3.800000000000001, -3.9000000000000012, -4.4, -4.300000000000001, -4.300000000000001, -4.200000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -3.800000000000001, -4.000000000000001, -4.000000000000001, -4.1000000000000005, -4.000000000000002, -4.000000000000001, -3.900000000000001, -4.100000000000001, -3.9000000000000004, -3.900000000000001, -3.9000000000000012, -4.100000000000001, -3.900000000000001, -3.9000000000000012, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.9000000000000012, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000002, -4.300000000000001, -4.100000000000001, -3.900000000000001, -4.200000000000001, -4.300000000000001, -4.0, -3.800000000000001, -4.300000000000001, -4.200000000000001, -3.9000000000000012, -4.100000000000001, -3.900000000000001, -4.200000000000001, -4.100000000000001, -4.200000000000001, -4.500000000000002, -4.100000000000001, -4.1000000000000005, -4.100000000000001, -10.3, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -4.0, -4.200000000000001, -4.000000000000001, -3.900000000000001, -4.0, -4.000000000000001, -4.000000000000002, -3.9000000000000012, -4.000000000000001, -4.200000000000001, -4.100000000000001, -4.1000000000000005, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000002, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000002, -3.900000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -4.0, -4.000000000000001, -4.1000000000000005, -4.0, -3.900000000000001, -4.000000000000001, -4.300000000000001, -4.0, -3.800000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000002, -3.800000000000001, -4.200000000000001, -4.1000000000000005, -4.000000000000002, -4.000000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -4.200000000000001, -4.000000000000001, -3.800000000000001, -3.9000000000000012, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000002, -3.800000000000001, -4.200000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000002, -3.900000000000001, -4.300000000000001, -4.100000000000001, -4.000000000000002, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000002, -3.900000000000001, -4.000000000000001, -4.400000000000001, -4.100000000000001, -4.300000000000001, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -4.200000000000001, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -3.9000000000000004, -4.100000000000001, -4.100000000000001, -3.800000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.617889358011634, "mean_inference_ms": 18.241855367390716, "mean_action_processing_ms": 0.9404195118777503, "mean_env_wait_ms": 1.5482709238607226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07333207257928695, "StateBufferConnector_ms": 0.009195817345603902, "ViewRequirementAgentConnector_ms": 0.13532498303581686}}, "episode_reward_max": -3.8000000000000007, "episode_reward_min": -10.3, "episode_reward_mean": -4.08770053475936, "episode_len_mean": 20.90909090909091, "episodes_this_iter": 187, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.100000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -4.4, -4.300000000000001, -4.100000000000001, -4.200000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000002, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.200000000000001, -4.200000000000001, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.200000000000001, -4.200000000000001, -4.000000000000002, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -3.800000000000001, -3.9000000000000012, -4.4, -4.300000000000001, -4.300000000000001, -4.200000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -3.800000000000001, -4.000000000000001, -4.000000000000001, -4.1000000000000005, -4.000000000000002, -4.000000000000001, -3.900000000000001, -4.100000000000001, -3.9000000000000004, -3.900000000000001, -3.9000000000000012, -4.100000000000001, -3.900000000000001, -3.9000000000000012, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.9000000000000012, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000002, -4.300000000000001, -4.100000000000001, -3.900000000000001, -4.200000000000001, -4.300000000000001, -4.0, -3.800000000000001, -4.300000000000001, -4.200000000000001, -3.9000000000000012, -4.100000000000001, -3.900000000000001, -4.200000000000001, -4.100000000000001, -4.200000000000001, -4.500000000000002, -4.100000000000001, -4.1000000000000005, -4.100000000000001, -10.3, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -4.0, -4.200000000000001, -4.000000000000001, -3.900000000000001, -4.0, -4.000000000000001, -4.000000000000002, -3.9000000000000012, -4.000000000000001, -4.200000000000001, -4.100000000000001, -4.1000000000000005, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000002, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000002, -3.900000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -4.0, -4.000000000000001, -4.1000000000000005, -4.0, -3.900000000000001, -4.000000000000001, -4.300000000000001, -4.0, -3.800000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000002, -3.800000000000001, -4.200000000000001, -4.1000000000000005, -4.000000000000002, -4.000000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -4.200000000000001, -4.000000000000001, -3.800000000000001, -3.9000000000000012, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000002, -3.800000000000001, -4.200000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000002, -3.900000000000001, -4.300000000000001, -4.100000000000001, -4.000000000000002, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000002, -3.900000000000001, -4.000000000000001, -4.400000000000001, -4.100000000000001, -4.300000000000001, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -4.200000000000001, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -3.9000000000000004, -4.100000000000001, -4.100000000000001, -3.800000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.617889358011634, "mean_inference_ms": 18.241855367390716, "mean_action_processing_ms": 0.9404195118777503, "mean_env_wait_ms": 1.5482709238607226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07333207257928695, "StateBufferConnector_ms": 0.009195817345603902, "ViewRequirementAgentConnector_ms": 0.13532498303581686}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 620000, "num_agent_steps_trained": 620000, "num_env_steps_sampled": 620000, "num_env_steps_trained": 620000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 620000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 620000, "timers": {"training_iteration_time_ms": 175062.473, "load_time_ms": 1.161, "load_throughput": 3444730.618, "learn_time_ms": 174058.066, "learn_throughput": 22.981, "synch_weights_time_ms": 181.803}, "counters": {"num_env_steps_sampled": 620000, "num_env_steps_trained": 620000, "num_agent_steps_sampled": 620000, "num_agent_steps_trained": 620000}, "done": false, "episodes_total": 30968, "training_iteration": 155, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_04-20-48", "timestamp": 1680834048, "time_this_iter_s": 174.96389651298523, "time_total_s": 26707.92282652855, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01472fc910>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff946f7dc0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 26707.92282652855, "timesteps_since_restore": 0, "iterations_since_restore": 155, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.31847389558233, "ram_util_percent": 23.900401606425707}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.126870201351822, "cur_kl_coeff": 22.80312181284605, "cur_lr": 0.01, "total_loss": 0.28254502019494454, "policy_loss": 3.2273079118421003e-05, "vf_loss": 0.2771568680482526, "vf_explained_var": 0.6960616986597737, "kl": 0.00023487480341006424, "entropy": 2.6645204244121428, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 144615.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "sampler_results": {"episode_reward_max": -3.600000000000001, "episode_reward_min": -10.2, "episode_reward_mean": -4.054639175257733, "episode_len_mean": 20.90721649484536, "episode_media": {}, "episodes_this_iter": 194, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.000000000000001, -4.400000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.300000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000002, -4.0, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000002, -4.000000000000001, -3.800000000000001, -4.4, -4.200000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000002, -4.300000000000001, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -3.600000000000001, -4.0, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -3.9000000000000004, -4.100000000000001, -4.100000000000001, -3.7000000000000006, -4.400000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -4.0, -4.200000000000001, -4.000000000000001, -4.300000000000001, -4.200000000000001, -4.200000000000001, -4.100000000000001, -3.9000000000000012, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -4.000000000000001, -3.800000000000001, -4.000000000000002, -3.800000000000001, -4.200000000000001, -4.000000000000001, -4.300000000000001, -3.600000000000001, -3.9000000000000012, -3.800000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -3.9000000000000012, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.0, -4.200000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000002, -4.200000000000001, -4.100000000000001, -3.800000000000001, -4.0, -3.900000000000001, -3.700000000000001, -4.200000000000001, -10.2, -3.900000000000001, -4.200000000000001, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.200000000000001, -4.200000000000001, -4.000000000000001, -4.200000000000001, -4.500000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.0, -4.300000000000001, -4.100000000000001, -4.000000000000002, -4.000000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -4.100000000000001, -4.1000000000000005, -4.200000000000001, -4.200000000000001, -3.800000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.0, -4.000000000000001, -3.900000000000001, -4.300000000000001, -4.500000000000002, -3.900000000000001, -3.700000000000001, -3.900000000000001, -3.800000000000001, -3.9000000000000012, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -4.200000000000001, -3.7000000000000006, -4.000000000000002, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000002, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -4.300000000000001, -3.9000000000000004, -3.9000000000000012, -3.8000000000000007, -4.000000000000001, -3.9000000000000012, -4.200000000000001, -4.000000000000002, -4.000000000000001, -4.000000000000002, -3.900000000000001, -4.200000000000001, -3.8000000000000007, -4.200000000000001, -4.000000000000001, -4.000000000000002, -4.000000000000001, -4.200000000000001, -4.200000000000001, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -4.100000000000001, -3.800000000000001, -4.000000000000001, -4.100000000000001, -3.700000000000001, -3.8000000000000003, -3.700000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -4.200000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.615106263204478, "mean_inference_ms": 18.226339619397308, "mean_action_processing_ms": 0.9403881054544324, "mean_env_wait_ms": 1.5460648384355453, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0782377941092265, "StateBufferConnector_ms": 0.009634814311548607, "ViewRequirementAgentConnector_ms": 0.1430872789363271}}, "episode_reward_max": -3.600000000000001, "episode_reward_min": -10.2, "episode_reward_mean": -4.054639175257733, "episode_len_mean": 20.90721649484536, "episodes_this_iter": 194, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.000000000000001, -4.400000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.300000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000002, -4.0, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000002, -4.000000000000001, -3.800000000000001, -4.4, -4.200000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000002, -4.300000000000001, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -3.600000000000001, -4.0, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -3.9000000000000004, -4.100000000000001, -4.100000000000001, -3.7000000000000006, -4.400000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -4.0, -4.200000000000001, -4.000000000000001, -4.300000000000001, -4.200000000000001, -4.200000000000001, -4.100000000000001, -3.9000000000000012, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -4.000000000000001, -3.800000000000001, -4.000000000000002, -3.800000000000001, -4.200000000000001, -4.000000000000001, -4.300000000000001, -3.600000000000001, -3.9000000000000012, -3.800000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -3.9000000000000012, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.0, -4.200000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000002, -4.200000000000001, -4.100000000000001, -3.800000000000001, -4.0, -3.900000000000001, -3.700000000000001, -4.200000000000001, -10.2, -3.900000000000001, -4.200000000000001, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.200000000000001, -4.200000000000001, -4.000000000000001, -4.200000000000001, -4.500000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.0, -4.300000000000001, -4.100000000000001, -4.000000000000002, -4.000000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -4.100000000000001, -4.1000000000000005, -4.200000000000001, -4.200000000000001, -3.800000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.0, -4.000000000000001, -3.900000000000001, -4.300000000000001, -4.500000000000002, -3.900000000000001, -3.700000000000001, -3.900000000000001, -3.800000000000001, -3.9000000000000012, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -4.200000000000001, -3.7000000000000006, -4.000000000000002, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000002, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -4.300000000000001, -3.9000000000000004, -3.9000000000000012, -3.8000000000000007, -4.000000000000001, -3.9000000000000012, -4.200000000000001, -4.000000000000002, -4.000000000000001, -4.000000000000002, -3.900000000000001, -4.200000000000001, -3.8000000000000007, -4.200000000000001, -4.000000000000001, -4.000000000000002, -4.000000000000001, -4.200000000000001, -4.200000000000001, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -4.100000000000001, -3.800000000000001, -4.000000000000001, -4.100000000000001, -3.700000000000001, -3.8000000000000003, -3.700000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -4.200000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.615106263204478, "mean_inference_ms": 18.226339619397308, "mean_action_processing_ms": 0.9403881054544324, "mean_env_wait_ms": 1.5460648384355453, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0782377941092265, "StateBufferConnector_ms": 0.009634814311548607, "ViewRequirementAgentConnector_ms": 0.1430872789363271}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 624000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 175085.53, "load_time_ms": 1.159, "load_throughput": 3450752.998, "learn_time_ms": 174079.545, "learn_throughput": 22.978, "synch_weights_time_ms": 180.322}, "counters": {"num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "done": false, "episodes_total": 31162, "training_iteration": 156, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_04-23-43", "timestamp": 1680834223, "time_this_iter_s": 175.01741862297058, "time_total_s": 26882.94024515152, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7effc0130b80>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff94727e50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 26882.94024515152, "timesteps_since_restore": 0, "iterations_since_restore": 156, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.368273092369477, "ram_util_percent": 23.900000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.88320625353885, "cur_kl_coeff": 11.401560906423025, "cur_lr": 0.01, "total_loss": 0.23954592816261275, "policy_loss": -0.011074249431370727, "vf_loss": 0.24359488814908972, "vf_explained_var": 0.7422491732464042, "kl": 0.0006161690965855478, "entropy": 2.663623881596391, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 145545.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 628000, "num_env_steps_trained": 628000, "num_agent_steps_sampled": 628000, "num_agent_steps_trained": 628000}, "sampler_results": {"episode_reward_max": -3.6000000000000005, "episode_reward_min": -4.400000000000001, "episode_reward_mean": -4.026315789473686, "episode_len_mean": 21.0, "episode_media": {}, "episodes_this_iter": 190, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.8000000000000007, -4.200000000000001, -4.200000000000001, -4.000000000000001, -4.100000000000001, -3.7000000000000006, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -3.700000000000001, -3.700000000000001, -3.8000000000000007, -4.000000000000002, -4.000000000000001, -4.000000000000002, -4.200000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -4.300000000000001, -3.700000000000001, -4.300000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.1000000000000005, -3.800000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.800000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -3.700000000000001, -3.8000000000000003, -4.100000000000001, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -3.9000000000000012, -4.100000000000001, -4.200000000000001, -4.200000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000001, -4.400000000000001, -4.0, -3.9000000000000012, -4.100000000000001, -4.200000000000001, -4.000000000000001, -4.200000000000001, -3.8000000000000007, -4.100000000000001, -3.8000000000000007, -3.9000000000000004, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -4.200000000000001, -4.200000000000001, -4.200000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000001, -4.200000000000001, -4.300000000000001, -4.100000000000001, -4.000000000000002, -4.100000000000001, -3.900000000000001, -4.1000000000000005, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -3.700000000000001, -3.7000000000000006, -4.000000000000002, -3.900000000000001, -4.100000000000001, -4.100000000000001, -3.6000000000000005, -4.000000000000001, -4.100000000000001, -4.300000000000002, -3.7000000000000006, -4.100000000000001, -4.000000000000001, -4.200000000000001, -4.200000000000001, -4.200000000000001, -4.100000000000001, -4.0, -4.200000000000001, -4.000000000000001, -4.1000000000000005, -3.900000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -3.9000000000000012, -4.0, -4.200000000000001, -3.9000000000000012, -4.300000000000002, -4.400000000000001, -3.9000000000000004, -4.000000000000001, -4.100000000000001, -4.200000000000001, -4.300000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000001, -4.400000000000001, -3.7000000000000006, -3.800000000000001, -4.200000000000001, -4.200000000000001, -4.200000000000001, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000002, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -4.1000000000000005, -3.900000000000001, -4.000000000000002, -4.000000000000002, -3.900000000000001, -4.200000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -3.7000000000000006, -4.200000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -3.800000000000001, -3.800000000000001, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -4.000000000000001, -3.700000000000001, -4.000000000000002, -4.100000000000001, -3.9000000000000012, -3.900000000000001, -3.8000000000000007, -4.1000000000000005, -4.200000000000001, -3.900000000000001, -4.100000000000001, -3.600000000000001, -4.100000000000001, -3.9000000000000004, -4.100000000000001, -4.100000000000001, -4.300000000000001, -4.000000000000002, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.0, -3.900000000000001, -3.900000000000001, -3.6000000000000005, -4.100000000000001, -4.000000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.617566790381238, "mean_inference_ms": 18.229834609825172, "mean_action_processing_ms": 0.9401706147184719, "mean_env_wait_ms": 1.5436575434682889, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07423262847097296, "StateBufferConnector_ms": 0.009621068050986841, "ViewRequirementAgentConnector_ms": 0.13868658166182668}}, "episode_reward_max": -3.6000000000000005, "episode_reward_min": -4.400000000000001, "episode_reward_mean": -4.026315789473686, "episode_len_mean": 21.0, "episodes_this_iter": 190, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.8000000000000007, -4.200000000000001, -4.200000000000001, -4.000000000000001, -4.100000000000001, -3.7000000000000006, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -3.700000000000001, -3.700000000000001, -3.8000000000000007, -4.000000000000002, -4.000000000000001, -4.000000000000002, -4.200000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -4.300000000000001, -3.700000000000001, -4.300000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.1000000000000005, -3.800000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.800000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -3.700000000000001, -3.8000000000000003, -4.100000000000001, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -3.9000000000000012, -4.100000000000001, -4.200000000000001, -4.200000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000001, -4.400000000000001, -4.0, -3.9000000000000012, -4.100000000000001, -4.200000000000001, -4.000000000000001, -4.200000000000001, -3.8000000000000007, -4.100000000000001, -3.8000000000000007, -3.9000000000000004, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -4.200000000000001, -4.200000000000001, -4.200000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000001, -4.200000000000001, -4.300000000000001, -4.100000000000001, -4.000000000000002, -4.100000000000001, -3.900000000000001, -4.1000000000000005, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -3.700000000000001, -3.7000000000000006, -4.000000000000002, -3.900000000000001, -4.100000000000001, -4.100000000000001, -3.6000000000000005, -4.000000000000001, -4.100000000000001, -4.300000000000002, -3.7000000000000006, -4.100000000000001, -4.000000000000001, -4.200000000000001, -4.200000000000001, -4.200000000000001, -4.100000000000001, -4.0, -4.200000000000001, -4.000000000000001, -4.1000000000000005, -3.900000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -3.9000000000000012, -4.0, -4.200000000000001, -3.9000000000000012, -4.300000000000002, -4.400000000000001, -3.9000000000000004, -4.000000000000001, -4.100000000000001, -4.200000000000001, -4.300000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000001, -4.400000000000001, -3.7000000000000006, -3.800000000000001, -4.200000000000001, -4.200000000000001, -4.200000000000001, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000002, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -4.1000000000000005, -3.900000000000001, -4.000000000000002, -4.000000000000002, -3.900000000000001, -4.200000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -3.7000000000000006, -4.200000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -3.800000000000001, -3.800000000000001, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -4.000000000000001, -3.700000000000001, -4.000000000000002, -4.100000000000001, -3.9000000000000012, -3.900000000000001, -3.8000000000000007, -4.1000000000000005, -4.200000000000001, -3.900000000000001, -4.100000000000001, -3.600000000000001, -4.100000000000001, -3.9000000000000004, -4.100000000000001, -4.100000000000001, -4.300000000000001, -4.000000000000002, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.0, -3.900000000000001, -3.900000000000001, -3.6000000000000005, -4.100000000000001, -4.000000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.617566790381238, "mean_inference_ms": 18.229834609825172, "mean_action_processing_ms": 0.9401706147184719, "mean_env_wait_ms": 1.5436575434682889, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07423262847097296, "StateBufferConnector_ms": 0.009621068050986841, "ViewRequirementAgentConnector_ms": 0.13868658166182668}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 628000, "num_agent_steps_trained": 628000, "num_env_steps_sampled": 628000, "num_env_steps_trained": 628000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 628000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 628000, "timers": {"training_iteration_time_ms": 175076.6, "load_time_ms": 1.155, "load_throughput": 3462360.905, "learn_time_ms": 174071.134, "learn_throughput": 22.979, "synch_weights_time_ms": 179.503}, "counters": {"num_env_steps_sampled": 628000, "num_env_steps_trained": 628000, "num_agent_steps_sampled": 628000, "num_agent_steps_trained": 628000}, "done": false, "episodes_total": 31352, "training_iteration": 157, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_04-26-39", "timestamp": 1680834399, "time_this_iter_s": 175.14644265174866, "time_total_s": 27058.08668780327, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01475e2f10>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff946f7040>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 27058.08668780327, "timesteps_since_restore": 0, "iterations_since_restore": 157, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.528514056224899, "ram_util_percent": 23.895180722891563}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.3658818899303355, "cur_kl_coeff": 5.700780453211513, "cur_lr": 0.01, "total_loss": 0.2737344121310099, "policy_loss": -0.0021657900704491525, "vf_loss": 0.2646352828750687, "vf_explained_var": 0.702350607866882, "kl": 0.0019760311968463114, "entropy": 2.670496762183405, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 146475.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_agent_steps_sampled": 632000, "num_agent_steps_trained": 632000}, "sampler_results": {"episode_reward_max": -3.6000000000000005, "episode_reward_min": -10.2, "episode_reward_mean": -4.078534031413613, "episode_len_mean": 20.80628272251309, "episode_media": {}, "episodes_this_iter": 191, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.6000000000000005, -4.000000000000001, -4.200000000000001, -4.1000000000000005, -4.300000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.1000000000000005, -3.9000000000000012, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.6000000000000005, -4.000000000000001, -3.900000000000001, -10.1, -4.100000000000001, -4.300000000000001, -4.300000000000001, -4.100000000000001, -4.0, -4.200000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.300000000000001, -4.200000000000001, -4.200000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.700000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -3.800000000000001, -3.800000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.0, -4.100000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -3.9000000000000012, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.200000000000001, -4.200000000000001, -4.000000000000001, -4.300000000000001, -4.1000000000000005, -4.100000000000001, -4.000000000000001, -3.9000000000000004, -4.000000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000002, -4.000000000000001, -3.900000000000001, -4.0, -3.900000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000002, -4.1000000000000005, -4.200000000000001, -4.300000000000001, -4.200000000000001, -3.800000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.800000000000001, -10.2, -4.000000000000001, -3.8000000000000007, -3.9000000000000004, -3.900000000000001, -4.000000000000001, -3.9000000000000012, -4.100000000000001, -4.000000000000002, -4.100000000000001, -4.0, -4.000000000000002, -4.100000000000001, -4.100000000000001, -4.100000000000001, -3.800000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.0, -4.000000000000001, -4.000000000000002, -4.000000000000001, -4.200000000000001, -4.100000000000001, -4.200000000000001, -4.200000000000001, -3.9000000000000012, -4.200000000000001, -4.0, -4.000000000000001, -4.1000000000000005, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.600000000000001, -3.9000000000000004, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -3.800000000000001, -4.100000000000001, -4.300000000000001, -4.300000000000001, -4.200000000000001, -4.000000000000002, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -3.7000000000000006, -4.100000000000001, -4.000000000000002, -4.100000000000001, -3.8000000000000007, -4.200000000000001, -4.300000000000001, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -3.800000000000001, -4.000000000000001, -3.7000000000000006, -4.100000000000001, -4.000000000000001, -4.300000000000001, -3.6000000000000005, -4.000000000000001, -4.000000000000001, -3.800000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -4.200000000000001, -3.8000000000000007, -4.000000000000002, -4.200000000000001, -4.000000000000001, -3.9000000000000012, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -3.9000000000000012, -3.900000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.620777091364006, "mean_inference_ms": 18.235969016587397, "mean_action_processing_ms": 0.940171064308413, "mean_env_wait_ms": 1.5455162465488534, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07524939731777651, "StateBufferConnector_ms": 0.009587048235988117, "ViewRequirementAgentConnector_ms": 0.13711102969983485}}, "episode_reward_max": -3.6000000000000005, "episode_reward_min": -10.2, "episode_reward_mean": -4.078534031413613, "episode_len_mean": 20.80628272251309, "episodes_this_iter": 191, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.6000000000000005, -4.000000000000001, -4.200000000000001, -4.1000000000000005, -4.300000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.1000000000000005, -3.9000000000000012, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.6000000000000005, -4.000000000000001, -3.900000000000001, -10.1, -4.100000000000001, -4.300000000000001, -4.300000000000001, -4.100000000000001, -4.0, -4.200000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.300000000000001, -4.200000000000001, -4.200000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.700000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -3.800000000000001, -3.800000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.0, -4.100000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -3.9000000000000012, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.200000000000001, -4.200000000000001, -4.000000000000001, -4.300000000000001, -4.1000000000000005, -4.100000000000001, -4.000000000000001, -3.9000000000000004, -4.000000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000002, -4.000000000000001, -3.900000000000001, -4.0, -3.900000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000002, -4.1000000000000005, -4.200000000000001, -4.300000000000001, -4.200000000000001, -3.800000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.800000000000001, -10.2, -4.000000000000001, -3.8000000000000007, -3.9000000000000004, -3.900000000000001, -4.000000000000001, -3.9000000000000012, -4.100000000000001, -4.000000000000002, -4.100000000000001, -4.0, -4.000000000000002, -4.100000000000001, -4.100000000000001, -4.100000000000001, -3.800000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.0, -4.000000000000001, -4.000000000000002, -4.000000000000001, -4.200000000000001, -4.100000000000001, -4.200000000000001, -4.200000000000001, -3.9000000000000012, -4.200000000000001, -4.0, -4.000000000000001, -4.1000000000000005, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.600000000000001, -3.9000000000000004, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -3.800000000000001, -4.100000000000001, -4.300000000000001, -4.300000000000001, -4.200000000000001, -4.000000000000002, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -3.7000000000000006, -4.100000000000001, -4.000000000000002, -4.100000000000001, -3.8000000000000007, -4.200000000000001, -4.300000000000001, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -3.800000000000001, -4.000000000000001, -3.7000000000000006, -4.100000000000001, -4.000000000000001, -4.300000000000001, -3.6000000000000005, -4.000000000000001, -4.000000000000001, -3.800000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -4.200000000000001, -3.8000000000000007, -4.000000000000002, -4.200000000000001, -4.000000000000001, -3.9000000000000012, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -3.9000000000000012, -3.900000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.620777091364006, "mean_inference_ms": 18.235969016587397, "mean_action_processing_ms": 0.940171064308413, "mean_env_wait_ms": 1.5455162465488534, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07524939731777651, "StateBufferConnector_ms": 0.009587048235988117, "ViewRequirementAgentConnector_ms": 0.13711102969983485}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 632000, "num_agent_steps_trained": 632000, "num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 632000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 632000, "timers": {"training_iteration_time_ms": 175130.591, "load_time_ms": 1.177, "load_throughput": 3399018.619, "learn_time_ms": 174113.398, "learn_throughput": 22.974, "synch_weights_time_ms": 191.816}, "counters": {"num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_agent_steps_sampled": 632000, "num_agent_steps_trained": 632000}, "done": false, "episodes_total": 31543, "training_iteration": 158, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_04-29-34", "timestamp": 1680834574, "time_this_iter_s": 175.57758045196533, "time_total_s": 27233.664268255234, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01472fc130>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff947181f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 27233.664268255234, "timesteps_since_restore": 0, "iterations_since_restore": 158, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.2971887550200805, "ram_util_percent": 23.893574297188756}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.452796961287017, "cur_kl_coeff": 2.8503902266057564, "cur_lr": 0.01, "total_loss": 0.3371031972359345, "policy_loss": -0.004607920968524551, "vf_loss": 0.31561344874802455, "vf_explained_var": 0.7063287137016173, "kl": 0.009155823128680969, "entropy": 2.7077439836276476, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 147405.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000}, "sampler_results": {"episode_reward_max": -3.7000000000000006, "episode_reward_min": -10.7, "episode_reward_mean": -4.068586387434555, "episode_len_mean": 20.848167539267017, "episode_media": {}, "episodes_this_iter": 191, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.0, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.800000000000001, -4.000000000000001, -4.200000000000001, -4.300000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -4.1000000000000005, -4.200000000000001, -4.0, -4.200000000000001, -4.000000000000002, -4.200000000000001, -3.9000000000000012, -4.000000000000002, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.9000000000000017, -4.100000000000001, -4.0, -3.9000000000000012, -3.800000000000001, -3.9000000000000012, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.800000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000002, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -3.9000000000000004, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -3.9000000000000012, -4.000000000000002, -4.100000000000001, -4.100000000000001, -3.7000000000000006, -3.900000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000002, -4.000000000000001, -4.1000000000000005, -4.000000000000001, -3.9000000000000004, -3.900000000000001, -4.200000000000001, -4.200000000000001, -4.100000000000001, -4.200000000000001, -4.0, -4.200000000000001, -4.300000000000001, -3.800000000000001, -4.200000000000001, -3.8000000000000007, -3.9000000000000012, -4.100000000000001, -4.200000000000001, -3.900000000000001, -4.0, -3.900000000000001, -3.900000000000001, -4.1000000000000005, -4.000000000000001, -4.200000000000001, -4.0, -4.000000000000001, -3.8000000000000007, -3.9000000000000012, -10.7, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.300000000000001, -4.100000000000001, -4.100000000000001, -4.1000000000000005, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -3.9000000000000012, -3.700000000000001, -4.300000000000001, -4.0, -4.100000000000001, -4.000000000000002, -4.100000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000002, -4.1000000000000005, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -4.1000000000000005, -4.0, -4.200000000000001, -3.8000000000000007, -4.100000000000001, -3.800000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.9000000000000012, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.200000000000001, -3.8000000000000007, -4.0, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -4.0, -4.100000000000001, -3.900000000000001, -3.900000000000001, -10.7, -4.200000000000001, -3.8000000000000007, -4.100000000000001, -4.100000000000001, -4.100000000000001, -3.7000000000000006, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -3.8000000000000016, -4.100000000000001, -4.200000000000001, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000002, -4.000000000000001, -4.100000000000001, -4.000000000000002, -4.000000000000001, -4.200000000000001, -3.700000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -4.0, -3.700000000000001, -3.900000000000001, -3.9000000000000012, -3.800000000000001, -3.700000000000001, -3.9000000000000012, -3.8000000000000007, -3.9000000000000004, -4.000000000000001, -4.100000000000001, -3.9000000000000004, -3.900000000000001, -3.9000000000000004, -4.100000000000001, -3.700000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.617625831118506, "mean_inference_ms": 18.232985425665387, "mean_action_processing_ms": 0.9402783163367627, "mean_env_wait_ms": 1.541755108043379, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08026704738277415, "StateBufferConnector_ms": 0.010238392814915842, "ViewRequirementAgentConnector_ms": 0.14863825593319238}}, "episode_reward_max": -3.7000000000000006, "episode_reward_min": -10.7, "episode_reward_mean": -4.068586387434555, "episode_len_mean": 20.848167539267017, "episodes_this_iter": 191, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.0, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.800000000000001, -4.000000000000001, -4.200000000000001, -4.300000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -4.1000000000000005, -4.200000000000001, -4.0, -4.200000000000001, -4.000000000000002, -4.200000000000001, -3.9000000000000012, -4.000000000000002, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.9000000000000017, -4.100000000000001, -4.0, -3.9000000000000012, -3.800000000000001, -3.9000000000000012, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.800000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000002, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -3.9000000000000004, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -3.9000000000000012, -4.000000000000002, -4.100000000000001, -4.100000000000001, -3.7000000000000006, -3.900000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000002, -4.000000000000001, -4.1000000000000005, -4.000000000000001, -3.9000000000000004, -3.900000000000001, -4.200000000000001, -4.200000000000001, -4.100000000000001, -4.200000000000001, -4.0, -4.200000000000001, -4.300000000000001, -3.800000000000001, -4.200000000000001, -3.8000000000000007, -3.9000000000000012, -4.100000000000001, -4.200000000000001, -3.900000000000001, -4.0, -3.900000000000001, -3.900000000000001, -4.1000000000000005, -4.000000000000001, -4.200000000000001, -4.0, -4.000000000000001, -3.8000000000000007, -3.9000000000000012, -10.7, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.300000000000001, -4.100000000000001, -4.100000000000001, -4.1000000000000005, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -3.9000000000000012, -3.700000000000001, -4.300000000000001, -4.0, -4.100000000000001, -4.000000000000002, -4.100000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000002, -4.1000000000000005, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -4.1000000000000005, -4.0, -4.200000000000001, -3.8000000000000007, -4.100000000000001, -3.800000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.9000000000000012, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.200000000000001, -3.8000000000000007, -4.0, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -4.0, -4.100000000000001, -3.900000000000001, -3.900000000000001, -10.7, -4.200000000000001, -3.8000000000000007, -4.100000000000001, -4.100000000000001, -4.100000000000001, -3.7000000000000006, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -3.8000000000000016, -4.100000000000001, -4.200000000000001, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000002, -4.000000000000001, -4.100000000000001, -4.000000000000002, -4.000000000000001, -4.200000000000001, -3.700000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -4.0, -3.700000000000001, -3.900000000000001, -3.9000000000000012, -3.800000000000001, -3.700000000000001, -3.9000000000000012, -3.8000000000000007, -3.9000000000000004, -4.000000000000001, -4.100000000000001, -3.9000000000000004, -3.900000000000001, -3.9000000000000004, -4.100000000000001, -3.700000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 6, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.617625831118506, "mean_inference_ms": 18.232985425665387, "mean_action_processing_ms": 0.9402783163367627, "mean_env_wait_ms": 1.541755108043379, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08026704738277415, "StateBufferConnector_ms": 0.010238392814915842, "ViewRequirementAgentConnector_ms": 0.14863825593319238}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 636000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 636000, "timers": {"training_iteration_time_ms": 175132.355, "load_time_ms": 1.187, "load_throughput": 3368513.031, "learn_time_ms": 174122.082, "learn_throughput": 22.972, "synch_weights_time_ms": 190.823}, "counters": {"num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000}, "done": false, "episodes_total": 31734, "training_iteration": 159, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_04-32-29", "timestamp": 1680834749, "time_this_iter_s": 174.84892749786377, "time_total_s": 27408.513195753098, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0147659160>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff946f71f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 27408.513195753098, "timesteps_since_restore": 0, "iterations_since_restore": 159, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.387951807228915, "ram_util_percent": 23.863453815261042}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.183352024580843, "cur_kl_coeff": 2.8503902266057564, "cur_lr": 0.01, "total_loss": 0.42659842019840594, "policy_loss": -0.0013083045210649249, "vf_loss": 0.4018097354119183, "vf_explained_var": 0.7204837232507685, "kl": 0.009155585053276712, "entropy": 2.719806888026576, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 148335.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "sampler_results": {"episode_reward_max": -3.7, "episode_reward_min": -4.300000000000001, "episode_reward_mean": -4.000529100529101, "episode_len_mean": 21.0, "episode_media": {}, "episodes_this_iter": 189, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.100000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.200000000000001, -4.200000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.7000000000000006, -4.100000000000001, -4.1000000000000005, -4.0, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.9000000000000004, -4.100000000000001, -4.100000000000001, -3.800000000000001, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -4.1000000000000005, -4.300000000000001, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -4.100000000000001, -3.8000000000000007, -4.0, -4.0, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.800000000000001, -3.8000000000000007, -4.000000000000001, -4.0, -3.900000000000001, -3.9000000000000004, -4.100000000000001, -3.7000000000000006, -3.800000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -3.9000000000000012, -4.100000000000001, -3.800000000000001, -3.900000000000001, -4.1000000000000005, -4.100000000000001, -3.8000000000000007, -4.200000000000001, -4.200000000000001, -4.200000000000001, -4.200000000000001, -4.000000000000002, -4.000000000000001, -4.100000000000001, -3.9000000000000012, -4.000000000000002, -4.200000000000001, -4.300000000000001, -4.100000000000001, -4.300000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -4.000000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -3.9000000000000012, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -3.9000000000000004, -4.000000000000002, -3.900000000000001, -3.8000000000000003, -3.7000000000000006, -3.900000000000001, -3.9000000000000012, -3.7, -3.900000000000001, -4.000000000000001, -4.300000000000001, -4.300000000000001, -3.800000000000001, -4.0, -3.900000000000001, -4.0, -4.1000000000000005, -4.200000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000002, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.200000000000001, -4.1000000000000005, -4.000000000000002, -4.200000000000001, -3.8000000000000003, -4.1000000000000005, -4.0, -3.9000000000000012, -3.7000000000000006, -4.100000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.200000000000001, -3.9000000000000004, -4.300000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.300000000000001, -3.9000000000000012, -4.200000000000001, -4.1000000000000005, -4.100000000000001, -4.200000000000001, -4.200000000000001, -3.8000000000000003, -3.8000000000000007, -4.000000000000001, -4.0, -4.200000000000001, -3.7000000000000006, -4.0, -4.200000000000001, -3.8000000000000007, -4.000000000000002, -3.9000000000000012, -3.800000000000001, -3.9000000000000012, -3.700000000000001, -4.300000000000001, -4.000000000000001, -4.000000000000002, -3.8000000000000007, -4.200000000000001, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.9000000000000004, -4.000000000000001, -3.8000000000000007, -3.700000000000001, -4.1000000000000005, -4.100000000000001, -4.200000000000001, -4.000000000000001, -3.9000000000000004, -3.9000000000000004, -4.200000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -4.0, -4.000000000000001, -4.0], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.616474343623349, "mean_inference_ms": 18.229839845291643, "mean_action_processing_ms": 0.9406235560395815, "mean_env_wait_ms": 1.5429464799126387, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07345361053628266, "StateBufferConnector_ms": 0.009359884514379753, "ViewRequirementAgentConnector_ms": 0.13674806665491174}}, "episode_reward_max": -3.7, "episode_reward_min": -4.300000000000001, "episode_reward_mean": -4.000529100529101, "episode_len_mean": 21.0, "episodes_this_iter": 189, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.100000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.200000000000001, -4.200000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.7000000000000006, -4.100000000000001, -4.1000000000000005, -4.0, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.9000000000000004, -4.100000000000001, -4.100000000000001, -3.800000000000001, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -4.1000000000000005, -4.300000000000001, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -4.100000000000001, -3.8000000000000007, -4.0, -4.0, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.800000000000001, -3.8000000000000007, -4.000000000000001, -4.0, -3.900000000000001, -3.9000000000000004, -4.100000000000001, -3.7000000000000006, -3.800000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -3.9000000000000012, -4.100000000000001, -3.800000000000001, -3.900000000000001, -4.1000000000000005, -4.100000000000001, -3.8000000000000007, -4.200000000000001, -4.200000000000001, -4.200000000000001, -4.200000000000001, -4.000000000000002, -4.000000000000001, -4.100000000000001, -3.9000000000000012, -4.000000000000002, -4.200000000000001, -4.300000000000001, -4.100000000000001, -4.300000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -4.000000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -3.9000000000000012, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -3.9000000000000004, -4.000000000000002, -3.900000000000001, -3.8000000000000003, -3.7000000000000006, -3.900000000000001, -3.9000000000000012, -3.7, -3.900000000000001, -4.000000000000001, -4.300000000000001, -4.300000000000001, -3.800000000000001, -4.0, -3.900000000000001, -4.0, -4.1000000000000005, -4.200000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000002, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.200000000000001, -4.1000000000000005, -4.000000000000002, -4.200000000000001, -3.8000000000000003, -4.1000000000000005, -4.0, -3.9000000000000012, -3.7000000000000006, -4.100000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.200000000000001, -3.9000000000000004, -4.300000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.300000000000001, -3.9000000000000012, -4.200000000000001, -4.1000000000000005, -4.100000000000001, -4.200000000000001, -4.200000000000001, -3.8000000000000003, -3.8000000000000007, -4.000000000000001, -4.0, -4.200000000000001, -3.7000000000000006, -4.0, -4.200000000000001, -3.8000000000000007, -4.000000000000002, -3.9000000000000012, -3.800000000000001, -3.9000000000000012, -3.700000000000001, -4.300000000000001, -4.000000000000001, -4.000000000000002, -3.8000000000000007, -4.200000000000001, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.9000000000000004, -4.000000000000001, -3.8000000000000007, -3.700000000000001, -4.1000000000000005, -4.100000000000001, -4.200000000000001, -4.000000000000001, -3.9000000000000004, -3.9000000000000004, -4.200000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -4.0, -4.000000000000001, -4.0], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.616474343623349, "mean_inference_ms": 18.229839845291643, "mean_action_processing_ms": 0.9406235560395815, "mean_env_wait_ms": 1.5429464799126387, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07345361053628266, "StateBufferConnector_ms": 0.009359884514379753, "ViewRequirementAgentConnector_ms": 0.13674806665491174}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000, "num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 640000, "timers": {"training_iteration_time_ms": 175137.691, "load_time_ms": 1.195, "load_throughput": 3346875.199, "learn_time_ms": 174159.245, "learn_throughput": 22.967, "synch_weights_time_ms": 191.85}, "counters": {"num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "done": false, "episodes_total": 31923, "training_iteration": 160, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_04-35-25", "timestamp": 1680834925, "time_this_iter_s": 175.49833273887634, "time_total_s": 27584.011528491974, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476d7a30>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff946ed9d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 27584.011528491974, "timesteps_since_restore": 0, "iterations_since_restore": 160, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.518473895582329, "ram_util_percent": 23.88032128514056}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.6904417519928305, "cur_kl_coeff": 2.8503902266057564, "cur_lr": 0.01, "total_loss": 0.310436587163838, "policy_loss": -0.002458040470254898, "vf_loss": 0.29254047373930614, "vf_explained_var": 0.6498821103444663, "kl": 0.007140831111164223, "entropy": 2.747279433537555, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 149265.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_agent_steps_sampled": 644000, "num_agent_steps_trained": 644000}, "sampler_results": {"episode_reward_max": 99.4, "episode_reward_min": -10.3, "episode_reward_mean": -3.515104166666667, "episode_len_mean": 20.734375, "episode_media": {}, "episodes_this_iter": 192, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.000000000000002, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -3.9000000000000012, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.400000000000001, -3.8000000000000007, -3.9000000000000012, -4.200000000000001, -3.900000000000001, -3.7000000000000006, -4.0, -10.1, -4.300000000000001, -10.3, -4.000000000000001, -3.900000000000001, -4.000000000000002, -4.200000000000001, -4.100000000000001, -3.5000000000000004, -4.100000000000001, -4.000000000000002, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.800000000000001, -4.000000000000001, -3.900000000000001, -4.200000000000001, -4.200000000000001, -3.800000000000001, -4.000000000000002, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.1000000000000005, -3.700000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -3.7000000000000006, -4.100000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -4.100000000000001, -3.700000000000001, -3.900000000000001, -3.800000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -3.9000000000000004, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.800000000000001, -4.100000000000001, -3.8000000000000003, -4.000000000000002, -4.200000000000001, -4.000000000000001, -4.200000000000001, -4.200000000000001, -3.900000000000001, -4.300000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000002, -3.8000000000000007, -4.0, -4.1000000000000005, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -3.700000000000001, -4.000000000000001, -4.300000000000001, -4.200000000000001, -4.100000000000001, -4.200000000000001, -4.1000000000000005, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.0, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.9000000000000012, -4.0, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000001, -4.200000000000001, -3.900000000000001, -4.200000000000001, -4.100000000000001, -3.9000000000000004, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.0, -3.8000000000000003, -3.800000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.300000000000001, -3.8000000000000007, -4.300000000000001, -3.9000000000000012, 99.4, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -4.1000000000000005, -4.300000000000001, -4.000000000000002, -4.100000000000001, -3.9000000000000004, -4.000000000000001, -3.8000000000000007, -4.200000000000001, -4.000000000000002, -3.900000000000001, -4.1000000000000005, -3.7000000000000006, -3.700000000000001, -3.900000000000001, -3.9000000000000004, -4.100000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000002, -4.000000000000001, -3.800000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.6000000000000005, -3.8000000000000003, -3.9000000000000012, -3.900000000000001, -4.1000000000000005], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.620755594101528, "mean_inference_ms": 18.238483025928247, "mean_action_processing_ms": 0.940401680728213, "mean_env_wait_ms": 1.5434619294897587, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07734795411427815, "StateBufferConnector_ms": 0.009817754228909811, "ViewRequirementAgentConnector_ms": 0.14123705526192984}}, "episode_reward_max": 99.4, "episode_reward_min": -10.3, "episode_reward_mean": -3.515104166666667, "episode_len_mean": 20.734375, "episodes_this_iter": 192, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.000000000000002, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -3.9000000000000012, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.400000000000001, -3.8000000000000007, -3.9000000000000012, -4.200000000000001, -3.900000000000001, -3.7000000000000006, -4.0, -10.1, -4.300000000000001, -10.3, -4.000000000000001, -3.900000000000001, -4.000000000000002, -4.200000000000001, -4.100000000000001, -3.5000000000000004, -4.100000000000001, -4.000000000000002, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.800000000000001, -4.000000000000001, -3.900000000000001, -4.200000000000001, -4.200000000000001, -3.800000000000001, -4.000000000000002, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.1000000000000005, -3.700000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -3.7000000000000006, -4.100000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -4.100000000000001, -3.700000000000001, -3.900000000000001, -3.800000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -3.9000000000000004, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.800000000000001, -4.100000000000001, -3.8000000000000003, -4.000000000000002, -4.200000000000001, -4.000000000000001, -4.200000000000001, -4.200000000000001, -3.900000000000001, -4.300000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000002, -3.8000000000000007, -4.0, -4.1000000000000005, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -3.700000000000001, -4.000000000000001, -4.300000000000001, -4.200000000000001, -4.100000000000001, -4.200000000000001, -4.1000000000000005, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.0, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.9000000000000012, -4.0, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000001, -4.200000000000001, -3.900000000000001, -4.200000000000001, -4.100000000000001, -3.9000000000000004, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.0, -3.8000000000000003, -3.800000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.300000000000001, -3.8000000000000007, -4.300000000000001, -3.9000000000000012, 99.4, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -4.1000000000000005, -4.300000000000001, -4.000000000000002, -4.100000000000001, -3.9000000000000004, -4.000000000000001, -3.8000000000000007, -4.200000000000001, -4.000000000000002, -3.900000000000001, -4.1000000000000005, -3.7000000000000006, -3.700000000000001, -3.900000000000001, -3.9000000000000004, -4.100000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000002, -4.000000000000001, -3.800000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.6000000000000005, -3.8000000000000003, -3.9000000000000012, -3.900000000000001, -4.1000000000000005], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.620755594101528, "mean_inference_ms": 18.238483025928247, "mean_action_processing_ms": 0.940401680728213, "mean_env_wait_ms": 1.5434619294897587, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07734795411427815, "StateBufferConnector_ms": 0.009817754228909811, "ViewRequirementAgentConnector_ms": 0.14123705526192984}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 644000, "num_agent_steps_trained": 644000, "num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 644000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 644000, "timers": {"training_iteration_time_ms": 175165.422, "load_time_ms": 1.219, "load_throughput": 3280067.254, "learn_time_ms": 174181.07, "learn_throughput": 22.965, "synch_weights_time_ms": 194.137}, "counters": {"num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_agent_steps_sampled": 644000, "num_agent_steps_trained": 644000}, "done": false, "episodes_total": 32115, "training_iteration": 161, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_04-38-20", "timestamp": 1680835100, "time_this_iter_s": 174.90789461135864, "time_total_s": 27758.919423103333, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01473e24f0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff946d0280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 27758.919423103333, "timesteps_since_restore": 0, "iterations_since_restore": 161, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.3297188755020075, "ram_util_percent": 23.895582329317268}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.37928534361624, "cur_kl_coeff": 2.8503902266057564, "cur_lr": 0.01, "total_loss": 0.32918578746217875, "policy_loss": 0.0001886437236461588, "vf_loss": 0.28010195311839864, "vf_explained_var": 0.7129630249033692, "kl": 0.01715385827448054, "entropy": 2.753069523842104, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 150195.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "sampler_results": {"episode_reward_max": -3.600000000000001, "episode_reward_min": -10.2, "episode_reward_mean": -4.046907216494846, "episode_len_mean": 20.809278350515463, "episode_media": {}, "episodes_this_iter": 194, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.900000000000001, -4.200000000000001, -4.000000000000001, -4.1000000000000005, -4.100000000000001, -4.0, -3.700000000000001, -3.9000000000000012, -4.000000000000001, -3.8000000000000007, -3.7000000000000006, -10.2, -4.100000000000001, -3.8000000000000007, -4.000000000000002, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -3.9000000000000004, -3.700000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.200000000000001, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -4.100000000000001, -3.7000000000000006, -4.200000000000001, -4.0, -3.8000000000000007, -4.000000000000002, -3.900000000000001, -3.800000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -4.300000000000001, -3.8000000000000007, -3.900000000000001, -4.0, -4.300000000000001, -4.100000000000001, -3.9000000000000004, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -4.300000000000001, -4.100000000000001, -3.9000000000000012, -4.000000000000002, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000002, -4.000000000000001, -4.200000000000001, -4.000000000000001, -4.500000000000002, -4.200000000000001, -3.9000000000000012, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.1000000000000005, -4.100000000000001, -4.0, -3.700000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.1000000000000005, -4.200000000000001, -4.300000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -3.8000000000000003, -3.600000000000001, -10.1, -3.600000000000001, -4.100000000000001, -4.300000000000001, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.9000000000000012, -3.800000000000001, -3.800000000000001, -4.100000000000001, -4.000000000000002, -4.0, -4.200000000000001, -4.100000000000001, -4.200000000000001, -3.900000000000001, -4.1000000000000005, -4.100000000000001, -3.900000000000001, -4.0, -4.100000000000001, -4.1000000000000005, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -4.0, -4.000000000000001, -3.600000000000001, -4.000000000000001, -4.400000000000001, -3.700000000000001, -4.100000000000001, -4.000000000000002, -3.9000000000000012, -4.200000000000001, -4.000000000000001, -3.8000000000000007, -3.9000000000000012, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.8000000000000003, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.0, -3.9000000000000012, -4.100000000000001, -3.900000000000001, -4.200000000000001, -4.200000000000001, -4.200000000000001, -3.9000000000000004, -4.100000000000001, -4.000000000000002, -4.100000000000001, -4.200000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.700000000000001, -3.8000000000000003, -3.7000000000000006, -3.800000000000001, -3.7000000000000006, -4.000000000000001, -3.900000000000001, -4.1000000000000005, -3.8000000000000007, -3.800000000000001, -3.8000000000000007, -3.8000000000000007, -4.200000000000001, -3.900000000000001, -4.300000000000001, -4.200000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.9000000000000004, -4.000000000000002, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -4.200000000000001, -4.100000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.618279258116516, "mean_inference_ms": 18.22845992707939, "mean_action_processing_ms": 0.9399114255745861, "mean_env_wait_ms": 1.5399903197884863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07714905689672097, "StateBufferConnector_ms": 0.0099067835463691, "ViewRequirementAgentConnector_ms": 0.14122872008490808}}, "episode_reward_max": -3.600000000000001, "episode_reward_min": -10.2, "episode_reward_mean": -4.046907216494846, "episode_len_mean": 20.809278350515463, "episodes_this_iter": 194, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.900000000000001, -4.200000000000001, -4.000000000000001, -4.1000000000000005, -4.100000000000001, -4.0, -3.700000000000001, -3.9000000000000012, -4.000000000000001, -3.8000000000000007, -3.7000000000000006, -10.2, -4.100000000000001, -3.8000000000000007, -4.000000000000002, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -3.9000000000000004, -3.700000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.200000000000001, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -4.100000000000001, -3.7000000000000006, -4.200000000000001, -4.0, -3.8000000000000007, -4.000000000000002, -3.900000000000001, -3.800000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -4.300000000000001, -3.8000000000000007, -3.900000000000001, -4.0, -4.300000000000001, -4.100000000000001, -3.9000000000000004, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -4.300000000000001, -4.100000000000001, -3.9000000000000012, -4.000000000000002, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000002, -4.000000000000001, -4.200000000000001, -4.000000000000001, -4.500000000000002, -4.200000000000001, -3.9000000000000012, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.1000000000000005, -4.100000000000001, -4.0, -3.700000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.1000000000000005, -4.200000000000001, -4.300000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -3.8000000000000003, -3.600000000000001, -10.1, -3.600000000000001, -4.100000000000001, -4.300000000000001, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.9000000000000012, -3.800000000000001, -3.800000000000001, -4.100000000000001, -4.000000000000002, -4.0, -4.200000000000001, -4.100000000000001, -4.200000000000001, -3.900000000000001, -4.1000000000000005, -4.100000000000001, -3.900000000000001, -4.0, -4.100000000000001, -4.1000000000000005, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -4.0, -4.000000000000001, -3.600000000000001, -4.000000000000001, -4.400000000000001, -3.700000000000001, -4.100000000000001, -4.000000000000002, -3.9000000000000012, -4.200000000000001, -4.000000000000001, -3.8000000000000007, -3.9000000000000012, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.8000000000000003, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.0, -3.9000000000000012, -4.100000000000001, -3.900000000000001, -4.200000000000001, -4.200000000000001, -4.200000000000001, -3.9000000000000004, -4.100000000000001, -4.000000000000002, -4.100000000000001, -4.200000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.700000000000001, -3.8000000000000003, -3.7000000000000006, -3.800000000000001, -3.7000000000000006, -4.000000000000001, -3.900000000000001, -4.1000000000000005, -3.8000000000000007, -3.800000000000001, -3.8000000000000007, -3.8000000000000007, -4.200000000000001, -3.900000000000001, -4.300000000000001, -4.200000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.9000000000000004, -4.000000000000002, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -4.200000000000001, -4.100000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.618279258116516, "mean_inference_ms": 18.22845992707939, "mean_action_processing_ms": 0.9399114255745861, "mean_env_wait_ms": 1.5399903197884863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07714905689672097, "StateBufferConnector_ms": 0.0099067835463691, "ViewRequirementAgentConnector_ms": 0.14122872008490808}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 648000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 648000, "timers": {"training_iteration_time_ms": 175229.948, "load_time_ms": 1.248, "load_throughput": 3206348.017, "learn_time_ms": 174248.066, "learn_throughput": 22.956, "synch_weights_time_ms": 193.763}, "counters": {"num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "done": false, "episodes_total": 32309, "training_iteration": 162, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_04-41-16", "timestamp": 1680835276, "time_this_iter_s": 175.75514793395996, "time_total_s": 27934.674571037292, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7effc0123430>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff9463b160>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 27934.674571037292, "timesteps_since_restore": 0, "iterations_since_restore": 162, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.3812, "ram_util_percent": 23.8936}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.42332650435868, "cur_kl_coeff": 2.8503902266057564, "cur_lr": 0.01, "total_loss": 0.3951584693404936, "policy_loss": 0.0064608078397389865, "vf_loss": 0.311461370622599, "vf_explained_var": 0.6894236262126635, "kl": 0.027096743526948637, "entropy": 2.7548542609778783, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 151125.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 652000, "num_env_steps_trained": 652000, "num_agent_steps_sampled": 652000, "num_agent_steps_trained": 652000}, "sampler_results": {"episode_reward_max": -3.6000000000000005, "episode_reward_min": -10.5, "episode_reward_mean": -4.0062500000000005, "episode_len_mean": 20.916666666666668, "episode_media": {}, "episodes_this_iter": 192, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.8000000000000007, -4.200000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -4.400000000000001, -3.600000000000001, -3.800000000000001, -4.000000000000001, -4.000000000000001, -4.0, -4.000000000000001, -4.000000000000002, -3.9000000000000012, -10.5, -4.1000000000000005, -3.8000000000000003, -4.100000000000001, -4.000000000000001, -3.800000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.9000000000000012, -3.900000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.600000000000001, -3.700000000000001, -4.200000000000001, -3.7000000000000006, -4.300000000000001, -3.8000000000000003, -3.7000000000000006, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.800000000000001, -4.200000000000001, -3.600000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.6000000000000005, -3.900000000000001, -4.100000000000001, -4.1000000000000005, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -4.200000000000001, -3.8000000000000007, -4.200000000000001, -3.900000000000001, -4.000000000000001, -4.1000000000000005, -4.300000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000002, -4.000000000000001, -3.9000000000000012, -4.100000000000001, -4.200000000000001, -4.100000000000001, -3.900000000000001, -4.200000000000001, -3.7000000000000006, -4.200000000000001, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.300000000000001, -4.300000000000001, -3.9000000000000012, -3.700000000000001, -3.9000000000000012, -3.9000000000000004, -3.700000000000001, -3.700000000000001, -3.7, -4.000000000000002, -3.8000000000000007, -4.000000000000001, -3.7000000000000006, -3.900000000000001, -4.000000000000002, -4.000000000000001, -3.9000000000000012, -4.000000000000001, -4.200000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -4.1000000000000005, -4.100000000000001, -3.700000000000001, -4.000000000000001, -4.1000000000000005, -3.900000000000001, -3.6000000000000005, -4.200000000000001, -3.800000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000002, -4.0, -4.100000000000001, -4.0, -4.000000000000002, -3.9000000000000012, -4.000000000000002, -3.9000000000000012, -4.200000000000001, -3.800000000000001, -4.200000000000001, -3.8000000000000007, -4.000000000000001, -4.0, -4.000000000000002, -4.1000000000000005, -4.000000000000002, -4.100000000000001, -4.100000000000001, -3.7000000000000006, -3.8000000000000007, -4.200000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -3.9000000000000012, -4.600000000000001, -4.200000000000001, -4.200000000000001, -4.200000000000001, -4.200000000000001, -4.200000000000001, -3.900000000000001, -4.000000000000001, -3.9000000000000012, -4.200000000000001, -4.000000000000001, -3.9000000000000012, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.9000000000000012, -3.8000000000000007, -3.9000000000000012, -4.000000000000002, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -3.600000000000001, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000002, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -4.000000000000002], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.62016119721671, "mean_inference_ms": 18.24154331823208, "mean_action_processing_ms": 0.9403550746243972, "mean_env_wait_ms": 1.5392285866580417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07865863541762035, "StateBufferConnector_ms": 0.010064120093981424, "ViewRequirementAgentConnector_ms": 0.14540143311023712}}, "episode_reward_max": -3.6000000000000005, "episode_reward_min": -10.5, "episode_reward_mean": -4.0062500000000005, "episode_len_mean": 20.916666666666668, "episodes_this_iter": 192, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.8000000000000007, -4.200000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -4.400000000000001, -3.600000000000001, -3.800000000000001, -4.000000000000001, -4.000000000000001, -4.0, -4.000000000000001, -4.000000000000002, -3.9000000000000012, -10.5, -4.1000000000000005, -3.8000000000000003, -4.100000000000001, -4.000000000000001, -3.800000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.9000000000000012, -3.900000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.600000000000001, -3.700000000000001, -4.200000000000001, -3.7000000000000006, -4.300000000000001, -3.8000000000000003, -3.7000000000000006, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.800000000000001, -4.200000000000001, -3.600000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.6000000000000005, -3.900000000000001, -4.100000000000001, -4.1000000000000005, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -4.200000000000001, -3.8000000000000007, -4.200000000000001, -3.900000000000001, -4.000000000000001, -4.1000000000000005, -4.300000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000002, -4.000000000000001, -3.9000000000000012, -4.100000000000001, -4.200000000000001, -4.100000000000001, -3.900000000000001, -4.200000000000001, -3.7000000000000006, -4.200000000000001, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.300000000000001, -4.300000000000001, -3.9000000000000012, -3.700000000000001, -3.9000000000000012, -3.9000000000000004, -3.700000000000001, -3.700000000000001, -3.7, -4.000000000000002, -3.8000000000000007, -4.000000000000001, -3.7000000000000006, -3.900000000000001, -4.000000000000002, -4.000000000000001, -3.9000000000000012, -4.000000000000001, -4.200000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -4.1000000000000005, -4.100000000000001, -3.700000000000001, -4.000000000000001, -4.1000000000000005, -3.900000000000001, -3.6000000000000005, -4.200000000000001, -3.800000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000002, -4.0, -4.100000000000001, -4.0, -4.000000000000002, -3.9000000000000012, -4.000000000000002, -3.9000000000000012, -4.200000000000001, -3.800000000000001, -4.200000000000001, -3.8000000000000007, -4.000000000000001, -4.0, -4.000000000000002, -4.1000000000000005, -4.000000000000002, -4.100000000000001, -4.100000000000001, -3.7000000000000006, -3.8000000000000007, -4.200000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -3.9000000000000012, -4.600000000000001, -4.200000000000001, -4.200000000000001, -4.200000000000001, -4.200000000000001, -4.200000000000001, -3.900000000000001, -4.000000000000001, -3.9000000000000012, -4.200000000000001, -4.000000000000001, -3.9000000000000012, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.9000000000000012, -3.8000000000000007, -3.9000000000000012, -4.000000000000002, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -3.600000000000001, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000002, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -4.000000000000002], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.62016119721671, "mean_inference_ms": 18.24154331823208, "mean_action_processing_ms": 0.9403550746243972, "mean_env_wait_ms": 1.5392285866580417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07865863541762035, "StateBufferConnector_ms": 0.010064120093981424, "ViewRequirementAgentConnector_ms": 0.14540143311023712}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 652000, "num_agent_steps_trained": 652000, "num_env_steps_sampled": 652000, "num_env_steps_trained": 652000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 652000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 652000, "timers": {"training_iteration_time_ms": 175194.697, "load_time_ms": 1.248, "load_throughput": 3206409.296, "learn_time_ms": 174218.329, "learn_throughput": 22.96, "synch_weights_time_ms": 193.339}, "counters": {"num_env_steps_sampled": 652000, "num_env_steps_trained": 652000, "num_agent_steps_sampled": 652000, "num_agent_steps_trained": 652000}, "done": false, "episodes_total": 32501, "training_iteration": 163, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_04-44-11", "timestamp": 1680835451, "time_this_iter_s": 174.97881269454956, "time_total_s": 28109.653383731842, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7eff9479a040>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff9463b670>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 28109.653383731842, "timesteps_since_restore": 0, "iterations_since_restore": 163, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.3334677419354835, "ram_util_percent": 23.898790322580645}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.705430898615109, "cur_kl_coeff": 4.275585339908632, "cur_lr": 0.01, "total_loss": 0.3230873782548212, "policy_loss": 0.006361220911225324, "vf_loss": 0.2136670184071346, "vf_explained_var": 0.6857591349591491, "kl": 0.02410410159087229, "entropy": 2.7668538865222727, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 152055.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "sampler_results": {"episode_reward_max": -3.6000000000000005, "episode_reward_min": -10.4, "episode_reward_mean": -3.9661458333333344, "episode_len_mean": 20.911458333333332, "episode_media": {}, "episodes_this_iter": 192, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.9000000000000012, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -4.200000000000001, -4.000000000000001, -4.200000000000001, -3.700000000000001, -3.9000000000000012, -3.900000000000001, -10.4, -3.900000000000001, -3.700000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -4.0, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.1000000000000005, -3.6000000000000005, -3.8000000000000007, -3.9000000000000012, -4.1000000000000005, -4.100000000000001, -3.900000000000001, -3.800000000000001, -4.0, -4.100000000000001, -4.200000000000001, -4.000000000000002, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -3.900000000000001, -3.7000000000000006, -3.9000000000000012, -4.000000000000001, -3.6000000000000005, -4.400000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -3.9000000000000004, -3.7000000000000006, -3.900000000000001, -4.0, -4.000000000000002, -4.0, -4.000000000000002, -4.100000000000001, -3.8000000000000016, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.300000000000001, -3.900000000000001, -3.8000000000000003, -4.000000000000002, -4.000000000000001, -3.800000000000001, -3.9000000000000012, -4.000000000000001, -3.9000000000000004, -3.900000000000001, -3.800000000000001, -3.800000000000001, -3.9000000000000012, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.200000000000001, -3.900000000000001, -3.900000000000001, -3.9000000000000012, -3.900000000000001, -4.300000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -4.0, -3.900000000000001, -3.600000000000001, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.700000000000001, -3.8000000000000007, -4.000000000000001, -3.9000000000000012, -4.000000000000001, -3.700000000000001, -4.200000000000001, -3.9000000000000012, -4.100000000000001, -3.900000000000001, -4.300000000000001, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -4.100000000000001, -4.100000000000001, -4.200000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000002, -4.000000000000002, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.700000000000001, -3.9000000000000012, -3.900000000000001, -3.7000000000000006, -3.800000000000001, -3.8000000000000007, -3.800000000000001, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -4.200000000000001, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -4.000000000000002, -4.000000000000001, -4.000000000000002, -3.7, -3.8000000000000007, -3.9000000000000012, -4.000000000000001, -3.8000000000000007, -4.200000000000001, -3.7000000000000006, -3.9000000000000004, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000002, -4.000000000000001, -4.000000000000002, -3.8000000000000007, -4.100000000000001, -3.7, -4.100000000000001, -4.100000000000001, -4.200000000000001, -3.900000000000001, -3.7000000000000006, -4.0, -3.9000000000000004, -3.900000000000001, -3.800000000000001, -4.100000000000001, -4.100000000000001, -3.600000000000001, -3.6000000000000005, -3.7000000000000006, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.700000000000001, -3.6000000000000005, -4.000000000000002, -3.8000000000000007, -3.600000000000001, -4.000000000000001, -3.9000000000000004, -4.000000000000002, -3.900000000000001, -4.100000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.622059819402946, "mean_inference_ms": 18.232036377039794, "mean_action_processing_ms": 0.93987952744853, "mean_env_wait_ms": 1.5397466031090221, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0706646591424942, "StateBufferConnector_ms": 0.00876598060131073, "ViewRequirementAgentConnector_ms": 0.1286003738641739}}, "episode_reward_max": -3.6000000000000005, "episode_reward_min": -10.4, "episode_reward_mean": -3.9661458333333344, "episode_len_mean": 20.911458333333332, "episodes_this_iter": 192, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.9000000000000012, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -4.200000000000001, -4.000000000000001, -4.200000000000001, -3.700000000000001, -3.9000000000000012, -3.900000000000001, -10.4, -3.900000000000001, -3.700000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -4.0, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.1000000000000005, -3.6000000000000005, -3.8000000000000007, -3.9000000000000012, -4.1000000000000005, -4.100000000000001, -3.900000000000001, -3.800000000000001, -4.0, -4.100000000000001, -4.200000000000001, -4.000000000000002, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -3.900000000000001, -3.7000000000000006, -3.9000000000000012, -4.000000000000001, -3.6000000000000005, -4.400000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -3.9000000000000004, -3.7000000000000006, -3.900000000000001, -4.0, -4.000000000000002, -4.0, -4.000000000000002, -4.100000000000001, -3.8000000000000016, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.300000000000001, -3.900000000000001, -3.8000000000000003, -4.000000000000002, -4.000000000000001, -3.800000000000001, -3.9000000000000012, -4.000000000000001, -3.9000000000000004, -3.900000000000001, -3.800000000000001, -3.800000000000001, -3.9000000000000012, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.200000000000001, -3.900000000000001, -3.900000000000001, -3.9000000000000012, -3.900000000000001, -4.300000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -4.0, -3.900000000000001, -3.600000000000001, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.700000000000001, -3.8000000000000007, -4.000000000000001, -3.9000000000000012, -4.000000000000001, -3.700000000000001, -4.200000000000001, -3.9000000000000012, -4.100000000000001, -3.900000000000001, -4.300000000000001, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -4.100000000000001, -4.100000000000001, -4.200000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000002, -4.000000000000002, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.700000000000001, -3.9000000000000012, -3.900000000000001, -3.7000000000000006, -3.800000000000001, -3.8000000000000007, -3.800000000000001, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -4.200000000000001, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -4.000000000000002, -4.000000000000001, -4.000000000000002, -3.7, -3.8000000000000007, -3.9000000000000012, -4.000000000000001, -3.8000000000000007, -4.200000000000001, -3.7000000000000006, -3.9000000000000004, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000002, -4.000000000000001, -4.000000000000002, -3.8000000000000007, -4.100000000000001, -3.7, -4.100000000000001, -4.100000000000001, -4.200000000000001, -3.900000000000001, -3.7000000000000006, -4.0, -3.9000000000000004, -3.900000000000001, -3.800000000000001, -4.100000000000001, -4.100000000000001, -3.600000000000001, -3.6000000000000005, -3.7000000000000006, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.700000000000001, -3.6000000000000005, -4.000000000000002, -3.8000000000000007, -3.600000000000001, -4.000000000000001, -3.9000000000000004, -4.000000000000002, -3.900000000000001, -4.100000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.622059819402946, "mean_inference_ms": 18.232036377039794, "mean_action_processing_ms": 0.93987952744853, "mean_env_wait_ms": 1.5397466031090221, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0706646591424942, "StateBufferConnector_ms": 0.00876598060131073, "ViewRequirementAgentConnector_ms": 0.1286003738641739}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000, "num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 656000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 656000, "timers": {"training_iteration_time_ms": 175208.703, "load_time_ms": 1.255, "load_throughput": 3187706.105, "learn_time_ms": 174235.388, "learn_throughput": 22.957, "synch_weights_time_ms": 194.024}, "counters": {"num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "done": false, "episodes_total": 32693, "training_iteration": 164, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_04-47-06", "timestamp": 1680835626, "time_this_iter_s": 175.50945734977722, "time_total_s": 28285.16284108162, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0147569be0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff946edb80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 28285.16284108162, "timesteps_since_restore": 0, "iterations_since_restore": 164, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.497991967871486, "ram_util_percent": 23.900803212851407}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.439096571809502, "cur_kl_coeff": 6.413378009862951, "cur_lr": 0.01, "total_loss": 0.4379262580946889, "policy_loss": 0.0042674557671391515, "vf_loss": 0.2783111149104693, "vf_explained_var": 0.7017319196013994, "kl": 0.02422244243864571, "entropy": 2.7957977817904567, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 152985.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000}, "sampler_results": {"episode_reward_max": -3.5000000000000004, "episode_reward_min": -10.5, "episode_reward_mean": -3.9901041666666672, "episode_len_mean": 20.828125, "episode_media": {}, "episodes_this_iter": 192, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.9000000000000012, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.700000000000001, -3.900000000000001, -3.700000000000001, -4.100000000000001, -3.900000000000001, -4.0, -4.000000000000001, -3.8000000000000007, -3.9000000000000004, -4.200000000000001, -4.200000000000001, -4.100000000000001, -10.5, -3.900000000000001, -4.1000000000000005, -3.9000000000000012, -4.100000000000001, -3.7000000000000015, -4.000000000000001, -4.000000000000001, -3.500000000000001, -4.300000000000001, -3.8000000000000007, -3.9000000000000012, -4.000000000000001, -4.000000000000001, -3.6000000000000005, -3.800000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.300000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.700000000000001, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -3.700000000000001, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -3.800000000000001, -3.900000000000001, -4.200000000000001, -3.8000000000000007, -3.9000000000000012, -3.9000000000000012, -3.900000000000001, -4.100000000000001, -3.9000000000000004, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.100000000000001, -3.700000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.800000000000001, -4.000000000000001, -4.000000000000002, -3.9000000000000012, -3.600000000000001, -3.8000000000000007, -4.0, -4.100000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -3.800000000000001, -3.9000000000000012, -4.200000000000001, -3.800000000000001, -3.800000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000003, -3.900000000000001, -4.300000000000001, -3.9000000000000012, -4.200000000000001, -3.6000000000000005, -3.7, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -3.9000000000000012, -3.8000000000000007, -3.700000000000001, -3.900000000000001, -10.3, -3.8000000000000007, -4.300000000000001, -4.100000000000001, -3.900000000000001, -3.9000000000000012, -3.7000000000000006, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -3.7, -3.7000000000000006, -4.200000000000001, -4.000000000000002, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -4.1000000000000005, -4.000000000000001, -3.7000000000000006, -3.900000000000001, -3.8000000000000007, -4.0, -4.1000000000000005, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -3.9000000000000004, -4.000000000000001, -4.1000000000000005, -3.800000000000001, -3.900000000000001, -4.1000000000000005, -3.900000000000001, -3.9000000000000004, -4.000000000000001, -4.0, -4.000000000000001, -3.800000000000001, -4.000000000000001, -4.200000000000001, -3.900000000000001, -3.9000000000000012, -4.000000000000002, -3.900000000000001, -4.300000000000001, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.800000000000001, -4.000000000000001, -4.100000000000001, -4.0, -4.400000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -3.8000000000000007, -3.9000000000000004, -3.600000000000001, -3.500000000000001, -3.7000000000000015, -4.000000000000001, -4.100000000000001, -3.5000000000000004, -3.8000000000000007, -4.100000000000001, -3.800000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.7000000000000006, -3.600000000000001, -3.800000000000001, -3.7000000000000006, -3.7000000000000006, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.800000000000001, -3.900000000000001, -4.100000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.622264021754228, "mean_inference_ms": 18.240416872583232, "mean_action_processing_ms": 0.9405045808384807, "mean_env_wait_ms": 1.5414210618908548, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07492539783318837, "StateBufferConnector_ms": 0.009242693583170572, "ViewRequirementAgentConnector_ms": 0.13831071555614471}}, "episode_reward_max": -3.5000000000000004, "episode_reward_min": -10.5, "episode_reward_mean": -3.9901041666666672, "episode_len_mean": 20.828125, "episodes_this_iter": 192, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.9000000000000012, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.700000000000001, -3.900000000000001, -3.700000000000001, -4.100000000000001, -3.900000000000001, -4.0, -4.000000000000001, -3.8000000000000007, -3.9000000000000004, -4.200000000000001, -4.200000000000001, -4.100000000000001, -10.5, -3.900000000000001, -4.1000000000000005, -3.9000000000000012, -4.100000000000001, -3.7000000000000015, -4.000000000000001, -4.000000000000001, -3.500000000000001, -4.300000000000001, -3.8000000000000007, -3.9000000000000012, -4.000000000000001, -4.000000000000001, -3.6000000000000005, -3.800000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.300000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.700000000000001, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -3.700000000000001, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -3.800000000000001, -3.900000000000001, -4.200000000000001, -3.8000000000000007, -3.9000000000000012, -3.9000000000000012, -3.900000000000001, -4.100000000000001, -3.9000000000000004, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.100000000000001, -3.700000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.800000000000001, -4.000000000000001, -4.000000000000002, -3.9000000000000012, -3.600000000000001, -3.8000000000000007, -4.0, -4.100000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -3.800000000000001, -3.9000000000000012, -4.200000000000001, -3.800000000000001, -3.800000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000003, -3.900000000000001, -4.300000000000001, -3.9000000000000012, -4.200000000000001, -3.6000000000000005, -3.7, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -3.9000000000000012, -3.8000000000000007, -3.700000000000001, -3.900000000000001, -10.3, -3.8000000000000007, -4.300000000000001, -4.100000000000001, -3.900000000000001, -3.9000000000000012, -3.7000000000000006, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -3.7, -3.7000000000000006, -4.200000000000001, -4.000000000000002, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -4.1000000000000005, -4.000000000000001, -3.7000000000000006, -3.900000000000001, -3.8000000000000007, -4.0, -4.1000000000000005, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -3.9000000000000004, -4.000000000000001, -4.1000000000000005, -3.800000000000001, -3.900000000000001, -4.1000000000000005, -3.900000000000001, -3.9000000000000004, -4.000000000000001, -4.0, -4.000000000000001, -3.800000000000001, -4.000000000000001, -4.200000000000001, -3.900000000000001, -3.9000000000000012, -4.000000000000002, -3.900000000000001, -4.300000000000001, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.800000000000001, -4.000000000000001, -4.100000000000001, -4.0, -4.400000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -3.8000000000000007, -3.9000000000000004, -3.600000000000001, -3.500000000000001, -3.7000000000000015, -4.000000000000001, -4.100000000000001, -3.5000000000000004, -3.8000000000000007, -4.100000000000001, -3.800000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.7000000000000006, -3.600000000000001, -3.800000000000001, -3.7000000000000006, -3.7000000000000006, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.800000000000001, -3.900000000000001, -4.100000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 5, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.622264021754228, "mean_inference_ms": 18.240416872583232, "mean_action_processing_ms": 0.9405045808384807, "mean_env_wait_ms": 1.5414210618908548, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07492539783318837, "StateBufferConnector_ms": 0.009242693583170572, "ViewRequirementAgentConnector_ms": 0.13831071555614471}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 660000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 660000, "timers": {"training_iteration_time_ms": 175220.26, "load_time_ms": 1.251, "load_throughput": 3197182.658, "learn_time_ms": 174243.427, "learn_throughput": 22.956, "synch_weights_time_ms": 195.143}, "counters": {"num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000}, "done": false, "episodes_total": 32885, "training_iteration": 165, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_04-50-01", "timestamp": 1680835801, "time_this_iter_s": 175.07870817184448, "time_total_s": 28460.241549253464, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476d18b0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff94615790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 28460.241549253464, "timesteps_since_restore": 0, "iterations_since_restore": 165, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.308032128514055, "ram_util_percent": 23.90120481927711}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.148085555722636, "cur_kl_coeff": 9.620067014794428, "cur_lr": 0.01, "total_loss": 0.4933971810204688, "policy_loss": 0.007883372946932752, "vf_loss": 0.2791104756455908, "vf_explained_var": 0.7373104869037546, "kl": 0.021455499131272558, "entropy": 2.7839134808509582, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 153915.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_agent_steps_sampled": 664000, "num_agent_steps_trained": 664000}, "sampler_results": {"episode_reward_max": -3.6000000000000005, "episode_reward_min": -10.4, "episode_reward_mean": -4.0062500000000005, "episode_len_mean": 20.8125, "episode_media": {}, "episodes_this_iter": 192, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.9000000000000012, -4.1000000000000005, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -3.800000000000001, -4.100000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000002, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -10.1, -4.1000000000000005, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -4.200000000000001, -3.900000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000001, -3.8000000000000007, -3.600000000000001, -4.000000000000001, -4.000000000000001, -3.800000000000001, -3.8000000000000007, -3.9000000000000012, -3.9000000000000004, -4.000000000000001, -3.9000000000000012, -4.000000000000002, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -3.800000000000001, -4.000000000000001, -3.8000000000000003, -3.800000000000001, -4.000000000000002, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.200000000000001, -3.900000000000001, -3.6000000000000005, -4.100000000000001, -3.9000000000000012, -4.0, -3.800000000000001, -3.8000000000000007, -3.800000000000001, -4.0, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -4.0, -3.800000000000001, -4.000000000000001, -3.800000000000001, -4.100000000000001, -4.200000000000001, -3.8000000000000007, -4.1000000000000005, -3.8000000000000003, -3.900000000000001, -3.9000000000000012, -4.200000000000001, -4.1000000000000005, -3.800000000000001, -4.000000000000002, -4.1000000000000005, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -4.200000000000001, -4.0, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -3.8000000000000003, -3.8000000000000007, -3.700000000000001, -4.000000000000001, -3.900000000000001, -3.9000000000000012, -3.700000000000001, -3.600000000000001, -3.800000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -4.000000000000002, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.9000000000000012, -4.1000000000000005, -3.900000000000001, -4.000000000000002, -3.900000000000001, -3.900000000000001, -4.000000000000002, -3.9000000000000004, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -3.6000000000000005, -3.900000000000001, -4.000000000000002, -4.0, -4.000000000000001, -3.9000000000000012, -4.100000000000001, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -10.4, -3.8000000000000003, -4.1000000000000005, -3.7000000000000006, -4.200000000000001, -3.9000000000000012, -3.900000000000001, -3.900000000000001, -3.800000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000002, -4.000000000000001, -4.100000000000001, -4.300000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -4.0, -3.7000000000000006, -3.9000000000000012, -4.0, -3.9000000000000012, -3.8000000000000007, -3.6000000000000005, -3.900000000000001, -4.000000000000001, -4.000000000000002, -3.6000000000000005], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.62768380296502, "mean_inference_ms": 18.264962919075113, "mean_action_processing_ms": 0.9417711617560626, "mean_env_wait_ms": 1.5432329862056504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09995326399803162, "StateBufferConnector_ms": 0.011084352930386862, "ViewRequirementAgentConnector_ms": 0.15992199381192526}}, "episode_reward_max": -3.6000000000000005, "episode_reward_min": -10.4, "episode_reward_mean": -4.0062500000000005, "episode_len_mean": 20.8125, "episodes_this_iter": 192, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.9000000000000012, -4.1000000000000005, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -3.800000000000001, -4.100000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000002, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -10.1, -4.1000000000000005, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -4.200000000000001, -3.900000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000001, -3.8000000000000007, -3.600000000000001, -4.000000000000001, -4.000000000000001, -3.800000000000001, -3.8000000000000007, -3.9000000000000012, -3.9000000000000004, -4.000000000000001, -3.9000000000000012, -4.000000000000002, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -3.800000000000001, -4.000000000000001, -3.8000000000000003, -3.800000000000001, -4.000000000000002, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.200000000000001, -3.900000000000001, -3.6000000000000005, -4.100000000000001, -3.9000000000000012, -4.0, -3.800000000000001, -3.8000000000000007, -3.800000000000001, -4.0, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -4.0, -3.800000000000001, -4.000000000000001, -3.800000000000001, -4.100000000000001, -4.200000000000001, -3.8000000000000007, -4.1000000000000005, -3.8000000000000003, -3.900000000000001, -3.9000000000000012, -4.200000000000001, -4.1000000000000005, -3.800000000000001, -4.000000000000002, -4.1000000000000005, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -4.200000000000001, -4.0, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -3.8000000000000003, -3.8000000000000007, -3.700000000000001, -4.000000000000001, -3.900000000000001, -3.9000000000000012, -3.700000000000001, -3.600000000000001, -3.800000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -4.000000000000002, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.9000000000000012, -4.1000000000000005, -3.900000000000001, -4.000000000000002, -3.900000000000001, -3.900000000000001, -4.000000000000002, -3.9000000000000004, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -3.6000000000000005, -3.900000000000001, -4.000000000000002, -4.0, -4.000000000000001, -3.9000000000000012, -4.100000000000001, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -10.4, -3.8000000000000003, -4.1000000000000005, -3.7000000000000006, -4.200000000000001, -3.9000000000000012, -3.900000000000001, -3.900000000000001, -3.800000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000002, -4.000000000000001, -4.100000000000001, -4.300000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -4.0, -3.7000000000000006, -3.9000000000000012, -4.0, -3.9000000000000012, -3.8000000000000007, -3.6000000000000005, -3.900000000000001, -4.000000000000001, -4.000000000000002, -3.6000000000000005], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.62768380296502, "mean_inference_ms": 18.264962919075113, "mean_action_processing_ms": 0.9417711617560626, "mean_env_wait_ms": 1.5432329862056504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09995326399803162, "StateBufferConnector_ms": 0.011084352930386862, "ViewRequirementAgentConnector_ms": 0.15992199381192526}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 664000, "num_agent_steps_trained": 664000, "num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 664000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 664000, "timers": {"training_iteration_time_ms": 175221.887, "load_time_ms": 1.251, "load_throughput": 3196208.112, "learn_time_ms": 174238.391, "learn_throughput": 22.957, "synch_weights_time_ms": 196.21}, "counters": {"num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_agent_steps_sampled": 664000, "num_agent_steps_trained": 664000}, "done": false, "episodes_total": 33077, "training_iteration": 166, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_04-52-56", "timestamp": 1680835976, "time_this_iter_s": 175.03430485725403, "time_total_s": 28635.275854110718, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7eff9472c2e0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff9463ba60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 28635.275854110718, "timesteps_since_restore": 0, "iterations_since_restore": 166, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.375502008032129, "ram_util_percent": 23.902008032128517}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.964929029762104, "cur_kl_coeff": 14.430100522191642, "cur_lr": 0.01, "total_loss": 0.4649878515271089, "policy_loss": 0.0042532344639141075, "vf_loss": 0.20505092852618745, "vf_explained_var": 0.7293851126906692, "kl": 0.017718773967428735, "entropy": 2.7952261365869995, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 154845.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 668000, "num_env_steps_trained": 668000, "num_agent_steps_sampled": 668000, "num_agent_steps_trained": 668000}, "sampler_results": {"episode_reward_max": -3.6, "episode_reward_min": -10.1, "episode_reward_mean": -3.954922279792747, "episode_len_mean": 20.901554404145077, "episode_media": {}, "episodes_this_iter": 193, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.6000000000000005, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -4.000000000000002, -4.000000000000001, -4.100000000000001, -3.800000000000001, -4.300000000000001, -3.900000000000001, -3.9000000000000012, -4.100000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -3.9000000000000012, -4.0, -4.000000000000001, -3.900000000000001, -4.200000000000001, -3.800000000000001, -4.200000000000001, -4.0, -4.0, -3.700000000000001, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.800000000000001, -3.7000000000000006, -4.000000000000002, -3.800000000000001, -3.800000000000001, -3.8000000000000007, -3.900000000000001, -4.0, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.0, -3.900000000000001, -4.000000000000002, -4.1000000000000005, -3.8000000000000007, -4.200000000000001, -4.000000000000001, -4.000000000000001, -3.800000000000001, -4.100000000000001, -4.000000000000001, -3.800000000000001, -4.200000000000001, -3.7000000000000006, -3.900000000000001, -4.200000000000001, -3.6000000000000005, -3.9000000000000012, -4.000000000000001, -3.8000000000000007, -3.800000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000002, -4.100000000000001, -4.100000000000001, -3.6, -3.800000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.8000000000000003, -3.700000000000001, -3.8000000000000007, -4.300000000000001, -4.100000000000001, -3.8000000000000007, -3.7000000000000006, -3.8000000000000007, -4.100000000000001, -3.8000000000000007, -3.9000000000000004, -3.8000000000000007, -4.1000000000000005, -4.100000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -3.9000000000000004, -3.800000000000001, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000002, -4.100000000000001, -3.900000000000001, -4.0, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -4.000000000000001, -3.8000000000000007, -4.200000000000001, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -4.000000000000002, -4.000000000000001, -3.8000000000000007, -3.7000000000000006, -4.100000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000002, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -3.800000000000001, -3.700000000000001, -10.1, -4.100000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.7, -3.8000000000000007, -4.100000000000001, -3.8000000000000007, -3.700000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -3.8000000000000003, -3.7000000000000006, -4.000000000000002, -3.700000000000001, -4.200000000000001, -4.200000000000001, -3.800000000000001, -3.9000000000000004, -3.800000000000001, -3.8000000000000007, -4.200000000000001, -3.9000000000000012, -3.700000000000001, -4.000000000000001, -3.700000000000001, -3.8000000000000007, -3.8000000000000003, -4.000000000000001, -4.100000000000001, -3.800000000000001, -3.800000000000001, -3.9000000000000004, -3.9000000000000012, -3.8000000000000007], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.622181224897094, "mean_inference_ms": 18.242607231128954, "mean_action_processing_ms": 0.9410312588304913, "mean_env_wait_ms": 1.5382382813862567, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07601945511417685, "StateBufferConnector_ms": 0.00958170915514694, "ViewRequirementAgentConnector_ms": 0.13891810580238778}}, "episode_reward_max": -3.6, "episode_reward_min": -10.1, "episode_reward_mean": -3.954922279792747, "episode_len_mean": 20.901554404145077, "episodes_this_iter": 193, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.6000000000000005, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -4.000000000000002, -4.000000000000001, -4.100000000000001, -3.800000000000001, -4.300000000000001, -3.900000000000001, -3.9000000000000012, -4.100000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -3.9000000000000012, -4.0, -4.000000000000001, -3.900000000000001, -4.200000000000001, -3.800000000000001, -4.200000000000001, -4.0, -4.0, -3.700000000000001, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.800000000000001, -3.7000000000000006, -4.000000000000002, -3.800000000000001, -3.800000000000001, -3.8000000000000007, -3.900000000000001, -4.0, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.0, -3.900000000000001, -4.000000000000002, -4.1000000000000005, -3.8000000000000007, -4.200000000000001, -4.000000000000001, -4.000000000000001, -3.800000000000001, -4.100000000000001, -4.000000000000001, -3.800000000000001, -4.200000000000001, -3.7000000000000006, -3.900000000000001, -4.200000000000001, -3.6000000000000005, -3.9000000000000012, -4.000000000000001, -3.8000000000000007, -3.800000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000002, -4.100000000000001, -4.100000000000001, -3.6, -3.800000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -3.8000000000000003, -3.700000000000001, -3.8000000000000007, -4.300000000000001, -4.100000000000001, -3.8000000000000007, -3.7000000000000006, -3.8000000000000007, -4.100000000000001, -3.8000000000000007, -3.9000000000000004, -3.8000000000000007, -4.1000000000000005, -4.100000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -3.9000000000000004, -3.800000000000001, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000002, -4.100000000000001, -3.900000000000001, -4.0, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -4.000000000000001, -3.8000000000000007, -4.200000000000001, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -4.000000000000002, -4.000000000000001, -3.8000000000000007, -3.7000000000000006, -4.100000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000002, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -3.800000000000001, -3.700000000000001, -10.1, -4.100000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.7, -3.8000000000000007, -4.100000000000001, -3.8000000000000007, -3.700000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -3.8000000000000003, -3.7000000000000006, -4.000000000000002, -3.700000000000001, -4.200000000000001, -4.200000000000001, -3.800000000000001, -3.9000000000000004, -3.800000000000001, -3.8000000000000007, -4.200000000000001, -3.9000000000000012, -3.700000000000001, -4.000000000000001, -3.700000000000001, -3.8000000000000007, -3.8000000000000003, -4.000000000000001, -4.100000000000001, -3.800000000000001, -3.800000000000001, -3.9000000000000004, -3.9000000000000012, -3.8000000000000007], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.622181224897094, "mean_inference_ms": 18.242607231128954, "mean_action_processing_ms": 0.9410312588304913, "mean_env_wait_ms": 1.5382382813862567, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07601945511417685, "StateBufferConnector_ms": 0.00958170915514694, "ViewRequirementAgentConnector_ms": 0.13891810580238778}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 668000, "num_agent_steps_trained": 668000, "num_env_steps_sampled": 668000, "num_env_steps_trained": 668000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 668000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 668000, "timers": {"training_iteration_time_ms": 175271.827, "load_time_ms": 1.252, "load_throughput": 3195477.592, "learn_time_ms": 174280.083, "learn_throughput": 22.952, "synch_weights_time_ms": 196.942}, "counters": {"num_env_steps_sampled": 668000, "num_env_steps_trained": 668000, "num_agent_steps_sampled": 668000, "num_agent_steps_trained": 668000}, "done": false, "episodes_total": 33270, "training_iteration": 167, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_04-55-52", "timestamp": 1680836152, "time_this_iter_s": 175.6438639163971, "time_total_s": 28810.919718027115, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7eff9479adf0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff9463b670>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 28810.919718027115, "timesteps_since_restore": 0, "iterations_since_restore": 167, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.534, "ram_util_percent": 23.9004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.595791664943901, "cur_kl_coeff": 14.430100522191642, "cur_lr": 0.01, "total_loss": 0.3766076605606784, "policy_loss": -0.0002373733823137578, "vf_loss": 0.20603758218467877, "vf_explained_var": 0.7322735689660554, "kl": 0.011836885865489822, "entropy": 2.8011206211582307, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 155775.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "sampler_results": {"episode_reward_max": -3.6000000000000005, "episode_reward_min": -10.1, "episode_reward_mean": -3.9626315789473687, "episode_len_mean": 20.9, "episode_media": {}, "episodes_this_iter": 190, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.900000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -4.100000000000001, -3.9000000000000012, -3.800000000000001, -3.7000000000000006, -3.9000000000000004, -3.9000000000000004, -3.900000000000001, -4.000000000000001, -3.800000000000001, -10.1, -3.700000000000001, -3.700000000000001, -3.6000000000000005, -4.000000000000002, -3.7000000000000006, -4.000000000000001, -3.900000000000001, -3.8000000000000003, -3.7000000000000006, -3.900000000000001, -3.800000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -4.1000000000000005, -3.600000000000001, -4.000000000000001, -3.9000000000000012, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -3.6000000000000005, -4.000000000000001, -3.7000000000000006, -3.9000000000000004, -3.900000000000001, -3.6000000000000005, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.300000000000001, -3.7000000000000006, -3.900000000000001, -3.9000000000000012, -4.000000000000001, -4.200000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.800000000000001, -4.200000000000001, -4.0, -3.8000000000000007, -3.700000000000001, -4.000000000000001, -4.000000000000001, -3.800000000000001, -3.8000000000000007, -3.9000000000000012, -4.100000000000001, -3.800000000000001, -4.100000000000001, -4.1000000000000005, -4.000000000000001, -3.8000000000000007, -3.800000000000001, -4.0, -3.9000000000000004, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.700000000000001, -3.7000000000000006, -3.6000000000000005, -4.200000000000001, -4.1000000000000005, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -4.000000000000002, -3.900000000000001, -3.8000000000000007, -4.200000000000001, -4.0, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.1000000000000005, -4.100000000000001, -4.100000000000001, -3.9000000000000012, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.600000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -4.100000000000001, -3.9000000000000012, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.1000000000000005, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -4.300000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000002, -3.9000000000000012, -3.7000000000000006, -4.300000000000001, -4.000000000000001, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -4.100000000000001, -3.9000000000000012, -3.6000000000000005, -4.000000000000001, -4.1000000000000005, -3.6000000000000005, -3.800000000000001, -4.100000000000001, -3.9000000000000012, -4.000000000000002, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000001, -3.900000000000001, -3.800000000000001, -3.800000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000002, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -4.200000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000002, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.9000000000000012, -3.8000000000000007, -3.8000000000000003, -4.0], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.624866021863186, "mean_inference_ms": 18.252110090363114, "mean_action_processing_ms": 0.9412643129485585, "mean_env_wait_ms": 1.5410910502607476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07827545467175935, "StateBufferConnector_ms": 0.010590427800228721, "ViewRequirementAgentConnector_ms": 0.14608320436979594}}, "episode_reward_max": -3.6000000000000005, "episode_reward_min": -10.1, "episode_reward_mean": -3.9626315789473687, "episode_len_mean": 20.9, "episodes_this_iter": 190, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.900000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -4.100000000000001, -3.9000000000000012, -3.800000000000001, -3.7000000000000006, -3.9000000000000004, -3.9000000000000004, -3.900000000000001, -4.000000000000001, -3.800000000000001, -10.1, -3.700000000000001, -3.700000000000001, -3.6000000000000005, -4.000000000000002, -3.7000000000000006, -4.000000000000001, -3.900000000000001, -3.8000000000000003, -3.7000000000000006, -3.900000000000001, -3.800000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -4.1000000000000005, -3.600000000000001, -4.000000000000001, -3.9000000000000012, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -3.6000000000000005, -4.000000000000001, -3.7000000000000006, -3.9000000000000004, -3.900000000000001, -3.6000000000000005, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.300000000000001, -3.7000000000000006, -3.900000000000001, -3.9000000000000012, -4.000000000000001, -4.200000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.800000000000001, -4.200000000000001, -4.0, -3.8000000000000007, -3.700000000000001, -4.000000000000001, -4.000000000000001, -3.800000000000001, -3.8000000000000007, -3.9000000000000012, -4.100000000000001, -3.800000000000001, -4.100000000000001, -4.1000000000000005, -4.000000000000001, -3.8000000000000007, -3.800000000000001, -4.0, -3.9000000000000004, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.700000000000001, -3.7000000000000006, -3.6000000000000005, -4.200000000000001, -4.1000000000000005, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -4.000000000000002, -3.900000000000001, -3.8000000000000007, -4.200000000000001, -4.0, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.1000000000000005, -4.100000000000001, -4.100000000000001, -3.9000000000000012, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.600000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -4.100000000000001, -3.9000000000000012, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.1000000000000005, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -4.300000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000002, -3.9000000000000012, -3.7000000000000006, -4.300000000000001, -4.000000000000001, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -4.100000000000001, -3.9000000000000012, -3.6000000000000005, -4.000000000000001, -4.1000000000000005, -3.6000000000000005, -3.800000000000001, -4.100000000000001, -3.9000000000000012, -4.000000000000002, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000001, -3.900000000000001, -3.800000000000001, -3.800000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000002, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -4.200000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000002, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.9000000000000012, -3.8000000000000007, -3.8000000000000003, -4.0], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.624866021863186, "mean_inference_ms": 18.252110090363114, "mean_action_processing_ms": 0.9412643129485585, "mean_env_wait_ms": 1.5410910502607476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07827545467175935, "StateBufferConnector_ms": 0.010590427800228721, "ViewRequirementAgentConnector_ms": 0.14608320436979594}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 672000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 175216.679, "load_time_ms": 1.215, "load_throughput": 3291392.698, "learn_time_ms": 174240.174, "learn_throughput": 22.957, "synch_weights_time_ms": 184.636}, "counters": {"num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "done": false, "episodes_total": 33460, "training_iteration": 168, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_04-58-47", "timestamp": 1680836327, "time_this_iter_s": 175.027037858963, "time_total_s": 28985.946755886078, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7eff946d3490>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff94615040>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 28985.946755886078, "timesteps_since_restore": 0, "iterations_since_restore": 168, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.334136546184739, "ram_util_percent": 23.899598393574298}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.216295174629458, "cur_kl_coeff": 14.430100522191642, "cur_lr": 0.01, "total_loss": 0.4498289167159988, "policy_loss": 0.0029400965191363807, "vf_loss": 0.27804144565616884, "vf_explained_var": 0.7023490384701759, "kl": 0.011701053241518156, "entropy": 2.824535099665324, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 156705.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 676000, "num_env_steps_trained": 676000, "num_agent_steps_sampled": 676000, "num_agent_steps_trained": 676000}, "sampler_results": {"episode_reward_max": -3.6000000000000005, "episode_reward_min": -12.3, "episode_reward_mean": -4.081347150259068, "episode_len_mean": 20.72538860103627, "episode_media": {}, "episodes_this_iter": 193, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.100000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.200000000000001, -4.100000000000001, -3.800000000000001, -3.9000000000000012, -4.100000000000001, -3.8000000000000007, -4.200000000000001, -10.1, -4.300000000000001, -4.300000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000002, -4.1000000000000005, -3.8000000000000007, -3.9000000000000004, -3.900000000000001, -4.100000000000001, -4.100000000000001, -3.7000000000000006, -3.7000000000000006, -4.200000000000001, -3.7000000000000006, -3.9000000000000012, -3.9000000000000012, -4.0, -4.000000000000001, -3.900000000000001, -3.9000000000000004, -4.000000000000002, -4.000000000000002, -4.100000000000001, -3.9000000000000012, -3.600000000000001, -3.8000000000000007, -4.000000000000001, -3.700000000000001, -3.9000000000000004, -4.200000000000001, -3.700000000000001, -4.000000000000001, -3.900000000000001, -3.9000000000000012, -3.900000000000001, -3.700000000000001, -3.900000000000001, -3.8000000000000003, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -3.7000000000000006, -3.8000000000000007, -4.000000000000002, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -3.6000000000000005, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000002, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -3.8000000000000003, -4.0, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -12.3, -4.000000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -4.1000000000000005, -4.100000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000002, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -3.9000000000000004, -3.900000000000001, -3.600000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.9000000000000012, -3.9000000000000012, -3.6000000000000005, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -4.200000000000001, -3.7000000000000006, -3.7000000000000006, -3.9000000000000004, -3.7000000000000006, -4.000000000000001, -4.0, -4.300000000000001, -3.9000000000000012, -4.0, -4.1000000000000005, -3.900000000000001, -3.8000000000000007, -3.6000000000000005, -4.200000000000001, -3.900000000000001, -3.9000000000000012, -3.700000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -10.2, -4.200000000000001, -4.200000000000001, -4.100000000000001, -3.9000000000000012, -4.000000000000001, -4.000000000000001, -11.0, -3.7000000000000006, -4.000000000000002, -4.000000000000001, -4.200000000000001, -4.000000000000001, -3.7000000000000006, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -3.600000000000001, -4.200000000000001, -3.800000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.800000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -3.7000000000000006, -4.100000000000001, -3.800000000000001, -4.000000000000001, -3.900000000000001, -4.1000000000000005, -4.000000000000001, -4.000000000000002, -4.000000000000002, -3.900000000000001, -3.800000000000001, -3.9000000000000012, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.9000000000000012, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -4.0, -4.000000000000001, -3.8000000000000007], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.619791693382814, "mean_inference_ms": 18.243384401860144, "mean_action_processing_ms": 0.9410460106383656, "mean_env_wait_ms": 1.538278959969768, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07347838248613585, "StateBufferConnector_ms": 0.009475717890447903, "ViewRequirementAgentConnector_ms": 0.13529957884951577}}, "episode_reward_max": -3.6000000000000005, "episode_reward_min": -12.3, "episode_reward_mean": -4.081347150259068, "episode_len_mean": 20.72538860103627, "episodes_this_iter": 193, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.100000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.200000000000001, -4.100000000000001, -3.800000000000001, -3.9000000000000012, -4.100000000000001, -3.8000000000000007, -4.200000000000001, -10.1, -4.300000000000001, -4.300000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000002, -4.1000000000000005, -3.8000000000000007, -3.9000000000000004, -3.900000000000001, -4.100000000000001, -4.100000000000001, -3.7000000000000006, -3.7000000000000006, -4.200000000000001, -3.7000000000000006, -3.9000000000000012, -3.9000000000000012, -4.0, -4.000000000000001, -3.900000000000001, -3.9000000000000004, -4.000000000000002, -4.000000000000002, -4.100000000000001, -3.9000000000000012, -3.600000000000001, -3.8000000000000007, -4.000000000000001, -3.700000000000001, -3.9000000000000004, -4.200000000000001, -3.700000000000001, -4.000000000000001, -3.900000000000001, -3.9000000000000012, -3.900000000000001, -3.700000000000001, -3.900000000000001, -3.8000000000000003, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -3.7000000000000006, -3.8000000000000007, -4.000000000000002, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -3.6000000000000005, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000002, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -3.8000000000000003, -4.0, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -12.3, -4.000000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -4.1000000000000005, -4.100000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000002, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -3.9000000000000004, -3.900000000000001, -3.600000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -3.9000000000000012, -3.9000000000000012, -3.6000000000000005, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -4.200000000000001, -3.7000000000000006, -3.7000000000000006, -3.9000000000000004, -3.7000000000000006, -4.000000000000001, -4.0, -4.300000000000001, -3.9000000000000012, -4.0, -4.1000000000000005, -3.900000000000001, -3.8000000000000007, -3.6000000000000005, -4.200000000000001, -3.900000000000001, -3.9000000000000012, -3.700000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -10.2, -4.200000000000001, -4.200000000000001, -4.100000000000001, -3.9000000000000012, -4.000000000000001, -4.000000000000001, -11.0, -3.7000000000000006, -4.000000000000002, -4.000000000000001, -4.200000000000001, -4.000000000000001, -3.7000000000000006, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -3.600000000000001, -4.200000000000001, -3.800000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.800000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -3.7000000000000006, -4.100000000000001, -3.800000000000001, -4.000000000000001, -3.900000000000001, -4.1000000000000005, -4.000000000000001, -4.000000000000002, -4.000000000000002, -3.900000000000001, -3.800000000000001, -3.9000000000000012, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.9000000000000012, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -4.0, -4.000000000000001, -3.8000000000000007], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 16, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 10, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.619791693382814, "mean_inference_ms": 18.243384401860144, "mean_action_processing_ms": 0.9410460106383656, "mean_env_wait_ms": 1.538278959969768, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07347838248613585, "StateBufferConnector_ms": 0.009475717890447903, "ViewRequirementAgentConnector_ms": 0.13529957884951577}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 676000, "num_agent_steps_trained": 676000, "num_env_steps_sampled": 676000, "num_env_steps_trained": 676000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 676000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 676000, "timers": {"training_iteration_time_ms": 175300.268, "load_time_ms": 1.208, "load_throughput": 3311140.145, "learn_time_ms": 174326.559, "learn_throughput": 22.945, "synch_weights_time_ms": 184.87}, "counters": {"num_env_steps_sampled": 676000, "num_env_steps_trained": 676000, "num_agent_steps_sampled": 676000, "num_agent_steps_trained": 676000}, "done": false, "episodes_total": 33653, "training_iteration": 169, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_05-01-43", "timestamp": 1680836503, "time_this_iter_s": 175.68472504615784, "time_total_s": 29161.631480932236, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01476bcdf0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff9463bee0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 29161.631480932236, "timesteps_since_restore": 0, "iterations_since_restore": 169, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 6.3588, "ram_util_percent": 23.9008}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.11301502643093, "cur_kl_coeff": 14.430100522191642, "cur_lr": 0.01, "total_loss": 0.4530704389937142, "policy_loss": 0.004194963472064144, "vf_loss": 0.26639685123678175, "vf_explained_var": 0.6998309602660517, "kl": 0.012645693294708967, "entropy": 2.799804058126224, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 157635.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 680000}, "sampler_results": {"episode_reward_max": -3.6000000000000005, "episode_reward_min": -10.6, "episode_reward_mean": -4.057286432160805, "episode_len_mean": 20.65326633165829, "episode_media": {}, "episodes_this_iter": 199, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.800000000000001, -4.100000000000001, -4.000000000000001, -10.3, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000002, -4.000000000000001, -3.7, -3.900000000000001, -4.100000000000001, -3.700000000000001, -4.000000000000001, -10.1, -4.1000000000000005, -3.900000000000001, -3.9000000000000004, -10.1, -4.1000000000000005, -3.900000000000001, -3.8000000000000007, -4.000000000000002, -4.200000000000001, -4.100000000000001, -4.300000000000001, -4.000000000000001, -4.000000000000001, -3.6000000000000005, -4.000000000000002, -4.000000000000001, -4.000000000000002, -3.700000000000001, -3.900000000000001, -3.900000000000001, -3.9000000000000012, -4.1000000000000005, -3.800000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -4.200000000000001, -3.7, -3.8000000000000003, -3.900000000000001, -4.000000000000001, -3.800000000000001, -4.0, -3.600000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -3.900000000000001, -3.9000000000000012, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -4.000000000000001, -3.9000000000000012, -3.8000000000000007, -3.7000000000000006, -4.000000000000001, -4.1000000000000005, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -3.9000000000000012, -3.8000000000000007, -4.1000000000000005, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -4.000000000000002, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -3.600000000000001, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -3.700000000000001, -10.6, -3.900000000000001, -3.7000000000000006, -4.200000000000001, -3.900000000000001, -3.8000000000000007, -3.6000000000000005, -4.300000000000002, -4.200000000000001, -3.700000000000001, -3.9000000000000012, -3.600000000000001, -4.100000000000001, -3.9000000000000004, -3.9000000000000012, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.0, -4.000000000000001, -3.9000000000000012, -4.300000000000001, -4.000000000000001, -4.300000000000001, -4.1000000000000005, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000001, -3.8000000000000007, -3.9000000000000012, -4.0, -3.900000000000001, -3.800000000000001, -3.7000000000000006, -4.000000000000001, -3.700000000000001, -4.100000000000001, -3.800000000000001, -3.600000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -3.6000000000000005, -3.8000000000000007, -3.9000000000000012, -3.8000000000000007, -4.000000000000002, -4.200000000000001, -3.8000000000000007, -3.7000000000000006, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.800000000000001, -3.900000000000001, -4.000000000000001, -4.1000000000000005, -4.100000000000001, -4.100000000000001, -3.800000000000001, -4.000000000000001, -3.800000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -4.100000000000001, -3.7, -3.800000000000001, -3.800000000000001, -4.000000000000001, -3.9000000000000004, -3.900000000000001, -3.7000000000000006, -3.7000000000000006, -3.700000000000001, -3.700000000000001, -3.9000000000000012, -4.100000000000001, -3.700000000000001, -3.6000000000000005, -4.000000000000002, -4.000000000000001, -3.8000000000000007, -4.0, -3.900000000000001, -4.000000000000001, -4.0, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007], "episode_lengths": [21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.623479048302784, "mean_inference_ms": 18.23891257547317, "mean_action_processing_ms": 0.9405828741462346, "mean_env_wait_ms": 1.5405574055449647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07430093372287462, "StateBufferConnector_ms": 0.009931511615388957, "ViewRequirementAgentConnector_ms": 0.13846188933406045}}, "episode_reward_max": -3.6000000000000005, "episode_reward_min": -10.6, "episode_reward_mean": -4.057286432160805, "episode_len_mean": 20.65326633165829, "episodes_this_iter": 199, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.800000000000001, -4.100000000000001, -4.000000000000001, -10.3, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000002, -4.000000000000001, -3.7, -3.900000000000001, -4.100000000000001, -3.700000000000001, -4.000000000000001, -10.1, -4.1000000000000005, -3.900000000000001, -3.9000000000000004, -10.1, -4.1000000000000005, -3.900000000000001, -3.8000000000000007, -4.000000000000002, -4.200000000000001, -4.100000000000001, -4.300000000000001, -4.000000000000001, -4.000000000000001, -3.6000000000000005, -4.000000000000002, -4.000000000000001, -4.000000000000002, -3.700000000000001, -3.900000000000001, -3.900000000000001, -3.9000000000000012, -4.1000000000000005, -3.800000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -4.200000000000001, -3.7, -3.8000000000000003, -3.900000000000001, -4.000000000000001, -3.800000000000001, -4.0, -3.600000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -3.900000000000001, -3.9000000000000012, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -4.000000000000001, -3.9000000000000012, -3.8000000000000007, -3.7000000000000006, -4.000000000000001, -4.1000000000000005, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -3.9000000000000012, -3.8000000000000007, -4.1000000000000005, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -4.000000000000002, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -3.600000000000001, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -3.700000000000001, -10.6, -3.900000000000001, -3.7000000000000006, -4.200000000000001, -3.900000000000001, -3.8000000000000007, -3.6000000000000005, -4.300000000000002, -4.200000000000001, -3.700000000000001, -3.9000000000000012, -3.600000000000001, -4.100000000000001, -3.9000000000000004, -3.9000000000000012, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.0, -4.000000000000001, -3.9000000000000012, -4.300000000000001, -4.000000000000001, -4.300000000000001, -4.1000000000000005, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000001, -3.8000000000000007, -3.9000000000000012, -4.0, -3.900000000000001, -3.800000000000001, -3.7000000000000006, -4.000000000000001, -3.700000000000001, -4.100000000000001, -3.800000000000001, -3.600000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -3.6000000000000005, -3.8000000000000007, -3.9000000000000012, -3.8000000000000007, -4.000000000000002, -4.200000000000001, -3.8000000000000007, -3.7000000000000006, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.800000000000001, -3.900000000000001, -4.000000000000001, -4.1000000000000005, -4.100000000000001, -4.100000000000001, -3.800000000000001, -4.000000000000001, -3.800000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -4.100000000000001, -3.7, -3.800000000000001, -3.800000000000001, -4.000000000000001, -3.9000000000000004, -3.900000000000001, -3.7000000000000006, -3.7000000000000006, -3.700000000000001, -3.700000000000001, -3.9000000000000012, -4.100000000000001, -3.700000000000001, -3.6000000000000005, -4.000000000000002, -4.000000000000001, -3.8000000000000007, -4.0, -3.900000000000001, -4.000000000000001, -4.0, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007], "episode_lengths": [21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.623479048302784, "mean_inference_ms": 18.23891257547317, "mean_action_processing_ms": 0.9405828741462346, "mean_env_wait_ms": 1.5405574055449647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07430093372287462, "StateBufferConnector_ms": 0.009931511615388957, "ViewRequirementAgentConnector_ms": 0.13846188933406045}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 680000, "num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 680000, "timers": {"training_iteration_time_ms": 175280.425, "load_time_ms": 1.195, "load_throughput": 3346274.408, "learn_time_ms": 174283.928, "learn_throughput": 22.951, "synch_weights_time_ms": 185.098}, "counters": {"num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 680000}, "done": false, "episodes_total": 33852, "training_iteration": 170, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_05-04-38", "timestamp": 1680836678, "time_this_iter_s": 175.30075812339783, "time_total_s": 29336.932239055634, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f014746e4c0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff945f7700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 29336.932239055634, "timesteps_since_restore": 0, "iterations_since_restore": 170, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.312449799196787, "ram_util_percent": 23.90120481927711}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.493036935406346, "cur_kl_coeff": 14.430100522191642, "cur_lr": 0.01, "total_loss": 0.4247308412787094, "policy_loss": 0.00397177672674579, "vf_loss": 0.2539271254773422, "vf_explained_var": 0.7111033102517487, "kl": 0.011561384486311155, "entropy": 2.7781335464087866, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 158565.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "sampler_results": {"episode_reward_max": -3.500000000000001, "episode_reward_min": -10.3, "episode_reward_mean": -4.008900523560211, "episode_len_mean": 20.81151832460733, "episode_media": {}, "episodes_this_iter": 191, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.900000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.200000000000001, -3.900000000000001, -3.9000000000000012, -10.1, -4.0, -4.0, -3.700000000000001, -3.700000000000001, -3.7000000000000006, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -10.3, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -4.200000000000001, -4.000000000000002, -4.000000000000002, -4.0, -4.200000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -3.7000000000000006, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -4.200000000000001, -4.000000000000002, -3.9000000000000012, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -3.800000000000001, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000002, -4.000000000000001, -3.9000000000000004, -4.000000000000001, -4.100000000000001, -3.700000000000001, -3.800000000000001, -3.8000000000000007, -4.000000000000002, -4.100000000000001, -3.6000000000000005, -3.8000000000000007, -4.000000000000002, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -4.1000000000000005, -4.000000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -3.800000000000001, -4.000000000000001, -3.9000000000000012, -3.700000000000001, -4.100000000000001, -3.800000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -3.9000000000000012, -3.700000000000001, -3.8000000000000007, -3.500000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.1000000000000005, -3.9000000000000012, -3.800000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -4.000000000000002, -4.100000000000001, -4.0, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000002, -3.900000000000001, -3.9000000000000012, -3.900000000000001, -3.900000000000001, -3.800000000000001, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -3.900000000000001, -3.600000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -3.6000000000000005, -3.7000000000000006, -3.9000000000000004, -4.100000000000001, -4.200000000000001, -4.200000000000001, -3.8000000000000007, -4.100000000000001, -4.000000000000002, -3.900000000000001, -3.900000000000001, -3.9000000000000012, -3.900000000000001, -4.200000000000001, -3.800000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.4, -4.300000000000002, -4.000000000000001, -4.000000000000002, -4.1000000000000005, -4.100000000000001, -4.100000000000001, -4.1000000000000005, -4.000000000000001, -3.900000000000001, -3.6000000000000005, -3.900000000000001, -4.100000000000001, -4.400000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -3.7000000000000006, -3.800000000000001, -3.6000000000000005, -3.800000000000001, -4.000000000000001, -3.900000000000001, -4.0, -3.8000000000000007, -3.9000000000000012, -3.800000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000002, -3.6000000000000005, -3.9000000000000012, -3.800000000000001, -3.8000000000000007, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.619652956644392, "mean_inference_ms": 18.23623656550799, "mean_action_processing_ms": 0.9407971921579793, "mean_env_wait_ms": 1.5381409231088676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07837667515140553, "StateBufferConnector_ms": 0.009788518176652999, "ViewRequirementAgentConnector_ms": 0.14176593401045076}}, "episode_reward_max": -3.500000000000001, "episode_reward_min": -10.3, "episode_reward_mean": -4.008900523560211, "episode_len_mean": 20.81151832460733, "episodes_this_iter": 191, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.900000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.200000000000001, -3.900000000000001, -3.9000000000000012, -10.1, -4.0, -4.0, -3.700000000000001, -3.700000000000001, -3.7000000000000006, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -10.3, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -4.200000000000001, -4.000000000000002, -4.000000000000002, -4.0, -4.200000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -3.7000000000000006, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -4.200000000000001, -4.000000000000002, -3.9000000000000012, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -3.800000000000001, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000002, -4.000000000000001, -3.9000000000000004, -4.000000000000001, -4.100000000000001, -3.700000000000001, -3.800000000000001, -3.8000000000000007, -4.000000000000002, -4.100000000000001, -3.6000000000000005, -3.8000000000000007, -4.000000000000002, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -4.1000000000000005, -4.000000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -3.800000000000001, -4.000000000000001, -3.9000000000000012, -3.700000000000001, -4.100000000000001, -3.800000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -3.9000000000000012, -3.700000000000001, -3.8000000000000007, -3.500000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.1000000000000005, -3.9000000000000012, -3.800000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -4.000000000000002, -4.100000000000001, -4.0, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000002, -3.900000000000001, -3.9000000000000012, -3.900000000000001, -3.900000000000001, -3.800000000000001, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -3.900000000000001, -3.600000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -3.6000000000000005, -3.7000000000000006, -3.9000000000000004, -4.100000000000001, -4.200000000000001, -4.200000000000001, -3.8000000000000007, -4.100000000000001, -4.000000000000002, -3.900000000000001, -3.900000000000001, -3.9000000000000012, -3.900000000000001, -4.200000000000001, -3.800000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.4, -4.300000000000002, -4.000000000000001, -4.000000000000002, -4.1000000000000005, -4.100000000000001, -4.100000000000001, -4.1000000000000005, -4.000000000000001, -3.900000000000001, -3.6000000000000005, -3.900000000000001, -4.100000000000001, -4.400000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.7000000000000006, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -3.7000000000000006, -3.800000000000001, -3.6000000000000005, -3.800000000000001, -4.000000000000001, -3.900000000000001, -4.0, -3.8000000000000007, -3.9000000000000012, -3.800000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000002, -3.6000000000000005, -3.9000000000000012, -3.800000000000001, -3.8000000000000007, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.619652956644392, "mean_inference_ms": 18.23623656550799, "mean_action_processing_ms": 0.9407971921579793, "mean_env_wait_ms": 1.5381409231088676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07837667515140553, "StateBufferConnector_ms": 0.009788518176652999, "ViewRequirementAgentConnector_ms": 0.14176593401045076}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 684000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 684000, "timers": {"training_iteration_time_ms": 175370.991, "load_time_ms": 1.178, "load_throughput": 3394548.398, "learn_time_ms": 174381.307, "learn_throughput": 22.938, "synch_weights_time_ms": 182.022}, "counters": {"num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "done": false, "episodes_total": 34043, "training_iteration": 171, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_05-07-34", "timestamp": 1680836854, "time_this_iter_s": 175.81379461288452, "time_total_s": 29512.746033668518, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7eff946d30d0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff94615a60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 29512.746033668518, "timesteps_since_restore": 0, "iterations_since_restore": 171, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.5396, "ram_util_percent": 23.900800000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.832381103884789, "cur_kl_coeff": 14.430100522191642, "cur_lr": 0.01, "total_loss": 0.4650790818976939, "policy_loss": -0.0007938412318546926, "vf_loss": 0.25637799312350573, "vf_explained_var": 0.7384925627580253, "kl": 0.014517912045571834, "entropy": 2.7684864146735078, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 159495.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "sampler_results": {"episode_reward_max": -3.5000000000000004, "episode_reward_min": -4.400000000000001, "episode_reward_mean": -3.960655737704919, "episode_len_mean": 21.0, "episode_media": {}, "episodes_this_iter": 183, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.900000000000001, -3.900000000000001, -4.0, -4.100000000000001, -4.100000000000001, -3.700000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -4.0, -4.200000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -3.9000000000000012, -3.900000000000001, -4.100000000000001, -3.7000000000000006, -3.9000000000000004, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -4.300000000000001, -4.100000000000001, -3.7, -4.100000000000001, -4.200000000000001, -3.900000000000001, -4.1000000000000005, -3.800000000000001, -3.800000000000001, -3.8000000000000007, -3.8000000000000007, -3.7000000000000006, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.9000000000000004, -3.900000000000001, -4.200000000000001, -4.0, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -3.700000000000001, -4.000000000000002, -4.0, -4.200000000000001, -4.100000000000001, -3.700000000000001, -4.0, -4.000000000000001, -3.900000000000001, -4.1000000000000005, -3.900000000000001, -4.1000000000000005, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -3.9000000000000012, -4.400000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.7000000000000006, -3.7000000000000006, -3.900000000000001, -3.700000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.9000000000000012, -3.900000000000001, -4.100000000000001, -3.800000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -4.1000000000000005, -4.100000000000001, -3.900000000000001, -3.7, -4.300000000000001, -4.0, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.1000000000000005, -4.100000000000001, -3.900000000000001, -4.000000000000002, -4.000000000000001, -3.800000000000001, -4.0, -4.000000000000001, -4.000000000000002, -4.000000000000001, -4.100000000000001, -3.5000000000000004, -4.100000000000001, -3.9000000000000012, -4.000000000000002, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000002, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000002, -4.000000000000001, -3.900000000000001, -4.100000000000001, -3.600000000000001, -3.900000000000001, -4.100000000000001, -3.9000000000000012, -3.7000000000000006, -3.900000000000001, -3.900000000000001, -3.6000000000000005, -3.9000000000000004, -3.9000000000000012, -3.7000000000000006, -3.900000000000001, -3.6000000000000005, -4.000000000000001, -4.1000000000000005, -3.900000000000001, -3.7000000000000006, -4.200000000000001, -4.100000000000001, -4.200000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000002, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -4.100000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.6188091372592, "mean_inference_ms": 18.2269024517607, "mean_action_processing_ms": 0.9403715253265691, "mean_env_wait_ms": 1.5364607265492283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07236577122589279, "StateBufferConnector_ms": 0.009073976610527664, "ViewRequirementAgentConnector_ms": 0.13661566979246711}}, "episode_reward_max": -3.5000000000000004, "episode_reward_min": -4.400000000000001, "episode_reward_mean": -3.960655737704919, "episode_len_mean": 21.0, "episodes_this_iter": 183, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.900000000000001, -3.900000000000001, -4.0, -4.100000000000001, -4.100000000000001, -3.700000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -4.0, -4.200000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -3.9000000000000012, -3.900000000000001, -4.100000000000001, -3.7000000000000006, -3.9000000000000004, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -4.300000000000001, -4.100000000000001, -3.7, -4.100000000000001, -4.200000000000001, -3.900000000000001, -4.1000000000000005, -3.800000000000001, -3.800000000000001, -3.8000000000000007, -3.8000000000000007, -3.7000000000000006, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.9000000000000004, -3.900000000000001, -4.200000000000001, -4.0, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -3.700000000000001, -4.000000000000002, -4.0, -4.200000000000001, -4.100000000000001, -3.700000000000001, -4.0, -4.000000000000001, -3.900000000000001, -4.1000000000000005, -3.900000000000001, -4.1000000000000005, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -3.9000000000000012, -4.400000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.7000000000000006, -3.7000000000000006, -3.900000000000001, -3.700000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.9000000000000012, -3.900000000000001, -4.100000000000001, -3.800000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -4.1000000000000005, -4.100000000000001, -3.900000000000001, -3.7, -4.300000000000001, -4.0, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.1000000000000005, -4.100000000000001, -3.900000000000001, -4.000000000000002, -4.000000000000001, -3.800000000000001, -4.0, -4.000000000000001, -4.000000000000002, -4.000000000000001, -4.100000000000001, -3.5000000000000004, -4.100000000000001, -3.9000000000000012, -4.000000000000002, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000002, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000002, -4.000000000000001, -3.900000000000001, -4.100000000000001, -3.600000000000001, -3.900000000000001, -4.100000000000001, -3.9000000000000012, -3.7000000000000006, -3.900000000000001, -3.900000000000001, -3.6000000000000005, -3.9000000000000004, -3.9000000000000012, -3.7000000000000006, -3.900000000000001, -3.6000000000000005, -4.000000000000001, -4.1000000000000005, -3.900000000000001, -3.7000000000000006, -4.200000000000001, -4.100000000000001, -4.200000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000002, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -4.100000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.6188091372592, "mean_inference_ms": 18.2269024517607, "mean_action_processing_ms": 0.9403715253265691, "mean_env_wait_ms": 1.5364607265492283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07236577122589279, "StateBufferConnector_ms": 0.009073976610527664, "ViewRequirementAgentConnector_ms": 0.13661566979246711}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000, "num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 688000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 688000, "timers": {"training_iteration_time_ms": 175344.48, "load_time_ms": 1.17, "load_throughput": 3417783.572, "learn_time_ms": 174352.508, "learn_throughput": 22.942, "synch_weights_time_ms": 181.323}, "counters": {"num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "done": false, "episodes_total": 34226, "training_iteration": 172, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_05-10-30", "timestamp": 1680837030, "time_this_iter_s": 175.48833990097046, "time_total_s": 29688.23437356949, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0147659940>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff946151f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 29688.23437356949, "timesteps_since_restore": 0, "iterations_since_restore": 172, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.347600000000001, "ram_util_percent": 23.9016}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.803578089898632, "cur_kl_coeff": 14.430100522191642, "cur_lr": 0.01, "total_loss": 0.40469691109272743, "policy_loss": -4.223238636729538e-05, "vf_loss": 0.24084087841773547, "vf_explained_var": 0.724112194520171, "kl": 0.011358081965997654, "entropy": 2.78117652375211, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 160425.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 692000, "num_env_steps_trained": 692000, "num_agent_steps_sampled": 692000, "num_agent_steps_trained": 692000}, "sampler_results": {"episode_reward_max": -3.4000000000000004, "episode_reward_min": -10.3, "episode_reward_mean": -3.991709844559586, "episode_len_mean": 20.911917098445596, "episode_media": {}, "episodes_this_iter": 193, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.800000000000001, -4.1000000000000005, -4.000000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -4.0, -3.6000000000000005, -4.100000000000001, -4.300000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -10.3, -4.200000000000001, -4.100000000000001, -3.900000000000001, -4.1000000000000005, -4.100000000000001, -4.0, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -4.200000000000001, -3.8000000000000007, -4.000000000000001, -4.0, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -4.000000000000002, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.800000000000001, -3.9000000000000012, -4.200000000000001, -4.000000000000001, -3.9000000000000012, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -3.7000000000000006, -3.600000000000001, -3.9000000000000012, -4.000000000000002, -4.000000000000001, -3.800000000000001, -3.8000000000000003, -4.100000000000001, -4.100000000000001, -4.000000000000002, -4.100000000000001, -3.7000000000000006, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.0, -4.0, -3.8000000000000007, -3.8000000000000007, -3.9000000000000004, -4.200000000000001, -4.200000000000001, -4.000000000000002, -4.200000000000001, -3.8000000000000007, -4.000000000000002, -3.9000000000000012, -3.9000000000000012, -4.300000000000001, -4.200000000000001, -3.8000000000000007, -3.900000000000001, -3.9000000000000012, -4.000000000000002, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -3.9000000000000012, -4.0, -4.000000000000001, -4.000000000000001, -3.4000000000000004, -4.100000000000001, -3.9000000000000012, -3.6000000000000005, -3.9000000000000012, -4.000000000000002, -3.7000000000000006, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.1000000000000005, -3.6000000000000005, -3.700000000000001, -3.800000000000001, -4.0, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.6000000000000005, -4.000000000000002, -4.000000000000001, -3.700000000000001, -4.100000000000001, -4.200000000000001, -4.0, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.200000000000001, -3.9000000000000004, -3.800000000000001, -4.000000000000001, -4.0, -3.9000000000000012, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -4.000000000000002, -3.7000000000000006, -3.7000000000000006, -3.8000000000000007, -3.8000000000000007, -4.100000000000001, -3.9000000000000004, -3.600000000000001, -3.900000000000001, -4.200000000000001, -3.900000000000001, -4.200000000000001, -4.300000000000001, -3.9000000000000012, -3.900000000000001, -4.100000000000001, -4.300000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000003, -4.000000000000001, -3.900000000000001, -3.9000000000000012, -4.200000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.9000000000000004, -4.200000000000001, -3.7000000000000006, -3.900000000000001, -4.200000000000001, -4.100000000000001, -3.700000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -4.200000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000002, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.9000000000000012, -4.200000000000001, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -3.8000000000000007, -4.300000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000002, -3.7000000000000006, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.9000000000000012, -3.9000000000000012, -4.100000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.61969773965079, "mean_inference_ms": 18.238675498262534, "mean_action_processing_ms": 0.9405617821199505, "mean_env_wait_ms": 1.5373574066649813, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07644181424471999, "StateBufferConnector_ms": 0.009754161142932318, "ViewRequirementAgentConnector_ms": 0.137612486132686}}, "episode_reward_max": -3.4000000000000004, "episode_reward_min": -10.3, "episode_reward_mean": -3.991709844559586, "episode_len_mean": 20.911917098445596, "episodes_this_iter": 193, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.800000000000001, -4.1000000000000005, -4.000000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -4.0, -3.6000000000000005, -4.100000000000001, -4.300000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -10.3, -4.200000000000001, -4.100000000000001, -3.900000000000001, -4.1000000000000005, -4.100000000000001, -4.0, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -4.200000000000001, -3.8000000000000007, -4.000000000000001, -4.0, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -4.000000000000002, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.800000000000001, -3.9000000000000012, -4.200000000000001, -4.000000000000001, -3.9000000000000012, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -3.7000000000000006, -3.600000000000001, -3.9000000000000012, -4.000000000000002, -4.000000000000001, -3.800000000000001, -3.8000000000000003, -4.100000000000001, -4.100000000000001, -4.000000000000002, -4.100000000000001, -3.7000000000000006, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.0, -4.0, -3.8000000000000007, -3.8000000000000007, -3.9000000000000004, -4.200000000000001, -4.200000000000001, -4.000000000000002, -4.200000000000001, -3.8000000000000007, -4.000000000000002, -3.9000000000000012, -3.9000000000000012, -4.300000000000001, -4.200000000000001, -3.8000000000000007, -3.900000000000001, -3.9000000000000012, -4.000000000000002, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -3.9000000000000012, -4.0, -4.000000000000001, -4.000000000000001, -3.4000000000000004, -4.100000000000001, -3.9000000000000012, -3.6000000000000005, -3.9000000000000012, -4.000000000000002, -3.7000000000000006, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.1000000000000005, -3.6000000000000005, -3.700000000000001, -3.800000000000001, -4.0, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.6000000000000005, -4.000000000000002, -4.000000000000001, -3.700000000000001, -4.100000000000001, -4.200000000000001, -4.0, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.200000000000001, -3.9000000000000004, -3.800000000000001, -4.000000000000001, -4.0, -3.9000000000000012, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -4.000000000000002, -3.7000000000000006, -3.7000000000000006, -3.8000000000000007, -3.8000000000000007, -4.100000000000001, -3.9000000000000004, -3.600000000000001, -3.900000000000001, -4.200000000000001, -3.900000000000001, -4.200000000000001, -4.300000000000001, -3.9000000000000012, -3.900000000000001, -4.100000000000001, -4.300000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000003, -4.000000000000001, -3.900000000000001, -3.9000000000000012, -4.200000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.9000000000000004, -4.200000000000001, -3.7000000000000006, -3.900000000000001, -4.200000000000001, -4.100000000000001, -3.700000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -4.200000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000002, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.9000000000000012, -4.200000000000001, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -3.8000000000000007, -4.300000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000002, -3.7000000000000006, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.9000000000000012, -3.9000000000000012, -4.100000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.61969773965079, "mean_inference_ms": 18.238675498262534, "mean_action_processing_ms": 0.9405617821199505, "mean_env_wait_ms": 1.5373574066649813, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07644181424471999, "StateBufferConnector_ms": 0.009754161142932318, "ViewRequirementAgentConnector_ms": 0.137612486132686}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 692000, "num_agent_steps_trained": 692000, "num_env_steps_sampled": 692000, "num_env_steps_trained": 692000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 692000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 692000, "timers": {"training_iteration_time_ms": 175395.179, "load_time_ms": 1.182, "load_throughput": 3385233.253, "learn_time_ms": 174405.022, "learn_throughput": 22.935, "synch_weights_time_ms": 182.493}, "counters": {"num_env_steps_sampled": 692000, "num_env_steps_trained": 692000, "num_agent_steps_sampled": 692000, "num_agent_steps_trained": 692000}, "done": false, "episodes_total": 34419, "training_iteration": 173, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_05-13-25", "timestamp": 1680837205, "time_this_iter_s": 175.48656463623047, "time_total_s": 29863.72093820572, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7eff946f6340>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff94615040>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 29863.72093820572, "timesteps_since_restore": 0, "iterations_since_restore": 173, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.306024096385542, "ram_util_percent": 23.900000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.11348790648163, "cur_kl_coeff": 14.430100522191642, "cur_lr": 0.01, "total_loss": 0.42392531515209264, "policy_loss": 0.006684512180346314, "vf_loss": 0.20610824214514867, "vf_explained_var": 0.7429781470888405, "kl": 0.014631399227292478, "entropy": 2.7727540082828974, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 161355.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000}, "sampler_results": {"episode_reward_max": -3.6000000000000005, "episode_reward_min": -10.3, "episode_reward_mean": -3.9761658031088087, "episode_len_mean": 20.906735751295336, "episode_media": {}, "episodes_this_iter": 193, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.100000000000001, -4.000000000000001, -4.200000000000001, -3.900000000000001, -4.200000000000001, -3.8000000000000007, -3.700000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.0, -3.7000000000000006, -4.000000000000002, -3.900000000000001, -4.000000000000001, -3.9000000000000004, -3.900000000000001, -10.3, -4.000000000000001, -4.0, -3.900000000000001, -3.9000000000000012, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.200000000000001, -3.700000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -3.8000000000000007, -3.7, -3.900000000000001, -3.9000000000000012, -4.000000000000001, -3.700000000000001, -4.000000000000001, -3.8000000000000003, -3.8000000000000007, -4.100000000000001, -3.9000000000000004, -4.000000000000001, -3.8000000000000007, -4.0, -3.7000000000000006, -4.100000000000001, -4.200000000000001, -3.600000000000001, -4.1000000000000005, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -4.0, -3.9000000000000004, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.700000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -4.0, -3.900000000000001, -3.6000000000000005, -4.0, -3.900000000000001, -3.8000000000000007, -3.700000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.6000000000000005, -3.9000000000000012, -3.9000000000000012, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -4.0, -4.300000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000002, -4.200000000000001, -4.000000000000002, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -3.9000000000000012, -3.8000000000000007, -3.8000000000000003, -4.000000000000001, -4.000000000000002, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -3.9000000000000012, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -4.300000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.800000000000001, -3.900000000000001, -3.8000000000000007, -3.7000000000000006, -3.9000000000000004, -3.900000000000001, -4.100000000000001, -3.6000000000000005, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -4.1000000000000005, -3.9000000000000012, -4.100000000000001, -3.8000000000000007, -3.9000000000000004, -4.200000000000001, -4.1000000000000005, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.1000000000000005, -4.000000000000001, -4.000000000000002, -4.000000000000001, -3.700000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -4.1000000000000005, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.9000000000000012, -4.000000000000002, -4.1000000000000005, -4.000000000000002, -4.000000000000002, -3.800000000000001, -4.000000000000001, -4.100000000000001, -3.6000000000000005, -3.9000000000000012, -3.8000000000000007, -4.100000000000001, -4.100000000000001, -4.300000000000001, -4.000000000000001, -3.8000000000000003, -3.800000000000001, -3.8000000000000007, -4.000000000000001, -3.9000000000000004, -3.900000000000001, -4.200000000000001, -3.7000000000000006, -3.8000000000000007, -4.0, -3.700000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.617471046383079, "mean_inference_ms": 18.2388727792558, "mean_action_processing_ms": 0.9411619677219998, "mean_env_wait_ms": 1.5373301715455836, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07917633946077811, "StateBufferConnector_ms": 0.010273246567484011, "ViewRequirementAgentConnector_ms": 0.14644435032661715}}, "episode_reward_max": -3.6000000000000005, "episode_reward_min": -10.3, "episode_reward_mean": -3.9761658031088087, "episode_len_mean": 20.906735751295336, "episodes_this_iter": 193, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.100000000000001, -4.000000000000001, -4.200000000000001, -3.900000000000001, -4.200000000000001, -3.8000000000000007, -3.700000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.0, -3.7000000000000006, -4.000000000000002, -3.900000000000001, -4.000000000000001, -3.9000000000000004, -3.900000000000001, -10.3, -4.000000000000001, -4.0, -3.900000000000001, -3.9000000000000012, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.200000000000001, -3.700000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -3.8000000000000007, -3.7, -3.900000000000001, -3.9000000000000012, -4.000000000000001, -3.700000000000001, -4.000000000000001, -3.8000000000000003, -3.8000000000000007, -4.100000000000001, -3.9000000000000004, -4.000000000000001, -3.8000000000000007, -4.0, -3.7000000000000006, -4.100000000000001, -4.200000000000001, -3.600000000000001, -4.1000000000000005, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -4.0, -3.9000000000000004, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.700000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -4.0, -3.900000000000001, -3.6000000000000005, -4.0, -3.900000000000001, -3.8000000000000007, -3.700000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.6000000000000005, -3.9000000000000012, -3.9000000000000012, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -4.0, -4.300000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000002, -4.200000000000001, -4.000000000000002, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.7000000000000006, -3.9000000000000012, -3.8000000000000007, -3.8000000000000003, -4.000000000000001, -4.000000000000002, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -3.9000000000000012, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -4.300000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.800000000000001, -3.900000000000001, -3.8000000000000007, -3.7000000000000006, -3.9000000000000004, -3.900000000000001, -4.100000000000001, -3.6000000000000005, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -4.1000000000000005, -3.9000000000000012, -4.100000000000001, -3.8000000000000007, -3.9000000000000004, -4.200000000000001, -4.1000000000000005, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.1000000000000005, -4.000000000000001, -4.000000000000002, -4.000000000000001, -3.700000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -4.1000000000000005, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.9000000000000012, -4.000000000000002, -4.1000000000000005, -4.000000000000002, -4.000000000000002, -3.800000000000001, -4.000000000000001, -4.100000000000001, -3.6000000000000005, -3.9000000000000012, -3.8000000000000007, -4.100000000000001, -4.100000000000001, -4.300000000000001, -4.000000000000001, -3.8000000000000003, -3.800000000000001, -3.8000000000000007, -4.000000000000001, -3.9000000000000004, -3.900000000000001, -4.200000000000001, -3.7000000000000006, -3.8000000000000007, -4.0, -3.700000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.617471046383079, "mean_inference_ms": 18.2388727792558, "mean_action_processing_ms": 0.9411619677219998, "mean_env_wait_ms": 1.5373301715455836, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07917633946077811, "StateBufferConnector_ms": 0.010273246567484011, "ViewRequirementAgentConnector_ms": 0.14644435032661715}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 696000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 696000, "timers": {"training_iteration_time_ms": 175463.841, "load_time_ms": 1.181, "load_throughput": 3388241.377, "learn_time_ms": 174468.726, "learn_throughput": 22.927, "synch_weights_time_ms": 182.374}, "counters": {"num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000}, "done": false, "episodes_total": 34612, "training_iteration": 174, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_05-16-21", "timestamp": 1680837381, "time_this_iter_s": 176.19579100608826, "time_total_s": 30039.916729211807, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7eff946f64c0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff945baf70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 30039.916729211807, "timesteps_since_restore": 0, "iterations_since_restore": 174, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.5536, "ram_util_percent": 23.9008}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.633158252957047, "cur_kl_coeff": 14.430100522191642, "cur_lr": 0.01, "total_loss": 0.43819543149282214, "policy_loss": 0.0038951049759102766, "vf_loss": 0.25342099104196797, "vf_explained_var": 0.7300764889486374, "kl": 0.012534863216632237, "entropy": 2.7581772488932454, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 162285.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_agent_steps_sampled": 700000, "num_agent_steps_trained": 700000}, "sampler_results": {"episode_reward_max": -3.500000000000001, "episode_reward_min": -10.3, "episode_reward_mean": -4.042857142857144, "episode_len_mean": 20.724489795918366, "episode_media": {}, "episodes_this_iter": 196, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.000000000000001, -3.9000000000000012, -4.100000000000001, -3.8000000000000003, -10.2, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.1000000000000005, -4.300000000000001, -10.2, -4.100000000000001, -3.700000000000001, -4.1000000000000005, -4.200000000000001, -3.600000000000001, -10.3, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.200000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -4.300000000000001, -4.1000000000000005, -3.700000000000001, -3.800000000000001, -3.700000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.9000000000000012, -3.7000000000000006, -4.100000000000001, -4.000000000000002, -4.200000000000001, -3.9000000000000012, -4.0, -3.900000000000001, -3.800000000000001, -3.7000000000000006, -3.5000000000000013, -3.9000000000000004, -3.6000000000000005, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000002, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.9000000000000012, -4.000000000000001, -3.700000000000001, -3.900000000000001, -4.100000000000001, -3.700000000000001, -3.9000000000000012, -3.7000000000000006, -4.100000000000001, -3.900000000000001, -3.9000000000000012, -3.9000000000000012, -4.100000000000001, -4.000000000000002, -3.9000000000000004, -3.900000000000001, -4.200000000000001, -3.9000000000000012, -3.8000000000000007, -4.000000000000001, -3.7000000000000006, -3.8000000000000007, -3.8000000000000007, -4.1000000000000005, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -3.7000000000000006, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -3.9000000000000012, -4.1000000000000005, -4.100000000000001, -4.000000000000001, -4.000000000000002, -3.9000000000000012, -4.000000000000001, -4.200000000000001, -3.8000000000000007, -3.9000000000000004, -3.900000000000001, -3.900000000000001, -3.9000000000000012, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000002, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.300000000000001, -4.1000000000000005, -4.300000000000002, -3.600000000000001, -4.0, -3.9000000000000012, -3.800000000000001, -4.200000000000001, -4.000000000000001, -3.9000000000000004, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.700000000000001, -4.0, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.9000000000000012, -4.100000000000001, -3.8000000000000003, -3.900000000000001, -4.100000000000001, -3.700000000000001, -3.7000000000000006, -4.100000000000001, -3.8000000000000007, -4.200000000000001, -4.000000000000001, -3.7000000000000006, -4.000000000000002, -4.300000000000001, -4.000000000000001, -4.000000000000002, -3.9000000000000012, -3.8000000000000007, -4.100000000000001, -3.800000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -3.800000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.500000000000001, -3.600000000000001, -4.000000000000002, -4.000000000000001, -3.800000000000001, -4.200000000000001, -3.900000000000001, -4.100000000000001, -4.200000000000001, -3.900000000000001, -4.100000000000001, -4.200000000000001, -3.900000000000001, -4.0, -4.000000000000001, -4.0, -4.100000000000001, -3.9000000000000012, -3.7000000000000006, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -3.700000000000001, -3.900000000000001, -3.600000000000001, -3.9000000000000004], "episode_lengths": [21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.617860457427561, "mean_inference_ms": 18.236224496749358, "mean_action_processing_ms": 0.9405618320603157, "mean_env_wait_ms": 1.5371967897310146, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07202880723135811, "StateBufferConnector_ms": 0.009192009361422792, "ViewRequirementAgentConnector_ms": 0.13505536682751715}}, "episode_reward_max": -3.500000000000001, "episode_reward_min": -10.3, "episode_reward_mean": -4.042857142857144, "episode_len_mean": 20.724489795918366, "episodes_this_iter": 196, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.000000000000001, -3.9000000000000012, -4.100000000000001, -3.8000000000000003, -10.2, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.1000000000000005, -4.300000000000001, -10.2, -4.100000000000001, -3.700000000000001, -4.1000000000000005, -4.200000000000001, -3.600000000000001, -10.3, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.200000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -4.300000000000001, -4.1000000000000005, -3.700000000000001, -3.800000000000001, -3.700000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.9000000000000012, -3.7000000000000006, -4.100000000000001, -4.000000000000002, -4.200000000000001, -3.9000000000000012, -4.0, -3.900000000000001, -3.800000000000001, -3.7000000000000006, -3.5000000000000013, -3.9000000000000004, -3.6000000000000005, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000002, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.9000000000000012, -4.000000000000001, -3.700000000000001, -3.900000000000001, -4.100000000000001, -3.700000000000001, -3.9000000000000012, -3.7000000000000006, -4.100000000000001, -3.900000000000001, -3.9000000000000012, -3.9000000000000012, -4.100000000000001, -4.000000000000002, -3.9000000000000004, -3.900000000000001, -4.200000000000001, -3.9000000000000012, -3.8000000000000007, -4.000000000000001, -3.7000000000000006, -3.8000000000000007, -3.8000000000000007, -4.1000000000000005, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -3.7000000000000006, -3.900000000000001, -4.000000000000001, -3.7000000000000006, -4.000000000000001, -3.9000000000000012, -4.1000000000000005, -4.100000000000001, -4.000000000000001, -4.000000000000002, -3.9000000000000012, -4.000000000000001, -4.200000000000001, -3.8000000000000007, -3.9000000000000004, -3.900000000000001, -3.900000000000001, -3.9000000000000012, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000002, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.300000000000001, -4.1000000000000005, -4.300000000000002, -3.600000000000001, -4.0, -3.9000000000000012, -3.800000000000001, -4.200000000000001, -4.000000000000001, -3.9000000000000004, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.700000000000001, -4.0, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.9000000000000012, -4.100000000000001, -3.8000000000000003, -3.900000000000001, -4.100000000000001, -3.700000000000001, -3.7000000000000006, -4.100000000000001, -3.8000000000000007, -4.200000000000001, -4.000000000000001, -3.7000000000000006, -4.000000000000002, -4.300000000000001, -4.000000000000001, -4.000000000000002, -3.9000000000000012, -3.8000000000000007, -4.100000000000001, -3.800000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -3.800000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.500000000000001, -3.600000000000001, -4.000000000000002, -4.000000000000001, -3.800000000000001, -4.200000000000001, -3.900000000000001, -4.100000000000001, -4.200000000000001, -3.900000000000001, -4.100000000000001, -4.200000000000001, -3.900000000000001, -4.0, -4.000000000000001, -4.0, -4.100000000000001, -3.9000000000000012, -3.7000000000000006, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -3.700000000000001, -3.900000000000001, -3.600000000000001, -3.9000000000000004], "episode_lengths": [21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.617860457427561, "mean_inference_ms": 18.236224496749358, "mean_action_processing_ms": 0.9405618320603157, "mean_env_wait_ms": 1.5371967897310146, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07202880723135811, "StateBufferConnector_ms": 0.009192009361422792, "ViewRequirementAgentConnector_ms": 0.13505536682751715}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 700000, "num_agent_steps_trained": 700000, "num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 700000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 700000, "timers": {"training_iteration_time_ms": 175482.678, "load_time_ms": 1.184, "load_throughput": 3378892.715, "learn_time_ms": 174489.683, "learn_throughput": 22.924, "synch_weights_time_ms": 182.449}, "counters": {"num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_agent_steps_sampled": 700000, "num_agent_steps_trained": 700000}, "done": false, "episodes_total": 34808, "training_iteration": 175, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_05-19-17", "timestamp": 1680837557, "time_this_iter_s": 175.26762223243713, "time_total_s": 30215.184351444244, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01475e2160>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff945ba790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 30215.184351444244, "timesteps_since_restore": 0, "iterations_since_restore": 175, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.3267999999999995, "ram_util_percent": 23.9004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.219099092611703, "cur_kl_coeff": 14.430100522191642, "cur_lr": 0.01, "total_loss": 0.440911799525061, "policy_loss": 0.0018814495113748375, "vf_loss": 0.25011051558358693, "vf_explained_var": 0.7400319455131408, "kl": 0.013092066407559179, "entropy": 2.7478377352478685, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 163215.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "sampler_results": {"episode_reward_max": -3.6000000000000005, "episode_reward_min": -10.3, "episode_reward_mean": -4.00846560846561, "episode_len_mean": 20.91005291005291, "episode_media": {}, "episodes_this_iter": 189, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.900000000000001, -4.000000000000001, -3.9000000000000012, -4.100000000000001, -3.800000000000001, -4.400000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -10.3, -4.000000000000002, -4.300000000000001, -3.9000000000000012, -4.0, -4.200000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -4.000000000000001, -3.9000000000000012, -4.200000000000001, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.0, -4.000000000000001, -4.000000000000002, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -3.7000000000000006, -4.1000000000000005, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.200000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -4.300000000000001, -4.200000000000001, -4.200000000000001, -4.100000000000001, -3.900000000000001, -3.9000000000000004, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -3.800000000000001, -4.000000000000001, -4.0, -4.0, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.300000000000001, -4.000000000000002, -3.8000000000000007, -3.900000000000001, -3.9000000000000004, -4.200000000000001, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -3.6000000000000005, -3.700000000000001, -4.300000000000001, -3.700000000000001, -4.000000000000001, -4.000000000000002, -3.900000000000001, -3.9000000000000004, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -3.700000000000001, -3.8000000000000007, -3.900000000000001, -4.1000000000000005, -4.000000000000001, -4.000000000000002, -4.000000000000001, -4.000000000000001, -4.1000000000000005, -3.6000000000000005, -3.900000000000001, -4.1000000000000005, -3.900000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.200000000000001, -3.900000000000001, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.7000000000000006, -4.100000000000001, -4.100000000000001, -4.000000000000002, -4.000000000000001, -4.100000000000001, -4.200000000000001, -3.7000000000000006, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.7, -4.200000000000001, -4.000000000000002, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.300000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000002, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -3.600000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000002, -4.000000000000001, -4.100000000000001, -4.300000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.7, -3.8000000000000007, -3.9000000000000004, -4.1000000000000005, -4.000000000000001, -3.8000000000000007, -3.6000000000000014, -3.900000000000001, -3.9000000000000012, -4.000000000000001, -3.900000000000001, -3.700000000000001, -4.200000000000001, -4.000000000000001, -4.400000000000001, -3.7000000000000006, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -3.900000000000001, -3.700000000000001, -3.600000000000001, -3.700000000000001, -4.1000000000000005], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.617735518620753, "mean_inference_ms": 18.245575493999063, "mean_action_processing_ms": 0.9405934121628589, "mean_env_wait_ms": 1.537766710854959, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07295267922537667, "StateBufferConnector_ms": 0.009223393031529017, "ViewRequirementAgentConnector_ms": 0.13415573765991856}}, "episode_reward_max": -3.6000000000000005, "episode_reward_min": -10.3, "episode_reward_mean": -4.00846560846561, "episode_len_mean": 20.91005291005291, "episodes_this_iter": 189, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.900000000000001, -4.000000000000001, -3.9000000000000012, -4.100000000000001, -3.800000000000001, -4.400000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -10.3, -4.000000000000002, -4.300000000000001, -3.9000000000000012, -4.0, -4.200000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -4.000000000000001, -3.9000000000000012, -4.200000000000001, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.0, -4.000000000000001, -4.000000000000002, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -3.7000000000000006, -4.1000000000000005, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.200000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -3.8000000000000007, -4.300000000000001, -4.200000000000001, -4.200000000000001, -4.100000000000001, -3.900000000000001, -3.9000000000000004, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -3.800000000000001, -4.000000000000001, -4.0, -4.0, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.300000000000001, -4.000000000000002, -3.8000000000000007, -3.900000000000001, -3.9000000000000004, -4.200000000000001, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -3.6000000000000005, -3.700000000000001, -4.300000000000001, -3.700000000000001, -4.000000000000001, -4.000000000000002, -3.900000000000001, -3.9000000000000004, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -3.700000000000001, -3.8000000000000007, -3.900000000000001, -4.1000000000000005, -4.000000000000001, -4.000000000000002, -4.000000000000001, -4.000000000000001, -4.1000000000000005, -3.6000000000000005, -3.900000000000001, -4.1000000000000005, -3.900000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.200000000000001, -3.900000000000001, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.7000000000000006, -4.100000000000001, -4.100000000000001, -4.000000000000002, -4.000000000000001, -4.100000000000001, -4.200000000000001, -3.7000000000000006, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000001, -3.7, -4.200000000000001, -4.000000000000002, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.300000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000002, -3.900000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -3.600000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000002, -4.000000000000001, -4.100000000000001, -4.300000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.7, -3.8000000000000007, -3.9000000000000004, -4.1000000000000005, -4.000000000000001, -3.8000000000000007, -3.6000000000000014, -3.900000000000001, -3.9000000000000012, -4.000000000000001, -3.900000000000001, -3.700000000000001, -4.200000000000001, -4.000000000000001, -4.400000000000001, -3.7000000000000006, -3.8000000000000007, -3.800000000000001, -3.900000000000001, -3.900000000000001, -3.700000000000001, -3.600000000000001, -3.700000000000001, -4.1000000000000005], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.617735518620753, "mean_inference_ms": 18.245575493999063, "mean_action_processing_ms": 0.9405934121628589, "mean_env_wait_ms": 1.537766710854959, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07295267922537667, "StateBufferConnector_ms": 0.009223393031529017, "ViewRequirementAgentConnector_ms": 0.13415573765991856}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000, "num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 704000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 704000, "timers": {"training_iteration_time_ms": 175532.258, "load_time_ms": 1.183, "load_throughput": 3381276.15, "learn_time_ms": 174548.366, "learn_throughput": 22.916, "synch_weights_time_ms": 182.628}, "counters": {"num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "done": false, "episodes_total": 34997, "training_iteration": 176, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_05-22-12", "timestamp": 1680837732, "time_this_iter_s": 175.52827644348145, "time_total_s": 30390.712627887726, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01473e2a90>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff945f79d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 30390.712627887726, "timesteps_since_restore": 0, "iterations_since_restore": 176, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.320883534136547, "ram_util_percent": 23.901204819277112}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.691672769028653, "cur_kl_coeff": 14.430100522191642, "cur_lr": 0.01, "total_loss": 0.47697274924846744, "policy_loss": 0.007919276408070037, "vf_loss": 0.2578332643835775, "vf_explained_var": 0.7509866362617862, "kl": 0.014637473199525297, "entropy": 2.7427538051400133, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 164145.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000}, "sampler_results": {"episode_reward_max": -3.600000000000001, "episode_reward_min": -10.2, "episode_reward_mean": -4.012307692307694, "episode_len_mean": 20.907692307692308, "episode_media": {}, "episodes_this_iter": 195, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.9000000000000012, -4.000000000000001, -3.8000000000000007, -4.1000000000000005, -4.300000000000001, -4.100000000000001, -3.9000000000000012, -3.8000000000000007, -4.200000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -4.1000000000000005, -4.100000000000001, -4.200000000000001, -4.000000000000001, -10.2, -4.200000000000001, -3.7000000000000006, -3.900000000000001, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -3.7000000000000006, -4.000000000000001, -4.000000000000002, -4.100000000000001, -3.800000000000001, -3.8000000000000007, -4.100000000000001, -3.8000000000000003, -4.000000000000002, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000002, -4.000000000000002, -4.1000000000000005, -3.800000000000001, -3.7000000000000006, -4.0, -3.8000000000000007, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -4.100000000000001, -4.200000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000002, -4.200000000000001, -4.100000000000001, -4.200000000000001, -4.0, -3.9000000000000004, -4.000000000000002, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000002, -3.8000000000000003, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -3.9000000000000012, -4.200000000000001, -3.9000000000000012, -3.900000000000001, -4.100000000000001, -4.100000000000001, -3.9000000000000004, -4.100000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000002, -4.0, -3.8000000000000007, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -4.200000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.9000000000000004, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000002, -3.900000000000001, -3.900000000000001, -4.0, -4.0, -3.7000000000000006, -4.200000000000001, -4.000000000000002, -3.900000000000001, -4.200000000000001, -3.8000000000000007, -4.200000000000001, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.300000000000001, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -3.9000000000000004, -4.100000000000001, -3.900000000000001, -4.1000000000000005, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.200000000000001, -4.100000000000001, -3.900000000000001, -4.200000000000001, -3.9000000000000012, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.9000000000000012, -3.900000000000001, -4.1000000000000005, -3.900000000000001, -3.9000000000000012, -4.300000000000001, -4.100000000000001, -3.900000000000001, -4.0, -4.100000000000001, -3.900000000000001, -4.200000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.800000000000001, -3.900000000000001, -3.900000000000001, -3.600000000000001, -3.900000000000001, -3.700000000000001, -3.8000000000000003, -4.200000000000001, -3.800000000000001, -4.000000000000002, -3.9000000000000012, -4.100000000000001, -4.000000000000001, -4.1000000000000005, -4.000000000000001, -4.1000000000000005, -4.300000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.700000000000001, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -3.800000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.600000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000002, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -4.000000000000002, -3.8000000000000007, -4.100000000000001, -4.000000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.61638216092941, "mean_inference_ms": 18.233406959888207, "mean_action_processing_ms": 0.9405158072070608, "mean_env_wait_ms": 1.5363779289598019, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07505221244616386, "StateBufferConnector_ms": 0.009813186449882312, "ViewRequirementAgentConnector_ms": 0.13820012410481772}}, "episode_reward_max": -3.600000000000001, "episode_reward_min": -10.2, "episode_reward_mean": -4.012307692307694, "episode_len_mean": 20.907692307692308, "episodes_this_iter": 195, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.9000000000000012, -4.000000000000001, -3.8000000000000007, -4.1000000000000005, -4.300000000000001, -4.100000000000001, -3.9000000000000012, -3.8000000000000007, -4.200000000000001, -4.000000000000001, -4.200000000000001, -4.100000000000001, -4.1000000000000005, -4.100000000000001, -4.200000000000001, -4.000000000000001, -10.2, -4.200000000000001, -3.7000000000000006, -3.900000000000001, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -3.7000000000000006, -4.000000000000001, -4.000000000000002, -4.100000000000001, -3.800000000000001, -3.8000000000000007, -4.100000000000001, -3.8000000000000003, -4.000000000000002, -4.000000000000001, -3.900000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000002, -4.000000000000002, -4.1000000000000005, -3.800000000000001, -3.7000000000000006, -4.0, -3.8000000000000007, -3.8000000000000007, -4.100000000000001, -3.900000000000001, -4.100000000000001, -4.200000000000001, -3.900000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000002, -4.200000000000001, -4.100000000000001, -4.200000000000001, -4.0, -3.9000000000000004, -4.000000000000002, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000002, -3.8000000000000003, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -3.9000000000000012, -4.200000000000001, -3.9000000000000012, -3.900000000000001, -4.100000000000001, -4.100000000000001, -3.9000000000000004, -4.100000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000002, -4.0, -3.8000000000000007, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -4.200000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.9000000000000004, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000002, -3.900000000000001, -3.900000000000001, -4.0, -4.0, -3.7000000000000006, -4.200000000000001, -4.000000000000002, -3.900000000000001, -4.200000000000001, -3.8000000000000007, -4.200000000000001, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.300000000000001, -4.100000000000001, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -3.9000000000000004, -4.100000000000001, -3.900000000000001, -4.1000000000000005, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.200000000000001, -4.100000000000001, -3.900000000000001, -4.200000000000001, -3.9000000000000012, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -3.9000000000000012, -3.900000000000001, -4.1000000000000005, -3.900000000000001, -3.9000000000000012, -4.300000000000001, -4.100000000000001, -3.900000000000001, -4.0, -4.100000000000001, -3.900000000000001, -4.200000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -3.800000000000001, -3.900000000000001, -3.900000000000001, -3.600000000000001, -3.900000000000001, -3.700000000000001, -3.8000000000000003, -4.200000000000001, -3.800000000000001, -4.000000000000002, -3.9000000000000012, -4.100000000000001, -4.000000000000001, -4.1000000000000005, -4.000000000000001, -4.1000000000000005, -4.300000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -3.900000000000001, -3.700000000000001, -4.000000000000001, -4.000000000000001, -3.9000000000000012, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.9000000000000012, -3.800000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.600000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000002, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -4.000000000000002, -3.8000000000000007, -4.100000000000001, -4.000000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.61638216092941, "mean_inference_ms": 18.233406959888207, "mean_action_processing_ms": 0.9405158072070608, "mean_env_wait_ms": 1.5363779289598019, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07505221244616386, "StateBufferConnector_ms": 0.009813186449882312, "ViewRequirementAgentConnector_ms": 0.13820012410481772}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 708000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 708000, "timers": {"training_iteration_time_ms": 175534.631, "load_time_ms": 1.173, "load_throughput": 3409864.64, "learn_time_ms": 174557.871, "learn_throughput": 22.915, "synch_weights_time_ms": 181.939}, "counters": {"num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000}, "done": false, "episodes_total": 35192, "training_iteration": 177, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_05-25-08", "timestamp": 1680837908, "time_this_iter_s": 175.66791892051697, "time_total_s": 30566.380546808243, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7eff94561130>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff945f0e50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 30566.380546808243, "timesteps_since_restore": 0, "iterations_since_restore": 177, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.3347999999999995, "ram_util_percent": 23.9016}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.05331182069676, "cur_kl_coeff": 14.430100522191642, "cur_lr": 0.01, "total_loss": 0.5494759780064385, "policy_loss": -0.0037299605702320413, "vf_loss": 0.27716072373973427, "vf_explained_var": 0.755504370376628, "kl": 0.019129819434852167, "entropy": 2.75063435364795, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 165075.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_agent_steps_sampled": 712000, "num_agent_steps_trained": 712000}, "sampler_results": {"episode_reward_max": -3.500000000000001, "episode_reward_min": -10.4, "episode_reward_mean": -4.015263157894738, "episode_len_mean": 20.910526315789475, "episode_media": {}, "episodes_this_iter": 190, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.100000000000001, -4.000000000000001, -4.200000000000001, -3.900000000000001, -4.100000000000001, -3.9000000000000012, -4.100000000000001, -4.300000000000001, -4.200000000000001, -4.1000000000000005, -4.200000000000001, -4.200000000000001, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -10.4, -3.8000000000000007, -4.200000000000001, -4.200000000000001, -4.000000000000001, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -4.000000000000002, -4.000000000000001, -3.900000000000001, -4.200000000000001, -3.900000000000001, -4.1000000000000005, -4.100000000000001, -4.100000000000001, -3.800000000000001, -3.800000000000001, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -4.000000000000002, -4.1000000000000005, -4.100000000000001, -4.000000000000001, -4.200000000000001, -3.800000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000002, -4.0, -4.000000000000001, -4.000000000000002, -4.200000000000001, -4.1000000000000005, -4.100000000000001, -3.600000000000001, -4.100000000000001, -4.000000000000002, -3.900000000000001, -4.000000000000001, -3.9000000000000012, -4.200000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.1000000000000005, -3.8000000000000007, -4.100000000000001, -4.0, -4.1000000000000005, -4.000000000000001, -3.9000000000000012, -4.000000000000002, -4.000000000000001, -4.000000000000001, -3.9000000000000004, -4.1000000000000005, -4.100000000000001, -3.7000000000000006, -3.900000000000001, -3.900000000000001, -3.500000000000001, -3.900000000000001, -4.000000000000002, -3.900000000000001, -3.800000000000001, -4.000000000000001, -4.1000000000000005, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000002, -4.000000000000002, -4.200000000000001, -4.1000000000000005, -4.000000000000002, -3.9000000000000012, -4.300000000000001, -3.800000000000001, -4.100000000000001, -4.000000000000001, -4.300000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -3.6000000000000005, -3.900000000000001, -3.900000000000001, -4.200000000000001, -4.300000000000001, -3.8000000000000007, -4.100000000000001, -3.800000000000001, -4.000000000000001, -4.000000000000002, -3.900000000000001, -4.200000000000001, -4.0, -4.300000000000001, -4.200000000000001, -3.800000000000001, -3.9000000000000004, -4.200000000000001, -4.000000000000001, -3.900000000000001, -3.9000000000000012, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.200000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.200000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.800000000000001, -4.0, -3.9000000000000012, -3.8000000000000007, -3.800000000000001, -4.000000000000002, -4.1000000000000005, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -3.7000000000000006, -3.700000000000001, -3.6000000000000005, -3.900000000000001, -4.0, -4.1000000000000005, -3.900000000000001, -3.900000000000001, -3.700000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -4.100000000000001, -3.9000000000000012, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.618210659115338, "mean_inference_ms": 18.2365696482958, "mean_action_processing_ms": 0.9402592205170014, "mean_env_wait_ms": 1.534347474697496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07570266723632812, "StateBufferConnector_ms": 0.009844805064954255, "ViewRequirementAgentConnector_ms": 0.14019426546598734}}, "episode_reward_max": -3.500000000000001, "episode_reward_min": -10.4, "episode_reward_mean": -4.015263157894738, "episode_len_mean": 20.910526315789475, "episodes_this_iter": 190, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.100000000000001, -4.000000000000001, -4.200000000000001, -3.900000000000001, -4.100000000000001, -3.9000000000000012, -4.100000000000001, -4.300000000000001, -4.200000000000001, -4.1000000000000005, -4.200000000000001, -4.200000000000001, -3.8000000000000007, -4.100000000000001, -4.000000000000001, -10.4, -3.8000000000000007, -4.200000000000001, -4.200000000000001, -4.000000000000001, -3.900000000000001, -3.7000000000000006, -3.8000000000000007, -3.900000000000001, -4.000000000000001, -4.000000000000002, -4.000000000000001, -3.900000000000001, -4.200000000000001, -3.900000000000001, -4.1000000000000005, -4.100000000000001, -4.100000000000001, -3.800000000000001, -3.800000000000001, -4.100000000000001, -3.8000000000000007, -4.100000000000001, -4.000000000000002, -4.1000000000000005, -4.100000000000001, -4.000000000000001, -4.200000000000001, -3.800000000000001, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000002, -4.0, -4.000000000000001, -4.000000000000002, -4.200000000000001, -4.1000000000000005, -4.100000000000001, -3.600000000000001, -4.100000000000001, -4.000000000000002, -3.900000000000001, -4.000000000000001, -3.9000000000000012, -4.200000000000001, -4.100000000000001, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.1000000000000005, -3.8000000000000007, -4.100000000000001, -4.0, -4.1000000000000005, -4.000000000000001, -3.9000000000000012, -4.000000000000002, -4.000000000000001, -4.000000000000001, -3.9000000000000004, -4.1000000000000005, -4.100000000000001, -3.7000000000000006, -3.900000000000001, -3.900000000000001, -3.500000000000001, -3.900000000000001, -4.000000000000002, -3.900000000000001, -3.800000000000001, -4.000000000000001, -4.1000000000000005, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000002, -4.000000000000002, -4.200000000000001, -4.1000000000000005, -4.000000000000002, -3.9000000000000012, -4.300000000000001, -3.800000000000001, -4.100000000000001, -4.000000000000001, -4.300000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -3.6000000000000005, -3.900000000000001, -3.900000000000001, -4.200000000000001, -4.300000000000001, -3.8000000000000007, -4.100000000000001, -3.800000000000001, -4.000000000000001, -4.000000000000002, -3.900000000000001, -4.200000000000001, -4.0, -4.300000000000001, -4.200000000000001, -3.800000000000001, -3.9000000000000004, -4.200000000000001, -4.000000000000001, -3.900000000000001, -3.9000000000000012, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.200000000000001, -3.900000000000001, -3.900000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -4.200000000000001, -3.900000000000001, -3.900000000000001, -4.100000000000001, -3.800000000000001, -4.0, -3.9000000000000012, -3.8000000000000007, -3.800000000000001, -4.000000000000002, -4.1000000000000005, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -3.8000000000000007, -3.7000000000000006, -3.700000000000001, -3.6000000000000005, -3.900000000000001, -4.0, -4.1000000000000005, -3.900000000000001, -3.900000000000001, -3.700000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -4.200000000000001, -4.100000000000001, -3.9000000000000012, -4.100000000000001, -3.8000000000000007, -3.900000000000001, -4.000000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.618210659115338, "mean_inference_ms": 18.2365696482958, "mean_action_processing_ms": 0.9402592205170014, "mean_env_wait_ms": 1.534347474697496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07570266723632812, "StateBufferConnector_ms": 0.009844805064954255, "ViewRequirementAgentConnector_ms": 0.14019426546598734}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 712000, "num_agent_steps_trained": 712000, "num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 712000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 712000, "timers": {"training_iteration_time_ms": 175594.55, "load_time_ms": 1.181, "load_throughput": 3386531.56, "learn_time_ms": 174619.389, "learn_throughput": 22.907, "synch_weights_time_ms": 182.661}, "counters": {"num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_agent_steps_sampled": 712000, "num_agent_steps_trained": 712000}, "done": false, "episodes_total": 35382, "training_iteration": 178, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_05-28-04", "timestamp": 1680838084, "time_this_iter_s": 175.62770748138428, "time_total_s": 30742.008254289627, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f0147659730>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff94615040>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 30742.008254289627, "timesteps_since_restore": 0, "iterations_since_restore": 178, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.5084, "ram_util_percent": 23.9016}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.74081260875989, "cur_kl_coeff": 14.430100522191642, "cur_lr": 0.01, "total_loss": 0.43950525234223053, "policy_loss": 0.0039048762045680516, "vf_loss": 0.28062116979591306, "vf_explained_var": 0.7162041906387575, "kl": 0.010739994969332256, "entropy": 2.764493095233876, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 166005.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 716000, "num_env_steps_trained": 716000, "num_agent_steps_sampled": 716000, "num_agent_steps_trained": 716000}, "sampler_results": {"episode_reward_max": -3.5000000000000004, "episode_reward_min": -10.2, "episode_reward_mean": -4.044973544973546, "episode_len_mean": 20.804232804232804, "episode_media": {}, "episodes_this_iter": 189, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.000000000000001, -4.200000000000001, -4.000000000000002, -3.800000000000001, -4.1000000000000005, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000002, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000002, -3.800000000000001, -3.900000000000001, -10.2, -3.8000000000000007, -3.9000000000000004, -3.800000000000001, -4.300000000000001, -3.900000000000001, -4.000000000000001, -3.9000000000000012, -3.800000000000001, -3.8000000000000003, -4.400000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000002, -3.900000000000001, -3.8000000000000003, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.0, -3.900000000000001, -4.000000000000001, -3.9000000000000004, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -4.100000000000001, -4.200000000000001, -3.7000000000000006, -3.900000000000001, -4.0, -3.8000000000000007, -4.200000000000001, -4.100000000000001, -3.8000000000000007, -4.1000000000000005, -3.900000000000001, -3.9000000000000004, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.700000000000001, -3.800000000000001, -4.300000000000001, -3.8000000000000007, -4.000000000000002, -4.200000000000001, -3.9000000000000012, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.300000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.1000000000000005, -3.8000000000000003, -10.1, -4.000000000000001, -3.5000000000000004, -3.8000000000000007, -3.900000000000001, -4.000000000000002, -4.000000000000001, -4.1000000000000005, -3.8000000000000007, -3.800000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.7, -3.9000000000000012, -4.000000000000001, -3.8000000000000007, -4.300000000000001, -4.300000000000001, -4.000000000000001, -3.9000000000000004, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -4.200000000000001, -3.9000000000000012, -4.000000000000001, -4.200000000000001, -3.900000000000001, -3.9000000000000004, -4.100000000000001, -4.0, -4.1000000000000005, -4.200000000000001, -4.300000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -4.200000000000001, -3.9000000000000012, -4.100000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -3.9000000000000012, -4.200000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.1000000000000005, -4.100000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.9000000000000012, -4.000000000000002, -3.6000000000000005, -4.1000000000000005, -3.8000000000000007, -3.8000000000000003, -4.000000000000001, -3.8000000000000007, -3.9000000000000004, -4.100000000000001, -3.800000000000001, -4.000000000000001, -3.800000000000001, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -4.200000000000001, -4.200000000000001, -4.000000000000002, -3.800000000000001, -4.000000000000001, -4.000000000000001, -4.200000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -3.8000000000000003, -4.1000000000000005, -4.000000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.621066062463504, "mean_inference_ms": 18.23984652540955, "mean_action_processing_ms": 0.9399977640876542, "mean_env_wait_ms": 1.5337534656568812, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07248240173178375, "StateBufferConnector_ms": 0.009299712206320788, "ViewRequirementAgentConnector_ms": 0.13307478062059513}}, "episode_reward_max": -3.5000000000000004, "episode_reward_min": -10.2, "episode_reward_mean": -4.044973544973546, "episode_len_mean": 20.804232804232804, "episodes_this_iter": 189, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.000000000000001, -4.200000000000001, -4.000000000000002, -3.800000000000001, -4.1000000000000005, -4.000000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000002, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000002, -3.800000000000001, -3.900000000000001, -10.2, -3.8000000000000007, -3.9000000000000004, -3.800000000000001, -4.300000000000001, -3.900000000000001, -4.000000000000001, -3.9000000000000012, -3.800000000000001, -3.8000000000000003, -4.400000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000002, -3.900000000000001, -3.8000000000000003, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.0, -3.900000000000001, -4.000000000000001, -3.9000000000000004, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -4.100000000000001, -4.200000000000001, -3.7000000000000006, -3.900000000000001, -4.0, -3.8000000000000007, -4.200000000000001, -4.100000000000001, -3.8000000000000007, -4.1000000000000005, -3.900000000000001, -3.9000000000000004, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.700000000000001, -3.800000000000001, -4.300000000000001, -3.8000000000000007, -4.000000000000002, -4.200000000000001, -3.9000000000000012, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.300000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.100000000000001, -4.1000000000000005, -3.8000000000000003, -10.1, -4.000000000000001, -3.5000000000000004, -3.8000000000000007, -3.900000000000001, -4.000000000000002, -4.000000000000001, -4.1000000000000005, -3.8000000000000007, -3.800000000000001, -4.100000000000001, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -4.000000000000001, -3.7, -3.9000000000000012, -4.000000000000001, -3.8000000000000007, -4.300000000000001, -4.300000000000001, -4.000000000000001, -3.9000000000000004, -4.000000000000001, -3.9000000000000012, -3.900000000000001, -4.000000000000001, -4.200000000000001, -3.9000000000000012, -4.000000000000001, -4.200000000000001, -3.900000000000001, -3.9000000000000004, -4.100000000000001, -4.0, -4.1000000000000005, -4.200000000000001, -4.300000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.8000000000000007, -4.100000000000001, -4.200000000000001, -3.9000000000000012, -4.100000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -3.9000000000000012, -4.200000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -4.000000000000001, -4.100000000000001, -4.100000000000001, -4.1000000000000005, -4.100000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.9000000000000012, -4.000000000000002, -3.6000000000000005, -4.1000000000000005, -3.8000000000000007, -3.8000000000000003, -4.000000000000001, -3.8000000000000007, -3.9000000000000004, -4.100000000000001, -3.800000000000001, -4.000000000000001, -3.800000000000001, -4.000000000000001, -4.000000000000001, -3.7000000000000006, -4.200000000000001, -4.200000000000001, -4.000000000000002, -3.800000000000001, -4.000000000000001, -4.000000000000001, -4.200000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -3.8000000000000003, -4.1000000000000005, -4.000000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 3, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.621066062463504, "mean_inference_ms": 18.23984652540955, "mean_action_processing_ms": 0.9399977640876542, "mean_env_wait_ms": 1.5337534656568812, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07248240173178375, "StateBufferConnector_ms": 0.009299712206320788, "ViewRequirementAgentConnector_ms": 0.13307478062059513}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 716000, "num_agent_steps_trained": 716000, "num_env_steps_sampled": 716000, "num_env_steps_trained": 716000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 716000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 716000, "timers": {"training_iteration_time_ms": 175573.651, "load_time_ms": 1.179, "load_throughput": 3392283.398, "learn_time_ms": 174600.857, "learn_throughput": 22.909, "synch_weights_time_ms": 178.236}, "counters": {"num_env_steps_sampled": 716000, "num_env_steps_trained": 716000, "num_agent_steps_sampled": 716000, "num_agent_steps_trained": 716000}, "done": false, "episodes_total": 35571, "training_iteration": 179, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_05-30-59", "timestamp": 1680838259, "time_this_iter_s": 175.47714185714722, "time_total_s": 30917.485396146774, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7effc01300a0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff94564820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 30917.485396146774, "timesteps_since_restore": 0, "iterations_since_restore": 179, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.611646586345382, "ram_util_percent": 23.900803212851407}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.412298139449089, "cur_kl_coeff": 14.430100522191642, "cur_lr": 0.01, "total_loss": 0.43472829491941517, "policy_loss": -0.0028291038598024076, "vf_loss": 0.25855077866424797, "vf_explained_var": 0.7495746172884459, "kl": 0.012405084649674214, "entropy": 2.755222205449176, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 166935.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "sampler_results": {"episode_reward_max": -3.5000000000000004, "episode_reward_min": -4.400000000000001, "episode_reward_mean": -3.9528795811518322, "episode_len_mean": 21.0, "episode_media": {}, "episodes_this_iter": 191, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.200000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000002, -3.800000000000001, -3.9000000000000004, -4.0, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000001, -3.8000000000000007, -4.0, -3.8000000000000007, -4.000000000000002, -4.200000000000001, -4.0, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000001, -4.300000000000001, -4.100000000000001, -3.800000000000001, -4.100000000000001, -4.200000000000001, -3.8000000000000007, -3.9000000000000012, -3.900000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -3.800000000000001, -4.000000000000001, -4.000000000000002, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -3.9000000000000012, -4.100000000000001, -4.000000000000001, -4.0, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.0, -4.000000000000001, -4.200000000000001, -4.000000000000002, -3.800000000000001, -4.1000000000000005, -3.8000000000000007, -3.8000000000000007, -4.200000000000001, -4.100000000000001, -3.9000000000000012, -3.800000000000001, -4.1000000000000005, -4.000000000000001, -3.900000000000001, -4.100000000000001, -3.9000000000000012, -4.200000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.200000000000001, -4.400000000000001, -3.8000000000000007, -4.000000000000001, -3.9000000000000012, -4.100000000000001, -3.7000000000000006, -3.9000000000000004, -3.8000000000000007, -3.800000000000001, -3.8000000000000007, -4.200000000000001, -4.000000000000001, -4.200000000000001, -3.9000000000000012, -3.8000000000000007, -3.900000000000001, -3.6000000000000005, -3.7000000000000006, -4.000000000000001, -3.800000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -3.800000000000001, -3.9000000000000012, -3.600000000000001, -3.900000000000001, -4.0, -4.000000000000001, -4.000000000000002, -3.800000000000001, -3.9000000000000004, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000002, -4.200000000000001, -4.000000000000001, -4.0, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.9000000000000012, -4.200000000000001, -4.100000000000001, -3.900000000000001, -3.7000000000000006, -3.7000000000000006, -3.9000000000000012, -3.8000000000000007, -4.000000000000001, -4.0, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -4.200000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000002, -4.000000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.0, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000001, -3.6000000000000005, -3.8000000000000007, -3.700000000000001, -3.5000000000000004, -4.0, -3.800000000000001, -3.7000000000000006, -3.600000000000001, -4.000000000000001, -3.8000000000000007, -4.0, -3.9000000000000004, -3.8000000000000003, -4.0, -4.000000000000001, -3.900000000000001, -3.800000000000001, -4.000000000000001, -4.000000000000001, -3.800000000000001, -3.800000000000001, -3.7000000000000006, -4.000000000000001, -3.900000000000001, -3.9000000000000004, -4.000000000000001, -3.7000000000000006, -3.700000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.621971920411447, "mean_inference_ms": 18.231084305309157, "mean_action_processing_ms": 0.9397087248360186, "mean_env_wait_ms": 1.5311152734900133, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07453950911916363, "StateBufferConnector_ms": 0.009453234248136351, "ViewRequirementAgentConnector_ms": 0.13806607710753435}}, "episode_reward_max": -3.5000000000000004, "episode_reward_min": -4.400000000000001, "episode_reward_mean": -3.9528795811518322, "episode_len_mean": 21.0, "episodes_this_iter": 191, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.200000000000001, -3.900000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000002, -3.800000000000001, -3.9000000000000004, -4.0, -4.100000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000001, -3.8000000000000007, -4.0, -3.8000000000000007, -4.000000000000002, -4.200000000000001, -4.0, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000001, -4.300000000000001, -4.100000000000001, -3.800000000000001, -4.100000000000001, -4.200000000000001, -3.8000000000000007, -3.9000000000000012, -3.900000000000001, -3.900000000000001, -4.100000000000001, -4.100000000000001, -3.900000000000001, -3.800000000000001, -4.000000000000001, -4.000000000000002, -3.8000000000000007, -3.900000000000001, -3.8000000000000007, -3.8000000000000007, -3.9000000000000012, -4.100000000000001, -4.000000000000001, -4.0, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.0, -4.000000000000001, -4.200000000000001, -4.000000000000002, -3.800000000000001, -4.1000000000000005, -3.8000000000000007, -3.8000000000000007, -4.200000000000001, -4.100000000000001, -3.9000000000000012, -3.800000000000001, -4.1000000000000005, -4.000000000000001, -3.900000000000001, -4.100000000000001, -3.9000000000000012, -4.200000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.200000000000001, -4.400000000000001, -3.8000000000000007, -4.000000000000001, -3.9000000000000012, -4.100000000000001, -3.7000000000000006, -3.9000000000000004, -3.8000000000000007, -3.800000000000001, -3.8000000000000007, -4.200000000000001, -4.000000000000001, -4.200000000000001, -3.9000000000000012, -3.8000000000000007, -3.900000000000001, -3.6000000000000005, -3.7000000000000006, -4.000000000000001, -3.800000000000001, -3.8000000000000007, -3.8000000000000007, -4.000000000000001, -3.800000000000001, -3.9000000000000012, -3.600000000000001, -3.900000000000001, -4.0, -4.000000000000001, -4.000000000000002, -3.800000000000001, -3.9000000000000004, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000002, -4.200000000000001, -4.000000000000001, -4.0, -3.8000000000000007, -3.8000000000000007, -3.900000000000001, -4.100000000000001, -3.900000000000001, -3.9000000000000012, -4.200000000000001, -4.100000000000001, -3.900000000000001, -3.7000000000000006, -3.7000000000000006, -3.9000000000000012, -3.8000000000000007, -4.000000000000001, -4.0, -4.100000000000001, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -4.200000000000001, -4.100000000000001, -3.900000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000002, -4.000000000000001, -4.200000000000001, -4.000000000000001, -4.000000000000001, -3.900000000000001, -3.900000000000001, -3.8000000000000007, -4.200000000000001, -4.100000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.0, -4.000000000000001, -3.900000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000001, -3.6000000000000005, -3.8000000000000007, -3.700000000000001, -3.5000000000000004, -4.0, -3.800000000000001, -3.7000000000000006, -3.600000000000001, -4.000000000000001, -3.8000000000000007, -4.0, -3.9000000000000004, -3.8000000000000003, -4.0, -4.000000000000001, -3.900000000000001, -3.800000000000001, -4.000000000000001, -4.000000000000001, -3.800000000000001, -3.800000000000001, -3.7000000000000006, -4.000000000000001, -3.900000000000001, -3.9000000000000004, -4.000000000000001, -3.7000000000000006, -3.700000000000001], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.621971920411447, "mean_inference_ms": 18.231084305309157, "mean_action_processing_ms": 0.9397087248360186, "mean_env_wait_ms": 1.5311152734900133, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07453950911916363, "StateBufferConnector_ms": 0.009453234248136351, "ViewRequirementAgentConnector_ms": 0.13806607710753435}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 175560.949, "load_time_ms": 1.176, "load_throughput": 3402741.304, "learn_time_ms": 174610.487, "learn_throughput": 22.908, "synch_weights_time_ms": 178.052}, "counters": {"num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "episodes_total": 35762, "training_iteration": 180, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_05-33-54", "timestamp": 1680838434, "time_this_iter_s": 175.17220902442932, "time_total_s": 31092.657605171204, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7eff946f68b0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff94615a60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 31092.657605171204, "timesteps_since_restore": 0, "iterations_since_restore": 180, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.557429718875502, "ram_util_percent": 23.901204819277112}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.838260345305166, "cur_kl_coeff": 14.430100522191642, "cur_lr": 0.01, "total_loss": 0.5148976091736106, "policy_loss": 0.0053198748653734565, "vf_loss": 0.2910205974854449, "vf_explained_var": 0.7210859885138851, "kl": 0.0151459191991542, "entropy": 2.749575400096114, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 167865.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 724000, "num_env_steps_trained": 724000, "num_agent_steps_sampled": 724000, "num_agent_steps_trained": 724000}, "sampler_results": {"episode_reward_max": -3.500000000000001, "episode_reward_min": -10.8, "episode_reward_mean": -4.055789473684211, "episode_len_mean": 20.83684210526316, "episode_media": {}, "episodes_this_iter": 190, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.000000000000001, -4.000000000000001, -4.400000000000001, -4.000000000000001, -4.1000000000000005, -4.000000000000001, -3.900000000000001, -3.800000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000002, -3.800000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000002, -10.3, -4.000000000000001, -4.100000000000001, -4.300000000000001, -4.000000000000001, -4.200000000000001, -4.200000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000002, -4.300000000000001, -3.8000000000000007, -4.000000000000002, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.800000000000001, -3.9000000000000012, -4.000000000000001, -4.000000000000001, -4.000000000000002, -4.000000000000001, -4.000000000000001, -3.700000000000001, -4.000000000000001, -3.900000000000001, -3.800000000000001, -3.8000000000000007, -3.800000000000001, -3.800000000000001, -4.300000000000001, -3.900000000000001, -4.000000000000001, -3.9000000000000004, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -3.9000000000000012, -4.200000000000001, -4.100000000000001, -4.0, -4.100000000000001, -4.200000000000001, -4.000000000000001, -4.200000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000002, -3.800000000000001, -4.000000000000001, -3.6000000000000005, -3.800000000000001, -3.8000000000000007, -4.100000000000001, -3.500000000000001, -4.200000000000001, -10.8, -4.100000000000001, -3.7000000000000006, -3.8000000000000003, -3.8000000000000007, -4.200000000000001, -3.900000000000001, -4.200000000000001, -3.7000000000000006, -3.8000000000000007, -4.100000000000001, -3.800000000000001, -4.000000000000002, -4.000000000000001, -4.1000000000000005, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -4.300000000000001, -4.100000000000001, -3.7000000000000006, -3.900000000000001, -3.9000000000000012, -4.100000000000001, -4.300000000000001, -4.000000000000001, -4.100000000000001, -3.9000000000000012, -4.100000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -3.600000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000001, -4.0, -4.000000000000001, -4.300000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000001, -3.9000000000000004, -4.100000000000001, -4.1000000000000005, -4.400000000000001, -4.200000000000001, -4.100000000000001, -4.200000000000001, -4.300000000000001, -4.000000000000002, -3.9000000000000012, -4.100000000000001, -3.800000000000001, -3.9000000000000012, -3.8000000000000007, -4.000000000000002, -4.000000000000001, -3.900000000000001, -4.100000000000001, -3.8000000000000003, -3.700000000000001, -3.800000000000001, -4.000000000000001, -3.800000000000001, -4.000000000000002, -4.000000000000001, -3.8000000000000003, -3.700000000000001, -4.000000000000001, -4.1000000000000005, -4.200000000000001, -3.800000000000001, -3.8000000000000007, -4.100000000000001, -4.000000000000002, -3.700000000000001, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -3.800000000000001, -3.900000000000001, -4.000000000000002], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.622141144930946, "mean_inference_ms": 18.234425316796205, "mean_action_processing_ms": 0.9399053241231435, "mean_env_wait_ms": 1.5331249174405457, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0730384023565995, "StateBufferConnector_ms": 0.009598230060778166, "ViewRequirementAgentConnector_ms": 0.13426216025101512}}, "episode_reward_max": -3.500000000000001, "episode_reward_min": -10.8, "episode_reward_mean": -4.055789473684211, "episode_len_mean": 20.83684210526316, "episodes_this_iter": 190, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.000000000000001, -4.000000000000001, -4.400000000000001, -4.000000000000001, -4.1000000000000005, -4.000000000000001, -3.900000000000001, -3.800000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000002, -3.800000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -3.900000000000001, -4.000000000000002, -10.3, -4.000000000000001, -4.100000000000001, -4.300000000000001, -4.000000000000001, -4.200000000000001, -4.200000000000001, -3.900000000000001, -4.100000000000001, -4.000000000000002, -4.300000000000001, -3.8000000000000007, -4.000000000000002, -4.100000000000001, -4.000000000000001, -3.900000000000001, -3.800000000000001, -3.9000000000000012, -4.000000000000001, -4.000000000000001, -4.000000000000002, -4.000000000000001, -4.000000000000001, -3.700000000000001, -4.000000000000001, -3.900000000000001, -3.800000000000001, -3.8000000000000007, -3.800000000000001, -3.800000000000001, -4.300000000000001, -3.900000000000001, -4.000000000000001, -3.9000000000000004, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -4.000000000000001, -3.900000000000001, -4.100000000000001, -3.9000000000000012, -4.200000000000001, -4.100000000000001, -4.0, -4.100000000000001, -4.200000000000001, -4.000000000000001, -4.200000000000001, -3.900000000000001, -4.200000000000001, -4.000000000000001, -4.100000000000001, -4.000000000000001, -4.000000000000001, -4.000000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.200000000000001, -4.100000000000001, -4.200000000000001, -4.000000000000002, -3.800000000000001, -4.000000000000001, -3.6000000000000005, -3.800000000000001, -3.8000000000000007, -4.100000000000001, -3.500000000000001, -4.200000000000001, -10.8, -4.100000000000001, -3.7000000000000006, -3.8000000000000003, -3.8000000000000007, -4.200000000000001, -3.900000000000001, -4.200000000000001, -3.7000000000000006, -3.8000000000000007, -4.100000000000001, -3.800000000000001, -4.000000000000002, -4.000000000000001, -4.1000000000000005, -3.900000000000001, -3.8000000000000007, -3.900000000000001, -3.900000000000001, -4.300000000000001, -4.100000000000001, -3.7000000000000006, -3.900000000000001, -3.9000000000000012, -4.100000000000001, -4.300000000000001, -4.000000000000001, -4.100000000000001, -3.9000000000000012, -4.100000000000001, -4.000000000000001, -4.000000000000001, -3.8000000000000007, -4.100000000000001, -3.600000000000001, -4.200000000000001, -4.100000000000001, -4.000000000000001, -4.0, -4.000000000000001, -4.300000000000001, -4.000000000000001, -4.100000000000001, -3.900000000000001, -4.000000000000001, -4.000000000000001, -4.200000000000001, -4.000000000000001, -3.9000000000000004, -4.100000000000001, -4.1000000000000005, -4.400000000000001, -4.200000000000001, -4.100000000000001, -4.200000000000001, -4.300000000000001, -4.000000000000002, -3.9000000000000012, -4.100000000000001, -3.800000000000001, -3.9000000000000012, -3.8000000000000007, -4.000000000000002, -4.000000000000001, -3.900000000000001, -4.100000000000001, -3.8000000000000003, -3.700000000000001, -3.800000000000001, -4.000000000000001, -3.800000000000001, -4.000000000000002, -4.000000000000001, -3.8000000000000003, -3.700000000000001, -4.000000000000001, -4.1000000000000005, -4.200000000000001, -3.800000000000001, -3.8000000000000007, -4.100000000000001, -4.000000000000002, -3.700000000000001, -3.900000000000001, -3.7000000000000006, -3.900000000000001, -4.100000000000001, -4.000000000000001, -4.200000000000001, -3.8000000000000007, -4.000000000000001, -3.8000000000000007, -4.000000000000001, -3.800000000000001, -3.900000000000001, -4.000000000000002], "episode_lengths": [21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 4, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 7, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.622141144930946, "mean_inference_ms": 18.234425316796205, "mean_action_processing_ms": 0.9399053241231435, "mean_env_wait_ms": 1.5331249174405457, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0730384023565995, "StateBufferConnector_ms": 0.009598230060778166, "ViewRequirementAgentConnector_ms": 0.13426216025101512}, "num_healthy_workers": 20, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 724000, "num_agent_steps_trained": 724000, "num_env_steps_sampled": 724000, "num_env_steps_trained": 724000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 724000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 724000, "timers": {"training_iteration_time_ms": 175539.28, "load_time_ms": 1.2, "load_throughput": 3332978.922, "learn_time_ms": 174585.871, "learn_throughput": 22.911, "synch_weights_time_ms": 180.013}, "counters": {"num_env_steps_sampled": 724000, "num_env_steps_trained": 724000, "num_agent_steps_sampled": 724000, "num_agent_steps_trained": 724000}, "done": false, "episodes_total": 35952, "training_iteration": 181, "trial_id": "9336a_00000", "experiment_id": "7bbe55449621491c81dd380db7819fb1", "date": "2023-04-07_05-36-50", "timestamp": 1680838610, "time_this_iter_s": 175.5972466468811, "time_total_s": 31268.254851818085, "pid": 255597, "hostname": "21d8e0492b66", "node_ip": "172.17.0.6", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'src.environment.env_complex_observation.BugPlus'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 10, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.99, "lr": 0.01, "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f01473e2af0>"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 42069, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7eff94615040>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 20}, "time_since_restore": 31268.254851818085, "timesteps_since_restore": 0, "iterations_since_restore": 181, "warmup_time": 6.40270471572876, "perf": {"cpu_util_percent": 5.6816, "ram_util_percent": 23.912399999999998}}
